<h3><span class=" glyphicon glyphicon-tag"/>&nbspNullVerifier</h3><kbd>Verifies whether objects are null</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.ambari.msi.ConfigurationProviderTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithPredicate() throws Exception {
  ClusterDefinition clusterDefinitionMock=createStrictMock(ClusterDefinition.class);
  StaxDriver staxDriver=PowerMock.createStrictMock(StaxDriver.class);
  XStream xstream=PowerMock.createStrictMock(XStream.class);
  PowerMock.mockStatic(ClassLoader.class);
  InputStream mockInputStream=createMock(InputStream.class);
  PowerMock.expectNew(StaxDriver.class).andReturn(staxDriver);
  PowerMock.expectNew(XStream.class,staxDriver).andReturn(xstream);
  xstream.alias("configuration",Map.class);
  expectLastCall();
  xstream.registerConverter(anyObject(ConfigurationProvider.ScomConfigConverter.class));
  expectLastCall();
  expect(ClassLoader.getSystemResourceAsStream(anyObject(String.class))).andReturn(mockInputStream).times(5);
  expect(xstream.fromXML(mockInputStream)).andReturn(new HashMap<String,String>(){
{
      put("property_key","propery_value");
    }
  }
).times(5);
  expect(clusterDefinitionMock.getClusterName()).andReturn("ambari");
  PowerMock.replay(staxDriver,StaxDriver.class,xstream,XStream.class,ClassLoader.class);
  replay(clusterDefinitionMock,mockInputStream);
  ConfigurationProvider configurationProvider=new ConfigurationProvider(clusterDefinitionMock);
  PowerMock.verify(staxDriver,StaxDriver.class,xstream,XStream.class,ClassLoader.class);
  verify(clusterDefinitionMock,mockInputStream);
  Predicate configPredicate=new PredicateBuilder().property(ConfigurationProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID).equals("ambari").and().property(ConfigurationProvider.CONFIGURATION_CONFIG_TYPE_PROPERTY_ID).equals("yarn-site").and().property(ConfigurationProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID).equals("version1").toPredicate();
  Set<Resource> resources=configurationProvider.getResources(PropertyHelper.getReadRequest(),configPredicate);
  Assert.assertNotNull(resources);
  Assert.assertEquals(1,resources.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.msi.NoOpProviderTest </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testGetKeyPropertyIds() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestStateProvider(),new TestClusterDefinitionProvider(),new TestHostInfoProvider());
  NoOpProvider provider=new NoOpProvider(Resource.Type.Workflow,clusterDefinition);
  Assert.assertNotNull(provider.getKeyPropertyIds());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.scom.ClusterDefinitionProviderTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetInputStream() throws Exception {
  ClusterDefinitionProvider provider=getProvider("clusterproperties.txt","myCluster","myVersion");
  InputStream inputStream=provider.getInputStream();
  Assert.assertNotNull(inputStream);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.scom.SQLPropertyProviderTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources_noHostNameProperty() throws Exception {
  ConnectionFactory connectionFactory=createNiceMock(ConnectionFactory.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(connectionFactory.getConnection()).andReturn(connection).once();
  expect(connection.createStatement()).andReturn(statement).once();
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet).once();
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999990L);
  expect(resultSet.getNString("MetricValue")).andReturn("0");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999991L);
  expect(resultSet.getNString("MetricValue")).andReturn("1");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999992L);
  expect(resultSet.getNString("MetricValue")).andReturn("2");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999993L);
  expect(resultSet.getNString("MetricValue")).andReturn("3");
  expect(resultSet.next()).andReturn(false);
  replay(connectionFactory,connection,statement,resultSet);
  TestHostInfoProvider hostProvider=new TestHostInfoProvider();
  SQLPropertyProvider provider=new SQLPropertyProvider(PropertyHelper.getGangliaPropertyIds(Resource.Type.HostComponent),hostProvider,CLUSTER_NAME_PROPERTY_ID,null,COMPONENT_NAME_PROPERTY_ID,SERVICE_NAME_PROPERTY_ID,connectionFactory);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  resource.setProperty(COMPONENT_NAME_PROPERTY_ID,"DATANODE");
  resource.setProperty(SERVICE_NAME_PROPERTY_ID,"HDFS");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID_1,new TemporalInfoImpl(10L,-1L,-1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(PROPERTY_ID_1),temporalInfoMap);
  provider.populateResources(Collections.singleton(resource),request,null);
  Assert.assertNull(hostProvider.getHostId());
  Assert.assertEquals("c1",hostProvider.getClusterName());
  Assert.assertEquals("DATANODE",hostProvider.getComponentName());
  verify(connectionFactory,connection,statement,resultSet);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources_hostNameProperty() throws Exception {
  ConnectionFactory connectionFactory=createNiceMock(ConnectionFactory.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  expect(connectionFactory.getConnection()).andReturn(connection).once();
  expect(connection.createStatement()).andReturn(statement).once();
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet).once();
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999990L);
  expect(resultSet.getNString("MetricValue")).andReturn("0");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999991L);
  expect(resultSet.getNString("MetricValue")).andReturn("1");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999992L);
  expect(resultSet.getNString("MetricValue")).andReturn("2");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getLong("RecordTimeStamp")).andReturn(999993L);
  expect(resultSet.getNString("MetricValue")).andReturn("3");
  expect(resultSet.next()).andReturn(false);
  replay(connectionFactory,connection,statement,resultSet);
  TestHostInfoProvider hostProvider=new TestHostInfoProvider();
  SQLPropertyProvider provider=new SQLPropertyProvider(PropertyHelper.getGangliaPropertyIds(Resource.Type.HostComponent),hostProvider,CLUSTER_NAME_PROPERTY_ID,HOST_NAME_PROPERTY_ID,COMPONENT_NAME_PROPERTY_ID,SERVICE_NAME_PROPERTY_ID,connectionFactory);
  Resource resource=new ResourceImpl(Resource.Type.HostComponent);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  resource.setProperty(HOST_NAME_PROPERTY_ID,"domU-12-31-39-0E-34-E1.compute-1.internal");
  resource.setProperty(COMPONENT_NAME_PROPERTY_ID,"DATANODE");
  resource.setProperty(SERVICE_NAME_PROPERTY_ID,"HDFS");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID_1,new TemporalInfoImpl(10L,-1L,-1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(PROPERTY_ID_1),temporalInfoMap);
  provider.populateResources(Collections.singleton(resource),request,null);
  Assert.assertEquals("domU-12-31-39-0E-34-E1.compute-1.internal",hostProvider.getHostId());
  Assert.assertNull(hostProvider.getClusterName());
  Assert.assertNull(hostProvider.getComponentName());
  verify(connectionFactory,connection,statement,resultSet);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.TestActionDBAccessorImpl </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequestsByStatus() throws AmbariException {
  List<Long> requestIds=new ArrayList<Long>();
  requestIds.add(requestId + 1);
  requestIds.add(requestId);
  populateActionDB(db,hostName,requestId,stageId);
  clusters.addHost("host2");
  clusters.getHost("host2").persist();
  populateActionDB(db,hostName,requestId + 1,stageId);
  List<Long> requestIdsResult=db.getRequestsByStatus(null,BaseRequest.DEFAULT_PAGE_SIZE,false);
  assertNotNull("List of request IDs is null",requestIdsResult);
  assertEquals("Request IDs not matches",requestIds,requestIdsResult);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateHostRole() throws Exception {
  populateActionDB(db,hostName,requestId,stageId);
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < 50000; i++) {
    sb.append("1234567890");
  }
  String largeString=sb.toString();
  CommandReport commandReport=new CommandReport();
  commandReport.setStatus(HostRoleStatus.COMPLETED.toString());
  commandReport.setStdOut(largeString);
  commandReport.setStdErr(largeString);
  commandReport.setStructuredOut(largeString);
  commandReport.setExitCode(123);
  db.updateHostRoleState(hostName,requestId,stageId,Role.HBASE_MASTER.toString(),commandReport);
  List<HostRoleCommandEntity> commandEntities=hostRoleCommandDAO.findByHostRole(hostName,requestId,stageId,Role.HBASE_MASTER.toString());
  assertEquals(1,commandEntities.size());
  HostRoleCommandEntity commandEntity=commandEntities.get(0);
  HostRoleCommand command=db.getTask(commandEntity.getTaskId());
  assertNotNull(command);
  assertEquals(largeString,command.getStdout());
  assertEquals(largeString,command.getStructuredOut());
  assertTrue(command.getEndTime() != -1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.TestActionManager </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionResponse() throws AmbariException {
  ActionDBAccessor db=injector.getInstance(ActionDBAccessorImpl.class);
  ActionManager am=new ActionManager(5000,1200000,new ActionQueue(),clusters,db,new HostsMap((String)null),unitOfWork,injector.getInstance(RequestFactory.class),null,null);
  populateActionDB(db,hostname);
  Stage stage=db.getAllStages(requestId).get(0);
  Assert.assertEquals(stageId,stage.getStageId());
  stage.setHostRoleStatus(hostname,"HBASE_MASTER",HostRoleStatus.QUEUED);
  db.hostRoleScheduled(stage,hostname,"HBASE_MASTER");
  List<CommandReport> reports=new ArrayList<CommandReport>();
  CommandReport cr=new CommandReport();
  cr.setTaskId(1);
  cr.setActionId(StageUtils.getActionId(requestId,stageId));
  cr.setRole("HBASE_MASTER");
  cr.setStatus("COMPLETED");
  cr.setStdErr("ERROR");
  cr.setStdOut("OUTPUT");
  cr.setStructuredOut("STRUCTURED_OUTPUT");
  cr.setExitCode(215);
  reports.add(cr);
  am.processTaskResponse(hostname,reports,stage.getOrderedHostRoleCommands());
  assertEquals(215,am.getAction(requestId,stageId).getExitCode(hostname,"HBASE_MASTER"));
  assertEquals(HostRoleStatus.COMPLETED,am.getAction(requestId,stageId).getHostRoleStatus(hostname,"HBASE_MASTER"));
  assertEquals("ERROR",am.getAction(requestId,stageId).getHostRoleCommand(hostname,"HBASE_MASTER").getStderr());
  assertEquals("OUTPUT",am.getAction(requestId,stageId).getHostRoleCommand(hostname,"HBASE_MASTER").getStdout());
  assertEquals("STRUCTURED_OUTPUT",am.getAction(requestId,stageId).getHostRoleCommand(hostname,"HBASE_MASTER").getStructuredOut());
  assertNotNull(db.getRequest(requestId));
  assertFalse(db.getRequest(requestId).getEndTime() == -1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.actionmanager.TestActionScheduler </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOpFailedEventRaisedForAbortedHostRole() throws Exception {
  ActionQueue aq=new ActionQueue();
  Properties properties=new Properties();
  Configuration conf=new Configuration(properties);
  Clusters fsm=mock(Clusters.class);
  Cluster oneClusterMock=mock(Cluster.class);
  Service serviceObj=mock(Service.class);
  ServiceComponent scomp=mock(ServiceComponent.class);
  ServiceComponentHost sch1=mock(ServiceComponentHost.class);
  ServiceComponentHost sch2=mock(ServiceComponentHost.class);
  String hostname1="host1";
  String hostname2="host2";
  Host host1=mock(Host.class);
  Host host2=mock(Host.class);
  HostEntity hostEntity1=new HostEntity();
  hostEntity1.setHostName(hostname1);
  HostEntity hostEntity2=new HostEntity();
  hostEntity2.setHostName(hostname2);
  hostDAO.merge(hostEntity1);
  hostDAO.merge(hostEntity2);
  HashMap<String,ServiceComponentHost> hosts=new HashMap<String,ServiceComponentHost>();
  hosts.put(hostname1,sch1);
  hosts.put(hostname2,sch2);
  when(scomp.getServiceComponentHosts()).thenReturn(hosts);
  when(fsm.getHost(hostname1)).thenReturn(host1);
  when(fsm.getHost(hostname2)).thenReturn(host2);
  when(host1.getState()).thenReturn(HostState.HEARTBEAT_LOST);
  when(host2.getState()).thenReturn(HostState.HEALTHY);
  when(host1.getHostName()).thenReturn(hostname1);
  when(host2.getHostName()).thenReturn(hostname2);
  when(scomp.getServiceComponentHost(hostname1)).thenReturn(sch1);
  when(scomp.getServiceComponentHost(hostname2)).thenReturn(sch2);
  UnitOfWork unitOfWork=mock(UnitOfWork.class);
  when(fsm.getCluster(anyString())).thenReturn(oneClusterMock);
  when(oneClusterMock.getService(anyString())).thenReturn(serviceObj);
  when(serviceObj.getServiceComponent(anyString())).thenReturn(scomp);
  when(serviceObj.getCluster()).thenReturn(oneClusterMock);
  final List<Stage> stages=new ArrayList<Stage>();
  Stage stage=stageFactory.createNew(1,"/tmp","cluster1",1L,"stageWith2Tasks",CLUSTER_HOST_INFO,"{\"command_param\":\"param_value\"}","{\"host_param\":\"param_value\"}");
  addInstallTaskToStage(stage,hostname1,"cluster1",Role.DATANODE,RoleCommand.INSTALL,Service.Type.HDFS,1);
  addInstallTaskToStage(stage,hostname2,"cluster1",Role.NAMENODE,RoleCommand.INSTALL,Service.Type.HDFS,2);
  stages.add(stage);
  ActionDBAccessor db=mock(ActionDBAccessor.class);
  RequestEntity request=mock(RequestEntity.class);
  when(request.isExclusive()).thenReturn(false);
  when(db.getRequestEntity(anyLong())).thenReturn(request);
  when(db.getCommandsInProgressCount()).thenReturn(stages.size());
  when(db.getStagesInProgress()).thenReturn(stages);
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      String host=(String)invocation.getArguments()[0];
      String role=(String)invocation.getArguments()[3];
      for (      HostRoleCommand command : stages.get(0).getOrderedHostRoleCommands()) {
        if (command.getHostName().equals(host) && command.getRole().name().equals(role)) {
          command.setStatus(HostRoleStatus.TIMEDOUT);
        }
      }
      return null;
    }
  }
).when(db).timeoutHostRole(anyString(),anyLong(),anyLong(),anyString());
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      Long requestId=(Long)invocation.getArguments()[0];
      for (      Stage stage : stages) {
        if (requestId.equals(stage.getRequestId())) {
          for (          HostRoleCommand command : stage.getOrderedHostRoleCommands()) {
            if (command.getStatus() == HostRoleStatus.QUEUED || command.getStatus() == HostRoleStatus.IN_PROGRESS || command.getStatus() == HostRoleStatus.PENDING) {
              command.setStatus(HostRoleStatus.ABORTED);
            }
          }
        }
      }
      return null;
    }
  }
).when(db).abortOperation(anyLong());
  ArgumentCaptor<ServiceComponentHostEvent> eventsCapture1=ArgumentCaptor.forClass(ServiceComponentHostEvent.class);
  ArgumentCaptor<ServiceComponentHostEvent> eventsCapture2=ArgumentCaptor.forClass(ServiceComponentHostEvent.class);
  ActionScheduler scheduler=new ActionScheduler(100,50000,db,aq,fsm,3,new HostsMap((String)null),unitOfWork,null,conf);
  scheduler.setTaskTimeoutAdjustment(false);
  int cycleCount=0;
  while (!(stages.get(0).getHostRoleStatus(hostname1,"DATANODE").equals(HostRoleStatus.TIMEDOUT) && stages.get(0).getHostRoleStatus(hostname2,"NAMENODE").equals(HostRoleStatus.ABORTED)) && cycleCount++ <= MAX_CYCLE_ITERATIONS) {
    scheduler.doWork();
  }
  Assert.assertEquals(HostRoleStatus.TIMEDOUT,stages.get(0).getHostRoleStatus(hostname1,"DATANODE"));
  Assert.assertEquals(HostRoleStatus.ABORTED,stages.get(0).getHostRoleStatus(hostname2,"NAMENODE"));
  verify(sch1,atLeastOnce()).handleEvent(eventsCapture1.capture());
  verify(sch2,atLeastOnce()).handleEvent(eventsCapture2.capture());
  List<ServiceComponentHostEvent> eventTypes=eventsCapture1.getAllValues();
  eventTypes.addAll(eventsCapture2.getAllValues());
  Assert.assertNotNull(eventTypes);
  ServiceComponentHostOpFailedEvent datanodeFailedEvent=null;
  ServiceComponentHostOpFailedEvent namenodeFailedEvent=null;
  for (  ServiceComponentHostEvent eventType : eventTypes) {
    if (eventType instanceof ServiceComponentHostOpFailedEvent) {
      ServiceComponentHostOpFailedEvent event=(ServiceComponentHostOpFailedEvent)eventType;
      if (event.getServiceComponentName().equals("DATANODE")) {
        datanodeFailedEvent=event;
      }
 else       if (event.getServiceComponentName().equals("NAMENODE")) {
        namenodeFailedEvent=event;
      }
    }
  }
  Assert.assertNotNull("Datanode should be in Install failed state.",datanodeFailedEvent);
  Assert.assertNotNull("Namenode should be in Install failed state.",namenodeFailedEvent);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.TestActionQueue </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testDequeueCommandType() throws Exception {
  ActionQueue queue=new ActionQueue();
  String c6401="c6401.ambari.apache.org";
  String c6402="c6402.ambari.apache.org";
  queue.enqueue(c6401,EasyMock.createMockBuilder(ExecutionCommand.class).createNiceMock());
  queue.enqueue(c6401,EasyMock.createMockBuilder(StatusCommand.class).createNiceMock());
  queue.enqueue(c6401,EasyMock.createMockBuilder(AlertDefinitionCommand.class).createNiceMock());
  queue.enqueue(c6401,EasyMock.createMockBuilder(StatusCommand.class).createNiceMock());
  queue.enqueue(c6401,EasyMock.createMockBuilder(AlertDefinitionCommand.class).createNiceMock());
  queue.enqueue(c6401,EasyMock.createMockBuilder(StatusCommand.class).createNiceMock());
  queue.enqueue(c6401,EasyMock.createMockBuilder(AlertDefinitionCommand.class).createNiceMock());
  queue.enqueue(c6402,EasyMock.createMockBuilder(ExecutionCommand.class).createNiceMock());
  queue.enqueue(c6402,EasyMock.createMockBuilder(StatusCommand.class).createNiceMock());
  queue.enqueue(c6402,EasyMock.createMockBuilder(AlertDefinitionCommand.class).createNiceMock());
  assertEquals(7,queue.size(c6401));
  List<AgentCommand> commands=queue.dequeue(c6401,AgentCommandType.ALERT_DEFINITION_COMMAND);
  assertNotNull(commands);
  assertEquals(3,commands.size());
  assertEquals(4,queue.size(c6401));
  assertEquals(3,queue.size(c6402));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.agent.TestHeartbeatHandler </h4><pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInjectKeytabApplicableHost() throws Exception {
  List<Map<String,String>> kcp;
  Map<String,String> properties;
  kcp=testInjectKeytabSetKeytab("c6403.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertEquals(1,kcp.size());
  properties=kcp.get(0);
  Assert.assertNotNull(properties);
  Assert.assertEquals("c6403.ambari.apache.org",properties.get(KerberosIdentityDataFileWriter.HOSTNAME));
  Assert.assertEquals("HDFS",properties.get(KerberosIdentityDataFileWriter.SERVICE));
  Assert.assertEquals("DATANODE",properties.get(KerberosIdentityDataFileWriter.COMPONENT));
  Assert.assertEquals("dn/_HOST@_REALM",properties.get(KerberosIdentityDataFileWriter.PRINCIPAL));
  Assert.assertEquals("/etc/security/keytabs/dn.service.keytab",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_PATH));
  Assert.assertEquals("hdfs",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_NAME));
  Assert.assertEquals("r",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_ACCESS));
  Assert.assertEquals("hadoop",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_NAME));
  Assert.assertEquals("",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_ACCESS));
  Assert.assertEquals(Base64.encodeBase64String("hello".getBytes()),kcp.get(0).get(KerberosServerAction.KEYTAB_CONTENT_BASE64));
  kcp=testInjectKeytabRemoveKeytab("c6403.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertEquals(1,kcp.size());
  properties=kcp.get(0);
  Assert.assertNotNull(properties);
  Assert.assertEquals("c6403.ambari.apache.org",properties.get(KerberosIdentityDataFileWriter.HOSTNAME));
  Assert.assertEquals("HDFS",properties.get(KerberosIdentityDataFileWriter.SERVICE));
  Assert.assertEquals("DATANODE",properties.get(KerberosIdentityDataFileWriter.COMPONENT));
  Assert.assertEquals("dn/_HOST@_REALM",properties.get(KerberosIdentityDataFileWriter.PRINCIPAL));
  Assert.assertEquals("/etc/security/keytabs/dn.service.keytab",properties.get(KerberosIdentityDataFileWriter.KEYTAB_FILE_PATH));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_NAME));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_OWNER_ACCESS));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_NAME));
  Assert.assertFalse(properties.containsKey(KerberosIdentityDataFileWriter.KEYTAB_FILE_GROUP_ACCESS));
  Assert.assertFalse(properties.containsKey(KerberosServerAction.KEYTAB_CONTENT_BASE64));
}

</code></pre>

<br>
<pre class="type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInjectKeytabNotApplicableHost() throws Exception {
  List<Map<String,String>> kcp;
  kcp=testInjectKeytabSetKeytab("c6401.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertTrue(kcp.isEmpty());
  kcp=testInjectKeytabRemoveKeytab("c6401.ambari.apache.org");
  Assert.assertNotNull(kcp);
  Assert.assertTrue(kcp.isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testHeartbeatCustomCommandWithConfigs() throws Exception {
  Cluster cluster=getDummyCluster();
  Service hdfs=cluster.addService(HDFS);
  hdfs.persist();
  hdfs.addServiceComponent(DATANODE).persist();
  hdfs.getServiceComponent(DATANODE).addServiceComponentHost(DummyHostname1).persist();
  hdfs.addServiceComponent(NAMENODE).persist();
  hdfs.getServiceComponent(NAMENODE).addServiceComponentHost(DummyHostname1).persist();
  hdfs.addServiceComponent(SECONDARY_NAMENODE).persist();
  hdfs.getServiceComponent(SECONDARY_NAMENODE).addServiceComponentHost(DummyHostname1).persist();
  ActionQueue aq=new ActionQueue();
  ServiceComponentHost serviceComponentHost1=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(DATANODE).getServiceComponentHost(DummyHostname1);
  ServiceComponentHost serviceComponentHost2=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(NAMENODE).getServiceComponentHost(DummyHostname1);
  serviceComponentHost1.setState(State.INSTALLED);
  serviceComponentHost2.setState(State.INSTALLED);
  HeartBeat hb=new HeartBeat();
  hb.setResponseId(0);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setHostname(DummyHostname1);
  List<CommandReport> reports=new ArrayList<CommandReport>();
  CommandReport cr=new CommandReport();
  cr.setActionId(StageUtils.getActionId(requestId,stageId));
  cr.setServiceName(HDFS);
  cr.setRoleCommand("CUSTOM_COMMAND");
  cr.setCustomCommand("RESTART");
  cr.setTaskId(1);
  cr.setRole(DATANODE);
  cr.setStatus("COMPLETED");
  cr.setStdErr("");
  cr.setStdOut("");
  cr.setExitCode(215);
  cr.setClusterName(DummyCluster);
  cr.setConfigurationTags(new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
);
  CommandReport crn=new CommandReport();
  crn.setActionId(StageUtils.getActionId(requestId,stageId));
  crn.setServiceName(HDFS);
  crn.setRoleCommand("CUSTOM_COMMAND");
  crn.setCustomCommand("START");
  crn.setTaskId(1);
  crn.setRole(NAMENODE);
  crn.setStatus("COMPLETED");
  crn.setStdErr("");
  crn.setStdOut("");
  crn.setExitCode(215);
  crn.setClusterName(DummyCluster);
  crn.setConfigurationTags(new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
);
  reports.add(cr);
  reports.add(crn);
  hb.setReports(reports);
  final HostRoleCommand command=hostRoleCommandFactory.create(DummyHostname1,Role.DATANODE,null,null);
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(new ArrayList<HostRoleCommand>(){
{
      add(command);
      add(command);
    }
  }
);
  replay(am);
  HeartBeatHandler handler=getHeartBeatHandler(am,aq);
  handler.handleHeartBeat(hb);
  Assert.assertNotNull(serviceComponentHost1.getActualConfigs());
  Assert.assertEquals(serviceComponentHost1.getActualConfigs().size(),1);
  Assert.assertNotNull(serviceComponentHost2.getActualConfigs());
  Assert.assertEquals(serviceComponentHost2.getActualConfigs().size(),1);
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testInstallPackagesWithVersion() throws Exception {
  EventBusSynchronizer.synchronizeAmbariEventPublisher(injector);
  final HostRoleCommand command=hostRoleCommandFactory.create(DummyHostname1,Role.DATANODE,null,null);
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(Collections.singletonList(command)).anyTimes();
  replay(am);
  Cluster cluster=getDummyCluster();
  HeartBeatHandler handler=getHeartBeatHandler(am,new ActionQueue());
  HeartBeat hb=new HeartBeat();
  JsonObject json=new JsonObject();
  json.addProperty("actual_version","2.2.1.0-2222");
  json.addProperty("package_installation_result","SUCCESS");
  json.addProperty("installed_repository_version","0.1");
  json.addProperty("stack_id",cluster.getDesiredStackVersion().getStackId());
  CommandReport cmdReport=new CommandReport();
  cmdReport.setActionId(StageUtils.getActionId(requestId,stageId));
  cmdReport.setTaskId(1);
  cmdReport.setCustomCommand("install_packages");
  cmdReport.setStructuredOut(json.toString());
  cmdReport.setRoleCommand(RoleCommand.ACTIONEXECUTE.name());
  cmdReport.setStatus(HostRoleStatus.COMPLETED.name());
  cmdReport.setRole("install_packages");
  cmdReport.setClusterName(DummyCluster);
  hb.setReports(Collections.singletonList(cmdReport));
  hb.setTimestamp(0L);
  hb.setResponseId(0);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setHostname(DummyHostname1);
  hb.setComponentStatus(new ArrayList<ComponentStatus>());
  StackId stackId=new StackId("HDP","0.1");
  RepositoryVersionDAO dao=injector.getInstance(RepositoryVersionDAO.class);
  RepositoryVersionEntity entity=dao.findByStackAndVersion(stackId,"0.1");
  Assert.assertNotNull(entity);
  handler.handleHeartBeat(hb);
  entity=dao.findByStackAndVersion(stackId,"0.1");
  Assert.assertNull(entity);
  entity=dao.findByStackAndVersion(stackId,"2.2.1.0-2222");
  Assert.assertNotNull(entity);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testHeartbeatWithConfigs() throws Exception {
  Cluster cluster=getDummyCluster();
  Service hdfs=cluster.addService(HDFS);
  hdfs.persist();
  hdfs.addServiceComponent(DATANODE).persist();
  hdfs.getServiceComponent(DATANODE).addServiceComponentHost(DummyHostname1).persist();
  hdfs.addServiceComponent(NAMENODE).persist();
  hdfs.getServiceComponent(NAMENODE).addServiceComponentHost(DummyHostname1).persist();
  hdfs.addServiceComponent(SECONDARY_NAMENODE).persist();
  hdfs.getServiceComponent(SECONDARY_NAMENODE).addServiceComponentHost(DummyHostname1).persist();
  ActionQueue aq=new ActionQueue();
  ServiceComponentHost serviceComponentHost1=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(DATANODE).getServiceComponentHost(DummyHostname1);
  ServiceComponentHost serviceComponentHost2=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(NAMENODE).getServiceComponentHost(DummyHostname1);
  serviceComponentHost1.setState(State.INSTALLED);
  serviceComponentHost2.setState(State.INSTALLED);
  HeartBeat hb=new HeartBeat();
  hb.setResponseId(0);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setHostname(DummyHostname1);
  List<CommandReport> reports=new ArrayList<CommandReport>();
  CommandReport cr=new CommandReport();
  cr.setActionId(StageUtils.getActionId(requestId,stageId));
  cr.setServiceName(HDFS);
  cr.setTaskId(1);
  cr.setRole(DATANODE);
  cr.setStatus("COMPLETED");
  cr.setStdErr("");
  cr.setStdOut("");
  cr.setExitCode(215);
  cr.setRoleCommand("START");
  cr.setClusterName(DummyCluster);
  cr.setConfigurationTags(new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
);
  reports.add(cr);
  hb.setReports(reports);
  HostEntity host1=hostDAO.findByName(DummyHostname1);
  Assert.assertNotNull(host1);
  final HostRoleCommand command=hostRoleCommandFactory.create(DummyHostname1,Role.DATANODE,null,null);
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(new ArrayList<HostRoleCommand>(){
{
      add(command);
    }
  }
);
  replay(am);
  HeartBeatHandler handler=getHeartBeatHandler(am,aq);
  handler.handleHeartBeat(hb);
  Assert.assertNotNull(serviceComponentHost1.getActualConfigs());
  Assert.assertEquals(serviceComponentHost1.getActualConfigs().size(),1);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testRestartRequiredAfterInstallClient() throws Exception {
  Cluster cluster=getDummyCluster();
  Service hdfs=cluster.addService(HDFS);
  hdfs.persist();
  hdfs.addServiceComponent(HDFS_CLIENT).persist();
  hdfs.getServiceComponent(HDFS_CLIENT).addServiceComponentHost(DummyHostname1).persist();
  ActionQueue aq=new ActionQueue();
  ServiceComponentHost serviceComponentHost=clusters.getCluster(DummyCluster).getService(HDFS).getServiceComponent(HDFS_CLIENT).getServiceComponentHost(DummyHostname1);
  serviceComponentHost.setState(State.INSTALLED);
  serviceComponentHost.setRestartRequired(true);
  HeartBeat hb=new HeartBeat();
  hb.setResponseId(0);
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,DummyHostStatus));
  hb.setHostname(DummyHostname1);
  List<CommandReport> reports=new ArrayList<CommandReport>();
  CommandReport cr=new CommandReport();
  cr.setActionId(StageUtils.getActionId(requestId,stageId));
  cr.setServiceName(HDFS);
  cr.setRoleCommand("INSTALL");
  cr.setCustomCommand("EXECUTION_COMMAND");
  cr.setTaskId(1);
  cr.setRole(HDFS_CLIENT);
  cr.setStatus("COMPLETED");
  cr.setStdErr("");
  cr.setStdOut("");
  cr.setExitCode(215);
  cr.setClusterName(DummyCluster);
  cr.setConfigurationTags(new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
);
  reports.add(cr);
  hb.setReports(reports);
  final HostRoleCommand command=hostRoleCommandFactory.create(DummyHostname1,Role.DATANODE,null,null);
  ActionManager am=getMockActionManager();
  expect(am.getTasks(anyObject(List.class))).andReturn(new ArrayList<HostRoleCommand>(){
{
      add(command);
      add(command);
    }
  }
);
  replay(am);
  HeartBeatHandler handler=getHeartBeatHandler(am,aq);
  handler.handleHeartBeat(hb);
  Assert.assertNotNull(serviceComponentHost.getActualConfigs());
  Assert.assertFalse(serviceComponentHost.isRestartRequired());
  Assert.assertEquals(serviceComponentHost.getActualConfigs().size(),1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.AmbariErrorHandlerTest </h4><pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorWithJetty() throws Exception {
  Server server=new Server(0);
  Configuration configuration=new Configuration();
  ServletContextHandler root=new ServletContextHandler(server,"/",ServletContextHandler.SECURITY | ServletContextHandler.SESSIONS);
  root.addServlet(HelloServlet.class,"/hello");
  root.addServlet(DefaultServlet.class,"/");
  root.setErrorHandler(new AmbariErrorHandler(gson,configuration));
  server.start();
  Connector connector=server.getConnectors()[0];
  int localPort=((ServerConnector)connector).getLocalPort();
  Client client=new Client();
  WebResource resource=client.resource("http://localhost:" + localPort + "/");
  ClientResponse successResponse=resource.path("hello").get(ClientResponse.class);
  assertEquals(HttpServletResponse.SC_OK,successResponse.getStatus());
  ClientResponse failResponse=resource.path("fail").get(ClientResponse.class);
  assertEquals(HttpServletResponse.SC_NOT_FOUND,failResponse.getStatus());
  try {
    String response=failResponse.getEntity(String.class);
    System.out.println(response);
    Map map;
    map=gson.fromJson(response,Map.class);
    System.out.println(map);
    assertNotNull("Incorrect response status",map.get("status"));
    assertNotNull("Incorrect response message",map.get("message"));
  }
 catch (  JsonSyntaxException e1) {
    fail("Incorrect response");
  }
  server.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.handlers.CreateHandlerTest </h4><pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous() throws Exception {
  Request request=createNiceMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Query query=createStrictMock(Query.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createNiceMock(RequestStatus.class);
  Resource resource1=createNiceMock(Resource.class);
  Resource resource2=createNiceMock(Resource.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(null).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(resource.getQuery()).andReturn(query);
  query.setRenderer(renderer);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.isCreatable()).andReturn(true).anyTimes();
  expect(pm.create(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2);
  Result result=new TestCreateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.CREATED,result.getStatus().getStatus());
  verify(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Asynchronous() throws Exception {
  Request request=createNiceMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Query query=createStrictMock(Query.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createNiceMock(RequestStatus.class);
  Resource resource1=createNiceMock(Resource.class);
  Resource resource2=createNiceMock(Resource.class);
  Resource requestResource=createNiceMock(Resource.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(null).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(resource.getQuery()).andReturn(query);
  query.setRenderer(renderer);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.isCreatable()).andReturn(true).anyTimes();
  expect(pm.create(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Accepted);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(status.getRequestResource()).andReturn(requestResource).anyTimes();
  replay(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2,requestResource);
  Result result=new TestCreateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(2,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  TreeNode<Resource> statusNode=tree.getChild("request");
  assertNotNull(statusNode);
  assertEquals(0,statusNode.getChildren().size());
  assertSame(requestResource,statusNode.getObject());
  assertEquals(ResultStatus.STATUS.ACCEPTED,result.getStatus().getStatus());
  verify(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2,requestResource);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous_NoPropsInBody() throws Exception {
  Request request=createNiceMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Query query=createStrictMock(Query.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createNiceMock(RequestStatus.class);
  Resource resource1=createNiceMock(Resource.class);
  Resource resource2=createNiceMock(Resource.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(null).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(request.getBody()).andReturn(body);
  expect(resource.getQuery()).andReturn(query);
  query.setRenderer(renderer);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.isCreatable()).andReturn(true).anyTimes();
  expect(pm.create(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2);
  Result result=new TestCreateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.CREATED,result.getStatus().getStatus());
  verify(request,body,resource,resourceDefinition,query,pm,status,resource1,resource2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.handlers.DeleteHandlerTest </h4><pre class="type-13 type-10 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Asynchronous() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Resource requestResource=createMock(Resource.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).anyTimes();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(null).atLeastOnce();
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  query.setRenderer(renderer);
  expect(pm.delete(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Accepted);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(status.getRequestResource()).andReturn(requestResource).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,requestResource,query);
  Result result=new TestDeleteHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(2,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  TreeNode<Resource> statusNode=tree.getChild("request");
  assertNotNull(statusNode);
  assertEquals(0,statusNode.getChildren().size());
  assertSame(requestResource,statusNode.getObject());
  assertEquals(ResultStatus.STATUS.ACCEPTED,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,requestResource,query);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.delete(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
  Result result=new TestDeleteHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.OK,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous_NoPropsInBody() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.delete(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
  Result result=new TestDeleteHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.OK,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdempotentPersist() throws Exception {
  Request request=createNiceMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  PersistenceManager pm=createNiceMock(PersistenceManager.class);
  RequestStatus status=createNiceMock(RequestStatus.class);
  Resource resource1=createNiceMock(Resource.class);
  Resource requestResource=createNiceMock(Resource.class);
  ConfigGroupNotFoundException configGroupNotFoundException=createNiceMock(ConfigGroupNotFoundException.class);
  Query query=createNiceMock(Query.class);
  expect(request.getResource()).andReturn(resource).anyTimes();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(pm.delete(resource,body)).andThrow(new NoSuchResourceException("Configgroup not exist",configGroupNotFoundException));
  replay(request,body,resource,pm,status,resource1,requestResource,query);
  Result result=new TestDeleteHandler(pm).persist(resource,body);
  assertNotNull(result);
  assertEquals(ResultStatus.STATUS.ACCEPTED,result.getStatus().getStatus());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.handlers.UpdateHandlerTest </h4><pre class="type-13 type-10 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Asynchronous() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Resource requestResource=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).anyTimes();
  expect(request.getBody()).andReturn(body).anyTimes();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.update(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Accepted);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(status.getRequestResource()).andReturn(requestResource).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,requestResource,userPredicate,query);
  Result result=new TestUpdateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(2,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  TreeNode<Resource> statusNode=tree.getChild("request");
  assertNotNull(statusNode);
  assertEquals(0,statusNode.getChildren().size());
  assertSame(requestResource,statusNode.getObject());
  assertEquals(ResultStatus.STATUS.ACCEPTED,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,requestResource,userPredicate,query);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__AuthorizationFailure() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  Predicate userPredicate=createMock(Predicate.class);
  Query query=createMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  expect(request.getResource()).andReturn(resource).atLeastOnce();
  expect(request.getBody()).andReturn(body).atLeastOnce();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer).atLeastOnce();
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.update(resource,body)).andThrow(new AuthorizationException());
  replay(request,body,resource,pm,userPredicate,query);
  Result result=new TestUpdateHandler(pm).handleRequest(request);
  assertNotNull(result);
  assertEquals(ResultStatus.STATUS.FORBIDDEN,result.getStatus().getStatus());
  verify(request,body,resource,pm,userPredicate,query);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).anyTimes();
  expect(request.getBody()).andReturn(body).anyTimes();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.update(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
  Result result=new TestUpdateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.OK,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHandleRequest__Synchronous_NoPropsInBody() throws Exception {
  Request request=createMock(Request.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createMock(ResourceInstance.class);
  PersistenceManager pm=createStrictMock(PersistenceManager.class);
  RequestStatus status=createMock(RequestStatus.class);
  Resource resource1=createMock(Resource.class);
  Resource resource2=createMock(Resource.class);
  Predicate userPredicate=createNiceMock(Predicate.class);
  Query query=createNiceMock(Query.class);
  Renderer renderer=new DefaultRenderer();
  Set<Resource> setResources=new HashSet<Resource>();
  setResources.add(resource1);
  setResources.add(resource2);
  expect(request.getResource()).andReturn(resource).anyTimes();
  expect(request.getBody()).andReturn(body).anyTimes();
  expect(request.getQueryPredicate()).andReturn(userPredicate).atLeastOnce();
  expect(request.getRenderer()).andReturn(renderer);
  expect(resource.getQuery()).andReturn(query).atLeastOnce();
  query.setRenderer(renderer);
  query.setUserPredicate(userPredicate);
  expect(pm.update(resource,body)).andReturn(status);
  expect(status.getStatus()).andReturn(RequestStatus.Status.Complete);
  expect(status.getAssociatedResources()).andReturn(setResources);
  expect(resource1.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  expect(resource2.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
  Result result=new TestUpdateHandler(pm).handleRequest(request);
  assertNotNull(result);
  TreeNode<Resource> tree=result.getResultTree();
  assertEquals(1,tree.getChildren().size());
  TreeNode<Resource> resourcesNode=tree.getChild("resources");
  assertEquals(2,resourcesNode.getChildren().size());
  boolean foundResource1=false;
  boolean foundResource2=false;
  for (  TreeNode<Resource> child : resourcesNode.getChildren()) {
    Resource r=child.getObject();
    if (r == resource1 && !foundResource1) {
      foundResource1=true;
    }
 else     if (r == resource2 && !foundResource2) {
      foundResource2=true;
    }
 else {
      fail();
    }
  }
  assertEquals(ResultStatus.STATUS.OK,result.getStatus().getStatus());
  verify(request,body,resource,pm,status,resource1,resource2,userPredicate,query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.predicate.QueryParserTest </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testParse_noTokens() throws InvalidQueryException {
  assertNull(new QueryParser().parse(new Token[0]));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.QueryImplTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddProperty__allCategoryProperties() throws Exception {
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Host).anyTimes();
  Set<SubResourceDefinition> setChildren=new HashSet<SubResourceDefinition>();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(setChildren).anyTimes();
  replay(resourceDefinition);
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addLocalProperty("c1");
  Result result=instance.execute();
  verify(resourceDefinition);
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(4,tree.getChildren().size());
  TreeNode<Resource> hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p2"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p3"));
  hostNode=tree.getChild("Host:2");
  Assert.assertEquals("Host:2",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p2"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p3"));
  hostNode=tree.getChild("Host:3");
  Assert.assertEquals("Host:3",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p2"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p3"));
  hostNode=tree.getChild("Host:4");
  Assert.assertEquals("Host:4",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p2"));
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p3"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddProperty__localProperty() throws Exception {
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Map<Resource.Type,String> mapIds=new HashMap<Resource.Type,String>();
  expect(resourceDefinition.getType()).andReturn(Resource.Type.Host).anyTimes();
  Set<SubResourceDefinition> setChildren=new HashSet<SubResourceDefinition>();
  expect(resourceDefinition.getSubResourceDefinitions()).andReturn(setChildren).anyTimes();
  replay(resourceDefinition);
  QueryImpl instance=new TestQuery(mapIds,resourceDefinition);
  instance.addLocalProperty("c1/p1");
  Result result=instance.execute();
  verify(resourceDefinition);
  TreeNode<Resource> tree=result.getResultTree();
  Assert.assertEquals(4,tree.getChildren().size());
  TreeNode<Resource> hostNode=tree.getChild("Host:1");
  Assert.assertEquals("Host:1",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  hostNode=tree.getChild("Host:2");
  Assert.assertEquals("Host:2",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  hostNode=tree.getChild("Host:3");
  Assert.assertEquals("Host:3",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
  hostNode=tree.getChild("Host:4");
  Assert.assertEquals("Host:4",hostNode.getName());
  Assert.assertEquals(Resource.Type.Host,hostNode.getObject().getType());
  Assert.assertNotNull(hostNode.getObject().getPropertyValue("c1/p1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.render.ClusterBlueprintRendererTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResultWithAttributes() throws Exception {
  ServiceInfo hdfsService=new ServiceInfo();
  hdfsService.setName("HDFS");
  ServiceInfo mrService=new ServiceInfo();
  mrService.setName("MAPREDUCE");
  Result result=new ResultImpl(true);
  Map<String,Object> testDesiredConfigMap=new HashMap<String,Object>();
  DesiredConfig testDesiredConfig=new DesiredConfig();
  testDesiredConfig.setTag("test-tag-one");
  testDesiredConfigMap.put("test-type-one",testDesiredConfig);
  createClusterResultTree(result.getResultTree(),testDesiredConfigMap);
  ClusterBlueprintRenderer renderer=new TestBlueprintRenderer(topology);
  Result blueprintResult=renderer.finalizeResult(result);
  TreeNode<Resource> blueprintTree=blueprintResult.getResultTree();
  assertNull(blueprintTree.getStringProperty("isCollection"));
  assertEquals(1,blueprintTree.getChildren().size());
  TreeNode<Resource> blueprintNode=blueprintTree.getChildren().iterator().next();
  assertEquals(0,blueprintNode.getChildren().size());
  Resource blueprintResource=blueprintNode.getObject();
  Map<String,Map<String,Object>> properties=blueprintResource.getPropertiesMap();
  assertEquals("HDP",properties.get("Blueprints").get("stack_name"));
  assertEquals("1.3.3",properties.get("Blueprints").get("stack_version"));
  Collection<Map<String,Object>> host_groups=(Collection<Map<String,Object>>)properties.get("").get("host_groups");
  assertEquals(2,host_groups.size());
  for (  Map<String,Object> hostGroupProperties : host_groups) {
    String host_group_name=(String)hostGroupProperties.get("name");
    if (host_group_name.equals("host_group_1")) {
      assertEquals("1",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(5,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("JOBTRACKER","TASKTRACKER","NAMENODE","DATANODE","AMBARI_SERVER"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
 else     if (host_group_name.equals("host_group_2")) {
      assertEquals("2",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(2,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("TASKTRACKER","DATANODE"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
  }
  List<Map<String,Map<String,Map<String,?>>>> configurationsResult=(List<Map<String,Map<String,Map<String,?>>>>)blueprintResource.getPropertyValue("configurations");
  assertEquals("Incorrect number of config maps added",1,configurationsResult.size());
  Map<String,Map<String,?>> configMap=configurationsResult.iterator().next().get("test-type-one");
  assertNotNull("Expected config map was not included",configMap);
  assertEquals("Incorrect number of maps added under expected type",2,configMap.size());
  assertTrue("Expected properties map was not found",configMap.containsKey("properties"));
  assertTrue("Expected properties_attributes map was not found",configMap.containsKey("properties_attributes"));
  Map<String,?> propertiesResult=configMap.get("properties");
  assertEquals("Incorrect number of config properties found",1,propertiesResult.size());
  Map<String,?> attributesResult=configMap.get("properties_attributes");
  assertEquals("Incorrect number of config attributes found",1,attributesResult.size());
  assertEquals("Incorrect property value included","valueOne",propertiesResult.get("propertyOne"));
  assertNotNull("Expected attribute not found in exported Blueprint",attributesResult.get("final"));
  assertTrue("Attribute type map was not included",attributesResult.get("final") instanceof Map);
  Map<String,?> finalMap=(Map<String,?>)attributesResult.get("final");
  assertEquals("Attribute value is not correct","true",finalMap.get("propertyOne"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance(){
  QueryInfo rootQuery=new QueryInfo(new ClusterResourceDefinition(),new HashSet<String>());
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Cluster");
  rootQuery.getProperties().add("foo/bar");
  rootQuery.getProperties().add("prop1");
  QueryInfo hostInfo=new QueryInfo(new HostResourceDefinition(),new HashSet<String>());
  queryTree.addChild(hostInfo,"Host");
  QueryInfo hostComponentInfo=new QueryInfo(new HostComponentResourceDefinition(),new HashSet<String>());
  queryTree.getChild("Host").addChild(hostComponentInfo,"HostComponent");
  ClusterBlueprintRenderer renderer=new ClusterBlueprintRenderer();
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  Set<String> rootProperties=propertyTree.getObject();
  assertEquals(2,rootProperties.size());
  assertNotNull(propertyTree.getChild("Host"));
  assertTrue(propertyTree.getChild("Host").getObject().isEmpty());
  assertNotNull(propertyTree.getChild("Host/HostComponent"));
  assertEquals(1,propertyTree.getChild("Host/HostComponent").getObject().size());
  assertTrue(propertyTree.getChild("Host/HostComponent").getObject().contains("HostRoles/component_name"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeProperties__instance_noComponentNode(){
  QueryInfo rootQuery=new QueryInfo(new ClusterResourceDefinition(),new HashSet<String>());
  TreeNode<QueryInfo> queryTree=new TreeNodeImpl<QueryInfo>(null,rootQuery,"Cluster");
  rootQuery.getProperties().add("foo/bar");
  rootQuery.getProperties().add("prop1");
  ClusterBlueprintRenderer renderer=new ClusterBlueprintRenderer();
  TreeNode<Set<String>> propertyTree=renderer.finalizeProperties(queryTree,false);
  Set<String> rootProperties=propertyTree.getObject();
  assertEquals(2,rootProperties.size());
  assertNotNull(propertyTree.getChild("Host"));
  assertTrue(propertyTree.getChild("Host").getObject().isEmpty());
  assertNotNull(propertyTree.getChild("Host/HostComponent"));
  assertEquals(1,propertyTree.getChild("Host/HostComponent").getObject().size());
  assertTrue(propertyTree.getChild("Host/HostComponent").getObject().contains("HostRoles/component_name"));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResult() throws Exception {
  Result result=new ResultImpl(true);
  createClusterResultTree(result.getResultTree());
  ClusterBlueprintRenderer renderer=new TestBlueprintRenderer(topology);
  Result blueprintResult=renderer.finalizeResult(result);
  TreeNode<Resource> blueprintTree=blueprintResult.getResultTree();
  assertNull(blueprintTree.getStringProperty("isCollection"));
  assertEquals(1,blueprintTree.getChildren().size());
  TreeNode<Resource> blueprintNode=blueprintTree.getChildren().iterator().next();
  assertEquals(0,blueprintNode.getChildren().size());
  Resource blueprintResource=blueprintNode.getObject();
  Map<String,Map<String,Object>> properties=blueprintResource.getPropertiesMap();
  assertEquals("HDP",properties.get("Blueprints").get("stack_name"));
  assertEquals("1.3.3",properties.get("Blueprints").get("stack_version"));
  Collection<Map<String,Object>> host_groups=(Collection<Map<String,Object>>)properties.get("").get("host_groups");
  assertEquals(2,host_groups.size());
  for (  Map<String,Object> hostGroupProperties : host_groups) {
    String host_group_name=(String)hostGroupProperties.get("name");
    if (host_group_name.equals("host_group_1")) {
      assertEquals("1",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(5,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("JOBTRACKER","TASKTRACKER","NAMENODE","DATANODE","AMBARI_SERVER"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
 else     if (host_group_name.equals("host_group_2")) {
      assertEquals("2",hostGroupProperties.get("cardinality"));
      Collection<Map<String,String>> components=(Collection<Map<String,String>>)hostGroupProperties.get("components");
      assertEquals(2,components.size());
      Set<String> expectedValues=new HashSet<String>(Arrays.asList("TASKTRACKER","DATANODE"));
      Set<String> actualValues=new HashSet<String>();
      for (      Map<String,String> componentProperties : components) {
        assertEquals(1,componentProperties.size());
        actualValues.add(componentProperties.get("name"));
      }
      assertEquals(expectedValues,actualValues);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResult_kerberos() throws Exception {
  setupMocksForKerberosEnabledCluster();
  Result result=new ResultImpl(true);
  createClusterResultTree(result.getResultTree());
  ClusterBlueprintRenderer renderer=new TestBlueprintRenderer(topology);
  Result blueprintResult=renderer.finalizeResult(result);
  TreeNode<Resource> blueprintTree=blueprintResult.getResultTree();
  assertNull(blueprintTree.getStringProperty("isCollection"));
  assertEquals(1,blueprintTree.getChildren().size());
  TreeNode<Resource> blueprintNode=blueprintTree.getChildren().iterator().next();
  assertEquals(0,blueprintNode.getChildren().size());
  Resource blueprintResource=blueprintNode.getObject();
  Map<String,Map<String,Object>> properties=blueprintResource.getPropertiesMap();
  assertEquals("HDP",properties.get("Blueprints").get("stack_name"));
  assertEquals("1.3.3",properties.get("Blueprints").get("stack_version"));
  Map<String,Object> securityProperties=(Map<String,Object>)properties.get("Blueprints").get("security");
  assertEquals("KERBEROS",securityProperties.get("type"));
  assertNotNull(((Map<String,Object>)securityProperties.get("kerberos_descriptor")).get("properties"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.query.render.MinimalRendererTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResult_propsSetOnSubResource() throws Exception {
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema clusterSchema=createNiceMock(Schema.class);
  Schema hostSchema=createNiceMock(Schema.class);
  Schema hostComponentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Cluster)).andReturn(clusterSchema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Host)).andReturn(hostSchema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.HostComponent)).andReturn(hostComponentSchema).anyTimes();
  expect(clusterSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Clusters/cluster_name").anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Hosts/cluster_name").anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Host)).andReturn("Hosts/host_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("HostRoles/cluster_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.Host)).andReturn("HostRoles/host_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.HostComponent)).andReturn("HostRoles/component_name").anyTimes();
  replay(schemaFactory,clusterSchema,hostSchema,hostComponentSchema);
  Result result=new ResultImpl(true);
  createResultTree(result.getResultTree());
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  renderer.finalizeProperties(createPropertyTreeWithSubProps(),false);
  TreeNode<Resource> resultTree=renderer.finalizeResult(result).getResultTree();
  assertNull(resultTree.getStringProperty("isCollection"));
  assertEquals(1,resultTree.getChildren().size());
  TreeNode<Resource> clusterNode=resultTree.getChildren().iterator().next();
  Resource clusterResource=clusterNode.getObject();
  Map<String,Map<String,Object>> clusterProperties=clusterResource.getPropertiesMap();
  assertEquals(2,clusterProperties.size());
  assertEquals(3,clusterProperties.get("Clusters").size());
  assertEquals("testCluster",clusterProperties.get("Clusters").get("cluster_name"));
  assertEquals("HDP-1.3.3",clusterProperties.get("Clusters").get("version"));
  assertEquals("value1",clusterProperties.get("Clusters").get("prop1"));
  assertEquals(1,clusterProperties.get("").size());
  assertEquals("bar",clusterProperties.get("").get("foo"));
  TreeNode<Resource> hosts=clusterNode.getChildren().iterator().next();
  for (  TreeNode<Resource> hostNode : hosts.getChildren()) {
    Resource hostResource=hostNode.getObject();
    Map<String,Map<String,Object>> hostProperties=hostResource.getPropertiesMap();
    assertEquals(2,hostProperties.size());
    assertEquals(1,hostProperties.get("Hosts").size());
    assertTrue(hostProperties.get("Hosts").containsKey("host_name"));
    assertEquals(1,hostProperties.get("").size());
    assertEquals("bar",hostProperties.get("").get("foo"));
    for (    TreeNode<Resource> componentNode : hostNode.getChildren().iterator().next().getChildren()) {
      Resource componentResource=componentNode.getObject();
      Map<String,Map<String,Object>> componentProperties=componentResource.getPropertiesMap();
      assertEquals(1,componentProperties.size());
      assertEquals(1,componentProperties.get("HostRoles").size());
      assertTrue(componentProperties.get("HostRoles").containsKey("component_name"));
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeResult() throws Exception {
  SchemaFactory schemaFactory=createNiceMock(SchemaFactory.class);
  Schema clusterSchema=createNiceMock(Schema.class);
  Schema hostSchema=createNiceMock(Schema.class);
  Schema hostComponentSchema=createNiceMock(Schema.class);
  expect(schemaFactory.getSchema(Resource.Type.Cluster)).andReturn(clusterSchema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.Host)).andReturn(hostSchema).anyTimes();
  expect(schemaFactory.getSchema(Resource.Type.HostComponent)).andReturn(hostComponentSchema).anyTimes();
  expect(clusterSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Clusters/cluster_name").anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("Hosts/cluster_name").anyTimes();
  expect(hostSchema.getKeyPropertyId(Resource.Type.Host)).andReturn("Hosts/host_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.Cluster)).andReturn("HostRoles/cluster_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.Host)).andReturn("HostRoles/host_name").anyTimes();
  expect(hostComponentSchema.getKeyPropertyId(Resource.Type.HostComponent)).andReturn("HostRoles/component_name").anyTimes();
  replay(schemaFactory,clusterSchema,hostSchema,hostComponentSchema);
  Result result=new ResultImpl(true);
  createResultTree(result.getResultTree());
  MinimalRenderer renderer=new MinimalRenderer();
  renderer.init(schemaFactory);
  renderer.finalizeProperties(createPropertyTree(),false);
  TreeNode<Resource> resultTree=renderer.finalizeResult(result).getResultTree();
  assertNull(resultTree.getStringProperty("isCollection"));
  assertEquals(1,resultTree.getChildren().size());
  TreeNode<Resource> clusterNode=resultTree.getChildren().iterator().next();
  Resource clusterResource=clusterNode.getObject();
  Map<String,Map<String,Object>> clusterProperties=clusterResource.getPropertiesMap();
  assertEquals(2,clusterProperties.size());
  assertEquals(3,clusterProperties.get("Clusters").size());
  assertEquals("testCluster",clusterProperties.get("Clusters").get("cluster_name"));
  assertEquals("HDP-1.3.3",clusterProperties.get("Clusters").get("version"));
  assertEquals("value1",clusterProperties.get("Clusters").get("prop1"));
  assertEquals(1,clusterProperties.get("").size());
  assertEquals("bar",clusterProperties.get("").get("foo"));
  TreeNode<Resource> hosts=clusterNode.getChildren().iterator().next();
  for (  TreeNode<Resource> hostNode : hosts.getChildren()) {
    Resource hostResource=hostNode.getObject();
    Map<String,Map<String,Object>> hostProperties=hostResource.getPropertiesMap();
    assertEquals(1,hostProperties.size());
    assertEquals(1,hostProperties.get("Hosts").size());
    assertTrue(hostProperties.get("Hosts").containsKey("host_name"));
    for (    TreeNode<Resource> componentNode : hostNode.getChildren().iterator().next().getChildren()) {
      Resource componentResource=componentNode.getObject();
      Map<String,Map<String,Object>> componentProperties=componentResource.getPropertiesMap();
      assertEquals(1,componentProperties.size());
      assertEquals(1,componentProperties.get("HostRoles").size());
      assertTrue(componentProperties.get("HostRoles").containsKey("component_name"));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.resources.ResourceInstanceFactoryImplTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostKerberosIdentityDefinition(){
  ResourceDefinition resourceDefinition=ResourceInstanceFactoryImpl.getResourceDefinition(Resource.Type.HostKerberosIdentity,null);
  assertNotNull(resourceDefinition);
  assertEquals("kerberos_identity",resourceDefinition.getSingularName());
  assertEquals("kerberos_identities",resourceDefinition.getPluralName());
  assertEquals(Resource.Type.HostKerberosIdentity,resourceDefinition.getType());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetUserAuthorizationDefinition(){
  ResourceDefinition resourceDefinition=ResourceInstanceFactoryImpl.getResourceDefinition(Resource.Type.UserAuthorization,null);
  assertNotNull(resourceDefinition);
  assertEquals("authorization",resourceDefinition.getSingularName());
  assertEquals("authorizations",resourceDefinition.getPluralName());
  assertEquals(Resource.Type.UserAuthorization,resourceDefinition.getType());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRoleAuthorizationDefinition(){
  ResourceDefinition resourceDefinition=ResourceInstanceFactoryImpl.getResourceDefinition(Resource.Type.RoleAuthorization,null);
  assertNotNull(resourceDefinition);
  assertEquals("authorization",resourceDefinition.getSingularName());
  assertEquals("authorizations",resourceDefinition.getPluralName());
  assertEquals(Resource.Type.RoleAuthorization,resourceDefinition.getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.AmbariMetaInfoTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryUpdatedBaseUrl() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  TestAmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  String newBaseUrl="http://myprivate-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.0.6.0";
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,"2.1.1","redhat6",HDP_REPO_ID,newBaseUrl);
  RepositoryInfo repoInfo=ambariMetaInfo.getRepository(STACK_NAME_HDP,"2.1.1","redhat6",HDP_REPO_ID);
  assertEquals(newBaseUrl,repoInfo.getBaseUrl());
  String prevBaseUrl=repoInfo.getDefaultBaseUrl();
  MetainfoDAO metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  MetainfoEntity entity=createNiceMock(MetainfoEntity.class);
  expect(metainfoDAO.findByKey("repo:/HDP/2.1.1/redhat6/HDP-2.1.1:baseurl")).andReturn(entity).atLeastOnce();
  expect(entity.getMetainfoValue()).andReturn(newBaseUrl).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.init();
  waitForAllReposToBeResolved(ambariMetaInfo);
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (HDP_REPO_NAME.equals(ri.getRepoName())) {
      assertEquals(newBaseUrl,ri.getBaseUrl());
      assertFalse(ri.getBaseUrl().equals(ri.getDefaultBaseUrl()));
    }
  }
  Capture<MetainfoEntity> c=new Capture<MetainfoEntity>();
  metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  reset(entity);
  expect(metainfoDAO.findByKey("repo:/HDP/2.1.1/redhat6/HDP-2.1.1:baseurl")).andReturn(entity).atLeastOnce();
  expect(metainfoDAO.merge(EasyMock.capture(c))).andReturn(entity).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,"2.1.1","redhat6",HDP_REPO_ID,prevBaseUrl);
  assertEquals(prevBaseUrl,c.getValue().getMetainfoValue());
  assertTrue(repoInfo.isBaseUrlFromSaved());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryDefault() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  AmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  ambariMetaInfo.init();
  waitForAllReposToBeResolved(ambariMetaInfo);
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (STACK_NAME_HDP.equals(ri.getRepoName())) {
      assertFalse(ri.getBaseUrl().equals(ri.getDefaultBaseUrl()));
      assertEquals(ri.getBaseUrl(),ri.getLatestBaseUrl());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Method: Map<String, ServiceInfo> getServices(String stackName, String
 * version, String serviceName)
 * @throws AmbariException
 */
@Test public void getServices() throws AmbariException {
  Map<String,ServiceInfo> services=metaInfo.getServices(STACK_NAME_HDP,STACK_VERSION_HDP);
  LOG.info("Getting all the services ");
  for (  Map.Entry<String,ServiceInfo> entry : services.entrySet()) {
    LOG.info("Service Name " + entry.getKey() + " values "+ entry.getValue());
  }
  assertTrue(services.containsKey("HDFS"));
  assertTrue(services.containsKey("MAPREDUCE"));
  assertNotNull(services);
  assertFalse(services.keySet().size() == 0);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHive134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HIVE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(4,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("HIVE_METASTORE")) {
      Assert.assertEquals(0,component.getDependencies().size());
      AutoDeployInfo autoDeploy=component.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("HIVE/HIVE_SERVER",autoDeploy.getCoLocate());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("HIVE_SERVER")) {
      List<DependencyInfo> dependencyList=component.getDependencies();
      Assert.assertEquals(1,dependencyList.size());
      DependencyInfo dependency=dependencyList.get(0);
      Assert.assertEquals("ZOOKEEPER/ZOOKEEPER_SERVER",dependency.getName());
      Assert.assertEquals("cluster",dependency.getScope());
      AutoDeployInfo autoDeploy=dependency.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("HIVE/HIVE_SERVER",autoDeploy.getCoLocate());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("MYSQL_SERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      AutoDeployInfo autoDeploy=component.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("HIVE/HIVE_SERVER",autoDeploy.getCoLocate());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("HIVE_CLIENT")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepos() throws Exception {
  Map<String,List<RepositoryInfo>> repos=metaInfo.getRepository(STACK_NAME_HDP,STACK_VERSION_HDP);
  Set<String> centos5Cnt=new HashSet<String>();
  Set<String> centos6Cnt=new HashSet<String>();
  Set<String> redhat6cnt=new HashSet<String>();
  Set<String> redhat5cnt=new HashSet<String>();
  for (  List<RepositoryInfo> vals : repos.values()) {
    for (    RepositoryInfo repo : vals) {
      LOG.debug("Dumping repo info : " + repo.toString());
      if (repo.getOsType().equals("centos5")) {
        centos5Cnt.add(repo.getRepoId());
      }
 else       if (repo.getOsType().equals("centos6")) {
        centos6Cnt.add(repo.getRepoId());
      }
 else       if (repo.getOsType().equals("redhat6")) {
        redhat6cnt.add(repo.getRepoId());
      }
 else       if (repo.getOsType().equals("redhat5")) {
        redhat5cnt.add(repo.getRepoId());
      }
 else {
        fail("Found invalid os " + repo.getOsType());
      }
      if (repo.getRepoId().equals("epel")) {
        assertFalse(repo.getMirrorsList().isEmpty());
        assertNull(repo.getBaseUrl());
      }
 else {
        assertNull(repo.getMirrorsList());
        assertFalse(repo.getBaseUrl().isEmpty());
      }
    }
  }
  assertEquals(3,centos5Cnt.size());
  assertEquals(3,redhat6cnt.size());
  assertEquals(3,redhat5cnt.size());
  assertEquals(3,centos6Cnt.size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigDependencies() throws Exception {
  ServiceInfo serviceInfo=metaInfo.getService(STACK_NAME_HDP,EXT_STACK_NAME,SERVICE_NAME_MAPRED2);
  assertNotNull(serviceInfo);
  assertTrue(!serviceInfo.getConfigDependencies().isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaInfoFileFilter() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  File stackRoot=new File("src/test/resources/stacks");
  File version=new File("src/test/resources/version");
  if (System.getProperty("os.name").contains("Windows")) {
    stackRoot=new File(ClassLoader.getSystemClassLoader().getResource("stacks").getPath());
    version=new File(new File(ClassLoader.getSystemClassLoader().getResource("").getPath()).getParent(),"version");
  }
  File stackRootTmp=new File(buildDir + "/ambari-metaInfo");
  stackRootTmp.mkdir();
  FileUtils.copyDirectory(stackRoot,stackRootTmp);
  AmbariMetaInfo ambariMetaInfo=createAmbariMetaInfo(stackRootTmp,version);
  File f1, f2, f3;
  f1=new File(stackRootTmp.getAbsolutePath() + "/001.svn");
  f1.createNewFile();
  f2=new File(stackRootTmp.getAbsolutePath() + "/abcd.svn/001.svn");
  f2.mkdirs();
  f2.createNewFile();
  f3=new File(stackRootTmp.getAbsolutePath() + "/.svn");
  if (!f3.exists()) {
    f3.createNewFile();
  }
  ambariMetaInfo.init();
  getServices();
  getComponentsByService();
  Assert.assertNotNull(ambariMetaInfo.getStack("abcd.svn","001.svn"));
  Assert.assertFalse(ambariMetaInfo.isSupportedStack(".svn",""));
  Assert.assertFalse(ambariMetaInfo.isSupportedStack(".svn",""));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetricsJson() throws Exception {
  ServiceInfo svc=metaInfo.getService(STACK_NAME_HDP,"2.0.5","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getMetricsFile());
  svc=metaInfo.getService(STACK_NAME_HDP,"2.0.6","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getMetricsFile());
  List<MetricDefinition> list=metaInfo.getMetrics(STACK_NAME_HDP,"2.0.5","HDFS",SERVICE_COMPONENT_NAME,Resource.Type.Component.name());
  Assert.assertNotNull(list);
  list=metaInfo.getMetrics(STACK_NAME_HDP,"2.0.5","HDFS","DATANODE",Resource.Type.Component.name());
  Assert.assertNull(list);
  List<MetricDefinition> list0=metaInfo.getMetrics(STACK_NAME_HDP,"2.0.5","HDFS","DATANODE",Resource.Type.Component.name());
  Assert.assertNull(list0);
  Assert.assertTrue("Expecting subsequent calls to use a cached value for the definition",list == list0);
  list=metaInfo.getMetrics(STACK_NAME_HDP,"2.0.6","HDFS","DATANODE",Resource.Type.Component.name());
  Assert.assertNull(list);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPasswordPropertyAttribute() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"2.0.1","HIVE");
  List<PropertyInfo> propertyInfoList=service.getProperties();
  Assert.assertNotNull(propertyInfoList);
  PropertyInfo passwordProperty=null;
  for (  PropertyInfo propertyInfo : propertyInfoList) {
    if (propertyInfo.isRequireInput() && propertyInfo.getPropertyTypes().contains(PropertyInfo.PropertyType.PASSWORD)) {
      passwordProperty=propertyInfo;
    }
 else {
      Assert.assertTrue(propertyInfo.getPropertyTypes().isEmpty());
    }
  }
  Assert.assertNotNull(passwordProperty);
  Assert.assertEquals("javax.jdo.option.ConnectionPassword",passwordProperty.getName());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getComponentsByService() throws AmbariException {
  List<ComponentInfo> components=metaInfo.getComponentsByService(STACK_NAME_HDP,STACK_VERSION_HDP,SERVICE_NAME_HDFS);
  assertNotNull(components);
  assertTrue(components.size() > 0);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosDescriptor() throws Exception {
  ServiceInfo service;
  service=metaInfo.getService(STACK_NAME_HDP,"2.1.1","PIG");
  Assert.assertNotNull(service);
  Assert.assertNull(service.getKerberosDescriptorFile());
  service=metaInfo.getService(STACK_NAME_HDP,"2.0.8","HDFS");
  Assert.assertNotNull(service);
  Assert.assertNotNull(service.getKerberosDescriptorFile());
  service=metaInfo.getService(STACK_NAME_HDP,"2.1.1","HDFS");
  Assert.assertNotNull(service);
  Assert.assertNotNull(service.getKerberosDescriptorFile());
  Map<?,?> kerberosDescriptorData=new Gson().fromJson(new FileReader(service.getKerberosDescriptorFile()),Map.class);
  Assert.assertNotNull(kerberosDescriptorData);
  Assert.assertEquals(1,kerberosDescriptorData.size());
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHBase134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HBASE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(3,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("HBASE_MASTER")) {
      List<DependencyInfo> dependencyList=component.getDependencies();
      Assert.assertEquals(2,dependencyList.size());
      for (      DependencyInfo dependency : dependencyList) {
        if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else         if (dependency.getName().equals("ZOOKEEPER/ZOOKEEPER_SERVER")) {
          Assert.assertEquals("cluster",dependency.getScope());
          AutoDeployInfo autoDeploy=dependency.getAutoDeploy();
          Assert.assertEquals(true,autoDeploy.isEnabled());
          Assert.assertEquals("HBASE/HBASE_MASTER",autoDeploy.getCoLocate());
        }
 else {
          Assert.fail("Unexpected dependency");
        }
      }
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("HBASE_REGIONSERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1+",component.getCardinality());
    }
    if (name.equals("HBASE_CLIENT")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetKerberosDescriptor() throws AmbariException {
  KerberosDescriptor descriptor=metaInfo.getKerberosDescriptor(STACK_NAME_HDP,"2.0.8");
  Assert.assertNotNull(descriptor);
  Assert.assertNotNull(descriptor.getProperties());
  Assert.assertEquals(3,descriptor.getProperties().size());
  Assert.assertNotNull(descriptor.getIdentities());
  Assert.assertEquals(1,descriptor.getIdentities().size());
  Assert.assertEquals("spnego",descriptor.getIdentities().get(0).getName());
  Assert.assertNotNull(descriptor.getConfigurations());
  Assert.assertEquals(1,descriptor.getConfigurations().size());
  Assert.assertNotNull(descriptor.getConfigurations().get("core-site"));
  Assert.assertNotNull(descriptor.getConfiguration("core-site"));
  Assert.assertNotNull(descriptor.getServices());
  Assert.assertEquals(1,descriptor.getServices().size());
  Assert.assertNotNull(descriptor.getServices().get("HDFS"));
  Assert.assertNotNull(descriptor.getService("HDFS"));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSqoop134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","SQOOP");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("SQOOP",component.getName());
  List<DependencyInfo> dependencyList=component.getDependencies();
  Assert.assertEquals(2,dependencyList.size());
  for (  DependencyInfo dependency : dependencyList) {
    if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else     if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else {
      Assert.fail("Unexpected dependency");
    }
  }
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("0+",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPig134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","PIG");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("PIG",component.getName());
  Assert.assertEquals(0,component.getDependencies().size());
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("0+",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWebHCat134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","WEBHCAT");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("WEBHCAT_SERVER",component.getName());
  List<DependencyInfo> dependencyList=component.getDependencies();
  Assert.assertEquals(4,dependencyList.size());
  for (  DependencyInfo dependency : dependencyList) {
    if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else     if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else     if (dependency.getName().equals("ZOOKEEPER/ZOOKEEPER_SERVER")) {
      Assert.assertEquals("cluster",dependency.getScope());
      AutoDeployInfo autoDeploy=dependency.getAutoDeploy();
      Assert.assertEquals(true,autoDeploy.isEnabled());
      Assert.assertEquals("WEBHCAT/WEBHCAT_SERVER",autoDeploy.getCoLocate());
    }
 else     if (dependency.getName().equals("ZOOKEEPER/ZOOKEEPER_CLIENT")) {
      Assert.assertEquals("host",dependency.getScope());
      Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
    }
 else {
      Assert.fail("Unexpected dependency");
    }
  }
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("1",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getRepository() throws AmbariException {
  Map<String,List<RepositoryInfo>> repository=metaInfo.getRepository(STACK_NAME_HDP,STACK_VERSION_HDP);
  assertNotNull(repository);
  assertFalse(repository.get("centos5").isEmpty());
  assertFalse(repository.get("centos6").isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExtendedStackDefinition() throws Exception {
  StackInfo stackInfo=metaInfo.getStack(STACK_NAME_HDP,EXT_STACK_NAME);
  Assert.assertTrue(stackInfo != null);
  Collection<ServiceInfo> serviceInfos=stackInfo.getServices();
  Assert.assertFalse(serviceInfos.isEmpty());
  Assert.assertTrue(serviceInfos.size() > 1);
  ServiceInfo deletedService=null;
  ServiceInfo redefinedService=null;
  for (  ServiceInfo serviceInfo : serviceInfos) {
    if (serviceInfo.getName().equals("SQOOP")) {
      deletedService=serviceInfo;
    }
    if (serviceInfo.getName().equals("YARN")) {
      redefinedService=serviceInfo;
    }
  }
  Assert.assertNull("SQOOP is a deleted service, should not be a part of " + "the extended stack.",deletedService);
  Assert.assertNotNull(redefinedService);
  Assert.assertEquals("YARN service is expected to be defined with 3 active" + " components.",3,redefinedService.getComponents().size());
  Assert.assertEquals("TEZ is expected to be a part of extended stack " + "definition","TEZ",redefinedService.getClientComponent().getName());
  Assert.assertFalse("YARN CLIENT is a deleted component.",redefinedService.getClientComponent().getName().equals("YARN_CLIENT"));
  Assert.assertNotNull(redefinedService.getProperties());
  Assert.assertTrue(redefinedService.getProperties().size() > 4);
  PropertyInfo deleteProperty1=null;
  PropertyInfo deleteProperty2=null;
  PropertyInfo redefinedProperty1=null;
  PropertyInfo redefinedProperty2=null;
  PropertyInfo redefinedProperty3=null;
  PropertyInfo inheritedProperty=null;
  PropertyInfo newProperty=null;
  PropertyInfo newEnhancedProperty=null;
  PropertyInfo propertyWithExtraValueAttributes=null;
  PropertyInfo originalProperty=null;
  PropertyDependencyInfo propertyDependencyInfo=new PropertyDependencyInfo("yarn-site","new-enhanced-yarn-property");
  for (  PropertyInfo propertyInfo : redefinedService.getProperties()) {
    if (propertyInfo.getName().equals("yarn.resourcemanager.resource-tracker.address")) {
      deleteProperty1=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.resourcemanager.scheduler.address")) {
      deleteProperty2=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.resourcemanager.address")) {
      redefinedProperty1=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.resourcemanager.admin.address")) {
      redefinedProperty2=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.nodemanager.health-checker.interval-ms")) {
      redefinedProperty3=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.nodemanager.address")) {
      inheritedProperty=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("new-yarn-property")) {
      newProperty=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("new-enhanced-yarn-property")) {
      newEnhancedProperty=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("yarn.nodemanager.aux-services")) {
      originalProperty=propertyInfo;
    }
 else     if (propertyInfo.getName().equals("property.with.extra.value.attributes")) {
      propertyWithExtraValueAttributes=propertyInfo;
    }
  }
  Assert.assertNull(deleteProperty1);
  Assert.assertNull(deleteProperty2);
  Assert.assertNotNull(redefinedProperty1);
  Assert.assertNotNull(redefinedProperty2);
  Assert.assertNotNull("yarn.nodemanager.address expected to be inherited " + "from parent",inheritedProperty);
  Assert.assertEquals("localhost:100009",redefinedProperty1.getValue());
  Assert.assertNotNull(redefinedProperty3);
  Assert.assertEquals("135000",redefinedProperty3.getValue());
  Assert.assertEquals("",redefinedProperty2.getValue());
  Assert.assertNotNull(newProperty);
  Assert.assertEquals("some-value",newProperty.getValue());
  Assert.assertEquals("some description.",newProperty.getDescription());
  Assert.assertEquals("yarn-site.xml",newProperty.getFilename());
  Assert.assertEquals(1,newProperty.getDependedByProperties().size());
  Assert.assertTrue(newProperty.getDependedByProperties().contains(propertyDependencyInfo));
  Assert.assertNotNull(newEnhancedProperty);
  Assert.assertEquals("1024",newEnhancedProperty.getValue());
  Assert.assertEquals("some enhanced description.",newEnhancedProperty.getDescription());
  Assert.assertEquals("yarn-site.xml",newEnhancedProperty.getFilename());
  Assert.assertEquals(2,newEnhancedProperty.getDependsOnProperties().size());
  Assert.assertTrue(newEnhancedProperty.getDependsOnProperties().contains(new PropertyDependencyInfo("yarn-site","new-yarn-property")));
  Assert.assertTrue(newEnhancedProperty.getDependsOnProperties().contains(new PropertyDependencyInfo("global","yarn_heapsize")));
  Assert.assertEquals("MB",newEnhancedProperty.getPropertyValueAttributes().getUnit());
  Assert.assertEquals("int",newEnhancedProperty.getPropertyValueAttributes().getType());
  Assert.assertEquals("512",newEnhancedProperty.getPropertyValueAttributes().getMinimum());
  Assert.assertEquals("15360",newEnhancedProperty.getPropertyValueAttributes().getMaximum());
  Assert.assertEquals("256",newEnhancedProperty.getPropertyValueAttributes().getIncrementStep());
  Assert.assertNull(newEnhancedProperty.getPropertyValueAttributes().getEntries());
  Assert.assertNull(newEnhancedProperty.getPropertyValueAttributes().getEntriesEditable());
  Assert.assertTrue(propertyWithExtraValueAttributes.getPropertyValueAttributes().getEmptyValueValid());
  Assert.assertTrue(propertyWithExtraValueAttributes.getPropertyValueAttributes().getVisible());
  Assert.assertTrue(propertyWithExtraValueAttributes.getPropertyValueAttributes().getReadOnly());
  Assert.assertEquals(Boolean.FALSE,propertyWithExtraValueAttributes.getPropertyValueAttributes().getEditableOnlyAtInstall());
  Assert.assertEquals(Boolean.FALSE,propertyWithExtraValueAttributes.getPropertyValueAttributes().getOverridable());
  Assert.assertEquals(Boolean.FALSE,propertyWithExtraValueAttributes.getPropertyValueAttributes().getShowPropertyName());
  Assert.assertNotNull(originalProperty);
  Assert.assertEquals("mapreduce.shuffle",originalProperty.getValue());
  Assert.assertEquals("Auxilliary services of NodeManager",originalProperty.getDescription());
  Assert.assertEquals(6,redefinedService.getConfigDependencies().size());
  Assert.assertEquals(7,redefinedService.getConfigDependenciesWithComponents().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHue134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HUE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(1,componentList.size());
  ComponentInfo component=componentList.get(0);
  Assert.assertEquals("HUE_SERVER",component.getName());
  Assert.assertEquals(0,component.getDependencies().size());
  Assert.assertNull(component.getAutoDeploy());
  Assert.assertEquals("1",component.getCardinality());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosJson() throws Exception {
  ServiceInfo svc;
  svc=metaInfo.getService(STACK_NAME_HDP,"2.0.8","HDFS");
  Assert.assertNotNull(svc);
  File kerberosDescriptorFile1=svc.getKerberosDescriptorFile();
  Assert.assertNotNull(kerberosDescriptorFile1);
  Assert.assertTrue(kerberosDescriptorFile1.exists());
  svc=metaInfo.getService(STACK_NAME_HDP,"2.1.1","HDFS");
  Assert.assertNotNull(svc);
  File kerberosDescriptorFile2=svc.getKerberosDescriptorFile();
  Assert.assertNotNull(kerberosDescriptorFile1);
  Assert.assertTrue(kerberosDescriptorFile1.exists());
  Assert.assertEquals(kerberosDescriptorFile1,kerberosDescriptorFile2);
  svc=metaInfo.getService(STACK_NAME_HDP,"2.0.7","HDFS");
  Assert.assertNotNull(svc);
  File kerberosDescriptorFile3=svc.getKerberosDescriptorFile();
  Assert.assertNull(kerberosDescriptorFile3);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryNoInternetDefault() throws Exception {
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  AmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  File latestUrlFile=new File(buildDir,"ambari-metaInfo/HDP/2.1.1/repos/hdp.json");
  if (System.getProperty("os.name").contains("Windows")) {
    latestUrlFile.deleteOnExit();
  }
 else {
    FileUtils.deleteQuietly(latestUrlFile);
    assertTrue(!latestUrlFile.exists());
  }
  ambariMetaInfo.init();
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (STACK_NAME_HDP.equals(ri.getRepoName())) {
      assertEquals(ri.getBaseUrl(),ri.getDefaultBaseUrl());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGanglia134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","GANGLIA");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(2,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("GANGLIA_SERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("GANGLIA_MONITOR")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertTrue(component.getAutoDeploy().isEnabled());
      Assert.assertEquals("ALL",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryUpdatedUtilsBaseUrl() throws Exception {
  String stackVersion="0.2";
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  TestAmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  String newBaseUrl="http://myprivate-repo-1.hortonworks.com/HDP-Utils/centos6/2.x/updates/2.0.6.0";
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,stackVersion,"redhat6",REPO_ID,newBaseUrl);
  RepositoryInfo repoInfo=ambariMetaInfo.getRepository(STACK_NAME_HDP,stackVersion,"redhat6",REPO_ID);
  assertEquals(newBaseUrl,repoInfo.getBaseUrl());
  String prevBaseUrl=repoInfo.getDefaultBaseUrl();
  MetainfoDAO metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  MetainfoEntity entity=createNiceMock(MetainfoEntity.class);
  expect(metainfoDAO.findByKey("repo:/HDP/0.2/redhat6/HDP-UTILS-1.1.0.15:baseurl")).andReturn(entity).atLeastOnce();
  expect(entity.getMetainfoValue()).andReturn(newBaseUrl).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.init();
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,stackVersion,"redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (HDP_UTILS_REPO_NAME.equals(ri.getRepoName())) {
      assertEquals(newBaseUrl,ri.getBaseUrl());
      assertFalse(ri.getBaseUrl().equals(ri.getDefaultBaseUrl()));
    }
  }
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,stackVersion,"redhat6",REPO_ID,prevBaseUrl);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZooKeeper134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","ZOOKEEPER");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(2,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("ZOOKEEPER_SERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("ZOOKEEPER_CLIENT")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapReduce134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","MAPREDUCE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(4,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("JOBTRACKER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("TASKTRACKER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1+",component.getCardinality());
    }
    if (name.equals("HISTORYSERVER")) {
      Assert.assertEquals(0,component.getDependencies().size());
      AutoDeployInfo autoDeploy=component.getAutoDeploy();
      Assert.assertTrue(autoDeploy.isEnabled());
      Assert.assertEquals("MAPREDUCE/JOBTRACKER",autoDeploy.getCoLocate());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("MAPREDUCE_CLIENT")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOozie134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","OOZIE");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(2,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("OOZIE_SERVER")) {
      List<DependencyInfo> dependencyList=component.getDependencies();
      Assert.assertEquals(2,dependencyList.size());
      for (      DependencyInfo dependency : dependencyList) {
        if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else         if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else {
          Assert.fail("Unexpected dependency");
        }
      }
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("OOZIE_CLIENT")) {
      List<DependencyInfo> dependencyList=component.getDependencies();
      Assert.assertEquals(2,dependencyList.size());
      for (      DependencyInfo dependency : dependencyList) {
        if (dependency.getName().equals("HDFS/HDFS_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else         if (dependency.getName().equals("MAPREDUCE/MAPREDUCE_CLIENT")) {
          Assert.assertEquals("host",dependency.getScope());
          Assert.assertEquals(true,dependency.getAutoDeploy().isEnabled());
        }
 else {
          Assert.fail("Unexpected dependency");
        }
      }
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRepositoryNoInternetUpdatedBaseUrl() throws Exception {
  String newBaseUrl="http://myprivate-repo-1.hortonworks.com/HDP/centos6/2.x/updates/2.0.6.0";
  String buildDir=tmpFolder.getRoot().getAbsolutePath();
  TestAmbariMetaInfo ambariMetaInfo=setupTempAmbariMetaInfo(buildDir);
  File latestUrlFile=new File(buildDir,"ambari-metaInfo/HDP/2.1.1/repos/hdp.json");
  if (System.getProperty("os.name").contains("Windows")) {
    latestUrlFile.deleteOnExit();
  }
 else {
    FileUtils.deleteQuietly(latestUrlFile);
    assertTrue(!latestUrlFile.exists());
  }
  ambariMetaInfo.updateRepoBaseURL("HDP","2.1.1","redhat6","HDP-2.1.1",newBaseUrl);
  RepositoryInfo repoInfo=ambariMetaInfo.getRepository(STACK_NAME_HDP,"2.1.1","redhat6",STACK_NAME_HDP + "-2.1.1");
  assertEquals(newBaseUrl,repoInfo.getBaseUrl());
  String prevBaseUrl=repoInfo.getDefaultBaseUrl();
  MetainfoDAO metainfoDAO=ambariMetaInfo.metaInfoDAO;
  reset(metainfoDAO);
  MetainfoEntity entity=createNiceMock(MetainfoEntity.class);
  expect(metainfoDAO.findByKey("repo:/HDP/2.1.1/redhat6/HDP-2.1.1:baseurl")).andReturn(entity).atLeastOnce();
  expect(entity.getMetainfoValue()).andReturn(newBaseUrl).atLeastOnce();
  replay(metainfoDAO,entity);
  ambariMetaInfo.init();
  waitForAllReposToBeResolved(ambariMetaInfo);
  List<RepositoryInfo> redhat6Repo=ambariMetaInfo.getRepositories(STACK_NAME_HDP,"2.1.1","redhat6");
  assertNotNull(redhat6Repo);
  for (  RepositoryInfo ri : redhat6Repo) {
    if (STACK_NAME_HDP.equals(ri.getRepoName())) {
      assertEquals(newBaseUrl,ri.getBaseUrl());
      assertFalse(ri.getDefaultBaseUrl().equals(ri.getBaseUrl()));
    }
  }
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME_HDP,"2.1.1","redhat6",STACK_NAME_HDP + "-2.1.1",prevBaseUrl);
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Method: getServiceInfo(String stackName, String version, String
 * serviceName)
 */
@Test public void getServiceInfo() throws Exception {
  ServiceInfo si=metaInfo.getService(STACK_NAME_HDP,STACK_VERSION_HDP,SERVICE_NAME_HDFS);
  assertNotNull(si);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHDFS134Dependencies() throws Exception {
  ServiceInfo service=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HDFS");
  List<ComponentInfo> componentList=service.getComponents();
  Assert.assertEquals(4,componentList.size());
  for (  ComponentInfo component : componentList) {
    String name=component.getName();
    if (name.equals("NAMENODE")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("DATANODE")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1+",component.getCardinality());
    }
    if (name.equals("SECONDARY_NAMENODE")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("1",component.getCardinality());
    }
    if (name.equals("HDFS_CLIENT")) {
      Assert.assertEquals(0,component.getDependencies().size());
      Assert.assertNull(component.getAutoDeploy());
      Assert.assertEquals("0+",component.getCardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlertsJson() throws Exception {
  ServiceInfo svc=metaInfo.getService(STACK_NAME_HDP,"2.0.5","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getAlertsFile());
  svc=metaInfo.getService(STACK_NAME_HDP,"2.0.6","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNotNull(svc.getAlertsFile());
  svc=metaInfo.getService(STACK_NAME_HDP,"1.3.4","HDFS");
  Assert.assertNotNull(svc);
  Assert.assertNull(svc.getAlertsFile());
  Set<AlertDefinition> set=metaInfo.getAlertDefinitions(STACK_NAME_HDP,"2.0.5","HDFS");
  Assert.assertNotNull(set);
  Assert.assertTrue(set.size() > 0);
  AlertDefinition nameNodeProcess=null;
  AlertDefinition nameNodeCpu=null;
  AlertDefinition datanodeStorage=null;
  AlertDefinition ignoreHost=null;
  Iterator<AlertDefinition> iterator=set.iterator();
  while (iterator.hasNext()) {
    AlertDefinition definition=iterator.next();
    if (definition.getName().equals("namenode_process")) {
      nameNodeProcess=definition;
    }
    if (definition.getName().equals("namenode_cpu")) {
      nameNodeCpu=definition;
    }
    if (definition.getName().equals("datanode_storage")) {
      datanodeStorage=definition;
    }
    if (definition.getName().equals("hdfs_ignore_host_test")) {
      ignoreHost=definition;
    }
  }
  assertNotNull(nameNodeProcess);
  assertNotNull(nameNodeCpu);
  assertNotNull(ignoreHost);
  assertEquals("NameNode Host CPU Utilization",nameNodeCpu.getLabel());
  assertFalse(nameNodeProcess.isHostIgnored());
  assertEquals("A description of namenode_process",nameNodeProcess.getDescription());
  Source source=nameNodeProcess.getSource();
  assertNotNull(source);
  assertNotNull(((PortSource)source).getPort());
  Reporting reporting=source.getReporting();
  assertNotNull(reporting);
  assertNotNull(reporting.getOk());
  assertNotNull(reporting.getOk().getText());
  assertNull(reporting.getOk().getValue());
  assertNotNull(reporting.getCritical());
  assertNotNull(reporting.getCritical().getText());
  assertNull(reporting.getCritical().getValue());
  assertNull(reporting.getWarning());
  assertFalse(nameNodeCpu.isHostIgnored());
  assertEquals("A description of namenode_cpu",nameNodeCpu.getDescription());
  source=nameNodeCpu.getSource();
  assertNotNull(source);
  reporting=source.getReporting();
  assertNotNull(reporting);
  assertNotNull(reporting.getOk());
  assertNotNull(reporting.getOk().getText());
  assertNull(reporting.getOk().getValue());
  assertNotNull(reporting.getCritical());
  assertNotNull(reporting.getCritical().getText());
  assertNotNull(reporting.getCritical().getValue());
  assertNotNull(reporting.getWarning());
  assertNotNull(reporting.getWarning().getText());
  assertNotNull(reporting.getWarning().getValue());
  assertNotNull(datanodeStorage);
  assertEquals("A description of datanode_storage",datanodeStorage.getDescription());
  assertFalse(datanodeStorage.isHostIgnored());
  MetricSource metricSource=(MetricSource)datanodeStorage.getSource();
  assertNotNull(metricSource.getUri());
  assertNotNull(metricSource.getUri().getHttpsProperty());
  assertNotNull(metricSource.getUri().getHttpsPropertyValue());
  assertNotNull(metricSource.getUri().getHttpsUri());
  assertNotNull(metricSource.getUri().getHttpUri());
  assertEquals(12345,metricSource.getUri().getDefaultPort());
  assertTrue(ignoreHost.isHostIgnored());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.BaseRequestTest </h4><pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcess_noBody_ErrorStateResult() throws Exception {
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition).anyTimes();
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(true).anyTimes();
  replay(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  Result processResult=request.process();
  verify(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  assertSame(result,processResult);
  assertNull(request.getQueryPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFields() throws Exception {
  String fields="prop,category/prop1,category2/category3/prop2[1,2,3],prop3[4,5,6],category4[7,8,9],sub-resource/*[10,11,12],finalProp";
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> mapQueryParams=createMock(MultivaluedMap.class);
  expect(uriInfo.getQueryParameters()).andReturn(mapQueryParams);
  expect(mapQueryParams.getFirst("fields")).andReturn(fields);
  replay(uriInfo,mapQueryParams);
  Request request=getTestRequest(null,null,uriInfo,null,null,null,null);
  Map<String,TemporalInfo> mapFields=request.getFields();
  assertEquals(7,mapFields.size());
  String prop="prop";
  assertTrue(mapFields.containsKey(prop));
  assertNull(mapFields.get(prop));
  String prop1=PropertyHelper.getPropertyId("category","prop1");
  assertTrue(mapFields.containsKey(prop1));
  assertNull(mapFields.get(prop1));
  String prop2=PropertyHelper.getPropertyId("category2/category3","prop2");
  assertTrue(mapFields.containsKey(prop2));
  assertEquals(new TemporalInfoImpl(1,2,3),mapFields.get(prop2));
  String prop3="prop3";
  assertTrue(mapFields.containsKey(prop3));
  assertEquals(new TemporalInfoImpl(4,5,6),mapFields.get(prop3));
  String category4="category4";
  assertTrue(mapFields.containsKey(category4));
  assertEquals(new TemporalInfoImpl(7,8,9),mapFields.get(category4));
  String subResource=PropertyHelper.getPropertyId("sub-resource","*");
  assertTrue(mapFields.containsKey(subResource));
  assertEquals(new TemporalInfoImpl(10,11,12),mapFields.get(subResource));
  String finalProp="finalProp";
  assertTrue(mapFields.containsKey(finalProp));
  assertNull(mapFields.get(finalProp));
  verify(uriInfo,mapQueryParams);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcess_WithBody() throws Exception {
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition);
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  expect(body.getQueryString()).andReturn(null);
  replay(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  Result processResult=request.process();
  verify(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  assertSame(result,processResult);
  assertNull(request.getQueryPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcess_noBody() throws Exception {
  String uriString="http://localhost.com:8080/api/v1/clusters/c1";
  URI uri=new URI(URLEncoder.encode(uriString,"UTF-8"));
  PredicateCompiler compiler=createStrictMock(PredicateCompiler.class);
  UriInfo uriInfo=createMock(UriInfo.class);
  @SuppressWarnings("unchecked") MultivaluedMap<String,String> queryParams=createMock(MultivaluedMap.class);
  RequestHandler handler=createStrictMock(RequestHandler.class);
  Result result=createMock(Result.class);
  ResultStatus resultStatus=createMock(ResultStatus.class);
  ResultPostProcessor processor=createStrictMock(ResultPostProcessor.class);
  RequestBody body=createNiceMock(RequestBody.class);
  ResourceInstance resource=createNiceMock(ResourceInstance.class);
  ResourceDefinition resourceDefinition=createNiceMock(ResourceDefinition.class);
  Renderer renderer=new DefaultRenderer();
  Request request=getTestRequest(null,body,uriInfo,compiler,handler,processor,resource);
  expect(uriInfo.getQueryParameters()).andReturn(queryParams).anyTimes();
  expect(queryParams.getFirst(QueryLexer.QUERY_MINIMAL)).andReturn(null);
  expect(queryParams.getFirst(QueryLexer.QUERY_FORMAT)).andReturn(null);
  expect(resource.getResourceDefinition()).andReturn(resourceDefinition);
  expect(resourceDefinition.getRenderer(null)).andReturn(renderer);
  expect(uriInfo.getRequestUri()).andReturn(uri).anyTimes();
  expect(handler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(resultStatus).anyTimes();
  expect(resultStatus.isErrorState()).andReturn(false).anyTimes();
  processor.process(result);
  replay(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  Result processResult=request.process();
  verify(compiler,uriInfo,handler,queryParams,resource,resourceDefinition,result,resultStatus,processor,body);
  assertSame(result,processResult);
  assertNull(request.getQueryPredicate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.ClusterStackVersionServiceTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetRepositoryVersionService(){
  ClusterStackVersionService clusterStackVersionService=new TestClusterStackVersionService("cluster");
  RepositoryVersionService rvs=clusterStackVersionService.getRepositoryVersionService(EasyMock.createMock(javax.ws.rs.core.Request.class),"1");
  TestCase.assertNotNull(rvs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.RequestBodyTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGetQueryString(){
  RequestBody body=new RequestBody();
  assertNull(body.getQueryString());
  body.setQueryString("foo=bar");
  assertEquals("foo=bar",body.getQueryString());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGetPartialResponseFields(){
  RequestBody body=new RequestBody();
  assertNull(body.getPartialResponseFields());
  body.setPartialResponseFields("foo,bar");
  assertEquals("foo,bar",body.getPartialResponseFields());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGetBody(){
  RequestBody body=new RequestBody();
  assertNull(body.getBody());
  body.setBody("{\"foo\" : \"value\" }");
  assertEquals("{\"foo\" : \"value\" }",body.getBody());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.ViewSubResourceServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResultSerializer_Json() throws Exception {
  UriInfo uriInfo=createMock(UriInfo.class);
  Resource resource=createMock(Resource.class);
  Result result=new ResultImpl(true);
  result.setResultStatus(new ResultStatus(ResultStatus.STATUS.OK));
  TreeNode<Resource> tree=result.getResultTree();
  TreeNode<Resource> child=tree.addChild(resource,"resource1");
  child.setProperty("href","this is an href");
  HashMap<String,Object> mapRootProps=new HashMap<String,Object>();
  mapRootProps.put("prop1","value1");
  mapRootProps.put("prop2","value2");
  HashMap<String,Object> mapCategoryProps=new HashMap<String,Object>();
  mapCategoryProps.put("catProp1","catValue1");
  mapCategoryProps.put("catProp2","catValue2");
  Map<String,Map<String,Object>> propertyMap=new HashMap<String,Map<String,Object>>();
  propertyMap.put(null,mapRootProps);
  propertyMap.put("category",mapCategoryProps);
  expect(resource.getPropertiesMap()).andReturn(propertyMap).anyTimes();
  expect(resource.getType()).andReturn(Resource.Type.Cluster).anyTimes();
  replay(uriInfo,resource);
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  Resource.Type type=new Resource.Type("subResource");
  ViewSubResourceService service=new ViewSubResourceService(type,viewInstanceEntity);
  ResultSerializer serializer=service.getResultSerializer(MediaType.APPLICATION_JSON_TYPE);
  Object o=serializer.serialize(result);
  assertTrue(o instanceof Map);
  Map map=(Map)o;
  assertEquals(4,map.size());
  assertEquals("value1",map.get("prop1"));
  assertEquals("value2",map.get("prop2"));
  assertEquals("this is an href",map.get("href"));
  Object o2=map.get("category");
  assertNotNull(o2);
  assertTrue(o2 instanceof Map);
  Map subMap=(Map)o2;
  assertEquals(2,subMap.size());
  assertEquals("catValue1",subMap.get("catProp1"));
  assertEquals("catValue2",subMap.get("catProp2"));
  verify(uriInfo,resource);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.parsers.JsonRequestBodyParserTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse_EmptyBody() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse("").iterator().next();
  assertNotNull(body.getNamedPropertySets());
  assertEquals(0,body.getNamedPropertySets().size());
  assertNull(body.getQueryString());
  assertNull(body.getPartialResponseFields());
  assertNull(body.getBody());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParse_NullBody() throws BodyParseException {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(null).iterator().next();
  assertNotNull(body.getNamedPropertySets());
  assertEquals(0,body.getNamedPropertySets().size());
  assertNull(body.getQueryString());
  assertNull(body.getPartialResponseFields());
  assertNull(body.getBody());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequestBlobProperties() throws Exception {
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(bodyWithRequestBlobProperties).iterator().next();
  Set<NamedPropertySet> setProps=body.getNamedPropertySets();
  assertEquals(1,setProps.size());
  String requestBlob=null;
  for (  NamedPropertySet ps : setProps) {
    assertEquals("",ps.getName());
    Map<String,Object> mapProps=ps.getProperties();
    for (    Map.Entry<String,Object> entry : mapProps.entrySet()) {
      if (entry.getKey().equals(JsonRequestBodyParser.REQUEST_BLOB_TITLE)) {
        requestBlob=(String)entry.getValue();
      }
    }
  }
  Assert.assertNotNull(requestBlob);
  body=parser.parse(requestBlob).iterator().next();
  Map<String,Object> mapExpected=new HashMap<String,Object>();
  mapExpected.put(PropertyHelper.getPropertyId("Services","service_name"),"HDFS");
  mapExpected.put(PropertyHelper.getPropertyId("Services","display_name"),"HDFS");
  mapExpected.put(PropertyHelper.getPropertyId("ServiceInfo","cluster_name"),"tbmetrictest");
  mapExpected.put(PropertyHelper.getPropertyId("Services","description"),"Apache Hadoop Distributed File System");
  mapExpected.put(PropertyHelper.getPropertyId("ServiceInfo","state"),"STARTED");
  mapExpected.put(PropertyHelper.getPropertyId("OuterCategory","propName"),"100");
  mapExpected.put(PropertyHelper.getPropertyId("OuterCategory/nested1/nested2","innerPropName"),"innerPropValue");
  mapExpected.put(PropertyHelper.getPropertyId(null,"topLevelProp"),"value");
  Set<NamedPropertySet> setProps2=body.getNamedPropertySets();
  assertEquals(mapExpected,setProps2.iterator().next().getProperties());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.serializers.CsvSerializerTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerializeResources_NoColumnInfo() throws Exception {
  Result result=new ResultImpl(true);
  result.setResultStatus(new ResultStatus(ResultStatus.STATUS.OK));
  TreeNode<Resource> tree=result.getResultTree();
  List<TreeMap<String,Object>> data=new ArrayList<TreeMap<String,Object>>(){
{
      add(new TreeMap<String,Object>(){
{
          put("property1","value1a");
          put("property2","value2a");
          put("property3","value3a");
          put("property4","value4a");
        }
      }
);
      add(new TreeMap<String,Object>(){
{
          put("property1","value1'b");
          put("property2","value2'b");
          put("property3","value3'b");
          put("property4","value4'b");
        }
      }
);
      add(new TreeMap<String,Object>(){
{
          put("property1","value1,c");
          put("property2","value2,c");
          put("property3","value3,c");
          put("property4","value4,c");
        }
      }
);
    }
  }
;
  tree.setName("items");
  tree.setProperty("isCollection","true");
  addChildResource(tree,"resource",0,data.get(0));
  addChildResource(tree,"resource",1,data.get(1));
  addChildResource(tree,"resource",2,data.get(2));
  replayAll();
  Object o=new CsvSerializer().serialize(result).toString().replace("\r","");
  verifyAll();
  assertNotNull(o);
  StringReader reader=new StringReader(o.toString());
  CSVParser csvParser=new CSVParser(reader,CSVFormat.DEFAULT);
  List<CSVRecord> records=csvParser.getRecords();
  assertNotNull(records);
  assertEquals(3,records.size());
  int i=0;
  for (  CSVRecord record : records) {
    TreeMap<String,Object> actualData=data.get(i++);
    assertEquals(actualData.size(),record.size());
    for (    String item : record) {
      assertTrue(actualData.containsValue(item));
    }
  }
  csvParser.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.commands.ConfigurationRecommendationCommandTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessHostGroups() throws Exception {
  StackAdvisorRunner saRunner=mock(StackAdvisorRunner.class);
  File file=mock(File.class);
  AmbariMetaInfo metaInfo=mock(AmbariMetaInfo.class);
  ConfigurationRecommendationCommand command=new ConfigurationRecommendationCommand(file,"script",1,saRunner,metaInfo);
  StackAdvisorRequest request=mock(StackAdvisorRequest.class);
  Map<String,Set<String>> componentHostGroupMap=new HashMap<String,Set<String>>();
  Set<String> components1=new HashSet<String>();
  components1.add("component1");
  components1.add("component4");
  components1.add("component5");
  componentHostGroupMap.put("group1",components1);
  Set<String> components2=new HashSet<String>();
  components2.add("component2");
  components2.add("component3");
  componentHostGroupMap.put("group2",components2);
  doReturn(componentHostGroupMap).when(request).getHostComponents();
  Set<RecommendationResponse.HostGroup> hostGroups=command.processHostGroups(request);
  assertNotNull(hostGroups);
  assertEquals(2,hostGroups.size());
  Map<String,RecommendationResponse.HostGroup> hostGroupMap=new HashMap<String,RecommendationResponse.HostGroup>();
  for (  RecommendationResponse.HostGroup hostGroup : hostGroups) {
    hostGroupMap.put(hostGroup.getName(),hostGroup);
  }
  RecommendationResponse.HostGroup hostGroup1=hostGroupMap.get("group1");
  assertNotNull(hostGroup1);
  Set<Map<String,String>> host1Components=hostGroup1.getComponents();
  assertNotNull(host1Components);
  assertEquals(3,host1Components.size());
  Set<String> componentNames1=new HashSet<String>();
  for (  Map<String,String> host1Component : host1Components) {
    assertNotNull(host1Component);
    assertEquals(1,host1Component.size());
    String componentName=host1Component.get("name");
    assertNotNull(componentName);
    componentNames1.add(componentName);
  }
  assertEquals(3,componentNames1.size());
  assertTrue(componentNames1.contains("component1"));
  assertTrue(componentNames1.contains("component4"));
  assertTrue(componentNames1.contains("component5"));
  RecommendationResponse.HostGroup hostGroup2=hostGroupMap.get("group2");
  assertNotNull(hostGroup2);
  Set<Map<String,String>> host2Components=hostGroup2.getComponents();
  assertNotNull(host2Components);
  assertEquals(2,host2Components.size());
  Set<String> componentNames2=new HashSet<String>();
  for (  Map<String,String> host2Component : host2Components) {
    assertNotNull(host2Component);
    assertEquals(1,host2Component.size());
    String componentName=host2Component.get("name");
    assertNotNull(componentName);
    componentNames2.add(componentName);
  }
  assertEquals(2,componentNames2.size());
  assertTrue(componentNames2.contains("component2"));
  assertTrue(componentNames2.contains("component3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.api.services.stackadvisor.commands.StackAdvisorCommandTest </h4><pre class="type-2 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateStackHierarchy() throws Exception {
  File file=mock(File.class);
  StackAdvisorRunner stackAdvisorRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo ambariMetaInfo=mock(AmbariMetaInfo.class);
  StackAdvisorCommand<TestResource> cmd=new TestStackAdvisorCommand(file,"test",1,stackAdvisorRunner,ambariMetaInfo);
  ObjectNode objectNode=(ObjectNode)cmd.mapper.readTree("{\"Versions\": " + "{\"stack_name\": \"stack\", \"stack_version\":\"1.0.0\"}}");
  doReturn(Arrays.asList("0.9","0.8")).when(ambariMetaInfo).getStackParentVersions("stack","1.0.0");
  cmd.populateStackHierarchy(objectNode);
  JsonNode stackHierarchy=objectNode.get("Versions").get("stack_hierarchy");
  assertNotNull(stackHierarchy);
  JsonNode stackName=stackHierarchy.get("stack_name");
  assertNotNull(stackName);
  assertEquals("stack",stackName.asText());
  ArrayNode stackVersions=(ArrayNode)stackHierarchy.get("stack_versions");
  assertNotNull(stackVersions);
  assertEquals(2,stackVersions.size());
  Iterator<JsonNode> stackVersionsElements=stackVersions.getElements();
  assertEquals("0.9",stackVersionsElements.next().asText());
  assertEquals("0.8",stackVersionsElements.next().asText());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateAmbariServerProperties() throws Exception {
  File file=mock(File.class);
  StackAdvisorRunner stackAdvisorRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo ambariMetaInfo=mock(AmbariMetaInfo.class);
  StackAdvisorCommand<TestResource> cmd=new TestStackAdvisorCommand(file,"test",1,stackAdvisorRunner,ambariMetaInfo);
  ObjectNode objectNode=(ObjectNode)cmd.mapper.readTree("{\"Versions\": " + "{\"stack_name\": \"stack\", \"stack_version\":\"1.0.0\"}}");
  Map<String,String> props=Collections.singletonMap("a","b");
  doReturn(props).when(ambariMetaInfo).getAmbariServerProperties();
  cmd.populateAmbariServerInfo(objectNode);
  JsonNode serverProperties=objectNode.get("ambari-server-properties");
  assertNotNull(serverProperties);
  assertEquals("b",serverProperties.iterator().next().getTextValue());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateStackHierarchy_noParents() throws Exception {
  File file=mock(File.class);
  StackAdvisorRunner stackAdvisorRunner=mock(StackAdvisorRunner.class);
  AmbariMetaInfo ambariMetaInfo=mock(AmbariMetaInfo.class);
  StackAdvisorCommand<TestResource> cmd=new TestStackAdvisorCommand(file,"test",1,stackAdvisorRunner,ambariMetaInfo);
  ObjectNode objectNode=(ObjectNode)cmd.mapper.readTree("{\"Versions\": " + "{\"stack_name\": \"stack\", \"stack_version\":\"1.0.0\"}}");
  doReturn(Collections.emptyList()).when(ambariMetaInfo).getStackParentVersions("stack","1.0.0");
  cmd.populateStackHierarchy(objectNode);
  JsonNode stackHierarchy=objectNode.get("Versions").get("stack_hierarchy");
  assertNotNull(stackHierarchy);
  JsonNode stackName=stackHierarchy.get("stack_name");
  assertNotNull(stackName);
  assertEquals("stack",stackName.asText());
  ArrayNode stackVersions=(ArrayNode)stackHierarchy.get("stack_versions");
  assertNotNull(stackVersions);
  assertEquals(0,stackVersions.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.checks.InstallPackagesCheckTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPerform() throws Exception {
  StackId stackId=new StackId("HDP","2.2");
  PowerMockito.mockStatic(HostComponentSummary.class);
  final InstallPackagesCheck installPackagesCheck=new InstallPackagesCheck();
  installPackagesCheck.clustersProvider=new Provider<Clusters>(){
    @Override public Clusters get(){
      return clusters;
    }
  }
;
  installPackagesCheck.ambariMetaInfo=new Provider<AmbariMetaInfo>(){
    @Override public AmbariMetaInfo get(){
      return ambariMetaInfo;
    }
  }
;
  installPackagesCheck.clusterVersionDAOProvider=new Provider<ClusterVersionDAO>(){
    @Override public ClusterVersionDAO get(){
      return clusterVersionDAO;
    }
  }
;
  installPackagesCheck.hostVersionDaoProvider=new Provider<HostVersionDAO>(){
    @Override public HostVersionDAO get(){
      return hostVersionDAO;
    }
  }
;
  installPackagesCheck.repositoryVersionDaoProvider=new Provider<RepositoryVersionDAO>(){
    @Override public RepositoryVersionDAO get(){
      return repositoryVersionDAO;
    }
  }
;
  StackEntity stack=new StackEntity();
  stack.setStackName(stackId.getStackName());
  stack.setStackVersion(stackId.getStackVersion());
  RepositoryVersionEntity rve=new RepositoryVersionEntity(stack,repositoryVersion,repositoryVersion,"rhel6");
  Mockito.when(repositoryVersionDAO.findByStackNameAndVersion(Mockito.anyString(),Mockito.anyString())).thenReturn(rve);
  final Cluster cluster=Mockito.mock(Cluster.class);
  Mockito.when(cluster.getClusterName()).thenReturn(clusterName);
  Mockito.when(cluster.getClusterId()).thenReturn(1L);
  Mockito.when(cluster.getCurrentStackVersion()).thenReturn(stackId);
  Mockito.when(clusters.getCluster(clusterName)).thenReturn(cluster);
  ClusterVersionEntity clusterVersionEntity=Mockito.mock(ClusterVersionEntity.class);
  Mockito.when(clusterVersionEntity.getState()).thenReturn(RepositoryVersionState.INSTALLED);
  Mockito.when(clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,targetStackId,repositoryVersion)).thenReturn(clusterVersionEntity);
  final List<String> hostNames=new ArrayList<String>();
  hostNames.add("host1");
  hostNames.add("host2");
  hostNames.add("host3");
  final List<Host> hosts=new ArrayList<Host>();
  final List<HostVersionEntity> hostVersionEntities=new ArrayList<HostVersionEntity>();
  for (  String hostName : hostNames) {
    Host host=Mockito.mock(Host.class);
    host.setHostName(hostName);
    Mockito.when(host.getHostName()).thenReturn(hostName);
    Mockito.when(host.getMaintenanceState(1L)).thenReturn(MaintenanceState.OFF);
    hosts.add(host);
    HostVersionEntity hve=Mockito.mock(HostVersionEntity.class);
    Mockito.when(hve.getRepositoryVersion()).thenReturn(rve);
    Mockito.when(hve.getState()).thenReturn(RepositoryVersionState.INSTALLED);
    hostVersionEntities.add(hve);
    Mockito.when(hostVersionDAO.findByHost(hostName)).thenReturn(Collections.singletonList(hve));
  }
  Mockito.when(cluster.getHosts()).thenReturn(hosts);
  PrereqCheckRequest checkRequest=new PrereqCheckRequest(clusterName);
  checkRequest.setRepositoryVersion(repositoryVersion);
  checkRequest.setSourceStackId(sourceStackId);
  checkRequest.setTargetStackId(targetStackId);
  PrerequisiteCheck check=new PrerequisiteCheck(null,null);
  installPackagesCheck.perform(check,checkRequest);
  Assert.assertEquals(PrereqCheckStatus.PASS,check.getStatus());
  Mockito.when(hostVersionEntities.get(0).getState()).thenReturn(RepositoryVersionState.INSTALL_FAILED);
  Mockito.when(clusterVersionEntity.getState()).thenReturn(RepositoryVersionState.INSTALL_FAILED);
  check=new PrerequisiteCheck(null,null);
  installPackagesCheck.perform(check,checkRequest);
  Assert.assertEquals(PrereqCheckStatus.FAIL,check.getStatus());
  Assert.assertNotNull(check.getFailedOn());
  Assert.assertTrue(check.getFailedOn().contains("host1"));
  Mockito.when(hostVersionEntities.get(0).getState()).thenReturn(RepositoryVersionState.INSTALL_FAILED);
  Mockito.when(hosts.get(0).getMaintenanceState(1L)).thenReturn(MaintenanceState.ON);
  Mockito.when(clusterVersionEntity.getState()).thenReturn(RepositoryVersionState.INSTALL_FAILED);
  check=new PrerequisiteCheck(null,null);
  installPackagesCheck.perform(check,checkRequest);
  Assert.assertEquals(PrereqCheckStatus.FAIL,check.getStatus());
  Assert.assertNotNull(check.getFailedOn());
  Assert.assertTrue(check.getFailedOn().contains(clusterName));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.configuration.ConfigurationTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetLdapServerProperties_WrongManagerPassword() throws Exception {
  final Properties ambariProperties=new Properties();
  ambariProperties.setProperty(Configuration.LDAP_MANAGER_PASSWORD_KEY,"somePassword");
  final Configuration configuration=new Configuration(ambariProperties);
  final LdapServerProperties ldapProperties=configuration.getLdapServerProperties();
  Assert.assertNull(ldapProperties.getManagerPassword());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariCustomCommandExecutionHelperTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostsFilterHealthy() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  createClusterFixture("HDP-2.0.6");
  Map<String,String> requestProperties=new HashMap<String,String>(){
{
      put("context","Restart all components for GANGLIA");
      put("operation_level/level","SERVICE");
      put("operation_level/service_name","GANGLIA");
      put("operation_level/cluster_name","c1");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","RESTART",null,Arrays.asList(new RequestResourceFilter("GANGLIA","GANGLIA_SERVER",Collections.singletonList("c6401")),new RequestResourceFilter("GANGLIA","GANGLIA_MONITOR",Collections.singletonList("c6401")),new RequestResourceFilter("GANGLIA","GANGLIA_MONITOR",Collections.singletonList("c6402"))),new RequestOperationLevel(Resource.Type.Service,"c1","GANGLIA",null,null),new HashMap<String,String>(){
{
    }
  }
,false);
  controller.createAction(actionRequest,requestProperties);
  Mockito.verify(am,Mockito.times(1)).sendActions(requestCapture.capture(),any(ExecuteActionRequest.class));
  Request request=requestCapture.getValue();
  Assert.assertNotNull(request);
  Assert.assertNotNull(request.getStages());
  Assert.assertEquals(1,request.getStages().size());
  Stage stage=request.getStages().iterator().next();
  Assert.assertEquals(2,stage.getHostRoleCommands().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("serial") @Test public void testRefreshQueueCustomCommand() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  createClusterFixture("HDP-2.0.6");
  Map<String,String> requestProperties=new HashMap<String,String>(){
{
      put(REQUEST_CONTEXT_PROPERTY,"Refresh YARN Capacity Scheduler");
      put("command","REFRESHQUEUES");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","REFRESHQUEUES",new HashMap<String,String>(){
{
      put("forceRefreshConfigTags","capacity-scheduler");
    }
  }
,false);
  actionRequest.getResourceFilters().add(new RequestResourceFilter("YARN","RESOURCEMANAGER",Collections.singletonList("c6401")));
  controller.createAction(actionRequest,requestProperties);
  Mockito.verify(am,Mockito.times(1)).sendActions(requestCapture.capture(),any(ExecuteActionRequest.class));
  Request request=requestCapture.getValue();
  Assert.assertNotNull(request);
  Assert.assertNotNull(request.getStages());
  Assert.assertEquals(1,request.getStages().size());
  Stage stage=request.getStages().iterator().next();
  Assert.assertEquals(1,stage.getHosts().size());
  List<ExecutionCommandWrapper> commands=stage.getExecutionCommands("c6401");
  Assert.assertEquals(1,commands.size());
  ExecutionCommand command=commands.get(0).getExecutionCommand();
  Assert.assertNotNull(command.getForceRefreshConfigTags());
  Assert.assertEquals(1,command.getForceRefreshConfigTags().size());
  Assert.assertEquals("capacity-scheduler",command.getForceRefreshConfigTags().iterator().next());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostsFilterUnhealthyHost() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  createClusterFixture("HDP-2.0.6");
  clusters.getHost("c6402").setState(HostState.HEARTBEAT_LOST);
  Map<String,String> requestProperties=new HashMap<String,String>(){
{
      put("context","Restart all components for GANGLIA");
      put("operation_level/level","SERVICE");
      put("operation_level/service_name","GANGLIA");
      put("operation_level/cluster_name","c1");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","RESTART",null,Arrays.asList(new RequestResourceFilter("GANGLIA","GANGLIA_SERVER",Collections.singletonList("c6401")),new RequestResourceFilter("GANGLIA","GANGLIA_MONITOR",Collections.singletonList("c6401")),new RequestResourceFilter("GANGLIA","GANGLIA_MONITOR",Collections.singletonList("c6402"))),new RequestOperationLevel(Resource.Type.Service,"c1","GANGLIA",null,null),new HashMap<String,String>(){
{
    }
  }
,false);
  controller.createAction(actionRequest,requestProperties);
  Mockito.verify(am,Mockito.times(1)).sendActions(requestCapture.capture(),any(ExecuteActionRequest.class));
  Request request=requestCapture.getValue();
  Assert.assertNotNull(request);
  Assert.assertNotNull(request.getStages());
  Assert.assertEquals(1,request.getStages().size());
  Stage stage=request.getStages().iterator().next();
  Assert.assertEquals(1,stage.getHostRoleCommands().size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostsFilterUnhealthyComponent() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  createClusterFixture("HDP-2.0.6");
  clusters.getCluster("c1").getService("GANGLIA").getServiceComponent("GANGLIA_MONITOR").getServiceComponentHost("c6402").setState(State.UNKNOWN);
  Map<String,String> requestProperties=new HashMap<String,String>(){
{
      put("context","Restart all components for GANGLIA");
      put("operation_level/level","SERVICE");
      put("operation_level/service_name","GANGLIA");
      put("operation_level/cluster_name","c1");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","RESTART",null,Arrays.asList(new RequestResourceFilter("GANGLIA","GANGLIA_SERVER",Collections.singletonList("c6401")),new RequestResourceFilter("GANGLIA","GANGLIA_MONITOR",Collections.singletonList("c6401")),new RequestResourceFilter("GANGLIA","GANGLIA_MONITOR",Collections.singletonList("c6402"))),new RequestOperationLevel(Resource.Type.Host,"c1","GANGLIA",null,null),new HashMap<String,String>(){
{
    }
  }
,false);
  controller.createAction(actionRequest,requestProperties);
  Mockito.verify(am,Mockito.times(1)).sendActions(requestCapture.capture(),any(ExecuteActionRequest.class));
  Request request=requestCapture.getValue();
  Assert.assertNotNull(request);
  Assert.assertNotNull(request.getStages());
  Assert.assertEquals(1,request.getStages().size());
  Stage stage=request.getStages().iterator().next();
  Assert.assertEquals(1,stage.getHostRoleCommands().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariManagementControllerImplTest </h4><pre class="type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostComponents___OR_Predicate_HostNotFoundException_hostProvidedInQuery() throws Exception {
  Injector injector=createStrictMock(Injector.class);
  Capture<AmbariManagementController> controllerCapture=new Capture<AmbariManagementController>();
  StackId stack=createNiceMock(StackId.class);
  Cluster cluster=createNiceMock(Cluster.class);
  final Host host=createNiceMock(Host.class);
  Service service=createNiceMock(Service.class);
  Service service2=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  ServiceComponent component3=createNiceMock(ServiceComponent.class);
  final ServiceComponentHost componentHost1=createNiceMock(ServiceComponentHost.class);
  final ServiceComponentHost componentHost2=createNiceMock(ServiceComponentHost.class);
  ServiceComponentHostResponse response1=createNiceMock(ServiceComponentHostResponse.class);
  ServiceComponentHostResponse response2=createNiceMock(ServiceComponentHostResponse.class);
  MaintenanceStateHelper maintHelper=createNiceMock(MaintenanceStateHelper.class);
  expect(maintHelper.getEffectiveState(anyObject(ServiceComponentHost.class),anyObject(Host.class))).andReturn(MaintenanceState.OFF).anyTimes();
  ServiceComponentHostRequest request1=new ServiceComponentHostRequest("cluster1",null,"component1",null,null);
  ServiceComponentHostRequest request2=new ServiceComponentHostRequest("cluster1",null,"component2","host2",null);
  ServiceComponentHostRequest request3=new ServiceComponentHostRequest("cluster1",null,"component3",null,null);
  Set<ServiceComponentHostRequest> setRequests=new HashSet<ServiceComponentHostRequest>();
  setRequests.add(request1);
  setRequests.add(request2);
  setRequests.add(request3);
  injector.injectMembers(capture(controllerCapture));
  expect(injector.getInstance(Gson.class)).andReturn(null);
  expect(injector.getInstance(MaintenanceStateHelper.class)).andReturn(maintHelper).anyTimes();
  expect(injector.getInstance(KerberosHelper.class)).andReturn(createNiceMock(KerberosHelper.class));
  expect(clusters.getCluster("cluster1")).andReturn(cluster).times(3);
  expect(clusters.getHostsForCluster((String)anyObject())).andReturn(new HashMap<String,Host>(){
{
      put("host1",host);
    }
  }
).anyTimes();
  expect(cluster.getDesiredStackVersion()).andReturn(stack).anyTimes();
  expect(stack.getStackName()).andReturn("stackName").anyTimes();
  expect(stack.getStackVersion()).andReturn("stackVersion").anyTimes();
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component1")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component1")).andReturn(component);
  expect(component.getName()).andReturn("component1");
  expect(component.getServiceComponentHosts()).andReturn(Collections.singletonMap("foo",componentHost1));
  expect(componentHost1.convertToResponse()).andReturn(response1);
  expect(componentHost1.getHostName()).andReturn("host1");
  expect(clusters.getClustersForHost("host2")).andThrow(new HostNotFoundException("host2"));
  expect(ambariMetaInfo.getComponentToService("stackName","stackVersion","component3")).andReturn("service1");
  expect(cluster.getService("service1")).andReturn(service);
  expect(service.getServiceComponent("component3")).andReturn(component3);
  expect(component3.getName()).andReturn("component3");
  expect(component3.getServiceComponentHosts()).andReturn(Collections.singletonMap("foo",componentHost2));
  expect(componentHost2.convertToResponse()).andReturn(response2);
  expect(componentHost2.getHostName()).andReturn("host1");
  replay(maintHelper,injector,clusters,cluster,host,stack,ambariMetaInfo,service,service2,component,component2,component3,componentHost1,componentHost2,response1,response2);
  AmbariManagementController controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  Set<ServiceComponentHostResponse> setResponses=controller.getHostComponents(setRequests);
  Assert.assertNotNull(setResponses);
  assertSame(controller,controllerCapture.getValue());
  assertEquals(2,setResponses.size());
  assertTrue(setResponses.contains(response1));
  assertTrue(setResponses.contains(response2));
  verify(injector,clusters,cluster,host,stack,ambariMetaInfo,service,service2,component,component2,component3,componentHost1,componentHost2,response1,response2);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClientHostForRunningAction_clientComponentThrowsException() throws Exception {
  Injector injector=createNiceMock(Injector.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  StackId stackId=createNiceMock(StackId.class);
  ServiceComponent component1=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  expect(service.getName()).andReturn("service");
  expect(service.getServiceComponent("component")).andThrow(new ServiceComponentNotFoundException("cluster","service","component"));
  expect(service.getDesiredStackVersion()).andReturn(stackId);
  expect(stackId.getStackName()).andReturn("stack");
  expect(stackId.getStackVersion()).andReturn("1.0");
  Map<String,ServiceComponent> componentsMap=new HashMap<String,ServiceComponent>();
  componentsMap.put("component1",component1);
  componentsMap.put("component2",component2);
  expect(service.getServiceComponents()).andReturn(componentsMap);
  expect(component1.getServiceComponentHosts()).andReturn(Collections.EMPTY_MAP);
  expect(component2.getServiceComponentHosts()).andReturn(Collections.<String,ServiceComponentHost>singletonMap("anyHost",null));
  ServiceInfo serviceInfo=createNiceMock(ServiceInfo.class);
  ComponentInfo compInfo=createNiceMock(ComponentInfo.class);
  expect(serviceInfo.getClientComponent()).andReturn(compInfo);
  expect(compInfo.getName()).andReturn("component");
  expect(ambariMetaInfo.getService("stack","1.0","service")).andReturn(serviceInfo);
  replay(injector,cluster,service,component1,component2,serviceInfo,compInfo,ambariMetaInfo,stackId);
  AmbariManagementControllerImpl controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  ServiceComponent resultComponent=controller.getClientComponentForRunningAction(cluster,service);
  assertNotNull(resultComponent);
  assertEquals(component2,resultComponent);
  verify(injector,cluster,service,component1,component2,serviceInfo,compInfo,ambariMetaInfo,stackId);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClientHostForRunningAction_noClientComponent() throws Exception {
  Injector injector=createNiceMock(Injector.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  StackId stackId=createNiceMock(StackId.class);
  ServiceComponent component1=createNiceMock(ServiceComponent.class);
  ServiceComponent component2=createNiceMock(ServiceComponent.class);
  expect(service.getName()).andReturn("service");
  expect(service.getDesiredStackVersion()).andReturn(stackId);
  expect(stackId.getStackName()).andReturn("stack");
  expect(stackId.getStackVersion()).andReturn("1.0");
  Map<String,ServiceComponent> componentsMap=new HashMap<String,ServiceComponent>();
  componentsMap.put("component1",component1);
  componentsMap.put("component2",component2);
  expect(service.getServiceComponents()).andReturn(componentsMap);
  expect(component1.getServiceComponentHosts()).andReturn(Collections.EMPTY_MAP);
  expect(component2.getServiceComponentHosts()).andReturn(Collections.<String,ServiceComponentHost>singletonMap("anyHost",null));
  ServiceInfo serviceInfo=createNiceMock(ServiceInfo.class);
  expect(serviceInfo.getClientComponent()).andReturn(null);
  expect(ambariMetaInfo.getService("stack","1.0","service")).andReturn(serviceInfo);
  replay(injector,cluster,service,component1,component2,serviceInfo,ambariMetaInfo,stackId);
  AmbariManagementControllerImpl controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  ServiceComponent resultComponent=controller.getClientComponentForRunningAction(cluster,service);
  assertNotNull(resultComponent);
  assertEquals(component2,resultComponent);
  verify(injector,cluster,service,component1,component2,serviceInfo,ambariMetaInfo,stackId);
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetClientHostForRunningAction_componentIsNull() throws Exception {
  Injector injector=createNiceMock(Injector.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent component=null;
  replay(cluster,service,injector);
  AmbariManagementControllerImpl controller=new AmbariManagementControllerImpl(null,clusters,injector);
  String host=controller.getClientHostForRunningAction(cluster,service,component);
  assertNull(host);
  verify(cluster,service,injector);
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetClientHostForRunningAction_componentMapIsEmpty() throws Exception {
  Injector injector=createNiceMock(Injector.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  Map<String,ServiceComponentHost> hostMap=new HashMap<String,ServiceComponentHost>();
  expect(component.getServiceComponentHosts()).andReturn(hostMap);
  replay(cluster,service,component,injector);
  AmbariManagementControllerImpl controller=new AmbariManagementControllerImpl(null,clusters,injector);
  String host=controller.getClientHostForRunningAction(cluster,service,component);
  verify(cluster,service,component,injector);
  assertNull(host);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClientHostForRunningAction_clientComponent() throws Exception {
  Injector injector=createNiceMock(Injector.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  StackId stackId=createNiceMock(StackId.class);
  ServiceComponent component=createNiceMock(ServiceComponent.class);
  expect(service.getName()).andReturn("service");
  expect(service.getServiceComponent("component")).andReturn(component);
  expect(service.getDesiredStackVersion()).andReturn(stackId);
  expect(stackId.getStackName()).andReturn("stack");
  expect(stackId.getStackVersion()).andReturn("1.0");
  ServiceInfo serviceInfo=createNiceMock(ServiceInfo.class);
  ComponentInfo compInfo=createNiceMock(ComponentInfo.class);
  expect(serviceInfo.getClientComponent()).andReturn(compInfo);
  expect(compInfo.getName()).andReturn("component");
  expect(component.getServiceComponentHosts()).andReturn(Collections.<String,ServiceComponentHost>singletonMap("host",null));
  expect(ambariMetaInfo.getService("stack","1.0","service")).andReturn(serviceInfo);
  replay(injector,cluster,service,component,serviceInfo,compInfo,ambariMetaInfo,stackId);
  AmbariManagementControllerImpl controller=new AmbariManagementControllerImpl(null,clusters,injector);
  setAmbariMetaInfo(ambariMetaInfo,controller);
  ServiceComponent resultComponent=controller.getClientComponentForRunningAction(cluster,service);
  assertNotNull(resultComponent);
  assertEquals(component,resultComponent);
  verify(injector,cluster,service,component,serviceInfo,compInfo,ambariMetaInfo,stackId);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariManagementControllerTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServicesSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  clusters.getCluster("foo1").setDesiredStackVersion(new StackId("HDP-0.1"));
  createService(clusterName,serviceName,State.INIT);
  Service s=clusters.getCluster(clusterName).getService(serviceName);
  Assert.assertNotNull(s);
  Assert.assertEquals(serviceName,s.getName());
  Assert.assertEquals(clusterName,s.getCluster().getClusterName());
  ServiceRequest req=new ServiceRequest(clusterName,serviceName,null);
  Set<ServiceResponse> r=ServiceResourceProviderTest.getServices(controller,Collections.singleton(req));
  Assert.assertEquals(1,r.size());
  ServiceResponse resp=r.iterator().next();
  Assert.assertEquals(serviceName,resp.getServiceName());
  Assert.assertEquals(clusterName,resp.getClusterName());
  Assert.assertEquals(State.INIT.toString(),resp.getDesiredState());
  Assert.assertEquals("HDP-0.1",resp.getDesiredStackVersion());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetExecutionCommand() throws Exception {
  testCreateServiceComponentHostSimple();
  String clusterName="foo1";
  String serviceName="HDFS";
  Cluster cluster=clusters.getCluster(clusterName);
  Service s1=cluster.getService(serviceName);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  installService(clusterName,serviceName,false,false);
  ExecutionCommand ec=controller.getExecutionCommand(cluster,s1.getServiceComponent("NAMENODE").getServiceComponentHost("h1"),RoleCommand.START);
  assertEquals("1-0",ec.getCommandId());
  assertEquals("foo1",ec.getClusterName());
  Map<String,Map<String,String>> configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(2,configurations.size());
  assertTrue(configurations.containsKey("hdfs-site"));
  assertTrue(configurations.containsKey("core-site"));
  assertTrue(ec.getConfigurationAttributes().containsKey("hdfs-site"));
  assertTrue(ec.getConfigurationAttributes().containsKey("core-site"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("0",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("false",ec.getCommandParams().get("command_retry_enabled"));
  Map<String,Set<String>> chInfo=ec.getClusterHostInfo();
  assertTrue(chInfo.containsKey("namenode_host"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentMultiple() throws AmbariException, AuthorizationException {
  clusters.addCluster("c1",new StackId("HDP-0.2"));
  clusters.addCluster("c2",new StackId("HDP-0.2"));
  Cluster c1=clusters.getCluster("c1");
  StackId stackId=new StackId("HDP-0.2");
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  c1.addService(s1);
  c1.addService(s2);
  s1.persist();
  s2.persist();
  Set<ServiceComponentRequest> set1=new HashSet<ServiceComponentRequest>();
  ServiceComponentRequest valid1=new ServiceComponentRequest("c1","HDFS","NAMENODE",null);
  ServiceComponentRequest valid2=new ServiceComponentRequest("c1","MAPREDUCE","JOBTRACKER",null);
  ServiceComponentRequest valid3=new ServiceComponentRequest("c1","MAPREDUCE","TASKTRACKER",null);
  set1.add(valid1);
  set1.add(valid2);
  set1.add(valid3);
  ComponentResourceProviderTest.createComponents(controller,set1);
  Assert.assertEquals(1,c1.getService("HDFS").getServiceComponents().size());
  Assert.assertEquals(2,c1.getService("MAPREDUCE").getServiceComponents().size());
  Assert.assertNotNull(c1.getService("HDFS").getServiceComponent("NAMENODE"));
  Assert.assertNotNull(c1.getService("MAPREDUCE").getServiceComponent("JOBTRACKER"));
  Assert.assertNotNull(c1.getService("MAPREDUCE").getServiceComponent("TASKTRACKER"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackServiceComponentCustomCommands() throws Exception {
  StackServiceComponentRequest namenodeRequest=new StackServiceComponentRequest(STACK_NAME,NEW_STACK_VERSION,SERVICE_NAME,COMPONENT_NAME);
  Set<StackServiceComponentResponse> responses=controller.getStackComponents(Collections.singleton(namenodeRequest));
  Assert.assertEquals(1,responses.size());
  StackServiceComponentResponse response=responses.iterator().next();
  assertNotNull(response.getCustomCommands());
  assertEquals(2,response.getCustomCommands().size());
  assertEquals("DECOMMISSION",response.getCustomCommands().get(0));
  assertEquals("REBALANCEHDFS",response.getCustomCommands().get(1));
  StackServiceComponentRequest journalNodeRequest=new StackServiceComponentRequest(STACK_NAME,NEW_STACK_VERSION,SERVICE_NAME,"JOURNALNODE");
  responses=controller.getStackComponents(Collections.singleton(journalNodeRequest));
  Assert.assertEquals(1,responses.size());
  response=responses.iterator().next();
  assertNotNull(response.getCustomCommands());
  assertEquals(0,response.getCustomCommands().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStackVersions() throws Exception {
  StackVersionRequest request=new StackVersionRequest(STACK_NAME,null);
  Set<StackVersionResponse> responses=controller.getStackVersions(Collections.singleton(request));
  Assert.assertEquals(STACK_VERSIONS_CNT,responses.size());
  StackVersionRequest requestWithParams=new StackVersionRequest(STACK_NAME,STACK_VERSION);
  Set<StackVersionResponse> responsesWithParams=controller.getStackVersions(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  for (  StackVersionResponse responseWithParams : responsesWithParams) {
    Assert.assertEquals(responseWithParams.getStackVersion(),STACK_VERSION);
  }
  StackVersionRequest invalidRequest=new StackVersionRequest(STACK_NAME,NON_EXT_VALUE);
  try {
    controller.getStackVersions(Collections.singleton(invalidRequest));
  }
 catch (  StackAccessException e) {
  }
  requestWithParams=new StackVersionRequest(STACK_NAME,"2.1.1");
  responsesWithParams=controller.getStackVersions(Collections.singleton(requestWithParams));
  Assert.assertEquals(1,responsesWithParams.size());
  StackVersionResponse resp=responsesWithParams.iterator().next();
  assertNotNull(resp.getUpgradePacks());
  assertEquals(8,resp.getUpgradePacks().size());
  assertTrue(resp.getUpgradePacks().contains("upgrade_test"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDeleteClusterCreateHost() throws Exception {
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
      properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
      properties.setProperty(Configuration.SERVER_VERSION_FILE,"../version");
      properties.setProperty(Configuration.OS_VERSION_KEY,"centos6");
      properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,"src/test/resources/");
      try {
        install(new ControllerModule(properties));
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  injector.getInstance(GuiceJpaInitializer.class);
  String STACK_ID="HDP-2.0.1";
  Long CLUSTER_ID=1L;
  String CLUSTER_NAME="c1";
  String HOST1="h1";
  String HOST2="h2";
  try {
    Clusters clusters=injector.getInstance(Clusters.class);
    clusters.addHost(HOST1);
    Host host=clusters.getHost(HOST1);
    setOsFamily(host,"redhat","6.3");
    host.persist();
    clusters.addHost(HOST2);
    host=clusters.getHost(HOST2);
    setOsFamily(host,"redhat","6.3");
    host.persist();
    AmbariManagementController amc=injector.getInstance(AmbariManagementController.class);
    ClusterRequest cr=new ClusterRequest(null,CLUSTER_NAME,STACK_ID,null);
    amc.createCluster(cr);
    ConfigurationRequest configRequest=new ConfigurationRequest(CLUSTER_NAME,"global","version1",new HashMap<String,String>(){
{
        put("a","b");
      }
    }
,null);
    cr.setDesiredConfig(Collections.singletonList(configRequest));
    cr.setClusterId(CLUSTER_ID);
    amc.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
    Set<HostRequest> hrs=new HashSet<HostRequest>();
    hrs.add(new HostRequest(HOST1,CLUSTER_NAME,null));
    HostResourceProviderTest.createHosts(amc,hrs);
    Set<ServiceRequest> serviceRequests=new HashSet<ServiceRequest>();
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"HDFS",null));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"MAPREDUCE2",null));
    serviceRequests.add(new ServiceRequest(CLUSTER_NAME,"YARN",null));
    ServiceResourceProviderTest.createServices(amc,serviceRequests);
    Set<ServiceComponentRequest> serviceComponentRequests=new HashSet<ServiceComponentRequest>();
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","SECONDARY_NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","DATANODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"MAPREDUCE2","HISTORYSERVER",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"YARN","RESOURCEMANAGER",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"YARN","NODEMANAGER",null));
    serviceComponentRequests.add(new ServiceComponentRequest(CLUSTER_NAME,"HDFS","HDFS_CLIENT",null));
    ComponentResourceProviderTest.createComponents(amc,serviceComponentRequests);
    Set<ServiceComponentHostRequest> componentHostRequests=new HashSet<ServiceComponentHostRequest>();
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"DATANODE",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"NAMENODE",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"SECONDARY_NAMENODE",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"HISTORYSERVER",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"RESOURCEMANAGER",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"NODEMANAGER",HOST1,null));
    componentHostRequests.add(new ServiceComponentHostRequest(CLUSTER_NAME,null,"HDFS_CLIENT",HOST1,null));
    amc.createHostComponents(componentHostRequests);
    RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS",null,null);
    ExecuteActionRequest ar=new ExecuteActionRequest(CLUSTER_NAME,Role.HDFS_SERVICE_CHECK.name(),null,false);
    ar.getResourceFilters().add(resourceFilter);
    amc.createAction(ar,null);
    amc.deleteCluster(cr);
    assertNotNull(clusters.getHost(HOST1));
    assertNotNull(clusters.getHost(HOST2));
    HostDAO dao=injector.getInstance(HostDAO.class);
    assertNotNull(dao.findByName(HOST1));
    assertNotNull(dao.findByName(HOST2));
  }
  finally {
    injector.getInstance(PersistService.class).stop();
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateClusterWithHostMapping() throws AmbariException, AuthorizationException {
  Set<String> hostNames=new HashSet<String>();
  hostNames.add("h1");
  hostNames.add("h2");
  ClusterRequest r=new ClusterRequest(null,"c1","HDP-0.1",hostNames);
  try {
    controller.createCluster(r);
    fail("Expected create cluster to fail for invalid hosts");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster("c1");
    fail("Expected to fail for non created cluster");
  }
 catch (  ClusterNotFoundException e) {
  }
  clusters.addHost("h1");
  clusters.addHost("h2");
  setOsFamily(clusters.getHost("h1"),"redhat","6.3");
  setOsFamily(clusters.getHost("h2"),"redhat","6.3");
  clusters.getHost("h1").persist();
  clusters.getHost("h2").persist();
  controller.createCluster(r);
  Assert.assertNotNull(clusters.getCluster("c1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceComponentHosts() throws AmbariException, AuthorizationException {
  Cluster c1=setupClusterWithHosts("c1","HDP-0.1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,"centos5");
  Service s1=serviceFactory.createNew(c1,"HDFS");
  c1.addService(s1);
  s1.persist();
  ServiceComponent sc1=serviceComponentFactory.createNew(s1,"DATANODE");
  s1.addServiceComponent(sc1);
  sc1.setDesiredState(State.UNINSTALLED);
  sc1.persist();
  ServiceComponentHost sch1=serviceComponentHostFactory.createNew(sc1,"h1");
  sc1.addServiceComponentHost(sch1);
  sch1.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLING);
  sch1.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  sch1.setStackVersion(new StackId("HDP-0.1"));
  sch1.persist();
  sch1.updateActualConfigs(new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(c1.getClusterName(),null,null,null,null);
  Set<ServiceComponentHostResponse> resps=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(1,resps.size());
  ServiceComponentHostResponse resp=resps.iterator().next();
  Assert.assertEquals(c1.getClusterName(),resp.getClusterName());
  Assert.assertEquals(sc1.getName(),resp.getComponentName());
  Assert.assertEquals(s1.getName(),resp.getServiceName());
  Assert.assertEquals(sch1.getHostName(),resp.getHostname());
  Assert.assertEquals(sch1.getDesiredState().toString(),resp.getDesiredState());
  Assert.assertEquals(sch1.getState().toString(),resp.getLiveState());
  Assert.assertEquals(sch1.getStackVersion().getStackId(),resp.getStackVersion());
  Assert.assertNotNull(resp.getActualConfigs());
  Assert.assertEquals(1,resp.getActualConfigs().size());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentHostSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  try {
    createServiceComponentHost(clusterName,serviceName,componentName1,host1,State.INIT);
    fail("ServiceComponentHost creation should fail for invalid host" + " as host not mapped to cluster");
  }
 catch (  Exception e) {
  }
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  try {
    createServiceComponentHost(clusterName,serviceName,componentName1,host1,State.INSTALLING);
    fail("ServiceComponentHost creation should fail for invalid state");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1);
    fail("ServiceComponentHost creation should have failed earlier");
  }
 catch (  Exception e) {
  }
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  try {
    createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
    fail("ServiceComponentHost creation should fail as duplicate");
  }
 catch (  Exception e) {
  }
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host2));
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,serviceName,componentName2,null,null);
  Set<ServiceComponentHostResponse> response=controller.getHostComponents(Collections.singleton(r));
  Assert.assertEquals(2,response.size());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteComponentsOnHost() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  addHostToCluster(host1,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  installService(clusterName,serviceName,false,false);
  Map<String,ServiceComponentHost> hostComponents=cluster.getService(serviceName).getServiceComponent(componentName1).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  hostComponents=cluster.getService(serviceName).getServiceComponent(componentName2).getServiceComponentHosts();
  for (  Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
    ServiceComponentHost cHost=entry.getValue();
    cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),cluster.getDesiredStackVersion().getStackId()));
    cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
  }
  ServiceComponentHost sch=cluster.getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1);
  Assert.assertNotNull(sch);
  sch.handleEvent(new ServiceComponentHostStartEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  sch.handleEvent(new ServiceComponentHostStartedEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  Set<ServiceComponentHostRequest> schRequests=new HashSet<ServiceComponentHostRequest>();
  schRequests.add(new ServiceComponentHostRequest(clusterName,null,null,host1,null));
  try {
    controller.deleteHostComponents(schRequests);
    fail("Expected exception while deleting all host components.");
  }
 catch (  AmbariException e) {
  }
  Assert.assertEquals(3,cluster.getServiceComponentHosts(host1).size());
  sch.handleEvent(new ServiceComponentHostStopEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  sch.handleEvent(new ServiceComponentHostStoppedEvent(sch.getServiceComponentName(),sch.getHostName(),System.currentTimeMillis()));
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,"DISABLED"));
  updateHostComponents(schRequests,new HashMap<String,String>(),false);
  schRequests.clear();
  schRequests.add(new ServiceComponentHostRequest(clusterName,null,null,host1,null));
  controller.deleteHostComponents(schRequests);
  Assert.assertEquals(0,cluster.getServiceComponentHosts(host1).size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateRepoUrl() throws Exception {
  String INCORRECT_URL_2="http://bar.com/foo";
  RepositoryInfo repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertNotNull(repo);
  assertNotNull(repo.getBaseUrl());
  String original=repo.getBaseUrl();
  repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertEquals(original,repo.getBaseUrl());
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID,INCORRECT_BASE_URL);
  repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertEquals(INCORRECT_BASE_URL,repo.getBaseUrl());
  assertEquals(original,repo.getDefaultBaseUrl());
  ambariMetaInfo.updateRepoBaseURL(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID,INCORRECT_URL_2);
  repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertFalse(INCORRECT_BASE_URL.equals(repo.getBaseUrl()));
  assertEquals(INCORRECT_URL_2,repo.getBaseUrl());
  assertEquals(original,repo.getDefaultBaseUrl());
  Configuration configuration=injector.getInstance(Configuration.class);
  Properties properties=configuration.getProperties();
  properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
  properties.setProperty(Configuration.SERVER_VERSION_FILE,"src/test/resources/version");
  Configuration newConfiguration=new Configuration(properties);
  AmbariMetaInfo ami=new AmbariMetaInfo(newConfiguration);
  injector.injectMembers(ami);
  ami.init();
  repo=ami.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertEquals(INCORRECT_URL_2,repo.getBaseUrl());
  assertNotNull(repo.getDefaultBaseUrl());
  assertEquals(original,repo.getDefaultBaseUrl());
  ami.updateRepoBaseURL(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID,original);
  repo=ami.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  assertEquals(original,repo.getBaseUrl());
  assertEquals(original,repo.getDefaultBaseUrl());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientServiceSmokeTests() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="PIG";
  createService(clusterName,serviceName,null);
  String componentName1="PIG";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,null,componentName1,host2,null);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      Assert.assertEquals(State.INIT,sch.getState());
    }
  }
  List<ShortTaskStatus> taskStatuses=trackAction.getTasks();
  Assert.assertEquals(2,taskStatuses.size());
  List<Stage> stages=actionDB.getAllStages(trackAction.getRequestId());
  Assert.assertEquals(1,stages.size());
  Assert.assertEquals("Called from a test",stages.get(0).getRequestContext());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      sch.setState(State.INSTALLED);
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  injector.getInstance(ActionMetadata.class).addServiceCheckAction("PIG");
  trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertNotNull(trackAction);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      Assert.assertEquals(State.INSTALLED,sch.getState());
    }
  }
  stages=actionDB.getAllStages(trackAction.getRequestId());
  for (  Stage s : stages) {
    LOG.info("Stage dump : " + s.toString());
  }
  Assert.assertEquals(1,stages.size());
  taskStatuses=trackAction.getTasks();
  Assert.assertEquals(1,taskStatuses.size());
  Assert.assertEquals(Role.PIG_SERVICE_CHECK.toString(),taskStatuses.get(0).getRole());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReConfigureService() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      sch.setState(State.INSTALLED);
    }
  }
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2, cr3;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  cr3=new ConfigurationRequest(clusterName,"core-site","version122",configs,null);
  controller.createConfiguration(cr1);
  controller.createConfiguration(cr2);
  controller.createConfiguration(cr3);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  ServiceComponent sc1=s.getServiceComponent(componentName1);
  ServiceComponent sc2=s.getServiceComponent(componentName2);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  Set<ServiceComponentHostRequest> schReqs=new HashSet<ServiceComponentHostRequest>();
  Set<ServiceComponentRequest> scReqs=new HashSet<ServiceComponentRequest>();
  Set<ServiceRequest> sReqs=new HashSet<ServiceRequest>();
  Map<String,String> configVersions=new HashMap<String,String>();
  configVersions.clear();
  configVersions.put("core-site","version1");
  configVersions.put("hdfs-site","version1");
  schReqs.clear();
  schReqs.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  Assert.assertNull(updateHostComponents(schReqs,Collections.<String,String>emptyMap(),true));
  configVersions.clear();
  configVersions.put("core-site","version122");
  schReqs.clear();
  schReqs.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  Assert.assertNull(updateHostComponents(schReqs,Collections.<String,String>emptyMap(),true));
  entityManager.clear();
  configVersions.clear();
  configVersions.put("core-site","version1");
  configVersions.put("hdfs-site","version1");
  scReqs.add(new ServiceComponentRequest(clusterName,serviceName,componentName2,null));
  Assert.assertNull(ComponentResourceProviderTest.updateComponents(controller,scReqs,Collections.<String,String>emptyMap(),true));
  scReqs.add(new ServiceComponentRequest(clusterName,serviceName,componentName1,null));
  Assert.assertNull(ComponentResourceProviderTest.updateComponents(controller,scReqs,Collections.<String,String>emptyMap(),true));
  configVersions.clear();
  configVersions.put("core-site","version122");
  scReqs.clear();
  scReqs.add(new ServiceComponentRequest(clusterName,serviceName,componentName2,null));
  Assert.assertNull(ComponentResourceProviderTest.updateComponents(controller,scReqs,Collections.<String,String>emptyMap(),true));
  scReqs.clear();
  scReqs.add(new ServiceComponentRequest(clusterName,serviceName,componentName1,null));
  Assert.assertNull(ComponentResourceProviderTest.updateComponents(controller,scReqs,Collections.<String,String>emptyMap(),true));
  entityManager.clear();
  configVersions.clear();
  configVersions.put("core-site","version1");
  configVersions.put("hdfs-site","version1");
  sReqs.clear();
  sReqs.add(new ServiceRequest(clusterName,serviceName,null));
  Assert.assertNull(ServiceResourceProviderTest.updateServices(controller,sReqs,mapRequestProps,true,false));
  configVersions.clear();
  configVersions.put("core-site","version122");
  sReqs.clear();
  sReqs.add(new ServiceRequest(clusterName,serviceName,null));
  Assert.assertNull(ServiceResourceProviderTest.updateServices(controller,sReqs,mapRequestProps,true,false));
  entityManager.clear();
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateRepoUrlController() throws Exception {
  String badUrl="http://hortonworks.com";
  RepositoryInfo repo=ambariMetaInfo.getRepository(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  RepositoryRequest request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl(badUrl);
  Set<RepositoryRequest> requests=new HashSet<RepositoryRequest>();
  requests.add(request);
  try {
    controller.updateRepositories(requests);
    Assert.fail("Expected a bad URL to throw an exception");
  }
 catch (  Exception e) {
    assertNotNull(e);
    Assert.assertTrue(e.getMessage().contains(badUrl));
  }
  request.setVerifyBaseUrl(false);
  controller.updateRepositories(requests);
  Assert.assertEquals(request.getBaseUrl(),repo.getBaseUrl());
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("https://hortonworks.com");
  requests.add(request);
  controller.updateRepositories(requests);
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("pro://hortonworks.com");
  requests.add(request);
  try {
    controller.updateRepositories(requests);
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Could not access base url"));
  }
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl("http://rrr1.cccc");
  requests.add(request);
  try {
    controller.updateRepositories(requests);
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
  }
  requests.clear();
  request=new RepositoryRequest(STACK_NAME,STACK_VERSION,OS_TYPE,REPO_ID);
  request.setBaseUrl(repo.getDefaultBaseUrl());
  requests.add(request);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(repo.getBaseUrl(),repo.getDefaultBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  String baseUrl=repo.getDefaultBaseUrl();
  if (!baseUrl.endsWith("/")) {
    baseUrl+="/";
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_UBUNTU,"/repodata/repomd.xml");
  Assert.assertTrue(baseUrl.endsWith("/") && configuration.getRepoValidationSuffixes("ubuntu12")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_DEFAULT,"repodata/repomd.xml");
  Assert.assertTrue(baseUrl.endsWith("/") && !configuration.getRepoValidationSuffixes("redhat6")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  baseUrl=baseUrl.substring(0,baseUrl.length() - 1);
  Assert.assertTrue(!baseUrl.endsWith("/") && !configuration.getRepoValidationSuffixes("redhat6")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_DEFAULT,"/repodata/repomd.xml");
  Assert.assertTrue(!baseUrl.endsWith("/") && configuration.getRepoValidationSuffixes("suse11")[0].startsWith("/"));
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
  backingProperties.setProperty(Configuration.REPO_SUFFIX_KEY_UBUNTU,"/foo/bar.xml,/repodata/repomd.xml");
  Assert.assertTrue(configuration.getRepoValidationSuffixes("ubuntu12").length > 1);
  request.setBaseUrl(baseUrl);
  try {
    controller.updateRepositories(requests);
    Assert.assertEquals(baseUrl,repo.getBaseUrl());
  }
 catch (  Exception e) {
    String exceptionMsg=e.getMessage();
    assertTrue(exceptionMsg.contains("Could not access base url"));
    LOG.error("Can not complete test. " + exceptionMsg);
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReConfigureServiceClient() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName1="HDFS";
  String serviceName2="MAPREDUCE";
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  String componentName4="JOBTRACKER";
  String componentName5="TASKTRACKER";
  String componentName6="MAPREDUCE_CLIENT";
  createService(clusterName,serviceName1,null);
  createService(clusterName,serviceName2,null);
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName4,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName5,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName6,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName1,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName2,componentName4,host1,null);
  createServiceComponentHost(clusterName,serviceName2,componentName5,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName2,componentName6,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host3,null);
  createServiceComponentHost(clusterName,serviceName2,componentName6,host3,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  Map<String,String> configs2=new HashMap<String,String>();
  configs2.put("c","d");
  Map<String,String> configs3=new HashMap<String,String>();
  ConfigurationRequest cr1, cr2, cr3, cr4;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  cr4=new ConfigurationRequest(clusterName,"kerberos-env","version1",configs3,null);
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"kerberos-env",new HashMap<String,String>(),new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  cluster.addConfig(config1);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr4));
  controller.updateClusters(Collections.singleton(crReq),null);
  long requestId1=installService(clusterName,serviceName1,true,false);
  List<Stage> stages=actionDB.getAllStages(requestId1);
  Assert.assertEquals(3,stages.get(0).getOrderedHostRoleCommands().get(0).getExecutionCommandWrapper().getExecutionCommand().getConfigurationTags().size());
  installService(clusterName,serviceName2,false,false);
  startService(clusterName,serviceName1,true,false);
  startService(clusterName,serviceName2,true,false);
  cr3=new ConfigurationRequest(clusterName,"core-site","version122",configs2,null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr3));
  controller.updateClusters(Collections.singleton(crReq),null);
  stopService(clusterName,serviceName1,false,false);
  stopService(clusterName,serviceName2,false,false);
  long requestId2=startService(clusterName,serviceName1,true,true);
  long requestId3=startService(clusterName,serviceName2,true,true);
  stages=new ArrayList<>();
  stages.addAll(actionDB.getAllStages(requestId2));
  stages.addAll(actionDB.getAllStages(requestId3));
  HostRoleCommand hdfsCmdHost3=null;
  HostRoleCommand hdfsCmdHost2=null;
  HostRoleCommand mapRedCmdHost2=null;
  HostRoleCommand mapRedCmdHost3=null;
  for (  Stage stage : stages) {
    List<HostRoleCommand> hrcs=stage.getOrderedHostRoleCommands();
    for (    HostRoleCommand hrc : hrcs) {
      LOG.debug("role: " + hrc.getRole());
      if (hrc.getRole().toString().equals("HDFS_CLIENT")) {
        if (hrc.getHostName().equals(host3)) {
          hdfsCmdHost3=hrc;
        }
 else         if (hrc.getHostName().equals(host2)) {
          hdfsCmdHost2=hrc;
        }
      }
      if (hrc.getRole().toString().equals("MAPREDUCE_CLIENT")) {
        if (hrc.getHostName().equals(host2)) {
          mapRedCmdHost2=hrc;
        }
 else         if (hrc.getHostName().equals(host3)) {
          mapRedCmdHost3=hrc;
        }
      }
    }
  }
  Assert.assertNotNull(hdfsCmdHost3);
  Assert.assertNotNull(hdfsCmdHost2);
  ExecutionCommand execCmd=hdfsCmdHost3.getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals(3,execCmd.getConfigurationTags().size());
  Assert.assertEquals("version122",execCmd.getConfigurationTags().get("core-site").get("tag"));
  Assert.assertEquals("d",execCmd.getConfigurations().get("core-site").get("c"));
  Assert.assertNotNull(mapRedCmdHost2);
  Assert.assertNotNull(mapRedCmdHost3);
  stopService(clusterName,serviceName1,false,false);
  stopService(clusterName,serviceName2,false,false);
  clusters.getHost(host2).setState(HostState.HEARTBEAT_LOST);
  requestId3=startService(clusterName,serviceName2,true,true);
  stages=actionDB.getAllStages(requestId3);
  HostRoleCommand clientWithHostDown=null;
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().toString().equals("MAPREDUCE_CLIENT") && hrc.getHostName().equals(host2)) {
        clientWithHostDown=hrc;
      }
    }
  }
  Assert.assertNull(clientWithHostDown);
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService("MAPREDUCE").getServiceComponent("TASKTRACKER").getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHost(host1).getState());
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService("HDFS").getServiceComponent("DATANODE").getServiceComponentHost(host1).getState());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplyConfigurationWithTheSameTag() throws AuthorizationException {
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
      properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
      properties.setProperty(Configuration.SERVER_VERSION_FILE,"src/test/resources/version");
      properties.setProperty(Configuration.OS_VERSION_KEY,"centos6");
      properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,"src/test/resources/");
      try {
        install(new ControllerModule(properties));
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  injector.getInstance(GuiceJpaInitializer.class);
  try {
    String tag="version1";
    String type="core-site";
    AmbariException exception=null;
    try {
      AmbariManagementController amc=injector.getInstance(AmbariManagementController.class);
      Clusters clusters=injector.getInstance(Clusters.class);
      Gson gson=new Gson();
      clusters.addHost("host1");
      clusters.addHost("host2");
      clusters.addHost("host3");
      Host host=clusters.getHost("host1");
      setOsFamily(host,"redhat","6.3");
      host.persist();
      host=clusters.getHost("host2");
      setOsFamily(host,"redhat","6.3");
      host.persist();
      host=clusters.getHost("host3");
      setOsFamily(host,"redhat","6.3");
      host.persist();
      ClusterRequest clusterRequest=new ClusterRequest(null,"c1","HDP-1.2.0",null);
      amc.createCluster(clusterRequest);
      Set<ServiceRequest> serviceRequests=new HashSet<ServiceRequest>();
      serviceRequests.add(new ServiceRequest("c1","HDFS",null));
      ServiceResourceProviderTest.createServices(amc,serviceRequests);
      Type confType=new TypeToken<Map<String,String>>(){
      }
.getType();
      ConfigurationRequest configurationRequest=new ConfigurationRequest("c1",type,tag,gson.<Map<String,String>>fromJson("{ \"fs.default.name\" : \"localhost:8020\"}",confType),null);
      amc.createConfiguration(configurationRequest);
      amc.createConfiguration(configurationRequest);
    }
 catch (    AmbariException e) {
      exception=e;
    }
    assertNotNull(exception);
    String exceptionMessage=MessageFormat.format("Configuration with tag ''{0}'' exists for ''{1}''",tag,type);
    org.junit.Assert.assertEquals(exceptionMessage,exception.getMessage());
  }
  finally {
    injector.getInstance(PersistService.class).stop();
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigsAttachedToServiceChecks() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  installService(clusterName,serviceName,false,false);
  long requestId=startService(clusterName,serviceName,true,false);
  List<Stage> stages=actionDB.getAllStages(requestId);
  boolean serviceCheckFound=false;
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HDFS_SERVICE_CHECK)) {
        serviceCheckFound=true;
        Assert.assertEquals(2,hrc.getExecutionCommandWrapper().getExecutionCommand().getConfigurationTags().size());
      }
    }
  }
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    Map<String,String> hostParamsStage=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
    Assert.assertNotNull(hostParamsStage.get("jdk_location"));
  }
  Assert.assertEquals(true,serviceCheckFound);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigGroupOverridesWithDecommissionDatanode() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.7"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  installService(clusterName,serviceName,false,false);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2;
  cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  startService(clusterName,serviceName,false,false);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  final Config config=new ConfigImpl("hdfs-site");
  config.setProperties(configs);
  config.setTag("version122");
  Long groupId=createConfigGroup(clusters.getCluster(clusterName),"g1","t1",new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
      put("excluded_hosts"," h1 ");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  ExecuteActionRequest request=new ExecuteActionRequest(clusterName,"DECOMMISSION",params,false);
  request.getResourceFilters().add(resourceFilter);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(request,requestProperties);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  ExecutionCommand execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertNotNull(execCmd.getConfigurationTags().get("hdfs-site"));
  Assert.assertEquals(1,storedTasks.size());
  HostRoleCommand command=storedTasks.get(0);
  Assert.assertEquals(Role.NAMENODE,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServicesWithInvalidRequest() throws AmbariException, AuthorizationException {
  Set<ServiceRequest> set1=new HashSet<ServiceRequest>();
  try {
    set1.clear();
    ServiceRequest rInvalid=new ServiceRequest(null,null,null);
    set1.add(rInvalid);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest rInvalid=new ServiceRequest("foo",null,null);
    set1.add(rInvalid);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest rInvalid=new ServiceRequest("foo","bar",null);
    set1.add(rInvalid);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid cluster");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(checkExceptionType(e,ClusterNotFoundException.class));
  }
  clusters.addCluster("foo",new StackId("HDP-0.1"));
  clusters.addCluster("bar",new StackId("HDP-0.1"));
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
    ServiceRequest valid2=new ServiceRequest("foo","HDFS",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","bar",null);
    set1.add(valid1);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid service");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
    ServiceRequest valid2=new ServiceRequest("bar","HDFS",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for multiple clusters");
  }
 catch (  Exception e) {
  }
  Assert.assertNotNull(clusters.getCluster("foo"));
  Assert.assertEquals(0,clusters.getCluster("foo").getServices().size());
  set1.clear();
  ServiceRequest valid=new ServiceRequest("foo","HDFS",null);
  set1.add(valid);
  ServiceResourceProviderTest.createServices(controller,set1);
  try {
    set1.clear();
    ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
    ServiceRequest valid2=new ServiceRequest("foo","HDFS",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for existing service");
  }
 catch (  Exception e) {
  }
  Assert.assertEquals(1,clusters.getCluster("foo").getServices().size());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceStopWhileStopping() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host2));
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      sch.setState(State.INSTALLED);
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (!sch.getServiceComponentName().equals("HDFS_CLIENT")) {
        sch.setState(State.STARTED);
      }
    }
  }
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  clusters.getCluster(clusterName).getService(serviceName).setDesiredState(State.STOPPING);
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (!sch.getServiceComponentName().equals("HDFS_CLIENT")) {
        Assert.assertEquals(State.STARTED,sch.getDesiredState());
        sch.setState(State.STOPPING);
      }
 else       if (sch.getServiceComponentName().equals("DATANODE")) {
        ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName,sch.getServiceComponentName(),sch.getHostName(),State.INSTALLED.name());
        Set<ServiceComponentHostRequest> reqs1=new HashSet<ServiceComponentHostRequest>();
        reqs1.add(r1);
        updateHostComponents(reqs1,Collections.<String,String>emptyMap(),true);
        Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      }
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  requests.clear();
  requests.add(r);
  ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (!sch.getServiceComponentName().equals("HDFS_CLIENT")) {
        Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComponentCategorySentWithRestart() throws AmbariException, AuthorizationException {
  setupClusterWithHosts("c1","HDP-2.0.7",new ArrayList<String>(){
{
      add("h1");
    }
  }
,"centos5");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.7"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.7"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  installService("c1","HDFS",false,false);
  startService("c1","HDFS",false,false);
  Cluster c=clusters.getCluster("c1");
  Service s=c.getService("HDFS");
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  for (  ServiceComponent sc : s.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sc.isClientComponent()) {
        Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      }
 else {
        Assert.assertEquals(State.STARTED,sch.getDesiredState());
      }
    }
  }
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","HDFS_CLIENT",new ArrayList<String>(){
{
      add("h1");
    }
  }
);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","RESTART",params,false);
  actionRequest.getResourceFilters().add(resourceFilter);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  requestProperties.put("hdfs_client","abc");
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  List<Stage> stages=actionDB.getAllStages(response.getRequestId());
  Assert.assertNotNull(stages);
  HostRoleCommand hrc=null;
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : stages) {
    for (    HostRoleCommand cmd : stage.getOrderedHostRoleCommands()) {
      if (cmd.getRole().equals(Role.HDFS_CLIENT)) {
        hrc=cmd;
      }
      Map<String,String> hostParamStage=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
      Assert.assertTrue(hostParamStage.containsKey(ExecutionCommand.KeyNames.DB_DRIVER_FILENAME));
      Assert.assertTrue(hostParamStage.containsKey(ExecutionCommand.KeyNames.MYSQL_JDBC_URL));
      Assert.assertTrue(hostParamStage.containsKey(ExecutionCommand.KeyNames.ORACLE_JDBC_URL));
    }
  }
  Assert.assertNotNull(hrc);
  Assert.assertEquals("RESTART HDFS/HDFS_CLIENT",hrc.getCommandDetail());
  Map<String,String> roleParams=hrc.getExecutionCommandWrapper().getExecutionCommand().getRoleParams();
  Assert.assertNotNull(roleParams);
  Assert.assertEquals("CLIENT",roleParams.get(ExecutionCommand.KeyNames.COMPONENT_CATEGORY));
  Assert.assertTrue(hrc.getExecutionCommandWrapper().getExecutionCommand().getCommandParams().containsKey("hdfs_client"));
  Assert.assertEquals("abc",hrc.getExecutionCommandWrapper().getExecutionCommand().getCommandParams().get("hdfs_client"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyConfigs() throws Exception {
  String clusterName="c1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  ClusterRequest cr=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),null,null);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v1",null,null)));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  Config config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNull(config);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v1",new HashMap<String,String>(),new HashMap<String,Map<String,String>>())));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNotNull(config);
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v2",new HashMap<String,String>(),new HashMap<String,Map<String,String>>())));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNotNull(config);
  Assert.assertEquals(Integer.valueOf(0),Integer.valueOf(config.getProperties().size()));
  Map<String,String> map=new HashMap<String,String>();
  map.clear();
  map.put("c","d");
  Map<String,Map<String,String>> attributesMap=new HashMap<String,Map<String,String>>();
  attributesMap.put("final",new HashMap<String,String>());
  attributesMap.get("final").put("c","true");
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v3",map,attributesMap)));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertNotNull(config);
  Assert.assertTrue(config.getProperties().containsKey("c"));
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v2",new HashMap<String,String>(),new HashMap<String,Map<String,String>>())));
  controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
  config=cluster.getDesiredConfigByType("typeA");
  Assert.assertEquals("v2",config.getTag());
  Assert.assertNotNull(config);
  Assert.assertEquals(Integer.valueOf(0),Integer.valueOf(config.getProperties().size()));
  cr.setDesiredConfig(Collections.singletonList(new ConfigurationRequest(clusterName,"typeA","v2",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>(){
{
      put("final",new HashMap<String,String>(){
{
          put("a","true");
        }
      }
);
    }
  }
)));
  try {
    controller.updateClusters(Collections.singleton(cr),new HashMap<String,String>());
    Assert.fail("Expect failure when creating a config that exists");
  }
 catch (  AmbariException e) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testDisableAndDeleteStates() throws Exception {
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
      properties.setProperty(Configuration.METADATA_DIR_PATH,"src/test/resources/stacks");
      properties.setProperty(Configuration.SERVER_VERSION_FILE,"src/test/resources/version");
      properties.setProperty(Configuration.OS_VERSION_KEY,"centos5");
      properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,"src/test/resources/");
      try {
        install(new ControllerModule(properties));
        bind(AmbariEventPublisher.class).toInstance(EasyMock.createMock(AmbariEventPublisher.class));
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  injector.getInstance(GuiceJpaInitializer.class);
  try {
    AmbariManagementController amc=injector.getInstance(AmbariManagementController.class);
    Clusters clusters=injector.getInstance(Clusters.class);
    Gson gson=new Gson();
    clusters.addHost("host1");
    clusters.addHost("host2");
    clusters.addHost("host3");
    Host host=clusters.getHost("host1");
    setOsFamily(host,"redhat","5.9");
    host.persist();
    host=clusters.getHost("host2");
    setOsFamily(host,"redhat","5.9");
    host.persist();
    host=clusters.getHost("host3");
    setOsFamily(host,"redhat","5.9");
    host.persist();
    ClusterRequest clusterRequest=new ClusterRequest(null,"c1","HDP-1.2.0",null);
    amc.createCluster(clusterRequest);
    Set<ServiceRequest> serviceRequests=new HashSet<ServiceRequest>();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    serviceRequests.add(new ServiceRequest("c1","HIVE",null));
    ServiceResourceProviderTest.createServices(amc,serviceRequests);
    Type confType=new TypeToken<Map<String,String>>(){
    }
.getType();
    ConfigurationRequest configurationRequest=new ConfigurationRequest("c1","core-site","version1",gson.<Map<String,String>>fromJson("{ \"fs.default.name\" : \"localhost:8020\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","hdfs-site","version1",gson.<Map<String,String>>fromJson("{ \"dfs.datanode.data.dir.perm\" : \"750\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","global","version1",gson.<Map<String,String>>fromJson("{ \"hive.server2.enable.doAs\" : \"true\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    Assert.assertTrue(clusters.getCluster("c1").getDesiredConfigs().containsKey("hive-site"));
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    Set<ServiceComponentRequest> serviceComponentRequests=new HashSet<ServiceComponentRequest>();
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","SECONDARY_NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","DATANODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null));
    ComponentResourceProviderTest.createComponents(amc,serviceComponentRequests);
    Set<HostRequest> hostRequests=new HashSet<HostRequest>();
    hostRequests.add(new HostRequest("host1","c1",null));
    hostRequests.add(new HostRequest("host2","c1",null));
    hostRequests.add(new HostRequest("host3","c1",null));
    HostResourceProviderTest.createHosts(amc,hostRequests);
    Set<ServiceComponentHostRequest> componentHostRequests=new HashSet<ServiceComponentHostRequest>();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"SECONDARY_NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host3",null));
    amc.createHostComponents(componentHostRequests);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","INSTALLED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    Cluster cluster=clusters.getCluster("c1");
    Map<String,ServiceComponentHost> namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes.size());
    ServiceComponentHost componentHost=namenodes.get("host1");
    Map<String,ServiceComponentHost> hostComponents=cluster.getService("HDFS").getServiceComponent("DATANODE").getServiceComponentHosts();
    for (    Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
      ServiceComponentHost cHost=entry.getValue();
      cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
      cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
    }
    hostComponents=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    for (    Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
      ServiceComponentHost cHost=entry.getValue();
      cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
      cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
    }
    hostComponents=cluster.getService("HDFS").getServiceComponent("SECONDARY_NAMENODE").getServiceComponentHosts();
    for (    Map.Entry<String,ServiceComponentHost> entry : hostComponents.entrySet()) {
      ServiceComponentHost cHost=entry.getValue();
      cHost.handleEvent(new ServiceComponentHostInstallEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
      cHost.handleEvent(new ServiceComponentHostOpSucceededEvent(cHost.getServiceComponentName(),cHost.getHostName(),System.currentTimeMillis()));
    }
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","DISABLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    Assert.assertEquals(State.DISABLED,componentHost.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","INSTALLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    Assert.assertEquals(State.INSTALLED,componentHost.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","DISABLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    Assert.assertEquals(State.DISABLED,componentHost.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host2",null));
    amc.createHostComponents(componentHostRequests);
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host2","INSTALLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    Assert.assertEquals(2,namenodes.size());
    componentHost=namenodes.get("host2");
    componentHost.handleEvent(new ServiceComponentHostInstallEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
    componentHost.handleEvent(new ServiceComponentHostOpSucceededEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis()));
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","STARTED"));
    RequestStatusResponse response=ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    for (    ShortTaskStatus shortTaskStatus : response.getTasks()) {
      assertFalse("host1".equals(shortTaskStatus.getHostName()) && "NAMENODE".equals(shortTaskStatus.getRole()));
    }
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    amc.deleteHostComponents(componentHostRequests);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes.size());
    testRunSmokeTestFlag(mapRequestProps,amc,serviceRequests);
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    amc.createHostComponents(componentHostRequests);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    assertEquals(2,namenodes.size());
    componentHost=namenodes.get("host1");
    componentHost.handleEvent(new ServiceComponentHostInstallEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis(),"HDP-1.2.0"));
    componentHost.handleEvent(new ServiceComponentHostOpSucceededEvent(componentHost.getServiceComponentName(),componentHost.getHostName(),System.currentTimeMillis()));
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1","INSTALLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,true);
    assertEquals(State.INSTALLED,namenodes.get("host1").getState());
    ServiceComponentHost sch=null;
    for (    ServiceComponentHost tmp : cluster.getServiceComponentHosts("host2")) {
      if (tmp.getServiceComponentName().equals("DATANODE")) {
        tmp.setState(State.UNKNOWN);
        sch=tmp;
      }
    }
    assertNotNull(sch);
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2","DISABLED"));
    updateHostComponents(amc,componentHostRequests,mapRequestProps,false);
    org.junit.Assert.assertEquals(State.DISABLED,sch.getState());
    componentHostRequests.clear();
    mapRequestProps.put(RequestOperationLevel.OPERATION_CLUSTER_ID,"c1");
    updateHostComponents(amc,componentHostRequests,mapRequestProps,false);
    org.junit.Assert.assertEquals(State.DISABLED,sch.getState());
    mapRequestProps.clear();
    assertEquals(sch.getServiceComponentName(),"DATANODE");
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","INSTALLED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    assertEquals(State.DISABLED,sch.getState());
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","STARTED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    assertEquals(State.DISABLED,sch.getState());
    componentHostRequests.clear();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2",null));
    amc.deleteHostComponents(componentHostRequests);
    sch=null;
    for (    ServiceComponentHost tmp : cluster.getServiceComponentHosts("host2")) {
      if (tmp.getServiceComponentName().equals("DATANODE")) {
        sch=tmp;
      }
    }
    org.junit.Assert.assertNull(sch);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS","INSTALLED"));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1",null,null));
    org.junit.Assert.assertEquals(2,ServiceResourceProviderTest.getServices(amc,serviceRequests).size());
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    serviceRequests.add(new ServiceRequest("c1","HIVE",null));
    ServiceResourceProviderTest.deleteServices(amc,serviceRequests);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1",null,null));
    org.junit.Assert.assertEquals(0,ServiceResourceProviderTest.getServices(amc,serviceRequests).size());
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    ServiceResourceProviderTest.createServices(amc,serviceRequests);
    org.junit.Assert.assertEquals(1,ServiceResourceProviderTest.getServices(amc,serviceRequests).size());
    configurationRequest=new ConfigurationRequest("c1","core-site","version2",gson.<Map<String,String>>fromJson("{ \"fs.default.name\" : \"localhost:8020\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","hdfs-site","version2",gson.<Map<String,String>>fromJson("{ \"dfs.datanode.data.dir.perm\" : \"750\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    configurationRequest=new ConfigurationRequest("c1","global","version2",gson.<Map<String,String>>fromJson("{ \"hbase_hdfs_root_dir\" : \"/apps/hbase/\"}",confType),null);
    amc.createConfiguration(configurationRequest);
    serviceRequests.clear();
    serviceRequests.add(new ServiceRequest("c1","HDFS",null));
    ServiceResourceProviderTest.updateServices(amc,serviceRequests,mapRequestProps,true,false);
    serviceComponentRequests=new HashSet<ServiceComponentRequest>();
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","SECONDARY_NAMENODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","DATANODE",null));
    serviceComponentRequests.add(new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null));
    ComponentResourceProviderTest.createComponents(amc,serviceComponentRequests);
    componentHostRequests=new HashSet<ServiceComponentHostRequest>();
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"SECONDARY_NAMENODE","host1",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host2",null));
    componentHostRequests.add(new ServiceComponentHostRequest("c1",null,"DATANODE","host3",null));
    amc.createHostComponents(componentHostRequests);
    namenodes=cluster.getService("HDFS").getServiceComponent("NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes.size());
    Map<String,ServiceComponentHost> datanodes=cluster.getService("HDFS").getServiceComponent("DATANODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(3,datanodes.size());
    Map<String,ServiceComponentHost> namenodes2=cluster.getService("HDFS").getServiceComponent("SECONDARY_NAMENODE").getServiceComponentHosts();
    org.junit.Assert.assertEquals(1,namenodes2.size());
  }
  finally {
    injector.getInstance(PersistService.class).stop();
  }
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigGroupOverridesWithServiceCheckActions() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  installService(clusterName,serviceName,false,false);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  final Config config=new ConfigImpl("hdfs-site");
  config.setProperties(configs);
  config.setTag("version122");
  Long groupId=createConfigGroup(clusters.getCluster(clusterName),"g1","t1",new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  long requestId=startService(clusterName,serviceName,true,false);
  HostRoleCommand smokeTestCmd=null;
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HDFS_SERVICE_CHECK)) {
        Assert.assertEquals(2,hrc.getExecutionCommandWrapper().getExecutionCommand().getConfigurationTags().size());
        smokeTestCmd=hrc;
      }
    }
  }
  Assert.assertNotNull(smokeTestCmd);
  Assert.assertEquals("c",smokeTestCmd.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("hdfs-site").get("a"));
}

</code></pre>

<br>
<pre class="type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateConfigForRunningService() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host2));
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      sch.setState(State.INSTALLED);
    }
  }
  r=new ServiceRequest(clusterName,serviceName,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      sch.setState(State.STARTED);
    }
  }
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponent sc : clusters.getCluster(clusterName).getService(serviceName).getServiceComponents().values()) {
    if (sc.getName().equals("HDFS_CLIENT")) {
      Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
    }
 else {
      Assert.assertEquals(State.STARTED,sc.getDesiredState());
    }
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      if (sch.getServiceComponentName().equals("HDFS_CLIENT")) {
        Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
      }
 else {
        Assert.assertEquals(State.STARTED,sch.getDesiredState());
      }
    }
  }
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2, cr3, cr4, cr5, cr6, cr7, cr8;
  cr1=new ConfigurationRequest(clusterName,"typeA","v1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"typeB","v1",configs,null);
  cr3=new ConfigurationRequest(clusterName,"typeC","v1",configs,null);
  cr4=new ConfigurationRequest(clusterName,"typeD","v1",configs,null);
  cr5=new ConfigurationRequest(clusterName,"typeA","v2",configs,null);
  cr6=new ConfigurationRequest(clusterName,"typeB","v2",configs,null);
  cr7=new ConfigurationRequest(clusterName,"typeC","v2",configs,null);
  cr8=new ConfigurationRequest(clusterName,"typeE","v1",configs,null);
  controller.createConfiguration(cr1);
  controller.createConfiguration(cr2);
  controller.createConfiguration(cr3);
  controller.createConfiguration(cr4);
  controller.createConfiguration(cr5);
  controller.createConfiguration(cr6);
  controller.createConfiguration(cr7);
  controller.createConfiguration(cr8);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  ServiceComponent sc1=s.getServiceComponent(componentName1);
  ServiceComponent sc2=s.getServiceComponent(componentName2);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  Set<ServiceComponentHostRequest> schReqs=new HashSet<ServiceComponentHostRequest>();
  Set<ServiceComponentRequest> scReqs=new HashSet<ServiceComponentRequest>();
  Set<ServiceRequest> sReqs=new HashSet<ServiceRequest>();
  Map<String,String> configVersions=new HashMap<String,String>();
  configVersions.clear();
  configVersions.put("typeA","v1");
  configVersions.put("typeB","v1");
  configVersions.put("typeC","v1");
  schReqs.clear();
  schReqs.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  Assert.assertNull(updateHostComponents(schReqs,Collections.<String,String>emptyMap(),true));
  configVersions.clear();
  configVersions.put("typeC","v1");
  configVersions.put("typeD","v1");
  scReqs.clear();
  scReqs.add(new ServiceComponentRequest(clusterName,serviceName,componentName2,null));
  Assert.assertNull(ComponentResourceProviderTest.updateComponents(controller,scReqs,Collections.<String,String>emptyMap(),true));
  configVersions.clear();
  configVersions.put("typeA","v2");
  configVersions.put("typeC","v2");
  configVersions.put("typeE","v1");
  sReqs.clear();
  sReqs.add(new ServiceRequest(clusterName,serviceName,null));
  Assert.assertNull(ServiceResourceProviderTest.updateServices(controller,sReqs,mapRequestProps,true,false));
  configVersions.clear();
  configVersions.put("typeA","v1");
  configVersions.put("typeB","v1");
  configVersions.put("typeC","v1");
  schReqs.clear();
  schReqs.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  Assert.assertNull(updateHostComponents(schReqs,Collections.<String,String>emptyMap(),true));
  configVersions.clear();
  configVersions.put("typeC","v2");
  configVersions.put("typeD","v1");
  scReqs.clear();
  scReqs.add(new ServiceComponentRequest(clusterName,serviceName,componentName1,null));
  Assert.assertNull(ComponentResourceProviderTest.updateComponents(controller,scReqs,Collections.<String,String>emptyMap(),true));
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentSimple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName="NAMENODE";
  try {
    createServiceComponent(clusterName,serviceName,componentName,State.INSTALLING);
    fail("ServiceComponent creation should fail for invalid state");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName);
    fail("ServiceComponent creation should have failed");
  }
 catch (  Exception e) {
  }
  createServiceComponent(clusterName,serviceName,componentName,State.INIT);
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName));
  ServiceComponentRequest r=new ServiceComponentRequest(clusterName,serviceName,null,null);
  Set<ServiceComponentResponse> response=ComponentResourceProviderTest.getComponents(controller,Collections.singleton(r));
  Assert.assertEquals(1,response.size());
  ServiceComponentResponse sc=response.iterator().next();
  Assert.assertEquals(State.INIT.toString(),sc.getDesiredState());
  Assert.assertEquals(componentName,sc.getComponentName());
  Assert.assertEquals(clusterName,sc.getClusterName());
  Assert.assertEquals(serviceName,sc.getServiceName());
}

</code></pre>

<br>
<pre class="type-4 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testServiceComponentHostUpdateStackIdError() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc1.getServiceComponentHost(host2);
  s1.setDesiredState(State.INIT);
  sc1.setDesiredState(State.INIT);
  ServiceComponentHostRequest req1;
  ServiceComponentHostRequest req2;
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("invalid stack id");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Invalid desired stack id");
  c1.setCurrentStackVersion(new StackId("HDP-0.0"));
  sch1.setStackVersion(new StackId("HDP-0.1"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Cluster has not been upgraded yet");
  c1.setCurrentStackVersion(new StackId("HDP2-0.1"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Deployed stack name and requested stack names");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.3");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Component host can only be upgraded to the same version");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.STARTED);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"Component host is in an invalid state for upgrade");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.UPGRADING);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.STARTED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"The desired state for an upgrade request must be");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.UPGRADING);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,null);
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  updateHostAndCompareExpectedFailure(reqs,"The desired state for an upgrade request must be");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.INSTALLED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.STARTED.toString());
  reqs.add(req2);
  updateHostAndCompareExpectedFailure(reqs,"An upgrade request cannot be combined with other");
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.INSTALLED);
  sch1.setStackVersion(new StackId("HDP-0.2"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,null);
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  RequestStatusResponse resp=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(resp);
  c1.setCurrentStackVersion(new StackId("HDP-0.2"));
  sch1.setState(State.INSTALLED);
  sch1.setStackVersion(new StackId("HDP-0.2"));
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req1.setDesiredStackId("HDP-0.2");
  reqs.add(req1);
  resp=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(resp);
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentUpdateRecursive() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.INIT);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.STARTED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.STARTED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.UNKNOWN);
  Set<ServiceComponentRequest> reqs=new HashSet<ServiceComponentRequest>();
  ServiceComponentRequest req1, req2, req3;
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc3.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  try {
    reqs.clear();
    req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INIT.toString());
    reqs.add(req1);
    ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INIT);
  sch5.setDesiredState(State.INIT);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  try {
    reqs.clear();
    req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.STARTED.toString());
    reqs.add(req1);
    ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INIT);
  sch5.setDesiredState(State.INIT);
  sch1.setState(State.STARTED);
  sch2.setState(State.INIT);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.STARTED);
  sch5.setState(State.INIT);
  reqs.clear();
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INSTALLED.toString());
  req2=new ServiceComponentRequest(clusterName,serviceName1,sc2.getName(),State.INSTALLED.toString());
  req3=new ServiceComponentRequest(clusterName,serviceName1,sc3.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  reqs.add(req3);
  RequestStatusResponse trackAction=ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertEquals(State.INSTALLED,s1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc2.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch1.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch2.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch4.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch5.getDesiredState());
  Assert.assertEquals(State.STARTED,sch1.getState());
  Assert.assertEquals(State.INIT,sch2.getState());
  Assert.assertEquals(State.INSTALLED,sch3.getState());
  Assert.assertEquals(State.STARTED,sch4.getState());
  Assert.assertEquals(State.INIT,sch5.getState());
  long requestId=trackAction.getRequestId();
  List<Stage> stages=actionDB.getAllStages(requestId);
  Assert.assertTrue(!stages.isEmpty());
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentRequest(clusterName,serviceName1,sc1.getName(),State.INSTALLED.toString());
  req2=new ServiceComponentRequest(clusterName,serviceName1,sc2.getName(),State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=ComponentResourceProviderTest.updateComponents(controller,reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHbaseDecommission() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-2.0.7"));
  String serviceName="HBASE";
  createService(clusterName,serviceName,null);
  String componentName1="HBASE_MASTER";
  String componentName2="HBASE_REGIONSERVER";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName1,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  RequestOperationLevel level=new RequestOperationLevel(Resource.Type.HostComponent,clusterName,null,null,null);
  installService(clusterName,serviceName,false,false);
  startService(clusterName,serviceName,false,false);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  ServiceComponentHost scHost=s.getServiceComponent("HBASE_REGIONSERVER").getServiceComponentHost("h2");
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Map<String,String> params=new HashMap<String,String>(){
{
      put("excluded_hosts","h2");
      put("align_maintenance_state","true");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HBASE","HBASE_MASTER",null);
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,resourceFilters,level,params,false);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(request,requestProperties);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  ExecutionCommand execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  HostRoleCommand command=storedTasks.get(0);
  Assert.assertTrue("DECOMMISSION, Excluded: h2".equals(command.getCommandDetail()));
  Assert.assertTrue("DECOMMISSION".equals(command.getCustomCommandName()));
  Map<String,String> cmdParams=command.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("mark_draining_only"));
  Assert.assertEquals("false",cmdParams.get("mark_draining_only"));
  Assert.assertEquals(Role.HBASE_MASTER,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  s.getServiceComponent("HBASE_REGIONSERVER").getServiceComponentHost("h2").setState(State.INSTALLED);
  params=new HashMap<String,String>(){
{
      put("excluded_hosts","h2");
      put("mark_draining_only","true");
      put("slave_type","HBASE_REGIONSERVER");
      put("align_maintenance_state","true");
    }
  }
;
  resourceFilter=new RequestResourceFilter("HBASE","HBASE_MASTER",null);
  ArrayList<RequestResourceFilter> filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  command=storedTasks.get(0);
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertTrue("DECOMMISSION, Excluded: h2".equals(command.getCommandDetail()));
  Assert.assertTrue("DECOMMISSION".equals(command.getCustomCommandName()));
  cmdParams=command.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("mark_draining_only"));
  Assert.assertEquals("true",cmdParams.get("mark_draining_only"));
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  params=new HashMap<String,String>(){
{
      put("included_hosts","h2");
    }
  }
;
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,resourceFilters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  command=storedTasks.get(0);
  Assert.assertTrue("DECOMMISSION, Included: h2".equals(command.getCommandDetail()));
  Assert.assertTrue("DECOMMISSION".equals(command.getCustomCommandName()));
  cmdParams=command.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("mark_draining_only"));
  Assert.assertEquals("false",cmdParams.get("mark_draining_only"));
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  Assert.assertTrue(cmdParams.containsKey("excluded_hosts"));
  Assert.assertEquals("",cmdParams.get("excluded_hosts"));
  Assert.assertEquals(Role.HBASE_MASTER,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceFiltersWithCustomActions() throws AmbariException, AuthorizationException {
  setupClusterWithHosts("c1","HDP-2.0.6",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos6");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.6"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  Service mapred=cluster.addService("YARN");
  mapred.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  mapred.addServiceComponent(Role.RESOURCEMANAGER.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h2").persist();
  controller.getAmbariMetaInfo().addActionDefinition(new ActionDefinition("a1",ActionType.SYSTEM,"","HDFS","","Some custom action.",TargetHostType.ALL,Short.valueOf("10010")));
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  ArrayList<String> hosts=new ArrayList<String>(){
{
      add("h2");
    }
  }
;
  RequestResourceFilter resourceFilter1=new RequestResourceFilter("HDFS","DATANODE",hosts);
  hosts=new ArrayList<String>(){
{
      add("h1");
    }
  }
;
  RequestResourceFilter resourceFilter2=new RequestResourceFilter("HDFS","NAMENODE",hosts);
  resourceFilters.add(resourceFilter1);
  resourceFilters.add(resourceFilter2);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  RequestStatusResponse response=null;
  try {
    response=controller.createAction(actionRequest,requestProperties);
  }
 catch (  AmbariException ae) {
    LOG.info("Expected exception.",ae);
    Assert.assertTrue(ae.getMessage().contains("Custom action definition only " + "allows one resource filter to be specified"));
  }
  resourceFilters.remove(resourceFilter1);
  actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  HostRoleCommand nnCommand=null;
  for (  HostRoleCommand hrc : actionDB.getRequestTasks(response.getRequestId())) {
    if (hrc.getHostName().equals("h1")) {
      nnCommand=hrc;
    }
  }
  Assert.assertNotNull(nnCommand);
  ExecutionCommand cmd=nnCommand.getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals("a1",cmd.getRole());
  Assert.assertEquals("10010",cmd.getCommandParams().get("command_timeout"));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : actionDB.getAllStages(response.getRequestId())) {
    Map<String,String> commandParamsStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
    Assert.assertTrue(commandParamsStage.containsKey("test"));
  }
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testReInstallForInstallFailedClient() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host3,null);
  installService(clusterName,serviceName,false,false);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  ServiceComponent sc3=s.getServiceComponent(componentName3);
  for (  ServiceComponentHost sch : sc3.getServiceComponentHosts().values()) {
    if (sch.getHostName().equals(host3)) {
      sch.setState(State.INSTALL_FAILED);
    }
  }
  long requestId=startService(clusterName,serviceName,false,true);
  List<Stage> stages=actionDB.getAllStages(requestId);
  HostRoleCommand clientReinstallCmd=null;
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getHostName().equals(host3) && hrc.getRole().toString().equals("HDFS_CLIENT")) {
        clientReinstallCmd=hrc;
        break;
      }
    }
  }
  Assert.assertNotNull(clientReinstallCmd);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigGroupOverridesWithHostActions() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName1="HDFS";
  String serviceName2="MAPREDUCE2";
  createService(clusterName,serviceName1,null);
  createService(clusterName,serviceName2,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  String componentName4="HISTORYSERVER";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName4,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName1,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName1,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName1,componentName3,host3,null);
  createServiceComponentHost(clusterName,serviceName2,componentName4,host3,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1, cr2, cr3;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  cr3=new ConfigurationRequest(clusterName,"mapred-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr3));
  controller.updateClusters(Collections.singleton(crReq),null);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  cluster=clusters.getCluster(clusterName);
  final Config config=new ConfigImpl("core-site");
  config.setProperties(configs);
  config.setTag("version122");
  Long groupId=createConfigGroup(cluster,"g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  configs=new HashMap<String,String>();
  configs.put("a","c");
  final Config config2=new ConfigImpl("mapred-site");
  config2.setProperties(configs);
  config2.setTag("version122");
  groupId=createConfigGroup(cluster,"g2","t2",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config2);
    }
  }
);
  Assert.assertNotNull(groupId);
  Long requestId=installService(clusterName,serviceName1,false,false);
  HostRoleCommand namenodeInstall=null;
  HostRoleCommand clientInstall=null;
  HostRoleCommand slaveInstall=null;
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.NAMENODE) && hrc.getHostName().equals("h1")) {
        namenodeInstall=hrc;
      }
 else       if (hrc.getRole().equals(Role.HDFS_CLIENT) && hrc.getHostName().equals("h3")) {
        clientInstall=hrc;
      }
 else       if (hrc.getRole().equals(Role.DATANODE) && hrc.getHostName().equals("h2")) {
        slaveInstall=hrc;
      }
    }
  }
  Assert.assertNotNull(namenodeInstall);
  Assert.assertNotNull(clientInstall);
  Assert.assertNotNull(slaveInstall);
  Assert.assertTrue(namenodeInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").containsKey("a"));
  Assert.assertEquals("c",namenodeInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").get("a"));
  Assert.assertTrue(clientInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").containsKey("a"));
  Assert.assertEquals("b",clientInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").get("a"));
  Assert.assertTrue(slaveInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").containsKey("a"));
  Assert.assertEquals("b",slaveInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("core-site").get("a"));
  startService(clusterName,serviceName1,false,false);
  requestId=installService(clusterName,serviceName2,false,false);
  HostRoleCommand mapredInstall=null;
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HISTORYSERVER) && hrc.getHostName().equals("h3")) {
        mapredInstall=hrc;
      }
    }
  }
  Assert.assertNotNull(mapredInstall);
  Assert.assertEquals("b",mapredInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("mapred-site").get("a"));
  ConfigGroup configGroup=cluster.getConfigGroups().get(groupId);
  configGroup.setHosts(new HashMap<Long,Host>(){
{
      put(3L,clusters.getHost("h3"));
    }
  }
);
  configGroup.persist();
  requestId=startService(clusterName,serviceName2,false,false);
  mapredInstall=null;
  for (  Stage stage : actionDB.getAllStages(requestId)) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HISTORYSERVER) && hrc.getHostName().equals("h3")) {
        mapredInstall=hrc;
      }
    }
  }
  Assert.assertNotNull(mapredInstall);
  Assert.assertEquals("c",mapredInstall.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().get("mapred-site").get("a"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecommissonDatanodeAction() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.7"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  RequestOperationLevel level=new RequestOperationLevel(Resource.Type.HostComponent,clusterName,null,null,null);
  installService(clusterName,serviceName,false,false);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  ConfigurationRequest cr1;
  cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  startService(clusterName,serviceName,false,false);
  cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  ServiceComponentHost scHost=s.getServiceComponent("DATANODE").getServiceComponentHost("h2");
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
      put("excluded_hosts","h2");
      put("align_maintenance_state","true");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  ArrayList<RequestResourceFilter> filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  ExecuteActionRequest request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(request,requestProperties);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  ExecutionCommand execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertNotNull(execCmd.getConfigurationTags().get("hdfs-site"));
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  HostRoleCommand command=storedTasks.get(0);
  Assert.assertEquals(Role.NAMENODE,command.getRole());
  Assert.assertEquals(RoleCommand.CUSTOM_COMMAND,command.getRoleCommand());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  params=new HashMap<String,String>(){
{
      put("test","test");
      put("excluded_hosts","h1");
      put("align_maintenance_state","true");
    }
  }
;
  resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Map<String,String> cmdParams=execCmd.getCommandParams();
  Assert.assertTrue(cmdParams.containsKey("update_exclude_file_only"));
  Assert.assertTrue(cmdParams.get("update_exclude_file_only").equals("false"));
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(1,storedTasks.size());
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.ON,scHost.getMaintenanceState());
  Assert.assertEquals("DECOMMISSION",execCmd.getHostLevelParams().get("custom_command"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  createServiceComponentHost(clusterName,serviceName,componentName1,host2,null);
  ServiceComponentHostRequest r=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host2,State.INSTALLED.toString());
  Set<ServiceComponentHostRequest> requests=new HashSet<ServiceComponentHostRequest>();
  requests.add(r);
  updateHostComponents(requests,Collections.<String,String>emptyMap(),true);
  s.getServiceComponent(componentName1).getServiceComponentHost(host2).setState(State.INSTALLED);
  r=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host2,State.STARTED.toString());
  requests.clear();
  requests.add(r);
  updateHostComponents(requests,Collections.<String,String>emptyMap(),true);
  s.getServiceComponent(componentName1).getServiceComponentHost(host2).setState(State.STARTED);
  params=new HashMap<String,String>(){
{
      put("test","test");
      put("included_hosts","h1 , h2");
      put("align_maintenance_state","true");
    }
  }
;
  resourceFilter=new RequestResourceFilter("HDFS","NAMENODE",null);
  filters=new ArrayList<RequestResourceFilter>();
  filters.add(resourceFilter);
  request=new ExecuteActionRequest(clusterName,"DECOMMISSION",null,filters,level,params,false);
  response=controller.createAction(request,requestProperties);
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertNotNull(storedTasks);
  scHost=s.getServiceComponent("DATANODE").getServiceComponentHost("h2");
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.OFF,scHost.getMaintenanceState());
  execCmd=storedTasks.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(2,storedTasks.size());
  int countRefresh=0;
  for (  HostRoleCommand hrc : storedTasks) {
    Assert.assertTrue("DECOMMISSION, Included: h1,h2".equals(hrc.getCommandDetail()));
    Assert.assertTrue("DECOMMISSION".equals(hrc.getCustomCommandName()));
    cmdParams=hrc.getExecutionCommandWrapper().getExecutionCommand().getCommandParams();
    if (!cmdParams.containsKey("update_exclude_file_only") || !cmdParams.get("update_exclude_file_only").equals("true")) {
      countRefresh++;
    }
  }
  Assert.assertEquals(2,countRefresh);
  scHost.setComponentAdminState(null);
  Assert.assertEquals(HostComponentAdminState.INSERVICE,scHost.getComponentAdminState());
  Assert.assertEquals(MaintenanceState.OFF,scHost.getMaintenanceState());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceFiltersWithCustomCommands() throws AmbariException, AuthorizationException {
  setupClusterWithHosts("c1","HDP-2.0.6",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos6");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.6"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  Service mapred=cluster.addService("YARN");
  mapred.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  mapred.addServiceComponent(Role.RESOURCEMANAGER.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h2").persist();
  mapred.getServiceComponent(Role.RESOURCEMANAGER.name()).addServiceComponentHost("h2").persist();
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS",Role.DATANODE.name(),new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
);
  resourceFilters.add(resourceFilter);
  resourceFilter=new RequestResourceFilter("YARN",Role.RESOURCEMANAGER.name(),new ArrayList<String>(){
{
      add("h2");
    }
  }
);
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest request=new ExecuteActionRequest("c1","RESTART",null,resourceFilters,null,params,false);
  RequestStatusResponse response=controller.createAction(request,requestProperties);
  Assert.assertEquals(3,response.getTasks().size());
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertNotNull(storedTasks);
  int expectedRestartCount=0;
  for (  HostRoleCommand hrc : storedTasks) {
    Assert.assertEquals("RESTART",hrc.getCustomCommandName());
    if (hrc.getHostName().equals("h1") && hrc.getRole().equals(Role.DATANODE)) {
      expectedRestartCount++;
    }
 else     if (hrc.getHostName().equals("h2")) {
      if (hrc.getRole().equals(Role.DATANODE)) {
        expectedRestartCount++;
      }
 else       if (hrc.getRole().equals(Role.RESOURCEMANAGER)) {
        expectedRestartCount++;
      }
    }
  }
  Assert.assertEquals("Restart 2 datanodes and 1 Resourcemanager.",3,expectedRestartCount);
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  resourceFilters.clear();
  resourceFilter=new RequestResourceFilter("HDFS",null,new ArrayList<String>(){
{
      add("h1");
    }
  }
);
  resourceFilters.add(resourceFilter);
  request=new ExecuteActionRequest("c1",Role.HDFS_SERVICE_CHECK.name(),null,resourceFilters,null,null,false);
  response=controller.createAction(request,requestProperties);
  Assert.assertEquals(1,response.getTasks().size());
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertNotNull(storedTasks);
  Assert.assertEquals(Role.HDFS_SERVICE_CHECK.name(),storedTasks.get(0).getRole().name());
  Assert.assertEquals("h1",storedTasks.get(0).getHostName());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("serial") @Test public void testCreateServiceCheckActions() throws Exception {
  setupClusterWithHosts("c1","HDP-0.1",new ArrayList<String>(){
{
      add("h1");
      add("h2");
    }
  }
,"centos5");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  cluster.setCurrentStackVersion(new StackId("HDP-0.1"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  config1.setPropertiesAttributes(new HashMap<String,Map<String,String>>(){
{
      put("attr1",new HashMap<String,String>());
    }
  }
);
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  config2.setPropertiesAttributes(new HashMap<String,Map<String,String>>(){
{
      put("attr2",new HashMap<String,String>());
    }
  }
);
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  cluster.addDesiredConfig("_test",Collections.singleton(config1));
  cluster.addDesiredConfig("_test",Collections.singleton(config2));
  Service hdfs=cluster.addService("HDFS");
  Service mapReduce=cluster.addService("MAPREDUCE");
  hdfs.persist();
  mapReduce.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  mapReduce.addServiceComponent(Role.MAPREDUCE_CLIENT.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  mapReduce.getServiceComponent(Role.MAPREDUCE_CLIENT.name()).addServiceComponentHost("h2").persist();
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
    }
  }
;
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1",Role.HDFS_SERVICE_CHECK.name(),params,false);
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS",null,null);
  actionRequest.getResourceFilters().add(resourceFilter);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  ShortTaskStatus task=response.getTasks().get(0);
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Stage stage=actionDB.getAllStages(response.getRequestId()).get(0);
  ExecutionCommandDAO executionCommandDAO=injector.getInstance(ExecutionCommandDAO.class);
  ExecutionCommandEntity commandEntity=executionCommandDAO.findByPK(task.getTaskId());
  Gson gson=new Gson();
  ExecutionCommand executionCommand=gson.fromJson(new StringReader(new String(commandEntity.getCommand())),ExecutionCommand.class);
  assertFalse(executionCommand.getConfigurationTags().isEmpty());
  assertTrue(executionCommand.getConfigurations() == null || executionCommand.getConfigurations().isEmpty());
  assertEquals(1,storedTasks.size());
  HostRoleCommand hostRoleCommand=storedTasks.get(0);
  assertEquals("SERVICE_CHECK HDFS",hostRoleCommand.getCommandDetail());
  assertNull(hostRoleCommand.getCustomCommandName());
  assertEquals(task.getTaskId(),hostRoleCommand.getTaskId());
  assertNotNull(actionRequest.getResourceFilters());
  RequestResourceFilter requestResourceFilter=actionRequest.getResourceFilters().get(0);
  assertEquals(resourceFilter.getServiceName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getServiceName());
  assertEquals(actionRequest.getClusterName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getClusterName());
  assertEquals(actionRequest.getCommandName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getRole());
  assertEquals(Role.HDFS_CLIENT.name(),hostRoleCommand.getEvent().getEvent().getServiceComponentName());
  assertEquals(actionRequest.getParameters(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getRoleParams());
  assertNotNull(hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getConfigurations());
  assertEquals(2,hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getConfigurations().size());
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),stage.getRequestContext());
  assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  actionRequest=new ExecuteActionRequest("c1",Role.MAPREDUCE_SERVICE_CHECK.name(),null,false);
  resourceFilter=new RequestResourceFilter("MAPREDUCE",null,null);
  actionRequest.getResourceFilters().add(resourceFilter);
  injector.getInstance(ActionMetadata.class).addServiceCheckAction("MAPREDUCE");
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  List<HostRoleCommand> tasks=actionDB.getRequestTasks(response.getRequestId());
  assertEquals(1,tasks.size());
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,null);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  assertEquals("",response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServicesMultiple() throws AmbariException, AuthorizationException {
  Set<ServiceRequest> set1=new HashSet<ServiceRequest>();
  clusters.addCluster("foo",new StackId("HDP-0.1"));
  ServiceRequest valid1=new ServiceRequest("foo","HDFS",null);
  ServiceRequest valid2=new ServiceRequest("foo","MAPREDUCE",null);
  set1.add(valid1);
  set1.add(valid2);
  ServiceResourceProviderTest.createServices(controller,set1);
  try {
    valid1=new ServiceRequest("foo","PIG",null);
    valid2=new ServiceRequest("foo","MAPREDUCE",null);
    set1.add(valid1);
    set1.add(valid2);
    ServiceResourceProviderTest.createServices(controller,set1);
    fail("Expected failure for invalid services");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(checkExceptionType(e,DuplicateResourceException.class));
  }
  Assert.assertNotNull(clusters.getCluster("foo"));
  Assert.assertEquals(2,clusters.getCluster("foo").getServices().size());
  Assert.assertNotNull(clusters.getCluster("foo").getService("HDFS"));
  Assert.assertNotNull(clusters.getCluster("foo").getService("MAPREDUCE"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostLevelParamsSentWithCommands() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="PIG";
  createService(clusterName,serviceName,null);
  String componentName1="PIG";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,null,componentName1,host2,null);
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  List<Stage> stages=actionDB.getAllStages(trackAction.getRequestId());
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage stage : stages) {
    Map<String,String> params=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
    Assert.assertEquals("0.1",params.get("stack_version"));
    Assert.assertNotNull(params.get("jdk_location"));
    Assert.assertNotNull(params.get("db_name"));
    Assert.assertNotNull(params.get("mysql_jdbc_url"));
    Assert.assertNotNull(params.get("oracle_jdbc_url"));
  }
  Map<String,String> paramsCmd=stages.get(0).getOrderedHostRoleCommands().get(0).getExecutionCommandWrapper().getExecutionCommand().getHostLevelParams();
  Assert.assertNotNull(paramsCmd.get("repo_info"));
  Assert.assertNotNull(paramsCmd.get("clientsToUpdateConfigs"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCustomActionNoCluster() throws Exception {
  String hostname1="h1";
  String hostname2="h2";
  addHost(hostname1);
  addHost(hostname2);
  ambariMetaInfo.addActionDefinition(new ActionDefinition("a1",ActionType.SYSTEM,"","","","action def description",TargetHostType.ANY,Short.valueOf("60")));
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  Map<String,String> requestParams=new HashMap<String,String>();
  requestParams.put("some_custom_param","abc");
  List<String> hosts=Arrays.asList(hostname1);
  RequestResourceFilter resourceFilter=new RequestResourceFilter(null,null,hosts);
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest(null,null,"a1",resourceFilters,null,requestParams,false);
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  ShortTaskStatus taskStatus=response.getTasks().get(0);
  Assert.assertEquals(hostname1,taskStatus.getHostName());
  Stage stage=actionDB.getAllStages(response.getRequestId()).get(0);
  Assert.assertNotNull(stage);
  Assert.assertEquals(-1L,stage.getClusterId());
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertEquals(1,storedTasks.size());
  HostRoleCommand task=storedTasks.get(0);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a1",task.getRole().name());
  Assert.assertEquals(hostname1,task.getHostName());
  ExecutionCommand cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  Map<String,String> commandParamsStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParamsStage.containsKey("some_custom_param"));
  Assert.assertEquals(null,cmd.getServiceName());
  Assert.assertEquals(null,cmd.getComponentName());
  Assert.assertTrue(cmd.getLocalComponents().isEmpty());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  hosts=Arrays.asList(hostname1,hostname2);
  resourceFilter=new RequestResourceFilter(null,null,hosts);
  resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  actionRequest=new ExecuteActionRequest(null,null,"a1",resourceFilters,null,requestParams,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(2,response.getTasks().size());
  boolean host1Found=false;
  boolean host2Found=false;
  for (  ShortTaskStatus sts : response.getTasks()) {
    if (sts.getHostName().equals(hostname1)) {
      host1Found=true;
    }
 else     if (sts.getHostName().equals(hostname2)) {
      host2Found=true;
    }
  }
  Assert.assertTrue(host1Found);
  Assert.assertTrue(host2Found);
  stage=actionDB.getAllStages(response.getRequestId()).get(0);
  Assert.assertNotNull(stage);
  Assert.assertEquals(-1L,stage.getClusterId());
  storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Assert.assertEquals(2,storedTasks.size());
  task=storedTasks.get(0);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a1",task.getRole().name());
  Assert.assertEquals(hostname1,task.getHostName());
  cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  commandParamsStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParamsStage.containsKey("some_custom_param"));
  Assert.assertEquals(null,cmd.getServiceName());
  Assert.assertEquals(null,cmd.getComponentName());
  Assert.assertTrue(cmd.getLocalComponents().isEmpty());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testGetExecutionCommandWithClusterEnvForRetry() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  configs.put("command_retry_enabled","true");
  configs.put("command_retry_max_time_in_sec","5");
  configs.put("commands_to_retry","INSTALL");
  ConfigurationRequest cr1;
  cr1=new ConfigurationRequest(clusterName,"cluster-env","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  ServiceComponentHostRequest schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"INSTALLED");
  Map<String,String> requestProps=new HashMap<String,String>();
  requestProps.put("phase","INITIAL_INSTALL");
  RequestStatusResponse rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  List<Stage> stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  Stage stage=stages.iterator().next();
  List<ExecutionCommandWrapper> execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  ExecutionCommandWrapper execWrapper=execWrappers.iterator().next();
  ExecutionCommand ec=execWrapper.getExecutionCommand();
  Map<String,Map<String,String>> configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("5",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("true",ec.getCommandParams().get("command_retry_enabled"));
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host2)) {
    sch.setState(State.INSTALLED);
  }
  schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"STARTED");
  rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  stage=stages.iterator().next();
  execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  execWrapper=execWrappers.iterator().next();
  ec=execWrapper.getExecutionCommand();
  configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("5",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("false",ec.getCommandParams().get("command_retry_enabled"));
  configs.put("command_retry_enabled","true");
  configs.put("command_retry_max_time_in_sec","12");
  configs.put("commands_to_retry","START");
  cr1=new ConfigurationRequest(clusterName,"cluster-env","version2",configs,null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  requestProps.put("phase","INITIAL_START");
  schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"STARTED");
  rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  stage=stages.iterator().next();
  execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  execWrapper=execWrappers.iterator().next();
  ec=execWrapper.getExecutionCommand();
  configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("12",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("true",ec.getCommandParams().get("command_retry_enabled"));
  configs.put("command_retry_enabled","asdf");
  configs.put("command_retry_max_time_in_sec","-5");
  configs.put("commands_to_retry2","START");
  cr1=new ConfigurationRequest(clusterName,"cluster-env","version3",configs,null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  requestProps.put("phase","INITIAL_START");
  schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"STARTED");
  rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  stage=stages.iterator().next();
  execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  execWrapper=execWrappers.iterator().next();
  ec=execWrapper.getExecutionCommand();
  configurations=ec.getConfigurations();
  assertNotNull(configurations);
  assertEquals(1,configurations.size());
  assertTrue(configurations.containsKey("cluster-env"));
  assertTrue(ec.getCommandParams().containsKey("max_duration_for_retries"));
  assertEquals("0",ec.getCommandParams().get("max_duration_for_retries"));
  assertTrue(ec.getCommandParams().containsKey("command_retry_enabled"));
  assertEquals("false",ec.getCommandParams().get("command_retry_enabled"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateHostComponentsBadState() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host2));
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,true,false);
  Assert.assertEquals(State.INSTALLED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host1)) {
    sch.setState(State.INSTALLED);
  }
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host2)) {
    sch.setState(State.UNKNOWN);
  }
  ServiceComponentHostRequest schr=new ServiceComponentHostRequest(clusterName,"HDFS","DATANODE",host2,"INSTALLED");
  Map<String,String> requestProps=new HashMap<String,String>();
  requestProps.put("datanode","dn_value");
  requestProps.put("namenode","nn_value");
  RequestStatusResponse rsr=updateHostComponents(Collections.singleton(schr),requestProps,false);
  List<Stage> stages=actionDB.getAllStages(rsr.getRequestId());
  Assert.assertEquals(1,stages.size());
  Stage stage=stages.iterator().next();
  List<ExecutionCommandWrapper> execWrappers=stage.getExecutionCommands(host2);
  Assert.assertEquals(1,execWrappers.size());
  ExecutionCommandWrapper execWrapper=execWrappers.iterator().next();
  Assert.assertTrue(execWrapper.getExecutionCommand().getCommandParams().containsKey("datanode"));
  Assert.assertFalse(execWrapper.getExecutionCommand().getCommandParams().containsKey("namendode"));
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host2)) {
    Assert.assertEquals(State.UNKNOWN,sch.getState());
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceComponentHostUpdateRecursive() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s1.getServiceComponent(componentName3);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  s1.setDesiredState(State.INIT);
  sc1.setDesiredState(State.INIT);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.INIT);
  sch1.setDesiredState(State.INIT);
  sch2.setDesiredState(State.INIT);
  sch3.setDesiredState(State.INIT);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALL_FAILED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  ServiceComponentHostRequest req1, req2, req3, req4, req5;
  Set<ServiceComponentHostRequest> reqs=new HashSet<ServiceComponentHostRequest>();
  try {
    reqs.clear();
    req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
    req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
    req3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INSTALLED.toString());
    req4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INSTALLED.toString());
    req5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.STARTED.toString());
    reqs.add(req1);
    reqs.add(req2);
    reqs.add(req3);
    reqs.add(req4);
    reqs.add(req5);
    updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  }
 catch (  Exception e) {
    fail("Failure for invalid states");
  }
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,null,componentName1,host1,State.INSTALLED.toString());
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  req3=new ServiceComponentHostRequest(clusterName,null,componentName2,host1,State.INSTALLED.toString());
  req4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INSTALLED.toString());
  req5=new ServiceComponentHostRequest(clusterName,serviceName1,componentName3,host1,State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  reqs.add(req3);
  reqs.add(req4);
  reqs.add(req5);
  RequestStatusResponse trackAction=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNotNull(trackAction);
  long requestId=trackAction.getRequestId();
  Assert.assertFalse(actionDB.getAllStages(requestId).isEmpty());
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INSTALLED.toString());
  req2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INSTALLED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=updateHostComponents(reqs,Collections.<String,String>emptyMap(),true);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReInstallClientComponent() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  String host3="h3";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  addHostToCluster(host3,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host3,null);
  installService(clusterName,serviceName,false,false);
  ServiceComponentHostRequest schr=new ServiceComponentHostRequest(clusterName,serviceName,componentName3,host3,State.INSTALLED.name());
  Set<ServiceComponentHostRequest> setReqs=new HashSet<ServiceComponentHostRequest>();
  setReqs.add(schr);
  RequestStatusResponse resp=updateHostComponents(setReqs,Collections.<String,String>emptyMap(),false);
  Assert.assertNotNull(resp);
  Assert.assertTrue(resp.getRequestId() > 0);
  List<Stage> stages=actionDB.getAllStages(resp.getRequestId());
  HostRoleCommand clientReinstallCmd=null;
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getHostName().equals(host3) && hrc.getRole().toString().equals("HDFS_CLIENT")) {
        clientReinstallCmd=hrc;
        break;
      }
    }
  }
  Assert.assertNotNull(clientReinstallCmd);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentWithInvalidRequest() throws AmbariException, AuthorizationException {
  Set<ServiceComponentRequest> set1=new HashSet<ServiceComponentRequest>();
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest(null,null,null,null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1",null,null,null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1","s1",null,null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1","s1","sc1",null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid cluster");
  }
 catch (  ParentObjectNotFoundException e) {
  }
  clusters.addCluster("c1",new StackId("HDP-0.1"));
  clusters.addCluster("c2",new StackId("HDP-0.1"));
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1","HDFS","NAMENODE",null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for invalid service");
  }
 catch (  ParentObjectNotFoundException e) {
  }
  Cluster c1=clusters.getCluster("c1");
  StackId stackId=new StackId("HDP-0.1");
  c1.setDesiredStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  c1.addService(s1);
  c1.addService(s2);
  s1.persist();
  s2.persist();
  set1.clear();
  ServiceComponentRequest valid1=new ServiceComponentRequest("c1","HDFS","NAMENODE",null);
  ServiceComponentRequest valid2=new ServiceComponentRequest("c1","MAPREDUCE","JOBTRACKER",null);
  ServiceComponentRequest valid3=new ServiceComponentRequest("c1","MAPREDUCE","TASKTRACKER",null);
  set1.add(valid1);
  set1.add(valid2);
  set1.add(valid3);
  ComponentResourceProviderTest.createComponents(controller,set1);
  try {
    set1.clear();
    ServiceComponentRequest rInvalid1=new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null);
    ServiceComponentRequest rInvalid2=new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null);
    set1.add(rInvalid1);
    set1.add(rInvalid2);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for dups in requests");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid1=new ServiceComponentRequest("c1","HDFS","HDFS_CLIENT",null);
    ServiceComponentRequest rInvalid2=new ServiceComponentRequest("c2","HDFS","HDFS_CLIENT",null);
    set1.add(rInvalid1);
    set1.add(rInvalid2);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for multiple clusters");
  }
 catch (  Exception e) {
  }
  try {
    set1.clear();
    ServiceComponentRequest rInvalid=new ServiceComponentRequest("c1","HDFS","NAMENODE",null);
    set1.add(rInvalid);
    ComponentResourceProviderTest.createComponents(controller,set1);
    fail("Expected failure for already existing component");
  }
 catch (  Exception e) {
  }
  Assert.assertEquals(1,s1.getServiceComponents().size());
  Assert.assertNotNull(s1.getServiceComponent("NAMENODE"));
  Assert.assertEquals(2,s2.getServiceComponents().size());
  Assert.assertNotNull(s2.getServiceComponent("JOBTRACKER"));
  Assert.assertNotNull(s2.getServiceComponent("TASKTRACKER"));
}

</code></pre>

<br>
<pre class="type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReconfigureClientWithServiceStarted() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  Map<String,String> configs2=new HashMap<String,String>();
  configs2.put("c","d");
  ConfigurationRequest cr1, cr2, cr3;
  cr1=new ConfigurationRequest(clusterName,"core-site","version1",configs,null);
  cr2=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr2));
  controller.updateClusters(Collections.singleton(crReq),null);
  installService(clusterName,serviceName,false,false);
  startService(clusterName,serviceName,false,false);
  Cluster c=clusters.getCluster(clusterName);
  Service s=c.getService(serviceName);
  stopServiceComponentHosts(clusterName,serviceName);
  Assert.assertEquals(State.STARTED,s.getDesiredState());
  for (  ServiceComponent sc : s.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INSTALLED,sch.getDesiredState());
    }
  }
  cr3=new ConfigurationRequest(clusterName,"core-site","version122",configs2,null);
  crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr3));
  controller.updateClusters(Collections.singleton(crReq),null);
  long id=startService(clusterName,serviceName,false,true);
  List<Stage> stages=actionDB.getAllStages(id);
  HostRoleCommand clientHrc=null;
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      if (hrc.getHostName().equals(host2) && hrc.getRole().toString().equals("HDFS_CLIENT")) {
        clientHrc=hrc;
        Assert.assertEquals("version122",hrc.getExecutionCommandWrapper().getExecutionCommand().getConfigurationTags().get("core-site").get("tag"));
      }
    }
  }
  Assert.assertNotNull(clientHrc);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReInstallClientComponentFromServiceChange() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName,host2,null);
  installService(clusterName,serviceName,false,false);
  ServiceRequest sr=new ServiceRequest(clusterName,serviceName,State.STARTED.name());
  Set<ServiceRequest> setReqs=new HashSet<ServiceRequest>();
  setReqs.add(sr);
  RequestStatusResponse resp=ServiceResourceProviderTest.updateServices(controller,setReqs,Collections.<String,String>emptyMap(),false,true);
  Assert.assertNotNull(resp);
  Assert.assertTrue(resp.getRequestId() > 0);
  List<Stage> stages=actionDB.getAllStages(resp.getRequestId());
  Map<String,Role> hostsToRoles=new HashMap<String,Role>();
  for (  Stage stage : stages) {
    for (    HostRoleCommand hrc : stage.getOrderedHostRoleCommands()) {
      hostsToRoles.put(hrc.getHostName(),hrc.getRole());
    }
  }
  Map<String,Role> expectedHostsToRoles=new HashMap<String,Role>();
  expectedHostsToRoles.put(host1,Role.HDFS_CLIENT);
  expectedHostsToRoles.put(host2,Role.HDFS_CLIENT);
  Assert.assertEquals(expectedHostsToRoles,hostsToRoles);
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testReinstallClientSchSkippedInMaintenance() throws Exception {
  Cluster c1=setupClusterWithHosts("c1","HDP-1.2.0",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos5");
  Service hdfs=c1.addService("HDFS");
  hdfs.persist();
  createServiceComponent("c1","HDFS","NAMENODE",State.INIT);
  createServiceComponent("c1","HDFS","DATANODE",State.INIT);
  createServiceComponent("c1","HDFS","HDFS_CLIENT",State.INIT);
  createServiceComponentHost("c1","HDFS","NAMENODE","h1",State.INIT);
  createServiceComponentHost("c1","HDFS","DATANODE","h1",State.INIT);
  createServiceComponentHost("c1","HDFS","HDFS_CLIENT","h1",State.INIT);
  createServiceComponentHost("c1","HDFS","HDFS_CLIENT","h2",State.INIT);
  createServiceComponentHost("c1","HDFS","HDFS_CLIENT","h3",State.INIT);
  installService("c1","HDFS",false,false);
  clusters.getHost("h3").setMaintenanceState(c1.getClusterId(),MaintenanceState.ON);
  Long id=startService("c1","HDFS",false,true);
  Assert.assertNotNull(id);
  List<Stage> stages=actionDB.getAllStages(id);
  Assert.assertNotNull(stages);
  HostRoleCommand hrc1=null;
  HostRoleCommand hrc2=null;
  HostRoleCommand hrc3=null;
  for (  Stage s : stages) {
    for (    HostRoleCommand hrc : s.getOrderedHostRoleCommands()) {
      if (hrc.getRole().equals(Role.HDFS_CLIENT) && hrc.getHostName().equals("h1")) {
        hrc1=hrc;
      }
 else       if (hrc.getRole().equals(Role.HDFS_CLIENT) && hrc.getHostName().equals("h2")) {
        hrc2=hrc;
      }
 else       if (hrc.getRole().equals(Role.HDFS_CLIENT) && hrc.getHostName().equals("h3")) {
        hrc3=hrc;
      }
    }
  }
  Assert.assertNotNull(hrc1);
  Assert.assertNotNull(hrc2);
  Assert.assertNull(hrc3);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaintenanceState() throws Exception {
  String clusterName="c1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-1.2.0"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put("context","Called from a test");
  Cluster cluster=clusters.getCluster(clusterName);
  Service service=cluster.getService(serviceName);
  Map<String,Host> hosts=clusters.getHostsForCluster(clusterName);
  MaintenanceStateHelper maintenanceStateHelper=MaintenanceStateHelperTest.getMaintenanceStateHelperInstance(clusters);
  ServiceRequest sr=new ServiceRequest(clusterName,serviceName,null);
  sr.setMaintenanceState(MaintenanceState.ON.name());
  ServiceResourceProviderTest.updateServices(controller,Collections.singleton(sr),requestProperties,false,false,maintenanceStateHelper);
  Assert.assertEquals(MaintenanceState.ON,service.getMaintenanceState());
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(MaintenanceState.IMPLIED_FROM_SERVICE,controller.getEffectiveMaintenanceState(sch));
      Assert.assertEquals(MaintenanceState.OFF,sch.getMaintenanceState());
    }
  }
  sr.setMaintenanceState(MaintenanceState.OFF.name());
  ServiceResourceProviderTest.updateServices(controller,Collections.singleton(sr),requestProperties,false,false,maintenanceStateHelper);
  Assert.assertEquals(MaintenanceState.OFF,service.getMaintenanceState());
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(MaintenanceState.OFF,controller.getEffectiveMaintenanceState(sch));
      Assert.assertEquals(MaintenanceState.OFF,sch.getMaintenanceState());
    }
  }
  HostRequest hr=new HostRequest(host1,clusterName,requestProperties);
  hr.setMaintenanceState(MaintenanceState.ON.name());
  HostResourceProviderTest.updateHosts(controller,Collections.singleton(hr));
  Host host=hosts.get(host1);
  Assert.assertEquals(MaintenanceState.ON,host.getMaintenanceState(cluster.getClusterId()));
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      MaintenanceState implied=controller.getEffectiveMaintenanceState(sch);
      if (sch.getHostName().equals(host1)) {
        Assert.assertEquals(MaintenanceState.IMPLIED_FROM_HOST,implied);
      }
 else {
        Assert.assertEquals(MaintenanceState.OFF,implied);
      }
      Assert.assertEquals(MaintenanceState.OFF,sch.getMaintenanceState());
    }
  }
  hr.setMaintenanceState(MaintenanceState.OFF.name());
  HostResourceProviderTest.updateHosts(controller,Collections.singleton(hr));
  host=hosts.get(host1);
  Assert.assertEquals(MaintenanceState.OFF,host.getMaintenanceState(cluster.getClusterId()));
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(MaintenanceState.OFF,controller.getEffectiveMaintenanceState(sch));
      Assert.assertEquals(MaintenanceState.OFF,sch.getMaintenanceState());
    }
  }
  HostRequest hr1=new HostRequest(host1,clusterName,requestProperties);
  hr1.setMaintenanceState(MaintenanceState.ON.name());
  HostRequest hr2=new HostRequest(host2,clusterName,requestProperties);
  hr2.setMaintenanceState(MaintenanceState.ON.name());
  Set<HostRequest> set=new HashSet<HostRequest>();
  set.add(hr1);
  set.add(hr2);
  HostResourceProviderTest.updateHosts(controller,set);
  host=hosts.get(host1);
  Assert.assertEquals(MaintenanceState.ON,host.getMaintenanceState(cluster.getClusterId()));
  host=hosts.get(host2);
  Assert.assertEquals(MaintenanceState.ON,host.getMaintenanceState(cluster.getClusterId()));
  hr1=new HostRequest(host1,clusterName,requestProperties);
  hr1.setMaintenanceState(MaintenanceState.OFF.name());
  hr2=new HostRequest(host2,clusterName,requestProperties);
  hr2.setMaintenanceState(MaintenanceState.OFF.name());
  set=new HashSet<HostRequest>();
  set.add(hr1);
  set.add(hr2);
  HostResourceProviderTest.updateHosts(controller,set);
  host=hosts.get(host1);
  Assert.assertEquals(MaintenanceState.OFF,host.getMaintenanceState(cluster.getClusterId()));
  host=hosts.get(host2);
  Assert.assertEquals(MaintenanceState.OFF,host.getMaintenanceState(cluster.getClusterId()));
  ServiceComponentHost targetSch=service.getServiceComponent(componentName2).getServiceComponentHosts().get(host2);
  Assert.assertNotNull(targetSch);
  targetSch.setMaintenanceState(MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.ON,controller.getEffectiveMaintenanceState(targetSch));
  service.setMaintenanceState(MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.ON,controller.getEffectiveMaintenanceState(targetSch));
  targetSch.setMaintenanceState(MaintenanceState.OFF);
  Assert.assertEquals(MaintenanceState.IMPLIED_FROM_SERVICE,controller.getEffectiveMaintenanceState(targetSch));
  service.setMaintenanceState(MaintenanceState.OFF);
  Assert.assertEquals(MaintenanceState.OFF,controller.getEffectiveMaintenanceState(targetSch));
  host=hosts.get(host2);
  host.setMaintenanceState(cluster.getClusterId(),MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.IMPLIED_FROM_HOST,controller.getEffectiveMaintenanceState(targetSch));
  targetSch.setMaintenanceState(MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.ON,controller.getEffectiveMaintenanceState(targetSch));
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(State.INIT,sch.getState());
    }
  }
  long id1=installService(clusterName,serviceName,false,false,maintenanceStateHelper,null);
  List<HostRoleCommand> hdfsCmds=actionDB.getRequestTasks(id1);
  Assert.assertNotNull(hdfsCmds);
  HostRoleCommand datanodeCmd=null;
  for (  HostRoleCommand cmd : hdfsCmds) {
    if (cmd.getRole().equals(Role.DATANODE)) {
      datanodeCmd=cmd;
    }
  }
  Assert.assertNotNull(datanodeCmd);
  for (  ServiceComponent sc : service.getServiceComponents().values()) {
    if (!sc.getName().equals(componentName2)) {
      continue;
    }
    for (    ServiceComponentHost sch : sc.getServiceComponentHosts().values()) {
      Assert.assertEquals(sch == targetSch ? State.INIT : State.INSTALLED,sch.getState());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCustomActions() throws Exception {
  setupClusterWithHosts("c1","HDP-2.0.6",new ArrayList<String>(){
{
      add("h1");
      add("h2");
      add("h3");
    }
  }
,"centos6");
  Cluster cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  cluster.setCurrentStackVersion(new StackId("HDP-2.0.6"));
  ConfigFactory cf=injector.getInstance(ConfigFactory.class);
  Config config1=cf.createNew(cluster,"global",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=cf.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("key1","value1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version1");
  Config config3=cf.createNew(cluster,"yarn-site",new HashMap<String,String>(){
{
      put("test.password","supersecret");
    }
  }
,new HashMap<String,Map<String,String>>());
  config3.setTag("version1");
  cluster.addConfig(config1);
  cluster.addConfig(config2);
  cluster.addConfig(config3);
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  Service mapred=cluster.addService("YARN");
  mapred.persist();
  hdfs.addServiceComponent(Role.HDFS_CLIENT.name()).persist();
  hdfs.addServiceComponent(Role.NAMENODE.name()).persist();
  hdfs.addServiceComponent(Role.DATANODE.name()).persist();
  mapred.addServiceComponent(Role.RESOURCEMANAGER.name()).persist();
  hdfs.getServiceComponent(Role.HDFS_CLIENT.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.NAMENODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h1").persist();
  hdfs.getServiceComponent(Role.DATANODE.name()).addServiceComponentHost("h2").persist();
  ActionDefinition a1=new ActionDefinition("a1",ActionType.SYSTEM,"test,[optional1]","","","Does file exist",TargetHostType.SPECIFIC,Short.valueOf("100"));
  controller.getAmbariMetaInfo().addActionDefinition(a1);
  controller.getAmbariMetaInfo().addActionDefinition(new ActionDefinition("a2",ActionType.SYSTEM,"","HDFS","DATANODE","Does file exist",TargetHostType.ALL,Short.valueOf("1000")));
  Map<String,String> params=new HashMap<String,String>(){
{
      put("test","test");
      put("pwd","SECRET:yarn-site:1:test.password");
    }
  }
;
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put(REQUEST_CONTEXT_PROPERTY,"Called from a test");
  requestProperties.put("datanode","abc");
  ArrayList<String> hosts=new ArrayList<String>(){
{
      add("h1");
    }
  }
;
  RequestResourceFilter resourceFilter=new RequestResourceFilter("HDFS","DATANODE",hosts);
  List<RequestResourceFilter> resourceFilters=new ArrayList<RequestResourceFilter>();
  resourceFilters.add(resourceFilter);
  ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  RequestStatusResponse response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  ShortTaskStatus taskStatus=response.getTasks().get(0);
  Assert.assertEquals("h1",taskStatus.getHostName());
  List<HostRoleCommand> storedTasks=actionDB.getRequestTasks(response.getRequestId());
  Stage stage=actionDB.getAllStages(response.getRequestId()).get(0);
  Assert.assertNotNull(stage);
  Assert.assertEquals(1,storedTasks.size());
  HostRoleCommand task=storedTasks.get(0);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a1",task.getRole().name());
  Assert.assertEquals("h1",task.getHostName());
  ExecutionCommand cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals("h1",cmd.getHostname());
  Assert.assertFalse(cmd.getLocalComponents().isEmpty());
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.DATANODE.name()));
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.NAMENODE.name()));
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.HDFS_CLIENT.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.RESOURCEMANAGER.name()));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  Map<String,String> hostParametersStage=StageUtils.getGson().fromJson(stage.getHostParamsStage(),type);
  Map<String,String> commandParametersStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParametersStage.containsKey("test"));
  Assert.assertTrue(commandParametersStage.containsKey("pwd"));
  Assert.assertEquals(commandParametersStage.get("pwd"),"supersecret");
  Assert.assertEquals("HDFS",cmd.getServiceName());
  Assert.assertEquals("DATANODE",cmd.getComponentName());
  Assert.assertNotNull(hostParametersStage.get("jdk_location"));
  Assert.assertEquals("900",cmd.getCommandParams().get("command_timeout"));
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  a1.setDefaultTimeout((short)1800);
  actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  List<HostRoleCommand> storedTasks1=actionDB.getRequestTasks(response.getRequestId());
  cmd=storedTasks1.get(0).getExecutionCommandWrapper().getExecutionCommand();
  Assert.assertEquals("1800",cmd.getCommandParams().get("command_timeout"));
  resourceFilters.clear();
  resourceFilter=new RequestResourceFilter("","",null);
  resourceFilters.add(resourceFilter);
  actionRequest=new ExecuteActionRequest("c1",null,"a2",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(2,response.getTasks().size());
  final List<HostRoleCommand> storedTasks2=actionDB.getRequestTasks(response.getRequestId());
  task=storedTasks2.get(1);
  Assert.assertEquals(RoleCommand.ACTIONEXECUTE,task.getRoleCommand());
  Assert.assertEquals("a2",task.getRole().name());
  HashSet<String> expectedHosts=new HashSet<String>(){
{
      add("h2");
      add("h1");
    }
  }
;
  HashSet<String> actualHosts=new HashSet<String>(){
{
      add(storedTasks2.get(1).getHostName());
      add(storedTasks2.get(0).getHostName());
    }
  }
;
  Assert.assertEquals(expectedHosts,actualHosts);
  cmd=task.getExecutionCommandWrapper().getExecutionCommand();
  commandParametersStage=StageUtils.getGson().fromJson(stage.getCommandParamsStage(),type);
  Assert.assertTrue(commandParametersStage.containsKey("test"));
  Assert.assertTrue(commandParametersStage.containsKey("pwd"));
  Assert.assertEquals(commandParametersStage.get("pwd"),"supersecret");
  Assert.assertEquals("HDFS",cmd.getServiceName());
  Assert.assertEquals("DATANODE",cmd.getComponentName());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
  Assert.assertEquals("h2",cmd.getHostname());
  Assert.assertFalse(cmd.getLocalComponents().isEmpty());
  Assert.assertTrue(cmd.getLocalComponents().contains(Role.DATANODE.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.NAMENODE.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.HDFS_CLIENT.name()));
  Assert.assertFalse(cmd.getLocalComponents().contains(Role.RESOURCEMANAGER.name()));
  hosts=new ArrayList<String>(){
{
      add("h3");
    }
  }
;
  resourceFilters.clear();
  resourceFilter=new RequestResourceFilter("","",hosts);
  resourceFilters.add(resourceFilter);
  actionRequest=new ExecuteActionRequest("c1",null,"a1",resourceFilters,null,params,false);
  response=controller.createAction(actionRequest,requestProperties);
  assertEquals(1,response.getTasks().size());
  taskStatus=response.getTasks().get(0);
  Assert.assertEquals("h3",taskStatus.getHostName());
  Assert.assertEquals(requestProperties.get(REQUEST_CONTEXT_PROPERTY),response.getRequestContext());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testConfigUpdates() throws Exception {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.1"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,null,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName3).getServiceComponentHost(host2));
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("a","b");
  Map<String,Map<String,String>> configAttributes=new HashMap<String,Map<String,String>>();
  configAttributes.put("final",new HashMap<String,String>());
  configAttributes.get("final").put("a","true");
  ConfigurationRequest cr1, cr2, cr3, cr4, cr5, cr6, cr7, cr8;
  cr1=new ConfigurationRequest(clusterName,"typeA","v1",configs,configAttributes);
  cr2=new ConfigurationRequest(clusterName,"typeB","v1",configs,configAttributes);
  cr3=new ConfigurationRequest(clusterName,"typeC","v1",configs,configAttributes);
  cr4=new ConfigurationRequest(clusterName,"typeD","v1",configs,configAttributes);
  cr5=new ConfigurationRequest(clusterName,"typeA","v2",configs,configAttributes);
  cr6=new ConfigurationRequest(clusterName,"typeB","v2",configs,configAttributes);
  cr7=new ConfigurationRequest(clusterName,"typeC","v2",configs,configAttributes);
  cr8=new ConfigurationRequest(clusterName,"typeE","v1",configs,configAttributes);
  controller.createConfiguration(cr1);
  controller.createConfiguration(cr2);
  controller.createConfiguration(cr3);
  controller.createConfiguration(cr4);
  controller.createConfiguration(cr5);
  controller.createConfiguration(cr6);
  controller.createConfiguration(cr7);
  controller.createConfiguration(cr8);
  Cluster cluster=clusters.getCluster(clusterName);
  Service s=cluster.getService(serviceName);
  ServiceComponent sc1=s.getServiceComponent(componentName1);
  ServiceComponent sc2=s.getServiceComponent(componentName2);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  Set<ServiceComponentHostRequest> schReqs=new HashSet<ServiceComponentHostRequest>();
  Set<ServiceComponentRequest> scReqs=new HashSet<ServiceComponentRequest>();
  Set<ServiceRequest> sReqs=new HashSet<ServiceRequest>();
  Map<String,String> configVersions=new HashMap<String,String>();
  configVersions.clear();
  configVersions.put("typeA","v1");
  configVersions.put("typeB","v1");
  configVersions.put("typeC","v1");
  schReqs.clear();
  schReqs.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  Assert.assertNull(updateHostComponents(schReqs,Collections.<String,String>emptyMap(),true));
  configVersions.clear();
  configVersions.put("typeC","v1");
  configVersions.put("typeD","v1");
  scReqs.clear();
  scReqs.add(new ServiceComponentRequest(clusterName,serviceName,componentName2,null));
  Assert.assertNull(ComponentResourceProviderTest.updateComponents(controller,scReqs,Collections.<String,String>emptyMap(),true));
  configVersions.clear();
  configVersions.put("typeA","v2");
  configVersions.put("typeC","v2");
  configVersions.put("typeE","v1");
  sReqs.clear();
  sReqs.add(new ServiceRequest(clusterName,serviceName,null));
  Assert.assertNull(ServiceResourceProviderTest.updateServices(controller,sReqs,mapRequestProps,true,false));
  configVersions.clear();
  configVersions.put("typeA","v1");
  configVersions.put("typeB","v1");
  configVersions.put("typeC","v1");
  schReqs.clear();
  schReqs.add(new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,null));
  Assert.assertNull(updateHostComponents(schReqs,Collections.<String,String>emptyMap(),true));
  configVersions.clear();
  configVersions.put("typeC","v2");
  configVersions.put("typeD","v1");
  scReqs.clear();
  scReqs.add(new ServiceComponentRequest(clusterName,serviceName,componentName1,null));
  Assert.assertNull(ComponentResourceProviderTest.updateComponents(controller,scReqs,Collections.<String,String>emptyMap(),true));
}

</code></pre>

<br>
<pre class="type-4 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testTargetedProcessCommand() throws Exception {
  final String host1="h1";
  String clusterName="c1";
  Cluster cluster=setupClusterWithHosts(clusterName,"HDP-2.0.5",Arrays.asList(host1),"centos5");
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  installService(clusterName,serviceName,false,false);
  Map<String,String> hdfsConfigs=new HashMap<String,String>();
  hdfsConfigs.put("a","b");
  Map<String,Map<String,String>> hdfsConfigAttributes=new HashMap<String,Map<String,String>>(){
{
      put("final",new HashMap<String,String>(){
{
          put("a","true");
        }
      }
);
    }
  }
;
  ConfigurationRequest cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",hdfsConfigs,hdfsConfigAttributes);
  ClusterRequest crReq1=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq1.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq1),null);
  startService(clusterName,serviceName,false,false);
  ServiceComponentHostRequest req=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,"INSTALLED");
  Map<String,String> requestProperties=new HashMap<String,String>();
  requestProperties.put("namenode","p1");
  RequestStatusResponse resp=updateHostComponents(Collections.singleton(req),requestProperties,false);
  assertNotNull(resp);
  for (  ServiceComponentHost sch : clusters.getCluster(clusterName).getServiceComponentHosts(host1)) {
    sch.setState(State.INSTALLED);
  }
  resp=updateHostComponents(Collections.singleton(req),new HashMap<String,String>(),false);
  assertNull(resp);
  resp=updateHostComponents(Collections.singleton(req),requestProperties,false);
  assertNotNull(resp);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceUpdateRecursive() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  clusters.getCluster(clusterName).setDesiredStackVersion(new StackId("HDP-0.2"));
  String serviceName1="HDFS";
  createService(clusterName,serviceName1,null);
  String serviceName2="HBASE";
  createService(clusterName,serviceName2,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HBASE_MASTER";
  String componentName4="HDFS_CLIENT";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  createServiceComponent(clusterName,serviceName1,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName2,componentName3,State.INIT);
  createServiceComponent(clusterName,serviceName1,componentName4,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName1,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName1,componentName2,host2,State.INIT.toString());
  ServiceComponentHostRequest r5=new ServiceComponentHostRequest(clusterName,serviceName2,componentName3,host1,State.INIT.toString());
  ServiceComponentHostRequest r6=new ServiceComponentHostRequest(clusterName,serviceName1,componentName4,host2,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  set1.add(r5);
  set1.add(r6);
  controller.createHostComponents(set1);
  Cluster c1=clusters.getCluster(clusterName);
  Service s1=c1.getService(serviceName1);
  Service s2=c1.getService(serviceName2);
  ServiceComponent sc1=s1.getServiceComponent(componentName1);
  ServiceComponent sc2=s1.getServiceComponent(componentName2);
  ServiceComponent sc3=s2.getServiceComponent(componentName3);
  ServiceComponent sc4=s1.getServiceComponent(componentName4);
  ServiceComponentHost sch1=sc1.getServiceComponentHost(host1);
  ServiceComponentHost sch2=sc2.getServiceComponentHost(host1);
  ServiceComponentHost sch3=sc1.getServiceComponentHost(host2);
  ServiceComponentHost sch4=sc2.getServiceComponentHost(host2);
  ServiceComponentHost sch5=sc3.getServiceComponentHost(host1);
  ServiceComponentHost sch6=sc4.getServiceComponentHost(host2);
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INIT);
  sc3.setDesiredState(State.STARTED);
  sc4.setDesiredState(State.INSTALLED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.INSTALLED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch6.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  sch6.setState(State.INSTALLED);
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  ServiceRequest req1, req2;
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
    reqs.add(req1);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.INSTALLED);
  sch2.setDesiredState(State.INSTALLED);
  sch3.setDesiredState(State.INSTALLED);
  sch4.setDesiredState(State.INSTALLED);
  sch5.setDesiredState(State.INSTALLED);
  sch1.setState(State.INIT);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INIT);
  sch4.setState(State.INSTALLED);
  sch5.setState(State.INSTALLED);
  try {
    reqs.clear();
    req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
    reqs.add(req1);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected failure for invalid state update");
  }
 catch (  Exception e) {
  }
  s1.setDesiredState(State.INSTALLED);
  s2.setDesiredState(State.INSTALLED);
  sc1.setDesiredState(State.STARTED);
  sc2.setDesiredState(State.INSTALLED);
  sc3.setDesiredState(State.STARTED);
  sch1.setDesiredState(State.STARTED);
  sch2.setDesiredState(State.STARTED);
  sch3.setDesiredState(State.STARTED);
  sch4.setDesiredState(State.STARTED);
  sch5.setDesiredState(State.STARTED);
  sch1.setState(State.INSTALLED);
  sch2.setState(State.INSTALLED);
  sch3.setState(State.INSTALLED);
  sch4.setState(State.STARTED);
  sch5.setState(State.INSTALLED);
  reqs.clear();
  req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
  req2=new ServiceRequest(clusterName,serviceName2,State.STARTED.toString());
  reqs.add(req1);
  reqs.add(req2);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertEquals(State.STARTED,s1.getDesiredState());
  Assert.assertEquals(State.STARTED,s2.getDesiredState());
  Assert.assertEquals(State.STARTED,sc1.getDesiredState());
  Assert.assertEquals(State.STARTED,sc2.getDesiredState());
  Assert.assertEquals(State.STARTED,sc3.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sc4.getDesiredState());
  Assert.assertEquals(State.STARTED,sch1.getDesiredState());
  Assert.assertEquals(State.STARTED,sch2.getDesiredState());
  Assert.assertEquals(State.STARTED,sch3.getDesiredState());
  Assert.assertEquals(State.STARTED,sch4.getDesiredState());
  Assert.assertEquals(State.STARTED,sch5.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch6.getDesiredState());
  Assert.assertEquals(State.INSTALLED,sch1.getState());
  Assert.assertEquals(State.INSTALLED,sch2.getState());
  Assert.assertEquals(State.INSTALLED,sch3.getState());
  Assert.assertEquals(State.STARTED,sch4.getState());
  Assert.assertEquals(State.INSTALLED,sch5.getState());
  Assert.assertEquals(State.INSTALLED,sch6.getState());
  long requestId=trackAction.getRequestId();
  List<Stage> stages=actionDB.getAllStages(requestId);
  for (  Stage stage : stages) {
    LOG.debug("Stage dump: " + stage.toString());
  }
  Assert.assertTrue(!stages.isEmpty());
  Assert.assertEquals(3,stages.size());
  Stage stage1=null, stage2=null, stage3=null;
  for (  Stage s : stages) {
    if (s.getStageId() == 0) {
      stage1=s;
    }
    if (s.getStageId() == 1) {
      stage2=s;
    }
    if (s.getStageId() == 2) {
      stage3=s;
    }
  }
  Assert.assertEquals(2,stage1.getExecutionCommands(host1).size());
  Assert.assertEquals(1,stage1.getExecutionCommands(host2).size());
  Assert.assertEquals(1,stage2.getExecutionCommands(host1).size());
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host1,"NAMENODE"));
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host1,"DATANODE"));
  Assert.assertNotNull(stage1.getExecutionCommandWrapper(host2,"NAMENODE"));
  Assert.assertNotNull(stage2.getExecutionCommandWrapper(host1,"HBASE_MASTER"));
  Assert.assertNull(stage1.getExecutionCommandWrapper(host2,"DATANODE"));
  Assert.assertNotNull(stage3.getExecutionCommandWrapper(host1,"HBASE_SERVICE_CHECK"));
  Assert.assertNotNull(stage2.getExecutionCommandWrapper(host2,"HDFS_SERVICE_CHECK"));
  Type type=new TypeToken<Map<String,String>>(){
  }
.getType();
  for (  Stage s : stages) {
    for (    List<ExecutionCommandWrapper> list : s.getExecutionCommands().values()) {
      for (      ExecutionCommandWrapper ecw : list) {
        if (ecw.getExecutionCommand().getRole().contains("SERVICE_CHECK")) {
          Map<String,String> hostParams=StageUtils.getGson().fromJson(s.getHostParamsStage(),type);
          Assert.assertNotNull(hostParams);
          Assert.assertTrue(hostParams.size() > 0);
          Assert.assertTrue(hostParams.containsKey("stack_version"));
          Assert.assertEquals(hostParams.get("stack_version"),c1.getDesiredStackVersion().getStackVersion());
        }
      }
    }
  }
  sch1.setState(State.STARTED);
  sch2.setState(State.STARTED);
  sch3.setState(State.STARTED);
  sch4.setState(State.STARTED);
  sch5.setState(State.STARTED);
  reqs.clear();
  req1=new ServiceRequest(clusterName,serviceName1,State.STARTED.toString());
  req2=new ServiceRequest(clusterName,serviceName2,State.STARTED.toString());
  reqs.add(req1);
  reqs.add(req2);
  trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponentHostMultiple() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  String host1="h1";
  String host2="h2";
  addHostToCluster(host1,clusterName);
  addHostToCluster(host2,clusterName);
  Set<ServiceComponentHostRequest> set1=new HashSet<ServiceComponentHostRequest>();
  ServiceComponentHostRequest r1=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host1,State.INIT.toString());
  ServiceComponentHostRequest r2=new ServiceComponentHostRequest(clusterName,serviceName,componentName2,host1,State.INIT.toString());
  ServiceComponentHostRequest r3=new ServiceComponentHostRequest(clusterName,serviceName,componentName1,host2,State.INIT.toString());
  ServiceComponentHostRequest r4=new ServiceComponentHostRequest(clusterName,serviceName,componentName2,host2,State.INIT.toString());
  set1.add(r1);
  set1.add(r2);
  set1.add(r3);
  set1.add(r4);
  controller.createHostComponents(set1);
  Assert.assertEquals(2,clusters.getCluster(clusterName).getServiceComponentHosts(host1).size());
  Assert.assertEquals(2,clusters.getCluster(clusterName).getServiceComponentHosts(host2).size());
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName1).getServiceComponentHost(host2));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host1));
  Assert.assertNotNull(clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(componentName2).getServiceComponentHost(host2));
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceUpdateBasic() throws AmbariException, AuthorizationException {
  String clusterName="foo1";
  createCluster(clusterName);
  String serviceName="HDFS";
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  clusters.getCluster("foo1").setDesiredStackVersion(new StackId("HDP-0.2"));
  createService(clusterName,serviceName,State.INIT);
  Service s=clusters.getCluster(clusterName).getService(serviceName);
  Assert.assertNotNull(s);
  Assert.assertEquals(serviceName,s.getName());
  Assert.assertEquals(State.INIT,s.getDesiredState());
  Assert.assertEquals(clusterName,s.getCluster().getClusterName());
  Set<ServiceRequest> reqs=new HashSet<ServiceRequest>();
  ServiceRequest r;
  try {
    r=new ServiceRequest(clusterName,serviceName,State.INSTALLING.toString());
    reqs.clear();
    reqs.add(r);
    ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
    fail("Expected fail for invalid state transition");
  }
 catch (  Exception e) {
  }
  r=new ServiceRequest(clusterName,serviceName,State.INSTALLED.toString());
  reqs.clear();
  reqs.add(r);
  RequestStatusResponse trackAction=ServiceResourceProviderTest.updateServices(controller,reqs,mapRequestProps,true,false);
  Assert.assertNull(trackAction);
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateHostSimple() throws AmbariException {
  Map<String,String> hostAttributes=null;
  HostRequest r1=new HostRequest("h1",null,hostAttributes);
  r1.toString();
  Set<HostRequest> requests=new HashSet<HostRequest>();
  requests.add(r1);
  try {
    HostResourceProviderTest.createHosts(controller,requests);
    fail("Create host should fail for non-bootstrapped host");
  }
 catch (  Exception e) {
  }
  clusters.addHost("h1");
  clusters.addHost("h2");
  setOsFamily(clusters.getHost("h1"),"redhat","5.9");
  setOsFamily(clusters.getHost("h2"),"redhat","5.9");
  clusters.getHost("h1").persist();
  clusters.getHost("h2").persist();
  requests.add(new HostRequest("h2","foo",new HashMap<String,String>()));
  try {
    HostResourceProviderTest.createHosts(controller,requests);
    fail("Create host should fail for invalid clusters");
  }
 catch (  Exception e) {
  }
  clusters.addCluster("foo",new StackId("HDP-0.1"));
  Cluster c=clusters.getCluster("foo");
  StackId stackId=new StackId("HDP-0.1");
  c.setDesiredStackVersion(stackId);
  c.setCurrentStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  HostResourceProviderTest.createHosts(controller,requests);
  Assert.assertNotNull(clusters.getHost("h1"));
  Assert.assertNotNull(clusters.getHost("h2"));
  Assert.assertEquals(0,clusters.getClustersForHost("h1").size());
  Assert.assertEquals(1,clusters.getClustersForHost("h2").size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceWidgetCreationOnServiceCreate() throws Exception {
  String clusterName="foo1";
  ClusterRequest r=new ClusterRequest(null,clusterName,State.INSTALLED.name(),SecurityType.NONE,"OTHER-2.0",null);
  controller.createCluster(r);
  String serviceName="HBASE";
  clusters.getCluster("foo1").setDesiredStackVersion(new StackId("OTHER-2.0"));
  createService(clusterName,serviceName,State.INIT);
  Service s=clusters.getCluster(clusterName).getService(serviceName);
  Assert.assertNotNull(s);
  Assert.assertEquals(serviceName,s.getName());
  Assert.assertEquals(clusterName,s.getCluster().getClusterName());
  WidgetDAO widgetDAO=injector.getInstance(WidgetDAO.class);
  WidgetLayoutDAO widgetLayoutDAO=injector.getInstance(WidgetLayoutDAO.class);
  List<WidgetEntity> widgetEntities=widgetDAO.findAll();
  List<WidgetLayoutEntity> layoutEntities=widgetLayoutDAO.findAll();
  Assert.assertNotNull(widgetEntities);
  Assert.assertFalse(widgetEntities.isEmpty());
  Assert.assertNotNull(layoutEntities);
  Assert.assertFalse(layoutEntities.isEmpty());
  WidgetEntity candidateVisibleEntity=null;
  for (  WidgetEntity entity : widgetEntities) {
    if (entity.getWidgetName().equals("OPEN_CONNECTIONS")) {
      candidateVisibleEntity=entity;
    }
  }
  Assert.assertNotNull(candidateVisibleEntity);
  Assert.assertEquals("GRAPH",candidateVisibleEntity.getWidgetType());
  Assert.assertEquals("ambari",candidateVisibleEntity.getAuthor());
  Assert.assertEquals("CLUSTER",candidateVisibleEntity.getScope());
  Assert.assertNotNull(candidateVisibleEntity.getMetrics());
  Assert.assertNotNull(candidateVisibleEntity.getProperties());
  Assert.assertNotNull(candidateVisibleEntity.getWidgetValues());
  WidgetLayoutEntity candidateLayoutEntity=null;
  for (  WidgetLayoutEntity entity : layoutEntities) {
    if (entity.getLayoutName().equals("default_hbase_layout")) {
      candidateLayoutEntity=entity;
    }
  }
  Assert.assertNotNull(candidateLayoutEntity);
  List<WidgetLayoutUserWidgetEntity> layoutUserWidgetEntities=candidateLayoutEntity.getListWidgetLayoutUserWidgetEntity();
  Assert.assertNotNull(layoutUserWidgetEntities);
  Assert.assertEquals(4,layoutUserWidgetEntities.size());
  Assert.assertEquals("RS_READS_WRITES",layoutUserWidgetEntities.get(0).getWidget().getWidgetName());
  Assert.assertEquals("OPEN_CONNECTIONS",layoutUserWidgetEntities.get(1).getWidget().getWidgetName());
  Assert.assertEquals("FILES_LOCAL",layoutUserWidgetEntities.get(2).getWidget().getWidgetName());
  Assert.assertEquals("UPDATED_BLOCKED_TIME",layoutUserWidgetEntities.get(3).getWidget().getWidgetName());
  Assert.assertEquals("HBASE_SUMMARY",layoutUserWidgetEntities.get(0).getWidget().getDefaultSectionName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariServerTest </h4><pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProxyUser() throws Exception {
  PasswordAuthentication pa=Authenticator.requestPasswordAuthentication(InetAddress.getLocalHost(),80,null,null,null);
  Assert.assertNull(pa);
  System.setProperty("http.proxyUser","abc");
  System.setProperty("http.proxyPassword","def");
  AmbariServer.setupProxyAuth();
  pa=Authenticator.requestPasswordAuthentication(InetAddress.getLocalHost(),80,null,null,null);
  Assert.assertNotNull(pa);
  Assert.assertEquals("abc",pa.getUserName());
  Assert.assertArrayEquals("def".toCharArray(),pa.getPassword());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.AmbariSessionManagerTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetCurrentSessionId() throws Exception {
  HttpSession session=createNiceMock(HttpSession.class);
  AmbariSessionManager sessionManager=createMockBuilder(AmbariSessionManager.class).addMockedMethod("getHttpSession").createMock();
  expect(sessionManager.getHttpSession()).andReturn(session);
  expect(sessionManager.getHttpSession()).andReturn(null);
  expect(session.getId()).andReturn("SESSION_ID").anyTimes();
  replay(session,sessionManager);
  assertEquals("SESSION_ID",sessionManager.getCurrentSessionId());
  assertNull(sessionManager.getCurrentSessionId());
  verify(session,sessionManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.BackgroundCustomCommandExecutionTest </h4><pre class="type-4 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("serial") @Test public void testRebalanceHdfsCustomCommand(){
  try {
    createClusterFixture();
    Map<String,String> requestProperties=new HashMap<String,String>(){
{
        put(REQUEST_CONTEXT_PROPERTY,"Refresh YARN Capacity Scheduler");
        put("command","REBALANCEHDFS");
        put("namenode","{\"threshold\":13}");
      }
    }
;
    ExecuteActionRequest actionRequest=new ExecuteActionRequest("c1","REBALANCEHDFS",new HashMap<String,String>(),false);
    actionRequest.getResourceFilters().add(new RequestResourceFilter("HDFS","NAMENODE",Collections.singletonList("c6401")));
    controller.createAction(actionRequest,requestProperties);
    Mockito.verify(am,Mockito.times(1)).sendActions(requestCapture.capture(),any(ExecuteActionRequest.class));
    Request request=requestCapture.getValue();
    Assert.assertNotNull(request);
    Assert.assertNotNull(request.getStages());
    Assert.assertEquals(1,request.getStages().size());
    Stage stage=request.getStages().iterator().next();
    System.out.println(stage);
    Assert.assertEquals(1,stage.getHosts().size());
    List<ExecutionCommandWrapper> commands=stage.getExecutionCommands("c6401");
    Assert.assertEquals(1,commands.size());
    ExecutionCommand command=commands.get(0).getExecutionCommand();
    Assert.assertEquals(AgentCommandType.BACKGROUND_EXECUTION_COMMAND,command.getCommandType());
    Assert.assertEquals("{\"threshold\":13}",command.getCommandParams().get("namenode"));
  }
 catch (  Exception e) {
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.KerberosHelperTest </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetActiveIdentities_SingleServiceSingleHost() throws Exception {
  Map<String,Collection<KerberosIdentityDescriptor>> identities=testGetActiveIdentities("c1","host2","SERVICE1",null,true,SecurityType.KERBEROS);
  Assert.assertNotNull(identities);
  Assert.assertEquals(1,identities.size());
  Collection<KerberosIdentityDescriptor> hostIdentities;
  hostIdentities=identities.get("host2");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(2,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity1",new HashMap<String,Object>(){
{
          put("principal_name","service1/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/component1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/component1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity3",new HashMap<String,Object>(){
{
          put("principal_name","service1/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/service1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.service.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/service1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetAuthToLocalRules() throws Exception {
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  final KerberosPrincipalDescriptor principalDescriptor1=createMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor1.getValue()).andReturn("principal1/host1@EXAMPLE.COM").times(1);
  expect(principalDescriptor1.getLocalUsername()).andReturn("principal1_user").times(1);
  final KerberosPrincipalDescriptor principalDescriptor2=createMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor2.getValue()).andReturn("principal2/host2@EXAMPLE.COM").times(1);
  expect(principalDescriptor2.getLocalUsername()).andReturn("principal2_user").times(1);
  final KerberosPrincipalDescriptor principalDescriptor3=createMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor3.getValue()).andReturn("principal3/host3@EXAMPLE.COM").times(1);
  expect(principalDescriptor3.getLocalUsername()).andReturn("principal3_user").times(1);
  final KerberosIdentityDescriptor identityDescriptor1=createMock(KerberosIdentityDescriptor.class);
  expect(identityDescriptor1.getPrincipalDescriptor()).andReturn(principalDescriptor1).times(1);
  final KerberosIdentityDescriptor identityDescriptor2=createMock(KerberosIdentityDescriptor.class);
  expect(identityDescriptor2.getPrincipalDescriptor()).andReturn(principalDescriptor2).times(1);
  final KerberosIdentityDescriptor identityDescriptor3=createMock(KerberosIdentityDescriptor.class);
  expect(identityDescriptor3.getPrincipalDescriptor()).andReturn(principalDescriptor3).times(1);
  final KerberosServiceDescriptor serviceDescriptor1=createMock(KerberosServiceDescriptor.class);
  expect(serviceDescriptor1.getName()).andReturn("SERVICE1").times(2);
  expect(serviceDescriptor1.getIdentities(true)).andReturn(Arrays.asList(identityDescriptor1,identityDescriptor2,identityDescriptor3)).times(1);
  expect(serviceDescriptor1.getComponents()).andReturn(null).times(1);
  expect(serviceDescriptor1.getAuthToLocalProperties()).andReturn(new HashSet<String>(Arrays.asList("default","explicit_multiple_lines|new_lines","explicit_multiple_lines_escaped|new_lines_escaped","explicit_single_line|spaces","service-site/default","service-site/explicit_multiple_lines|new_lines","service-site/explicit_multiple_lines_escaped|new_lines_escaped","service-site/explicit_single_line|spaces"))).times(1);
  final KerberosDescriptor kerberosDescriptor=createMock(KerberosDescriptor.class);
  expect(kerberosDescriptor.getProperty("additional_realms")).andReturn(null).times(1);
  expect(kerberosDescriptor.getIdentities()).andReturn(null).times(1);
  expect(kerberosDescriptor.getAuthToLocalProperties()).andReturn(null).times(1);
  expect(kerberosDescriptor.getServices()).andReturn(Collections.singletonMap("SERVICE1",serviceDescriptor1)).times(1);
  final Service service1=createNiceMock(Service.class);
  final Cluster cluster=createNiceMock(Cluster.class);
  expect(cluster.getServices()).andReturn(Collections.singletonMap("SERVICE1",service1)).times(1);
  Map<String,Map<String,String>> kerberosConfigurations=new HashMap<String,Map<String,String>>();
  replayAll();
  injector.getInstance(AmbariMetaInfo.class).init();
  Map existingConfigs=new HashMap<String,Map<String,String>>();
  existingConfigs.put("kerberos-env",new HashMap<String,String>());
  kerberosHelper.setAuthToLocalRules(kerberosDescriptor,cluster,"EXAMPLE.COM",existingConfigs,kerberosConfigurations);
  verifyAll();
  Map<String,String> configs;
  configs=kerberosConfigurations.get("");
  assertNotNull(configs);
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\n"+ "DEFAULT",configs.get("default"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\n"+ "DEFAULT",configs.get("explicit_multiple_lines"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\\\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\\\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\\\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\\\n"+ "DEFAULT",configs.get("explicit_multiple_lines_escaped"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*// " + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/ " + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/ "+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/ "+ "DEFAULT",configs.get("explicit_single_line"));
  configs=kerberosConfigurations.get("service-site");
  assertNotNull(configs);
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\n"+ "DEFAULT",configs.get("default"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\n"+ "DEFAULT",configs.get("explicit_multiple_lines"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*//\\\n" + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/\\\n" + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/\\\n"+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/\\\n"+ "DEFAULT",configs.get("explicit_multiple_lines_escaped"));
  assertEquals("RULE:[1:$1@$0](.*@EXAMPLE.COM)s/@.*// " + "RULE:[2:$1@$0](principal1@EXAMPLE.COM)s/.*/principal1_user/ " + "RULE:[2:$1@$0](principal2@EXAMPLE.COM)s/.*/principal2_user/ "+ "RULE:[2:$1@$0](principal3@EXAMPLE.COM)s/.*/principal3_user/ "+ "DEFAULT",configs.get("explicit_single_line"));
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetActiveIdentities_SingleService() throws Exception {
  Map<String,Collection<KerberosIdentityDescriptor>> identities=testGetActiveIdentities("c1",null,"SERVICE1",null,true,SecurityType.KERBEROS);
  Assert.assertNotNull(identities);
  Assert.assertEquals(2,identities.size());
  Collection<KerberosIdentityDescriptor> hostIdentities;
  hostIdentities=identities.get("host1");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(2,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity1",new HashMap<String,Object>(){
{
          put("principal_name","service1/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/component1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/component1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity3",new HashMap<String,Object>(){
{
          put("principal_name","service1/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/service1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.service.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/service1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
  hostIdentities=identities.get("host2");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(2,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity1",new HashMap<String,Object>(){
{
          put("principal_name","service1/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/component1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/component1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity3",new HashMap<String,Object>(){
{
          put("principal_name","service1/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/service1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.service.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/service1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetActiveIdentities_SingleHost() throws Exception {
  Map<String,Collection<KerberosIdentityDescriptor>> identities=testGetActiveIdentities("c1","host1",null,null,true,SecurityType.KERBEROS);
  Assert.assertNotNull(identities);
  Assert.assertEquals(1,identities.size());
  Collection<KerberosIdentityDescriptor> hostIdentities;
  hostIdentities=identities.get("host1");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(3,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity1",new HashMap<String,Object>(){
{
          put("principal_name","service1/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/component1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/component1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity2",new HashMap<String,Object>(){
{
          put("principal_name","component2/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service2-site/component2.kerberos.principal");
          put("principal_local_username","service2");
          put("keytab_file","${keytab_dir}/service2.keytab");
          put("keytab_owner_name","service2");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service2-site/component2.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
      put("identity3",new HashMap<String,Object>(){
{
          put("principal_name","service1/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service1-site/service1.kerberos.principal");
          put("principal_local_username","service1");
          put("keytab_file","${keytab_dir}/service1.service.keytab");
          put("keytab_owner_name","service1");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service1-site/service1.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetActiveIdentities_SingleComponent() throws Exception {
  Map<String,Collection<KerberosIdentityDescriptor>> identities=testGetActiveIdentities("c1",null,null,"COMPONENT2",true,SecurityType.KERBEROS);
  Assert.assertNotNull(identities);
  Assert.assertEquals(2,identities.size());
  Collection<KerberosIdentityDescriptor> hostIdentities;
  hostIdentities=identities.get("host1");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(1,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity2",new HashMap<String,Object>(){
{
          put("principal_name","component2/host1@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service2-site/component2.kerberos.principal");
          put("principal_local_username","service2");
          put("keytab_file","${keytab_dir}/service2.keytab");
          put("keytab_owner_name","service2");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service2-site/component2.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
  hostIdentities=identities.get("host2");
  Assert.assertNotNull(hostIdentities);
  Assert.assertEquals(1,hostIdentities.size());
  validateIdentities(hostIdentities,new HashMap<String,Map<String,Object>>(){
{
      put("identity2",new HashMap<String,Object>(){
{
          put("principal_name","component2/host2@EXAMPLE.COM");
          put("principal_type",KerberosPrincipalType.SERVICE);
          put("principal_configuration","service2-site/component2.kerberos.principal");
          put("principal_local_username","service2");
          put("keytab_file","${keytab_dir}/service2.keytab");
          put("keytab_owner_name","service2");
          put("keytab_owner_access","rw");
          put("keytab_group_name","hadoop");
          put("keytab_group_access","");
          put("keytab_configuration","service2-site/component2.keytab.file");
          put("keytab_cachable",false);
        }
      }
);
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.gsinstaller.GSInstallerNoOpProviderTest </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testGetKeyPropertyIds() throws Exception {
  ClusterDefinition clusterDefinition=new ClusterDefinition(new TestGSInstallerStateProvider());
  GSInstallerNoOpProvider provider=new GSInstallerNoOpProvider(Resource.Type.Workflow,clusterDefinition);
  Assert.assertNotNull(provider.getKeyPropertyIds());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractPropertyProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateComponentMetricMapHDP1(){
  Map<String,Map<String,PropertyInfo>> componentMetrics=PropertyHelper.getMetricPropertyIds(Resource.Type.HostComponent);
  AbstractPropertyProvider provider=new TestPropertyProvider(componentMetrics);
  Map<String,PropertyInfo> flumeMetrics=provider.getComponentMetrics().get("FLUME_HANDLER");
  int metricsBefore=flumeMetrics.size();
  String specificMetric="metrics/flume/arg1/CHANNEL/arg2/ChannelCapacity";
  String specificPropertyInfoId="arg1.CHANNEL.arg2.ChannelCapacity";
  Map<String,PropertyInfo> componentMetricMap=provider.getComponentMetrics().get("FLUME_HANDLER");
  Assert.assertNull(flumeMetrics.get(specificMetric));
  provider.updateComponentMetricMap(componentMetricMap,specificMetric);
  Assert.assertEquals(metricsBefore + 1,flumeMetrics.size());
  Assert.assertNotNull(flumeMetrics.get(specificMetric));
  Assert.assertEquals(specificPropertyInfoId,flumeMetrics.get(specificMetric).getPropertyId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AbstractResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetQueryParameterValue(){
  String queryParameterId1="qp/variable1";
  String queryParameterValue1="value1";
  String queryParameterId2="qp/variable2";
  String queryParameterValue2="value2";
  Predicate predicate=new PredicateBuilder().property(queryParameterId1).equals(queryParameterValue1).and().property(queryParameterId2).equals(queryParameterValue2).toPredicate();
  Assert.assertEquals(queryParameterValue1,AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate));
  Assert.assertFalse(queryParameterValue2.equals(AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate)));
  Assert.assertNull(AbstractResourceProvider.getQueryParameterValue("queryParameterIdNotFound",predicate));
  String queryParameterId3="qp/variable3";
  String queryParameterValue3="value3";
  predicate=new PredicateBuilder().property(queryParameterId3).equals(queryParameterValue3).and().begin().property(queryParameterId1).equals(queryParameterValue1).and().property(queryParameterId2).equals(queryParameterValue2).end().toPredicate();
  Assert.assertEquals(queryParameterValue1,AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate));
  Assert.assertFalse(queryParameterValue2.equals(AbstractResourceProvider.getQueryParameterValue(queryParameterId1,predicate)));
  Assert.assertNull(AbstractResourceProvider.getQueryParameterValue("queryParameterIdNotFound",predicate));
  Assert.assertEquals(queryParameterValue3,AbstractResourceProvider.getQueryParameterValue(queryParameterId3,predicate));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequestStatus(){
  Set<String> propertyIds=new HashSet<String>();
  Map<Resource.Type,String> keyPropertyIds=new HashMap<Resource.Type,String>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  MaintenanceStateHelper maintenanceStateHelper=createNiceMock(MaintenanceStateHelper.class);
  replay(maintenanceStateHelper);
  AbstractResourceProvider provider=new ServiceResourceProvider(propertyIds,keyPropertyIds,managementController,maintenanceStateHelper);
  RequestStatus status=provider.getRequestStatus(null);
  Assert.assertNull(status.getRequestResource());
  Assert.assertEquals(Collections.emptySet(),status.getAssociatedResources());
  RequestStatusResponse response=new RequestStatusResponse(99L);
  status=provider.getRequestStatus(response);
  Resource resource=status.getRequestResource();
  Assert.assertEquals(99L,resource.getPropertyValue("Requests/id"));
  Assert.assertEquals(Collections.emptySet(),status.getAssociatedResources());
  status=provider.getRequestStatus(response,null);
  resource=status.getRequestResource();
  Assert.assertEquals(99L,resource.getPropertyValue("Requests/id"));
  Assert.assertEquals(Collections.emptySet(),status.getAssociatedResources());
  Resource associatedResource=new ResourceImpl(Resource.Type.Service);
  Set<Resource> associatedResources=Collections.singleton(associatedResource);
  status=provider.getRequestStatus(response,associatedResources);
  resource=status.getRequestResource();
  Assert.assertEquals(99L,resource.getPropertyValue("Requests/id"));
  Assert.assertEquals(associatedResources,status.getAssociatedResources());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AlertDefinitionResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testUpdateResourcesWithNumbersAsStrings() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).atLeastOnce();
  Capture<AlertDefinitionEntity> entityCapture=new Capture<AlertDefinitionEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  expect(definitionHash.invalidateHosts(EasyMock.anyObject(AlertDefinitionEntity.class))).andReturn(new HashSet<String>()).atLeastOnce();
  replay(amc,clusters,cluster,dao,definitionHash);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  MetricSource source=(MetricSource)getMockSource();
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_CLUSTER_NAME,"c1");
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_INTERVAL,"1");
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_NAME,"my_def");
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_SERVICE_NAME,"HDFS");
  requestProps.put(AlertDefinitionResourceProvider.ALERT_DEF_SOURCE_TYPE,"METRIC");
  requestProps.put("AlertDefinition/source/reporting/critical/text",source.getReporting().getCritical().getText());
  requestProps.put("AlertDefinition/source/reporting/critical/value","1234.5");
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  AlertDefinitionResourceProvider provider=createProvider(amc);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  AlertDefinitionEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  String sourceJson=entity.getSource();
  Gson gson=new Gson();
  source=gson.fromJson(sourceJson,MetricSource.class);
  assertEquals(new Double(1234.5d),source.getReporting().getCritical().getValue());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AlertGroupResourceProviderTest </h4><pre class="type-7 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void before() throws Exception {
  m_dao=createMock(AlertDispatchDAO.class);
  m_definitionDao=createMock(AlertDefinitionDAO.class);
  m_amc=createMock(AmbariManagementController.class);
  m_clusters=createMock(Clusters.class);
  m_cluster=createMock(Cluster.class);
  m_injector=Guice.createInjector(Modules.override(new InMemoryDefaultTestModule()).with(new MockModule()));
  assertNotNull(m_injector);
  expect(m_amc.getClusters()).andReturn(m_clusters).anyTimes();
  expect(m_clusters.getCluster((String)anyObject())).andReturn(m_cluster).anyTimes();
  expect(m_clusters.getClusterById(1L)).andReturn(m_cluster).anyTimes();
  expect(m_cluster.getClusterId()).andReturn(1L).anyTimes();
  expect(m_cluster.getResourceId()).andReturn(4L).anyTimes();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AlertNoticeResourceProviderTest </h4><pre class="type-7 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void before(){
  m_dao=createStrictMock(AlertDispatchDAO.class);
  m_injector=Guice.createInjector(Modules.override(new InMemoryDefaultTestModule()).with(new MockModule()));
  Assert.assertNotNull(m_injector);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AlertTargetResourceProviderTest </h4><pre class="type-7 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void before(){
  m_dao=createStrictMock(AlertDispatchDAO.class);
  m_amc=createMock(AmbariManagementController.class);
  m_injector=Guice.createInjector(Modules.override(new InMemoryDefaultTestModule()).with(new MockModule()));
  Assert.assertNotNull(m_injector);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.AppCookieManagerTest </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void getCachedKnoxAppCookie(){
  assertNull(new AppCookieManager().getCachedAppCookie("http://dummy"));
}

</code></pre>

<br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void getHadoopAuthCookieValueWithNullHeaders(){
  assertNull(AppCookieManager.getHadoopAuthCookieValue(null));
}

</code></pre>

<br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void getHadoopAuthCookieValueWitEmptylHeaders(){
  assertNull(AppCookieManager.getHadoopAuthCookieValue(new Header[0]));
}

</code></pre>

<br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void getHadoopAuthCookieValueWithValidlHeaders(){
  Header[] headers=new Header[1];
  headers[0]=new BasicHeader("Set-Cookie",AppCookieManager.HADOOP_AUTH + "=dummyvalue");
  assertNotNull(AppCookieManager.getHadoopAuthCookieValue(headers));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BaseProviderTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegexpMethods(){
  Set<String> propertyIds=new HashSet<String>();
  String regexp="cat/$1.replaceAll(\\\"([.])\\\",\\\"/\\\")/key";
  String propertyId="cat/sub/key";
  String regexp2="cat/$1.replaceAll(\\\"([.])\\\",\\\"/\\\")/something/$2/key";
  String propertyId2="cat/sub/something/sub2/key";
  String incorrectPropertyId="some/property/id";
  propertyIds.add(regexp);
  propertyIds.add(regexp2);
  BaseProvider provider=new TestProvider(propertyIds);
  Map.Entry<String,Pattern> regexEntry=provider.getRegexEntry(propertyId);
  assertEquals(regexp,regexEntry.getKey());
  assertNull(provider.getRegexEntry(incorrectPropertyId));
  assertEquals("sub",provider.getRegexGroups(regexp,propertyId).get(0));
  assertEquals("sub2",provider.getRegexGroups(regexp2,propertyId2).get(1));
  assertTrue(provider.getRegexGroups(regexp,incorrectPropertyId).isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetResourcePropertyWithMaps(){
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("cat1/emptyMapProperty");
  propertyIds.add("cat1/mapProperty");
  propertyIds.add("cat2/mapMapProperty");
  propertyIds.add("cat3/mapProperty3/key2");
  propertyIds.add("cat4/mapMapProperty4/subMap1/key3");
  propertyIds.add("cat4/mapMapProperty4/subMap2");
  Resource resource=new ResourceImpl(Resource.Type.Service);
  Map<String,String> emptyMapProperty=new HashMap<String,String>();
  BaseProvider.setResourceProperty(resource,"cat1/emptyMapProperty",emptyMapProperty,propertyIds);
  assertTrue(resource.getPropertiesMap().containsKey("cat1/emptyMapProperty"));
  Map<String,String> mapProperty=new HashMap<String,String>();
  mapProperty.put("key1","value1");
  mapProperty.put("key2","value2");
  mapProperty.put("key3","value3");
  BaseProvider.setResourceProperty(resource,"cat1/mapProperty",mapProperty,propertyIds);
  assertNull(resource.getPropertyValue("cat1/mapProperty"));
  assertEquals("value1",resource.getPropertyValue("cat1/mapProperty/key1"));
  assertEquals("value2",resource.getPropertyValue("cat1/mapProperty/key2"));
  assertEquals("value3",resource.getPropertyValue("cat1/mapProperty/key3"));
  Map<String,Map<String,String>> mapMapProperty=new HashMap<String,Map<String,String>>();
  Map<String,String> mapSubProperty1=new HashMap<String,String>();
  mapSubProperty1.put("key1","value11");
  mapSubProperty1.put("key2","value12");
  mapSubProperty1.put("key3","value13");
  mapMapProperty.put("subMap1",mapSubProperty1);
  Map<String,String> mapSubProperty2=new HashMap<String,String>();
  mapSubProperty2.put("key1","value21");
  mapSubProperty2.put("key2","value22");
  mapSubProperty2.put("key3","value23");
  mapMapProperty.put("subMap2",mapSubProperty2);
  Map<String,String> mapSubProperty3=new HashMap<String,String>();
  mapMapProperty.put("subMap3",mapSubProperty3);
  BaseProvider.setResourceProperty(resource,"cat2/mapMapProperty",mapMapProperty,propertyIds);
  assertNull(resource.getPropertyValue("cat2/mapMapProperty"));
  assertNull(resource.getPropertyValue("cat2/mapMapProperty/subMap1"));
  assertNull(resource.getPropertyValue("cat2/mapMapProperty/subMap2"));
  assertTrue(resource.getPropertiesMap().containsKey("cat2/mapMapProperty/subMap3"));
  assertEquals("value11",resource.getPropertyValue("cat2/mapMapProperty/subMap1/key1"));
  assertEquals("value12",resource.getPropertyValue("cat2/mapMapProperty/subMap1/key2"));
  assertEquals("value13",resource.getPropertyValue("cat2/mapMapProperty/subMap1/key3"));
  assertEquals("value21",resource.getPropertyValue("cat2/mapMapProperty/subMap2/key1"));
  assertEquals("value22",resource.getPropertyValue("cat2/mapMapProperty/subMap2/key2"));
  assertEquals("value23",resource.getPropertyValue("cat2/mapMapProperty/subMap2/key3"));
  Map<String,String> mapProperty3=new HashMap<String,String>();
  mapProperty3.put("key1","value1");
  mapProperty3.put("key2","value2");
  mapProperty3.put("key3","value3");
  BaseProvider.setResourceProperty(resource,"cat3/mapProperty3",mapProperty3,propertyIds);
  assertNull(resource.getPropertyValue("cat3/mapProperty3"));
  assertNull(resource.getPropertyValue("cat3/mapProperty3/key1"));
  assertEquals("value2",resource.getPropertyValue("cat3/mapProperty3/key2"));
  assertNull(resource.getPropertyValue("cat3/mapProperty3/key3"));
  Map<String,Map<String,String>> mapMapProperty4=new HashMap<String,Map<String,String>>();
  mapMapProperty4.put("subMap1",mapSubProperty1);
  mapMapProperty4.put("subMap2",mapSubProperty2);
  BaseProvider.setResourceProperty(resource,"cat4/mapMapProperty4",mapMapProperty4,propertyIds);
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4"));
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4/subMap1"));
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4/subMap2"));
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4/subMap1/key1"));
  assertNull(resource.getPropertyValue("cat4/mapMapProperty4/subMap1/key2"));
  assertEquals("value13",resource.getPropertyValue("cat4/mapMapProperty4/subMap1/key3"));
  assertEquals("value21",resource.getPropertyValue("cat4/mapMapProperty4/subMap2/key1"));
  assertEquals("value22",resource.getPropertyValue("cat4/mapMapProperty4/subMap2/key2"));
  assertEquals("value23",resource.getPropertyValue("cat4/mapMapProperty4/subMap2/key3"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetResourceProperty(){
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("p1");
  propertyIds.add("foo");
  propertyIds.add("cat1/foo");
  propertyIds.add("cat2/bar");
  propertyIds.add("cat2/baz");
  propertyIds.add("cat3/sub1/bam");
  propertyIds.add("cat4/sub2/sub3/bat");
  propertyIds.add("cat5/sub5");
  Resource resource=new ResourceImpl(Resource.Type.Service);
  assertNull(resource.getPropertyValue("foo"));
  BaseProvider.setResourceProperty(resource,"foo","value1",propertyIds);
  assertEquals("value1",resource.getPropertyValue("foo"));
  BaseProvider.setResourceProperty(resource,"cat2/bar","value2",propertyIds);
  assertEquals("value2",resource.getPropertyValue("cat2/bar"));
  assertNull(resource.getPropertyValue("unsupported"));
  BaseProvider.setResourceProperty(resource,"unsupported","valueX",propertyIds);
  assertNull(resource.getPropertyValue("unsupported"));
  BaseProvider.setResourceProperty(resource,"cat5/sub5/prop5","value5",propertyIds);
  assertEquals("value5",resource.getPropertyValue("cat5/sub5/prop5"));
  BaseProvider.setResourceProperty(resource,"cat5/sub5/sub5a/prop5a","value5",propertyIds);
  assertEquals("value5",resource.getPropertyValue("cat5/sub5/sub5a/prop5a"));
  BaseProvider.setResourceProperty(resource,"cat5/sub7/unsupported","valueX",propertyIds);
  assertNull(resource.getPropertyValue("cat5/sub7/unsupported"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BlueprintConfigurationProcessorTest </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseNameNodes() throws Exception {
  final String expectedServiceName="serviceOne";
  Map<String,String> hdfsSiteConfigMap=new HashMap<String,String>();
  hdfsSiteConfigMap.put("dfs.ha.namenodes." + expectedServiceName,"node1");
  String[] result=BlueprintConfigurationProcessor.parseNameNodes(expectedServiceName,hdfsSiteConfigMap);
  assertNotNull("Resulting array was null",result);
  assertEquals("Incorrect array size",1,result.length);
  assertEquals("Incorrect value for returned name nodes","node1",result[0]);
  hdfsSiteConfigMap.put("dfs.ha.namenodes." + expectedServiceName," nodeSeven, nodeEight, nodeNine");
  String[] resultTwo=BlueprintConfigurationProcessor.parseNameNodes(expectedServiceName,hdfsSiteConfigMap);
  assertNotNull("Resulting array was null",resultTwo);
  assertEquals("Incorrect array size",3,resultTwo.length);
  assertEquals("Incorrect value for returned name node","nodeSeven",resultTwo[0]);
  assertEquals("Incorrect value for returned name node","nodeEight",resultTwo[1]);
  assertEquals("Incorrect value for returned name node","nodeNine",resultTwo[2]);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecommendConfiguration_applyStackDefaultsOnly() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedPortNum="808080";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.default.name",expectedHostName + ":" + expectedPortNum);
  coreSiteMap.put("fs.defaultFS","hdfs://" + expectedHostName + ":"+ expectedPortNum);
  coreSiteMap.put("fs.stackDefault.key2","dummyValue");
  Map<String,String> dummySiteMap=new HashMap<String,String>();
  properties.put("dummy-site",dummySiteMap);
  dummySiteMap.put("dummy.prop","dummyValue2");
  Map<String,Map<String,String>> parentProperties=new HashMap<String,Map<String,String>>();
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton(expectedHostGroupName));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Configuration parentConfig=new Configuration(parentProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),createStackDefaults());
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),parentConfig);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  topology.getAdvisedConfigurations().putAll(createAdvisedConfigMap());
  topology.setConfigRecommendationStrategy(ConfigRecommendationStrategy.ONLY_STACK_DEFAULTS_APPLY);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  reset(stack);
  expect(stack.getConfiguration(bp.getServices())).andReturn(createStackDefaults()).anyTimes();
  replay(stack);
  Set<String> configTypeUpdated=configProcessor.doUpdateForClusterCreate();
  assertEquals(expectedHostName + ":" + expectedPortNum,clusterConfig.getPropertyValue("core-site","fs.default.name"));
  assertEquals("stackDefaultUpgraded",clusterConfig.getPropertyValue("core-site","fs.stackDefault.key1"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.stackDefault.key2"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.notStackDefault"));
  assertTrue(configTypeUpdated.contains("dummy-site"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecommendConfiguration_neverApply() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedPortNum="808080";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.default.name",expectedHostName + ":" + expectedPortNum);
  coreSiteMap.put("fs.defaultFS","hdfs://" + expectedHostName + ":"+ expectedPortNum);
  coreSiteMap.put("fs.stackDefault.key2","dummyValue");
  Map<String,Map<String,String>> parentProperties=new HashMap<String,Map<String,String>>();
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton(expectedHostGroupName));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Configuration parentClusterConfig=new Configuration(parentProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),createStackDefaults());
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),parentClusterConfig);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  topology.getAdvisedConfigurations().putAll(createAdvisedConfigMap());
  topology.setConfigRecommendationStrategy(ConfigRecommendationStrategy.NEVER_APPLY);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForClusterCreate();
  assertEquals(expectedHostName + ":" + expectedPortNum,clusterConfig.getPropertyValue("core-site","fs.default.name"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.notStackDefault"));
  assertEquals("stackDefaultValue1",clusterConfig.getPropertyValue("core-site","fs.stackDefault.key1"));
  assertNotNull(clusterConfig.getPropertyValue("core-site","fs.stackDefault.key2"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecommendConfiguration_applyAlways() throws Exception {
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedPortNum="808080";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> coreSiteMap=new HashMap<String,String>();
  properties.put("core-site",coreSiteMap);
  coreSiteMap.put("fs.default.name",expectedHostName + ":" + expectedPortNum);
  coreSiteMap.put("fs.defaultFS","hdfs://" + expectedHostName + ":"+ expectedPortNum);
  coreSiteMap.put("fs.stackDefault.key2","dummyValue");
  Map<String,String> dummySiteMap=new HashMap<String,String>();
  properties.put("dummy-site",dummySiteMap);
  dummySiteMap.put("dummy.prop","dummyValue");
  Map<String,Map<String,String>> parentProperties=new HashMap<String,Map<String,String>>();
  Collection<String> hgComponents=new HashSet<String>();
  hgComponents.add("NAMENODE");
  hgComponents.add("SECONDARY_NAMENODE");
  hgComponents.add("RESOURCEMANAGER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents,Collections.singleton("testhost"));
  Collection<String> hgComponents2=new HashSet<String>();
  hgComponents2.add("DATANODE");
  hgComponents2.add("HDFS_CLIENT");
  TestHostGroup group2=new TestHostGroup("group2",hgComponents2,Collections.singleton(expectedHostGroupName));
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group1);
  hostGroups.add(group2);
  Configuration parentClusterConfig=new Configuration(parentProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),createStackDefaults());
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap(),parentClusterConfig);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  topology.getAdvisedConfigurations().putAll(createAdvisedConfigMap());
  topology.setConfigRecommendationStrategy(ConfigRecommendationStrategy.ALWAYS_APPLY);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  Set<String> configTypes=configProcessor.doUpdateForClusterCreate();
  assertEquals(expectedHostName + ":" + expectedPortNum,clusterConfig.getPropertyValue("core-site","fs.default.name"));
  assertEquals("stackDefaultUpgraded",clusterConfig.getPropertyValue("core-site","fs.stackDefault.key1"));
  assertNull(clusterConfig.getPropertyValue("core-site","fs.stackDefault.key2"));
  assertNotNull(clusterConfig.getPropertyValue("core-site","fs.notStackDefault"));
  assertEquals(2,topology.getAdvisedConfigurations().size());
  assertFalse(configTypes.contains("dummy-site"));
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseNameServices() throws Exception {
  Map<String,String> hdfsSiteConfigMap=new HashMap<String,String>();
  hdfsSiteConfigMap.put("dfs.nameservices","serviceOne");
  String[] result=BlueprintConfigurationProcessor.parseNameServices(hdfsSiteConfigMap);
  assertNotNull("Resulting array was null",result);
  assertEquals("Incorrect array size",1,result.length);
  assertEquals("Incorrect value for returned name service","serviceOne",result[0]);
  hdfsSiteConfigMap.put("dfs.nameservices"," serviceTwo, serviceThree, serviceFour");
  String[] resultTwo=BlueprintConfigurationProcessor.parseNameServices(hdfsSiteConfigMap);
  assertNotNull("Resulting array was null",resultTwo);
  assertEquals("Incorrect array size",3,resultTwo.length);
  assertEquals("Incorrect value for returned name service","serviceTwo",resultTwo[0]);
  assertEquals("Incorrect value for returned name service","serviceThree",resultTwo[1]);
  assertEquals("Incorrect value for returned name service","serviceFour",resultTwo[2]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.BlueprintResourceProviderTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testPopulateConfigurationEntity_configIsNull() throws Exception {
  Map<String,String> configuration=null;
  BlueprintConfiguration config=new BlueprintConfigEntity();
  provider.populateConfigurationEntity(configuration,config);
  assertNotNull(config.getConfigAttributes());
  assertNotNull(config.getConfigData());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_withOldSchema() throws Exception {
  Map<String,String> configMap=new HashMap<String,String>();
  configMap.put("global/hive_database","db");
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV1);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_withEmptyConfiguration() throws Exception {
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  setConfigurationProperties(setProperties);
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(Request.REQUEST_INFO_BODY_PROPERTY,"{\"configurations\":[]}");
  Request request=createMock(Request.class);
  expect(blueprintFactory.createBlueprint(setProperties.iterator().next(),null)).andReturn(blueprint).once();
  blueprint.validateRequiredProperties();
  blueprint.validateTopology();
  expect(blueprint.toEntity()).andReturn(entity);
  expect(blueprint.getName()).andReturn(BLUEPRINT_NAME).atLeastOnce();
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  expect(dao.findByName(BLUEPRINT_NAME)).andReturn(null);
  dao.create(entity);
  replay(dao,entity,metaInfo,blueprintFactory,blueprint,request,managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Blueprint,PropertyHelper.getPropertyIds(Resource.Type.Blueprint),PropertyHelper.getKeyPropertyIds(Resource.Type.Blueprint),managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  provider.createResources(request);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  assertNotNull(lastEvent);
  assertEquals(Resource.Type.Blueprint,lastEvent.getResourceType());
  assertEquals(ResourceProviderEvent.Type.Create,lastEvent.getType());
  assertEquals(request,lastEvent.getRequest());
  assertNull(lastEvent.getPredicate());
  verify(dao,entity,blueprintFactory,metaInfo,request,managementController);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_withConfiguration() throws Exception {
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  setConfigurationProperties(setProperties);
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Map<String,String> requestInfoProperties=getTestRequestInfoProperties();
  Request request=createMock(Request.class);
  expect(blueprintFactory.createBlueprint(setProperties.iterator().next(),null)).andReturn(blueprint).once();
  blueprint.validateRequiredProperties();
  blueprint.validateTopology();
  expect(blueprint.toEntity()).andReturn(entity);
  expect(blueprint.getName()).andReturn(BLUEPRINT_NAME).atLeastOnce();
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  expect(dao.findByName(BLUEPRINT_NAME)).andReturn(null);
  dao.create(entity);
  replay(dao,entity,metaInfo,blueprintFactory,blueprint,request,managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Blueprint,PropertyHelper.getPropertyIds(Resource.Type.Blueprint),PropertyHelper.getKeyPropertyIds(Resource.Type.Blueprint),managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  provider.createResources(request);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  assertNotNull(lastEvent);
  assertEquals(Resource.Type.Blueprint,lastEvent.getResourceType());
  assertEquals(ResourceProviderEvent.Type.Create,lastEvent.getType());
  assertEquals(request,lastEvent.getRequest());
  assertNull(lastEvent.getPredicate());
  verify(dao,entity,blueprintFactory,metaInfo,request,managementController);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigurationEntity_oldSchema() throws Exception {
  Map<String,String> configuration=new HashMap<String,String>();
  configuration.put("global/property1","val1");
  configuration.put("global/property2","val2");
  BlueprintConfiguration config=new BlueprintConfigEntity();
  provider.populateConfigurationEntity(configuration,config);
  assertNotNull(config.getConfigData());
  assertNotNull(config.getConfigAttributes());
  Map<?,?> configData=StageUtils.getGson().fromJson(config.getConfigData(),Map.class);
  Map<?,Map<?,?>> configAttrs=StageUtils.getGson().fromJson(config.getConfigAttributes(),Map.class);
  assertNotNull(configData);
  assertNotNull(configAttrs);
  assertEquals(2,configData.size());
  assertTrue(configData.containsKey("property1"));
  assertTrue(configData.containsKey("property2"));
  assertEquals("val1",configData.get("property1"));
  assertEquals("val2",configData.get("property2"));
  assertEquals(0,configAttrs.size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_configIsEmpty() throws Exception {
  Map<String,String> configMap=new HashMap<String,String>();
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_configIsNull() throws Exception {
  Map<String,String> configMap=null;
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV2);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_withNewSchema_attributes() throws Exception {
  Map<String,String> configMap=new HashMap<String,String>();
  configMap.put("global/properties_attributes/final/foo_contact","true");
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV2);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_withSingleConfigurationType() throws Exception {
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  setConfigurationProperties(setProperties);
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(Request.REQUEST_INFO_BODY_PROPERTY,"{\"configurations\":[{\"configuration-type\":{\"properties\":{\"property\":\"value\"}}}]}");
  Request request=createMock(Request.class);
  expect(blueprintFactory.createBlueprint(setProperties.iterator().next(),null)).andReturn(blueprint).once();
  blueprint.validateRequiredProperties();
  blueprint.validateTopology();
  expect(blueprint.toEntity()).andReturn(entity);
  expect(blueprint.getName()).andReturn(BLUEPRINT_NAME).atLeastOnce();
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  expect(dao.findByName(BLUEPRINT_NAME)).andReturn(null);
  dao.create(entity);
  replay(dao,entity,metaInfo,blueprintFactory,blueprint,request,managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Blueprint,PropertyHelper.getPropertyIds(Resource.Type.Blueprint),PropertyHelper.getKeyPropertyIds(Resource.Type.Blueprint),managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  provider.createResources(request);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  assertNotNull(lastEvent);
  assertEquals(Resource.Type.Blueprint,lastEvent.getResourceType());
  assertEquals(ResourceProviderEvent.Type.Create,lastEvent.getType());
  assertEquals(request,lastEvent.getRequest());
  assertNull(lastEvent.getPredicate());
  verify(dao,entity,blueprintFactory,metaInfo,request,managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigurationList() throws Exception {
  StackEntity stackEntity=new StackEntity();
  stackEntity.setStackName("test-stack-name");
  stackEntity.setStackVersion("test-stack-version");
  BlueprintEntity entity=createMock(BlueprintEntity.class);
  expect(entity.getStack()).andReturn(stackEntity).anyTimes();
  HashMap<PropertyInfo.PropertyType,Set<String>> pwdProperties=new HashMap<PropertyInfo.PropertyType,Set<String>>(){
{
      put(PropertyInfo.PropertyType.PASSWORD,new HashSet<String>(){
{
          add("test.password");
        }
      }
);
    }
  }
;
  StackInfo info=createMock(StackInfo.class);
  expect(info.getConfigPropertiesTypes("type1")).andReturn(new HashMap<PropertyInfo.PropertyType,Set<String>>()).anyTimes();
  expect(info.getConfigPropertiesTypes("type2")).andReturn(new HashMap<PropertyInfo.PropertyType,Set<String>>()).anyTimes();
  expect(info.getConfigPropertiesTypes("type3")).andReturn(pwdProperties).anyTimes();
  expect(metaInfo.getStack("test-stack-name","test-stack-version")).andReturn(info).anyTimes();
  replay(info,metaInfo,entity);
  BlueprintConfigEntity config1=new BlueprintConfigEntity();
  config1.setType("type1");
  config1.setConfigData("{\"key1\":\"value1\"}");
  config1.setBlueprintEntity(entity);
  BlueprintConfigEntity config2=new BlueprintConfigEntity();
  config2.setType("type2");
  config2.setConfigData("{\"key2\":\"value2\"}");
  config2.setConfigAttributes("{}");
  config2.setBlueprintEntity(entity);
  BlueprintConfigEntity config3=new BlueprintConfigEntity();
  config3.setType("type3");
  config3.setConfigData("{\"key3\":\"value3\",\"key4\":\"value4\",\"test.password\":\"pwdValue\"}");
  config3.setConfigAttributes("{\"final\":{\"key3\":\"attrValue1\",\"key4\":\"attrValue2\"}}");
  config3.setBlueprintEntity(entity);
  List<Map<String,Map<String,Object>>> configs=provider.populateConfigurationList(Arrays.asList(config1,config2,config3));
  assertNotNull(configs);
  assertEquals(3,configs.size());
  Map<String,Map<String,Object>> configuration1=configs.get(0);
  assertNotNull(configuration1);
  assertEquals(1,configuration1.size());
  assertTrue(configuration1.containsKey("type1"));
  Map<String,Object> typeConfig1=configuration1.get("type1");
  assertNotNull(typeConfig1);
  assertEquals(1,typeConfig1.size());
  assertTrue(typeConfig1.containsKey(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID));
  Map<String,String> confProperties1=(Map<String,String>)typeConfig1.get(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID);
  assertNotNull(confProperties1);
  assertEquals(1,confProperties1.size());
  assertEquals("value1",confProperties1.get("key1"));
  Map<String,Map<String,Object>> configuration2=configs.get(1);
  assertNotNull(configuration2);
  assertEquals(1,configuration2.size());
  assertTrue(configuration2.containsKey("type2"));
  Map<String,Object> typeConfig2=configuration2.get("type2");
  assertNotNull(typeConfig2);
  assertEquals(1,typeConfig2.size());
  assertTrue(typeConfig2.containsKey(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID));
  Map<String,String> confProperties2=(Map<String,String>)typeConfig2.get(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID);
  assertNotNull(confProperties2);
  assertEquals(1,confProperties2.size());
  assertEquals("value2",confProperties2.get("key2"));
  Map<String,Map<String,Object>> configuration3=configs.get(2);
  assertNotNull(configuration3);
  assertEquals(1,configuration3.size());
  assertTrue(configuration3.containsKey("type3"));
  Map<String,Object> typeConfig3=configuration3.get("type3");
  assertNotNull(typeConfig3);
  assertEquals(2,typeConfig3.size());
  assertTrue(typeConfig3.containsKey(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID));
  Map<String,String> confProperties3=(Map<String,String>)typeConfig3.get(BlueprintResourceProvider.PROPERTIES_PROPERTY_ID);
  assertNotNull(confProperties3);
  assertEquals(3,confProperties3.size());
  assertEquals("value3",confProperties3.get("key3"));
  assertEquals("value4",confProperties3.get("key4"));
  assertEquals("SECRET:type3:-1:test.password",confProperties3.get("test.password"));
  assertTrue(typeConfig3.containsKey(BlueprintResourceProvider.PROPERTIES_ATTRIBUTES_PROPERTY_ID));
  Map<String,Map<String,String>> confAttributes3=(Map<String,Map<String,String>>)typeConfig3.get(BlueprintResourceProvider.PROPERTIES_ATTRIBUTES_PROPERTY_ID);
  assertNotNull(confAttributes3);
  assertEquals(1,confAttributes3.size());
  assertTrue(confAttributes3.containsKey("final"));
  Map<String,String> finalAttrs=confAttributes3.get("final");
  assertEquals(2,finalAttrs.size());
  assertEquals("attrValue1",finalAttrs.get("key3"));
  assertEquals("attrValue2",finalAttrs.get("key4"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_withSecurityConfiguration() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Request request=createMock(Request.class);
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  Map<String,String> requestInfoProperties=getTestRequestInfoProperties();
  SecurityConfiguration securityConfiguration=new SecurityConfiguration(SecurityType.KERBEROS,"testRef",null);
  expect(securityFactory.createSecurityConfigurationFromRequest(anyObject(HashMap.class),anyBoolean())).andReturn(securityConfiguration).once();
  expect(blueprintFactory.createBlueprint(setProperties.iterator().next(),securityConfiguration)).andReturn(blueprint).once();
  blueprint.validateRequiredProperties();
  blueprint.validateTopology();
  expect(blueprint.toEntity()).andReturn(entity);
  expect(blueprint.getName()).andReturn(BLUEPRINT_NAME).atLeastOnce();
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  expect(dao.findByName(BLUEPRINT_NAME)).andReturn(null);
  dao.create(entity);
  replay(dao,entity,metaInfo,blueprintFactory,securityFactory,blueprint,request,managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Blueprint,PropertyHelper.getPropertyIds(Resource.Type.Blueprint),PropertyHelper.getKeyPropertyIds(Resource.Type.Blueprint),managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  provider.createResources(request);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  assertNotNull(lastEvent);
  assertEquals(Resource.Type.Blueprint,lastEvent.getResourceType());
  assertEquals(ResourceProviderEvent.Type.Create,lastEvent.getType());
  assertEquals(request,lastEvent.getRequest());
  assertNull(lastEvent.getPredicate());
  verify(dao,entity,blueprintFactory,metaInfo,request,managementController);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_NoValidation() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Request request=createMock(Request.class);
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  Map<String,String> requestInfoProperties=getTestRequestInfoProperties();
  requestInfoProperties.put("validate_topology","false");
  expect(blueprintFactory.createBlueprint(setProperties.iterator().next(),null)).andReturn(blueprint).once();
  blueprint.validateRequiredProperties();
  expect(blueprint.toEntity()).andReturn(entity);
  expect(blueprint.getName()).andReturn(BLUEPRINT_NAME).atLeastOnce();
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  expect(dao.findByName(BLUEPRINT_NAME)).andReturn(null);
  dao.create(entity);
  replay(dao,entity,metaInfo,blueprintFactory,blueprint,request,managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Blueprint,PropertyHelper.getPropertyIds(Resource.Type.Blueprint),PropertyHelper.getKeyPropertyIds(Resource.Type.Blueprint),managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  provider.createResources(request);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  assertNotNull(lastEvent);
  assertEquals(Resource.Type.Blueprint,lastEvent.getResourceType());
  assertEquals(ResourceProviderEvent.Type.Create,lastEvent.getType());
  assertEquals(request,lastEvent.getRequest());
  assertNull(lastEvent.getPredicate());
  verify(dao,entity,blueprintFactory,metaInfo,request,managementController);
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testPopulateConfigurationEntity_configIsEmpty() throws Exception {
  Map<String,String> configuration=new HashMap<String,String>();
  BlueprintConfiguration config=new BlueprintConfigEntity();
  provider.populateConfigurationEntity(configuration,config);
  assertNotNull(config.getConfigAttributes());
  assertNotNull(config.getConfigData());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateConfigurationEntity_newSchema() throws Exception {
  Map<String,String> configuration=new HashMap<String,String>();
  configuration.put("global/properties/property1","val1");
  configuration.put("global/properties/property2","val2");
  configuration.put("global/properties_attributes/final/property1","true");
  configuration.put("global/properties_attributes/final/property2","false");
  configuration.put("global/properties_attributes/deletable/property1","true");
  BlueprintConfiguration config=new BlueprintConfigEntity();
  provider.populateConfigurationEntity(configuration,config);
  assertNotNull(config.getConfigData());
  assertNotNull(config.getConfigAttributes());
  Map<?,?> configData=StageUtils.getGson().fromJson(config.getConfigData(),Map.class);
  Map<?,Map<?,?>> configAttrs=StageUtils.getGson().fromJson(config.getConfigAttributes(),Map.class);
  assertNotNull(configData);
  assertNotNull(configAttrs);
  assertEquals(2,configData.size());
  assertTrue(configData.containsKey("property1"));
  assertTrue(configData.containsKey("property2"));
  assertEquals("val1",configData.get("property1"));
  assertEquals("val2",configData.get("property2"));
  assertEquals(2,configAttrs.size());
  assertTrue(configAttrs.containsKey("final"));
  assertTrue(configAttrs.containsKey("deletable"));
  Map<?,?> finalAttrs=configAttrs.get("final");
  assertNotNull(finalAttrs);
  assertEquals(2,finalAttrs.size());
  assertTrue(finalAttrs.containsKey("property1"));
  assertTrue(finalAttrs.containsKey("property2"));
  assertEquals("true",finalAttrs.get("property1"));
  assertEquals("false",finalAttrs.get("property2"));
  Map<?,?> deletableAttrs=configAttrs.get("deletable");
  assertNotNull(deletableAttrs);
  assertEquals(1,deletableAttrs.size());
  assertTrue(deletableAttrs.containsKey("property1"));
  assertEquals("true",deletableAttrs.get("property1"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Request request=createMock(Request.class);
  Set<Map<String,Object>> setProperties=getBlueprintTestProperties();
  Map<String,String> requestInfoProperties=getTestRequestInfoProperties();
  expect(blueprintFactory.createBlueprint(setProperties.iterator().next(),null)).andReturn(blueprint).once();
  expect(securityFactory.createSecurityConfigurationFromRequest(null,true)).andReturn(null).anyTimes();
  blueprint.validateRequiredProperties();
  blueprint.validateTopology();
  expect(blueprint.toEntity()).andReturn(entity);
  expect(blueprint.getName()).andReturn(BLUEPRINT_NAME).atLeastOnce();
  expect(request.getProperties()).andReturn(setProperties);
  expect(request.getRequestInfoProperties()).andReturn(requestInfoProperties);
  expect(dao.findByName(BLUEPRINT_NAME)).andReturn(null);
  dao.create(entity);
  replay(dao,entity,metaInfo,blueprintFactory,securityFactory,blueprint,request,managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(Resource.Type.Blueprint,PropertyHelper.getPropertyIds(Resource.Type.Blueprint),PropertyHelper.getKeyPropertyIds(Resource.Type.Blueprint),managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  provider.createResources(request);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  assertNotNull(lastEvent);
  assertEquals(Resource.Type.Blueprint,lastEvent.getResourceType());
  assertEquals(ResourceProviderEvent.Type.Create,lastEvent.getType());
  assertEquals(request,lastEvent.getRequest());
  assertNull(lastEvent.getPredicate());
  verify(dao,entity,blueprintFactory,securityFactory,metaInfo,request,managementController);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResources() throws SystemException, UnsupportedPropertyException, NoSuchParentResourceException, NoSuchResourceException {
  BlueprintEntity blueprintEntity=createEntity(getBlueprintTestProperties().iterator().next());
  expect(dao.findByName(BLUEPRINT_NAME)).andReturn(blueprintEntity);
  dao.removeByName(blueprintEntity.getBlueprintName());
  expectLastCall();
  replay(dao);
  Predicate predicate=new EqualsPredicate<String>(BlueprintResourceProvider.BLUEPRINT_NAME_PROPERTY_ID,BLUEPRINT_NAME);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  provider.addObserver(observer);
  provider.deleteResources(predicate);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  assertNotNull(lastEvent);
  assertEquals(Resource.Type.Blueprint,lastEvent.getResourceType());
  assertEquals(ResourceProviderEvent.Type.Delete,lastEvent.getType());
  assertNotNull(lastEvent.getPredicate());
  verify(dao);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecidePopulationStrategy_withNewSchema_properties() throws Exception {
  Map<String,String> configMap=new HashMap<String,String>();
  configMap.put("global/properties/foo_contact","foo@ffl.dsfds");
  BlueprintConfigPopulationStrategy provisioner=provider.decidePopulationStrategy(configMap);
  assertNotNull(provisioner);
  assertTrue(provisioner instanceof BlueprintConfigPopulationStrategyV2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.CalculatedStatusTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStatusFromStages() throws Exception {
  Collection<Stage> stages;
  CalculatedStatus status;
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.COMPLETED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.IN_PROGRESS,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.IN_PROGRESS,status.getStatus());
  assertEquals(48.3,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.PENDING,status.getStatus());
  assertEquals(0.0,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.FAILED,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.FAILED,status.getStatus());
  assertEquals(55.55,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.TIMEDOUT),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.TIMEDOUT,status.getStatus());
  assertEquals(66.66,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(47.5,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(47.5,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertNull(status.getDisplayStatus());
  assertEquals(47.5,status.getPercent(),0.1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClusterControllerImplTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesPageToOffset() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  PageRequest pageRequest=new PageRequestImpl(PageRequest.StartingPoint.OffsetEnd,2,2,null,null);
  PageResponse pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Assert.assertEquals(1,pageResponse.getOffset());
  Assert.assertEquals("host:0",pageResponse.getPreviousResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals("host:3",pageResponse.getNextResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
  Iterable<Resource> iterable=pageResponse.getIterable();
  List<Resource> list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(2,list.size());
  Assert.assertEquals("host:1",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:2",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  pageRequest=new PageRequestImpl(PageRequest.StartingPoint.OffsetEnd,3,2,null,null);
  pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Assert.assertEquals(0,pageResponse.getOffset());
  Assert.assertNull(pageResponse.getPreviousResource());
  Assert.assertEquals("host:3",pageResponse.getNextResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  iterable=pageResponse.getIterable();
  list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(3,list.size());
  Assert.assertEquals("host:0",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:1",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals("host:2",(String)list.get(2).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(2).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
}

</code></pre>

<br>
<pre class="type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResources() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  TestHostResourceProvider resourceProvider=(TestHostResourceProvider)providerModule.getResourceProvider(Resource.Type.Host);
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Predicate predicate=new PredicateBuilder().property("c1/p2").equals(1).toPredicate();
  controller.deleteResources(Resource.Type.Host,predicate);
  Assert.assertEquals(TestHostResourceProvider.Action.Delete,resourceProvider.getLastAction());
  Assert.assertNull(resourceProvider.getLastRequest());
  Assert.assertSame(predicate,resourceProvider.getLastPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResourcesResolvePredicate() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  TestHostResourceProvider resourceProvider=(TestHostResourceProvider)providerModule.getResourceProvider(Resource.Type.Host);
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Predicate predicate=new PredicateBuilder().property("c3/p6").equals(1).toPredicate();
  controller.deleteResources(Resource.Type.Host,predicate);
  Assert.assertEquals(TestHostResourceProvider.Action.Delete,resourceProvider.getLastAction());
  Assert.assertNull(resourceProvider.getLastRequest());
  Predicate lastPredicate=resourceProvider.getLastPredicate();
  Assert.assertFalse(predicate.equals(lastPredicate));
  Set<String> predicatePropertyIds=PredicateHelper.getPropertyIds(lastPredicate);
  Collection<String> keyPropertyIds=resourceProvider.getKeyPropertyIds().values();
  Assert.assertEquals(predicatePropertyIds.size(),keyPropertyIds.size());
  Assert.assertTrue(keyPropertyIds.containsAll(predicatePropertyIds));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources() throws Exception {
  TestProviderModule providerModule=new TestProviderModule();
  TestHostResourceProvider resourceProvider=(TestHostResourceProvider)providerModule.getResourceProvider(Resource.Type.Host);
  ClusterController controller=new ClusterControllerImpl(providerModule);
  Set<Map<String,Object>> properties=new HashSet<Map<String,Object>>();
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(PropertyHelper.getPropertyId("c1","p1"),99);
  propertyMap.put(PropertyHelper.getPropertyId("c1","p2"),2);
  properties.add(propertyMap);
  Request request=PropertyHelper.getCreateRequest(properties,null);
  controller.createResources(Resource.Type.Host,request);
  Assert.assertEquals(TestHostResourceProvider.Action.Create,resourceProvider.getLastAction());
  Assert.assertSame(request,resourceProvider.getLastRequest());
  Assert.assertNull(resourceProvider.getLastPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesPageFromOffset() throws Exception {
  ClusterControllerImpl controller=new ClusterControllerImpl(new TestProviderModule());
  Set<String> propertyIds=new HashSet<String>();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  PageRequest pageRequest=new PageRequestImpl(PageRequest.StartingPoint.OffsetStart,2,1,null,null);
  PageResponse pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Assert.assertEquals(1,pageResponse.getOffset());
  Assert.assertEquals("host:0",pageResponse.getPreviousResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals("host:3",pageResponse.getNextResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Iterable<Resource> iterable=pageResponse.getIterable();
  List<Resource> list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(2,list.size());
  Assert.assertEquals("host:1",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:2",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
  pageRequest=new PageRequestImpl(PageRequest.StartingPoint.OffsetStart,3,0,null,null);
  pageResponse=controller.getResources(Resource.Type.Host,request,null,pageRequest,null);
  Assert.assertEquals(0,pageResponse.getOffset());
  Assert.assertNull(pageResponse.getPreviousResource());
  Assert.assertEquals("host:3",pageResponse.getNextResource().getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  iterable=pageResponse.getIterable();
  list=new LinkedList<Resource>();
  for (  Resource resource : iterable) {
    list.add(resource);
  }
  Assert.assertEquals(3,list.size());
  Assert.assertEquals("host:0",(String)list.get(0).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(0).getType());
  Assert.assertEquals("host:1",(String)list.get(1).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(1).getType());
  Assert.assertEquals("host:2",(String)list.get(2).getPropertyValue(PropertyHelper.getPropertyId("Hosts","host_name")));
  Assert.assertEquals(Resource.Type.Host,list.get(2).getType());
  Assert.assertEquals(4,pageResponse.getTotalResourceCount().intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClusterResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResourcesWithRetry() throws Exception {
  RetryHelper.init(3);
  Resource.Type type=Resource.Type.Cluster;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  managementController.createCluster(AbstractResourceProviderTest.Matcher.getClusterRequest(null,"Cluster100","HDP-0.1",null));
  expectLastCall().andThrow(new DatabaseException("test"){
  }
).once().andVoid().atLeastOnce();
  replay(managementController,response);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(ClusterResourceProvider.CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(ClusterResourceProvider.CLUSTER_VERSION_PROPERTY_ID,"HDP-0.1");
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  provider.createResources(request);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  Assert.assertNotNull(lastEvent);
  Assert.assertEquals(Resource.Type.Cluster,lastEvent.getResourceType());
  Assert.assertEquals(ResourceProviderEvent.Type.Create,lastEvent.getType());
  Assert.assertEquals(request,lastEvent.getRequest());
  Assert.assertNull(lastEvent.getPredicate());
  verify(managementController,response);
  RetryHelper.init(0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ClusterStackVersionResourceProviderTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests manual finalization scenario
 * @throws Exception
 */
@Test public void testUpdateResourcesWithForce() throws Exception {
  Resource.Type type=Resource.Type.ClusterStackVersion;
  String clusterName="Cluster100";
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  StackId stackId=new StackId("HDP","2.0.1");
  StackEntity stackEntity=stackDAO.find(stackId.getStackName(),stackId.getStackVersion());
  Assert.assertNotNull(stackEntity);
  ResourceTypeEntity resourceTypeEntity=resourceTypeDAO.findById(ResourceType.CLUSTER.getId());
  if (resourceTypeEntity == null) {
    resourceTypeEntity=new ResourceTypeEntity();
    resourceTypeEntity.setId(ResourceType.CLUSTER.getId());
    resourceTypeEntity.setName(ResourceType.CLUSTER.name());
    resourceTypeEntity=resourceTypeDAO.merge(resourceTypeEntity);
  }
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setResourceType(resourceTypeEntity);
  final Host host1=createNiceMock("host1",Host.class);
  final Host host2=createNiceMock("host2",Host.class);
  expect(host1.getHostName()).andReturn("host1").anyTimes();
  expect(host2.getHostName()).andReturn("host2").anyTimes();
  replay(host1,host2);
  ServiceComponentHost sch=createMock(ServiceComponentHost.class);
  List<ServiceComponentHost> schs=Collections.singletonList(sch);
  Cluster cluster=createNiceMock(Cluster.class);
  cluster.setClusterName(clusterName);
  ArrayList<Host> hosts=new ArrayList<Host>(){
{
      add(host1);
      add(host2);
    }
  }
;
  Clusters clusters=createNiceMock(Clusters.class);
  expect(clusters.getCluster(anyObject(String.class))).andReturn(cluster);
  RepositoryVersionEntity repoVersion=new RepositoryVersionEntity();
  repoVersion.setOperatingSystems(operatingSystemsJson);
  StackEntity newDesiredStack=stackDAO.find("HDP","2.0.1");
  repoVersion.setStack(newDesiredStack);
  final ServiceOsSpecific.Package hivePackage=new ServiceOsSpecific.Package();
  hivePackage.setName("hive");
  final ServiceOsSpecific.Package mysqlPackage=new ServiceOsSpecific.Package();
  mysqlPackage.setName("mysql");
  mysqlPackage.setSkipUpgrade(Boolean.TRUE);
  List<ServiceOsSpecific.Package> packages=new ArrayList<ServiceOsSpecific.Package>(){
{
      add(hivePackage);
      add(mysqlPackage);
    }
  }
;
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  ResourceProviderFactory resourceProviderFactory=createNiceMock(ResourceProviderFactory.class);
  ResourceProvider csvResourceProvider=createNiceMock(ClusterStackVersionResourceProvider.class);
  AbstractControllerResourceProvider.init(resourceProviderFactory);
  Map<String,Map<String,String>> hostConfigTags=new HashMap<String,Map<String,String>>();
  expect(configHelper.getEffectiveDesiredTags(anyObject(ClusterImpl.class),anyObject(String.class))).andReturn(hostConfigTags);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(managementController.getJdkResourceUrl()).andReturn("/JdkResourceUrl").anyTimes();
  expect(managementController.getPackagesForServiceHost(anyObject(ServiceInfo.class),(Map<String,String>)anyObject(List.class),anyObject(String.class))).andReturn(packages).anyTimes();
  expect(resourceProviderFactory.getHostResourceProvider(anyObject(Set.class),anyObject(Map.class),eq(managementController))).andReturn(csvResourceProvider).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(stackId);
  expect(cluster.getServiceComponentHosts(anyObject(String.class))).andReturn(schs).anyTimes();
  RepositoryVersionEntity currentRepo=new RepositoryVersionEntity();
  currentRepo.setVersion("2.2.2.0-2122");
  ClusterVersionEntity current=new ClusterVersionEntity();
  current.setRepositoryVersion(currentRepo);
  Capture<StackId> capturedStackId=new Capture<StackId>();
  cluster.setDesiredStackVersion(capture(capturedStackId));
  expectLastCall().once();
  expect(cluster.getHosts()).andReturn(hosts).anyTimes();
  expect(cluster.getCurrentClusterVersion()).andReturn(current).anyTimes();
  expect(sch.getServiceName()).andReturn("HIVE").anyTimes();
  expect(repositoryVersionDAOMock.findByDisplayName(anyObject(String.class))).andReturn(repoVersion);
  clusterVersionDAO.updateVersions((Long)anyObject(),(RepositoryVersionEntity)anyObject(),(RepositoryVersionEntity)anyObject());
  expectLastCall().once();
  hostVersionDAO.updateVersions((RepositoryVersionEntity)anyObject(),(RepositoryVersionEntity)anyObject());
  expectLastCall().once();
  hostComponentStateDAO.updateVersions((String)anyObject());
  expectLastCall().once();
  replay(managementController,response,clusters,resourceProviderFactory,csvResourceProvider,cluster,repositoryVersionDAOMock,configHelper,sch,actionManager,clusterVersionDAO,hostVersionDAO,hostComponentStateDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  injector.injectMembers(provider);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_CLUSTER_NAME_PROPERTY_ID,clusterName);
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_STATE_PROPERTY_ID,"CURRENT");
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_REPOSITORY_VERSION_PROPERTY_ID,"HDP-2.2.2.0-2561");
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_FORCE,"true");
  Request request=PropertyHelper.getUpdateRequest(properties,null);
  provider.updateResources(request,null);
  verify(managementController,response,clusterVersionDAO,hostVersionDAO,hostComponentStateDAO);
  Assert.assertEquals(capturedStackId.getValue(),new StackId(newDesiredStack.getStackName(),newDesiredStack.getStackVersion()));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests manual finalization scenario
 * @throws Exception
 */
@Test public void testUpdateResources() throws Exception {
  Resource.Type type=Resource.Type.ClusterStackVersion;
  String clusterName="Cluster100";
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  StackId stackId=new StackId("HDP","2.0.1");
  StackEntity stackEntity=stackDAO.find(stackId.getStackName(),stackId.getStackVersion());
  Assert.assertNotNull(stackEntity);
  ResourceTypeEntity resourceTypeEntity=resourceTypeDAO.findById(ResourceType.CLUSTER.getId());
  if (resourceTypeEntity == null) {
    resourceTypeEntity=new ResourceTypeEntity();
    resourceTypeEntity.setId(ResourceType.CLUSTER.getId());
    resourceTypeEntity.setName(ResourceType.CLUSTER.name());
    resourceTypeEntity=resourceTypeDAO.merge(resourceTypeEntity);
  }
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setResourceType(resourceTypeEntity);
  final Host host1=createNiceMock("host1",Host.class);
  final Host host2=createNiceMock("host2",Host.class);
  expect(host1.getHostName()).andReturn("host1").anyTimes();
  expect(host2.getHostName()).andReturn("host2").anyTimes();
  replay(host1,host2);
  ServiceComponentHost sch=createMock(ServiceComponentHost.class);
  List<ServiceComponentHost> schs=Collections.singletonList(sch);
  Cluster cluster=createNiceMock(Cluster.class);
  cluster.setClusterName(clusterName);
  ArrayList<Host> hosts=new ArrayList<Host>(){
{
      add(host1);
      add(host2);
    }
  }
;
  Clusters clusters=createNiceMock(Clusters.class);
  expect(clusters.getCluster(anyObject(String.class))).andReturn(cluster);
  RepositoryVersionEntity repoVersion=new RepositoryVersionEntity();
  repoVersion.setOperatingSystems(operatingSystemsJson);
  StackEntity newDesiredStack=stackDAO.find("HDP","2.0.1");
  repoVersion.setStack(newDesiredStack);
  final ServiceOsSpecific.Package hivePackage=new ServiceOsSpecific.Package();
  hivePackage.setName("hive");
  final ServiceOsSpecific.Package mysqlPackage=new ServiceOsSpecific.Package();
  mysqlPackage.setName("mysql");
  mysqlPackage.setSkipUpgrade(Boolean.TRUE);
  List<ServiceOsSpecific.Package> packages=new ArrayList<ServiceOsSpecific.Package>(){
{
      add(hivePackage);
      add(mysqlPackage);
    }
  }
;
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  ResourceProviderFactory resourceProviderFactory=createNiceMock(ResourceProviderFactory.class);
  ResourceProvider csvResourceProvider=createNiceMock(ClusterStackVersionResourceProvider.class);
  CommandReport report=createNiceMock(CommandReport.class);
  FinalizeUpgradeAction finalizeUpgradeAction=createNiceMock(FinalizeUpgradeAction.class);
  AbstractControllerResourceProvider.init(resourceProviderFactory);
  Map<String,Map<String,String>> hostConfigTags=new HashMap<String,Map<String,String>>();
  expect(configHelper.getEffectiveDesiredTags(anyObject(ClusterImpl.class),anyObject(String.class))).andReturn(hostConfigTags);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(managementController.getJdkResourceUrl()).andReturn("/JdkResourceUrl").anyTimes();
  expect(managementController.getPackagesForServiceHost(anyObject(ServiceInfo.class),(Map<String,String>)anyObject(List.class),anyObject(String.class))).andReturn(packages).anyTimes();
  expect(resourceProviderFactory.getHostResourceProvider(anyObject(Set.class),anyObject(Map.class),eq(managementController))).andReturn(csvResourceProvider).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(stackId);
  expect(cluster.getServiceComponentHosts(anyObject(String.class))).andReturn(schs).anyTimes();
  Capture<StackId> capturedStackId=new Capture<StackId>();
  cluster.setDesiredStackVersion(capture(capturedStackId));
  expectLastCall().once();
  expect(cluster.getHosts()).andReturn(hosts).anyTimes();
  expect(sch.getServiceName()).andReturn("HIVE").anyTimes();
  expect(repositoryVersionDAOMock.findByDisplayName(anyObject(String.class))).andReturn(repoVersion);
  expect(actionManager.getRequestTasks(anyLong())).andReturn(Collections.<HostRoleCommand>emptyList()).anyTimes();
  expect(finalizeUpgradeAction.execute(null)).andReturn(report);
  expect(report.getStdOut()).andReturn("Dummy stdout");
  expect(report.getStdErr()).andReturn("Dummy stderr");
  expect(report.getStatus()).andReturn("COMPLETED");
  replay(managementController,response,clusters,resourceProviderFactory,csvResourceProvider,cluster,repositoryVersionDAOMock,configHelper,sch,actionManager,finalizeUpgradeAction,report,stageFactory);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  injector.injectMembers(provider);
  Field field=ClusterStackVersionResourceProvider.class.getDeclaredField("finalizeUpgradeAction");
  field.setAccessible(true);
  field.set(provider,finalizeUpgradeAction);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_CLUSTER_NAME_PROPERTY_ID,clusterName);
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_STATE_PROPERTY_ID,"CURRENT");
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_REPOSITORY_VERSION_PROPERTY_ID,"HDP-2.2.2.0-2561");
  Request request=PropertyHelper.getUpdateRequest(properties,null);
  provider.updateResources(request,null);
  verify(managementController,response);
  Assert.assertEquals(capturedStackId.getValue(),new StackId(newDesiredStack.getStackName(),newDesiredStack.getStackVersion()));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources() throws Exception {
  Resource.Type type=Resource.Type.ClusterStackVersion;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  StackId stackId=new StackId("HDP","2.0.1");
  Map<String,Host> hostsForCluster=new HashMap<String,Host>();
  int hostCount=10;
  for (int i=0; i < hostCount; i++) {
    String hostname="host" + i;
    Host host=createNiceMock(hostname,Host.class);
    expect(host.getHostName()).andReturn(hostname).anyTimes();
    expect(host.getOsFamily()).andReturn("redhat6").anyTimes();
    expect(host.getMaintenanceState(EasyMock.anyLong())).andReturn(MaintenanceState.OFF).anyTimes();
    replay(host);
    hostsForCluster.put(hostname,host);
  }
  final ServiceComponentHost schDatanode=createMock(ServiceComponentHost.class);
  expect(schDatanode.getServiceName()).andReturn("HDFS").anyTimes();
  expect(schDatanode.getServiceComponentName()).andReturn("DATANODE").anyTimes();
  final ServiceComponentHost schNamenode=createMock(ServiceComponentHost.class);
  expect(schNamenode.getServiceName()).andReturn("HDFS").anyTimes();
  expect(schNamenode.getServiceComponentName()).andReturn("NAMENODE").anyTimes();
  final ServiceComponentHost schAMS=createMock(ServiceComponentHost.class);
  expect(schAMS.getServiceName()).andReturn("AMBARI_METRICS").anyTimes();
  expect(schAMS.getServiceComponentName()).andReturn("METRICS_COLLECTOR").anyTimes();
  final List<ServiceComponentHost> schsH1=new ArrayList<ServiceComponentHost>(){
{
      add(schDatanode);
      add(schNamenode);
      add(schAMS);
    }
  }
;
  final List<ServiceComponentHost> schsH2=new ArrayList<ServiceComponentHost>(){
{
      add(schAMS);
    }
  }
;
  RepositoryVersionEntity repoVersion=new RepositoryVersionEntity();
  repoVersion.setId(1l);
  repoVersion.setOperatingSystems(operatingSystemsJson);
  ServiceOsSpecific.Package hdfsPackage=new ServiceOsSpecific.Package();
  hdfsPackage.setName("hdfs");
  List<ServiceOsSpecific.Package> packages=Collections.singletonList(hdfsPackage);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  ResourceProviderFactory resourceProviderFactory=createNiceMock(ResourceProviderFactory.class);
  ResourceProvider csvResourceProvider=createNiceMock(ClusterStackVersionResourceProvider.class);
  AbstractControllerResourceProvider.init(resourceProviderFactory);
  Map<String,Map<String,String>> hostConfigTags=new HashMap<String,Map<String,String>>();
  expect(configHelper.getEffectiveDesiredTags(anyObject(ClusterImpl.class),anyObject(String.class))).andReturn(hostConfigTags);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAmbariMetaInfo()).andReturn(ambariMetaInfo).anyTimes();
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(managementController.getJdkResourceUrl()).andReturn("/JdkResourceUrl").anyTimes();
  expect(managementController.getPackagesForServiceHost(anyObject(ServiceInfo.class),(Map<String,String>)anyObject(List.class),anyObject(String.class))).andReturn(packages).times((hostCount - 1) * 2);
  expect(resourceProviderFactory.getHostResourceProvider(anyObject(Set.class),anyObject(Map.class),eq(managementController))).andReturn(csvResourceProvider).anyTimes();
  expect(clusters.getCluster(anyObject(String.class))).andReturn(cluster);
  expect(clusters.getHostsForCluster(anyObject(String.class))).andReturn(hostsForCluster).anyTimes();
  String clusterName="Cluster100";
  expect(cluster.getClusterId()).andReturn(1L).anyTimes();
  expect(cluster.getHosts()).andReturn(hostsForCluster.values()).atLeastOnce();
  expect(cluster.getServices()).andReturn(new HashMap<String,Service>()).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(stackId);
  expect(cluster.getServiceComponentHosts(anyObject(String.class))).andAnswer(new IAnswer<List<ServiceComponentHost>>(){
    @Override public List<ServiceComponentHost> answer() throws Throwable {
      String hostname=(String)EasyMock.getCurrentArguments()[0];
      if (hostname.equals("host2")) {
        return schsH2;
      }
 else {
        return schsH1;
      }
    }
  }
).anyTimes();
  ExecutionCommand executionCommand=createNiceMock(ExecutionCommand.class);
  ExecutionCommandWrapper executionCommandWrapper=createNiceMock(ExecutionCommandWrapper.class);
  expect(executionCommandWrapper.getExecutionCommand()).andReturn(executionCommand).anyTimes();
  Stage stage=createNiceMock(Stage.class);
  expect(stage.getExecutionCommandWrapper(anyObject(String.class),anyObject(String.class))).andReturn(executionCommandWrapper).anyTimes();
  Map<Role,Float> successFactors=new HashMap<>();
  expect(stage.getSuccessFactors()).andReturn(successFactors).atLeastOnce();
  expect(stageFactory.createNew(anyLong(),anyObject(String.class),anyObject(String.class),anyLong(),anyObject(String.class),anyObject(String.class),anyObject(String.class),anyObject(String.class))).andReturn(stage).times((int)Math.ceil(hostCount / MAX_TASKS_PER_STAGE));
  expect(repositoryVersionDAOMock.findByStackAndVersion(anyObject(StackId.class),anyObject(String.class))).andReturn(repoVersion);
  expect(actionManager.getRequestTasks(anyLong())).andReturn(Collections.<HostRoleCommand>emptyList()).anyTimes();
  ClusterEntity clusterEntity=new ClusterEntity();
  clusterEntity.setClusterId(1l);
  clusterEntity.setClusterName(clusterName);
  ClusterVersionEntity cve=new ClusterVersionEntity(clusterEntity,repoVersion,RepositoryVersionState.INSTALL_FAILED,0,"");
  expect(clusterVersionDAO.findByClusterAndStackAndVersion(anyObject(String.class),anyObject(StackId.class),anyObject(String.class))).andReturn(cve);
  TopologyManager topologyManager=injector.getInstance(TopologyManager.class);
  StageUtils.setTopologyManager(topologyManager);
  replay(managementController,response,clusters,resourceProviderFactory,csvResourceProvider,cluster,repositoryVersionDAOMock,configHelper,schDatanode,schNamenode,schAMS,actionManager,executionCommand,executionCommandWrapper,stage,stageFactory,clusterVersionDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  injector.injectMembers(provider);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_REPOSITORY_VERSION_PROPERTY_ID,"2.2.0.1-885");
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_STACK_PROPERTY_ID,"HDP");
  properties.put(ClusterStackVersionResourceProvider.CLUSTER_STACK_VERSION_VERSION_PROPERTY_ID,"2.1.1");
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  RequestStatus status=provider.createResources(request);
  Assert.assertNotNull(status);
  verify(managementController,response,clusters,stageFactory,stage);
  Float successFactor=successFactors.get(Role.INSTALL_PACKAGES);
  Assert.assertEquals(Float.valueOf(0.85f),successFactor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ConfigGroupResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetConfigGroupRequest_populatesConfigAttributes() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ConfigGroupResourceProvider resourceProvider=getConfigGroupResourceProvider(managementController);
  Set<Map<String,String>> desiredConfigProperties=new HashSet<Map<String,String>>();
  Map<String,String> desiredConfig1=new HashMap<String,String>();
  desiredConfig1.put("tag","version2");
  desiredConfig1.put("type","type1");
  desiredConfig1.put("properties/key1","value1");
  desiredConfig1.put("properties/key2","value2");
  desiredConfig1.put("properties_attributes/attr1/key1","true");
  desiredConfig1.put("properties_attributes/attr1/key2","false");
  desiredConfig1.put("properties_attributes/attr2/key1","15");
  desiredConfigProperties.add(desiredConfig1);
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("ConfigGroup/hosts",new HashMap<String,String>(){
{
      put("host_name","ambari1");
    }
  }
);
  properties.put("ConfigGroup/cluster_name","c");
  properties.put("ConfigGroup/desired_configs",desiredConfigProperties);
  ConfigGroupRequest request=resourceProvider.getConfigGroupRequest(properties);
  assertNotNull(request);
  Map<String,Config> configMap=request.getConfigs();
  assertNotNull(configMap);
  assertEquals(1,configMap.size());
  assertTrue(configMap.containsKey("type1"));
  Config config=configMap.get("type1");
  assertEquals("type1",config.getType());
  Map<String,String> configProperties=config.getProperties();
  assertNotNull(configProperties);
  assertEquals(2,configProperties.size());
  assertEquals("value1",configProperties.get("key1"));
  assertEquals("value2",configProperties.get("key2"));
  Map<String,Map<String,String>> configAttributes=config.getPropertiesAttributes();
  assertNotNull(configAttributes);
  assertEquals(2,configAttributes.size());
  assertTrue(configAttributes.containsKey("attr1"));
  Map<String,String> attr1=configAttributes.get("attr1");
  assertNotNull(attr1);
  assertEquals(2,attr1.size());
  assertEquals("true",attr1.get("key1"));
  assertEquals("false",attr1.get("key2"));
  assertTrue(configAttributes.containsKey("attr2"));
  Map<String,String> attr2=configAttributes.get("attr2");
  assertNotNull(attr2);
  assertEquals(1,attr2.size());
  assertEquals("15",attr2.get("key1"));
}

</code></pre>

<br>
<pre class="type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateNameConfigGroup() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  ConfigGroupFactory configGroupFactory=createNiceMock(ConfigGroupFactory.class);
  ConfigGroup configGroup=createNiceMock(ConfigGroup.class);
  Map<Long,ConfigGroup> configGroupMap=new HashMap<Long,ConfigGroup>();
  configGroupMap.put(1L,configGroup);
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(managementController.getConfigGroupFactory()).andReturn(configGroupFactory).anyTimes();
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(cluster.getConfigGroups()).andReturn(configGroupMap);
  expect(configGroupFactory.createNew((Cluster)anyObject(),(String)anyObject(),(String)anyObject(),(String)anyObject(),(HashMap)anyObject(),(HashMap)anyObject())).andReturn(configGroup).anyTimes();
  expect(configGroup.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(configGroup.getName()).andReturn("test-1").anyTimes();
  expect(configGroup.getTag()).andReturn("tag-1").anyTimes();
  replay(managementController,clusters,cluster,configGroupFactory,configGroup,response);
  ResourceProvider provider=getConfigGroupResourceProvider(managementController);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_NAME_PROPERTY_ID,"test-1");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID,"tag-1");
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  Exception exception=null;
  try {
    provider.createResources(request);
  }
 catch (  Exception e) {
    exception=e;
  }
  verify(managementController,clusters,cluster,configGroupFactory,configGroup,response);
  assertNotNull(exception);
  assertTrue(exception instanceof ResourceAlreadyExistsException);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testGetConfigGroup() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Host h1=createNiceMock(Host.class);
  final Long host1Id=1L;
  List<Long> hostIds=new ArrayList<Long>(){
{
      add(host1Id);
    }
  }
;
  List<String> hostNames=new ArrayList<String>(){
{
      add("h1");
    }
  }
;
  HostEntity hostEntity1=createMock(HostEntity.class);
  expect(hostDAO.getHostNamesByHostIds(hostIds)).andReturn(hostNames).atLeastOnce();
  expect(hostDAO.findByName("h1")).andReturn(hostEntity1).anyTimes();
  expect(hostEntity1.getHostId()).andReturn(host1Id).anyTimes();
  ConfigGroup configGroup1=createNiceMock(ConfigGroup.class);
  ConfigGroup configGroup2=createNiceMock(ConfigGroup.class);
  ConfigGroup configGroup3=createNiceMock(ConfigGroup.class);
  ConfigGroup configGroup4=createNiceMock(ConfigGroup.class);
  ConfigGroupResponse response1=createNiceMock(ConfigGroupResponse.class);
  ConfigGroupResponse response2=createNiceMock(ConfigGroupResponse.class);
  ConfigGroupResponse response3=createNiceMock(ConfigGroupResponse.class);
  ConfigGroupResponse response4=createNiceMock(ConfigGroupResponse.class);
  Map<Long,ConfigGroup> configGroupMap=new HashMap<Long,ConfigGroup>();
  configGroupMap.put(1L,configGroup1);
  configGroupMap.put(2L,configGroup2);
  configGroupMap.put(3L,configGroup3);
  configGroupMap.put(4L,configGroup4);
  Map<Long,ConfigGroup> configGroupByHostname=new HashMap<Long,ConfigGroup>();
  configGroupByHostname.put(4L,configGroup4);
  expect(configGroup1.convertToResponse()).andReturn(response1).anyTimes();
  expect(configGroup2.convertToResponse()).andReturn(response2).anyTimes();
  expect(configGroup3.convertToResponse()).andReturn(response3).anyTimes();
  expect(configGroup4.convertToResponse()).andReturn(response4).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getConfigGroups()).andReturn(configGroupMap).anyTimes();
  expect(cluster.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(configGroup1.getName()).andReturn("g1").anyTimes();
  expect(configGroup2.getName()).andReturn("g2").anyTimes();
  expect(configGroup3.getName()).andReturn("g3").anyTimes();
  expect(configGroup4.getName()).andReturn("g4").anyTimes();
  expect(configGroup1.getTag()).andReturn("t1").anyTimes();
  expect(configGroup2.getTag()).andReturn("t2").anyTimes();
  expect(configGroup3.getTag()).andReturn("t3").anyTimes();
  expect(configGroup4.getTag()).andReturn("t4").anyTimes();
  Map<Long,Host> hostMap=new HashMap<Long,Host>();
  hostMap.put(host1Id,h1);
  expect(configGroup4.getHosts()).andReturn(hostMap).anyTimes();
  expect(response1.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(response2.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(response3.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(response4.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(response1.getId()).andReturn(1L).anyTimes();
  expect(response2.getId()).andReturn(2L).anyTimes();
  expect(response3.getId()).andReturn(3L).anyTimes();
  expect(response4.getId()).andReturn(4L).anyTimes();
  expect(response2.getGroupName()).andReturn("g2").anyTimes();
  expect(response3.getTag()).andReturn("t3").anyTimes();
  expect(cluster.getConfigGroupsByHostname("h1")).andReturn(configGroupByHostname).anyTimes();
  Set<Map<String,Object>> hostObj=new HashSet<Map<String,Object>>();
  Map<String,Object> hostnames=new HashMap<String,Object>();
  hostnames.put("host_name","h1");
  hostObj.add(hostnames);
  expect(response4.getHosts()).andReturn(hostObj).anyTimes();
  replay(managementController,clusters,cluster,hostDAO,hostEntity1,configGroup1,configGroup2,configGroup3,configGroup4,response1,response2,response3,response4);
  ResourceProvider resourceProvider=getConfigGroupResourceProvider(managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=resourceProvider.getResources(request,predicate);
  assertEquals(4,resources.size());
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID).equals(1L).and().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  assertEquals(1L,resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_NAME_PROPERTY_ID).equals("g2").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  assertEquals("g2",resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_NAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID).equals("t3").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  assertEquals("t3",resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID).equals("h1").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  Set<Map<String,Object>> hostSet=(Set<Map<String,Object>>)resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID);
  assertEquals("h1",hostSet.iterator().next().get(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_HOSTNAME_PROPERTY_ID).equals("h1").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  hostSet=(Set<Map<String,Object>>)resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID);
  assertEquals("h1",hostSet.iterator().next().get(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID).equals("t4").and().property(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID).equals(host1Id).toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  hostSet=(Set<Map<String,Object>>)resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID);
  assertEquals("h1",hostSet.iterator().next().get(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID).equals("t4").and().property(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_HOSTNAME_PROPERTY_ID).equals("h1").toPredicate();
  resources=resourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  hostSet=(Set<Map<String,Object>>)resources.iterator().next().getPropertyValue(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID);
  assertEquals("h1",hostSet.iterator().next().get(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID));
  predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID).equals(11L).and().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  NoSuchResourceException resourceException=null;
  try {
    resourceProvider.getResources(request,predicate);
  }
 catch (  NoSuchResourceException ce) {
    resourceException=ce;
  }
  Assert.assertNotNull(resourceException);
  verify(managementController,clusters,cluster,hostDAO,hostEntity1,configGroup1,configGroup2,configGroup3,configGroup4,response1,response2,response3,response4);
}

</code></pre>

<br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testUpdateConfigGroupWithWrongConfigType() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  ConfigHelper configHelper=createNiceMock(ConfigHelper.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Host h1=createNiceMock(Host.class);
  Host h2=createNiceMock(Host.class);
  HostEntity hostEntity1=createMock(HostEntity.class);
  HostEntity hostEntity2=createMock(HostEntity.class);
  final ConfigGroup configGroup=createNiceMock(ConfigGroup.class);
  ConfigGroupResponse configGroupResponse=createNiceMock(ConfigGroupResponse.class);
  expect(cluster.isConfigTypeExists("core-site")).andReturn(false).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(clusters.getHost("h1")).andReturn(h1);
  expect(clusters.getHost("h2")).andReturn(h2);
  expect(hostDAO.findByName("h1")).andReturn(hostEntity1).anyTimes();
  expect(hostDAO.findById(1L)).andReturn(hostEntity1).anyTimes();
  expect(hostDAO.findByName("h2")).andReturn(hostEntity2).anyTimes();
  expect(hostDAO.findById(2L)).andReturn(hostEntity2).anyTimes();
  expect(hostEntity1.getHostId()).andReturn(1L).atLeastOnce();
  expect(hostEntity2.getHostId()).andReturn(2L).atLeastOnce();
  expect(h1.getHostId()).andReturn(1L).anyTimes();
  expect(h2.getHostId()).andReturn(2L).anyTimes();
  expect(configGroup.getName()).andReturn("test-1").anyTimes();
  expect(configGroup.getId()).andReturn(25L).anyTimes();
  expect(configGroup.getTag()).andReturn("tag-1").anyTimes();
  expect(configGroup.convertToResponse()).andReturn(configGroupResponse).anyTimes();
  expect(configGroupResponse.getClusterName()).andReturn("Cluster100").anyTimes();
  expect(configGroupResponse.getId()).andReturn(25L).anyTimes();
  expect(cluster.getConfigGroups()).andStubAnswer(new IAnswer<Map<Long,ConfigGroup>>(){
    @Override public Map<Long,ConfigGroup> answer() throws Throwable {
      Map<Long,ConfigGroup> configGroupMap=new HashMap<Long,ConfigGroup>();
      configGroupMap.put(configGroup.getId(),configGroup);
      return configGroupMap;
    }
  }
);
  replay(managementController,clusters,cluster,configGroup,response,configGroupResponse,configHelper,hostDAO,hostEntity1,hostEntity2,h1,h2);
  ResourceProvider provider=getConfigGroupResourceProvider(managementController);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Set<Map<String,Object>> hostSet=new HashSet<Map<String,Object>>();
  Map<String,Object> host1=new HashMap<String,Object>();
  host1.put(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID,"h1");
  hostSet.add(host1);
  Map<String,Object> host2=new HashMap<String,Object>();
  host2.put(ConfigGroupResourceProvider.CONFIGGROUP_HOSTNAME_PROPERTY_ID,"h2");
  hostSet.add(host2);
  Set<Map<String,Object>> configSet=new HashSet<Map<String,Object>>();
  Map<String,String> configMap=new HashMap<String,String>();
  Map<String,Object> configs=new HashMap<String,Object>();
  configs.put("type","core-site");
  configs.put("tag","version100");
  configMap.put("key1","value1");
  configs.put("properties",configMap);
  configSet.add(configs);
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_NAME_PROPERTY_ID,"test-1");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_TAG_PROPERTY_ID,"tag-1");
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_HOSTS_PROPERTY_ID,hostSet);
  properties.put(ConfigGroupResourceProvider.CONFIGGROUP_CONFIGS_PROPERTY_ID,configSet);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  Request request=PropertyHelper.getUpdateRequest(properties,mapRequestProps);
  Predicate predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID).equals(25L).toPredicate();
  SystemException systemException=null;
  try {
    provider.updateResources(request,predicate);
  }
 catch (  SystemException e) {
    systemException=e;
  }
  assertNotNull(systemException);
  verify(managementController,clusters,cluster,configGroup,response,configGroupResponse,configHelper,hostDAO,hostEntity1,hostEntity2,h1,h2);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteConfigGroup() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  ConfigGroup configGroup=createNiceMock(ConfigGroup.class);
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getConfigGroups()).andReturn(Collections.singletonMap(1L,configGroup));
  cluster.deleteConfigGroup(1L);
  replay(managementController,clusters,cluster,configGroup);
  ResourceProvider resourceProvider=getConfigGroupResourceProvider(managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)resourceProvider).addObserver(observer);
  Predicate predicate=new PredicateBuilder().property(ConfigGroupResourceProvider.CONFIGGROUP_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ConfigGroupResourceProvider.CONFIGGROUP_ID_PROPERTY_ID).equals(1L).toPredicate();
  resourceProvider.deleteResources(predicate);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  Assert.assertNotNull(lastEvent);
  Assert.assertEquals(Resource.Type.ConfigGroup,lastEvent.getResourceType());
  Assert.assertEquals(ResourceProviderEvent.Type.Delete,lastEvent.getType());
  Assert.assertEquals(predicate,lastEvent.getPredicate());
  Assert.assertNull(lastEvent.getRequest());
  verify(managementController,clusters,cluster,configGroup);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ConfigurationResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.Configuration;
  StackId stackId=new StackId("HDP","0.1");
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<ConfigurationResponse> allResponse=new HashSet<ConfigurationResponse>();
  allResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag1",1L,null,null));
  allResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag2",2L,null,null));
  allResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag3",3L,null,null));
  Set<ConfigurationResponse> orResponse=new HashSet<ConfigurationResponse>();
  orResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag1",1L,null,null));
  orResponse.add(new ConfigurationResponse("Cluster100",stackId,"type","tag2",2L,null,null));
  Capture<Set<ConfigurationRequest>> configRequestCapture1=new Capture<Set<ConfigurationRequest>>();
  Capture<Set<ConfigurationRequest>> configRequestCapture2=new Capture<Set<ConfigurationRequest>>();
  expect(managementController.getConfigurations(capture(configRequestCapture1))).andReturn(allResponse).once();
  expect(managementController.getConfigurations(capture(configRequestCapture2))).andReturn(orResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Set<ConfigurationRequest> setRequest=configRequestCapture1.getValue();
  assertEquals(1,setRequest.size());
  ConfigurationRequest configRequest=setRequest.iterator().next();
  assertEquals("Cluster100",configRequest.getClusterName());
  assertNull(configRequest.getType());
  assertNull(configRequest.getVersionTag());
  Assert.assertEquals(3,resources.size());
  boolean containsResource1=false;
  boolean containsResource2=false;
  boolean containsResource3=false;
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID);
    String stackIdProperty=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_STACK_ID_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    Assert.assertEquals(stackId.getStackId(),stackIdProperty);
    String tag=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID);
    if (tag.equals("tag1")) {
      containsResource1=true;
    }
 else     if (tag.equals("tag2")) {
      containsResource2=true;
    }
 else     if (tag.equals("tag3")) {
      containsResource3=true;
    }
  }
  assertTrue(containsResource1);
  assertTrue(containsResource2);
  assertTrue(containsResource3);
  predicate=new PredicateBuilder().property(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID).equals("tag1").or().property(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID).equals("tag2").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  resources=provider.getResources(request,predicate);
  setRequest=configRequestCapture2.getValue();
  assertEquals(2,setRequest.size());
  boolean containsTag1=false;
  boolean containsTag2=false;
  for (  ConfigurationRequest cr : setRequest) {
    assertNull(cr.getClusterName());
    if (cr.getVersionTag().equals("tag1")) {
      containsTag1=true;
    }
 else     if (cr.getVersionTag().equals("tag2")) {
      containsTag2=true;
    }
  }
  assertTrue(containsTag1);
  assertTrue(containsTag2);
  Assert.assertEquals(2,resources.size());
  containsResource1=false;
  containsResource2=false;
  for (  Resource resource : resources) {
    String clusterName=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CLUSTER_NAME_PROPERTY_ID);
    Assert.assertEquals("Cluster100",clusterName);
    String tag=(String)resource.getPropertyValue(ConfigurationResourceProvider.CONFIGURATION_CONFIG_TAG_PROPERTY_ID);
    if (tag.equals("tag1")) {
      containsResource1=true;
    }
 else     if (tag.equals("tag2")) {
      containsResource2=true;
    }
  }
  assertTrue(containsResource1);
  assertTrue(containsResource2);
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ExportBlueprintRequestTest </h4><pre class="type-4 type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExport_noConfigs() throws Exception {
  Resource clusterResource=new ResourceImpl(Resource.Type.Cluster);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_NAME_PROPERTY_ID,CLUSTER_NAME);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_ID_PROPERTY_ID,CLUSTER_ID);
  clusterResource.setProperty(ClusterResourceProvider.CLUSTER_VERSION_PROPERTY_ID,"TEST-1.0");
  TreeNode<Resource> clusterNode=new TreeNodeImpl<Resource>(null,clusterResource,"cluster");
  Resource configResource=new ResourceImpl(Resource.Type.Configuration);
  clusterNode.addChild(configResource,"configurations");
  Resource hostsResource=new ResourceImpl(Resource.Type.Host);
  Resource host1Resource=new ResourceImpl(Resource.Type.Host);
  Resource host2Resource=new ResourceImpl(Resource.Type.Host);
  Resource host3Resource=new ResourceImpl(Resource.Type.Host);
  TreeNode<Resource> hostsNode=clusterNode.addChild(hostsResource,"hosts");
  TreeNode<Resource> host1Node=hostsNode.addChild(host1Resource,"host_1");
  TreeNode<Resource> host2Node=hostsNode.addChild(host2Resource,"host_2");
  TreeNode<Resource> host3Node=hostsNode.addChild(host3Resource,"host_3");
  host1Resource.setProperty("Hosts/host_name","host1");
  host2Resource.setProperty("Hosts/host_name","host2");
  host3Resource.setProperty("Hosts/host_name","host3");
  List<String> host1ComponentsList=Arrays.asList("NAMENODE","HDFS_CLIENT","ZOOKEEPER_SERVER","SECONDARY_NAMENODE");
  List<String> host2ComponentsList=Arrays.asList("DATANODE","HDFS_CLIENT","ZOOKEEPER_SERVER");
  List<String> host3ComponentsList=Arrays.asList("DATANODE","HDFS_CLIENT","ZOOKEEPER_SERVER");
  processHostGroupComponents(host1Node,host1ComponentsList);
  processHostGroupComponents(host2Node,host2ComponentsList);
  processHostGroupComponents(host3Node,host3ComponentsList);
  ExportBlueprintRequest exportBlueprintRequest=new ExportBlueprintRequest(clusterNode);
  assertEquals(CLUSTER_NAME,exportBlueprintRequest.getClusterName());
  Blueprint bp=exportBlueprintRequest.getBlueprint();
  assertEquals("exported-blueprint",bp.getName());
  Map<String,HostGroup> hostGroups=bp.getHostGroups();
  assertEquals(2,hostGroups.size());
  String hg1Name=null;
  String hg2Name=null;
  for (  HostGroup group : hostGroups.values()) {
    Collection<String> components=group.getComponentNames();
    if (components.containsAll(host1ComponentsList)) {
      assertEquals(host1ComponentsList.size(),components.size());
      assertEquals("1",group.getCardinality());
      hg1Name=group.getName();
    }
 else     if (components.containsAll(host2ComponentsList)) {
      assertEquals(host2ComponentsList.size(),components.size());
      assertEquals("2",group.getCardinality());
      hg2Name=group.getName();
    }
 else {
      fail("Host group contained invalid components");
    }
  }
  assertNotNull(hg1Name);
  assertNotNull(hg2Name);
  HostGroupInfo host1Info=exportBlueprintRequest.getHostGroupInfo().get(hg1Name);
  assertEquals(1,host1Info.getHostNames().size());
  assertEquals("host1",host1Info.getHostNames().iterator().next());
  HostGroupInfo host2Info=exportBlueprintRequest.getHostGroupInfo().get(hg2Name);
  assertEquals(2,host2Info.getHostNames().size());
  assertTrue(host2Info.getHostNames().contains("host2") && host2Info.getHostNames().contains("host3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HostComponentProcessResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  @SuppressWarnings("unchecked") ResourceProvider provider=init(new HashMap<String,String>(){
{
      put("status","RUNNING");
      put("name","a1");
    }
  }
);
  PredicateBuilder pb=new PredicateBuilder().property(HostComponentProcessResourceProvider.HC_PROCESS_CLUSTER_NAME_ID).equals("c1").and();
  pb=pb.property(HostComponentProcessResourceProvider.HC_PROCESS_HOST_NAME_ID).equals("h1").and();
  Predicate predicate=pb.property(HostComponentProcessResourceProvider.HC_PROCESS_COMPONENT_NAME_ID).equals("comp1").toPredicate();
  Request request=PropertyHelper.getReadRequest(Collections.<String>emptySet());
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(Integer.valueOf(1),Integer.valueOf(resources.size()));
  Resource res=resources.iterator().next();
  Assert.assertNotNull(res.getPropertyValue(HostComponentProcessResourceProvider.HC_PROCESS_NAME_ID));
  Assert.assertNotNull(res.getPropertyValue(HostComponentProcessResourceProvider.HC_PROCESS_STATUS_ID));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources_many() throws Exception {
  @SuppressWarnings("unchecked") ResourceProvider provider=init(new HashMap<String,String>(){
{
      put("status","RUNNING");
      put("name","a");
    }
  }
,new HashMap<String,String>(){
{
      put("status","RUNNING");
      put("name","b");
    }
  }
,new HashMap<String,String>(){
{
      put("status","NOT_RUNNING");
      put("name","c");
    }
  }
);
  PredicateBuilder pb=new PredicateBuilder().property(HostComponentProcessResourceProvider.HC_PROCESS_CLUSTER_NAME_ID).equals("c1").and();
  pb=pb.property(HostComponentProcessResourceProvider.HC_PROCESS_HOST_NAME_ID).equals("h1").and();
  Predicate predicate=pb.property(HostComponentProcessResourceProvider.HC_PROCESS_COMPONENT_NAME_ID).equals("comp1").toPredicate();
  Request request=PropertyHelper.getReadRequest(Collections.<String>emptySet());
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(Integer.valueOf(3),Integer.valueOf(resources.size()));
  for (  Resource r : resources) {
    Assert.assertNotNull(r.getPropertyValue(HostComponentProcessResourceProvider.HC_PROCESS_NAME_ID));
    Assert.assertNotNull(r.getPropertyValue(HostComponentProcessResourceProvider.HC_PROCESS_STATUS_ID));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HostKerberosIdentityResourceProviderTest </h4><pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  KerberosPrincipalDescriptor principalDescriptor1=createStrictMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor1.getValue()).andReturn("principal1@EXAMPLE.COM");
  expect(principalDescriptor1.getType()).andReturn(KerberosPrincipalType.USER).times(1);
  expect(principalDescriptor1.getLocalUsername()).andReturn("principal1");
  KerberosKeytabDescriptor keytabDescriptor1=createStrictMock(KerberosKeytabDescriptor.class);
  expect(keytabDescriptor1.getOwnerAccess()).andReturn("rw").times(1);
  expect(keytabDescriptor1.getGroupAccess()).andReturn("r").times(1);
  expect(keytabDescriptor1.getFile()).andReturn("/etc/security/keytabs/principal1.headless.keytab").times(1);
  expect(keytabDescriptor1.getOwnerName()).andReturn("principal1").times(1);
  expect(keytabDescriptor1.getGroupName()).andReturn("principal1").times(1);
  KerberosIdentityDescriptor identity1=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity1.getPrincipalDescriptor()).andReturn(principalDescriptor1).times(1);
  expect(identity1.getKeytabDescriptor()).andReturn(keytabDescriptor1).times(1);
  expect(identity1.getName()).andReturn("identity1").times(1);
  KerberosPrincipalDescriptor principalDescriptor2=createStrictMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor2.getValue()).andReturn("principal2/Host100@EXAMPLE.COM");
  expect(principalDescriptor2.getType()).andReturn(KerberosPrincipalType.SERVICE).times(1);
  expect(principalDescriptor2.getLocalUsername()).andReturn("principal2");
  KerberosIdentityDescriptor identity2=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity2.getPrincipalDescriptor()).andReturn(principalDescriptor2).times(1);
  expect(identity2.getKeytabDescriptor()).andReturn(null).times(1);
  expect(identity2.getName()).andReturn("identity2").times(1);
  KerberosIdentityDescriptor identity3=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity3.getPrincipalDescriptor()).andReturn(null).times(1);
  KerberosIdentityDescriptor identity4=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity4.getPrincipalDescriptor()).andReturn(null).times(1);
  KerberosPrincipalDescriptor principalDescriptor5=createStrictMock(KerberosPrincipalDescriptor.class);
  expect(principalDescriptor5.getValue()).andReturn("principal5@EXAMPLE.COM");
  expect(principalDescriptor5.getType()).andReturn(KerberosPrincipalType.USER).times(1);
  expect(principalDescriptor5.getLocalUsername()).andReturn("principal5");
  KerberosKeytabDescriptor keytabDescriptor5=createStrictMock(KerberosKeytabDescriptor.class);
  expect(keytabDescriptor5.getOwnerAccess()).andReturn("r").times(1);
  expect(keytabDescriptor5.getGroupAccess()).andReturn("r").times(1);
  expect(keytabDescriptor5.getFile()).andReturn("/etc/security/keytabs/principal5.headless.keytab").times(1);
  expect(keytabDescriptor5.getOwnerName()).andReturn("principal5").times(1);
  expect(keytabDescriptor5.getGroupName()).andReturn("hadoop").times(1);
  KerberosIdentityDescriptor identity5=createStrictMock(KerberosIdentityDescriptor.class);
  expect(identity5.getPrincipalDescriptor()).andReturn(principalDescriptor5).times(1);
  expect(identity5.getKeytabDescriptor()).andReturn(keytabDescriptor5).times(1);
  expect(identity5.getName()).andReturn("identity5").times(1);
  KerberosPrincipalDAO kerberosPrincipalDAO=createStrictMock(KerberosPrincipalDAO.class);
  expect(kerberosPrincipalDAO.exists("principal1@EXAMPLE.COM")).andReturn(true).times(1);
  expect(kerberosPrincipalDAO.exists("principal2/Host100@EXAMPLE.COM")).andReturn(true).times(1);
  expect(kerberosPrincipalDAO.exists("principal5@EXAMPLE.COM")).andReturn(false).times(1);
  KerberosPrincipalHostDAO kerberosPrincipalHostDAO=createStrictMock(KerberosPrincipalHostDAO.class);
  expect(kerberosPrincipalHostDAO.exists("principal1@EXAMPLE.COM",100L)).andReturn(true).times(1);
  expect(kerberosPrincipalHostDAO.exists("principal2/Host100@EXAMPLE.COM",100L)).andReturn(false).times(1);
  HostEntity host100=createStrictMock(HostEntity.class);
  expect(host100.getHostId()).andReturn(100L).times(1);
  HostDAO hostDAO=createStrictMock(HostDAO.class);
  expect(hostDAO.findByName("Host100")).andReturn(host100).times(1);
  Collection<KerberosIdentityDescriptor> identities=new ArrayList<KerberosIdentityDescriptor>();
  identities.add(identity1);
  identities.add(identity2);
  identities.add(identity3);
  identities.add(identity4);
  identities.add(identity5);
  Map<String,Collection<KerberosIdentityDescriptor>> activeIdentities=new HashMap<String,Collection<KerberosIdentityDescriptor>>();
  activeIdentities.put("Host100",identities);
  KerberosHelper kerberosHelper=createStrictMock(KerberosHelper.class);
  expect(kerberosHelper.getActiveIdentities("Cluster100","Host100",null,null,true)).andReturn(activeIdentities).times(1);
  replayAll();
  ResourceProvider provider=new HostKerberosIdentityResourceProvider(managementController);
  Field field;
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("kerberosHelper");
  field.setAccessible(true);
  field.set(provider,kerberosHelper);
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("kerberosPrincipalDAO");
  field.setAccessible(true);
  field.set(provider,kerberosPrincipalDAO);
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("kerberosPrincipalHostDAO");
  field.setAccessible(true);
  field.set(provider,kerberosPrincipalHostDAO);
  field=HostKerberosIdentityResourceProvider.class.getDeclaredField("hostDAO");
  field.setAccessible(true);
  field.set(provider,hostDAO);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_CLUSTER_NAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_HOST_NAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_NAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID);
  propertyIds.add(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_HOST_NAME_PROPERTY_ID).equals("Host100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(3,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals("Cluster100",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_CLUSTER_NAME_PROPERTY_ID));
    Assert.assertEquals("Host100",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_HOST_NAME_PROPERTY_ID));
    String principal=(String)resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_NAME_PROPERTY_ID);
    if ("principal1@EXAMPLE.COM".equals(principal)) {
      Assert.assertEquals("identity1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID));
      Assert.assertEquals(KerberosPrincipalType.USER,resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID));
      Assert.assertEquals("principal1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID));
      Assert.assertEquals("/etc/security/keytabs/principal1.headless.keytab",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID));
      Assert.assertEquals("principal1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID));
      Assert.assertEquals("rw",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID));
      Assert.assertEquals("principal1",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID));
      Assert.assertEquals("r",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID));
      Assert.assertEquals("640",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID));
      Assert.assertEquals("true",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID));
    }
 else     if ("principal2/Host100@EXAMPLE.COM".equals(principal)) {
      Assert.assertEquals("identity2",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID));
      Assert.assertEquals(KerberosPrincipalType.SERVICE,resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID));
      Assert.assertEquals("principal2",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID));
      Assert.assertNull(resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID));
      Assert.assertEquals("false",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID));
    }
 else     if ("principal5@EXAMPLE.COM".equals(principal)) {
      Assert.assertEquals("identity5",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_DESCRIPTION_PROPERTY_ID));
      Assert.assertEquals(KerberosPrincipalType.USER,resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_TYPE_PROPERTY_ID));
      Assert.assertEquals("principal5",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_PRINCIPAL_LOCAL_USERNAME_PROPERTY_ID));
      Assert.assertEquals("/etc/security/keytabs/principal5.headless.keytab",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_PATH_PROPERTY_ID));
      Assert.assertEquals("principal5",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_PROPERTY_ID));
      Assert.assertEquals("r",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_OWNER_ACCESS_PROPERTY_ID));
      Assert.assertEquals("hadoop",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_PROPERTY_ID));
      Assert.assertEquals("r",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_GROUP_ACCESS_PROPERTY_ID));
      Assert.assertEquals("440",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_MODE_PROPERTY_ID));
      Assert.assertEquals("unknown",resource.getPropertyValue(HostKerberosIdentityResourceProvider.KERBEROS_IDENTITY_KEYTAB_FILE_INSTALLED_PROPERTY_ID));
    }
 else {
      Assert.fail("Unexpected principal: " + principal);
    }
  }
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.HttpPropertyProviderTest </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testReadGangliaServer() throws Exception {
  Resource resource=doPopulate("GANGLIA_SERVER",Collections.<String>emptySet(),new TestStreamProvider(false));
  Assert.assertNull(resource.getPropertyValue(PROPERTY_ID_STALE_CONFIGS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.KerberosDescriptorResourceProviderTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShoudCreateResourceWhenNameAndDescriptorProvided() throws Exception {
  kerberosDescriptorResourceProvider=new KerberosDescriptorResourceProvider(kerberosDescriptorDAO,kerberosDescriptorFactory,Collections.EMPTY_SET,Collections.EMPTY_MAP,null);
  EasyMock.expect(request.getProperties()).andReturn(requestPropertySet(KERBEROS_DESCRIPTORS_KERBEROS_DESCRIPTOR_NAME,TEST_KERBEROS_DESCRIPTOR_NAME)).times(3);
  EasyMock.expect(request.getRequestInfoProperties()).andReturn(requestInfoPropertyMap(Request.REQUEST_INFO_BODY_PROPERTY,TEST_KERBEROS_DESCRIPTOR)).times(3);
  EasyMock.expect(kerberosDescriptorFactory.createKerberosDescriptor(anyString(),anyString())).andReturn(new KerberosDescriptorImpl(TEST_KERBEROS_DESCRIPTOR_NAME,TEST_KERBEROS_DESCRIPTOR));
  Capture<KerberosDescriptorEntity> entityCapture=EasyMock.newCapture();
  kerberosDescriptorDAO.create(capture(entityCapture));
  EasyMock.replay(request,kerberosDescriptorFactory,kerberosDescriptorDAO);
  kerberosDescriptorResourceProvider.createResources(request);
  Assert.assertNotNull(entityCapture.getValue());
  Assert.assertEquals("The resource name is invalid!",TEST_KERBEROS_DESCRIPTOR_NAME,entityCapture.getValue().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ProvisionClusterRequestTest </h4><pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleGroups() throws Exception {
  Map<String,Object> properties=createBlueprintRequestProperties(CLUSTER_NAME,BLUEPRINT_NAME);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(CLUSTER_NAME,provisionClusterRequest.getClusterName());
  assertEquals(TopologyRequest.Type.PROVISION,provisionClusterRequest.getType());
  assertEquals(String.format("Provision Cluster '%s'",CLUSTER_NAME),provisionClusterRequest.getDescription());
  assertSame(blueprint,provisionClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=provisionClusterRequest.getHostGroupInfo();
  assertEquals(2,hostGroupInfo.size());
  assertEquals(1,provisionClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get("group1");
  assertEquals("group1",group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains("host1.myDomain.com"));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
  Configuration group1Configuration=group1Info.getConfiguration();
  assertNull(group1Configuration.getParentConfiguration());
  assertEquals(1,group1Configuration.getProperties().size());
  Map<String,String> group1TypeProperties=group1Configuration.getProperties().get("foo-type");
  assertEquals(2,group1TypeProperties.size());
  assertEquals("prop1Value",group1TypeProperties.get("hostGroup1Prop1"));
  assertEquals("prop2Value",group1TypeProperties.get("hostGroup1Prop2"));
  assertTrue(group1Configuration.getAttributes().isEmpty());
  HostGroupInfo group2Info=hostGroupInfo.get("group2");
  assertEquals("group2",group2Info.getHostGroupName());
  assertTrue(group2Info.getHostNames().isEmpty());
  assertEquals(5,group2Info.getRequestedHostCount());
  assertNotNull(group2Info.getPredicate());
  Configuration group2Configuration=group2Info.getConfiguration();
  assertNull(group2Configuration.getParentConfiguration());
  assertEquals(1,group2Configuration.getProperties().size());
  Map<String,String> group2TypeProperties=group2Configuration.getProperties().get("foo-type");
  assertEquals(1,group2TypeProperties.size());
  assertEquals("prop1Value",group2TypeProperties.get("hostGroup2Prop1"));
  Map<String,Map<String,Map<String,String>>> group2Attributes=group2Configuration.getAttributes();
  assertEquals(1,group2Attributes.size());
  Map<String,Map<String,String>> group2Type1Attributes=group2Attributes.get("foo-type");
  assertEquals(1,group2Type1Attributes.size());
  Map<String,String> group2Type1Prop1Attributes=group2Type1Attributes.get("hostGroup2Prop10");
  assertEquals(1,group2Type1Prop1Attributes.size());
  assertEquals("attribute1Prop10-value",group2Type1Prop1Attributes.get("attribute1"));
  Configuration clusterScopeConfiguration=provisionClusterRequest.getConfiguration();
  assertSame(blueprintConfig,clusterScopeConfiguration.getParentConfiguration());
  assertEquals(1,clusterScopeConfiguration.getProperties().size());
  Map<String,String> clusterScopedProperties=clusterScopeConfiguration.getProperties().get("someType");
  assertEquals(1,clusterScopedProperties.size());
  assertEquals("someValue",clusterScopedProperties.get("property1"));
  Map<String,Map<String,Map<String,String>>> clusterScopedAttributes=clusterScopeConfiguration.getAttributes();
  assertEquals(1,clusterScopedAttributes.size());
  Map<String,Map<String,String>> clusterScopedTypeAttributes=clusterScopedAttributes.get("someType");
  assertEquals(1,clusterScopedTypeAttributes.size());
  Map<String,String> clusterScopedTypePropertyAttributes=clusterScopedTypeAttributes.get("property1");
  assertEquals(1,clusterScopedTypePropertyAttributes.size());
  assertEquals("someAttributePropValue",clusterScopedTypePropertyAttributes.get("attribute1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostCountSpecified() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  Map<String,Object> properties=createBlueprintRequestPropertiesCountOnly(CLUSTER_NAME,BLUEPRINT_NAME);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(CLUSTER_NAME,provisionClusterRequest.getClusterName());
  assertEquals(TopologyRequest.Type.PROVISION,provisionClusterRequest.getType());
  assertEquals(String.format("Provision Cluster '%s'",CLUSTER_NAME),provisionClusterRequest.getDescription());
  assertSame(blueprint,provisionClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=provisionClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(1,provisionClusterRequest.getTopologyValidators().size());
  HostGroupInfo group2Info=hostGroupInfo.get("group2");
  assertEquals("group2",group2Info.getHostGroupName());
  assertTrue(group2Info.getHostNames().isEmpty());
  assertEquals(5,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
  Configuration group2Configuration=group2Info.getConfiguration();
  assertNull(group2Configuration.getParentConfiguration());
  assertEquals(1,group2Configuration.getProperties().size());
  Map<String,String> group2TypeProperties=group2Configuration.getProperties().get("foo-type");
  assertEquals(1,group2TypeProperties.size());
  assertEquals("prop1Value",group2TypeProperties.get("hostGroup2Prop1"));
  Map<String,Map<String,Map<String,String>>> group2Attributes=group2Configuration.getAttributes();
  assertEquals(1,group2Attributes.size());
  Map<String,Map<String,String>> group2Type1Attributes=group2Attributes.get("foo-type");
  assertEquals(1,group2Type1Attributes.size());
  Map<String,String> group2Type1Prop1Attributes=group2Type1Attributes.get("hostGroup2Prop10");
  assertEquals(1,group2Type1Prop1Attributes.size());
  assertEquals("attribute1Prop10-value",group2Type1Prop1Attributes.get("attribute1"));
  Configuration clusterScopeConfiguration=provisionClusterRequest.getConfiguration();
  assertSame(blueprintConfig,clusterScopeConfiguration.getParentConfiguration());
  assertEquals(1,clusterScopeConfiguration.getProperties().size());
  Map<String,String> clusterScopedProperties=clusterScopeConfiguration.getProperties().get("someType");
  assertEquals(1,clusterScopedProperties.size());
  assertEquals("someValue",clusterScopedProperties.get("property1"));
  Map<String,Map<String,Map<String,String>>> clusterScopedAttributes=clusterScopeConfiguration.getAttributes();
  assertEquals(1,clusterScopedAttributes.size());
  Map<String,Map<String,String>> clusterScopedTypeAttributes=clusterScopedAttributes.get("someType");
  assertEquals(1,clusterScopedTypeAttributes.size());
  Map<String,String> clusterScopedTypePropertyAttributes=clusterScopedTypeAttributes.get("property1");
  assertEquals(1,clusterScopedTypePropertyAttributes.size());
  assertEquals("someAttributePropValue",clusterScopedTypePropertyAttributes.get("attribute1"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostNameSpecified() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  Map<String,Object> properties=createBlueprintRequestPropertiesNameOnly(CLUSTER_NAME,BLUEPRINT_NAME);
  ProvisionClusterRequest provisionClusterRequest=new ProvisionClusterRequest(properties,null);
  assertEquals(CLUSTER_NAME,provisionClusterRequest.getClusterName());
  assertEquals(TopologyRequest.Type.PROVISION,provisionClusterRequest.getType());
  assertEquals(String.format("Provision Cluster '%s'",CLUSTER_NAME),provisionClusterRequest.getDescription());
  assertSame(blueprint,provisionClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=provisionClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(1,provisionClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get("group1");
  assertEquals("group1",group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains("host1.myDomain.com"));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
  Configuration group1Configuration=group1Info.getConfiguration();
  assertNull(group1Configuration.getParentConfiguration());
  assertEquals(1,group1Configuration.getProperties().size());
  Map<String,String> group1TypeProperties=group1Configuration.getProperties().get("foo-type");
  assertEquals(2,group1TypeProperties.size());
  assertEquals("prop1Value",group1TypeProperties.get("hostGroup1Prop1"));
  assertEquals("prop2Value",group1TypeProperties.get("hostGroup1Prop2"));
  assertTrue(group1Configuration.getAttributes().isEmpty());
  Configuration clusterScopeConfiguration=provisionClusterRequest.getConfiguration();
  assertSame(blueprintConfig,clusterScopeConfiguration.getParentConfiguration());
  assertEquals(1,clusterScopeConfiguration.getProperties().size());
  Map<String,String> clusterScopedProperties=clusterScopeConfiguration.getProperties().get("someType");
  assertEquals(1,clusterScopedProperties.size());
  assertEquals("someValue",clusterScopedProperties.get("property1"));
  Map<String,Map<String,Map<String,String>>> clusterScopedAttributes=clusterScopeConfiguration.getAttributes();
  assertEquals(1,clusterScopedAttributes.size());
  Map<String,Map<String,String>> clusterScopedTypeAttributes=clusterScopedAttributes.get("someType");
  assertEquals(1,clusterScopedTypeAttributes.size());
  Map<String,String> clusterScopedTypePropertyAttributes=clusterScopedTypeAttributes.get("property1");
  assertEquals(1,clusterScopedTypePropertyAttributes.size());
  assertEquals("someAttributePropValue",clusterScopedTypePropertyAttributes.get("attribute1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RepositoryVersionResourceProviderTest </h4><pre class="type-10 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateRepositoryVersion() throws Exception {
  StackDAO stackDAO=injector.getInstance(StackDAO.class);
  StackEntity stackEntity=stackDAO.find("HDP","1.1");
  Assert.assertNotNull(stackEntity);
  final RepositoryVersionResourceProvider provider=(RepositoryVersionResourceProvider)injector.getInstance(ResourceProviderFactory.class).getRepositoryVersionResourceProvider();
  final RepositoryVersionEntity entity=new RepositoryVersionEntity();
  entity.setDisplayName("name");
  entity.setStack(stackEntity);
  entity.setVersion("1.1");
  entity.setOperatingSystems("[{\"OperatingSystems/os_type\":\"redhat6\",\"repositories\":[{\"Repositories/repo_id\":\"1\",\"Repositories/repo_name\":\"1\",\"Repositories/base_url\":\"http://example.com/repo1\"}]}]");
  provider.validateRepositoryVersion(entity);
  entity.setVersion("1.1-17");
  provider.validateRepositoryVersion(entity);
  entity.setVersion("1.1.1.1");
  provider.validateRepositoryVersion(entity);
  entity.setVersion("1.1.343432.2");
  provider.validateRepositoryVersion(entity);
  entity.setVersion("1.1.343432.2-234234324");
  provider.validateRepositoryVersion(entity);
  entity.setOperatingSystems(jsonStringRedhat7);
  try {
    provider.validateRepositoryVersion(entity);
    Assert.fail("Should throw exception");
  }
 catch (  Exception ex) {
  }
  entity.setOperatingSystems("");
  try {
    provider.validateRepositoryVersion(entity);
    Assert.fail("Should throw exception");
  }
 catch (  Exception ex) {
  }
  StackEntity bigtop=new StackEntity();
  stackEntity.setStackName("BIGTOP");
  entity.setStack(bigtop);
  try {
    provider.validateRepositoryVersion(entity);
    Assert.fail("Should throw exception");
  }
 catch (  Exception ex) {
  }
  final RepositoryVersionDAO repositoryVersionDAO=injector.getInstance(RepositoryVersionDAO.class);
  entity.setDisplayName("name");
  entity.setStack(stackEntity);
  entity.setVersion("1.1");
  entity.setOperatingSystems("[{\"OperatingSystems/os_type\":\"redhat6\",\"repositories\":[{\"Repositories/repo_id\":\"1\",\"Repositories/repo_name\":\"1\",\"Repositories/base_url\":\"http://example.com/repo1\"}]}]");
  repositoryVersionDAO.create(entity);
  final RepositoryVersionEntity entity2=new RepositoryVersionEntity();
  entity2.setId(2l);
  entity2.setDisplayName("name2");
  entity2.setStack(stackEntity);
  entity2.setVersion("1.2");
  entity2.setOperatingSystems("[{\"OperatingSystems/os_type\":\"redhat6\",\"repositories\":[{\"Repositories/repo_id\":\"1\",\"Repositories/repo_name\":\"1\",\"Repositories/base_url\":\"http://example.com/repo1\"}]}]");
  try {
    provider.validateRepositoryVersion(entity2);
    Assert.fail("Should throw exception: Base url http://example.com/repo1 is already defined for another repository version");
  }
 catch (  Exception ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResourcesForNonCluster() throws Exception {
  Resource.Type type=Resource.Type.Request;
  Capture<ExecuteActionRequest> actionRequest=newCapture();
  Capture<HashMap<String,String>> propertyMap=newCapture();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  expect(managementController.createAction(capture(actionRequest),capture(propertyMap))).andReturn(response).anyTimes();
  expect(response.getMessage()).andReturn("Message").anyTimes();
  replay(managementController,response);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  Set<Map<String,Object>> filterSet=new HashSet<Map<String,Object>>();
  Map<String,Object> filterMap=new HashMap<String,Object>();
  filterMap.put(RequestResourceProvider.HOSTS_ID,"h1,h2");
  filterSet.add(filterMap);
  properties.put(RequestResourceProvider.REQUEST_RESOURCE_FILTER_ID,filterSet);
  propertySet.add(properties);
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(RequestResourceProvider.ACTION_ID,"check_java");
  Request request=PropertyHelper.getCreateRequest(propertySet,requestInfoProperties);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  provider.createResources(request);
  ExecuteActionRequest capturedRequest=actionRequest.getValue();
  Assert.assertTrue(actionRequest.hasCaptured());
  Assert.assertFalse("expected an action",capturedRequest.isCommand());
  Assert.assertEquals("check_java",capturedRequest.getActionName());
  Assert.assertEquals(null,capturedRequest.getCommandName());
  Assert.assertNotNull(capturedRequest.getResourceFilters());
  Assert.assertEquals(1,capturedRequest.getResourceFilters().size());
  RequestResourceFilter capturedResourceFilter=capturedRequest.getResourceFilters().get(0);
  Assert.assertEquals(null,capturedResourceFilter.getServiceName());
  Assert.assertEquals(null,capturedResourceFilter.getComponentName());
  Assert.assertNotNull(capturedResourceFilter.getHostNames());
  Assert.assertEquals(2,capturedResourceFilter.getHostNames().size());
  Assert.assertEquals(0,actionRequest.getValue().getParameters().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResourcesWithoutCluster() throws Exception {
  Resource.Type type=Resource.Type.Request;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  ActionManager actionManager=createNiceMock(ActionManager.class);
  Clusters clusters=createNiceMock(Clusters.class);
  RequestEntity requestMock=createNiceMock(RequestEntity.class);
  expect(requestMock.getRequestContext()).andReturn("this is a context").anyTimes();
  expect(requestMock.getRequestId()).andReturn(100L).anyTimes();
  Capture<Collection<Long>> requestIdsCapture=newCapture();
  expect(managementController.getActionManager()).andReturn(actionManager).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster(anyObject(String.class))).andReturn(null).anyTimes();
  expect(requestDAO.findByPks(capture(requestIdsCapture),eq(true))).andReturn(Collections.singletonList(requestMock));
  expect(hrcDAO.findAggregateCounts((Long)anyObject())).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(1L,HostRoleCommandStatusSummaryDTO.create().inProgress(1));
    }
  }
).anyTimes();
  replay(managementController,actionManager,clusters,requestMock,requestDAO,hrcDAO);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RequestResourceProvider.REQUEST_ID_PROPERTY_ID);
  propertyIds.add(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID);
  Predicate predicate=new PredicateBuilder().property(RequestResourceProvider.REQUEST_ID_PROPERTY_ID).equals("100").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  for (  Resource resource : resources) {
    Assert.assertEquals(100L,(long)(Long)resource.getPropertyValue(RequestResourceProvider.REQUEST_ID_PROPERTY_ID));
    Assert.assertEquals("IN_PROGRESS",resource.getPropertyValue(RequestResourceProvider.REQUEST_STATUS_PROPERTY_ID));
    Assert.assertNull(resource.getPropertyValue(RequestResourceProvider.REQUEST_CLUSTER_NAME_PROPERTY_ID));
  }
  verify(managementController,actionManager,clusters,requestMock,requestDAO,hrcDAO);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResourcesForCommandWithHostPredicate() throws Exception {
  Resource.Type type=Resource.Type.Request;
  Capture<ExecuteActionRequest> actionRequest=new Capture<ExecuteActionRequest>();
  Capture<HashMap<String,String>> propertyMap=new Capture<HashMap<String,String>>();
  Capture<Request> requestCapture=new Capture<>();
  Capture<Predicate> predicateCapture=new Capture<>();
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  Clusters clusters=createNiceMock(Clusters.class);
  expect(managementController.createAction(capture(actionRequest),capture(propertyMap))).andReturn(response).anyTimes();
  expect(response.getMessage()).andReturn("Message").anyTimes();
  expect(managementController.getClusters()).andReturn(clusters);
  ClusterControllerImpl controller=createNiceMock(ClusterControllerImpl.class);
  HostComponentProcessResourceProvider hostComponentProcessResourceProvider=createNiceMock(HostComponentProcessResourceProvider.class);
  PowerMock.mockStatic(ClusterControllerHelper.class);
  Resource resource=createNiceMock(Resource.class);
  expect(ClusterControllerHelper.getClusterController()).andReturn(controller);
  expect(controller.ensureResourceProvider(Resource.Type.HostComponent)).andReturn(hostComponentProcessResourceProvider);
  expect(hostComponentProcessResourceProvider.getResources(capture(requestCapture),capture(predicateCapture))).andReturn(Collections.singleton(resource));
  replay(managementController,response,controller,hostComponentProcessResourceProvider,resource,clusters);
  PowerMock.replayAll();
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(RequestResourceProvider.REQUEST_CLUSTER_NAME_PROPERTY_ID,"c1");
  Set<Map<String,Object>> filterSet=new HashSet<Map<String,Object>>();
  String predicateProperty=HOST_COMPONENT_STALE_CONFIGS_PROPERTY_ID + "=true";
  Map<String,Object> filterMap=new HashMap<String,Object>();
  filterMap.put(RequestResourceProvider.HOSTS_PREDICATE,predicateProperty);
  filterSet.add(filterMap);
  properties.put(RequestResourceProvider.REQUEST_RESOURCE_FILTER_ID,filterSet);
  propertySet.add(properties);
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(RequestResourceProvider.COMMAND_ID,"RESTART");
  requestInfoProperties.put(RequestResourceProvider.REQUEST_CONTEXT_ID,"Restart All with Stale Configs");
  Request request=PropertyHelper.getCreateRequest(propertySet,requestInfoProperties);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  provider.createResources(request);
  ExecuteActionRequest capturedRequest=actionRequest.getValue();
  Assert.assertTrue(requestCapture.hasCaptured());
  Assert.assertTrue(predicateCapture.hasCaptured());
  Map<String,Object> predicateProperties=PredicateHelper.getProperties(predicateCapture.getValue());
  String propertyIdToAssert=null;
  Object propertyValueToAssert=null;
  for (  Map.Entry<String,Object> predicateEntry : predicateProperties.entrySet()) {
    if (predicateEntry.getKey().equals(HOST_COMPONENT_STALE_CONFIGS_PROPERTY_ID)) {
      propertyIdToAssert=predicateEntry.getKey();
      propertyValueToAssert=predicateEntry.getValue();
    }
  }
  Assert.assertNotNull(propertyIdToAssert);
  Assert.assertEquals("true",(String)propertyValueToAssert);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestScheduleResourceProviderTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateRequestSchedule() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  RequestExecutionFactory executionFactory=createNiceMock(RequestExecutionFactory.class);
  RequestExecution requestExecution=createNiceMock(RequestExecution.class);
  ExecutionScheduleManager executionScheduleManager=createNiceMock(ExecutionScheduleManager.class);
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(managementController.getClusters()).andReturn(clusters);
  expect(managementController.getExecutionScheduleManager()).andReturn(executionScheduleManager).anyTimes();
  expect(managementController.getRequestExecutionFactory()).andReturn(executionFactory);
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  Capture<Cluster> clusterCapture=new Capture<Cluster>();
  Capture<Batch> batchCapture=new Capture<Batch>();
  Capture<Schedule> scheduleCapture=new Capture<Schedule>();
  expect(executionFactory.createNew(capture(clusterCapture),capture(batchCapture),capture(scheduleCapture))).andReturn(requestExecution);
  replay(managementController,clusters,cluster,executionFactory,requestExecution,response,executionScheduleManager);
  RequestScheduleResourceProvider resourceProvider=getResourceProvider(managementController);
  Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(RequestScheduleResourceProvider.REQUEST_SCHEDULE_CLUSTER_NAME_PROPERTY_ID,"Cluster100");
  properties.put(RequestScheduleResourceProvider.REQUEST_SCHEDULE_DESC_PROPERTY_ID,"some description");
  properties.put(RequestScheduleResourceProvider.SCHEDULE_DAY_OF_WEEK_PROPERTY_ID,"MON");
  properties.put(RequestScheduleResourceProvider.SCHEDULE_MINUTES_PROPERTY_ID,"2");
  properties.put(RequestScheduleResourceProvider.SCHEDULE_END_TIME_PROPERTY_ID,"2013-11-18T14:29:29-08:00");
  properties.put(RequestScheduleResourceProvider.SCHEDULE_DAYS_OF_MONTH_PROPERTY_ID,"*");
  HashSet<Map<String,Object>> batch=new HashSet<Map<String,Object>>();
  Map<String,Object> batchSettings=new HashMap<String,Object>();
  batchSettings.put(RequestScheduleResourceProvider.REQUEST_SCHEDULE_BATCH_SEPARATION_PROPERTY_ID,"15");
  Map<String,Object> batchRequests=new HashMap<String,Object>();
  HashSet<Map<String,Object>> requestSet=new HashSet<Map<String,Object>>();
  Map<String,Object> request1=new HashMap<String,Object>();
  Map<String,Object> request2=new HashMap<String,Object>();
  request1.put(RequestScheduleResourceProvider.BATCH_REQUEST_TYPE_PROPERTY_ID,BatchRequest.Type.PUT.name());
  request1.put(RequestScheduleResourceProvider.BATCH_REQUEST_ORDER_ID_PROPERTY_ID,"20");
  request1.put(RequestScheduleResourceProvider.BATCH_REQUEST_URI_PROPERTY_ID,"SomeUpdateUri");
  request1.put(RequestScheduleResourceProvider.BATCH_REQUEST_BODY_PROPERTY_ID,"data1");
  request2.put(RequestScheduleResourceProvider.BATCH_REQUEST_TYPE_PROPERTY_ID,BatchRequest.Type.DELETE.name());
  request2.put(RequestScheduleResourceProvider.BATCH_REQUEST_ORDER_ID_PROPERTY_ID,"22");
  request2.put(RequestScheduleResourceProvider.BATCH_REQUEST_URI_PROPERTY_ID,"SomeDeleteUri");
  requestSet.add(request1);
  requestSet.add(request2);
  batchRequests.put(RequestScheduleResourceProvider.REQUEST_SCHEDULE_BATCH_REQUESTS_PROPERTY_ID,requestSet);
  batch.add(batchSettings);
  batch.add(batchRequests);
  properties.put(RequestScheduleResourceProvider.REQUEST_SCHEDULE_BATCH_PROPERTY_ID,batch);
  propertySet.add(properties);
  Request request=PropertyHelper.getCreateRequest(propertySet,null);
  resourceProvider.createResources(request);
  verify(managementController,clusters,cluster,executionFactory,requestExecution,response,executionScheduleManager);
  List<BatchRequest> testRequests=batchCapture.getValue().getBatchRequests();
  Assert.assertNotNull(testRequests);
  BatchRequest deleteReq=null;
  BatchRequest putReq=null;
  for (  BatchRequest testBatchRequest : testRequests) {
    if (testBatchRequest.getType().equals(BatchRequest.Type.DELETE.name())) {
      deleteReq=testBatchRequest;
    }
 else {
      putReq=testBatchRequest;
    }
  }
  Assert.assertNotNull(deleteReq);
  Assert.assertNotNull(putReq);
  Assert.assertEquals("data1",putReq.getBody());
  Assert.assertNull(deleteReq.getBody());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteRequestSchedule() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  RequestExecution requestExecution=createNiceMock(RequestExecution.class);
  ExecutionScheduleManager executionScheduleManager=createNiceMock(ExecutionScheduleManager.class);
  Map<Long,RequestExecution> requestExecutionMap=new HashMap<Long,RequestExecution>();
  requestExecutionMap.put(1L,requestExecution);
  expect(managementController.getAuthName()).andReturn("admin").anyTimes();
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(managementController.getExecutionScheduleManager()).andReturn(executionScheduleManager).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getAllRequestExecutions()).andReturn(requestExecutionMap);
  replay(managementController,clusters,cluster,executionScheduleManager,requestExecution);
  RequestScheduleResourceProvider resourceProvider=getResourceProvider(managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)resourceProvider).addObserver(observer);
  Predicate predicate=new PredicateBuilder().property(RequestScheduleResourceProvider.REQUEST_SCHEDULE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(RequestScheduleResourceProvider.REQUEST_SCHEDULE_ID_PROPERTY_ID).equals(1L).toPredicate();
  resourceProvider.deleteResources(predicate);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  Assert.assertNotNull(lastEvent);
  Assert.assertEquals(Resource.Type.RequestSchedule,lastEvent.getResourceType());
  Assert.assertEquals(ResourceProviderEvent.Type.Delete,lastEvent.getType());
  Assert.assertEquals(predicate,lastEvent.getPredicate());
  Assert.assertNull(lastEvent.getRequest());
  verify(managementController,clusters,cluster,executionScheduleManager,requestExecution);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RequestStatusImplTest </h4><pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequestResource() throws Exception {
  RequestStatusImpl status=new RequestStatusImpl(null);
  Assert.assertNull(status.getRequestResource());
  Resource requestResource=new ResourceImpl(Resource.Type.Request);
  status=new RequestStatusImpl(requestResource);
  Assert.assertEquals(requestResource,status.getRequestResource());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RoleAuthorizationResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  RoleAuthorizationEntity roleAuthorizationEntity=createNiceMock(RoleAuthorizationEntity.class);
  expect(roleAuthorizationEntity.getAuthorizationId()).andReturn("TEST.DO_SOMETHING");
  expect(roleAuthorizationEntity.getAuthorizationName()).andReturn("Do Something");
  List<RoleAuthorizationEntity> authorizationEntities=new ArrayList<RoleAuthorizationEntity>();
  authorizationEntities.add(roleAuthorizationEntity);
  RoleAuthorizationDAO roleAuthorizationDAO=injector.getInstance(RoleAuthorizationDAO.class);
  expect(roleAuthorizationDAO.findAll()).andReturn(authorizationEntities);
  replayAll();
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  RoleAuthorizationResourceProvider provider=new RoleAuthorizationResourceProvider(managementController);
  injector.injectMembers(provider);
  Set<Resource> resources=provider.getResources(PropertyHelper.getReadRequest(),null);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals("TEST.DO_SOMETHING",resource.getPropertyValue(RoleAuthorizationResourceProvider.AUTHORIZATION_ID_PROPERTY_ID));
  Assert.assertEquals("Do Something",resource.getPropertyValue(RoleAuthorizationResourceProvider.AUTHORIZATION_NAME_PROPERTY_ID));
  Assert.assertNull(resource.getPropertyValue(RoleAuthorizationResourceProvider.PERMISSION_ID_PROPERTY_ID));
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.RootServiceComponentResourceProviderTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Resource.Type type=Resource.Type.RootServiceComponent;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<RootServiceComponentResponse> allResponse=new HashSet<RootServiceComponentResponse>();
  allResponse.add(new RootServiceComponentResponse("component1","1.1.1",Collections.<String,String>emptyMap()));
  allResponse.add(new RootServiceComponentResponse("component2","1.1.1",Collections.<String,String>emptyMap()));
  allResponse.add(new RootServiceComponentResponse("component3","1.1.1",Collections.<String,String>emptyMap()));
  allResponse.add(new RootServiceComponentResponse(RootServiceResponseFactory.Components.AMBARI_SERVER.name(),"1.1.1",Collections.<String,String>emptyMap()));
  Set<RootServiceComponentResponse> nameResponse=new HashSet<RootServiceComponentResponse>();
  nameResponse.add(new RootServiceComponentResponse("component4","1.1.1",Collections.<String,String>emptyMap()));
  expect(managementController.getRootServiceComponents(EasyMock.<Set<RootServiceComponentRequest>>anyObject())).andReturn(allResponse).once();
  expect(managementController.getRootServiceComponents(EasyMock.<Set<RootServiceComponentRequest>>anyObject())).andReturn(nameResponse).once();
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(RootServiceComponentResourceProvider.SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.PROPERTIES_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.COMPONENT_VERSION_PROPERTY_ID);
  propertyIds.add(RootServiceComponentResourceProvider.PROPERTIES_SERVER_CLOCK);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String componentName=(String)resource.getPropertyValue(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID);
    String componentVersion=(String)resource.getPropertyValue(RootServiceComponentResourceProvider.COMPONENT_VERSION_PROPERTY_ID);
    Long server_clock=(Long)resource.getPropertyValue(RootServiceComponentResourceProvider.PROPERTIES_SERVER_CLOCK);
    if (componentName.equals(RootServiceResponseFactory.Components.AMBARI_SERVER.name())) {
      Assert.assertNotNull(server_clock);
    }
 else {
      Assert.assertNull(server_clock);
    }
    Assert.assertTrue(allResponse.contains(new RootServiceComponentResponse(componentName,componentVersion,Collections.<String,String>emptyMap())));
  }
  Predicate predicate=new PredicateBuilder().property(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID).equals("component4").toPredicate();
  resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Assert.assertEquals("component4",resources.iterator().next().getPropertyValue(RootServiceComponentResourceProvider.COMPONENT_NAME_PROPERTY_ID));
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ScaleClusterRequestTest </h4><pre class="type-4 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_basic_hostCount() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(Collections.singleton(createScaleClusterPropertiesGroup1_HostCount(CLUSTER_NAME,BLUEPRINT_NAME)));
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"1"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group2Info=hostGroupInfo.get(GROUP2_NAME);
  assertEquals(GROUP2_NAME,group2Info.getHostGroupName());
  assertEquals(0,group2Info.getHostNames().size());
  assertEquals(1,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_basic_hostCount2() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(Collections.singleton(createScaleClusterPropertiesGroup1_HostCount2(CLUSTER_NAME,BLUEPRINT_NAME)));
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"2"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group2Info=hostGroupInfo.get(GROUP3_NAME);
  assertEquals(GROUP3_NAME,group2Info.getHostGroupName());
  assertEquals(0,group2Info.getHostNames().size());
  assertEquals(2,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleHostNames() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  propertySet.add(createScaleClusterPropertiesGroup1_HostName(CLUSTER_NAME,BLUEPRINT_NAME));
  propertySet.add(createScaleClusterPropertiesGroup1_HostName2(CLUSTER_NAME,BLUEPRINT_NAME));
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(propertySet);
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"2"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get(GROUP1_NAME);
  assertEquals(GROUP1_NAME,group1Info.getHostGroupName());
  assertEquals(2,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains(HOST1_NAME));
  assertTrue(group1Info.getHostNames().contains(HOST2_NAME));
  assertEquals(2,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_basic_hostName() throws Exception {
  reset(hostResourceProvider);
  replay(hostResourceProvider);
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(Collections.singleton(createScaleClusterPropertiesGroup1_HostName(CLUSTER_NAME,BLUEPRINT_NAME)));
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"1"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(1,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get(GROUP1_NAME);
  assertEquals(GROUP1_NAME,group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains(HOST1_NAME));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleHostGroups() throws Exception {
  Set<Map<String,Object>> propertySet=new HashSet<Map<String,Object>>();
  propertySet.add(createScaleClusterPropertiesGroup1_HostCountAndPredicate(CLUSTER_NAME,BLUEPRINT_NAME));
  propertySet.add(createScaleClusterPropertiesGroup1_HostCount(CLUSTER_NAME,BLUEPRINT_NAME));
  propertySet.add(createScaleClusterPropertiesGroup1_HostName(CLUSTER_NAME,BLUEPRINT_NAME));
  ScaleClusterRequest scaleClusterRequest=new ScaleClusterRequest(propertySet);
  assertEquals(TopologyRequest.Type.SCALE,scaleClusterRequest.getType());
  assertEquals(String.format("Scale Cluster '%s' (+%s hosts)",CLUSTER_NAME,"3"),scaleClusterRequest.getDescription());
  assertEquals(CLUSTER_NAME,scaleClusterRequest.getClusterName());
  assertSame(blueprint,scaleClusterRequest.getBlueprint());
  Map<String,HostGroupInfo> hostGroupInfo=scaleClusterRequest.getHostGroupInfo();
  assertEquals(3,hostGroupInfo.size());
  assertEquals(0,scaleClusterRequest.getTopologyValidators().size());
  HostGroupInfo group1Info=hostGroupInfo.get(GROUP1_NAME);
  assertEquals(GROUP1_NAME,group1Info.getHostGroupName());
  assertEquals(1,group1Info.getHostNames().size());
  assertTrue(group1Info.getHostNames().contains(HOST1_NAME));
  assertEquals(1,group1Info.getRequestedHostCount());
  assertNull(group1Info.getPredicate());
  HostGroupInfo group2Info=hostGroupInfo.get(GROUP2_NAME);
  assertEquals(GROUP2_NAME,group2Info.getHostGroupName());
  assertEquals(0,group2Info.getHostNames().size());
  assertEquals(1,group2Info.getRequestedHostCount());
  assertNull(group2Info.getPredicate());
  HostGroupInfo group3Info=hostGroupInfo.get(GROUP3_NAME);
  assertEquals(GROUP3_NAME,group3Info.getHostGroupName());
  assertEquals(0,group3Info.getHostNames().size());
  assertEquals(1,group3Info.getRequestedHostCount());
  assertEquals(PREDICATE,group3Info.getPredicateString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ServiceResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResourcesBadServiceState() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
  String serviceName="Service100";
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster("Cluster100")).andReturn(cluster).anyTimes();
  expect(cluster.getClusterId()).andReturn(2L).anyTimes();
  expect(cluster.getService(serviceName)).andReturn(service).anyTimes();
  expect(service.getDesiredState()).andReturn(State.STARTED).anyTimes();
  expect(service.getName()).andReturn(serviceName).anyTimes();
  expect(service.getServiceComponents()).andReturn(new HashMap<String,ServiceComponent>());
  expect(service.getCluster()).andReturn(cluster);
  cluster.deleteService(serviceName);
  replay(managementController,clusters,cluster,service);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=getServiceProvider(managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  Predicate predicate=new PredicateBuilder().property(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID).equals("Cluster100").and().property(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals(serviceName).toPredicate();
  provider.deleteResources(predicate);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  Assert.assertNotNull(lastEvent);
  Assert.assertEquals(Resource.Type.Service,lastEvent.getResourceType());
  Assert.assertEquals(ResourceProviderEvent.Type.Delete,lastEvent.getType());
  Assert.assertEquals(predicate,lastEvent.getPredicate());
  Assert.assertNull(lastEvent.getRequest());
  verify(managementController,clusters,cluster,service);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteResourcesStoppedComponentState() throws Exception {
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Clusters clusters=createNiceMock(Clusters.class);
  Cluster cluster=createNiceMock(Cluster.class);
  Service service=createNiceMock(Service.class);
class TestComponent {
    public String Name;
    public ServiceComponent Component;
    public State DesiredState;
    public TestComponent(    String name,    ServiceComponent component,    State desiredState){
      Name=name;
      Component=component;
      DesiredState=desiredState;
    }
  }
  TestComponent component1=new TestComponent("Component100",createNiceMock(ServiceComponent.class),State.INSTALLED);
  TestComponent component2=new TestComponent("Component101",createNiceMock(ServiceComponent.class),State.INSTALLED);
  TestComponent component3=new TestComponent("Component102",createNiceMock(ServiceComponent.class),State.INSTALLED);
  Map<String,ServiceComponent> scMap=new HashMap<String,ServiceComponent>();
  scMap.put(component1.Name,component1.Component);
  scMap.put(component2.Name,component2.Component);
  scMap.put(component3.Name,component3.Component);
  String clusterName="Cluster100";
  String serviceName="Service100";
  expect(managementController.getClusters()).andReturn(clusters).anyTimes();
  expect(clusters.getCluster(clusterName)).andReturn(cluster).anyTimes();
  expect(cluster.getService(serviceName)).andReturn(service).anyTimes();
  expect(service.getDesiredState()).andReturn(State.STARTED).anyTimes();
  expect(service.getName()).andReturn(serviceName).anyTimes();
  expect(service.getServiceComponents()).andReturn(scMap).anyTimes();
  expect(component1.Component.getDesiredState()).andReturn(component1.DesiredState).anyTimes();
  expect(component2.Component.getDesiredState()).andReturn(component2.DesiredState).anyTimes();
  expect(component3.Component.getDesiredState()).andReturn(component3.DesiredState).anyTimes();
  expect(component1.Component.canBeRemoved()).andReturn(component1.DesiredState.isRemovableState()).anyTimes();
  expect(component2.Component.canBeRemoved()).andReturn(component2.DesiredState.isRemovableState()).anyTimes();
  expect(component3.Component.canBeRemoved()).andReturn(component3.DesiredState.isRemovableState()).anyTimes();
  expect(service.getCluster()).andReturn(cluster);
  cluster.deleteService(serviceName);
  replay(managementController,clusters,cluster,service,component1.Component,component2.Component,component3.Component);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  ResourceProvider provider=getServiceProvider(managementController);
  AbstractResourceProviderTest.TestObserver observer=new AbstractResourceProviderTest.TestObserver();
  ((ObservableResourceProvider)provider).addObserver(observer);
  Predicate predicate=new PredicateBuilder().property(ServiceResourceProvider.SERVICE_CLUSTER_NAME_PROPERTY_ID).equals(clusterName).and().property(ServiceResourceProvider.SERVICE_SERVICE_NAME_PROPERTY_ID).equals(serviceName).toPredicate();
  provider.deleteResources(predicate);
  ResourceProviderEvent lastEvent=observer.getLastEvent();
  Assert.assertNotNull(lastEvent);
  Assert.assertEquals(Resource.Type.Service,lastEvent.getResourceType());
  Assert.assertEquals(ResourceProviderEvent.Type.Delete,lastEvent.getType());
  Assert.assertEquals(predicate,lastEvent.getPredicate());
  Assert.assertNull(lastEvent.getRequest());
  verify(managementController,clusters,cluster,service,component1.Component,component2.Component,component3.Component);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackAdvisorResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCalculateConfigurations() throws Exception {
  Map<Resource.Type,String> keyPropertyIds=Collections.emptyMap();
  Set<String> propertyIds=Collections.emptySet();
  AmbariManagementController ambariManagementController=mock(AmbariManagementController.class);
  RecommendationResourceProvider provider=new RecommendationResourceProvider(propertyIds,keyPropertyIds,ambariManagementController);
  Request request=mock(Request.class);
  Set<Map<String,Object>> propertiesSet=new HashSet<Map<String,Object>>();
  Map<String,Object> propertiesMap=new HashMap<String,Object>();
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/string_prop","string");
  List array=new ArrayList();
  array.add("array1");
  array.add("array2");
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/array_prop",array);
  propertiesSet.add(propertiesMap);
  doReturn(propertiesSet).when(request).getProperties();
  Map<String,Map<String,Map<String,String>>> calculatedConfigurations=provider.calculateConfigurations(request);
  assertNotNull(calculatedConfigurations);
  assertEquals(1,calculatedConfigurations.size());
  Map<String,Map<String,String>> site=calculatedConfigurations.get("site");
  assertNotNull(site);
  assertEquals(1,site.size());
  Map<String,String> properties=site.get("properties");
  assertNotNull(properties);
  assertEquals(2,properties.size());
  assertEquals("string",properties.get("string_prop"));
  assertEquals("[array1, array2]",properties.get("array_prop"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCalculateConfigurationsWithNullPropertyValues() throws Exception {
  Map<Resource.Type,String> keyPropertyIds=Collections.emptyMap();
  Set<String> propertyIds=Collections.emptySet();
  AmbariManagementController ambariManagementController=mock(AmbariManagementController.class);
  RecommendationResourceProvider provider=new RecommendationResourceProvider(propertyIds,keyPropertyIds,ambariManagementController);
  Request request=mock(Request.class);
  Set<Map<String,Object>> propertiesSet=new HashSet<Map<String,Object>>();
  Map<String,Object> propertiesMap=new HashMap<String,Object>();
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/string_prop",null);
  List array=new ArrayList();
  array.add("array1");
  array.add("array2");
  propertiesMap.put(CONFIGURATIONS_PROPERTY_ID + "site/properties/array_prop",array);
  propertiesSet.add(propertiesMap);
  doReturn(propertiesSet).when(request).getProperties();
  Map<String,Map<String,Map<String,String>>> calculatedConfigurations=provider.calculateConfigurations(request);
  assertNotNull(calculatedConfigurations);
  assertEquals(1,calculatedConfigurations.size());
  Map<String,Map<String,String>> site=calculatedConfigurations.get("site");
  assertNotNull(site);
  assertEquals(1,site.size());
  Map<String,String> properties=site.get("properties");
  assertNotNull(properties);
  assertEquals("[array1, array2]",properties.get("array_prop"));
  assertFalse(properties.containsKey("string_prop"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackArtifactResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testGetWidgetDescriptorForService() throws Exception {
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  expect(managementController.getAmbariMetaInfo()).andReturn(metaInfo).anyTimes();
  replay(managementController);
  StackArtifactResourceProvider resourceProvider=getStackArtifactResourceProvider(managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ARTIFACT_NAME_PROPERTY_ID);
  propertyIds.add(STACK_NAME_PROPERTY_ID);
  propertyIds.add(STACK_VERSION_PROPERTY_ID);
  propertyIds.add(STACK_SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(ARTIFACT_DATA_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(ARTIFACT_NAME_PROPERTY_ID).equals("widgets_descriptor").and().property(STACK_NAME_PROPERTY_ID).equals("OTHER").and().property(STACK_VERSION_PROPERTY_ID).equals("2.0").and().property(STACK_SERVICE_NAME_PROPERTY_ID).equals("HBASE").toPredicate();
  Set<Resource> resources=resourceProvider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Map<String,Map<String,Object>> propertyMap=resource.getPropertiesMap();
  Map<String,Object> descriptor=propertyMap.get(ARTIFACT_DATA_PROPERTY_ID);
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(1,((List)descriptor.get("layouts")).size());
  WidgetLayout layout=((List<WidgetLayout>)descriptor.get("layouts")).iterator().next();
  Assert.assertEquals("default_hbase_layout",layout.getLayoutName());
  Assert.assertEquals("HBASE_SUMMARY",layout.getSectionName());
  Assert.assertEquals(5,layout.getWidgetLayoutInfoList().size());
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMetricsDescriptorForService() throws Exception {
  AmbariManagementController managementController=createNiceMock(AmbariManagementController.class);
  expect(managementController.getAmbariMetaInfo()).andReturn(metaInfo).anyTimes();
  replay(managementController);
  StackArtifactResourceProvider resourceProvider=getStackArtifactResourceProvider(managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ARTIFACT_NAME_PROPERTY_ID);
  propertyIds.add(STACK_NAME_PROPERTY_ID);
  propertyIds.add(STACK_VERSION_PROPERTY_ID);
  propertyIds.add(STACK_SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(ARTIFACT_DATA_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Predicate predicate=new PredicateBuilder().property(ARTIFACT_NAME_PROPERTY_ID).equals("metrics_descriptor").and().property(STACK_NAME_PROPERTY_ID).equals("OTHER").and().property(STACK_VERSION_PROPERTY_ID).equals("1.0").and().property(STACK_SERVICE_NAME_PROPERTY_ID).equals("HDFS").toPredicate();
  Set<Resource> resources=resourceProvider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Map<String,Map<String,Object>> propertyMap=resource.getPropertiesMap();
  Map<String,Object> descriptor=propertyMap.get(ARTIFACT_DATA_PROPERTY_ID + "/HDFS/DATANODE");
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(1,((ArrayList)descriptor.get("Component")).size());
  MetricDefinition md=(MetricDefinition)((ArrayList)descriptor.get("Component")).iterator().next();
  Metric m1=md.getMetrics().get("metrics/dfs/datanode/heartBeats_avg_time");
  Metric m2=md.getMetrics().get("metrics/rpc/closeRegion_num_ops");
  Assert.assertEquals(326,md.getMetrics().size());
  Assert.assertTrue(m1.isAmsHostMetric());
  Assert.assertEquals("unitless",m1.getUnit());
  Assert.assertFalse(m2.isAmsHostMetric());
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackConfigurationResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put("final","true");
  Resource.Type type=Resource.Type.StackConfiguration;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  Set<StackConfigurationResponse> allResponse=new HashSet<StackConfigurationResponse>();
  allResponse.add(new StackConfigurationResponse(PROPERTY_NAME,PROPERTY_VALUE,PROPERTY_DESC,TYPE,attributes));
  expect(managementController.getStackConfigurations(AbstractResourceProviderTest.Matcher.getStackConfigurationRequestSet(null,null,null,null))).andReturn(allResponse).times(1);
  replay(managementController);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(StackConfigurationResourceProvider.STACK_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.STACK_VERSION_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.SERVICE_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
  propertyIds.add(StackConfigurationResourceProvider.PROPERTY_DEPENDS_ON_PROPERTY_ID);
  Request request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=provider.getResources(request,null);
  Assert.assertEquals(allResponse.size(),resources.size());
  for (  Resource resource : resources) {
    String propertyName=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_NAME_PROPERTY_ID);
    String propertyValue=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_VALUE_PROPERTY_ID);
    String propertyDesc=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_DESCRIPTION_PROPERTY_ID);
    String propertyType=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_TYPE_PROPERTY_ID);
    String propertyIsFinal=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_FINAL_PROPERTY_ID);
    String propertyDependencies=(String)resource.getPropertyValue(StackConfigurationResourceProvider.PROPERTY_DEPENDS_ON_PROPERTY_ID);
    Assert.assertEquals(PROPERTY_NAME,propertyName);
    Assert.assertEquals(PROPERTY_VALUE,propertyValue);
    Assert.assertEquals(PROPERTY_DESC,propertyDesc);
    Assert.assertEquals(TYPE,propertyType);
    Assert.assertEquals("true",propertyIsFinal);
    Assert.assertNull(propertyDependencies);
  }
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StackTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequiredProperties_serviceAndPropertyType() throws Exception {
  AmbariManagementController controller=createNiceMock(AmbariManagementController.class);
  AmbariMetaInfo metaInfo=createNiceMock(AmbariMetaInfo.class);
  Capture<Set<StackServiceRequest>> stackServiceRequestCapture=new Capture<Set<StackServiceRequest>>();
  StackServiceResponse stackServiceResponse=createNiceMock(StackServiceResponse.class);
  Capture<Set<StackServiceComponentRequest>> stackComponentRequestCapture=new Capture<Set<StackServiceComponentRequest>>();
  StackServiceComponentResponse stackComponentResponse=createNiceMock(StackServiceComponentResponse.class);
  Capture<Set<StackConfigurationRequest>> stackConfigurationRequestCapture=new Capture<Set<StackConfigurationRequest>>();
  Capture<Set<StackLevelConfigurationRequest>> stackLevelConfigurationRequestCapture=new Capture<Set<StackLevelConfigurationRequest>>();
  StackConfigurationResponse stackConfigurationResponse=EasyMock.createNiceMock(StackConfigurationResponse.class);
  StackConfigurationResponse stackConfigurationResponse2=EasyMock.createNiceMock(StackConfigurationResponse.class);
  expect(controller.getStackServices(capture(stackServiceRequestCapture))).andReturn(Collections.singleton(stackServiceResponse)).anyTimes();
  expect(controller.getAmbariMetaInfo()).andReturn(metaInfo).anyTimes();
  expect(stackServiceResponse.getServiceName()).andReturn("service1").anyTimes();
  expect(stackServiceResponse.getExcludedConfigTypes()).andReturn(Collections.<String>emptySet());
  expect(controller.getStackComponents(capture(stackComponentRequestCapture))).andReturn(Collections.singleton(stackComponentResponse)).anyTimes();
  expect(stackComponentResponse.getComponentName()).andReturn("component1").anyTimes();
  expect(stackComponentResponse.getComponentCategory()).andReturn("test-site.xml").anyTimes();
  expect(controller.getStackConfigurations(capture(stackConfigurationRequestCapture))).andReturn(new HashSet<StackConfigurationResponse>(Arrays.asList(stackConfigurationResponse,stackConfigurationResponse2))).anyTimes();
  expect(controller.getStackLevelConfigurations(capture(stackLevelConfigurationRequestCapture))).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  expect(stackConfigurationResponse.getPropertyName()).andReturn("prop1").anyTimes();
  expect(stackConfigurationResponse.getPropertyValue()).andReturn(null).anyTimes();
  expect(stackConfigurationResponse.getType()).andReturn("test-site.xml").anyTimes();
  expect(stackConfigurationResponse.getPropertyType()).andReturn(Collections.singleton(PropertyInfo.PropertyType.PASSWORD)).anyTimes();
  expect(stackConfigurationResponse.getPropertyAttributes()).andReturn(Collections.<String,String>emptyMap()).anyTimes();
  expect(stackConfigurationResponse.isRequired()).andReturn(true).anyTimes();
  expect(stackConfigurationResponse2.getPropertyName()).andReturn("prop2").anyTimes();
  expect(stackConfigurationResponse2.getPropertyValue()).andReturn(null).anyTimes();
  expect(stackConfigurationResponse2.getType()).andReturn("test-site.xml").anyTimes();
  expect(stackConfigurationResponse2.getPropertyType()).andReturn(Collections.singleton(PropertyInfo.PropertyType.USER)).anyTimes();
  expect(stackConfigurationResponse2.getPropertyAttributes()).andReturn(Collections.<String,String>emptyMap()).anyTimes();
  expect(stackConfigurationResponse2.isRequired()).andReturn(true).anyTimes();
  expect(metaInfo.getComponentDependencies("test","1.0","service1","component1")).andReturn(Collections.<DependencyInfo>emptyList()).anyTimes();
  replay(controller,stackServiceResponse,stackComponentResponse,stackConfigurationResponse,stackConfigurationResponse2,metaInfo);
  Stack stack=new Stack("test","1.0",controller);
  Collection<Stack.ConfigProperty> requiredPasswordProperties=stack.getRequiredConfigurationProperties("service1",PropertyInfo.PropertyType.PASSWORD);
  assertEquals(1,requiredPasswordProperties.size());
  Stack.ConfigProperty requiredPasswordConfigProperty=requiredPasswordProperties.iterator().next();
  assertEquals("test-site",requiredPasswordConfigProperty.getType());
  assertEquals("prop1",requiredPasswordConfigProperty.getName());
  assertTrue(requiredPasswordConfigProperty.getPropertyTypes().contains(PropertyInfo.PropertyType.PASSWORD));
  StackServiceRequest stackServiceRequest=stackServiceRequestCapture.getValue().iterator().next();
  assertEquals("test",stackServiceRequest.getStackName());
  assertEquals("1.0",stackServiceRequest.getStackVersion());
  StackServiceComponentRequest stackComponentRequest=stackComponentRequestCapture.getValue().iterator().next();
  assertEquals("service1",stackComponentRequest.getServiceName());
  assertEquals("test",stackComponentRequest.getStackName());
  assertEquals("1.0",stackComponentRequest.getStackVersion());
  assertNull(stackComponentRequest.getComponentName());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTestXmlExtensionStrippedOff() throws Exception {
  AmbariManagementController controller=createNiceMock(AmbariManagementController.class);
  AmbariMetaInfo metaInfo=createNiceMock(AmbariMetaInfo.class);
  Capture<Set<StackServiceRequest>> stackServiceRequestCapture=new Capture<Set<StackServiceRequest>>();
  StackServiceResponse stackServiceResponse=createNiceMock(StackServiceResponse.class);
  Capture<Set<StackServiceComponentRequest>> stackComponentRequestCapture=new Capture<Set<StackServiceComponentRequest>>();
  StackServiceComponentResponse stackComponentResponse=createNiceMock(StackServiceComponentResponse.class);
  Capture<Set<StackConfigurationRequest>> stackConfigurationRequestCapture=new Capture<Set<StackConfigurationRequest>>();
  Capture<Set<StackLevelConfigurationRequest>> stackLevelConfigurationRequestCapture=new Capture<Set<StackLevelConfigurationRequest>>();
  StackConfigurationResponse stackConfigurationResponse=EasyMock.createNiceMock(StackConfigurationResponse.class);
  expect(controller.getStackServices(capture(stackServiceRequestCapture))).andReturn(Collections.singleton(stackServiceResponse)).anyTimes();
  expect(controller.getAmbariMetaInfo()).andReturn(metaInfo).anyTimes();
  expect(stackServiceResponse.getServiceName()).andReturn("service1").anyTimes();
  expect(stackServiceResponse.getExcludedConfigTypes()).andReturn(Collections.<String>emptySet());
  expect(controller.getStackComponents(capture(stackComponentRequestCapture))).andReturn(Collections.singleton(stackComponentResponse)).anyTimes();
  expect(stackComponentResponse.getComponentName()).andReturn("component1").anyTimes();
  expect(stackComponentResponse.getComponentCategory()).andReturn("test-site.xml").anyTimes();
  expect(controller.getStackConfigurations(capture(stackConfigurationRequestCapture))).andReturn(Collections.singleton(stackConfigurationResponse)).anyTimes();
  expect(controller.getStackLevelConfigurations(capture(stackLevelConfigurationRequestCapture))).andReturn(Collections.<StackConfigurationResponse>emptySet()).anyTimes();
  expect(stackConfigurationResponse.getPropertyName()).andReturn("prop1").anyTimes();
  expect(stackConfigurationResponse.getPropertyValue()).andReturn("prop1Val").anyTimes();
  expect(stackConfigurationResponse.getType()).andReturn("test-site.xml").anyTimes();
  expect(stackConfigurationResponse.getPropertyType()).andReturn(Collections.<org.apache.ambari.server.state.PropertyInfo.PropertyType>emptySet()).anyTimes();
  expect(stackConfigurationResponse.getPropertyAttributes()).andReturn(Collections.<String,String>emptyMap()).anyTimes();
  expect(stackConfigurationResponse.isRequired()).andReturn(true).anyTimes();
  expect(metaInfo.getComponentDependencies("test","1.0","service1","component1")).andReturn(Collections.<DependencyInfo>emptyList()).anyTimes();
  replay(controller,stackServiceResponse,stackComponentResponse,stackConfigurationResponse,metaInfo);
  Stack stack=new Stack("test","1.0",controller);
  Configuration configuration=stack.getConfiguration(Collections.singleton("service1"));
  assertEquals("prop1Val",configuration.getProperties().get("test-site").get("prop1"));
  assertEquals("test-site",stack.getRequiredConfigurationProperties("service1").iterator().next().getType());
  StackServiceRequest stackServiceRequest=stackServiceRequestCapture.getValue().iterator().next();
  assertEquals("test",stackServiceRequest.getStackName());
  assertEquals("1.0",stackServiceRequest.getStackVersion());
  StackServiceComponentRequest stackComponentRequest=stackComponentRequestCapture.getValue().iterator().next();
  assertEquals("service1",stackComponentRequest.getServiceName());
  assertEquals("test",stackComponentRequest.getStackName());
  assertEquals("1.0",stackComponentRequest.getStackVersion());
  assertNull(stackComponentRequest.getComponentName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.StageResourceProviderTest </h4><pre class="type-7 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void before(){
  dao=createStrictMock(StageDAO.class);
  clusters=createStrictMock(Clusters.class);
  cluster=createStrictMock(Cluster.class);
  hrcDao=createStrictMock(HostRoleCommandDAO.class);
  topologyManager=EasyMock.createNiceMock(TopologyManager.class);
  expect(topologyManager.getStages()).andReturn(new ArrayList<StageEntity>()).anyTimes();
  expect(hrcDao.findAggregateCounts(EasyMock.anyObject(Long.class))).andReturn(new HashMap<Long,HostRoleCommandStatusSummaryDTO>(){
{
      put(0L,new HostRoleCommandStatusSummaryDTO(0,1000L,2500L,0,0,1,0,0,0,0,0,0,0,0,0));
    }
  }
).anyTimes();
  replay(hrcDao,topologyManager);
  managementController=createNiceMock(AmbariManagementController.class);
  injector=Guice.createInjector(Modules.override(new InMemoryDefaultTestModule()).with(new MockModule()));
  Assert.assertNotNull(injector);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.TaskResourceProviderTest </h4><pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testInvalidStructuredOutput(){
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  TaskResourceProvider taskResourceProvider=new TaskResourceProvider(PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  replay(managementController);
  Map<?,?> result=taskResourceProvider.parseStructuredOutput(null);
  Assert.assertNull(result);
  result=taskResourceProvider.parseStructuredOutput("This is some bad JSON");
  Assert.assertNull(result);
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseStructuredOutput(){
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  TaskResourceProvider taskResourceProvider=new TaskResourceProvider(PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  replay(managementController);
  Map<?,?> result=taskResourceProvider.parseStructuredOutput("{\"a\":\"b\", \"c\": {\"d\":\"e\",\"f\": [\"g\",\"h\"],\"i\": {\"k\":\"l\"}}}");
  assertEquals(result.size(),2);
  Map<?,?> submap=(Map<?,?>)result.get("c");
  assertEquals(submap.size(),3);
  List sublist=(List)submap.get("f");
  assertEquals(sublist.size(),2);
  Map<?,?> subsubmap=(Map<?,?>)submap.get("i");
  assertEquals(subsubmap.size(),1);
  assertEquals(subsubmap.get("k"),"l");
  result=taskResourceProvider.parseStructuredOutput("{\"a\": invalid JSON}");
  assertNull(result);
  result=taskResourceProvider.parseStructuredOutput("{\"a\": 5}");
  assertEquals(result.get("a"),5);
  verify(managementController);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseStructuredOutputForHostCheck(){
  Resource.Type type=Resource.Type.Task;
  AmbariManagementController managementController=createMock(AmbariManagementController.class);
  TaskResourceProvider taskResourceProvider=new TaskResourceProvider(PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  replay(managementController);
  Map<?,?> result=taskResourceProvider.parseStructuredOutput("{\"host_resolution_check\": {\"failures\": [{\"cause\": [-2, \"Name or service not known\"], \"host\": \"foobar\", \"type\": \"FORWARD_LOOKUP\"}], \"message\": \"There were 1 host(s) that could not resolve to an IP address.\", \"failed_count\": 1, \"success_count\": 3, \"exit_code\": 0}}");
  Assert.assertNotNull(result);
  Map<?,?> host_resolution_check=(Map<?,?>)result.get("host_resolution_check");
  assertEquals(host_resolution_check.get("success_count"),3);
  assertEquals(host_resolution_check.get("failed_count"),1);
  verify(managementController);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.UpgradeResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that retrieving an upgrade correctly populates less common upgrade
 * options correctly.
 */
@Test public void testGetResourcesWithSpecialOptions() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(0,upgrades.size());
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.1.1.1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  RequestStatus status=upgradeResourceProvider.createResources(request);
  assertNotNull(status);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("Upgrade");
  Predicate predicate=new PredicateBuilder().property(UpgradeResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  Set<Resource> resources=upgradeResourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  assertEquals(true,resource.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES));
  assertEquals(true,resource.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES));
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeToBase() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  Map<String,Object> requestProps=new HashMap<>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.1.1.1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  requestProps=new HashMap<>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  try {
    upgradeResourceProvider.createResources(request);
    Assert.fail("Expected an exception going downgrade with no upgrade pack");
  }
 catch (  Exception e) {
  }
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.0.0");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_FROM_VERSION,"2.1.1.0");
  Map<String,String> requestInfoProperties=new HashMap<>();
  requestInfoProperties.put(UpgradeResourceDefinition.DOWNGRADE_DIRECTIVE,"true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProperties);
  RequestStatus status=upgradeResourceProvider.createResources(request);
  assertEquals(1,status.getAssociatedResources().size());
  Resource r=status.getAssociatedResources().iterator().next();
  String id=r.getPropertyValue("Upgrade/request_id").toString();
  UpgradeEntity entity=upgradeDao.findUpgrade(Long.parseLong(id));
  assertNotNull(entity);
  assertEquals("2.1.1",entity.getFromVersion());
  assertEquals("2.2.0.0",entity.getToVersion());
  assertEquals(Direction.DOWNGRADE,entity.getDirection());
  StageDAO dao=injector.getInstance(StageDAO.class);
  List<StageEntity> stages=dao.findByRequestId(entity.getRequestId());
  Gson gson=new Gson();
  for (  StageEntity se : stages) {
    Map<String,String> map=gson.fromJson(se.getCommandParamsStage(),Map.class);
    assertTrue(map.containsKey("upgrade_direction"));
    assertEquals("downgrade",map.get("upgrade_direction"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreatePartialDowngrade() throws Exception {
  clusters.addHost("h2");
  Host host=clusters.getHost("h2");
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","6.3");
  host.setHostAttributes(hostAttributes);
  host.persist();
  clusters.mapHostToCluster("h2","c1");
  Cluster cluster=clusters.getCluster("c1");
  Service service=cluster.getService("ZOOKEEPER");
  ServiceComponent component=service.getServiceComponent("ZOOKEEPER_SERVER");
  ServiceComponentHost sch=component.addServiceComponentHost("h2");
  sch.setVersion("2.2.2.2");
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(0,upgrades.size());
  UpgradeEntity upgradeEntity=new UpgradeEntity();
  upgradeEntity.setClusterId(cluster.getClusterId());
  upgradeEntity.setDirection(Direction.UPGRADE);
  upgradeEntity.setFromVersion("2.1.1.1");
  upgradeEntity.setToVersion("2.2.2.2");
  upgradeEntity.setUpgradePackage("upgrade_test");
  upgradeEntity.setUpgradeType(UpgradeType.ROLLING);
  upgradeEntity.setRequestId(1L);
  upgradeDao.create(upgradeEntity);
  upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity lastUpgrade=upgradeDao.findLastUpgradeForCluster(cluster.getClusterId());
  assertNotNull(lastUpgrade);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.1.1.1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_test");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  Map<String,String> requestInfoProperties=new HashMap<String,String>();
  requestInfoProperties.put(UpgradeResourceDefinition.DOWNGRADE_DIRECTIVE,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProperties);
  upgradeResourceProvider.createResources(request);
  upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(2,upgrades.size());
  UpgradeEntity downgrade=upgrades.get(1);
  assertEquals(cluster.getClusterId(),downgrade.getClusterId().longValue());
  List<UpgradeGroupEntity> upgradeGroups=downgrade.getUpgradeGroups();
  assertEquals(3,upgradeGroups.size());
  UpgradeGroupEntity group=upgradeGroups.get(1);
  assertEquals("ZOOKEEPER",group.getName());
  assertEquals(4,group.getItems().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectionUpgrade() throws Exception {
  Cluster cluster=clusters.getCluster("c1");
  StackEntity stackEntity=stackDAO.find("HDP","2.1.1");
  RepositoryVersionEntity repoVersionEntity=new RepositoryVersionEntity();
  repoVersionEntity.setDisplayName("My New Version 3");
  repoVersionEntity.setOperatingSystems("");
  repoVersionEntity.setStack(stackEntity);
  repoVersionEntity.setVersion("2.2.2.3");
  repoVersionDao.create(repoVersionEntity);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2.2.3");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_direction");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  upgradeResourceProvider.createResources(request);
  List<UpgradeEntity> upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(1,upgrades.size());
  UpgradeEntity upgrade=upgrades.get(0);
  Long id=upgrade.getRequestId();
  assertEquals(3,upgrade.getUpgradeGroups().size());
  UpgradeGroupEntity group=upgrade.getUpgradeGroups().get(2);
  Assert.assertEquals("POST_CLUSTER",group.getName());
  Assert.assertTrue(!group.getItems().isEmpty());
  for (  UpgradeItemEntity item : group.getItems()) {
    Assert.assertFalse(item.getText().toLowerCase().contains("downgrade"));
  }
  requestProps.clear();
  requestProps.put(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME,"c1");
  requestProps.put(UpgradeResourceProvider.UPGRADE_VERSION,"2.2");
  requestProps.put(UpgradeResourceProvider.UPGRADE_PACK,"upgrade_direction");
  requestProps.put(UpgradeResourceProvider.UPGRADE_SKIP_PREREQUISITE_CHECKS,"true");
  requestProps.put(UpgradeResourceProvider.UPGRADE_FROM_VERSION,"2.2.2.3");
  Map<String,String> requestInfoProps=new HashMap<String,String>();
  requestInfoProps.put("downgrade","true");
  request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),requestInfoProps);
  upgradeResourceProvider.createResources(request);
  upgrades=upgradeDao.findUpgrades(cluster.getClusterId());
  assertEquals(2,upgrades.size());
  upgrade=null;
  for (  UpgradeEntity u : upgrades) {
    if (!u.getRequestId().equals(id)) {
      upgrade=u;
    }
  }
  assertNotNull(upgrade);
  assertEquals("Downgrade groups reduced from 3 to 2",2,upgrade.getUpgradeGroups().size());
  group=upgrade.getUpgradeGroups().get(1);
  assertEquals("Execution items increased from 1 to 2",2,group.getItems().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbort() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,id.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_STATUS,"ABORTED");
  UpgradeResourceProvider urp=createProvider(amc);
  Request req=PropertyHelper.getUpdateRequest(requestProps,null);
  urp.updateResources(req,null);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetry() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,id.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_STATUS,"ABORTED");
  UpgradeResourceProvider urp=createProvider(amc);
  Request req=PropertyHelper.getUpdateRequest(requestProps,null);
  urp.updateResources(req,null);
  ActionManager am=injector.getInstance(ActionManager.class);
  List<HostRoleCommand> commands=am.getRequestTasks(id);
  boolean foundOne=false;
  for (  HostRoleCommand hrc : commands) {
    if (hrc.getRole().equals(Role.AMBARI_SERVER_ACTION)) {
      assertEquals(-1L,hrc.getHostId());
      assertNull(hrc.getHostName());
      foundOne=true;
    }
  }
  assertTrue("Expected at least one server-side action",foundOne);
  HostRoleCommand cmd=commands.get(commands.size() - 1);
  HostRoleCommandDAO dao=injector.getInstance(HostRoleCommandDAO.class);
  HostRoleCommandEntity entity=dao.findByPK(cmd.getTaskId());
  entity.setStatus(HostRoleStatus.ABORTED);
  dao.merge(entity);
  requestProps=new HashMap<String,Object>();
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_ID,id.toString());
  requestProps.put(UpgradeResourceProvider.UPGRADE_REQUEST_STATUS,"PENDING");
  req=PropertyHelper.getUpdateRequest(requestProps,null);
  urp.updateResources(req,null);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPercents() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  StageDAO stageDao=injector.getInstance(StageDAO.class);
  HostRoleCommandDAO hrcDao=injector.getInstance(HostRoleCommandDAO.class);
  List<StageEntity> stages=stageDao.findByRequestId(id);
  List<HostRoleCommandEntity> tasks=hrcDao.findByRequest(id);
  Set<Long> stageIds=new HashSet<Long>();
  for (  StageEntity se : stages) {
    stageIds.add(se.getStageId());
  }
  CalculatedStatus calc=null;
  int i=0;
  for (  HostRoleCommandEntity hrce : tasks) {
    hrce.setStatus(HostRoleStatus.IN_PROGRESS);
    hrcDao.merge(hrce);
    calc=CalculatedStatus.statusFromStageSummary(hrcDao.findAggregateCounts(id),stageIds);
    assertEquals(((i++) + 1) * 4.375d,calc.getPercent(),0.01d);
    assertEquals(HostRoleStatus.IN_PROGRESS,calc.getStatus());
  }
  i=0;
  for (  HostRoleCommandEntity hrce : tasks) {
    hrce.setStatus(HostRoleStatus.COMPLETED);
    hrcDao.merge(hrce);
    calc=CalculatedStatus.statusFromStageSummary(hrcDao.findAggregateCounts(id),stageIds);
    assertEquals(35 + (((i++) + 1) * 8.125),calc.getPercent(),0.01d);
    if (i < 8) {
      assertEquals(HostRoleStatus.IN_PROGRESS,calc.getStatus());
    }
  }
  calc=CalculatedStatus.statusFromStageSummary(hrcDao.findAggregateCounts(id),stageIds);
  assertEquals(HostRoleStatus.COMPLETED,calc.getStatus());
  assertEquals(100d,calc.getPercent(),0.01d);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  RequestStatus status=testCreateResources();
  Set<Resource> createdResources=status.getAssociatedResources();
  assertEquals(1,createdResources.size());
  Resource res=createdResources.iterator().next();
  Long id=(Long)res.getPropertyValue("Upgrade/request_id");
  assertNotNull(id);
  assertEquals(Long.valueOf(1),id);
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add("Upgrade");
  Predicate predicate=new PredicateBuilder().property(UpgradeResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  Request request=PropertyHelper.getReadRequest(propertyIds);
  ResourceProvider upgradeResourceProvider=createProvider(amc);
  Set<Resource> resources=upgradeResourceProvider.getResources(request,predicate);
  assertEquals(1,resources.size());
  res=resources.iterator().next();
  assertNotNull(res.getPropertyValue("Upgrade/progress_percent"));
  assertNotNull(res.getPropertyValue(UpgradeResourceProvider.UPGRADE_DIRECTION));
  assertEquals(Direction.UPGRADE,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_DIRECTION));
  assertEquals(false,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_FAILURES));
  assertEquals(false,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_SKIP_SC_FAILURES));
  assertEquals(UpgradeType.ROLLING,res.getPropertyValue(UpgradeResourceProvider.UPGRADE_TYPE));
  propertyIds.clear();
  propertyIds.add("UpgradeGroup");
  predicate=new PredicateBuilder().property(UpgradeGroupResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeGroupResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  ResourceProvider upgradeGroupResourceProvider=new UpgradeGroupResourceProvider(amc);
  resources=upgradeGroupResourceProvider.getResources(request,predicate);
  assertEquals(3,resources.size());
  res=resources.iterator().next();
  assertNotNull(res.getPropertyValue("UpgradeGroup/status"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/group_id"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/total_task_count"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/in_progress_task_count"));
  assertNotNull(res.getPropertyValue("UpgradeGroup/completed_task_count"));
  propertyIds.clear();
  propertyIds.add("UpgradeItem");
  predicate=new PredicateBuilder().property(UpgradeItemResourceProvider.UPGRADE_GROUP_ID).equals("1").and().property(UpgradeItemResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeItemResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  ResourceProvider upgradeItemResourceProvider=new UpgradeItemResourceProvider(amc);
  resources=upgradeItemResourceProvider.getResources(request,predicate);
  assertEquals(2,resources.size());
  res=resources.iterator().next();
  assertNotNull(res.getPropertyValue("UpgradeItem/status"));
  propertyIds.clear();
  propertyIds.add("UpgradeItem");
  predicate=new PredicateBuilder().property(UpgradeItemResourceProvider.UPGRADE_GROUP_ID).equals("3").and().property(UpgradeItemResourceProvider.UPGRADE_REQUEST_ID).equals("1").and().property(UpgradeItemResourceProvider.UPGRADE_CLUSTER_NAME).equals("c1").toPredicate();
  request=PropertyHelper.getReadRequest(propertyIds);
  upgradeItemResourceProvider=new UpgradeItemResourceProvider(amc);
  resources=upgradeItemResourceProvider.getResources(request,predicate);
  assertEquals(2,resources.size());
  res=resources.iterator().next();
  assertEquals("Confirm Finalize",res.getPropertyValue("UpgradeItem/context"));
  assertTrue(res.getPropertyValue("UpgradeItem/text").toString().startsWith("Please confirm"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ValidationResourceProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateResources_checkRequestId() throws Exception {
  Map<Resource.Type,String> keyPropertyIds=Collections.emptyMap();
  Set<String> propertyIds=Collections.singleton(ValidationResourceProvider.VALIDATION_ID_PROPERTY_ID);
  AmbariManagementController ambariManagementController=mock(AmbariManagementController.class);
  ValidationResourceProvider provider=spy(new ValidationResourceProvider(propertyIds,keyPropertyIds,ambariManagementController));
  StackAdvisorRequest stackAdvisorRequest=mock(StackAdvisorRequest.class);
  Request request=mock(Request.class);
  doReturn(stackAdvisorRequest).when(provider).prepareStackAdvisorRequest(request);
  StackAdvisorHelper saHelper=mock(StackAdvisorHelper.class);
  ValidationResponse response=mock(ValidationResponse.class);
  Version version=mock(Version.class);
  doReturn(3).when(response).getId();
  doReturn(version).when(response).getVersion();
  doReturn(response).when(saHelper).validate(any(StackAdvisorRequest.class));
  ValidationResourceProvider.init(saHelper);
  RequestStatus status=provider.createResources(request);
  Set<Resource> associatedResources=status.getAssociatedResources();
  assertNotNull(associatedResources);
  assertEquals(1,associatedResources.size());
  Resource resource=associatedResources.iterator().next();
  Object requestId=resource.getPropertyValue(ValidationResourceProvider.VALIDATION_ID_PROPERTY_ID);
  assertNotNull(requestId);
  assertEquals(3,requestId);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.ViewInstanceResourceProviderTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUpdateResources_viewNotLoaded() throws Exception {
  ViewInstanceResourceProvider provider=new ViewInstanceResourceProvider();
  Set<Map<String,Object>> properties=new HashSet<Map<String,Object>>();
  Map<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put(ViewInstanceResourceProvider.ICON_PATH_ID,"path");
  properties.add(propertyMap);
  PredicateBuilder predicateBuilder=new PredicateBuilder();
  Predicate predicate=predicateBuilder.property(ViewInstanceResourceProvider.VIEW_NAME_PROPERTY_ID).equals("V1").toPredicate();
  ViewEntity viewEntity=new ViewEntity();
  viewEntity.setName("V1{1.0.0}");
  viewEntity.setStatus(ViewDefinition.ViewStatus.DEPLOYING);
  ViewInstanceEntity viewInstanceEntity=new ViewInstanceEntity();
  viewInstanceEntity.setViewName("V1{1.0.0}");
  viewInstanceEntity.setName("I1");
  viewInstanceEntity.setViewEntity(viewEntity);
  expect(singleton.getDefinitions()).andReturn(Collections.singleton(viewEntity));
  replay(singleton);
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator());
  provider.updateResources(PropertyHelper.getCreateRequest(properties,null),predicate);
  Assert.assertNull(viewInstanceEntity.getIcon());
  verify(singleton);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToResource() throws Exception {
  ViewInstanceResourceProvider provider=new ViewInstanceResourceProvider();
  Set<String> propertyIds=new HashSet<String>();
  propertyIds.add(ViewInstanceResourceProvider.PROPERTIES_PROPERTY_ID);
  propertyIds.add(ViewInstanceResourceProvider.CLUSTER_HANDLE_PROPERTY_ID);
  ViewInstanceEntity viewInstanceEntity=createNiceMock(ViewInstanceEntity.class);
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  expect(viewInstanceEntity.getViewEntity()).andReturn(viewEntity).anyTimes();
  Map<String,String> propertyMap=new HashMap<String,String>();
  propertyMap.put("par1","val1");
  propertyMap.put("par2","val2");
  expect(viewInstanceEntity.getPropertyMap()).andReturn(propertyMap);
  expect(viewInstanceEntity.getData()).andReturn(Collections.<ViewInstanceDataEntity>emptyList()).anyTimes();
  expect(singleton.checkAdmin()).andReturn(true);
  expect(singleton.checkAdmin()).andReturn(false);
  expect(viewInstanceEntity.getClusterHandle()).andReturn("c1");
  replay(singleton,viewEntity,viewInstanceEntity);
  Resource resource=provider.toResource(viewInstanceEntity,propertyIds);
  Map<String,Map<String,Object>> properties=resource.getPropertiesMap();
  assertEquals(2,properties.size());
  Map<String,Object> props=properties.get("ViewInstanceInfo");
  assertNotNull(props);
  assertEquals(1,props.size());
  assertEquals("c1",props.get("cluster_handle"));
  props=properties.get("ViewInstanceInfo/properties");
  assertNotNull(props);
  assertEquals(2,props.size());
  assertEquals("val1",props.get("par1"));
  assertEquals("val2",props.get("par2"));
  resource=provider.toResource(viewInstanceEntity,propertyIds);
  properties=resource.getPropertiesMap();
  props=properties.get("ViewInstanceInfo/properties");
  assertNull(props);
  verify(singleton,viewEntity,viewInstanceEntity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.WidgetLayoutResourceProviderTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testCreateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetLayoutEntity> entityCapture=new Capture<WidgetLayoutEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  WidgetEntity widgetEntity=new WidgetEntity();
  widgetEntity.setId(1l);
  widgetEntity.setListWidgetLayoutUserWidgetEntity(new ArrayList<WidgetLayoutUserWidgetEntity>());
  expect(widgetDAO.findById(anyLong())).andReturn(widgetEntity).anyTimes();
  replay(amc,clusters,cluster,dao,widgetDAO);
  WidgetLayoutResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,"layout_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_DISPLAY_NAME_PROPERTY_ID,"display_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SECTION_NAME_PROPERTY_ID,"section_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID,"admin");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,"CLUSTER");
  Set widgetsInfo=new LinkedHashSet();
  Map<String,String> widget=new HashMap<String,String>();
  widget.put("id","1");
  widgetsInfo.add(widget);
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID,widgetsInfo);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  RequestStatus requestStatus=provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetLayoutEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Assert.assertEquals(1,requestStatus.getAssociatedResources().size());
  Assert.assertEquals(Long.valueOf(1),entity.getClusterId());
  Assert.assertEquals("CLUSTER",entity.getScope());
  Assert.assertEquals("layout_name",entity.getLayoutName());
  Assert.assertEquals("display_name",entity.getDisplayName());
  Assert.assertEquals("section_name",entity.getSectionName());
  Assert.assertEquals("admin",entity.getUserName());
  Assert.assertNotNull(entity.getListWidgetLayoutUserWidgetEntity());
  Assert.assertNotNull(entity.getListWidgetLayoutUserWidgetEntity().get(0));
  Assert.assertNotNull(entity.getListWidgetLayoutUserWidgetEntity().get(0).getWidget().getListWidgetLayoutUserWidgetEntity());
  verify(amc,clusters,cluster,dao,widgetDAO);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testUpdateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).atLeastOnce();
  Capture<WidgetLayoutEntity> entityCapture=new Capture<WidgetLayoutEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  WidgetEntity widgetEntity=new WidgetEntity();
  widgetEntity.setId(1L);
  widgetEntity.setListWidgetLayoutUserWidgetEntity(new ArrayList<WidgetLayoutUserWidgetEntity>());
  WidgetEntity widgetEntity2=new WidgetEntity();
  widgetEntity2.setId(2L);
  widgetEntity2.setListWidgetLayoutUserWidgetEntity(new ArrayList<WidgetLayoutUserWidgetEntity>());
  expect(widgetDAO.findById(1L)).andReturn(widgetEntity).atLeastOnce();
  replay(amc,clusters,cluster,dao,widgetDAO);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,"layout_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_DISPLAY_NAME_PROPERTY_ID,"display_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SECTION_NAME_PROPERTY_ID,"section_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID,"admin");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,"CLUSTER");
  Set widgetsInfo=new LinkedHashSet();
  Map<String,String> widget=new HashMap<String,String>();
  widget.put("id","1");
  widgetsInfo.add(widget);
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID,widgetsInfo);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  WidgetLayoutResourceProvider provider=createProvider(amc);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetLayoutEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Predicate predicate=new PredicateBuilder().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_ID_PROPERTY_ID).equals("1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID).equals("username").toPredicate();
  entity.setId(Long.valueOf(1));
  String oldLayoutName=entity.getLayoutName();
  String oldScope=entity.getScope();
  resetToStrict(dao,widgetDAO);
  expect(dao.findById(1L)).andReturn(entity).anyTimes();
  expect(dao.mergeWithFlush((WidgetLayoutEntity)anyObject())).andReturn(entity).anyTimes();
  expect(widgetDAO.merge(widgetEntity)).andReturn(widgetEntity).anyTimes();
  expect(widgetDAO.findById(2L)).andReturn(widgetEntity2).anyTimes();
  replay(dao,widgetDAO);
  requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,"layout_name_new");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,"USER");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_ID_PROPERTY_ID,"1");
  widget.put("id","2");
  widgetsInfo.add(widget);
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID,widgetsInfo);
  request=PropertyHelper.getUpdateRequest(requestProps,null);
  provider.updateResources(request,predicate);
  Assert.assertFalse(oldLayoutName.equals(entity.getLayoutName()));
  Assert.assertFalse(oldScope.equals(entity.getScope()));
  verify(amc,clusters,cluster,dao,widgetDAO);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testDeleteResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetLayoutEntity> entityCapture=new Capture<WidgetLayoutEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  replay(amc,clusters,cluster,dao);
  WidgetLayoutResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_LAYOUT_NAME_PROPERTY_ID,"layout_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_DISPLAY_NAME_PROPERTY_ID,"display_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SECTION_NAME_PROPERTY_ID,"section_name");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID,"admin");
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_SCOPE_PROPERTY_ID,"CLUSTER");
  Set widgetsInfo=new LinkedHashSet();
  requestProps.put(WidgetLayoutResourceProvider.WIDGETLAYOUT_WIDGETS_PROPERTY_ID,widgetsInfo);
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetLayoutEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Predicate predicate=new PredicateBuilder().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_ID_PROPERTY_ID).equals("1").and().property(WidgetLayoutResourceProvider.WIDGETLAYOUT_USERNAME_PROPERTY_ID).equals("username").toPredicate();
  entity.setId(Long.valueOf(1));
  resetToStrict(dao);
  expect(dao.findById(1L)).andReturn(entity).anyTimes();
  dao.remove(capture(entityCapture));
  expectLastCall();
  replay(dao);
  provider.deleteResources(predicate);
  WidgetLayoutEntity entity1=entityCapture.getValue();
  Assert.assertEquals(Long.valueOf(1),entity1.getId());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.internal.WidgetResourceProviderTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testUpdateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).atLeastOnce();
  Capture<WidgetEntity> entityCapture=new Capture<WidgetEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  replay(amc,clusters,cluster,dao);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,"widget name");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,"GAUGE");
  requestProps.put(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,"admin");
  requestProps.put(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,"USER");
  Set testSet=new LinkedHashSet();
  HashMap testMap=new HashMap();
  testMap.put("name","value");
  testMap.put("name2","value2");
  testSet.add(testMap);
  requestProps.put(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property1","value1");
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property2","value2");
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  WidgetResourceProvider provider=createProvider(amc);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Predicate predicate=new PredicateBuilder().property(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetResourceProvider.WIDGET_ID_PROPERTY_ID).equals("1").and().property(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID).equals("username").toPredicate();
  entity.setId(Long.valueOf(1));
  String oldMetrics=entity.getMetrics();
  String oldProperties=entity.getProperties();
  String oldName=entity.getWidgetName();
  resetToStrict(dao);
  expect(dao.findById(1L)).andReturn(entity).anyTimes();
  expect(dao.merge((WidgetEntity)anyObject())).andReturn(entity).anyTimes();
  replay(dao);
  requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetResourceProvider.WIDGET_ID_PROPERTY_ID,"1");
  requestProps.put(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,"widget name2");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,"GAUGE");
  requestProps.put(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,"admin");
  requestProps.put(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,"USER");
  testSet=new LinkedHashSet();
  testMap=new HashMap();
  testMap.put("name","new_value");
  testMap.put("new_name","new_value2");
  testSet.add(testMap);
  requestProps.put(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property1","new_value1");
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/new_property","new_value2");
  request=PropertyHelper.getUpdateRequest(requestProps,null);
  provider.updateResources(request,predicate);
  Assert.assertFalse(oldName.equals(entity.getWidgetName()));
  Assert.assertFalse(oldMetrics.equals(entity.getMetrics()));
  Assert.assertFalse(oldProperties.equals(entity.getProperties()));
  Assert.assertEquals("[{\"name\":\"new_value\",\"new_name\":\"new_value2\"}]",entity.getMetrics());
  Assert.assertTrue(CollectionPresentationUtils.isJsonsEquals("{\"new_property\":\"new_value2\",\"property1\":\"new_value1\"}",entity.getProperties()));
  Assert.assertEquals("widget name2",entity.getWidgetName());
  Assert.assertEquals(null,entity.getDefaultSectionName());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testDeleteResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetEntity> entityCapture=new Capture<WidgetEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  replay(amc,clusters,cluster,dao);
  WidgetResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,"widget name");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,"GAUGE");
  requestProps.put(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,"admin");
  requestProps.put(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,"USER");
  Set testSet=new LinkedHashSet();
  HashMap testMap=new HashMap();
  testMap.put("name","value");
  testMap.put("name2","value2");
  testSet.add(testMap);
  requestProps.put(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property1","value1");
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property2","value2");
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Predicate predicate=new PredicateBuilder().property(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID).equals("c1").and().property(WidgetResourceProvider.WIDGET_ID_PROPERTY_ID).equals("1").and().property(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID).equals("username").toPredicate();
  entity.setId(Long.valueOf(1));
  resetToStrict(dao);
  expect(dao.findById(1L)).andReturn(entity).anyTimes();
  dao.remove(capture(entityCapture));
  expectLastCall();
  replay(dao);
  provider.deleteResources(predicate);
  WidgetEntity entity1=entityCapture.getValue();
  Assert.assertEquals(Long.valueOf(1),entity1.getId());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testCreateResources() throws Exception {
  AmbariManagementController amc=createMock(AmbariManagementController.class);
  Clusters clusters=createMock(Clusters.class);
  Cluster cluster=createMock(Cluster.class);
  expect(amc.getClusters()).andReturn(clusters).atLeastOnce();
  expect(clusters.getCluster((String)anyObject())).andReturn(cluster).atLeastOnce();
  expect(cluster.getClusterId()).andReturn(Long.valueOf(1)).anyTimes();
  Capture<WidgetEntity> entityCapture=new Capture<WidgetEntity>();
  dao.create(capture(entityCapture));
  expectLastCall();
  replay(amc,clusters,cluster,dao);
  WidgetResourceProvider provider=createProvider(amc);
  Map<String,Object> requestProps=new HashMap<String,Object>();
  requestProps.put(WidgetResourceProvider.WIDGET_CLUSTER_NAME_PROPERTY_ID,"c1");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_NAME_PROPERTY_ID,"widget name");
  requestProps.put(WidgetResourceProvider.WIDGET_WIDGET_TYPE_PROPERTY_ID,"GAUGE");
  requestProps.put(WidgetResourceProvider.WIDGET_AUTHOR_PROPERTY_ID,"admin");
  requestProps.put(WidgetResourceProvider.WIDGET_SCOPE_PROPERTY_ID,"USER");
  Set testSet=new LinkedHashSet();
  HashMap testMap=new HashMap();
  testMap.put("name","value");
  testMap.put("name2","value2");
  testSet.add(testMap);
  requestProps.put(WidgetResourceProvider.WIDGET_METRICS_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_VALUES_PROPERTY_ID,testSet);
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property1","value1");
  requestProps.put(WidgetResourceProvider.WIDGET_PROPERTIES_PROPERTY_ID + "/property2","value2");
  Request request=PropertyHelper.getCreateRequest(Collections.singleton(requestProps),null);
  RequestStatus requestStatus=provider.createResources(request);
  Assert.assertTrue(entityCapture.hasCaptured());
  WidgetEntity entity=entityCapture.getValue();
  Assert.assertNotNull(entity);
  Assert.assertEquals(1,requestStatus.getAssociatedResources().size());
  Assert.assertEquals(Long.valueOf(1),entity.getClusterId());
  Assert.assertEquals("USER",entity.getScope());
  Assert.assertEquals("widget name",entity.getWidgetName());
  Assert.assertEquals(null,entity.getDefaultSectionName());
  Assert.assertEquals("GAUGE",entity.getWidgetType());
  Assert.assertEquals("admin",entity.getAuthor());
  Assert.assertEquals("[{\"name\":\"value\",\"name2\":\"value2\"}]",entity.getMetrics());
  Assert.assertEquals("[{\"name\":\"value\",\"name2\":\"value2\"}]",entity.getWidgetValues());
  Assert.assertEquals("{\"property2\":\"value2\",\"property1\":\"value1\"}",entity.getProperties());
  verify(amc,clusters,cluster,dao);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.metrics.ganglia.GangliaReportPropertyProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources() throws Exception {
  TestStreamProvider streamProvider=new TestStreamProvider("temporal_ganglia_report_data.json");
  TestGangliaHostProvider hostProvider=new TestGangliaHostProvider();
  GangliaReportPropertyProvider propertyProvider=new GangliaReportPropertyProvider(PropertyHelper.getMetricPropertyIds(Resource.Type.Cluster),streamProvider,configuration,hostProvider,CLUSTER_NAME_PROPERTY_ID);
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(PROPERTY_ID,new TemporalInfoImpl(10L,20L,1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(PROPERTY_ID),temporalInfoMap);
  Assert.assertEquals(1,propertyProvider.populateResources(Collections.singleton(resource),request,null).size());
  String expected=(configuration.isGangliaSSL() ? "https" : "http") + "://domU-12-31-39-0E-34-E1.compute-1.internal/ganglia/graph.php?g=load_report&json=1";
  Assert.assertEquals(expected,streamProvider.getLastSpec());
  Assert.assertEquals(2,PropertyHelper.getProperties(resource).size());
  Assert.assertNotNull(resource.getPropertyValue(PROPERTY_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.metrics.timeline.AMSReportPropertyProviderTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResources() throws Exception {
  TestStreamProvider streamProvider=new TestStreamProvider(SINGLE_HOST_METRICS_FILE_PATH);
  injectCacheEntryFactoryWithStreamProvider(streamProvider);
  TestMetricHostProvider metricHostProvider=new TestMetricHostProvider();
  ComponentSSLConfiguration sslConfiguration=mock(ComponentSSLConfiguration.class);
  Map<String,Map<String,PropertyInfo>> propertyIds=PropertyHelper.getMetricPropertyIds(Resource.Type.Cluster);
  AMSReportPropertyProvider propertyProvider=new AMSReportPropertyProvider(propertyIds,streamProvider,sslConfiguration,cacheProvider,metricHostProvider,CLUSTER_NAME_PROPERTY_ID);
  String propertyId=PropertyHelper.getPropertyId("metrics/cpu","User");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(propertyId,new TemporalInfoImpl(1416445244800L,1416448936474L,1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(propertyId),temporalInfoMap);
  Set<Resource> resources=propertyProvider.populateResources(Collections.singleton(resource),request,null);
  Assert.assertEquals(1,resources.size());
  Resource res=resources.iterator().next();
  Map<String,Object> properties=PropertyHelper.getProperties(resources.iterator().next());
  Assert.assertNotNull(properties);
  URIBuilder uriBuilder=AMSPropertyProvider.getAMSUriBuilder("localhost",8188);
  uriBuilder.addParameter("metricNames","cpu_user");
  uriBuilder.addParameter("appId","HOST");
  uriBuilder.addParameter("startTime","1416445244800");
  uriBuilder.addParameter("endTime","1416448936474");
  Assert.assertEquals(uriBuilder.toString(),streamProvider.getLastSpec());
  Number[][] val=(Number[][])res.getPropertyValue("metrics/cpu/User");
  Assert.assertEquals(111,val.length);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPopulateResourceWithAggregateFunction() throws Exception {
  TestStreamProvider streamProvider=new TestStreamProvider(AGGREGATE_CLUSTER_METRICS_FILE_PATH);
  injectCacheEntryFactoryWithStreamProvider(streamProvider);
  TestMetricHostProvider metricHostProvider=new TestMetricHostProvider();
  ComponentSSLConfiguration sslConfiguration=mock(ComponentSSLConfiguration.class);
  Map<String,Map<String,PropertyInfo>> propertyIds=PropertyHelper.getMetricPropertyIds(Resource.Type.Cluster);
  AMSReportPropertyProvider propertyProvider=new AMSReportPropertyProvider(propertyIds,streamProvider,sslConfiguration,cacheProvider,metricHostProvider,CLUSTER_NAME_PROPERTY_ID);
  String propertyId=PropertyHelper.getPropertyId("metrics/cpu","User._sum");
  Resource resource=new ResourceImpl(Resource.Type.Cluster);
  resource.setProperty(CLUSTER_NAME_PROPERTY_ID,"c1");
  Map<String,TemporalInfo> temporalInfoMap=new HashMap<String,TemporalInfo>();
  temporalInfoMap.put(propertyId,new TemporalInfoImpl(1432033257812L,1432035927922L,1L));
  Request request=PropertyHelper.getReadRequest(Collections.singleton(propertyId),temporalInfoMap);
  Set<Resource> resources=propertyProvider.populateResources(Collections.singleton(resource),request,null);
  Assert.assertEquals(1,resources.size());
  Resource res=resources.iterator().next();
  Map<String,Object> properties=PropertyHelper.getProperties(resources.iterator().next());
  Assert.assertNotNull(properties);
  URIBuilder uriBuilder=AMSPropertyProvider.getAMSUriBuilder("localhost",8188);
  uriBuilder.addParameter("metricNames","cpu_user._sum");
  uriBuilder.addParameter("appId","HOST");
  uriBuilder.addParameter("startTime","1432033257812");
  uriBuilder.addParameter("endTime","1432035927922");
  Assert.assertEquals(uriBuilder.toString(),streamProvider.getLastSpec());
  Number[][] val=(Number[][])res.getPropertyValue("metrics/cpu/User._sum");
  Assert.assertEquals(90,val.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.metrics.timeline.cache.TimelineMetricCacheTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimelineMetricCacheTimeseriesUpdates() throws Exception {
  Configuration configuration=createNiceMock(Configuration.class);
  expect(configuration.getMetricsRequestConnectTimeoutMillis()).andReturn(10000);
  expect(configuration.getMetricsRequestReadTimeoutMillis()).andReturn(10000);
  expect(configuration.getMetricsRequestIntervalReadTimeoutMillis()).andReturn(10000);
  expect(configuration.getMetricRequestBufferTimeCatchupInterval()).andReturn(0l);
  replay(configuration);
  TimelineMetricCacheEntryFactory factory=createMockBuilder(TimelineMetricCacheEntryFactory.class).withConstructor(configuration).createMock();
  replay(factory);
  long now=System.currentTimeMillis();
  final TimelineMetric timelineMetric1=new TimelineMetric();
  timelineMetric1.setMetricName("cpu_user");
  timelineMetric1.setAppId("app1");
  TreeMap<Long,Double> metricValues=new TreeMap<Long,Double>();
  metricValues.put(now - 100,1.0);
  metricValues.put(now - 200,2.0);
  metricValues.put(now - 300,3.0);
  timelineMetric1.setMetricValues(metricValues);
  final TimelineMetric timelineMetric2=new TimelineMetric();
  timelineMetric2.setMetricName("cpu_nice");
  timelineMetric2.setAppId("app1");
  metricValues=new TreeMap<Long,Double>();
  metricValues.put(now + 400,1.0);
  metricValues.put(now + 500,2.0);
  metricValues.put(now + 600,3.0);
  timelineMetric2.setMetricValues(metricValues);
  TimelineMetrics existingMetrics=new TimelineMetrics();
  existingMetrics.getMetrics().add(timelineMetric1);
  existingMetrics.getMetrics().add(timelineMetric2);
  TimelineMetricsCacheValue existingMetricValue=new TimelineMetricsCacheValue(now - 1000,now + 1000,existingMetrics,null);
  TimelineMetrics newMetrics=new TimelineMetrics();
  TimelineMetric timelineMetric3=new TimelineMetric();
  timelineMetric3.setMetricName("cpu_user");
  timelineMetric3.setAppId("app1");
  metricValues=new TreeMap<Long,Double>();
  metricValues.put(now + 1400,1.0);
  metricValues.put(now + 1500,2.0);
  metricValues.put(now + 1600,3.0);
  timelineMetric3.setMetricValues(metricValues);
  newMetrics.getMetrics().add(timelineMetric3);
  factory.updateTimelineMetricsInCache(newMetrics,existingMetricValue,now,now + 2000,false);
  Assert.assertEquals(2,existingMetricValue.getTimelineMetrics().getMetrics().size());
  TimelineMetric newMetric1=null;
  TimelineMetric newMetric2=null;
  for (  TimelineMetric metric : existingMetricValue.getTimelineMetrics().getMetrics()) {
    if (metric.getMetricName().equals("cpu_user")) {
      newMetric1=metric;
    }
    if (metric.getMetricName().equals("cpu_nice")) {
      newMetric2=metric;
    }
  }
  Assert.assertNotNull(newMetric1);
  Assert.assertNotNull(newMetric2);
  Assert.assertEquals(3,newMetric1.getMetricValues().size());
  Assert.assertEquals(3,newMetric2.getMetricValues().size());
  Map<Long,Double> newMetricsMap=newMetric1.getMetricValues();
  Iterator<Long> metricKeyIterator=newMetricsMap.keySet().iterator();
  Assert.assertEquals(now + 1400,metricKeyIterator.next().longValue());
  Assert.assertEquals(now + 1500,metricKeyIterator.next().longValue());
  Assert.assertEquals(now + 1600,metricKeyIterator.next().longValue());
  verify(configuration,factory);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.predicate.PredicateVisitorTest </h4><pre class="type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVisitor(){
  String propertyId=PropertyHelper.getPropertyId("category1","foo");
  EqualsPredicate equalsPredicate=new EqualsPredicate<String>(propertyId,"bar");
  TestPredicateVisitor visitor=new TestPredicateVisitor();
  equalsPredicate.accept(visitor);
  Assert.assertSame(equalsPredicate,visitor.visitedComparisonPredicate);
  Assert.assertNull(visitor.visitedArrayPredicate);
  Assert.assertNull(visitor.visitedUnaryPredicate);
  AndPredicate andPredicate=new AndPredicate(equalsPredicate);
  visitor=new TestPredicateVisitor();
  andPredicate.accept(visitor);
  Assert.assertNull(visitor.visitedComparisonPredicate);
  Assert.assertSame(andPredicate,visitor.visitedArrayPredicate);
  Assert.assertNull(visitor.visitedUnaryPredicate);
  NotPredicate notPredicate=new NotPredicate(andPredicate);
  visitor=new TestPredicateVisitor();
  notPredicate.accept(visitor);
  Assert.assertNull(visitor.visitedComparisonPredicate);
  Assert.assertNull(visitor.visitedArrayPredicate);
  Assert.assertSame(notPredicate,visitor.visitedUnaryPredicate);
  CategoryPredicate categoryPredicate=new CategoryIsEmptyPredicate("cat1");
  visitor=new TestPredicateVisitor();
  categoryPredicate.accept(visitor);
  Assert.assertNull(visitor.visitedComparisonPredicate);
  Assert.assertNull(visitor.visitedArrayPredicate);
  Assert.assertNull(visitor.visitedUnaryPredicate);
  Assert.assertSame(categoryPredicate,visitor.visitedCategoryPredicate);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.controller.utilities.PropertyHelperTest </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertyCategory(){
  String propertyId="metrics/yarn/Queue/$1.replaceAll(\",q(\\d+)=\",\"/\").substring(1)/AppsRunning";
  String category=PropertyHelper.getPropertyCategory(propertyId);
  Assert.assertEquals("metrics/yarn/Queue/$1",category);
  category=PropertyHelper.getPropertyCategory(category);
  Assert.assertEquals("metrics/yarn/Queue",category);
  category=PropertyHelper.getPropertyCategory(category);
  Assert.assertEquals("metrics/yarn",category);
  category=PropertyHelper.getPropertyCategory(category);
  Assert.assertEquals("metrics",category);
  category=PropertyHelper.getPropertyCategory(category);
  Assert.assertNull(category);
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetJMXPropertyIds(){
  Map<String,Map<String,PropertyInfo>> metrics=PropertyHelper.getJMXPropertyIds(Resource.Type.HostComponent);
  Map<String,PropertyInfo> componentMetrics=metrics.get("HISTORYSERVER");
  Assert.assertNull(componentMetrics);
  componentMetrics=metrics.get("NAMENODE");
  Assert.assertNotNull(componentMetrics);
  PropertyInfo info=componentMetrics.get("metrics/jvm/memHeapUsedM");
  Assert.assertNotNull(info);
  Assert.assertEquals("Hadoop:service=NameNode,name=jvm.memHeapUsedM",info.getPropertyId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.customactions.ActionDefinitionManagerTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadCustomActionDefinitions() throws Exception {
  ActionDefinitionManager manager=new ActionDefinitionManager();
  manager.readCustomActionDefinitions(new File(customActionDefinitionRoot));
  Assert.assertEquals(2,manager.getAllActionDefinition().size());
  ActionDefinition ad=manager.getActionDefinition("customAction1");
  Assert.assertNotNull(ad);
  Assert.assertEquals("customAction1",ad.getActionName());
  Assert.assertEquals("A random test",ad.getDescription());
  Assert.assertEquals("threshold",ad.getInputs());
  Assert.assertEquals("TASKTRACKER",ad.getTargetComponent());
  Assert.assertEquals("MAPREDUCE",ad.getTargetService());
  Assert.assertEquals(60,(int)ad.getDefaultTimeout());
  Assert.assertEquals(TargetHostType.ALL,ad.getTargetType());
  Assert.assertEquals(ActionType.USER,ad.getActionType());
  ad=manager.getActionDefinition("customAction2");
  Assert.assertNotNull(ad);
  Assert.assertEquals("customAction2",ad.getActionName());
  Assert.assertEquals("A random test",ad.getDescription());
  Assert.assertEquals(null,ad.getInputs());
  Assert.assertEquals("TASKTRACKER",ad.getTargetComponent());
  Assert.assertEquals("MAPREDUCE",ad.getTargetService());
  Assert.assertEquals(60,(int)ad.getDefaultTimeout());
  Assert.assertEquals(null,ad.getTargetType());
  Assert.assertEquals(ActionType.USER,ad.getActionType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.events.EventsTest </h4><pre class="type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Before public void setup() throws Exception {
  m_injector=Guice.createInjector(new InMemoryDefaultTestModule());
  m_injector.getInstance(GuiceJpaInitializer.class);
  m_helper=m_injector.getInstance(OrmTestHelper.class);
  EventBus synchronizedBus=EventBusSynchronizer.synchronizeAmbariEventPublisher(m_injector);
  m_listener=m_injector.getInstance(MockEventListener.class);
  synchronizedBus.register(m_listener);
  m_clusters=m_injector.getInstance(Clusters.class);
  m_serviceFactory=m_injector.getInstance(ServiceFactory.class);
  m_componentFactory=m_injector.getInstance(ServiceComponentFactory.class);
  m_schFactory=m_injector.getInstance(ServiceComponentHostFactory.class);
  m_definitionDao=m_injector.getInstance(AlertDefinitionDAO.class);
  m_clusterName="foo";
  StackId stackId=new StackId("HDP","2.0.6");
  m_clusters.addCluster(m_clusterName,stackId);
  m_clusters.addHost(HOSTNAME);
  Host host=m_clusters.getHost(HOSTNAME);
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","6.4");
  host.setHostAttributes(hostAttributes);
  host.setState(HostState.HEALTHY);
  host.persist();
  m_cluster=m_clusters.getCluster(m_clusterName);
  Assert.assertNotNull(m_cluster);
  m_cluster.setDesiredStackVersion(stackId);
  m_helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  m_cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  m_clusters.mapHostToCluster(HOSTNAME,m_clusterName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.metadata.RoleCommandOrderTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransitiveServices() throws AmbariException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  ClusterImpl cluster=createMock(ClusterImpl.class);
  Service hdfsService=createMock(Service.class);
  ServiceComponent namenode=createMock(ServiceComponent.class);
  expect(namenode.getName()).andReturn("NAMENODE").anyTimes();
  Map<String,ServiceComponent> hdfsComponents=Collections.singletonMap("NAMENODE",namenode);
  expect(hdfsService.getServiceComponents()).andReturn(hdfsComponents).anyTimes();
  Service hbaseService=createMock(Service.class);
  expect(cluster.getService("HBASE")).andReturn(hbaseService).atLeastOnce();
  expect(hbaseService.getCluster()).andReturn(cluster).anyTimes();
  ServiceComponent hbaseMaster=createMock(ServiceComponent.class);
  expect(hbaseMaster.getName()).andReturn("HBASE_MASTER").anyTimes();
  Map<String,ServiceComponent> hbaseComponents=Collections.singletonMap("HBASE_MASTER",hbaseMaster);
  expect(hbaseService.getServiceComponents()).andReturn(hbaseComponents).anyTimes();
  Map<String,Service> installedServices=new HashMap<String,Service>();
  installedServices.put("HDFS",hdfsService);
  installedServices.put("HBASE",hbaseService);
  expect(cluster.getServices()).andReturn(installedServices).atLeastOnce();
  expect(cluster.getService("HDFS")).andReturn(hdfsService).atLeastOnce();
  expect(cluster.getService("GLUSTERFS")).andReturn(null);
  expect(cluster.getService("YARN")).andReturn(null);
  expect(hdfsService.getServiceComponent("JOURNALNODE")).andReturn(null);
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.0.5"));
  replay(cluster,hdfsService,hbaseService,hbaseMaster,namenode);
  rco.initialize(cluster);
  Set<Service> transitiveServices=rco.getTransitiveServices(cluster.getService("HBASE"),RoleCommand.START);
  Assert.assertNotNull(transitiveServices);
  Assert.assertFalse(transitiveServices.isEmpty());
  Assert.assertEquals(1,transitiveServices.size());
  Assert.assertTrue(transitiveServices.contains(hdfsService));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitializeAtHaRMCluster() throws AmbariException {
  RoleCommandOrder rco=injector.getInstance(RoleCommandOrder.class);
  ClusterImpl cluster=createMock(ClusterImpl.class);
  ServiceComponentHost sch1=createMock(ServiceComponentHostImpl.class);
  ServiceComponentHost sch2=createMock(ServiceComponentHostImpl.class);
  expect(cluster.getService("GLUSTERFS")).andReturn(null);
  Map<String,ServiceComponentHost> hostComponents=new HashMap<String,ServiceComponentHost>();
  hostComponents.put("1",sch1);
  hostComponents.put("2",sch2);
  Service yarnService=createMock(Service.class);
  ServiceComponent resourcemanagerSC=createMock(ServiceComponent.class);
  expect(cluster.getService("YARN")).andReturn(yarnService).atLeastOnce();
  expect(cluster.getService("HDFS")).andReturn(null);
  expect(yarnService.getServiceComponent("RESOURCEMANAGER")).andReturn(resourcemanagerSC).anyTimes();
  expect(resourcemanagerSC.getServiceComponentHosts()).andReturn(hostComponents).anyTimes();
  expect(cluster.getCurrentStackVersion()).andReturn(new StackId("HDP","2.0.6"));
  replay(cluster,yarnService,sch1,sch2,resourcemanagerSC);
  Map<RoleCommandPair,Set<RoleCommandPair>> deps=rco.getDependencies();
  assertTrue("Dependencies are empty before initialization",deps.size() == 0);
  rco.initialize(cluster);
  assertTrue("Dependencies are loaded after initialization",deps.size() > 0);
  verify(cluster,yarnService);
  assertFalse(dependenciesContainBlockedRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockedRole(deps,Role.GLUSTERFS_CLIENT));
  assertFalse(dependenciesContainBlockerRole(deps,Role.PEERSTATUS));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_SERVICE_CHECK));
  assertFalse(dependenciesContainBlockerRole(deps,Role.GLUSTERFS_CLIENT));
  assertTrue(dependenciesContainBlockerRole(deps,Role.DATANODE));
  RoleCommandPair rmPair=new RoleCommandPair(Role.RESOURCEMANAGER,RoleCommand.START);
  Set<RoleCommandPair> rmRoleCommandPairs=deps.get(rmPair);
  assertNotNull(rmRoleCommandPairs);
  boolean isZookeeperStartPresent=false;
  for (  RoleCommandPair pair : rmRoleCommandPairs) {
    if (pair.cmd == RoleCommand.START && pair.getRole() == Role.ZOOKEEPER_SERVER) {
      isZookeeperStartPresent=true;
    }
  }
  assertTrue(isZookeeperStartPresent);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.notifications.DispatchFactoryTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that know {@link NotificationDispatcher}s are registered via the
 * Guice {@link Module} and that they singletons.
 * @throws Exception
 */
@Test public void testDispatchFactoryRegistration() throws Exception {
  String sourceResourceDirectory="src" + File.separator + "test"+ File.separator+ "resources";
  Properties properties=new Properties();
  properties.setProperty(Configuration.SERVER_PERSISTENCE_TYPE_KEY,"in-memory");
  properties.setProperty(Configuration.OS_VERSION_KEY,"centos6");
  properties.setProperty(Configuration.SHARED_RESOURCES_DIR_KEY,sourceResourceDirectory);
  Injector injector=Guice.createInjector(new ControllerModule(properties));
  DispatchFactory dispatchFactory=injector.getInstance(DispatchFactory.class);
  DispatchFactory dispatchFactory2=injector.getInstance(DispatchFactory.class);
  Assert.assertEquals(dispatchFactory,dispatchFactory2);
  EmailDispatcher emailDispatcher=injector.getInstance(EmailDispatcher.class);
  EmailDispatcher emailDispatcher2=(EmailDispatcher)dispatchFactory.getDispatcher(emailDispatcher.getType());
  Assert.assertNotNull(emailDispatcher);
  Assert.assertNotNull(emailDispatcher2);
  Assert.assertEquals(emailDispatcher,emailDispatcher2);
  SNMPDispatcher snmpDispatcher=injector.getInstance(SNMPDispatcher.class);
  SNMPDispatcher snmpDispatcher2=(SNMPDispatcher)dispatchFactory.getDispatcher(snmpDispatcher.getType());
  Assert.assertNotNull(snmpDispatcher);
  Assert.assertNotNull(snmpDispatcher2);
  Assert.assertEquals(snmpDispatcher,snmpDispatcher2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.TestOrmImpl </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test auto incremented field and custom query example
 */
@Test public void testAutoIncrementedField(){
  ClusterServiceDAO clusterServiceDAO=injector.getInstance(ClusterServiceDAO.class);
  Date currentTime=new Date();
  String serviceName="MapReduce1";
  String clusterName="test_cluster1";
  createService(currentTime,serviceName,clusterName);
  ClusterServiceEntity clusterServiceEntity=clusterServiceDAO.findByClusterAndServiceNames(clusterName,serviceName);
  clusterServiceDAO.remove(clusterServiceEntity);
  assertNull(clusterServiceDAO.findByClusterAndServiceNames(clusterName,serviceName));
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Rollback test
 */
@Test public void testSafeRollback(){
  String testClusterName="don't save";
  EntityManager entityManager=injector.getInstance(OrmTestHelper.class).getEntityManager();
  entityManager.getTransaction().begin();
  ClusterEntity clusterEntity=new ClusterEntity();
  clusterEntity.setClusterName(testClusterName);
  entityManager.persist(clusterEntity);
  entityManager.getTransaction().rollback();
  assertNull("transaction was not rolled back",injector.getInstance(ClusterDAO.class).findByName(testClusterName));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrentModification() throws InterruptedException {
  final StackDAO stackDAO=injector.getInstance(StackDAO.class);
  final ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  final ResourceTypeDAO resourceTypeDAO=injector.getInstance(ResourceTypeDAO.class);
  final StackEntity stackEntity=stackDAO.find("HDP","2.2.0");
  ResourceTypeEntity resourceTypeEntity=resourceTypeDAO.findById(ResourceType.CLUSTER.getId());
  if (resourceTypeEntity == null) {
    resourceTypeEntity=new ResourceTypeEntity();
    resourceTypeEntity.setId(ResourceType.CLUSTER.getId());
    resourceTypeEntity.setName(ResourceType.CLUSTER.name());
    resourceTypeEntity=resourceTypeDAO.merge(resourceTypeEntity);
  }
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setResourceType(resourceTypeEntity);
  ClusterEntity clusterEntity=new ClusterEntity();
  clusterEntity.setClusterName("cluster1");
  clusterEntity.setResource(resourceEntity);
  clusterEntity.setDesiredStack(stackEntity);
  clusterDAO.create(clusterEntity);
  clusterEntity=clusterDAO.findById(clusterEntity.getClusterId());
  assertEquals("cluster1",clusterEntity.getClusterName());
  Thread thread=new Thread(){
    @Override public void run(){
      ClusterEntity clusterEntity1=clusterDAO.findByName("cluster1");
      clusterEntity1.setClusterName("anotherName");
      clusterDAO.merge(clusterEntity1);
      clusterEntity1=clusterDAO.findById(clusterEntity1.getClusterId());
      assertEquals("anotherName",clusterEntity1.getClusterName());
      injector.getInstance(EntityManager.class).clear();
    }
  }
;
  thread.start();
  thread.join();
  injector.getInstance(EntityManager.class).clear();
  clusterEntity=clusterDAO.findById(clusterEntity.getClusterId());
  assertEquals("anotherName",clusterEntity.getClusterName());
  thread=new Thread(){
    @Override public void run(){
      clusterDAO.removeByName("anotherName");
      injector.getInstance(EntityManager.class).clear();
    }
  }
;
  thread.start();
  thread.join();
  injector.getInstance(EntityManager.class).clear();
  assertNull(clusterDAO.findById(clusterEntity.getClusterId()));
  List<ClusterEntity> result=clusterDAO.findAll();
  final ResourceTypeEntity finalResourceTypeEntity=resourceTypeEntity;
  thread=new Thread(){
    @Override public void run(){
      ResourceEntity resourceEntity=new ResourceEntity();
      resourceEntity.setResourceType(finalResourceTypeEntity);
      ClusterEntity temp=new ClusterEntity();
      temp.setClusterName("temp_cluster");
      temp.setResource(resourceEntity);
      temp.setDesiredStack(stackEntity);
      clusterDAO.create(temp);
    }
  }
;
  thread.start();
  thread.join();
  assertEquals(result.size() + 1,(result=clusterDAO.findAll()).size());
  thread=new Thread(){
    @Override public void run(){
      ResourceEntity resourceEntity=new ResourceEntity();
      resourceEntity.setResourceType(finalResourceTypeEntity);
      ClusterEntity temp=new ClusterEntity();
      temp.setClusterName("temp_cluster2");
      temp.setResource(resourceEntity);
      temp.setDesiredStack(stackEntity);
      clusterDAO.create(temp);
    }
  }
;
  thread.start();
  thread.join();
  assertEquals(result.size() + 1,(clusterDAO.findAll()).size());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * to clarify: are cascade operations allowed?
 */
@Test public void testCascadeRemoveFail(){
  ClusterServiceDAO clusterServiceDAO=injector.getInstance(ClusterServiceDAO.class);
  Date currentTime=new Date();
  String serviceName="MapReduce2";
  String clusterName="test_cluster1";
  createService(currentTime,serviceName,clusterName);
  ClusterServiceEntity clusterServiceEntity=clusterServiceDAO.findByClusterAndServiceNames(clusterName,serviceName);
  clusterServiceDAO.remove(clusterServiceEntity);
  Assert.assertNull(clusterServiceDAO.findByClusterAndServiceNames(clusterName,serviceName));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.AlertDefinitionDAOTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testCascadeDelete() throws Exception {
  AlertDefinitionEntity definition=helper.createAlertDefinition(clusterId);
  AlertGroupEntity group=helper.createAlertGroup(clusterId,null);
  group.addAlertDefinition(definition);
  dispatchDao.merge(group);
  AlertHistoryEntity history=new AlertHistoryEntity();
  history.setServiceName(definition.getServiceName());
  history.setClusterId(clusterId);
  history.setAlertDefinition(definition);
  history.setAlertLabel("Label");
  history.setAlertState(AlertState.OK);
  history.setAlertText("Alert Text");
  history.setAlertTimestamp(calendar.getTimeInMillis());
  AlertCurrentEntity current=new AlertCurrentEntity();
  current.setAlertHistory(history);
  current.setLatestTimestamp(new Date().getTime());
  current.setOriginalTimestamp(new Date().getTime() - 10800000);
  current.setMaintenanceState(MaintenanceState.OFF);
  alertsDao.create(current);
  AlertNoticeEntity notice=new AlertNoticeEntity();
  notice.setAlertHistory(history);
  notice.setAlertTarget(helper.createAlertTarget());
  notice.setNotifyState(NotificationState.PENDING);
  notice.setUuid(UUID.randomUUID().toString());
  dispatchDao.create(notice);
  group=dispatchDao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertNotNull(group.getAlertDefinitions());
  assertEquals(1,group.getAlertDefinitions().size());
  history=alertsDao.findById(history.getAlertId());
  assertNotNull(history);
  current=alertsDao.findCurrentById(current.getAlertId());
  assertNotNull(current);
  assertNotNull(current.getAlertHistory());
  notice=dispatchDao.findNoticeById(notice.getNotificationId());
  assertNotNull(notice);
  assertNotNull(notice.getAlertHistory());
  assertNotNull(notice.getAlertTarget());
  definition=dao.findById(definition.getDefinitionId());
  dao.refresh(definition);
  dao.remove(definition);
  notice=dispatchDao.findNoticeById(notice.getNotificationId());
  assertNull(notice);
  current=alertsDao.findCurrentById(current.getAlertId());
  assertNull(current);
  history=alertsDao.findById(history.getAlertId());
  assertNull(history);
  group=dispatchDao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertNotNull(group.getAlertDefinitions());
  assertEquals(0,group.getAlertDefinitions().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindById(){
  List<AlertDefinitionEntity> definitions=dao.findAll();
  assertNotNull(definitions);
  AlertDefinitionEntity definition=definitions.get(2);
  AlertDefinitionEntity retrieved=dao.findById(definition.getDefinitionId());
  assertEquals(definition,retrieved);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedClusterEntity() throws Exception {
  AlertDefinitionEntity definition=new AlertDefinitionEntity();
  definition.setDefinitionName("nested-cluster-entity-test");
  definition.setServiceName("HDFS");
  definition.setComponentName(null);
  definition.setClusterId(clusterId);
  definition.setHash(UUID.randomUUID().toString());
  definition.setScheduleInterval(60);
  definition.setScope(Scope.SERVICE);
  definition.setSource("{\"type\" : \"SCRIPT\"}");
  definition.setSourceType(SourceType.SCRIPT);
  dao.create(definition);
  definition=dao.findById(definition.getDefinitionId());
  assertNotNull(definition.getCluster());
  assertEquals(clusterId,definition.getCluster().getClusterId());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindByService(){
  List<AlertDefinitionEntity> definitions=dao.findByService(clusterId,"HDFS");
  assertNotNull(definitions);
  assertEquals(10,definitions.size());
  definitions=dao.findByService(clusterId,"YARN");
  assertNotNull(definitions);
  assertEquals(0,definitions.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindByServiceComponent(){
  List<AlertDefinitionEntity> definitions=dao.findByServiceComponent(clusterId,"OOZIE","OOZIE_SERVER");
  assertNotNull(definitions);
  assertEquals(2,definitions.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindByName(){
  List<AlertDefinitionEntity> definitions=dao.findAll();
  assertNotNull(definitions);
  AlertDefinitionEntity definition=definitions.get(2);
  AlertDefinitionEntity retrieved=dao.findByName(definition.getClusterId(),definition.getDefinitionName());
  assertEquals(definition,retrieved);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testCascadeDeleteForCluster() throws Exception {
  AlertDefinitionEntity definition=helper.createAlertDefinition(clusterId);
  definition=dao.findById(definition.getDefinitionId());
  dao.refresh(definition);
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  ClusterEntity clusterEntity=clusterDAO.findById(clusterId);
  clusterDAO.refresh(clusterEntity);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=clusters.getClusterById(clusterId);
  cluster.delete();
  assertNull(clusterDAO.findById(clusterId));
  assertNull(dao.findById(definition.getDefinitionId()));
  assertEquals(0,dispatchDao.findAllGroups(clusterId).size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindAllEnabled(){
  List<AlertDefinitionEntity> definitions=dao.findAll();
  assertNotNull(definitions);
  assertEquals(15,definitions.size());
  List<AlertDefinitionEntity> enabledDefinitions=dao.findAllEnabled(clusterId);
  assertNotNull(enabledDefinitions);
  assertEquals(definitions.size(),enabledDefinitions.size());
  enabledDefinitions.get(0).setEnabled(false);
  dao.merge(enabledDefinitions.get(0));
  enabledDefinitions=dao.findAllEnabled(clusterId);
  assertNotNull(enabledDefinitions);
  assertEquals(definitions.size() - 1,enabledDefinitions.size());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRemove() throws Exception {
  AlertDefinitionEntity definition=helper.createAlertDefinition(clusterId);
  definition=dao.findById(definition.getDefinitionId());
  assertNotNull(definition);
  dao.remove(definition);
  definition=dao.findById(definition.getDefinitionId());
  assertNull(definition);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindAgentScoped(){
  List<AlertDefinitionEntity> definitions=dao.findAgentScoped(clusterId);
  assertNotNull(definitions);
  assertEquals(3,definitions.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindAll(){
  List<AlertDefinitionEntity> definitions=dao.findAll();
  assertNotNull(definitions);
  assertEquals(15,definitions.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.AlertDispatchDAOTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindAllTargets() throws Exception {
  List<AlertTargetEntity> targets=m_dao.findAllTargets();
  assertNotNull(targets);
  assertEquals(5,targets.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests finding groups by a definition ID that they are associatd with.
 * @throws Exception
 */
@Test public void testFindGroupsByDefinition() throws Exception {
  List<AlertDefinitionEntity> definitions=createDefinitions();
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  for (  AlertDefinitionEntity definition : definitions) {
    group.addAlertDefinition(definition);
  }
  m_dao.merge(group);
  group=m_dao.findGroupByName(group.getGroupName());
  assertEquals(definitions.size(),group.getAlertDefinitions().size());
  for (  AlertDefinitionEntity definition : definitions) {
    List<AlertGroupEntity> groups=m_dao.findGroupsByDefinition(definition);
    assertEquals(2,groups.size());
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when creating a new {@link AlertDefinitionEntity}, if the group
 * for its service does not exist, then it will be created.
 */
@Test public void testDefaultGroupAutomaticCreation() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  assertEquals(10,groups.size());
  for (  AlertGroupEntity group : groups) {
    assertFalse(group.isDefault());
  }
  Cluster cluster=m_helper.buildNewCluster(m_clusters,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  AlertGroupEntity hdfsGroup=m_dao.findDefaultServiceGroup(cluster.getClusterId(),"HDFS");
  m_dao.remove(hdfsGroup);
  hdfsGroup=m_dao.findDefaultServiceGroup(cluster.getClusterId(),"HDFS");
  assertNull(hdfsGroup);
  AlertDefinitionEntity datanodeProcess=new AlertDefinitionEntity();
  datanodeProcess.setClusterId(cluster.getClusterId());
  datanodeProcess.setDefinitionName("datanode_process");
  datanodeProcess.setServiceName("HDFS");
  datanodeProcess.setComponentName("DATANODE");
  datanodeProcess.setHash(UUID.randomUUID().toString());
  datanodeProcess.setScheduleInterval(60);
  datanodeProcess.setScope(Scope.SERVICE);
  datanodeProcess.setSource("{\"type\" : \"SCRIPT\"}");
  datanodeProcess.setSourceType(SourceType.SCRIPT);
  m_definitionDao.create(datanodeProcess);
  hdfsGroup=m_dao.findDefaultServiceGroup(cluster.getClusterId(),"HDFS");
  assertNotNull(hdfsGroup);
  assertTrue(hdfsGroup.isDefault());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindAllGlobalTargets() throws Exception {
  List<AlertTargetEntity> targets=m_dao.findAllGlobalTargets();
  assertNotNull(targets);
  assertEquals(0,targets.size());
  m_helper.createGlobalAlertTarget();
  m_helper.createGlobalAlertTarget();
  m_helper.createGlobalAlertTarget();
  targets=m_dao.findAllGlobalTargets();
  assertEquals(3,targets.size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testGlobalTargetAssociations() throws Exception {
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(0,group.getAlertTargets().size());
  AlertTargetEntity target=m_helper.createGlobalAlertTarget();
  assertTrue(target.isGlobal());
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(1,group.getAlertTargets().size());
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  target=m_dao.findTargetById(target.getTargetId());
  assertEquals(groups.size(),target.getAlertGroups().size());
  m_dao.remove(target);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(0,group.getAlertTargets().size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testFindNoticeByUuid() throws Exception {
  List<AlertDefinitionEntity> definitions=createDefinitions();
  AlertDefinitionEntity definition=definitions.get(0);
  AlertHistoryEntity history=new AlertHistoryEntity();
  history.setServiceName(definition.getServiceName());
  history.setClusterId(m_cluster.getClusterId());
  history.setAlertDefinition(definition);
  history.setAlertLabel("Label");
  history.setAlertState(AlertState.OK);
  history.setAlertText("Alert Text");
  history.setAlertTimestamp(System.currentTimeMillis());
  m_alertsDao.create(history);
  AlertTargetEntity target=m_helper.createAlertTarget();
  AlertNoticeEntity notice=new AlertNoticeEntity();
  notice.setUuid(UUID.randomUUID().toString());
  notice.setAlertTarget(target);
  notice.setAlertHistory(history);
  notice.setNotifyState(NotificationState.PENDING);
  m_dao.create(notice);
  AlertNoticeEntity actual=m_dao.findNoticeByUuid(notice.getUuid());
  assertEquals(notice.getNotificationId(),actual.getNotificationId());
  assertNull(m_dao.findNoticeByUuid("DEADBEEF"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindDefaultGroup() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  assertEquals(10,groups.size());
  for (  AlertGroupEntity group : groups) {
    assertFalse(group.isDefault());
  }
  Cluster cluster=m_helper.buildNewCluster(m_clusters,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  AlertGroupEntity hdfsGroup=m_dao.findDefaultServiceGroup(cluster.getClusterId(),"HDFS");
  assertNotNull(hdfsGroup);
  assertTrue(hdfsGroup.isDefault());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that a newly created group is correctly associated with all global
 * targets.
 */
@Test public void testGlobalTargetAssociatedWithNewGroup() throws Exception {
  AlertTargetEntity target1=m_helper.createGlobalAlertTarget();
  AlertTargetEntity target2=m_helper.createGlobalAlertTarget();
  assertTrue(target1.isGlobal());
  assertTrue(target2.isGlobal());
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(2,group.getAlertTargets().size());
  Iterator<AlertTargetEntity> iterator=group.getAlertTargets().iterator();
  AlertTargetEntity groupTarget1=iterator.next();
  AlertTargetEntity groupTarget2=iterator.next();
  assertTrue(groupTarget1.isGlobal());
  assertTrue(groupTarget2.isGlobal());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testDeleteAssociatedTarget() throws Exception {
  AlertTargetEntity target=m_helper.createAlertTarget();
  Set<AlertTargetEntity> targets=new HashSet<AlertTargetEntity>();
  targets.add(target);
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),targets);
  assertEquals(1,group.getAlertTargets().size());
  target=m_dao.findTargetById(target.getTargetId());
  m_dao.refresh(target);
  assertNotNull(target);
  assertEquals(1,target.getAlertGroups().size());
  m_dao.remove(target);
  target=m_dao.findTargetById(target.getTargetId());
  assertNull(target);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(0,group.getAlertTargets().size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testDeleteTarget() throws Exception {
  AlertTargetEntity target=m_helper.createAlertTarget();
  target=m_dao.findTargetById(target.getTargetId());
  assertTrue(target.getAlertStates().size() > 0);
  assertNotNull(target);
  m_dao.remove(target);
  target=m_dao.findTargetById(target.getTargetId());
  assertNull(target);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exception
 */
@Test public void testFindGroupsByIds() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  assertEquals(10,groups.size());
  List<Long> ids=new ArrayList<Long>();
  ids.add(groups.get(0).getGroupId());
  ids.add(groups.get(1).getGroupId());
  ids.add(99999L);
  groups=m_dao.findGroupsById(ids);
  assertEquals(2,groups.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testDeleteTargetWithNotices() throws Exception {
  AlertTargetEntity target=m_helper.createAlertTarget();
  List<AlertDefinitionEntity> definitions=createDefinitions();
  AlertDefinitionEntity definition=definitions.get(0);
  AlertHistoryEntity history=new AlertHistoryEntity();
  history.setServiceName(definition.getServiceName());
  history.setClusterId(m_cluster.getClusterId());
  history.setAlertDefinition(definition);
  history.setAlertLabel("Label");
  history.setAlertState(AlertState.OK);
  history.setAlertText("Alert Text");
  history.setAlertTimestamp(System.currentTimeMillis());
  m_alertsDao.create(history);
  AlertNoticeEntity notice=new AlertNoticeEntity();
  notice.setUuid(UUID.randomUUID().toString());
  notice.setAlertTarget(target);
  notice.setAlertHistory(history);
  notice.setNotifyState(NotificationState.PENDING);
  m_dao.create(notice);
  notice=m_dao.findNoticeById(notice.getNotificationId());
  assertEquals(target.getTargetId(),notice.getAlertTarget().getTargetId());
  target=m_dao.findTargetById(target.getTargetId());
  m_dao.remove(target);
  notice=m_dao.findNoticeById(notice.getNotificationId());
  assertNull(notice);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindTargetByName() throws Exception {
  List<AlertTargetEntity> targets=m_dao.findAllTargets();
  assertNotNull(targets);
  AlertTargetEntity target=targets.get(3);
  AlertTargetEntity actual=m_dao.findTargetByName(target.getTargetName());
  assertEquals(target,actual);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testDeleteGroup() throws Exception {
  int targetCount=m_dao.findAllTargets().size();
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  AlertTargetEntity target=m_helper.createAlertTarget();
  assertEquals(targetCount + 1,m_dao.findAllTargets().size());
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertNotNull(group.getAlertTargets());
  assertEquals(0,group.getAlertTargets().size());
  group.addAlertTarget(target);
  m_dao.merge(group);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertNotNull(group.getAlertTargets());
  assertEquals(1,group.getAlertTargets().size());
  m_dao.remove(group);
  group=m_dao.findGroupById(group.getGroupId());
  assertNull(group);
  target=m_dao.findTargetById(target.getTargetId());
  assertNotNull(target);
  assertEquals(targetCount + 1,m_dao.findAllTargets().size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when creating a new {@link AlertDefinitionEntity}, if the group
 * for its service does not exist, then it will not be created if the service
 * is invalid.
 */
@Test(expected=AmbariException.class) public void testDefaultGroupInvalidServiceNoCreation() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  assertEquals(10,groups.size());
  for (  AlertGroupEntity group : groups) {
    assertFalse(group.isDefault());
  }
  Cluster cluster=m_helper.buildNewCluster(m_clusters,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  assertEquals(12,m_dao.findAllGroups().size());
  AlertDefinitionEntity datanodeProcess=new AlertDefinitionEntity();
  datanodeProcess.setClusterId(cluster.getClusterId());
  datanodeProcess.setDefinitionName("datanode_process");
  datanodeProcess.setServiceName("INVALID");
  datanodeProcess.setComponentName("DATANODE");
  datanodeProcess.setHash(UUID.randomUUID().toString());
  datanodeProcess.setScheduleInterval(60);
  datanodeProcess.setScope(Scope.SERVICE);
  datanodeProcess.setSource("{\"type\" : \"SCRIPT\"}");
  datanodeProcess.setSourceType(SourceType.SCRIPT);
  try {
    m_definitionDao.create(datanodeProcess);
  }
  finally {
    assertEquals(12,m_dao.findAllGroups().size());
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testCreateTarget() throws Exception {
  int targetCount=m_dao.findAllTargets().size();
  AlertTargetEntity target=m_helper.createAlertTarget();
  Set<AlertTargetEntity> targets=new HashSet<AlertTargetEntity>();
  targets.add(target);
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),targets);
  AlertTargetEntity actual=m_dao.findTargetById(target.getTargetId());
  assertNotNull(actual);
  assertEquals(target.getTargetName(),actual.getTargetName());
  assertEquals(target.getDescription(),actual.getDescription());
  assertEquals(target.getNotificationType(),actual.getNotificationType());
  assertEquals(target.getProperties(),actual.getProperties());
  assertEquals(false,actual.isGlobal());
  assertNotNull(actual.getAlertGroups());
  Iterator<AlertGroupEntity> iterator=actual.getAlertGroups().iterator();
  AlertGroupEntity actualGroup=iterator.next();
  assertEquals(group,actualGroup);
  assertEquals(targetCount + 1,m_dao.findAllTargets().size());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testGroupDefinitions() throws Exception {
  List<AlertDefinitionEntity> definitions=createDefinitions();
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  for (  AlertDefinitionEntity definition : definitions) {
    group.addAlertDefinition(definition);
  }
  m_dao.merge(group);
  group=m_dao.findGroupByName(group.getGroupName());
  assertEquals(definitions.size(),group.getAlertDefinitions().size());
  for (  AlertDefinitionEntity definition : definitions) {
    assertTrue(group.getAlertDefinitions().contains(definition));
  }
  m_definitionDao.refresh(definitions.get(0));
  m_definitionDao.remove(definitions.get(0));
  definitions.remove(0);
  group=m_dao.findGroupByName(group.getGroupName());
  assertEquals(definitions.size(),group.getAlertDefinitions().size());
  for (  AlertDefinitionEntity definition : definitions) {
    assertTrue(group.getAlertDefinitions().contains(definition));
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests finding groups by a definition ID that they are associatd with in
 * order to get any targets associated with that group. This exercises the
 * bi-directional
 * @throws Exception
 */
@Test public void testFindTargetsViaGroupsByDefinition() throws Exception {
  List<AlertDefinitionEntity> definitions=createDefinitions();
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),null);
  group=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  AlertDefinitionEntity definition=definitions.get(0);
  group.addAlertDefinition(definition);
  m_dao.merge(group);
  List<AlertTargetEntity> targets=m_dao.findAllTargets();
  AlertTargetEntity target=targets.get(0);
  Set<AlertTargetEntity> setTargets=Collections.singleton(target);
  group.setAlertTargets(setTargets);
  m_dao.merge(group);
  List<AlertGroupEntity> groups=m_dao.findGroupsByDefinition(definition);
  assertEquals(2,groups.size());
  group=groups.get(groups.indexOf(group));
  assertEquals(1,group.getAlertTargets().size());
  assertEquals(target.getTargetId(),group.getAlertTargets().iterator().next().getTargetId());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testCreateGroup() throws Exception {
  AlertTargetEntity target=m_helper.createAlertTarget();
  Set<AlertTargetEntity> targets=new HashSet<AlertTargetEntity>();
  targets.add(target);
  AlertGroupEntity group=m_helper.createAlertGroup(m_cluster.getClusterId(),targets);
  AlertGroupEntity actual=m_dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  assertEquals(group.getGroupName(),actual.getGroupName());
  assertEquals(group.isDefault(),actual.isDefault());
  assertEquals(group.getAlertTargets(),actual.getAlertTargets());
  assertEquals(group.getAlertDefinitions(),actual.getAlertDefinitions());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindGroupByName() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  AlertGroupEntity group=groups.get(3);
  AlertGroupEntity actual=m_dao.findGroupByName(group.getClusterId(),group.getGroupName());
  assertEquals(group,actual);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindAllGroups() throws Exception {
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  assertEquals(10,groups.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.AlertsDAOTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test looking up current by a host name.
 */
@Test public void testFindCurrentByHost() throws Exception {
  AlertDefinitionEntity hostDef=new AlertDefinitionEntity();
  hostDef.setDefinitionName("Host Alert Definition ");
  hostDef.setServiceName("YARN");
  hostDef.setComponentName(null);
  hostDef.setClusterId(m_cluster.getClusterId());
  hostDef.setHash(UUID.randomUUID().toString());
  hostDef.setScheduleInterval(Integer.valueOf(60));
  hostDef.setScope(Scope.HOST);
  hostDef.setSource("{\"type\" : \"SCRIPT\"}");
  hostDef.setSourceType(SourceType.SCRIPT);
  m_definitionDao.create(hostDef);
  AlertHistoryEntity history=new AlertHistoryEntity();
  history.setServiceName(hostDef.getServiceName());
  history.setClusterId(m_cluster.getClusterId());
  history.setAlertDefinition(hostDef);
  history.setAlertLabel(hostDef.getDefinitionName());
  history.setAlertText(hostDef.getDefinitionName());
  history.setAlertTimestamp(Long.valueOf(1L));
  history.setHostName(HOSTNAME);
  history.setAlertState(AlertState.OK);
  AlertCurrentEntity current=new AlertCurrentEntity();
  current.setOriginalTimestamp(1L);
  current.setLatestTimestamp(2L);
  current.setAlertHistory(history);
  m_dao.create(current);
  Predicate hostPredicate=null;
  hostPredicate=new PredicateBuilder().property(AlertResourceProvider.ALERT_HOST).equals(HOSTNAME).toPredicate();
  AlertCurrentRequest request=new AlertCurrentRequest();
  request.Predicate=hostPredicate;
  List<AlertCurrentEntity> currentAlerts=m_dao.findAll(request);
  assertNotNull(currentAlerts);
  assertEquals(1,currentAlerts.size());
  hostPredicate=new PredicateBuilder().property(AlertResourceProvider.ALERT_HOST).equals("invalid.apache.org").toPredicate();
  request=new AlertCurrentRequest();
  request.Predicate=hostPredicate;
  currentAlerts=m_dao.findAll(request);
  assertNotNull(currentAlerts);
  assertEquals(0,currentAlerts.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveCurrenyByHost() throws Exception {
  List<AlertCurrentEntity> currentAlerts=m_dao.findCurrent();
  assertNotNull(currentAlerts);
  assertEquals(5,currentAlerts.size());
  m_dao.removeCurrentByHost("h2");
  currentAlerts=m_dao.findCurrent();
  assertEquals(5,currentAlerts.size());
  m_dao.removeCurrentByHost("h1");
  currentAlerts=m_dao.findCurrent();
  assertEquals(0,currentAlerts.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindAll(){
  List<AlertHistoryEntity> alerts=m_dao.findAll(m_cluster.getClusterId());
  assertNotNull(alerts);
  assertEquals(50,alerts.size());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFindCurrentByHostAndName() throws Exception {
  AlertCurrentEntity entity=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),"h2","Alert Definition 1");
  assertNull(entity);
  entity=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),"h1","Alert Definition 1");
  assertNotNull(entity);
  assertNotNull(entity.getAlertHistory());
  assertNotNull(entity.getAlertHistory().getAlertDefinition());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindCurrentByService(){
  List<AlertCurrentEntity> currentAlerts=m_dao.findCurrent();
  int currentAlertExpectedCount=currentAlerts.size();
  assertEquals(5,currentAlertExpectedCount);
  AlertCurrentEntity current=currentAlerts.get(0);
  AlertHistoryEntity history=current.getAlertHistory();
  assertNotNull(history);
  currentAlerts=m_dao.findCurrentByService(m_cluster.getClusterId(),history.getServiceName());
  assertNotNull(currentAlerts);
  assertEquals(currentAlertExpectedCount,currentAlerts.size());
  currentAlerts=m_dao.findCurrentByService(m_cluster.getClusterId(),"foo");
  assertNotNull(currentAlerts);
  assertEquals(0,currentAlerts.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindByState(){
  List<AlertState> allStates=new ArrayList<AlertState>();
  allStates.add(AlertState.OK);
  allStates.add(AlertState.WARNING);
  allStates.add(AlertState.CRITICAL);
  List<AlertHistoryEntity> history=m_dao.findAll(m_cluster.getClusterId(),allStates);
  assertNotNull(history);
  assertEquals(50,history.size());
  history=m_dao.findAll(m_cluster.getClusterId(),Collections.singletonList(AlertState.OK));
  assertNotNull(history);
  assertEquals(40,history.size());
  history=m_dao.findAll(m_cluster.getClusterId(),Collections.singletonList(AlertState.CRITICAL));
  assertNotNull(history);
  assertEquals(10,history.size());
  history=m_dao.findAll(m_cluster.getClusterId(),Collections.singletonList(AlertState.WARNING));
  assertNotNull(history);
  assertEquals(0,history.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveCurrenyByService() throws Exception {
  List<AlertCurrentEntity> currentAlerts=m_dao.findCurrent();
  assertNotNull(currentAlerts);
  assertEquals(5,currentAlerts.size());
  m_dao.removeCurrentByService(m_cluster.getClusterId(),"HDFS");
  currentAlerts=m_dao.findCurrent();
  assertEquals(5,currentAlerts.size());
  m_dao.removeCurrentByService(m_cluster.getClusterId(),"YARN");
  currentAlerts=m_dao.findCurrent();
  assertEquals(0,currentAlerts.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindByDate(){
  calendar.clear();
  calendar.set(2014,Calendar.JANUARY,1);
  List<AlertHistoryEntity> history=m_dao.findAll(m_cluster.getClusterId(),calendar.getTime(),null);
  assertNotNull(history);
  assertEquals(50,history.size());
  history=m_dao.findAll(m_cluster.getClusterId(),null,calendar.getTime());
  assertNotNull(history);
  assertEquals(1,history.size());
  calendar.set(2014,Calendar.JANUARY,5);
  Date startDate=calendar.getTime();
  calendar.set(2014,Calendar.JANUARY,10);
  Date endDate=calendar.getTime();
  history=m_dao.findAll(m_cluster.getClusterId(),startDate,endDate);
  assertNotNull(history);
  assertEquals(6,history.size());
  calendar.set(2014,Calendar.MARCH,5);
  history=m_dao.findAll(m_cluster.getClusterId(),calendar.getTime(),null);
  assertNotNull(history);
  assertEquals(0,history.size());
  history=m_dao.findAll(m_cluster.getClusterId(),endDate,startDate);
  assertNotNull(history);
  assertEquals(0,history.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testFindAllCurrent(){
  List<AlertCurrentEntity> currentAlerts=m_dao.findCurrent();
  assertNotNull(currentAlerts);
  assertEquals(5,currentAlerts.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the Ambari {@link Predicate} can be converted and submitted to
 * JPA correctly to return a restricted result set.
 * @throws Exception
 */
@Test public void testAlertCurrentPredicate() throws Exception {
  AlertDefinitionEntity definition=m_definitionDao.findByName(m_cluster.getClusterId(),"Alert Definition 0");
  assertNotNull(definition);
  Predicate definitionIdPredicate=null;
  Predicate hdfsPredicate=null;
  Predicate yarnPredicate=null;
  definitionIdPredicate=new PredicateBuilder().property(AlertResourceProvider.ALERT_DEFINITION_ID).equals(definition.getDefinitionId()).toPredicate();
  AlertCurrentRequest request=new AlertCurrentRequest();
  request.Predicate=definitionIdPredicate;
  List<AlertCurrentEntity> currentAlerts=m_dao.findAll(request);
  assertEquals(1,currentAlerts.size());
  hdfsPredicate=new PredicateBuilder().property(AlertResourceProvider.ALERT_SERVICE).equals("HDFS").toPredicate();
  yarnPredicate=new PredicateBuilder().property(AlertResourceProvider.ALERT_SERVICE).equals("YARN").toPredicate();
  request.Predicate=yarnPredicate;
  currentAlerts=m_dao.findAll(request);
  assertEquals(5,currentAlerts.size());
  request.Predicate=hdfsPredicate;
  currentAlerts=m_dao.findAll(request);
  assertEquals(0,currentAlerts.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveCurrenyByComponentHost() throws Exception {
  List<AlertCurrentEntity> currentAlerts=m_dao.findCurrent();
  assertNotNull(currentAlerts);
  assertEquals(5,currentAlerts.size());
  AlertCurrentEntity entity=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),"h1","Alert Definition 1");
  assertNotNull(entity);
  m_dao.removeCurrentByServiceComponentHost(m_cluster.getClusterId(),entity.getAlertHistory().getServiceName(),entity.getAlertHistory().getComponentName(),entity.getAlertHistory().getHostName());
  currentAlerts=m_dao.findCurrent();
  assertEquals(4,currentAlerts.size());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that maintenance mode is set correctly on notices.
 * @throws Exception
 */
@Test public void testMaintenanceMode() throws Exception {
  m_helper.installHdfsService(m_cluster,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  List<AlertCurrentEntity> currents=m_dao.findCurrent();
  for (  AlertCurrentEntity current : currents) {
    m_dao.remove(current);
  }
  AlertDefinitionEntity namenode=new AlertDefinitionEntity();
  namenode.setDefinitionName("NAMENODE");
  namenode.setServiceName("HDFS");
  namenode.setComponentName("NAMENODE");
  namenode.setClusterId(m_cluster.getClusterId());
  namenode.setHash(UUID.randomUUID().toString());
  namenode.setScheduleInterval(Integer.valueOf(60));
  namenode.setScope(Scope.ANY);
  namenode.setSource("{\"type\" : \"SCRIPT\"}");
  namenode.setSourceType(SourceType.SCRIPT);
  m_definitionDao.create(namenode);
  AlertDefinitionEntity datanode=new AlertDefinitionEntity();
  datanode.setDefinitionName("DATANODE");
  datanode.setServiceName("HDFS");
  datanode.setComponentName("DATANODE");
  datanode.setClusterId(m_cluster.getClusterId());
  datanode.setHash(UUID.randomUUID().toString());
  datanode.setScheduleInterval(Integer.valueOf(60));
  datanode.setScope(Scope.HOST);
  datanode.setSource("{\"type\" : \"SCRIPT\"}");
  datanode.setSourceType(SourceType.SCRIPT);
  m_definitionDao.create(datanode);
  AlertDefinitionEntity aggregate=new AlertDefinitionEntity();
  aggregate.setDefinitionName("DATANODE_UP");
  aggregate.setServiceName("HDFS");
  aggregate.setComponentName(null);
  aggregate.setClusterId(m_cluster.getClusterId());
  aggregate.setHash(UUID.randomUUID().toString());
  aggregate.setScheduleInterval(Integer.valueOf(60));
  aggregate.setScope(Scope.SERVICE);
  aggregate.setSource("{\"type\" : \"SCRIPT\"}");
  aggregate.setSourceType(SourceType.SCRIPT);
  m_definitionDao.create(aggregate);
  AlertHistoryEntity nnHistory=new AlertHistoryEntity();
  nnHistory.setAlertState(AlertState.OK);
  nnHistory.setServiceName(namenode.getServiceName());
  nnHistory.setComponentName(namenode.getComponentName());
  nnHistory.setClusterId(m_cluster.getClusterId());
  nnHistory.setAlertDefinition(namenode);
  nnHistory.setAlertLabel(namenode.getDefinitionName());
  nnHistory.setAlertText(namenode.getDefinitionName());
  nnHistory.setAlertTimestamp(calendar.getTimeInMillis());
  nnHistory.setHostName(HOSTNAME);
  m_dao.create(nnHistory);
  AlertCurrentEntity nnCurrent=new AlertCurrentEntity();
  nnCurrent.setAlertHistory(nnHistory);
  nnCurrent.setLatestText(nnHistory.getAlertText());
  nnCurrent.setMaintenanceState(MaintenanceState.OFF);
  nnCurrent.setOriginalTimestamp(System.currentTimeMillis());
  nnCurrent.setLatestTimestamp(System.currentTimeMillis());
  m_dao.create(nnCurrent);
  AlertHistoryEntity dnHistory=new AlertHistoryEntity();
  dnHistory.setAlertState(AlertState.WARNING);
  dnHistory.setServiceName(datanode.getServiceName());
  dnHistory.setComponentName(datanode.getComponentName());
  dnHistory.setClusterId(m_cluster.getClusterId());
  dnHistory.setAlertDefinition(datanode);
  dnHistory.setAlertLabel(datanode.getDefinitionName());
  dnHistory.setAlertText(datanode.getDefinitionName());
  dnHistory.setAlertTimestamp(calendar.getTimeInMillis());
  dnHistory.setHostName(HOSTNAME);
  m_dao.create(dnHistory);
  AlertCurrentEntity dnCurrent=new AlertCurrentEntity();
  dnCurrent.setAlertHistory(dnHistory);
  dnCurrent.setLatestText(dnHistory.getAlertText());
  dnCurrent.setMaintenanceState(MaintenanceState.OFF);
  dnCurrent.setOriginalTimestamp(System.currentTimeMillis());
  dnCurrent.setLatestTimestamp(System.currentTimeMillis());
  m_dao.create(dnCurrent);
  AlertHistoryEntity aggregateHistory=new AlertHistoryEntity();
  aggregateHistory.setAlertState(AlertState.CRITICAL);
  aggregateHistory.setServiceName(aggregate.getServiceName());
  aggregateHistory.setComponentName(aggregate.getComponentName());
  aggregateHistory.setClusterId(m_cluster.getClusterId());
  aggregateHistory.setAlertDefinition(aggregate);
  aggregateHistory.setAlertLabel(aggregate.getDefinitionName());
  aggregateHistory.setAlertText(aggregate.getDefinitionName());
  aggregateHistory.setAlertTimestamp(calendar.getTimeInMillis());
  m_dao.create(aggregateHistory);
  AlertCurrentEntity aggregateCurrent=new AlertCurrentEntity();
  aggregateCurrent.setAlertHistory(aggregateHistory);
  aggregateCurrent.setLatestText(aggregateHistory.getAlertText());
  aggregateCurrent.setMaintenanceState(MaintenanceState.OFF);
  aggregateCurrent.setOriginalTimestamp(System.currentTimeMillis());
  aggregateCurrent.setLatestTimestamp(System.currentTimeMillis());
  m_dao.create(aggregateCurrent);
  currents=m_dao.findCurrent();
  assertEquals(3,currents.size());
  for (  AlertCurrentEntity current : currents) {
    assertEquals(MaintenanceState.OFF,current.getMaintenanceState());
  }
  Service hdfs=m_clusters.getClusterById(m_cluster.getClusterId()).getService("HDFS");
  hdfs.setMaintenanceState(MaintenanceState.ON);
  currents=m_dao.findCurrent();
  assertEquals(3,currents.size());
  for (  AlertCurrentEntity current : currents) {
    assertEquals(MaintenanceState.ON,current.getMaintenanceState());
  }
  hdfs.setMaintenanceState(MaintenanceState.OFF);
  currents=m_dao.findCurrent();
  assertEquals(3,currents.size());
  for (  AlertCurrentEntity current : currents) {
    assertEquals(MaintenanceState.OFF,current.getMaintenanceState());
  }
  Host host=m_clusters.getHost(HOSTNAME);
  host.setMaintenanceState(m_cluster.getClusterId(),MaintenanceState.ON);
  currents=m_dao.findCurrent();
  assertEquals(3,currents.size());
  for (  AlertCurrentEntity current : currents) {
    if (current.getAlertHistory().getComponentName() != null) {
      assertEquals(MaintenanceState.ON,current.getMaintenanceState());
    }
 else {
      assertEquals(MaintenanceState.OFF,current.getMaintenanceState());
    }
  }
  host.setMaintenanceState(m_cluster.getClusterId(),MaintenanceState.OFF);
  currents=m_dao.findCurrent();
  assertEquals(3,currents.size());
  for (  AlertCurrentEntity current : currents) {
    assertEquals(MaintenanceState.OFF,current.getMaintenanceState());
  }
  ServiceComponentHost nnComponent=null;
  List<ServiceComponentHost> schs=m_cluster.getServiceComponentHosts(HOSTNAME);
  for (  ServiceComponentHost sch : schs) {
    if ("NAMENODE".equals(sch.getServiceComponentName())) {
      sch.setMaintenanceState(MaintenanceState.ON);
      nnComponent=sch;
    }
  }
  assertNotNull(nnComponent);
  currents=m_dao.findCurrent();
  assertEquals(3,currents.size());
  for (  AlertCurrentEntity current : currents) {
    if ("NAMENODE".equals(current.getAlertHistory().getComponentName())) {
      assertEquals(MaintenanceState.ON,current.getMaintenanceState());
    }
 else {
      assertEquals(MaintenanceState.OFF,current.getMaintenanceState());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveCurrentDisabled() throws Exception {
  List<AlertCurrentEntity> currentAlerts=m_dao.findCurrent();
  assertNotNull(currentAlerts);
  assertEquals(5,currentAlerts.size());
  AlertDefinitionEntity definition=currentAlerts.get(0).getAlertHistory().getAlertDefinition();
  definition.setEnabled(false);
  m_definitionDao.merge(definition);
  m_dao.removeCurrentDisabledAlerts();
  currentAlerts=m_dao.findCurrent();
  assertEquals(4,currentAlerts.size());
}

</code></pre>

<br>
<pre class="type-7 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Before public void setup() throws Exception {
  m_injector=Guice.createInjector(new InMemoryDefaultTestModule());
  m_injector.getInstance(GuiceJpaInitializer.class);
  m_injector.getInstance(UnitOfWork.class).begin();
  m_helper=m_injector.getInstance(OrmTestHelper.class);
  m_dao=m_injector.getInstance(AlertsDAO.class);
  m_definitionDao=m_injector.getInstance(AlertDefinitionDAO.class);
  m_serviceFactory=m_injector.getInstance(ServiceFactory.class);
  m_componentFactory=m_injector.getInstance(ServiceComponentFactory.class);
  m_schFactory=m_injector.getInstance(ServiceComponentHostFactory.class);
  m_clusters=m_injector.getInstance(Clusters.class);
  m_alertHelper=m_injector.getInstance(AlertDaoHelper.class);
  EventBusSynchronizer.synchronizeAmbariEventPublisher(m_injector);
  m_cluster=m_clusters.getClusterById(m_helper.createCluster());
  m_helper.initializeClusterWithStack(m_cluster);
  m_helper.addHost(m_clusters,m_cluster,HOSTNAME);
  m_helper.installYarnService(m_cluster,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  for (int i=0; i < 5; i++) {
    AlertDefinitionEntity definition=new AlertDefinitionEntity();
    definition.setDefinitionName("Alert Definition " + i);
    definition.setServiceName("YARN");
    definition.setComponentName("Component " + i);
    definition.setClusterId(m_cluster.getClusterId());
    definition.setHash(UUID.randomUUID().toString());
    definition.setScheduleInterval(Integer.valueOf(60));
    definition.setScope(Scope.SERVICE);
    definition.setSource("{\"type\" : \"SCRIPT\"}");
    definition.setSourceType(SourceType.SCRIPT);
    m_definitionDao.create(definition);
  }
  List<AlertDefinitionEntity> definitions=m_definitionDao.findAll();
  assertNotNull(definitions);
  assertEquals(5,definitions.size());
  calendar.clear();
  calendar.set(2014,Calendar.JANUARY,1);
  for (  AlertDefinitionEntity definition : definitions) {
    for (int i=0; i < 10; i++) {
      AlertHistoryEntity history=new AlertHistoryEntity();
      history.setServiceName(definition.getServiceName());
      history.setClusterId(m_cluster.getClusterId());
      history.setAlertDefinition(definition);
      history.setAlertLabel(definition.getDefinitionName() + " " + i);
      history.setAlertText(definition.getDefinitionName() + " " + i);
      history.setAlertTimestamp(calendar.getTimeInMillis());
      history.setComponentName(definition.getComponentName());
      history.setHostName("h1");
      history.setAlertState(AlertState.OK);
      if (i == 0 || i == 5) {
        history.setAlertState(AlertState.CRITICAL);
      }
      calendar.add(Calendar.DATE,1);
      m_dao.create(history);
    }
  }
  for (  AlertDefinitionEntity definition : definitions) {
    List<AlertHistoryEntity> alerts=m_dao.findAll();
    AlertHistoryEntity history=null;
    for (    AlertHistoryEntity alert : alerts) {
      if (definition.equals(alert.getAlertDefinition())) {
        history=alert;
      }
    }
    assertNotNull(history);
    AlertCurrentEntity current=new AlertCurrentEntity();
    current.setAlertHistory(history);
    current.setLatestTimestamp(new Date().getTime());
    current.setOriginalTimestamp(new Date().getTime() - 10800000);
    current.setMaintenanceState(MaintenanceState.OFF);
    m_dao.create(current);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.ClusterVersionDAOTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * At all times the cluster should have a cluster version whose state is {@link org.apache.ambari.server.state.RepositoryVersionState#CURRENT}
 */
@Test public void testFindByClusterAndStateCurrent(){
  createRecordsUntilStep(1);
  Assert.assertNotNull(clusterVersionDAO.findByClusterAndStateCurrent(cluster.getClusterName()));
  createRecordsUntilStep(2);
  Assert.assertNotNull(clusterVersionDAO.findByClusterAndStateCurrent(cluster.getClusterName()));
  createRecordsUntilStep(3);
  Assert.assertNotNull(clusterVersionDAO.findByClusterAndStateCurrent(cluster.getClusterName()));
  createRecordsUntilStep(4);
  Assert.assertNotNull(clusterVersionDAO.findByClusterAndStateCurrent(cluster.getClusterName()));
  createRecordsUntilStep(5);
  Assert.assertNotNull(clusterVersionDAO.findByClusterAndStateCurrent(cluster.getClusterName()));
  createRecordsUntilStep(6);
  Assert.assertNotNull(clusterVersionDAO.findByClusterAndStateCurrent(cluster.getClusterName()));
  createRecordsUntilStep(7);
  Assert.assertNotNull(clusterVersionDAO.findByClusterAndStateCurrent(cluster.getClusterName()));
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFindByClusterAndStackAndVersion(){
  createRecordsUntilStep(1);
  Assert.assertNull(clusterVersionDAO.findByClusterAndStackAndVersion(cluster.getClusterName(),BAD_STACK,"non existing"));
  Assert.assertNotNull(clusterVersionDAO.findByClusterAndStackAndVersion(cluster.getClusterName(),HDP_22_STACK,"2.2.0.0-995"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.ConfigGroupDAOTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindByName() throws Exception {
  createConfigGroup("c1","hdfs-1","HDFS","some description",null,null);
  ConfigGroupEntity configGroupEntity=configGroupDAO.findByName("hdfs-1");
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals("c1",configGroupEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),configGroupEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("hdfs-1",configGroupEntity.getGroupName());
  Assert.assertEquals("HDFS",configGroupEntity.getTag());
  Assert.assertEquals("some description",configGroupEntity.getDescription());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreatePlaneJaneCG() throws Exception {
  ConfigGroupEntity configGroupEntity=createConfigGroup("c1","hdfs-1","HDFS","some description",null,null);
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals("c1",configGroupEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),configGroupEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("hdfs-1",configGroupEntity.getGroupName());
  Assert.assertEquals("HDFS",configGroupEntity.getTag());
  Assert.assertEquals("some description",configGroupEntity.getDescription());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindByTag() throws Exception {
  createConfigGroup("c1","hdfs-1","HDFS","some description",null,null);
  List<ConfigGroupEntity> configGroupEntities=configGroupDAO.findAllByTag("HDFS");
  Assert.assertNotNull(configGroupEntities);
  ConfigGroupEntity configGroupEntity=configGroupEntities.get(0);
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals("c1",configGroupEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),configGroupEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("hdfs-1",configGroupEntity.getGroupName());
  Assert.assertEquals("HDFS",configGroupEntity.getTag());
  Assert.assertEquals("some description",configGroupEntity.getDescription());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindConfigsByGroup() throws Exception {
  StackEntity stackEntity=stackDAO.find("HDP","0.1");
  ClusterConfigEntity configEntity=new ClusterConfigEntity();
  configEntity.setType("core-site");
  configEntity.setTag("version1");
  configEntity.setData("someData");
  configEntity.setAttributes("someAttributes");
  configEntity.setStack(stackEntity);
  List<ClusterConfigEntity> configEntities=new ArrayList<ClusterConfigEntity>();
  configEntities.add(configEntity);
  ConfigGroupEntity configGroupEntity=createConfigGroup("c1","hdfs-1","HDFS","some description",null,configEntities);
  Assert.assertNotNull(configGroupEntity);
  Assert.assertTrue(configGroupEntity.getConfigGroupConfigMappingEntities().size() > 0);
  List<ConfigGroupConfigMappingEntity> configMappingEntities=configGroupConfigMappingDAO.findByGroup(configGroupEntity.getGroupId());
  Assert.assertNotNull(configEntities);
  Assert.assertEquals("core-site",configEntities.get(0).getType());
  Assert.assertEquals("version1",configEntities.get(0).getTag());
  Assert.assertEquals("someData",configEntities.get(0).getData());
  Assert.assertEquals("someAttributes",configEntities.get(0).getAttributes());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindByHost() throws Exception {
  List<HostEntity> hosts=new ArrayList<HostEntity>();
  HostEntity hostEntity=new HostEntity();
  hostEntity.setHostName("h1");
  hostEntity.setOsType("centOS");
  hosts.add(hostEntity);
  ConfigGroupEntity configGroupEntity=createConfigGroup("c1","hdfs-1","HDFS","some description",hosts,null);
  Assert.assertNotNull(hostEntity.getHostId());
  Assert.assertNotNull(configGroupEntity);
  Assert.assertTrue(configGroupEntity.getConfigGroupHostMappingEntities().size() > 0);
  Assert.assertNotNull(configGroupEntity.getConfigGroupHostMappingEntities().iterator().next());
  Set<ConfigGroupHostMapping> hostMappingEntities=configGroupHostMappingDAO.findByHostId(hostEntity.getHostId());
  Assert.assertNotNull(hostMappingEntities);
  for (  ConfigGroupHostMapping hostMappingEntity : hostMappingEntities) {
    Assert.assertEquals(hostEntity.getHostId(),hostMappingEntity.getHostId());
    Assert.assertEquals("centOS",hostMappingEntity.getHost().getOsType());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.CrudDAOTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove(){
  createSingleRecord();
  createSingleRecord();
  Assert.assertEquals(2,repositoryVersionDAO.findAll().size());
  repositoryVersionDAO.remove(repositoryVersionDAO.findByPK(FIRST_ID));
  Assert.assertEquals(1,repositoryVersionDAO.findAll().size());
  Assert.assertNull(repositoryVersionDAO.findByPK(1L));
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFindByPK(){
  Assert.assertNull(repositoryVersionDAO.findByPK(FIRST_ID));
  createSingleRecord();
  Assert.assertNotNull(repositoryVersionDAO.findByPK(FIRST_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.HostConfigMappingDAOTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindSelectedByType() throws Exception {
  HostConfigMapping entity1=createEntity(1L,"h1","global","version1");
  HostEntity hostEntity=hostDAO.findByName("h1");
  HostConfigMapping target=hostConfigMappingDAO.findSelectedByType(1L,hostEntity.getHostId(),"core-site");
  Assert.assertNull("Expected null entity for type 'core-site'",target);
  target=hostConfigMappingDAO.findSelectedByType(1L,hostEntity.getHostId(),"global");
  Assert.assertNotNull("Expected non-null entity for type 'global'",target);
  Assert.assertEquals("Expected version to be '" + entity1.getVersion() + "'",entity1.getVersion(),target.getVersion());
  target.setSelected(0);
  hostConfigMappingDAO.merge(target);
  HostConfigMapping entity2=createEntity(1L,"h1","global","version2");
  target=hostConfigMappingDAO.findSelectedByType(1L,hostEntity.getHostId(),"global");
  Assert.assertNotNull("Expected non-null entity for type 'global'",target);
  Assert.assertEquals("Expected version to be '" + entity2.getVersion() + "'",entity2.getVersion(),target.getVersion());
  Assert.assertEquals("Expected instance equality",entity2,target);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.KerberosDescriptorDAOTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPersistNewKerberosDescriptorEntity(){
  KerberosDescriptorEntity kerberosDescriptorEntity=new KerberosDescriptorEntity();
  kerberosDescriptorEntity.setName(TEST_KERBEROS_DESCRIPTOR_ENTITY_NAME);
  Capture<KerberosDescriptorEntity> capturedArgument=EasyMock.newCapture();
  entityManager.persist(capture(capturedArgument));
  replay(entityManager);
  kerberosDescriptorDAO.create(kerberosDescriptorEntity);
  Assert.assertNotNull(capturedArgument);
  Assert.assertEquals("The persisted object is not the expected one",kerberosDescriptorEntity,capturedArgument.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.RepositoryVersionDAOTest </h4><pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate(){
  UUID uuid=UUID.randomUUID();
  RepositoryVersionEntity first=createSingleRecord();
  Assert.assertNotNull(first);
  StackEntity stackEntity=stackDAO.find(first.getStackName(),first.getStackVersion());
  Assert.assertNotNull(stackEntity);
  RepositoryVersionEntity dupVersion=new RepositoryVersionEntity();
  dupVersion.setDisplayName("display name " + uuid.toString());
  dupVersion.setOperatingSystems("repositories");
  dupVersion.setStack(stackEntity);
  dupVersion.setVersion(first.getVersion());
  boolean exceptionThrown=false;
  try {
    repositoryVersionDAO.create(stackEntity,dupVersion.getVersion(),dupVersion.getDisplayName(),dupVersion.getOperatingSystemsJson());
  }
 catch (  AmbariException e) {
    exceptionThrown=true;
    Assert.assertTrue(e.getMessage().contains("already exists"));
  }
  Assert.assertTrue(exceptionThrown);
  exceptionThrown=false;
  dupVersion.setVersion("2.3-1234");
  try {
    repositoryVersionDAO.create(stackEntity,dupVersion.getVersion(),dupVersion.getDisplayName(),dupVersion.getOperatingSystemsJson());
  }
 catch (  AmbariException e) {
    exceptionThrown=true;
    Assert.assertTrue(e.getMessage().contains("needs to belong to stack"));
  }
  Assert.assertTrue(exceptionThrown);
  dupVersion.setVersion(stackEntity.getStackVersion() + "-1234");
  try {
    repositoryVersionDAO.create(stackEntity,dupVersion.getVersion(),dupVersion.getDisplayName(),dupVersion.getOperatingSystemsJson());
  }
 catch (  AmbariException e) {
    Assert.fail("Did not expect a failure creating the Repository Version");
  }
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDeleteCascade(){
  long clusterId=helper.createCluster();
  ClusterEntity cluster=clusterDAO.findById(clusterId);
  createSingleRecord();
  final RepositoryVersionEntity entity=repositoryVersionDAO.findByStackAndVersion(HDP_206,"version");
  ClusterVersionEntity cvA=new ClusterVersionEntity(cluster,entity,RepositoryVersionState.INSTALLED,System.currentTimeMillis(),System.currentTimeMillis(),"admin");
  clusterVersionDAO.create(cvA);
  long cvAId=cvA.getId();
  cvA=clusterVersionDAO.findByPK(cvAId);
  Assert.assertNotNull(cvA.getRepositoryVersion());
  final RepositoryVersionEntity newEntity=repositoryVersionDAO.findByStackAndVersion(HDP_206,"version");
  try {
    repositoryVersionDAO.remove(newEntity);
  }
 catch (  Exception e) {
    Assert.assertNotNull(clusterVersionDAO.findByPK(cvAId));
  }
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDelete(){
  createSingleRecord();
  Assert.assertNotNull(repositoryVersionDAO.findByStackAndVersion(HDP_206,"version"));
  final RepositoryVersionEntity entity=repositoryVersionDAO.findByStackAndVersion(HDP_206,"version");
  repositoryVersionDAO.remove(entity);
  Assert.assertNull(repositoryVersionDAO.findByStackAndVersion(HDP_206,"version"));
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFindByStackAndVersion(){
  createSingleRecord();
  Assert.assertNull(repositoryVersionDAO.findByStackAndVersion(BAD_STACK,"non existing"));
  Assert.assertNotNull(repositoryVersionDAO.findByStackAndVersion(HDP_206,"version"));
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFindByDisplayName(){
  createSingleRecord();
  Assert.assertNull(repositoryVersionDAO.findByDisplayName("non existing"));
  Assert.assertNotNull(repositoryVersionDAO.findByDisplayName("display name"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.RequestScheduleDAOTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateRequestSchedule() throws Exception {
  RequestScheduleEntity scheduleEntity=createScheduleEntity();
  Assert.assertTrue(scheduleEntity.getScheduleId() > 0);
  Assert.assertEquals("SCHEDULED",scheduleEntity.getStatus());
  Assert.assertEquals("12",scheduleEntity.getHours());
  RequestScheduleBatchRequestEntity batchRequestEntity=scheduleEntity.getRequestScheduleBatchRequestEntities().iterator().next();
  Assert.assertNotNull(batchRequestEntity);
  Assert.assertEquals(testUri,batchRequestEntity.getRequestUri());
  Assert.assertEquals(testType,batchRequestEntity.getRequestType());
  Assert.assertEquals(testBody,batchRequestEntity.getRequestBodyAsString());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindByStatus() throws Exception {
  RequestScheduleEntity scheduleEntity=createScheduleEntity();
  List<RequestScheduleEntity> scheduleEntities=requestScheduleDAO.findByStatus("SCHEDULED");
  Assert.assertNotNull(scheduleEntities);
  Assert.assertEquals(scheduleEntity,scheduleEntities.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.ServiceConfigDAOTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLastServiceConfig() throws Exception {
  createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  createServiceConfig("HDFS","admin",2L,2L,2222L,null);
  createServiceConfig("YARN","admin",1L,3L,3333L,null);
  ServiceConfigEntity serviceConfigEntity=serviceConfigDAO.getLastServiceConfig(1L,"HDFS");
  Assert.assertNotNull(serviceConfigEntity);
  Assert.assertEquals("c1",serviceConfigEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("HDFS",serviceConfigEntity.getServiceName());
  Assert.assertEquals(Long.valueOf(2222L),serviceConfigEntity.getCreateTimestamp());
  Assert.assertEquals("admin",serviceConfigEntity.getUser());
  Assert.assertEquals(Long.valueOf(2),serviceConfigEntity.getVersion());
  Assert.assertTrue(serviceConfigEntity.getClusterConfigEntities().isEmpty());
  Assert.assertNotNull(serviceConfigEntity.getServiceConfigId());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLastServiceConfigs() throws Exception {
  createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  createServiceConfig("HDFS","admin",2L,2L,2222L,null);
  createServiceConfig("YARN","admin",1L,3L,3333L,null);
  List<ServiceConfigEntity> serviceConfigEntities=serviceConfigDAO.getLastServiceConfigs(clusterDAO.findByName("c1").getClusterId());
  Assert.assertNotNull(serviceConfigEntities);
  Assert.assertEquals(2,serviceConfigEntities.size());
  for (  ServiceConfigEntity sce : serviceConfigEntities) {
    if ("HDFS".equals(sce.getServiceName())) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(2222L),sce.getCreateTimestamp());
      Assert.assertEquals(Long.valueOf(2),sce.getVersion());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
    if ("YARN".equals(sce.getServiceName())) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(3333L),sce.getCreateTimestamp());
      Assert.assertEquals(Long.valueOf(1),sce.getVersion());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
    Assert.assertEquals("admin",sce.getUser());
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindByServiceAndVersion() throws Exception {
  createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  ServiceConfigEntity serviceConfigEntity=serviceConfigDAO.findByServiceAndVersion("HDFS",1L);
  Assert.assertNotNull(serviceConfigEntity);
  Assert.assertEquals("c1",serviceConfigEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("HDFS",serviceConfigEntity.getServiceName());
  Assert.assertEquals(Long.valueOf(1111L),serviceConfigEntity.getCreateTimestamp());
  Assert.assertEquals("admin",serviceConfigEntity.getUser());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getVersion());
  Assert.assertTrue(serviceConfigEntity.getClusterConfigEntities().isEmpty());
  Assert.assertNotNull(serviceConfigEntity.getServiceConfigId());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindServiceConfigEntity() throws Exception {
  ServiceConfigEntity sce=createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  ServiceConfigEntity serviceConfigEntity=serviceConfigDAO.find(sce.getServiceConfigId());
  Assert.assertNotNull(serviceConfigEntity);
  Assert.assertEquals("c1",serviceConfigEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("HDFS",serviceConfigEntity.getServiceName());
  Assert.assertEquals(Long.valueOf(1111L),serviceConfigEntity.getCreateTimestamp());
  Assert.assertEquals("admin",serviceConfigEntity.getUser());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getVersion());
  Assert.assertTrue(serviceConfigEntity.getClusterConfigEntities().isEmpty());
  Assert.assertNotNull(serviceConfigEntity.getServiceConfigId());
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServiceConfigs() throws Exception {
  createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  createServiceConfig("HDFS","admin",2L,2L,2222L,null);
  createServiceConfig("YARN","admin",1L,3L,3333L,null);
  List<ServiceConfigEntity> serviceConfigEntities=serviceConfigDAO.getServiceConfigs(clusterDAO.findByName("c1").getClusterId());
  Assert.assertNotNull(serviceConfigEntities);
  Assert.assertEquals(3,serviceConfigEntities.size());
  for (  ServiceConfigEntity sce : serviceConfigEntities) {
    if ("HDFS".equals(sce.getServiceName()) && (sce.getVersion() == 1)) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(1111L),sce.getCreateTimestamp());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
 else     if ("HDFS".equals(sce.getServiceName()) && (sce.getVersion() == 2)) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(2222L),sce.getCreateTimestamp());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
 else     if ("YARN".equals(sce.getServiceName())) {
      Assert.assertEquals("c1",sce.getClusterEntity().getClusterName());
      Assert.assertEquals(Long.valueOf(1),sce.getClusterEntity().getClusterId());
      Assert.assertEquals(Long.valueOf(3333L),sce.getCreateTimestamp());
      Assert.assertEquals(Long.valueOf(1),sce.getVersion());
      Assert.assertTrue(sce.getClusterConfigEntities().isEmpty());
      Assert.assertNotNull(sce.getServiceConfigId());
    }
 else {
      Assert.fail();
    }
    Assert.assertEquals("admin",sce.getUser());
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceConfigVersion() throws Exception {
  ServiceConfigEntity serviceConfigEntity=createServiceConfig("HDFS","admin",1L,1L,1111L,null);
  Assert.assertNotNull(serviceConfigEntity);
  Assert.assertEquals("c1",serviceConfigEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("HDFS",serviceConfigEntity.getServiceName());
  Assert.assertEquals(Long.valueOf(1111L),serviceConfigEntity.getCreateTimestamp());
  Assert.assertEquals("admin",serviceConfigEntity.getUser());
  Assert.assertEquals(Long.valueOf(1),serviceConfigEntity.getVersion());
  Assert.assertTrue(serviceConfigEntity.getClusterConfigEntities().isEmpty());
  Assert.assertNotNull(serviceConfigEntity.getServiceConfigId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the get latest configuration query against clusterconfig table with configuration groups inserted
 */
@Test public void testGetClusterConfigMappingByStackCG() throws Exception {
  initClusterEntitiesWithConfigGroups();
  ClusterEntity clusterEntity=clusterDAO.findByName("c1");
  List<ConfigGroupEntity> configGroupEntities=configGroupDAO.findAllByTag("OOZIE");
  Assert.assertNotNull(configGroupEntities);
  ConfigGroupEntity configGroupEntity=configGroupEntities.get(0);
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals("c1",configGroupEntity.getClusterEntity().getClusterName());
  Assert.assertEquals(Long.valueOf(1),configGroupEntity.getClusterEntity().getClusterId());
  Assert.assertEquals("oozie_server",configGroupEntity.getGroupName());
  Assert.assertEquals("OOZIE",configGroupEntity.getTag());
  Assert.assertEquals("oozie server",configGroupEntity.getDescription());
  List<ClusterConfigMappingEntity> clusterConfigMappingEntities=clusterDAO.getClusterConfigMappingsByStack(clusterEntity.getClusterId(),HDP_01);
  Assert.assertEquals(2,clusterConfigMappingEntities.size());
  ClusterConfigMappingEntity e1=clusterConfigMappingEntities.get(0);
  String tag1=e1.getTag();
  Assert.assertEquals("version1",tag1);
  String type1=e1.getType();
  Assert.assertEquals("oozie-site",type1);
  ClusterConfigMappingEntity e2=clusterConfigMappingEntities.get(1);
  String tag2=e2.getTag();
  Assert.assertEquals("version2",tag2);
  String type2=e2.getType();
  Assert.assertEquals("oozie-site",type2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.SettingDAOTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCRUD(){
  Map<String,SettingEntity> entities=new HashMap<>();
  for (int i=0; i < 3; i++) {
    SettingEntity entity=new SettingEntity();
    entity.setName("motd" + i);
    entity.setContent("test content" + i);
    entity.setUpdatedBy("ambari");
    entity.setSettingType("ambari-server");
    entity.setUpdateTimestamp(System.currentTimeMillis());
    entities.put(entity.getName(),entity);
    dao.create(entity);
  }
  retrieveAndValidateSame(entities);
  assertEquals(entities.size(),dao.findAll().size());
  assertNull(dao.findByName("does-not-exist"));
  for (  Map.Entry<String,SettingEntity> entry : entities.entrySet()) {
    entry.getValue().setContent(Objects.toString(Math.random()));
    dao.merge(entry.getValue());
  }
  retrieveAndValidateSame(entities);
  assertEquals(entities.size(),dao.findAll().size());
  for (  Map.Entry<String,SettingEntity> entry : entities.entrySet()) {
    dao.removeByName(entry.getKey());
  }
  assertEquals(0,dao.findAll().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.StageDAOTest </h4><pre class="type-7 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  stageDao=injector.getInstance(StageDAO.class);
  OrmTestHelper helper=injector.getInstance(OrmTestHelper.class);
  Long clusterId=helper.createCluster();
  RequestDAO requestDao=injector.getInstance(RequestDAO.class);
  RequestEntity requestEntity=new RequestEntity();
  requestEntity.setClusterId(clusterId);
  requestEntity.setStartTime(1000L);
  requestEntity.setEndTime(1200L);
  requestEntity.setRequestId(99L);
  requestDao.create(requestEntity);
  for (int i=0; i < 5; i++) {
    StageEntity definition=new StageEntity();
    definition.setClusterId(clusterId);
    definition.setRequestId(99L);
    definition.setStageId((long)(100 + i));
    definition.setLogInfo("log info for " + i);
    definition.setRequestContext("request context for " + i);
    definition.setRequest(requestEntity);
    stageDao.create(definition);
  }
  List<StageEntity> definitions=stageDao.findAll();
  assertNotNull(definitions);
  assertEquals(5,definitions.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.TopologyLogicalRequestDAOTest </h4><pre class="type-4 type-2 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testFindAll() throws Exception {
  create();
  List<TopologyLogicalRequestEntity> logicalRequestEntities=logicalRequestDAO.findAll();
  Assert.assertEquals(1,logicalRequestEntities.size());
  TopologyLogicalRequestEntity logicalRequestEntity=logicalRequestEntities.iterator().next();
  Assert.assertNotNull(logicalRequestEntity.getTopologyRequestId());
  Assert.assertEquals(Long.valueOf(1),logicalRequestEntity.getId());
  Assert.assertEquals("description",logicalRequestEntity.getDescription());
  Assert.assertNotNull(logicalRequestEntity.getTopologyRequestEntity());
  Collection<TopologyHostRequestEntity> hostRequestEntities=logicalRequestEntity.getTopologyHostRequestEntities();
  Assert.assertEquals(1,hostRequestEntities.size());
  TopologyHostRequestEntity hostRequestEntity=hostRequestEntities.iterator().next();
  Assert.assertNotNull(hostRequestEntity.getTopologyHostGroupEntity());
  Assert.assertEquals(hostRequestEntity.getTopologyHostGroupEntity().getId(),hostRequestEntity.getHostGroupId());
  Collection<TopologyHostTaskEntity> taskEntities=hostRequestEntity.getTopologyHostTaskEntities();
  Assert.assertEquals(1,taskEntities.size());
  TopologyHostTaskEntity taskEntity=taskEntities.iterator().next();
  Assert.assertNotNull(taskEntity.getTopologyHostRequestEntity());
  Assert.assertNotNull(taskEntity.getTopologyLogicalTaskEntities());
  Assert.assertEquals(1,taskEntity.getTopologyLogicalTaskEntities().size());
  Assert.assertNotNull(taskEntity.getTopologyLogicalTaskEntities().iterator().next().getTopologyHostTaskEntity());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.dao.UpgradeDAOTest </h4><pre class="type-4 type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindUpgrade() throws Exception {
  List<UpgradeEntity> items=dao.findUpgrades(clusterId.longValue());
  assertTrue(items.size() > 0);
  UpgradeEntity entity=dao.findUpgrade(items.get(0).getId().longValue());
  assertNotNull(entity);
  assertEquals(1,entity.getUpgradeGroups().size());
  UpgradeGroupEntity group=dao.findUpgradeGroup(entity.getUpgradeGroups().get(0).getId().longValue());
  assertNotNull(group);
  Assert.assertNotSame(entity.getUpgradeGroups().get(0),group);
  assertEquals("group_name",group.getName());
  assertEquals("group title",group.getTitle());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create upgrades and downgrades and verify only latest upgrade is given
 * @throws Exception
 */
@Test public void testFindLastUpgradeForCluster() throws Exception {
  UpgradeEntity entity1=new UpgradeEntity();
  entity1.setId(11L);
  entity1.setClusterId(Long.valueOf(1));
  entity1.setDirection(Direction.UPGRADE);
  entity1.setRequestId(Long.valueOf(1));
  entity1.setFromVersion("2.2.0.0-1234");
  entity1.setToVersion("2.3.0.0-4567");
  entity1.setUpgradeType(UpgradeType.ROLLING);
  entity1.setUpgradePackage("test-upgrade");
  entity1.setDowngradeAllowed(true);
  dao.create(entity1);
  UpgradeEntity entity2=new UpgradeEntity();
  entity2.setId(22L);
  entity2.setClusterId(Long.valueOf(1));
  entity2.setDirection(Direction.DOWNGRADE);
  entity2.setRequestId(Long.valueOf(1));
  entity2.setFromVersion("2.3.0.0-4567");
  entity2.setToVersion("2.2.0.0-1234");
  entity2.setUpgradeType(UpgradeType.ROLLING);
  entity2.setUpgradePackage("test-upgrade");
  entity2.setDowngradeAllowed(true);
  dao.create(entity2);
  UpgradeEntity entity3=new UpgradeEntity();
  entity3.setId(33L);
  entity3.setClusterId(Long.valueOf(1));
  entity3.setDirection(Direction.UPGRADE);
  entity3.setRequestId(Long.valueOf(1));
  entity3.setFromVersion("2.2.0.0-1234");
  entity3.setToVersion("2.3.1.1-4567");
  entity3.setUpgradeType(UpgradeType.ROLLING);
  entity3.setUpgradePackage("test-upgrade");
  entity3.setDowngradeAllowed(true);
  dao.create(entity3);
  UpgradeEntity lastUpgradeForCluster=dao.findLastUpgradeForCluster(1);
  assertNotNull(lastUpgradeForCluster);
  assertEquals(33L,(long)lastUpgradeForCluster.getId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.ResourceEntityTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGetPrivileges() throws Exception {
  ResourceEntity entity=new ResourceEntity();
  PrivilegeEntity privilegeEntity=new PrivilegeEntity();
  Collection<PrivilegeEntity> privileges=Collections.singleton(privilegeEntity);
  Assert.assertNull(entity.getResourceType());
  entity.setPrivileges(privileges);
  Assert.assertEquals(privileges,entity.getPrivileges());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.orm.entities.ViewInstanceEntityTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstanceData() throws Exception {
  TestSecurityHelper securityHelper=new TestSecurityHelper("user1");
  ViewInstanceEntity viewInstanceDefinition=getViewInstanceEntity(securityHelper);
  viewInstanceDefinition.putInstanceData("key1","foo");
  ViewInstanceDataEntity dataEntity=viewInstanceDefinition.getInstanceData("key1");
  Assert.assertNotNull(dataEntity);
  Assert.assertEquals("foo",dataEntity.getValue());
  Assert.assertEquals("user1",dataEntity.getUser());
  viewInstanceDefinition.putInstanceData("key2","bar");
  viewInstanceDefinition.putInstanceData("key3","baz");
  viewInstanceDefinition.putInstanceData("key4","monkey");
  viewInstanceDefinition.putInstanceData("key5","runner");
  Map<String,String> dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(5,dataMap.size());
  Assert.assertEquals("foo",dataMap.get("key1"));
  Assert.assertEquals("bar",dataMap.get("key2"));
  Assert.assertEquals("baz",dataMap.get("key3"));
  Assert.assertEquals("monkey",dataMap.get("key4"));
  Assert.assertEquals("runner",dataMap.get("key5"));
  viewInstanceDefinition.removeInstanceData("key3");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(4,dataMap.size());
  Assert.assertFalse(dataMap.containsKey("key3"));
  securityHelper.setUser("user2");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertTrue(dataMap.isEmpty());
  viewInstanceDefinition.putInstanceData("key1","aaa");
  viewInstanceDefinition.putInstanceData("key2","bbb");
  viewInstanceDefinition.putInstanceData("key3","ccc");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(3,dataMap.size());
  Assert.assertEquals("aaa",dataMap.get("key1"));
  Assert.assertEquals("bbb",dataMap.get("key2"));
  Assert.assertEquals("ccc",dataMap.get("key3"));
  securityHelper.setUser("user1");
  dataMap=viewInstanceDefinition.getInstanceDataMap();
  Assert.assertEquals(4,dataMap.size());
  Assert.assertEquals("foo",dataMap.get("key1"));
  Assert.assertEquals("bar",dataMap.get("key2"));
  Assert.assertNull(dataMap.get("key3"));
  Assert.assertEquals("monkey",dataMap.get("key4"));
  Assert.assertEquals("runner",dataMap.get("key5"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetId() throws Exception {
  ViewInstanceEntity viewInstanceDefinition=getViewInstanceEntity();
  Assert.assertNull(viewInstanceDefinition.getViewInstanceId());
  viewInstanceDefinition.setViewInstanceId(99L);
  Assert.assertEquals(99L,(long)viewInstanceDefinition.getViewInstanceId());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDescription() throws Exception {
  InstanceConfig instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_with_instance_label).get(0);
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewInstanceEntity viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertEquals("This is an instance description.",viewInstanceDefinition.getDescription());
  instanceConfig=InstanceConfigTest.getInstanceConfigs(xml_without_instance_label).get(0);
  viewDefinition=ViewEntityTest.getViewEntity();
  viewInstanceDefinition=new ViewInstanceEntity(viewDefinition,instanceConfig);
  Assert.assertNull(viewInstanceDefinition.getDescription());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.scheduler.ExecutionScheduleManagerTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScheduleBatch() throws Exception {
  RequestExecution requestExecution=createRequestExecution(true);
  Assert.assertNotNull(requestExecution);
  executionScheduleManager.scheduleBatch(requestExecution);
  String jobName1=executionScheduleManager.getJobName(requestExecution.getId(),10L);
  String jobName2=executionScheduleManager.getJobName(requestExecution.getId(),12L);
  JobDetail jobDetail1=null;
  JobDetail jobDetail2=null;
  Trigger trigger1=null;
  Trigger trigger2=null;
  for (  String group : scheduler.getJobGroupNames()) {
    for (    JobKey jobKey : scheduler.getJobKeys(GroupMatcher.jobGroupEquals(ExecutionJob.LINEAR_EXECUTION_JOB_GROUP))) {
      LOG.info("Found job identified by: " + jobKey);
      String jobName=jobKey.getName();
      String jobGroup=jobKey.getGroup();
      List<Trigger> triggers=(List<Trigger>)scheduler.getTriggersOfJob(jobKey);
      Trigger trigger=triggers != null && !triggers.isEmpty() ? triggers.get(0) : null;
      Date nextFireTime=trigger != null ? trigger.getNextFireTime() : null;
      LOG.info("[jobName] : " + jobName + " [groupName] : "+ jobGroup+ " - "+ nextFireTime);
      if (jobName.equals(jobName1)) {
        jobDetail1=scheduler.getJobDetail(jobKey);
        trigger1=trigger;
      }
 else       if (jobName.equals(jobName2)) {
        jobDetail2=scheduler.getJobDetail(jobKey);
        trigger2=trigger;
      }
    }
  }
  Assert.assertNotNull(jobDetail1);
  Assert.assertNotNull(trigger1);
  Assert.assertNotNull(jobDetail2);
  Assert.assertNull(trigger2);
  CronTrigger cronTrigger=(CronTrigger)trigger1;
  Schedule schedule=new Schedule();
  schedule.setMinutes("10");
  schedule.setHours("2");
  schedule.setMonth("*");
  schedule.setDaysOfMonth("*");
  schedule.setDayOfWeek("?");
  Assert.assertEquals(schedule.getScheduleExpression(),cronTrigger.getCronExpression());
  Assert.assertEquals(jobName1,jobDetail1.getKey().getName());
  Assert.assertEquals(jobName2,jobDetail2.getKey().getName());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-2 type-11 type-18 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  InMemoryDefaultTestModule defaultTestModule=new InMemoryDefaultTestModule();
  properties=defaultTestModule.getProperties();
  injector=Guice.createInjector(Modules.override(defaultTestModule).with(new ExecutionSchedulerTestModule()));
  injector.getInstance(GuiceJpaInitializer.class);
  clusters=injector.getInstance(Clusters.class);
  metaInfo=injector.getInstance(AmbariMetaInfo.class);
  executionScheduleManager=injector.getInstance(ExecutionScheduleManager.class);
  executionScheduler=injector.getInstance(ExecutionScheduler.class);
  requestExecutionFactory=injector.getInstance(RequestExecutionFactory.class);
  clusterName="c1";
  clusters.addCluster(clusterName,new StackId("HDP-0.1"));
  cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
  assertThat(executionScheduler,instanceOf(TestExecutionScheduler.class));
  TestExecutionScheduler testExecutionScheduler=(TestExecutionScheduler)executionScheduler;
  scheduler=testExecutionScheduler.getScheduler();
  Assert.assertNotNull(scheduler);
  executionScheduleManager.start();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteAllJobs() throws Exception {
  RequestExecution requestExecution=createRequestExecution(true);
  Assert.assertNotNull(requestExecution);
  executionScheduleManager.scheduleBatch(requestExecution);
  String jobName1=executionScheduleManager.getJobName(requestExecution.getId(),10L);
  String jobName2=executionScheduleManager.getJobName(requestExecution.getId(),12L);
  JobDetail jobDetail1=scheduler.getJobDetail(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  JobDetail jobDetail2=scheduler.getJobDetail(JobKey.jobKey(jobName2,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  Assert.assertNotNull(jobDetail1);
  Assert.assertNotNull(jobDetail2);
  Assert.assertTrue(!scheduler.getTriggersOfJob(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP)).isEmpty());
  executionScheduleManager.deleteAllJobs(requestExecution);
  Assert.assertTrue(scheduler.getTriggersOfJob(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP)).isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-18 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPointInTimeExecutionJob() throws Exception {
  RequestExecution requestExecution=createRequestExecution(false);
  Assert.assertNotNull(requestExecution);
  executionScheduleManager.scheduleBatch(requestExecution);
  String jobName1=executionScheduleManager.getJobName(requestExecution.getId(),10L);
  String jobName2=executionScheduleManager.getJobName(requestExecution.getId(),12L);
  JobDetail jobDetail1=scheduler.getJobDetail(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  JobDetail jobDetail2=scheduler.getJobDetail(JobKey.jobKey(jobName2,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  Assert.assertNotNull(jobDetail1);
  Assert.assertNotNull(jobDetail2);
  List<? extends Trigger> triggers=scheduler.getTriggersOfJob(JobKey.jobKey(jobName1,ExecutionJob.LINEAR_EXECUTION_JOB_GROUP));
  Assert.assertNotNull(triggers);
  Assert.assertEquals(1,triggers.size());
  assertThat(triggers.get(0),instanceOf(SimpleTrigger.class));
  Assert.assertNull(jobDetail2.getJobDataMap().getString(ExecutionJob.NEXT_EXECUTION_JOB_NAME_KEY));
  int waitCount=0;
  while (scheduler.getCurrentlyExecutingJobs().size() != 0 && waitCount < 10) {
    Thread.sleep(100);
    waitCount++;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.AbstractSecurityHeaderFilterTest </h4><pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_EmptyValuesSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.API_USE_SSL,"true");
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER),"");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER),"");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER),"");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_DefaultValuesSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.API_USE_SSL,"true");
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  servletResponse.setHeader(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER));
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER));
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER));
  expectLastCall().once();
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_CustomValuesSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.API_USE_SSL,"true");
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER),"custom1");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER),"custom2");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER),"custom3");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  servletResponse.setHeader(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER,"custom1");
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER,"custom2");
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER,"custom3");
  expectLastCall().once();
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_DefaultValuesNoSSL() throws Exception {
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.API_USE_SSL,"false");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER));
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER,defatulPropertyValueMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER));
  expectLastCall().once();
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_CustomValuesNoSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER),"custom1");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER),"custom2");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER),"custom3");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER,"custom2");
  expectLastCall().once();
  servletResponse.setHeader(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER,"custom3");
  expectLastCall().once();
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDoFilter_EmptyValuesNoSSL() throws Exception {
  final File httpPassFile=temporaryFolder.newFile();
  Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      Properties properties=new Properties();
      properties.setProperty(Configuration.CLIENT_API_SSL_KSTR_DIR_NAME_KEY,httpPassFile.getParent());
      properties.setProperty(Configuration.CLIENT_API_SSL_CRT_PASS_FILE_NAME_KEY,httpPassFile.getName());
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.STRICT_TRANSPORT_HEADER),"");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_FRAME_OPTIONS_HEADER),"");
      properties.setProperty(propertyNameMap.get(AbstractSecurityHeaderFilter.X_XSS_PROTECTION_HEADER),"");
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      bind(Configuration.class).toInstance(new Configuration(properties));
    }
  }
);
  FilterConfig filterConfig=createNiceMock(FilterConfig.class);
  HttpServletRequest servletRequest=createStrictMock(HttpServletRequest.class);
  expectHttpServletRequestMock(servletRequest);
  HttpServletResponse servletResponse=createStrictMock(HttpServletResponse.class);
  FilterChain filterChain=createStrictMock(FilterChain.class);
  filterChain.doFilter(servletRequest,servletResponse);
  expectLastCall().once();
  replayAll();
  AbstractSecurityHeaderFilter securityFilter=injector.getInstance(filterClass);
  Assert.assertNotNull(securityFilter);
  securityFilter.init(filterConfig);
  securityFilter.doFilter(servletRequest,servletResponse,filterChain);
  verifyAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.SecurePasswordHelperTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateSecurePassword() throws Exception {
  String password1=securePasswordHelper.createSecurePassword();
  Assert.assertNotNull(password1);
  Assert.assertEquals(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_LENGTH,password1.length());
  String password2=securePasswordHelper.createSecurePassword();
  Assert.assertNotNull(password2);
  Assert.assertEquals(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_LENGTH,password2.length());
  Assert.assertFalse((password1.equals(password2)));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateSecurePasswordWithRules() throws Exception {
  String password;
  password=securePasswordHelper.createSecurePassword(null,null,null,null,null,null);
  Assert.assertNotNull(password);
  Assert.assertEquals(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_LENGTH,password.length());
  assertMinLowercaseLetters(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_LOWERCASE_LETTERS,password);
  assertMinUppercaseLetters(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_UPPERCASE_LETTERS,password);
  assertMinDigits(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_DIGITS,password);
  assertMinPunctuation(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_PUNCTUATION,password);
  assertMinWhitespace(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_WHITESPACE,password);
  password=securePasswordHelper.createSecurePassword(10,null,null,null,null,null);
  Assert.assertNotNull(password);
  Assert.assertEquals(10,password.length());
  assertMinLowercaseLetters(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_LOWERCASE_LETTERS,password);
  assertMinUppercaseLetters(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_UPPERCASE_LETTERS,password);
  assertMinDigits(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_DIGITS,password);
  assertMinPunctuation(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_PUNCTUATION,password);
  assertMinWhitespace(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_WHITESPACE,password);
  password=securePasswordHelper.createSecurePassword(0,null,null,null,null,null);
  Assert.assertNotNull(password);
  Assert.assertEquals(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_LENGTH,password.length());
  assertMinLowercaseLetters(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_LOWERCASE_LETTERS,password);
  assertMinUppercaseLetters(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_UPPERCASE_LETTERS,password);
  assertMinDigits(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_DIGITS,password);
  assertMinPunctuation(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_PUNCTUATION,password);
  assertMinWhitespace(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_WHITESPACE,password);
  password=securePasswordHelper.createSecurePassword(-20,null,null,null,null,null);
  Assert.assertNotNull(password);
  Assert.assertEquals(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_LENGTH,password.length());
  assertMinLowercaseLetters(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_LOWERCASE_LETTERS,password);
  assertMinUppercaseLetters(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_UPPERCASE_LETTERS,password);
  assertMinDigits(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_DIGITS,password);
  assertMinPunctuation(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_PUNCTUATION,password);
  assertMinWhitespace(SecurePasswordHelper.DEFAULT_SECURE_PASSWORD_MIN_WHITESPACE,password);
  password=securePasswordHelper.createSecurePassword(100,30,20,10,5,2);
  Assert.assertNotNull(password);
  Assert.assertEquals(100,password.length());
  assertMinLowercaseLetters(30,password);
  assertMinUppercaseLetters(20,password);
  assertMinDigits(10,password);
  assertMinPunctuation(5,password);
  assertMinWhitespace(2,password);
  password=securePasswordHelper.createSecurePassword(100,20,20,20,20,0);
  Assert.assertNotNull(password);
  Assert.assertEquals(100,password.length());
  assertMinLowercaseLetters(20,password);
  assertMinUppercaseLetters(20,password);
  assertMinDigits(20,password);
  assertMinPunctuation(20,password);
  assertMinWhitespace(0,password);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.SecurityFilterTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void mustFilterNonHttpsRequests() throws Exception {
  SecurityFilter filter=new SecurityFilter();
  MockHttpServletRequest request=this.getDefaultRequest();
  request.setRequestURI("/certs/");
  request.setScheme("http");
  MockHttpServletResponse response=new MockHttpServletResponse();
  request.setLocalPort(8440);
  MockFilterChain chain=new MockFilterChain();
  filter.doFilter(request,response,chain);
  assertNull(chain.getRequest());
  assertNull(chain.getResponse());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AmbariAuthorizationProviderDisableUserTest </h4><pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisabledUserViaDaoProvider(){
  try {
    daoProvider.authenticate(new UsernamePasswordAuthenticationToken("disabledUser","pwd"));
    Assert.fail("Disabled user passes authentication");
  }
 catch (  DisabledException e) {
    Assert.assertEquals("User is disabled",e.getMessage());
  }
  Authentication auth=daoProvider.authenticate(new UsernamePasswordAuthenticationToken("activeUser","pwd"));
  Assert.assertNotNull(auth);
  Assert.assertTrue(auth.isAuthenticated());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AmbariLdapAuthenticationProviderForDNWithSpaceTest </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticate() throws Exception {
  assertNull("User alread exists in DB",userDAO.findLdapUserByName("the allowedUser"));
  Authentication authentication=new UsernamePasswordAuthenticationToken("the allowedUser","password");
  Authentication result=authenticationProvider.authenticate(authentication);
  assertTrue(result.isAuthenticated());
  result=authenticationProvider.authenticate(authentication);
  assertTrue(result.isAuthenticated());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AmbariLdapAuthenticationProviderTest </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticate() throws Exception {
  assertNull("User alread exists in DB",userDAO.findLdapUserByName("allowedUser"));
  Authentication authentication=new UsernamePasswordAuthenticationToken("allowedUser","password");
  Authentication result=authenticationProvider.authenticate(authentication);
  assertTrue(result.isAuthenticated());
  result=authenticationProvider.authenticate(authentication);
  assertTrue(result.isAuthenticated());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.AuthorizationHelperTest </h4><pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthName() throws Exception {
  String user=AuthorizationHelper.getAuthenticatedName();
  Assert.assertNull(user);
  Authentication auth=new UsernamePasswordAuthenticationToken("admin",null);
  SecurityContextHolder.getContext().setAuthentication(auth);
  user=AuthorizationHelper.getAuthenticatedName();
  Assert.assertEquals("admin",user);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.authorization.TestUsers </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testCreateGroup() throws Exception {
  final String groupName="engineering";
  users.createGroup(groupName);
  assertNotNull(groupDAO.findGroupByName(groupName));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAnyUser() throws Exception {
  users.createUser("user","user",true,false,false);
  users.createUser("user_ldap","user_ldap",true,false,true);
  assertEquals("user",users.getAnyUser("user").getUserName());
  assertEquals("user_ldap",users.getAnyUser("user_ldap").getUserName());
  Assert.assertNull(users.getAnyUser("non_existing"));
}

</code></pre>

<br>
<pre class="type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAllUsers() throws Exception {
  Authentication auth=new UsernamePasswordAuthenticationToken("user",null);
  SecurityContextHolder.getContext().setAuthentication(auth);
  users.createUser("user","user");
  users.createUser("admin","admin");
  List<User> userList=users.getAllUsers();
  assertEquals(2,userList.size());
  for (  User user : userList) {
    assertEquals(false,user.isLdapUser());
  }
  assertEquals(2,userDAO.findAll().size());
  UserEntity userEntity=userDAO.findUserByName("user");
  assertNotNull("user",userEntity.getUserPassword());
  users.modifyPassword("user","user","resu");
  assertNotSame(userEntity.getUserPassword(),userDAO.findUserByName("user").getUserPassword());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveUser() throws Exception {
  users.createUser("user1","user1");
  users.createUser("user2","user2");
  users.createUser("user3","user3");
  Assert.assertEquals(3,users.getAllUsers().size());
  users.removeUser(users.getAnyUser("user1"));
  Assert.assertNull(users.getAnyUser("user1"));
  Assert.assertEquals(2,users.getAllUsers().size());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGroupLdap() throws Exception {
  users.createGroup("group");
  users.setGroupLdap("group");
  Assert.assertNotNull(users.getGroup("group"));
  Assert.assertTrue(users.getGroup("group").isLdapGroup());
  try {
    users.setGroupLdap("fake group");
    Assert.fail("It shouldn't be possible to call setGroupLdap() on non-existing group");
  }
 catch (  AmbariException ex) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetGroup() throws Exception {
  final String groupName="engineering";
  users.createGroup(groupName);
  final Group group=users.getGroup(groupName);
  assertNotNull(group);
  assertEquals(false,group.isLdapGroup());
  assertEquals(groupName,group.getGroupName());
  assertNotNull(groupDAO.findGroupByName(groupName));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.AESEncryptorTest </h4><pre class="type-4 type-2 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptionDecryption() throws Exception {
  AESEncryptor aes=new AESEncryptor("AESPassPhrase");
  String masterKey="Thisisusermasterkey";
  EncryptionResult res=aes.encrypt(masterKey.getBytes());
  Assert.assertNotNull(res);
  Assert.assertNotNull(res.cipher);
  Assert.assertNotNull(res.iv);
  Assert.assertNotNull(res.salt);
  byte[] descryptedKey=aes.decrypt(res.salt,res.iv,res.cipher);
  Assert.assertEquals(masterKey,new String(descryptedKey,"UTF8"));
  Assert.assertEquals(masterKey.getBytes().length,descryptedKey.length);
  Assert.assertEquals(masterKey.getBytes("UTF8").length,new String(descryptedKey,"UTF8").toCharArray().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.CredentialProviderTest </h4><pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitialization() throws Exception {
  CredentialProvider cr;
  File msFile=tmpFolder.newFile(Configuration.MASTER_KEY_FILENAME_DEFAULT);
  File mksFile=tmpFolder.newFile(Configuration.MASTER_KEYSTORE_FILENAME_DEFAULT);
  try {
    new CredentialProvider(null,null,true,null);
    Assert.fail("Expected an exception");
  }
 catch (  Throwable t) {
    Assert.assertTrue(t instanceof IllegalArgumentException);
  }
  cr=new CredentialProvider("blahblah!",msFile,false,mksFile);
  Assert.assertNotNull(cr);
  Assert.assertNotNull(cr.getKeystoreService());
  msFile.delete();
  mksFile.delete();
  createMasterKey();
  cr=new CredentialProvider(null,msFile,true,mksFile);
  Assert.assertNotNull(cr);
  Assert.assertNotNull(cr.getKeystoreService());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCredentialStore() throws Exception {
  File msFile=tmpFolder.newFile(Configuration.MASTER_KEY_FILENAME_DEFAULT);
  File mksFile=tmpFolder.newFile(Configuration.MASTER_KEYSTORE_FILENAME_DEFAULT);
  createMasterKey();
  CredentialProvider cr=new CredentialProvider(null,msFile,true,mksFile);
  Assert.assertNotNull(cr);
  Assert.assertNotNull(cr.getKeystoreService());
  try {
    cr.addAliasToCredentialStore("","xyz");
    Assert.fail("Expected an exception");
  }
 catch (  Throwable t) {
    Assert.assertTrue(t instanceof IllegalArgumentException);
  }
  try {
    cr.addAliasToCredentialStore("xyz",null);
    Assert.fail("Expected an exception");
  }
 catch (  Throwable t) {
    Assert.assertTrue(t instanceof IllegalArgumentException);
  }
  cr.addAliasToCredentialStore("myalias","mypassword");
  Assert.assertEquals("mypassword",new String(cr.getPasswordForAlias("myalias")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.CredentialStoreServiceImplTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveCredential_Persisted() throws Exception {
  PrincipalKeyCredential credential1=new PrincipalKeyCredential("username1","password1");
  PrincipalKeyCredential credential2=new PrincipalKeyCredential("username2","password2");
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.PERSISTED);
  credentialStoreService.setCredential(CLUSTER_NAME,"test2",credential2,CredentialStoreType.PERSISTED);
  credentialStoreService.removeCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY);
  Assert.assertEquals(credential1,credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED));
  Assert.assertEquals(credential1,credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  credentialStoreService.removeCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED);
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED));
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  Assert.assertEquals(credential2,credentialStoreService.getCredential(CLUSTER_NAME,"test2"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetAndGetCredential_Temporary() throws Exception {
  PrincipalKeyCredential credential=new PrincipalKeyCredential("username","password");
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential,CredentialStoreType.TEMPORARY);
  Assert.assertEquals(credential,credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY));
  Assert.assertEquals(credential,credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListCredentials() throws Exception {
  PrincipalKeyCredential credential1=new PrincipalKeyCredential("username1","password1");
  PrincipalKeyCredential credential2=new PrincipalKeyCredential("username2","password2");
  PrincipalKeyCredential credential3=new PrincipalKeyCredential("username3","password3");
  PrincipalKeyCredential credential4=new PrincipalKeyCredential("username4","password4");
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.PERSISTED);
  credentialStoreService.setCredential(CLUSTER_NAME,"test2",credential2,CredentialStoreType.PERSISTED);
  credentialStoreService.setCredential(CLUSTER_NAME,"test3",credential3,CredentialStoreType.TEMPORARY);
  credentialStoreService.setCredential(CLUSTER_NAME,"test4",credential4,CredentialStoreType.TEMPORARY);
  Map<String,CredentialStoreType> credentials=credentialStoreService.listCredentials(CLUSTER_NAME);
  Assert.assertNotNull(credentials);
  Assert.assertEquals(4,credentials.size());
  Assert.assertEquals(CredentialStoreType.PERSISTED,credentials.get("test1"));
  Assert.assertEquals(CredentialStoreType.PERSISTED,credentials.get("test2"));
  Assert.assertEquals(CredentialStoreType.TEMPORARY,credentials.get("test3"));
  Assert.assertEquals(CredentialStoreType.TEMPORARY,credentials.get("test4"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveCredential_Either() throws Exception {
  PrincipalKeyCredential credential1=new PrincipalKeyCredential("username1","password1");
  PrincipalKeyCredential credential2=new PrincipalKeyCredential("username2","password2");
  PrincipalKeyCredential credential3=new PrincipalKeyCredential("username3","password3");
  PrincipalKeyCredential credential4=new PrincipalKeyCredential("username4","password4");
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.PERSISTED);
  credentialStoreService.setCredential(CLUSTER_NAME,"test2",credential2,CredentialStoreType.PERSISTED);
  credentialStoreService.setCredential(CLUSTER_NAME,"test3",credential3,CredentialStoreType.TEMPORARY);
  credentialStoreService.setCredential(CLUSTER_NAME,"test4",credential4,CredentialStoreType.TEMPORARY);
  credentialStoreService.removeCredential(CLUSTER_NAME,"test1");
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED));
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  Assert.assertEquals(credential2,credentialStoreService.getCredential(CLUSTER_NAME,"test2"));
  Assert.assertEquals(credential3,credentialStoreService.getCredential(CLUSTER_NAME,"test3"));
  Assert.assertEquals(credential4,credentialStoreService.getCredential(CLUSTER_NAME,"test4"));
  credentialStoreService.removeCredential(CLUSTER_NAME,"test3");
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  Assert.assertEquals(credential2,credentialStoreService.getCredential(CLUSTER_NAME,"test2"));
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test3"));
  Assert.assertEquals(credential4,credentialStoreService.getCredential(CLUSTER_NAME,"test4"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateCredential() throws Exception {
  PrincipalKeyCredential credential1=new PrincipalKeyCredential("username1","password1");
  PrincipalKeyCredential credential2=new PrincipalKeyCredential("username2","password2");
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.PERSISTED);
  Assert.assertEquals(credential1,credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED));
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY));
  Assert.assertEquals(credential1,credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.TEMPORARY);
  Assert.assertEquals(credential1,credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY));
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED));
  Assert.assertEquals(credential1,credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential2,CredentialStoreType.PERSISTED);
  Assert.assertEquals(credential2,credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED));
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY));
  Assert.assertEquals(credential2,credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveCredential_Temporary() throws Exception {
  PrincipalKeyCredential credential1=new PrincipalKeyCredential("username1","password1");
  PrincipalKeyCredential credential2=new PrincipalKeyCredential("username2","password2");
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential1,CredentialStoreType.TEMPORARY);
  credentialStoreService.setCredential(CLUSTER_NAME,"test2",credential2,CredentialStoreType.TEMPORARY);
  credentialStoreService.removeCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED);
  Assert.assertEquals(credential1,credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY));
  Assert.assertEquals(credential1,credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  credentialStoreService.removeCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY);
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY));
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  Assert.assertEquals(credential2,credentialStoreService.getCredential(CLUSTER_NAME,"test2"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetAndGetCredential_Persisted() throws Exception {
  PrincipalKeyCredential credential=new PrincipalKeyCredential("username","password");
  credentialStoreService.setCredential(CLUSTER_NAME,"test1",credential,CredentialStoreType.PERSISTED);
  Assert.assertEquals(credential,credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.PERSISTED));
  Assert.assertEquals(credential,credentialStoreService.getCredential(CLUSTER_NAME,"test1"));
  Assert.assertNull(credentialStoreService.getCredential(CLUSTER_NAME,"test1",CredentialStoreType.TEMPORARY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.encryption.MasterKeyServiceTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitializeMasterKey() throws Exception {
  File masterKeyFile=new File(fileDir,"master");
  Assert.assertTrue(MasterKeyServiceImpl.initializeMasterKeyFile(masterKeyFile,"ThisisSomePassPhrase"));
  MasterKeyService ms=new MasterKeyServiceImpl(masterKeyFile);
  Assert.assertTrue(ms.isMasterKeyInitialized());
  Assert.assertTrue(masterKeyFile.exists());
  Set<PosixFilePermission> permissions=Files.getPosixFilePermissions(Paths.get(masterKeyFile.getAbsolutePath()));
  Assert.assertNotNull(permissions);
  Assert.assertEquals(2,permissions.size());
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_READ));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OWNER_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_EXECUTE));
  MasterKeyService ms1=new MasterKeyServiceImpl(masterKeyFile);
  Assert.assertTrue(ms1.isMasterKeyInitialized());
  Assert.assertEquals("ThisisSomePassPhrase",new String(ms1.getMasterSecret()));
  Assert.assertEquals(new String(ms.getMasterSecret()),new String(ms1.getMasterSecret()));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFromEnvAsKey() throws Exception {
  Map<String,String> mapRet=new HashMap<String,String>();
  mapRet.put(Configuration.MASTER_KEY_ENV_PROP,"ThisisSomePassPhrase");
  mockStatic(System.class);
  expect(System.getenv()).andReturn(mapRet);
  replayAll();
  MasterKeyService ms=new MasterKeyServiceImpl();
  verifyAll();
  Assert.assertTrue(ms.isMasterKeyInitialized());
  Assert.assertNotNull(ms.getMasterSecret());
  Assert.assertEquals("ThisisSomePassPhrase",new String(ms.getMasterSecret()));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFromEnvAsPath() throws Exception {
  File masterKeyFile=new File(fileDir,"master");
  Assert.assertTrue(MasterKeyServiceImpl.initializeMasterKeyFile(masterKeyFile,"ThisisSomePassPhrase"));
  MasterKeyService ms=new MasterKeyServiceImpl(masterKeyFile);
  Assert.assertTrue(ms.isMasterKeyInitialized());
  Assert.assertTrue(masterKeyFile.exists());
  Map<String,String> mapRet=new HashMap<String,String>();
  mapRet.put(Configuration.MASTER_KEY_LOCATION,masterKeyFile.getAbsolutePath());
  mockStatic(System.class);
  expect(System.getenv()).andReturn(mapRet);
  replayAll();
  ms=new MasterKeyServiceImpl();
  verifyAll();
  Assert.assertTrue(ms.isMasterKeyInitialized());
  Assert.assertNotNull(ms.getMasterSecret());
  Assert.assertEquals("ThisisSomePassPhrase",new String(ms.getMasterSecret()));
  Assert.assertFalse(masterKeyFile.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.security.ldap.AmbariLdapDataPopulatorTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testLdapUserContextMapper_uidAndUsernameAreNull() throws Exception {
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(ldapServerProperties.getUsernameAttribute()).andReturn("cn").once();
  DirContextAdapter adapter=createNiceMock(DirContextAdapter.class);
  expect(adapter.getStringAttribute("cn")).andReturn(null);
  expect(adapter.getStringAttribute("uid")).andReturn(null);
  replay(ldapServerProperties,adapter);
  AmbariLdapDataPopulator.LdapUserContextMapper ldapUserContextMapper=new AmbariLdapDataPopulator.LdapUserContextMapper(ldapServerProperties);
  assertNull(ldapUserContextMapper.mapFromContext(adapter));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLdapUserContextMapper_uidIsNull() throws Exception {
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(ldapServerProperties.getUsernameAttribute()).andReturn("cn").once();
  DirContextAdapter adapter=createNiceMock(DirContextAdapter.class);
  expect(adapter.getStringAttribute("cn")).andReturn("testUser");
  expect(adapter.getStringAttribute("uid")).andReturn(null);
  expect(adapter.getNameInNamespace()).andReturn("cn=testUser,ou=Ambari,dc=SME,dc=support,dc=com");
  replay(ldapServerProperties,adapter);
  AmbariLdapDataPopulator.LdapUserContextMapper ldapUserContextMapper=new AmbariLdapDataPopulator.LdapUserContextMapper(ldapServerProperties);
  LdapUserDto userDto=(LdapUserDto)ldapUserContextMapper.mapFromContext(adapter);
  assertNotNull(userDto);
  assertNull(userDto.getUid());
  assertEquals("testuser",userDto.getUserName());
  assertEquals("cn=testuser,ou=ambari,dc=sme,dc=support,dc=com",userDto.getDn());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLdapUserContextMapper() throws Exception {
  LdapServerProperties ldapServerProperties=createNiceMock(LdapServerProperties.class);
  expect(ldapServerProperties.getUsernameAttribute()).andReturn("cn").once();
  DirContextAdapter adapter=createNiceMock(DirContextAdapter.class);
  expect(adapter.getStringAttribute("cn")).andReturn("testUser");
  expect(adapter.getStringAttribute("uid")).andReturn("UID1");
  expect(adapter.getNameInNamespace()).andReturn("cn=testUser,ou=Ambari,dc=SME,dc=support,dc=com");
  replay(ldapServerProperties,adapter);
  AmbariLdapDataPopulator.LdapUserContextMapper ldapUserContextMapper=new AmbariLdapDataPopulator.LdapUserContextMapper(ldapServerProperties);
  LdapUserDto userDto=(LdapUserDto)ldapUserContextMapper.mapFromContext(adapter);
  assertNotNull(userDto);
  assertEquals("uid1",userDto.getUid());
  assertEquals("testuser",userDto.getUserName());
  assertEquals("cn=testuser,ou=ambari,dc=sme,dc=support,dc=com",userDto.getDn());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.ActionLogTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteStdErr() throws Exception {
  ActionLog actionLog=new ActionLog();
  actionLog.writeStdErr(null);
  Assert.assertEquals("",actionLog.getStdErr());
  Assert.assertEquals("",actionLog.getStdOut());
  actionLog.writeStdErr("This is a test message");
  Assert.assertNotNull(actionLog.getStdErr());
  Assert.assertTrue(actionLog.getStdErr().contains("This is a test message"));
  Assert.assertEquals("",actionLog.getStdOut());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteStdOut() throws Exception {
  ActionLog actionLog=new ActionLog();
  actionLog.writeStdOut(null);
  Assert.assertEquals("",actionLog.getStdOut());
  Assert.assertEquals("",actionLog.getStdErr());
  actionLog.writeStdOut("This is a test message");
  Assert.assertNotNull(actionLog.getStdErr());
  Assert.assertTrue(actionLog.getStdOut().contains("This is a test message"));
  Assert.assertEquals("",actionLog.getStdErr());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.ADKerberosOperationHandlerTest </h4><pre class="type-12 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessCreateTemplateCustom() throws Exception {
  PrincipalKeyCredential kc=new PrincipalKeyCredential(DEFAULT_ADMIN_PRINCIPAL,DEFAULT_ADMIN_PASSWORD);
  Map<String,String> kerberosEnvMap=new HashMap<String,String>(){
{
      put(ADKerberosOperationHandler.KERBEROS_ENV_LDAP_URL,DEFAULT_LDAP_URL);
      put(ADKerberosOperationHandler.KERBEROS_ENV_PRINCIPAL_CONTAINER_DN,DEFAULT_PRINCIPAL_CONTAINER_DN);
      put(ADKerberosOperationHandler.KERBEROS_ENV_AD_CREATE_ATTRIBUTES_TEMPLATE,"" + "#set( $user = \"${principal_primary}-${principal_digest}\" )" + "{"+ "  \"objectClass\": ["+ "    \"top\","+ "    \"person\","+ "    \"organizationalPerson\","+ "    \"user\""+ "  ],"+ "  \"cn\": \"$user\","+ "  \"sAMAccountName\": \"$user.substring(0,20)\","+ "  #if( $is_service )"+ "  \"servicePrincipalName\": \"$principal_name\","+ "  #end"+ "  \"userPrincipalName\": \"$normalized_principal\","+ "  \"unicodePwd\": \"$password\","+ "  \"accountExpires\": \"0\","+ "  \"userAccountControl\": \"66048\""+ "}");
    }
  }
;
  Capture<Name> capturedName=new Capture<Name>();
  Capture<Attributes> capturedAttributes=new Capture<Attributes>();
  ADKerberosOperationHandler handler=createMockBuilder(ADKerberosOperationHandler.class).addMockedMethod(ADKerberosOperationHandler.class.getDeclaredMethod("createInitialLdapContext",Properties.class,Control[].class)).addMockedMethod(ADKerberosOperationHandler.class.getDeclaredMethod("createSearchControls")).createNiceMock();
  NamingEnumeration<SearchResult> searchResult=createNiceMock(NamingEnumeration.class);
  expect(searchResult.hasMore()).andReturn(false).once();
  LdapContext ldapContext=createNiceMock(LdapContext.class);
  expect(ldapContext.search(anyObject(String.class),anyObject(String.class),anyObject(SearchControls.class))).andReturn(searchResult).once();
  expect(ldapContext.createSubcontext(capture(capturedName),capture(capturedAttributes))).andReturn(createNiceMock(DirContext.class)).once();
  expect(handler.createInitialLdapContext(anyObject(Properties.class),anyObject(Control[].class))).andReturn(ldapContext).once();
  expect(handler.createSearchControls()).andAnswer(new IAnswer<SearchControls>(){
    @Override public SearchControls answer() throws Throwable {
      SearchControls searchControls=createNiceMock(SearchControls.class);
      replay(searchControls);
      return searchControls;
    }
  }
).once();
  replayAll();
  handler.open(kc,DEFAULT_REALM,kerberosEnvMap);
  handler.createPrincipal("nn/c6501.ambari.apache.org","secret",true);
  handler.close();
  Attributes attributes=capturedAttributes.getValue();
  String[] objectClasses=new String[]{"top","person","organizationalPerson","user"};
  Assert.assertNotNull(attributes);
  Assert.assertEquals(8,attributes.size());
  Assert.assertNotNull(attributes.get("objectClass"));
  Assert.assertEquals(objectClasses.length,attributes.get("objectClass").size());
  for (int i=0; i < objectClasses.length; i++) {
    Assert.assertEquals(objectClasses[i],attributes.get("objectClass").get(i));
  }
  Assert.assertNotNull(attributes.get("cn"));
  Assert.assertEquals("nn-995e1580db28198e7fda1417ab5d894c877937d2",attributes.get("cn").get());
  Assert.assertNotNull(attributes.get("servicePrincipalName"));
  Assert.assertEquals("nn/c6501.ambari.apache.org",attributes.get("servicePrincipalName").get());
  Assert.assertNotNull(attributes.get("userPrincipalName"));
  Assert.assertEquals("nn/c6501.ambari.apache.org@HDP01.LOCAL",attributes.get("userPrincipalName").get());
  Assert.assertNotNull(attributes.get("sAMAccountName"));
  Assert.assertTrue(attributes.get("sAMAccountName").get().toString().length() <= 20);
  Assert.assertEquals("nn-995e1580db28198e7",attributes.get("sAMAccountName").get());
  Assert.assertNotNull(attributes.get("unicodePwd"));
  Assert.assertEquals("\"secret\"",new String((byte[])attributes.get("unicodePwd").get(),Charset.forName("UTF-16LE")));
  Assert.assertNotNull(attributes.get("accountExpires"));
  Assert.assertEquals("0",attributes.get("accountExpires").get());
  Assert.assertNotNull(attributes.get("userAccountControl"));
  Assert.assertEquals("66048",attributes.get("userAccountControl").get());
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessCreateTemplateDefault() throws Exception {
  PrincipalKeyCredential kc=new PrincipalKeyCredential(DEFAULT_ADMIN_PRINCIPAL,DEFAULT_ADMIN_PASSWORD);
  Map<String,String> kerberosEnvMap=new HashMap<String,String>(){
{
      put(ADKerberosOperationHandler.KERBEROS_ENV_LDAP_URL,DEFAULT_LDAP_URL);
      put(ADKerberosOperationHandler.KERBEROS_ENV_PRINCIPAL_CONTAINER_DN,DEFAULT_PRINCIPAL_CONTAINER_DN);
    }
  }
;
  Capture<Name> capturedName=new Capture<Name>(CaptureType.ALL);
  Capture<Attributes> capturedAttributes=new Capture<Attributes>(CaptureType.ALL);
  ADKerberosOperationHandler handler=createMockBuilder(ADKerberosOperationHandler.class).addMockedMethod(ADKerberosOperationHandler.class.getDeclaredMethod("createInitialLdapContext",Properties.class,Control[].class)).addMockedMethod(ADKerberosOperationHandler.class.getDeclaredMethod("createSearchControls")).createNiceMock();
  NamingEnumeration<SearchResult> searchResult=createNiceMock(NamingEnumeration.class);
  expect(searchResult.hasMore()).andReturn(false).once();
  LdapContext ldapContext=createNiceMock(LdapContext.class);
  expect(ldapContext.search(anyObject(String.class),anyObject(String.class),anyObject(SearchControls.class))).andReturn(searchResult).once();
  expect(ldapContext.createSubcontext(capture(capturedName),capture(capturedAttributes))).andReturn(createNiceMock(DirContext.class)).anyTimes();
  expect(handler.createInitialLdapContext(anyObject(Properties.class),anyObject(Control[].class))).andReturn(ldapContext).once();
  expect(handler.createSearchControls()).andAnswer(new IAnswer<SearchControls>(){
    @Override public SearchControls answer() throws Throwable {
      SearchControls searchControls=createNiceMock(SearchControls.class);
      replay(searchControls);
      return searchControls;
    }
  }
).once();
  replayAll();
  handler.open(kc,DEFAULT_REALM,kerberosEnvMap);
  handler.createPrincipal("nn/c6501.ambari.apache.org","secret",true);
  handler.createPrincipal("hdfs@" + DEFAULT_REALM,"secret",false);
  handler.close();
  List<Attributes> attributesList=capturedAttributes.getValues();
  Attributes attributes;
  attributes=attributesList.get(0);
  String[] objectClasses=new String[]{"top","person","organizationalPerson","user"};
  Assert.assertNotNull(attributes);
  Assert.assertEquals(7,attributes.size());
  Assert.assertNotNull(attributes.get("objectClass"));
  Assert.assertEquals(objectClasses.length,attributes.get("objectClass").size());
  for (int i=0; i < objectClasses.length; i++) {
    Assert.assertEquals(objectClasses[i],attributes.get("objectClass").get(i));
  }
  Assert.assertNotNull(attributes.get("cn"));
  Assert.assertEquals("nn/c6501.ambari.apache.org",attributes.get("cn").get());
  Assert.assertNotNull(attributes.get("servicePrincipalName"));
  Assert.assertEquals("nn/c6501.ambari.apache.org",attributes.get("servicePrincipalName").get());
  Assert.assertNotNull(attributes.get("userPrincipalName"));
  Assert.assertEquals("nn/c6501.ambari.apache.org@HDP01.LOCAL",attributes.get("userPrincipalName").get());
  Assert.assertNotNull(attributes.get("unicodePwd"));
  Assert.assertEquals("\"secret\"",new String((byte[])attributes.get("unicodePwd").get(),Charset.forName("UTF-16LE")));
  Assert.assertNotNull(attributes.get("accountExpires"));
  Assert.assertEquals("0",attributes.get("accountExpires").get());
  Assert.assertNotNull(attributes.get("userAccountControl"));
  Assert.assertEquals("66048",attributes.get("userAccountControl").get());
  attributes=attributesList.get(1);
  Assert.assertNotNull(attributes);
  Assert.assertEquals(6,attributes.size());
  Assert.assertNotNull(attributes.get("objectClass"));
  Assert.assertEquals(objectClasses.length,attributes.get("objectClass").size());
  for (int i=0; i < objectClasses.length; i++) {
    Assert.assertEquals(objectClasses[i],attributes.get("objectClass").get(i));
  }
  Assert.assertNotNull(attributes.get("cn"));
  Assert.assertEquals("hdfs",attributes.get("cn").get());
  Assert.assertNotNull(attributes.get("userPrincipalName"));
  Assert.assertEquals("hdfs@HDP01.LOCAL",attributes.get("userPrincipalName").get());
  Assert.assertNotNull(attributes.get("unicodePwd"));
  Assert.assertEquals("\"secret\"",new String((byte[])attributes.get("unicodePwd").get(),Charset.forName("UTF-16LE")));
  Assert.assertNotNull(attributes.get("accountExpires"));
  Assert.assertEquals("0",attributes.get("accountExpires").get());
  Assert.assertNotNull(attributes.get("userAccountControl"));
  Assert.assertEquals("66048",attributes.get("userAccountControl").get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.CreateKeytabFilesServerActionTest </h4><pre class="type-4 type-2 type-5 type-20 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnsureAmbariOnlyAccess() throws Exception {
  Assume.assumeTrue(ShellCommandUtil.UNIX_LIKE);
  Path path;
  Set<PosixFilePermission> permissions;
  File directory=testFolder.newFolder();
  Assert.assertNotNull(directory);
  new CreateKeytabFilesServerAction().ensureAmbariOnlyAccess(directory);
  path=Paths.get(directory.getAbsolutePath());
  Assert.assertNotNull(path);
  permissions=Files.getPosixFilePermissions(path);
  Assert.assertNotNull(permissions);
  Assert.assertNotNull(permissions);
  Assert.assertEquals(3,permissions.size());
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_READ));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_WRITE));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_EXECUTE));
  File file=File.createTempFile("temp_","",directory);
  Assert.assertNotNull(file);
  Assert.assertTrue(file.exists());
  new CreateKeytabFilesServerAction().ensureAmbariOnlyAccess(file);
  path=Paths.get(file.getAbsolutePath());
  Assert.assertNotNull(path);
  permissions=Files.getPosixFilePermissions(path);
  Assert.assertNotNull(permissions);
  Assert.assertEquals(2,permissions.size());
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_READ));
  Assert.assertTrue(permissions.contains(PosixFilePermission.OWNER_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OWNER_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.GROUP_EXECUTE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_READ));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_WRITE));
  Assert.assertFalse(permissions.contains(PosixFilePermission.OTHERS_EXECUTE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.DeconstructedPrincipalTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrimaryInstanceRealm() throws Exception {
  DeconstructedPrincipal deconstructedPrincipal=DeconstructedPrincipal.valueOf("primary/instance@MYREALM","REALM");
  assertNotNull(deconstructedPrincipal);
  assertEquals("primary",deconstructedPrincipal.getPrimary());
  assertEquals("instance",deconstructedPrincipal.getInstance());
  assertEquals("MYREALM",deconstructedPrincipal.getRealm());
  assertEquals("primary/instance",deconstructedPrincipal.getPrincipalName());
  assertEquals("primary/instance@MYREALM",deconstructedPrincipal.getNormalizedPrincipal());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrimary() throws Exception {
  DeconstructedPrincipal deconstructedPrincipal=DeconstructedPrincipal.valueOf("primary","REALM");
  assertNotNull(deconstructedPrincipal);
  assertEquals("primary",deconstructedPrincipal.getPrimary());
  assertNull(deconstructedPrincipal.getInstance());
  assertEquals("REALM",deconstructedPrincipal.getRealm());
  assertEquals("primary",deconstructedPrincipal.getPrincipalName());
  assertEquals("primary@REALM",deconstructedPrincipal.getNormalizedPrincipal());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOddCharacters() throws Exception {
  DeconstructedPrincipal deconstructedPrincipal=DeconstructedPrincipal.valueOf("p_ri.ma-ry/i.n_s-tance@M_Y-REALM.COM","REALM");
  assertNotNull(deconstructedPrincipal);
  assertEquals("p_ri.ma-ry",deconstructedPrincipal.getPrimary());
  assertEquals("i.n_s-tance",deconstructedPrincipal.getInstance());
  assertEquals("M_Y-REALM.COM",deconstructedPrincipal.getRealm());
  assertEquals("p_ri.ma-ry/i.n_s-tance",deconstructedPrincipal.getPrincipalName());
  assertEquals("p_ri.ma-ry/i.n_s-tance@M_Y-REALM.COM",deconstructedPrincipal.getNormalizedPrincipal());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrimaryInstance() throws Exception {
  DeconstructedPrincipal deconstructedPrincipal=DeconstructedPrincipal.valueOf("primary/instance","REALM");
  assertNotNull(deconstructedPrincipal);
  assertEquals("primary",deconstructedPrincipal.getPrimary());
  assertEquals("instance",deconstructedPrincipal.getInstance());
  assertEquals("instance",deconstructedPrincipal.getInstance());
  assertEquals("REALM",deconstructedPrincipal.getRealm());
  assertEquals("primary/instance",deconstructedPrincipal.getPrincipalName());
  assertEquals("primary/instance@REALM",deconstructedPrincipal.getNormalizedPrincipal());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrimaryRealm() throws Exception {
  DeconstructedPrincipal deconstructedPrincipal=DeconstructedPrincipal.valueOf("primary@MYREALM","REALM");
  assertNotNull(deconstructedPrincipal);
  assertEquals("primary",deconstructedPrincipal.getPrimary());
  assertNull(deconstructedPrincipal.getInstance());
  assertEquals("MYREALM",deconstructedPrincipal.getRealm());
  assertEquals("primary",deconstructedPrincipal.getPrincipalName());
  assertEquals("primary@MYREALM",deconstructedPrincipal.getNormalizedPrincipal());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosConfigDataFileTest </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosConfigDataFile() throws Exception {
  File file=folder.newFile();
  Assert.assertNotNull(file);
  KerberosConfigDataFileWriter writer=kerberosConfigDataFileWriterFactory.createKerberosConfigDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  for (int i=0; i < 10; i++) {
    writer.addRecord("config-type" + i,"key" + i,"value" + i,KerberosConfigDataFileWriter.OPERATION_TYPE_SET);
  }
  for (int i=10; i < 15; i++) {
    writer.addRecord("config-type" + i,"key" + i,"value" + i,KerberosConfigDataFileWriter.OPERATION_TYPE_REMOVE);
  }
  writer.close();
  Assert.assertTrue(writer.isClosed());
  KerberosConfigDataFileReader reader=kerberosConfigDataFileReaderFactory.createKerberosConfigDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  Iterator<Map<String,String>> iterator=reader.iterator();
  Assert.assertNotNull(iterator);
  int i=0;
  while (iterator.hasNext()) {
    Map<String,String> record=iterator.next();
    if (i < 15) {
      Assert.assertEquals("config-type" + i,record.get(KerberosConfigDataFileReader.CONFIGURATION_TYPE));
      Assert.assertEquals("key" + i,record.get(KerberosConfigDataFileReader.KEY));
      Assert.assertEquals("value" + i,record.get(KerberosConfigDataFileReader.VALUE));
      if (i < 10) {
        Assert.assertEquals("SET",record.get(KerberosConfigDataFileReader.OPERATION));
      }
 else {
        Assert.assertEquals("REMOVE",record.get(KerberosConfigDataFileReader.OPERATION));
      }
    }
    i++;
  }
  Assert.assertEquals(15,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    if (i < 10) {
      Assert.assertEquals("config-type" + i,record.get(KerberosConfigDataFileReader.CONFIGURATION_TYPE));
      Assert.assertEquals("key" + i,record.get(KerberosConfigDataFileReader.KEY));
      Assert.assertEquals("value" + i,record.get(KerberosConfigDataFileReader.VALUE));
    }
    i++;
  }
  Assert.assertEquals(15,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer.open();
  Assert.assertFalse(writer.isClosed());
  writer.addRecord("config-type","key","value",KerberosConfigDataFileReader.OPERATION_TYPE_SET);
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader=kerberosConfigDataFileReaderFactory.createKerberosConfigDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(16,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer=kerberosConfigDataFileWriterFactory.createKerberosConfigDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  writer.addRecord("config-type","key","value",KerberosConfigDataFileReader.OPERATION_TYPE_REMOVE);
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(17,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(0,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosIdentityDataFileTest </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosIdentityDataFile() throws Exception {
  File file=folder.newFile();
  Assert.assertNotNull(file);
  KerberosIdentityDataFileWriter writer=kerberosIdentityDataFileWriterFactory.createKerberosIdentityDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  for (int i=0; i < 10; i++) {
    writer.writeRecord("hostName" + i,"serviceName" + i,"serviceComponentName" + i,"principal" + i,"principal_type" + i,"keytabFilePath" + i,"keytabFileOwnerName" + i,"keytabFileOwnerAccess" + i,"keytabFileGroupName" + i,"keytabFileGroupAccess" + i,"false");
  }
  writer.writeRecord("hostName's","serviceName#","serviceComponentName\"","principal","principal_type","keytabFilePath","'keytabFileOwnerName'","<keytabFileOwnerAccess>","\"keytabFileGroupName\"","keytab,File,Group,Access","false");
  writer.close();
  Assert.assertTrue(writer.isClosed());
  KerberosIdentityDataFileReader reader=kerberosIdentityDataFileReaderFactory.createKerberosIdentityDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  Iterator<Map<String,String>> iterator=reader.iterator();
  Assert.assertNotNull(iterator);
  int i=0;
  while (iterator.hasNext()) {
    Map<String,String> record=iterator.next();
    if (i < 10) {
      Assert.assertEquals("hostName" + i,record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName" + i,record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName" + i,record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("keytabFileOwnerName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("keytabFileOwnerAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("keytabFileGroupName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytabFileGroupAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
      Assert.assertEquals("false",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_IS_CACHABLE));
    }
 else {
      Assert.assertEquals("hostName's",record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName#",record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName\"",record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal",record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type",record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("'keytabFileOwnerName'",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("<keytabFileOwnerAccess>",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("\"keytabFileGroupName\"",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytab,File,Group,Access",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
      Assert.assertEquals("false",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_IS_CACHABLE));
    }
    i++;
  }
  reader.close();
  Assert.assertTrue(reader.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    if (i < 10) {
      Assert.assertEquals("hostName" + i,record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName" + i,record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName" + i,record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type" + i,record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("keytabFileOwnerName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("keytabFileOwnerAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("keytabFileGroupName" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytabFileGroupAccess" + i,record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
    }
 else {
      Assert.assertEquals("hostName's",record.get(KerberosIdentityDataFileReader.HOSTNAME));
      Assert.assertEquals("serviceName#",record.get(KerberosIdentityDataFileReader.SERVICE));
      Assert.assertEquals("serviceComponentName\"",record.get(KerberosIdentityDataFileReader.COMPONENT));
      Assert.assertEquals("principal",record.get(KerberosIdentityDataFileReader.PRINCIPAL));
      Assert.assertEquals("principal_type",record.get(KerberosIdentityDataFileReader.PRINCIPAL_TYPE));
      Assert.assertEquals("keytabFilePath",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_PATH));
      Assert.assertEquals("'keytabFileOwnerName'",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_NAME));
      Assert.assertEquals("<keytabFileOwnerAccess>",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_OWNER_ACCESS));
      Assert.assertEquals("\"keytabFileGroupName\"",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_NAME));
      Assert.assertEquals("keytab,File,Group,Access",record.get(KerberosIdentityDataFileReader.KEYTAB_FILE_GROUP_ACCESS));
    }
    i++;
  }
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer.open();
  Assert.assertFalse(writer.isClosed());
  writer.writeRecord("hostName","serviceName","serviceComponentName","principal","principal_type","keytabFilePath","keytabFileOwnerName","keytabFileOwnerAccess","keytabFileGroupName","keytabFileGroupAccess","true");
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader=kerberosIdentityDataFileReaderFactory.createKerberosIdentityDataFileReader(file);
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(12,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  writer=kerberosIdentityDataFileWriterFactory.createKerberosIdentityDataFileWriter(file);
  Assert.assertFalse(writer.isClosed());
  writer.writeRecord("hostName","serviceName","serviceComponentName","principal","principal_type","keytabFilePath","keytabFileOwnerName","keytabFileOwnerAccess","keytabFileGroupName","keytabFileGroupAccess","true");
  writer.close();
  Assert.assertTrue(writer.isClosed());
  reader.open();
  Assert.assertFalse(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(13,i);
  reader.close();
  Assert.assertTrue(reader.isClosed());
  i=0;
  for (  Map<String,String> record : reader) {
    i++;
  }
  Assert.assertEquals(0,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosOperationHandlerFactoryTest </h4><pre class="type-11 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testForNull(){
  Assert.assertNull(injector.getInstance(KerberosOperationHandlerFactory.class).getKerberosOperationHandler(null));
}

</code></pre>

<br>
<pre class="type-11 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testForNone(){
  Assert.assertNull(injector.getInstance(KerberosOperationHandlerFactory.class).getKerberosOperationHandler(KDCType.NONE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosOperationHandlerTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetExecutableSearchPaths() throws KerberosOperationException {
  KerberosOperationHandler handler=createHandler();
  handler.setExecutableSearchPaths((String)null);
  Assert.assertNull(handler.getExecutableSearchPaths());
  handler.setExecutableSearchPaths((String[])null);
  Assert.assertNull(handler.getExecutableSearchPaths());
  handler.setExecutableSearchPaths("");
  Assert.assertNotNull(handler.getExecutableSearchPaths());
  Assert.assertEquals(0,handler.getExecutableSearchPaths().length);
  handler.setExecutableSearchPaths(new String[0]);
  Assert.assertNotNull(handler.getExecutableSearchPaths());
  Assert.assertEquals(0,handler.getExecutableSearchPaths().length);
  handler.setExecutableSearchPaths(new String[]{""});
  Assert.assertNotNull(handler.getExecutableSearchPaths());
  Assert.assertEquals(1,handler.getExecutableSearchPaths().length);
  handler.setExecutableSearchPaths("/path1, path2, path3/");
  Assert.assertNotNull(handler.getExecutableSearchPaths());
  Assert.assertEquals(3,handler.getExecutableSearchPaths().length);
  Assert.assertEquals("/path1",handler.getExecutableSearchPaths()[0]);
  Assert.assertEquals("path2",handler.getExecutableSearchPaths()[1]);
  Assert.assertEquals("path3/",handler.getExecutableSearchPaths()[2]);
  handler.setExecutableSearchPaths("/path1, path2, ,path3/");
  Assert.assertNotNull(handler.getExecutableSearchPaths());
  Assert.assertEquals(3,handler.getExecutableSearchPaths().length);
  Assert.assertEquals("/path1",handler.getExecutableSearchPaths()[0]);
  Assert.assertEquals("path2",handler.getExecutableSearchPaths()[1]);
  Assert.assertEquals("path3/",handler.getExecutableSearchPaths()[2]);
  handler.setExecutableSearchPaths(new String[]{"/path1","path2","path3/"});
  Assert.assertNotNull(handler.getExecutableSearchPaths());
  Assert.assertEquals(3,handler.getExecutableSearchPaths().length);
  Assert.assertEquals("/path1",handler.getExecutableSearchPaths()[0]);
  Assert.assertEquals("path2",handler.getExecutableSearchPaths()[1]);
  Assert.assertEquals("path3/",handler.getExecutableSearchPaths()[2]);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateKeytabFileFromBase64EncodedData() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal="principal@REALM.COM";
  Assert.assertTrue(handler.createKeytabFile(principal,"some password",0,file));
  FileInputStream fis=new FileInputStream(file);
  byte[] data=new byte[(int)file.length()];
  Assert.assertEquals(data.length,fis.read(data));
  fis.close();
  File f=handler.createKeytabFile(Base64.encodeBase64String(data));
  if (f != null) {
    try {
      Keytab keytab=Keytab.read(f);
      Assert.assertNotNull(keytab);
      List<KeytabEntry> entries=keytab.getEntries();
      Assert.assertNotNull(entries);
      Assert.assertFalse(entries.isEmpty());
      for (      KeytabEntry entry : entries) {
        Assert.assertEquals(principal,entry.getPrincipalName());
      }
    }
  finally {
      if (!f.delete()) {
        f.deleteOnExit();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateKeytabFileOneAtATime() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal1="principal1@REALM.COM";
  final String principal2="principal2@REALM.COM";
  int count;
  Assert.assertTrue(handler.createKeytabFile(principal1,"some password",0,file));
  Keytab keytab=Keytab.read(file);
  Assert.assertNotNull(keytab);
  List<KeytabEntry> entries=keytab.getEntries();
  Assert.assertNotNull(entries);
  Assert.assertFalse(entries.isEmpty());
  count=entries.size();
  for (  KeytabEntry entry : entries) {
    Assert.assertEquals(principal1,entry.getPrincipalName());
  }
  Assert.assertTrue(handler.createKeytabFile(principal2,"some password",0,file));
  keytab=Keytab.read(file);
  Assert.assertNotNull(keytab);
  entries=keytab.getEntries();
  Assert.assertNotNull(entries);
  Assert.assertFalse(entries.isEmpty());
  Assert.assertEquals(count * 2,entries.size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEscapeCharacters() throws KerberosOperationException {
  KerberosOperationHandler handler=createHandler();
  HashSet<Character> specialCharacters=new HashSet<Character>(){
{
      add('/');
      add(',');
      add('\\');
      add('#');
      add('+');
      add('<');
      add('>');
      add(';');
      add('"');
      add('=');
      add(' ');
    }
  }
;
  Assert.assertEquals("\\/\\,\\\\\\#\\+\\<\\>\\;\\\"\\=\\ ",handler.escapeCharacters("/,\\#+<>;\"= ",specialCharacters,'\\'));
  Assert.assertNull(handler.escapeCharacters(null,specialCharacters,'\\'));
  Assert.assertEquals("",handler.escapeCharacters("",specialCharacters,'\\'));
  Assert.assertEquals("nothing_special_here",handler.escapeCharacters("nothing_special_here",specialCharacters,'\\'));
  Assert.assertEquals("\\/\\,\\\\\\#\\+\\<\\>\\;\\\"\\=\\ ",handler.escapeCharacters("/,\\#+<>;\"= ",specialCharacters,'\\'));
  Assert.assertEquals("nothing<>special#here!",handler.escapeCharacters("nothing<>special#here!",null,'\\'));
  Assert.assertEquals("nothing<>special#here!",handler.escapeCharacters("nothing<>special#here!",Collections.<Character>emptySet(),'\\'));
  Assert.assertEquals("nothing<>special#here!",handler.escapeCharacters("nothing<>special#here!",Collections.singleton('?'),'\\'));
  Assert.assertEquals("\\A's are special!",handler.escapeCharacters("A's are special!",Collections.singleton('A'),'\\'));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnsureKeytabFileContainsNoDuplicates() throws Exception {
  KerberosOperationHandler handler=createHandler();
  File file=folder.newFile();
  final String principal1="principal1@REALM.COM";
  final String principal2="principal2@REALM.COM";
  Set<String> seenEntries=new HashSet<String>();
  Assert.assertTrue(handler.createKeytabFile(principal1,"some password",0,file));
  Assert.assertTrue(handler.createKeytabFile(principal2,"some password",0,file));
  Assert.assertTrue(handler.createKeytabFile(principal2,"some password",0,file));
  Keytab keytab=Keytab.read(file);
  Assert.assertNotNull(keytab);
  List<KeytabEntry> entries=keytab.getEntries();
  Assert.assertNotNull(entries);
  Assert.assertFalse(entries.isEmpty());
  for (  KeytabEntry entry : entries) {
    String seenEntry=String.format("%s|%s",entry.getPrincipalName(),entry.getKey().getKeyType().toString());
    Assert.assertFalse(seenEntries.contains(seenEntry));
    seenEntries.add(seenEntry);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.kerberos.KerberosServerActionTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessIdentitiesFail() throws Exception {
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  expect(kerberosHelper.getKDCAdministratorCredentials(EasyMock.anyObject(String.class))).andReturn(new PrincipalKeyCredential("principal","password")).anyTimes();
  replay(kerberosHelper);
  ConcurrentMap<String,Object> sharedMap=new ConcurrentHashMap<String,Object>();
  sharedMap.put("FAIL","true");
  CommandReport report=action.processIdentities(sharedMap);
  Assert.assertNotNull(report);
  Assert.assertEquals(HostRoleStatus.FAILED.toString(),report.getStatus());
  verify(kerberosHelper);
}

</code></pre>

<br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testGetPrincipalPasswordMapStatic() throws Exception {
  ConcurrentMap<String,Object> sharedMap=new ConcurrentHashMap<String,Object>();
  Assert.assertNotNull(KerberosServerAction.getPrincipalPasswordMap(sharedMap));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessIdentitiesSuccess() throws Exception {
  KerberosHelper kerberosHelper=injector.getInstance(KerberosHelper.class);
  expect(kerberosHelper.getKDCAdministratorCredentials(EasyMock.anyObject(String.class))).andReturn(new PrincipalKeyCredential("principal","password")).anyTimes();
  replay(kerberosHelper);
  ConcurrentMap<String,Object> sharedMap=new ConcurrentHashMap<String,Object>();
  CommandReport report=action.processIdentities(sharedMap);
  Assert.assertNotNull(report);
  Assert.assertEquals(HostRoleStatus.COMPLETED.toString(),report.getStatus());
  for (  Map.Entry<String,Object> entry : sharedMap.entrySet()) {
    Assert.assertEquals(entry.getValue(),entry.getKey().replace("_HOST","hostName").replace("_REALM","REALM.COM"));
  }
  verify(kerberosHelper);
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetCommandParameterValueStatic() throws Exception {
  Assert.assertNull(KerberosServerAction.getCommandParameterValue(commandParams,"nonexistingvalue"));
  Assert.assertEquals("REALM.COM",KerberosServerAction.getCommandParameterValue(commandParams,KerberosServerAction.DEFAULT_REALM));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  final Cluster cluster=mock(Cluster.class);
  final Clusters clusters=mock(Clusters.class);
  when(clusters.getCluster(anyString())).thenReturn(cluster);
  final ExecutionCommand mockExecutionCommand=mock(ExecutionCommand.class);
  final HostRoleCommand mockHostRoleCommand=mock(HostRoleCommand.class);
  injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      bind(KerberosHelper.class).toInstance(createNiceMock(KerberosHelper.class));
      bind(KerberosServerAction.class).toInstance(new KerberosServerAction(){
        @Override protected CommandReport processIdentity(        Map<String,String> identityRecord,        String evaluatedPrincipal,        KerberosOperationHandler operationHandler,        Map<String,String> kerberosConfiguration,        Map<String,Object> requestSharedDataContext) throws AmbariException {
          Assert.assertNotNull(requestSharedDataContext);
          if (requestSharedDataContext.get("FAIL") != null) {
            return createCommandReport(1,HostRoleStatus.FAILED,"{}","ERROR","ERROR");
          }
 else {
            requestSharedDataContext.put(identityRecord.get(KerberosIdentityDataFileReader.PRINCIPAL),evaluatedPrincipal);
            return null;
          }
        }
        @Override public CommandReport execute(        ConcurrentMap<String,Object> requestSharedDataContext) throws AmbariException, InterruptedException {
          return processIdentities(requestSharedDataContext);
        }
      }
);
      bind(Clusters.class).toInstance(clusters);
      bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
    }
  }
);
  temporaryDirectory=File.createTempFile("ambari_ut_",".d");
  Assert.assertTrue(temporaryDirectory.delete());
  Assert.assertTrue(temporaryDirectory.mkdirs());
  KerberosIdentityDataFileWriter writer=new KerberosIdentityDataFileWriter(new File(temporaryDirectory,KerberosIdentityDataFileWriter.DATA_FILE_NAME));
  for (int i=0; i < 10; i++) {
    writer.writeRecord("hostName","serviceName" + i,"serviceComponentName" + i,"principal|_HOST|_REALM" + i,"principal_type","keytabFilePath" + i,"keytabFileOwnerName" + i,"keytabFileOwnerAccess" + i,"keytabFileGroupName" + i,"keytabFileGroupAccess" + i,"false");
  }
  writer.close();
  commandParams.put(KerberosServerAction.DATA_DIRECTORY,temporaryDirectory.getAbsolutePath());
  commandParams.put(KerberosServerAction.DEFAULT_REALM,"REALM.COM");
  commandParams.put(KerberosServerAction.KDC_TYPE,KDCType.MIT_KDC.toString());
  when(mockExecutionCommand.getCommandParams()).thenReturn(commandParams);
  when(mockExecutionCommand.getClusterName()).thenReturn("c1");
  action=injector.getInstance(KerberosServerAction.class);
  action.setExecutionCommand(mockExecutionCommand);
  action.setHostRoleCommand(mockHostRoleCommand);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.AutoSkipFailedSummaryActionTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests workflow with failed host component tasks only
 */
@Test public void testAutoSkipFailedSummaryAction__red__host_components_only() throws Exception {
  AutoSkipFailedSummaryAction action=new AutoSkipFailedSummaryAction();
  m_injector.injectMembers(action);
  ServiceComponentHostEvent event=createNiceMock(ServiceComponentHostEvent.class);
  final HostRoleCommand hostRoleCommand=new HostRoleCommand("host1",Role.AMBARI_SERVER_ACTION,event,RoleCommand.EXECUTE,hostDAO,executionCommandDAO);
  hostRoleCommand.setRequestId(1l);
  hostRoleCommand.setStageId(1l);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setClusterName("cc");
  executionCommand.setRoleCommand(RoleCommand.EXECUTE);
  executionCommand.setRole("AMBARI_SERVER_ACTION");
  executionCommand.setServiceName("");
  executionCommand.setTaskId(1l);
  ExecutionCommandWrapper wrapper=new ExecutionCommandWrapper(executionCommand);
  hostRoleCommand.setExecutionCommandWrapper(wrapper);
  Field f=AbstractServerAction.class.getDeclaredField("hostRoleCommand");
  f.setAccessible(true);
  f.set(action,hostRoleCommand);
  final UpgradeItemEntity upgradeItem1=new UpgradeItemEntity();
  upgradeItem1.setStageId(5l);
  final UpgradeItemEntity upgradeItem2=new UpgradeItemEntity();
  upgradeItem2.setStageId(6l);
  UpgradeGroupEntity upgradeGroupEntity=new UpgradeGroupEntity();
  upgradeGroupEntity.setId(11l);
  List<UpgradeItemEntity> groupUpgradeItems=new ArrayList<UpgradeItemEntity>(){
{
      add(upgradeItem1);
      add(upgradeItem2);
    }
  }
;
  upgradeGroupEntity.setItems(groupUpgradeItems);
  UpgradeItemEntity upgradeItemEntity=new UpgradeItemEntity();
  upgradeItemEntity.setGroupEntity(upgradeGroupEntity);
  expect(upgradeDAOMock.findUpgradeItemByRequestAndStage(anyLong(),anyLong())).andReturn(upgradeItemEntity).anyTimes();
  expect(upgradeDAOMock.findUpgradeGroup(anyLong())).andReturn(upgradeGroupEntity).anyTimes();
  replay(upgradeDAOMock);
  List<HostRoleCommandEntity> skippedTasks=new ArrayList<HostRoleCommandEntity>(){
{
      add(createSkippedTask("DATANODE","DATANODE","host1.vm","RESTART HDFS/DATANODE",RoleCommand.CUSTOM_COMMAND,"RESTART"));
      add(createSkippedTask("DATANODE","DATANODE","host2.vm","RESTART HDFS/DATANODE",RoleCommand.CUSTOM_COMMAND,"RESTART"));
    }
  }
;
  expect(hostRoleCommandDAOMock.findByStatusBetweenStages(anyLong(),anyObject(HostRoleStatus.class),anyLong(),anyLong())).andReturn(skippedTasks).anyTimes();
  replay(hostRoleCommandDAOMock);
  ConcurrentMap<String,Object> requestSharedDataContext=new ConcurrentHashMap<String,Object>();
  CommandReport result=action.execute(requestSharedDataContext);
  assertNotNull(result.getStructuredOut());
  assertEquals(0,result.getExitCode());
  assertEquals(HostRoleStatus.HOLDING.toString(),result.getStatus());
  assertEquals("There were 2 skipped failure(s) that must be addressed " + "before you can proceed. Please resolve each failure before continuing with the upgrade.",result.getStdOut());
  assertEquals("{\"failures\":" + "{\"host_component\":" + "{\"host1.vm\":[{\"component\":\"DATANODE\",\"service\":\"HDFS\"}],"+ "\"host2.vm\":[{\"component\":\"DATANODE\",\"service\":\"HDFS\"}]}},"+ "\"skipped\":[\"host_component\"]}",result.getStructuredOut());
  assertEquals("The following steps failed but were automatically skipped:\n" + "DATANODE on host1.vm: RESTART HDFS/DATANODE\n" + "DATANODE on host2.vm: RESTART HDFS/DATANODE\n",result.getStdErr());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests workflow with few skipped tasks
 */
@Test public void testAutoSkipFailedSummaryAction__red() throws Exception {
  AutoSkipFailedSummaryAction action=new AutoSkipFailedSummaryAction();
  m_injector.injectMembers(action);
  ServiceComponentHostEvent event=createNiceMock(ServiceComponentHostEvent.class);
  final HostRoleCommand hostRoleCommand=new HostRoleCommand("host1",Role.AMBARI_SERVER_ACTION,event,RoleCommand.EXECUTE,hostDAO,executionCommandDAO);
  hostRoleCommand.setRequestId(1l);
  hostRoleCommand.setStageId(1l);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setClusterName("cc");
  executionCommand.setRoleCommand(RoleCommand.EXECUTE);
  executionCommand.setRole("AMBARI_SERVER_ACTION");
  executionCommand.setServiceName("");
  executionCommand.setTaskId(1l);
  ExecutionCommandWrapper wrapper=new ExecutionCommandWrapper(executionCommand);
  hostRoleCommand.setExecutionCommandWrapper(wrapper);
  Field f=AbstractServerAction.class.getDeclaredField("hostRoleCommand");
  f.setAccessible(true);
  f.set(action,hostRoleCommand);
  final UpgradeItemEntity upgradeItem1=new UpgradeItemEntity();
  upgradeItem1.setStageId(5l);
  final UpgradeItemEntity upgradeItem2=new UpgradeItemEntity();
  upgradeItem2.setStageId(6l);
  UpgradeGroupEntity upgradeGroupEntity=new UpgradeGroupEntity();
  upgradeGroupEntity.setId(11l);
  List<UpgradeItemEntity> groupUpgradeItems=new ArrayList<UpgradeItemEntity>(){
{
      add(upgradeItem1);
      add(upgradeItem2);
    }
  }
;
  upgradeGroupEntity.setItems(groupUpgradeItems);
  UpgradeItemEntity upgradeItemEntity=new UpgradeItemEntity();
  upgradeItemEntity.setGroupEntity(upgradeGroupEntity);
  expect(upgradeDAOMock.findUpgradeItemByRequestAndStage(anyLong(),anyLong())).andReturn(upgradeItemEntity).anyTimes();
  expect(upgradeDAOMock.findUpgradeGroup(anyLong())).andReturn(upgradeGroupEntity).anyTimes();
  replay(upgradeDAOMock);
  List<HostRoleCommandEntity> skippedTasks=new ArrayList<HostRoleCommandEntity>(){
{
      add(createSkippedTask("DATANODE","DATANODE","host1.vm","RESTART HDFS/DATANODE",RoleCommand.CUSTOM_COMMAND,"RESTART"));
      add(createSkippedTask("DATANODE","DATANODE","host2.vm","RESTART HDFS/DATANODE",RoleCommand.CUSTOM_COMMAND,"RESTART"));
      add(createSkippedTask("ZOOKEEPER_QUORUM_SERVICE_CHECK","ZOOKEEPER_CLIENT","host2.vm","SERVICE_CHECK ZOOKEEPER",RoleCommand.SERVICE_CHECK,null));
    }
  }
;
  expect(hostRoleCommandDAOMock.findByStatusBetweenStages(anyLong(),anyObject(HostRoleStatus.class),anyLong(),anyLong())).andReturn(skippedTasks).anyTimes();
  replay(hostRoleCommandDAOMock);
  ConcurrentMap<String,Object> requestSharedDataContext=new ConcurrentHashMap<String,Object>();
  CommandReport result=action.execute(requestSharedDataContext);
  assertNotNull(result.getStructuredOut());
  assertEquals(0,result.getExitCode());
  assertEquals(HostRoleStatus.HOLDING.toString(),result.getStatus());
  assertEquals("There were 3 skipped failure(s) that must be addressed " + "before you can proceed. Please resolve each failure before continuing with the upgrade.",result.getStdOut());
  assertEquals("{\"failures\":" + "{\"service_check\":[\"ZOOKEEPER\"]," + "\"host_component\":{"+ "\"host1.vm\":[{\"component\":\"DATANODE\",\"service\":\"HDFS\"}],"+ "\"host2.vm\":[{\"component\":\"DATANODE\",\"service\":\"HDFS\"}]}},"+ "\"skipped\":[\"service_check\",\"host_component\"]}",result.getStructuredOut());
  assertEquals("The following steps failed but were automatically skipped:\n" + "DATANODE on host1.vm: RESTART HDFS/DATANODE\n" + "DATANODE on host2.vm: RESTART HDFS/DATANODE\n"+ "ZOOKEEPER_CLIENT on host2.vm: SERVICE_CHECK ZOOKEEPER\n",result.getStdErr());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests successful workflow
 */
@Test public void testAutoSkipFailedSummaryAction__green() throws Exception {
  AutoSkipFailedSummaryAction action=new AutoSkipFailedSummaryAction();
  m_injector.injectMembers(action);
  ServiceComponentHostEvent event=createNiceMock(ServiceComponentHostEvent.class);
  HostRoleCommand hostRoleCommand=new HostRoleCommand("host1",Role.AMBARI_SERVER_ACTION,event,RoleCommand.EXECUTE,hostDAO,executionCommandDAO);
  hostRoleCommand.setRequestId(1l);
  hostRoleCommand.setStageId(1l);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setClusterName("cc");
  executionCommand.setRoleCommand(RoleCommand.EXECUTE);
  executionCommand.setRole("AMBARI_SERVER_ACTION");
  executionCommand.setServiceName("");
  executionCommand.setTaskId(1l);
  ExecutionCommandWrapper wrapper=new ExecutionCommandWrapper(executionCommand);
  hostRoleCommand.setExecutionCommandWrapper(wrapper);
  Field f=AbstractServerAction.class.getDeclaredField("hostRoleCommand");
  f.setAccessible(true);
  f.set(action,hostRoleCommand);
  final UpgradeItemEntity upgradeItem1=new UpgradeItemEntity();
  upgradeItem1.setStageId(5l);
  final UpgradeItemEntity upgradeItem2=new UpgradeItemEntity();
  upgradeItem2.setStageId(6l);
  UpgradeGroupEntity upgradeGroupEntity=new UpgradeGroupEntity();
  upgradeGroupEntity.setId(11l);
  List<UpgradeItemEntity> groupUpgradeItems=new ArrayList<UpgradeItemEntity>(){
{
      add(upgradeItem1);
      add(upgradeItem2);
    }
  }
;
  upgradeGroupEntity.setItems(groupUpgradeItems);
  UpgradeItemEntity upgradeItemEntity=new UpgradeItemEntity();
  upgradeItemEntity.setGroupEntity(upgradeGroupEntity);
  expect(upgradeDAOMock.findUpgradeItemByRequestAndStage(anyLong(),anyLong())).andReturn(upgradeItemEntity).anyTimes();
  expect(upgradeDAOMock.findUpgradeGroup(anyLong())).andReturn(upgradeGroupEntity).anyTimes();
  replay(upgradeDAOMock);
  List<HostRoleCommandEntity> skippedTasks=new ArrayList<HostRoleCommandEntity>(){
{
    }
  }
;
  expect(hostRoleCommandDAOMock.findByStatusBetweenStages(anyLong(),anyObject(HostRoleStatus.class),anyLong(),anyLong())).andReturn(skippedTasks).anyTimes();
  replay(hostRoleCommandDAOMock);
  ConcurrentMap<String,Object> requestSharedDataContext=new ConcurrentHashMap<String,Object>();
  CommandReport result=action.execute(requestSharedDataContext);
  assertNotNull(result.getStructuredOut());
  assertEquals(0,result.getExitCode());
  assertEquals(HostRoleStatus.COMPLETED.toString(),result.getStatus());
  assertEquals("There were no skipped failures",result.getStdOut());
  assertEquals("{}",result.getStructuredOut());
  assertEquals("",result.getStdErr());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests workflow with failed service check
 */
@Test public void testAutoSkipFailedSummaryAction__red__service_checks_only() throws Exception {
  AutoSkipFailedSummaryAction action=new AutoSkipFailedSummaryAction();
  m_injector.injectMembers(action);
  ServiceComponentHostEvent event=createNiceMock(ServiceComponentHostEvent.class);
  final HostRoleCommand hostRoleCommand=new HostRoleCommand("host1",Role.AMBARI_SERVER_ACTION,event,RoleCommand.EXECUTE,hostDAO,executionCommandDAO);
  hostRoleCommand.setRequestId(1l);
  hostRoleCommand.setStageId(1l);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setClusterName("cc");
  executionCommand.setRoleCommand(RoleCommand.EXECUTE);
  executionCommand.setRole("AMBARI_SERVER_ACTION");
  executionCommand.setServiceName("");
  executionCommand.setTaskId(1l);
  ExecutionCommandWrapper wrapper=new ExecutionCommandWrapper(executionCommand);
  hostRoleCommand.setExecutionCommandWrapper(wrapper);
  Field f=AbstractServerAction.class.getDeclaredField("hostRoleCommand");
  f.setAccessible(true);
  f.set(action,hostRoleCommand);
  final UpgradeItemEntity upgradeItem1=new UpgradeItemEntity();
  upgradeItem1.setStageId(5l);
  final UpgradeItemEntity upgradeItem2=new UpgradeItemEntity();
  upgradeItem2.setStageId(6l);
  UpgradeGroupEntity upgradeGroupEntity=new UpgradeGroupEntity();
  upgradeGroupEntity.setId(11l);
  List<UpgradeItemEntity> groupUpgradeItems=new ArrayList<UpgradeItemEntity>(){
{
      add(upgradeItem1);
      add(upgradeItem2);
    }
  }
;
  upgradeGroupEntity.setItems(groupUpgradeItems);
  UpgradeItemEntity upgradeItemEntity=new UpgradeItemEntity();
  upgradeItemEntity.setGroupEntity(upgradeGroupEntity);
  expect(upgradeDAOMock.findUpgradeItemByRequestAndStage(anyLong(),anyLong())).andReturn(upgradeItemEntity).anyTimes();
  expect(upgradeDAOMock.findUpgradeGroup(anyLong())).andReturn(upgradeGroupEntity).anyTimes();
  replay(upgradeDAOMock);
  List<HostRoleCommandEntity> skippedTasks=new ArrayList<HostRoleCommandEntity>(){
{
      add(createSkippedTask("ZOOKEEPER_QUORUM_SERVICE_CHECK","ZOOKEEPER_CLIENT","host2.vm","SERVICE_CHECK ZOOKEEPER",RoleCommand.SERVICE_CHECK,null));
    }
  }
;
  expect(hostRoleCommandDAOMock.findByStatusBetweenStages(anyLong(),anyObject(HostRoleStatus.class),anyLong(),anyLong())).andReturn(skippedTasks).anyTimes();
  replay(hostRoleCommandDAOMock);
  ConcurrentMap<String,Object> requestSharedDataContext=new ConcurrentHashMap<String,Object>();
  CommandReport result=action.execute(requestSharedDataContext);
  assertNotNull(result.getStructuredOut());
  assertEquals(0,result.getExitCode());
  assertEquals(HostRoleStatus.HOLDING.toString(),result.getStatus());
  assertEquals("There were 1 skipped failure(s) that must be addressed " + "before you can proceed. Please resolve each failure before continuing with the upgrade.",result.getStdOut());
  assertEquals("{\"failures\":{\"service_check\":[\"ZOOKEEPER\"]},\"skipped\":[\"service_check\"]}",result.getStructuredOut());
  assertEquals("The following steps failed but were automatically skipped:\n" + "ZOOKEEPER_CLIENT on host2.vm: SERVICE_CHECK ZOOKEEPER\n",result.getStdErr());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.ComponentVersionCheckActionTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMixedComponentVersions() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_2_1_0;
  makeCrossStackUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  Clusters clusters=m_injector.getInstance(Clusters.class);
  Cluster cluster=clusters.getCluster("c1");
  Service service=installService(cluster,"HDFS");
  addServiceComponent(cluster,service,"NAMENODE");
  addServiceComponent(cluster,service,"DATANODE");
  createNewServiceComponentHost(cluster,"HDFS","NAMENODE","h1");
  createNewServiceComponentHost(cluster,"HDFS","DATANODE","h1");
  createConfigs(cluster);
  cluster.setCurrentStackVersion(sourceStack);
  cluster.setDesiredStackVersion(targetStack);
  cluster.getServiceComponentHosts("HDFS","NAMENODE").get(0).setVersion(targetRepo);
  ClusterVersionEntity upgradingClusterVersion=clusterVersionDAO.findByClusterAndStackAndVersion("c1",HDP_22_STACK,targetRepo);
  upgradingClusterVersion.setState(RepositoryVersionState.UPGRADING);
  upgradingClusterVersion=clusterVersionDAO.merge(upgradingClusterVersion);
  upgradingClusterVersion=clusterVersionDAO.findByClusterAndStackAndVersion("c1",HDP_22_STACK,targetRepo);
  List<HostVersionEntity> hostVersions=hostVersionDAO.findByClusterStackAndVersion("c1",HDP_22_STACK,targetRepo);
  assertEquals(RepositoryVersionState.UPGRADING,upgradingClusterVersion.getState());
  assertTrue(hostVersions.size() > 0);
  for (  HostVersionEntity hostVersion : hostVersions) {
    assertEquals(RepositoryVersionState.UPGRADED,hostVersion.getState());
  }
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"upgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,targetRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ComponentVersionCheckAction action=m_injector.getInstance(ComponentVersionCheckAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.FAILED.name(),report.getStatus());
  assertEquals(-1,report.getExitCode());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMatchingVersions() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_21_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_1_1_1;
  makeUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  AmbariMetaInfo metaInfo=m_injector.getInstance(AmbariMetaInfo.class);
  RepositoryInfo repo=metaInfo.getRepository(sourceStack.getStackName(),sourceStack.getStackVersion(),"redhat6",sourceStack.getStackId());
  assertEquals(HDP_211_CENTOS6_REPO_URL,repo.getBaseUrl());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"upgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,targetRepo);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ComponentVersionCheckAction action=m_injector.getInstance(ComponentVersionCheckAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  assertEquals(0,report.getExitCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.ConfigureActionTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigActionUpgradeAcrossStack() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setCurrentStackVersion(HDP_211_STACK);
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("initLimit","10");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  List<ConfigurationKeyValue> configurations=new ArrayList<ConfigurationKeyValue>();
  ConfigurationKeyValue keyValue=new ConfigurationKeyValue();
  configurations.add(keyValue);
  keyValue.key="initLimit";
  keyValue.value="11";
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  commandParams.put(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS,new Gson().toJson(configurations));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertEquals("version2",config.getTag());
  assertEquals("11",config.getProperties().get("initLimit"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoerceValueOnCopy() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("zoo.server.csv","c6401,c6402,  c6403");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  List<Transfer> transfers=new ArrayList<Transfer>();
  Transfer transfer=new Transfer();
  transfer.operation=TransferOperation.COPY;
  transfer.coerceTo=TransferCoercionType.YAML_ARRAY;
  transfer.fromKey="zoo.server.csv";
  transfer.toKey="zoo.server.array";
  transfer.defaultValue="['foo','bar']";
  transfers.add(transfer);
  commandParams.put(ConfigureTask.PARAMETER_TRANSFERS,new Gson().toJson(transfers));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  executionCommand.setRoleParams(new HashMap<String,String>());
  executionCommand.getRoleParams().put(ServerAction.ACTION_USER_NAME,"username");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(3,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertFalse("version2".equals(config.getTag()));
  Map<String,String> map=config.getProperties();
  assertEquals("c6401,c6402,  c6403",map.get("zoo.server.csv"));
  assertEquals("['c6401','c6402','c6403']",map.get("zoo.server.array"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that DELETE "*" with edit preserving works correctly.
 * @throws Exception
 */
@Test public void testDeletePreserveChanges() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("tickTime","2000");
      put("foo","bar");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  List<Transfer> transfers=new ArrayList<>();
  Transfer transfer=new Transfer();
  transfer.operation=TransferOperation.DELETE;
  transfer.deleteKey="*";
  transfer.preserveEdits=true;
  transfers.add(transfer);
  commandParams.put(ConfigureTask.PARAMETER_TRANSFERS,new Gson().toJson(transfers));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  executionCommand.setRoleParams(new HashMap<String,String>());
  executionCommand.getRoleParams().put(ServerAction.ACTION_USER_NAME,"username");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(3,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertFalse("version2".equals(config.getTag()));
  Map<String,String> map=config.getProperties();
  assertEquals("bar",map.get("foo"));
  assertFalse(map.containsKey("tickTime"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigTransferCopy() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("initLimit","10");
      put("copyIt","10");
      put("moveIt","10");
      put("deleteIt","10");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  List<ConfigurationKeyValue> configurations=new ArrayList<>();
  ConfigurationKeyValue keyValue=new ConfigurationKeyValue();
  configurations.add(keyValue);
  keyValue.key="initLimit";
  keyValue.value="11";
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  commandParams.put(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS,new Gson().toJson(configurations));
  List<Transfer> transfers=new ArrayList<>();
  Transfer transfer=new Transfer();
  transfer.operation=TransferOperation.COPY;
  transfer.fromKey="copyIt";
  transfer.toKey="copyKey";
  transfers.add(transfer);
  transfer=new Transfer();
  transfer.operation=TransferOperation.COPY;
  transfer.fromKey="copiedFromMissingKeyWithDefault";
  transfer.toKey="copiedToMissingKeyWithDefault";
  transfer.defaultValue="defaultValue";
  transfers.add(transfer);
  transfer=new Transfer();
  transfer.operation=TransferOperation.MOVE;
  transfer.fromKey="moveIt";
  transfer.toKey="movedKey";
  transfers.add(transfer);
  transfer=new Transfer();
  transfer.operation=TransferOperation.MOVE;
  transfer.fromKey="movedFromKeyMissingWithDefault";
  transfer.toKey="movedToMissingWithDefault";
  transfer.defaultValue="defaultValue2";
  transfer.mask=true;
  transfers.add(transfer);
  transfer=new Transfer();
  transfer.operation=TransferOperation.DELETE;
  transfer.deleteKey="deleteIt";
  transfers.add(transfer);
  commandParams.put(ConfigureTask.PARAMETER_TRANSFERS,new Gson().toJson(transfers));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  executionCommand.setRoleParams(new HashMap<String,String>());
  executionCommand.getRoleParams().put(ServerAction.ACTION_USER_NAME,"username");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(3,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertFalse("version2".equals(config.getTag()));
  Map<String,String> map=config.getProperties();
  assertEquals("11",map.get("initLimit"));
  assertEquals("10",map.get("copyIt"));
  assertTrue(map.containsKey("copyKey"));
  assertEquals(map.get("copyIt"),map.get("copyKey"));
  assertFalse(map.containsKey("moveIt"));
  assertTrue(map.containsKey("movedKey"));
  assertFalse(map.containsKey("deletedKey"));
  assertTrue(map.containsKey("copiedToMissingKeyWithDefault"));
  assertEquals("defaultValue",map.get("copiedToMissingKeyWithDefault"));
  assertTrue(map.containsKey("movedToMissingWithDefault"));
  assertEquals("defaultValue2",map.get("movedToMissingWithDefault"));
  transfers.clear();
  transfer=new Transfer();
  transfer.operation=TransferOperation.DELETE;
  transfer.deleteKey="*";
  transfer.preserveEdits=true;
  transfer.keepKeys.add("copyKey");
  transfer.keepKeys.add("keyNotExisting");
  transfer.keepKeys.add(null);
  transfers.add(transfer);
  commandParams.put(ConfigureTask.PARAMETER_TRANSFERS,new Gson().toJson(transfers));
  report=action.execute(null);
  assertNotNull(report);
  assertEquals(4,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  map=config.getProperties();
  assertEquals(6,map.size());
  assertTrue(map.containsKey("initLimit"));
  assertTrue(map.containsKey("copyKey"));
  assertFalse(map.containsKey("keyNotExisting"));
  assertFalse(map.containsKey(null));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleKeyValuesPerTask() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setCurrentStackVersion(HDP_211_STACK);
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("fooKey","barValue");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  List<ConfigurationKeyValue> configurations=new ArrayList<ConfigurationKeyValue>();
  ConfigurationKeyValue fooKey2=new ConfigurationKeyValue();
  configurations.add(fooKey2);
  fooKey2.key="fooKey2";
  fooKey2.value="barValue2";
  ConfigurationKeyValue fooKey3=new ConfigurationKeyValue();
  configurations.add(fooKey3);
  fooKey3.key="fooKey3";
  fooKey3.value="barValue3";
  fooKey3.mask=true;
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  commandParams.put(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS,new Gson().toJson(configurations));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertEquals("barValue",config.getProperties().get("fooKey"));
  assertEquals("barValue2",config.getProperties().get("fooKey2"));
  assertEquals("barValue3",config.getProperties().get("fooKey3"));
  assertTrue(report.getStdOut().contains("******"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValueReplacement() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("key_to_replace","My New Cat");
      put("key_with_no_match","WxyAndZ");
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  List<Replace> replacements=new ArrayList<Replace>();
  Replace replace=new Replace();
  replace.key="key_to_replace";
  replace.find="New Cat";
  replace.replaceWith="Wet Dog";
  replacements.add(replace);
  replace=new Replace();
  replace.key="key_with_no_match";
  replace.find="abc";
  replace.replaceWith="def";
  replacements.add(replace);
  commandParams.put(ConfigureTask.PARAMETER_REPLACEMENTS,new Gson().toJson(replacements));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  executionCommand.setRoleParams(new HashMap<String,String>());
  executionCommand.getRoleParams().put(ServerAction.ACTION_USER_NAME,"username");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(3,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertNotNull(config);
  assertFalse("version2".equals(config.getTag()));
  assertEquals("My Wet Dog",config.getProperties().get("key_to_replace"));
  assertEquals("WxyAndZ",config.getProperties().get("key_with_no_match"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that replacing a {@code null} value works.
 * @throws Exception
 */
@Test public void testValueReplacementWithMissingConfigurations() throws Exception {
  makeUpgradeCluster();
  Cluster c=m_injector.getInstance(Clusters.class).getCluster("c1");
  assertEquals(1,c.getConfigsByType("zoo.cfg").size());
  c.setDesiredStackVersion(HDP_220_STACK);
  ConfigFactory cf=m_injector.getInstance(ConfigFactory.class);
  Config config=cf.createNew(c,"zoo.cfg",new HashMap<String,String>(){
{
      put("existing","This exists!");
      put("missing",null);
    }
  }
,new HashMap<String,Map<String,String>>());
  config.setTag("version2");
  config.persist();
  c.addConfig(config);
  c.addDesiredConfig("user",Collections.singleton(config));
  assertEquals(2,c.getConfigsByType("zoo.cfg").size());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("upgrade_direction","upgrade");
  commandParams.put("version",HDP_2_2_0_1);
  commandParams.put("clusterName","c1");
  commandParams.put(ConfigureTask.PARAMETER_CONFIG_TYPE,"zoo.cfg");
  List<Replace> replacements=new ArrayList<Replace>();
  Replace replace=new Replace();
  replace.key="missing";
  replace.find="foo";
  replace.replaceWith="bar";
  replacements.add(replace);
  commandParams.put(ConfigureTask.PARAMETER_REPLACEMENTS,new Gson().toJson(replacements));
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  executionCommand.setRoleParams(new HashMap<String,String>());
  executionCommand.getRoleParams().put(ServerAction.ACTION_USER_NAME,"username");
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  ConfigureAction action=m_injector.getInstance(ConfigureAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(3,c.getConfigsByType("zoo.cfg").size());
  config=c.getDesiredConfigByType("zoo.cfg");
  assertEquals(null,config.getProperties().get("missing"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.RangerConfigCalculationTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAction() throws Exception {
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put("clusterName","c1");
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  HostRoleCommand hrc=EasyMock.createMock(HostRoleCommand.class);
  expect(hrc.getRequestId()).andReturn(1L).anyTimes();
  expect(hrc.getStageId()).andReturn(2L).anyTimes();
  expect(hrc.getExecutionCommandWrapper()).andReturn(new ExecutionCommandWrapper(executionCommand)).anyTimes();
  replay(hrc);
  RangerConfigCalculation action=new RangerConfigCalculation();
  m_clusterField.set(action,m_clusters);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hrc);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  Cluster c=m_clusters.getCluster("c1");
  Config config=c.getDesiredConfigByType("ranger-admin-site");
  Map<String,String> map=config.getProperties();
  assertTrue(map.containsKey("ranger.jpa.jdbc.driver"));
  assertTrue(map.containsKey("ranger.jpa.jdbc.url"));
  assertTrue(map.containsKey("ranger.jpa.jdbc.dialect"));
  assertTrue(map.containsKey("ranger.jpa.audit.jdbc.driver"));
  assertTrue(map.containsKey("ranger.jpa.audit.jdbc.url"));
  assertTrue(map.containsKey("ranger.jpa.audit.jdbc.dialect"));
  assertEquals("com.mysql.jdbc.Driver",map.get("ranger.jpa.jdbc.driver"));
  assertEquals("jdbc:mysql://host1/ranger",map.get("ranger.jpa.jdbc.url"));
  assertEquals("org.eclipse.persistence.platform.database.MySQLPlatform",map.get("ranger.jpa.jdbc.dialect"));
  assertEquals("com.mysql.jdbc.Driver",map.get("ranger.jpa.audit.jdbc.driver"));
  assertEquals("jdbc:mysql://host1/ranger_audit",map.get("ranger.jpa.audit.jdbc.url"));
  assertEquals("org.eclipse.persistence.platform.database.MySQLPlatform",map.get("ranger.jpa.audit.jdbc.dialect"));
  config=c.getDesiredConfigByType("admin-properties");
  config.getProperties().put("DB_FLAVOR","oracle");
  report=action.execute(null);
  assertNotNull(report);
  config=c.getDesiredConfigByType("ranger-admin-site");
  map=config.getProperties();
  assertEquals("oracle.jdbc.OracleDriver",map.get("ranger.jpa.jdbc.driver"));
  assertEquals("jdbc:oracle:thin:@//host1",map.get("ranger.jpa.jdbc.url"));
  assertEquals("org.eclipse.persistence.platform.database.OraclePlatform",map.get("ranger.jpa.jdbc.dialect"));
  assertEquals("oracle.jdbc.OracleDriver",map.get("ranger.jpa.audit.jdbc.driver"));
  assertEquals("jdbc:oracle:thin:@//host1",map.get("ranger.jpa.audit.jdbc.url"));
  assertEquals("org.eclipse.persistence.platform.database.OraclePlatform",map.get("ranger.jpa.audit.jdbc.dialect"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.SparkShufflePropertyConfigTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAction() throws Exception {
  ExecutionCommand executionCommand=new ExecutionCommand();
  Map<String,String> commandParams=new HashMap<>();
  HostRoleCommand hrc=EasyMock.createMock(HostRoleCommand.class);
  SparkShufflePropertyConfig action=new SparkShufflePropertyConfig();
  commandParams.put("clusterName","c1");
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName("c1");
  expect(hrc.getRequestId()).andReturn(1L).anyTimes();
  expect(hrc.getStageId()).andReturn(2L).anyTimes();
  expect(hrc.getExecutionCommandWrapper()).andReturn(new ExecutionCommandWrapper(executionCommand)).anyTimes();
  replay(cluster,hrc);
  clusterField.set(action,m_clusters);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hrc);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  Cluster c=m_clusters.getCluster("c1");
  Config config=c.getDesiredConfigByType("yarn-site");
  Map<String,String> map=config.getProperties();
  assertTrue(map.containsKey("yarn.nodemanager.aux-services"));
  assertTrue(map.containsKey("yarn.nodemanager.aux-services.spark_shuffle.class"));
  assertEquals("some_service,spark_shuffle",map.get("yarn.nodemanager.aux-services"));
  assertEquals("org.apache.spark.network.yarn.YarnShuffleService",map.get("yarn.nodemanager.aux-services.spark_shuffle.class"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.serveraction.upgrades.UpgradeActionTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that finalization can occur when the cluster state is{@link RepositoryVersionState#UPGRADING} if all of the hosts and components
 * are reporting correct versions and states.
 * @throws Exception
 */
@Test public void testFinalizeUpgradeWithClusterStateInconsistencies() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_2_0_1;
  makeCrossStackUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  Cluster cluster=clusters.getCluster(clusterName);
  Service service=installService(cluster,"HDFS");
  addServiceComponent(cluster,service,"NAMENODE");
  addServiceComponent(cluster,service,"DATANODE");
  createNewServiceComponentHost(cluster,"HDFS","NAMENODE","h1");
  createNewServiceComponentHost(cluster,"HDFS","DATANODE","h1");
  createConfigs(cluster);
  cluster.setCurrentStackVersion(sourceStack);
  cluster.setDesiredStackVersion(targetStack);
  cluster.getServiceComponentHosts("HDFS","NAMENODE").get(0).setVersion(targetRepo);
  cluster.getServiceComponentHosts("HDFS","DATANODE").get(0).setVersion(targetRepo);
  ClusterVersionEntity upgradingClusterVersion=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,HDP_22_STACK,targetRepo);
  upgradingClusterVersion.setState(RepositoryVersionState.UPGRADING);
  upgradingClusterVersion=clusterVersionDAO.merge(upgradingClusterVersion);
  upgradingClusterVersion=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,HDP_22_STACK,targetRepo);
  List<HostVersionEntity> hostVersions=hostVersionDAO.findByClusterStackAndVersion(clusterName,HDP_22_STACK,targetRepo);
  assertEquals(RepositoryVersionState.UPGRADING,upgradingClusterVersion.getState());
  assertTrue(hostVersions.size() > 0);
  for (  HostVersionEntity hostVersion : hostVersions) {
    assertEquals(RepositoryVersionState.UPGRADED,hostVersion.getState());
  }
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"upgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,targetRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  StackId currentStackId=cluster.getCurrentStackVersion();
  StackId desiredStackId=cluster.getDesiredStackVersion();
  assertEquals(desiredStackId,currentStackId);
  assertEquals(targetStack,currentStackId);
  assertEquals(targetStack,desiredStackId);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests some of the action items are completed when finalizing downgrade
 * across stacks (HDP 2.2 -> HDP 2.3).
 * @throws Exception
 */
@Test public void testFinalizeDowngradeAcrossStacks() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_2_0_1;
  makeCrossStackUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  Cluster cluster=clusters.getCluster(clusterName);
  Service service=installService(cluster,"HDFS");
  addServiceComponent(cluster,service,"NAMENODE");
  addServiceComponent(cluster,service,"DATANODE");
  createNewServiceComponentHost(cluster,"HDFS","NAMENODE","h1");
  createNewServiceComponentHost(cluster,"HDFS","DATANODE","h1");
  createConfigs(cluster);
  cluster.setCurrentStackVersion(sourceStack);
  cluster.setDesiredStackVersion(targetStack);
  createConfigs(cluster);
  cluster=clusters.getCluster(clusterName);
  Collection<Config> configs=cluster.getAllConfigs();
  assertEquals(8,configs.size());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"downgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,sourceRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  HostVersionDAO dao=m_injector.getInstance(HostVersionDAO.class);
  List<HostVersionEntity> hosts=dao.findByClusterStackAndVersion(clusterName,targetStack,targetRepo);
  assertFalse(hosts.isEmpty());
  for (  HostVersionEntity hve : hosts) {
    assertFalse(hve.getState() == RepositoryVersionState.INSTALLED);
  }
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  StackId currentStackId=cluster.getCurrentStackVersion();
  StackId desiredStackId=cluster.getDesiredStackVersion();
  assertEquals(desiredStackId,currentStackId);
  assertEquals(sourceStack,currentStackId);
  assertEquals(sourceStack,desiredStackId);
  cluster=clusters.getCluster(clusterName);
  configs=cluster.getAllConfigs();
  assertEquals(4,configs.size());
  hosts=dao.findByClusterStackAndVersion(clusterName,targetStack,targetRepo);
  assertFalse(hosts.isEmpty());
  for (  HostVersionEntity hve : hosts) {
    assertTrue(hve.getState() == RepositoryVersionState.INSTALLED);
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeDowngrade() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_21_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_1_1_1;
  makeDowngradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"downgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,sourceRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  for (  HostVersionEntity entity : hostVersionDAO.findByClusterAndHost(clusterName,"h1")) {
    if (entity.getRepositoryVersion().getVersion().equals(sourceRepo)) {
      assertEquals(RepositoryVersionState.CURRENT,entity.getState());
    }
 else     if (entity.getRepositoryVersion().getVersion().equals(targetRepo)) {
      assertEquals(RepositoryVersionState.INSTALLED,entity.getState());
    }
  }
  for (  ClusterVersionEntity entity : clusterVersionDAO.findByCluster(clusterName)) {
    if (entity.getRepositoryVersion().getVersion().equals(sourceRepo)) {
      assertEquals(RepositoryVersionState.CURRENT,entity.getState());
    }
 else     if (entity.getRepositoryVersion().getVersion().equals(targetRepo)) {
      assertEquals(RepositoryVersionState.INSTALLED,entity.getState());
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeUpgradeAcrossStacks() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_2_0_1;
  makeCrossStackUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setCurrentStackVersion(sourceStack);
  cluster.setDesiredStackVersion(targetStack);
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"upgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,targetRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  StackId currentStackId=cluster.getCurrentStackVersion();
  StackId desiredStackId=cluster.getDesiredStackVersion();
  assertEquals(desiredStackId,currentStackId);
  assertEquals(targetStack,currentStackId);
  assertEquals(targetStack,desiredStackId);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * During an Express Upgrade that crosses a stack version, Ambari calls UpdateDesiredStackAction
 * in order to change the stack and apply configs.
 * The configs that are applied must be saved with the username that is passed in the role params.
 */
@Test public void testExpressUpgradeUpdateDesiredStackAction() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_2_0_1;
  String upgradePackName="upgrade_nonrolling_new_stack";
  AmbariMetaInfo metaInfo=m_injector.getInstance(AmbariMetaInfo.class);
  Map<String,UpgradePack> packs=metaInfo.getUpgradePacks(sourceStack.getStackName(),sourceStack.getStackVersion());
  Assert.assertTrue(packs.containsKey(upgradePackName));
  makeCrossStackUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  RepositoryVersionEntity targetRve=repoVersionDAO.findByStackNameAndVersion("HDP",targetRepo);
  Assert.assertNotNull(targetRve);
  Cluster cluster=clusters.getCluster(clusterName);
  Service zk=installService(cluster,"ZOOKEEPER");
  addServiceComponent(cluster,zk,"ZOOKEEPER_SERVER");
  addServiceComponent(cluster,zk,"ZOOKEEPER_CLIENT");
  createNewServiceComponentHost(cluster,"ZOOKEEPER","ZOOKEEPER_SERVER","h1");
  createNewServiceComponentHost(cluster,"ZOOKEEPER","ZOOKEEPER_CLIENT","h1");
  Service hdfs=installService(cluster,"HDFS");
  addServiceComponent(cluster,hdfs,"NAMENODE");
  addServiceComponent(cluster,hdfs,"DATANODE");
  createNewServiceComponentHost(cluster,"HDFS","NAMENODE","h1");
  createNewServiceComponentHost(cluster,"HDFS","DATANODE","h1");
  createConfigs(cluster);
  Collection<Config> configs=cluster.getAllConfigs();
  Assert.assertFalse(configs.isEmpty());
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_ORIGINAL_STACK,sourceStack.getStackId());
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_TARGET_STACK,targetStack.getStackId());
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_DIRECTION,Direction.UPGRADE.toString());
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_VERSION,targetRepo);
  commandParams.put(UpdateDesiredStackAction.COMMAND_PARAM_UPGRADE_PACK,upgradePackName);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  Map<String,String> roleParams=new HashMap<>();
  String userName="admin";
  roleParams.put(ServerAction.ACTION_USER_NAME,userName);
  executionCommand.setRoleParams(roleParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  UpdateDesiredStackAction action=m_injector.getInstance(UpdateDesiredStackAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  List<ServiceConfigVersionResponse> configVersionsBefore=cluster.getServiceConfigVersions();
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  List<ServiceConfigVersionResponse> configVersionsAfter=cluster.getServiceConfigVersions();
  Assert.assertFalse(configVersionsAfter.isEmpty());
  assertTrue(configVersionsAfter.size() - configVersionsBefore.size() >= 1);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a case in which a customer performs an upgrade from HDP 2.1 to 2.2 (e.g., 2.2.0.0), but skips the step to
 * finalize, which calls "Save DB State". Therefore, the cluster's current stack is still on HDP 2.1.
 * They can still modify the database manually to mark HDP 2.2 as CURRENT in the cluster_version and then begin
 * another upgrade to 2.2.0.2 and then downgrade.
 * In the downgrade, the original stack is still 2.1 but the stack for the version marked as CURRENT is 2.2; this
 * mismatch means that the downgrade should not delete configs and will report a warning.
 * @throws Exception
 */
@Test public void testFinalizeDowngradeWhenDidNotFinalizePreviousUpgrade() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId midStack=HDP_22_STACK;
  StackId targetStack=HDP_22_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String midRepo=HDP_2_2_0_1;
  String targetRepo=HDP_2_2_0_2;
  makeTwoUpgradesWhereLastDidNotComplete(sourceStack,sourceRepo,midStack,midRepo,targetStack,targetRepo);
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"downgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,midRepo);
  commandParams.put(FinalizeUpgradeAction.ORIGINAL_STACK_KEY,sourceStack.getStackId());
  commandParams.put(FinalizeUpgradeAction.TARGET_STACK_KEY,targetStack.getStackId());
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.FAILED.name(),report.getStatus());
  assertTrue(report.getStdErr().contains(FinalizeUpgradeAction.PREVIOUS_UPGRADE_NOT_COMPLETED_MSG));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalizeUpgrade() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_21_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_1_1_1;
  makeUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  AmbariMetaInfo metaInfo=m_injector.getInstance(AmbariMetaInfo.class);
  AmbariCustomCommandExecutionHelper helper=m_injector.getInstance(AmbariCustomCommandExecutionHelper.class);
  Host host=clusters.getHost("h1");
  Cluster cluster=clusters.getCluster(clusterName);
  RepositoryInfo repo=metaInfo.getRepository(sourceStack.getStackName(),sourceStack.getStackVersion(),"redhat6",sourceStack.getStackId());
  assertEquals(HDP_211_CENTOS6_REPO_URL,repo.getBaseUrl());
  verifyBaseRepoURL(helper,cluster,host,HDP_211_CENTOS6_REPO_URL);
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"upgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,targetRepo);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
  verifyBaseRepoURL(helper,cluster,host,"http://foo1");
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that finalize still works when there are hosts which are already{@link RepositoryVersionState#CURRENT}.
 * @throws Exception
 */
@Test public void testFinalizeWithHostsAlreadyCurrent() throws Exception {
  StackId sourceStack=HDP_21_STACK;
  StackId targetStack=HDP_21_STACK;
  String sourceRepo=HDP_2_1_1_0;
  String targetRepo=HDP_2_1_1_1;
  makeUpgradeCluster(sourceStack,sourceRepo,targetStack,targetRepo);
  List<HostVersionEntity> hostVersions=hostVersionDAO.findAll();
  for (  HostVersionEntity hostVersion : hostVersions) {
    if (hostVersion.getState() == RepositoryVersionState.CURRENT) {
      hostVersion.setState(RepositoryVersionState.INSTALLED);
    }
 else {
      hostVersion.setState(RepositoryVersionState.CURRENT);
    }
    hostVersionDAO.merge(hostVersion);
  }
  AmbariMetaInfo metaInfo=m_injector.getInstance(AmbariMetaInfo.class);
  AmbariCustomCommandExecutionHelper helper=m_injector.getInstance(AmbariCustomCommandExecutionHelper.class);
  Host host=clusters.getHost("h1");
  Cluster cluster=clusters.getCluster(clusterName);
  RepositoryInfo repo=metaInfo.getRepository(sourceStack.getStackName(),sourceStack.getStackVersion(),"redhat6",sourceStack.getStackId());
  assertEquals(HDP_211_CENTOS6_REPO_URL,repo.getBaseUrl());
  verifyBaseRepoURL(helper,cluster,host,HDP_211_CENTOS6_REPO_URL);
  Map<String,String> commandParams=new HashMap<String,String>();
  commandParams.put(FinalizeUpgradeAction.UPGRADE_DIRECTION_KEY,"upgrade");
  commandParams.put(FinalizeUpgradeAction.VERSION_KEY,targetRepo);
  ExecutionCommand executionCommand=new ExecutionCommand();
  executionCommand.setCommandParams(commandParams);
  executionCommand.setClusterName(clusterName);
  HostRoleCommand hostRoleCommand=hostRoleCommandFactory.create(null,null,null,null);
  hostRoleCommand.setExecutionCommandWrapper(new ExecutionCommandWrapper(executionCommand));
  FinalizeUpgradeAction action=m_injector.getInstance(FinalizeUpgradeAction.class);
  action.setExecutionCommand(executionCommand);
  action.setHostRoleCommand(hostRoleCommand);
  CommandReport report=action.execute(null);
  assertNotNull(report);
  assertEquals(HostRoleStatus.COMPLETED.name(),report.getStatus());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.QuickLinksConfigurationModuleTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveInherit() throws Exception {
  QuickLinks[] results=resolveQuickLinks("parent_quicklinks.json","child_quicklinks_to_inherit.json");
  QuickLinks parentQuickLinks=results[0];
  QuickLinks childQuickLinks=results[1];
  QuickLinksConfiguration childQuickLinksConfig=childQuickLinks.getQuickLinksConfiguration();
  assertNotNull(childQuickLinksConfig);
  List<Link> links=childQuickLinksConfig.getLinks();
  assertNotNull(links);
  assertEquals(4,links.size());
  assertEquals(4,parentQuickLinks.getQuickLinksConfiguration().getLinks().size());
  Protocol protocol=childQuickLinksConfig.getProtocol();
  assertNotNull(protocol);
  assertEquals("https",protocol.getType());
  assertEquals(1,protocol.getChecks().size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveMerge() throws Exception {
  QuickLinks[] results=resolveQuickLinks("parent_quicklinks.json","child_quicklinks_to_merge.json");
  QuickLinks parentQuickLinks=results[0];
  QuickLinks childQuickLinks=results[1];
  QuickLinksConfiguration childQuickLinksConfig=childQuickLinks.getQuickLinksConfiguration();
  assertNotNull(childQuickLinksConfig);
  List<Link> links=childQuickLinksConfig.getLinks();
  assertNotNull(links);
  assertEquals(7,links.size());
  assertEquals(4,parentQuickLinks.getQuickLinksConfiguration().getLinks().size());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolveOverride() throws Exception {
  QuickLinks[] results=resolveQuickLinks("parent_quicklinks.json","child_quicklinks_to_override.json");
  QuickLinks parentQuickLinks=results[0];
  QuickLinks childQuickLinks=results[1];
  QuickLinksConfiguration childQuickLinksConfig=childQuickLinks.getQuickLinksConfiguration();
  assertNotNull(childQuickLinksConfig);
  List<Link> links=childQuickLinksConfig.getLinks();
  assertNotNull(links);
  assertEquals(7,links.size());
  assertEquals(4,parentQuickLinks.getQuickLinksConfiguration().getLinks().size());
  boolean hasLink=false;
  for (  Link link : links) {
    String name=link.getName();
    if ("thread_stacks".equals(name)) {
      hasLink=true;
      Port port=link.getPort();
      assertEquals("mapred-site",port.getSite());
    }
  }
  assertTrue(hasLink);
  Protocol protocol=childQuickLinksConfig.getProtocol();
  assertNotNull(protocol);
  assertEquals("http",protocol.getType());
  assertEquals(3,protocol.getChecks().size());
  List<Check> checks=protocol.getChecks();
  for (  Check check : checks) {
    assertEquals("mapred-site",check.getSite());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.StackManagerCommonServicesTest </h4><pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStack(){
  StackInfo stack=stackManager.getStack("HDP","0.1");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("0.1",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(3,services.size());
  Map<String,ServiceInfo> serviceMap=new HashMap<String,ServiceInfo>();
  for (  ServiceInfo service : services) {
    serviceMap.put(service.getName(),service);
  }
  ServiceInfo hdfsService=serviceMap.get("HDFS");
  assertNotNull(hdfsService);
  List<ComponentInfo> components=hdfsService.getComponents();
  assertEquals(6,components.size());
  List<PropertyInfo> properties=hdfsService.getProperties();
  assertEquals(62,properties.size());
  boolean hdfsPropFound=false;
  boolean hbasePropFound=false;
  for (  PropertyInfo p : properties) {
    if (p.getName().equals("hbase.regionserver.msginterval")) {
      assertEquals("hbase-site.xml",p.getFilename());
      hbasePropFound=true;
    }
 else     if (p.getName().equals("dfs.name.dir")) {
      assertEquals("hdfs-site.xml",p.getFilename());
      hdfsPropFound=true;
    }
  }
  assertTrue(hbasePropFound);
  assertTrue(hdfsPropFound);
  ServiceInfo mrService=serviceMap.get("MAPREDUCE");
  assertNotNull(mrService);
  components=mrService.getComponents();
  assertEquals(3,components.size());
  ServiceInfo pigService=serviceMap.get("PIG");
  assertNotNull(pigService);
  assertEquals("PIG",pigService.getName());
  assertEquals("1.0",pigService.getVersion());
  assertEquals("This is comment for PIG service",pigService.getComment());
  components=pigService.getComponents();
  assertEquals(1,components.size());
  CommandScriptDefinition commandScript=pigService.getCommandScript();
  assertEquals("scripts/service_check.py",commandScript.getScript());
  assertEquals(CommandScriptDefinition.Type.PYTHON,commandScript.getScriptType());
  assertEquals(300,commandScript.getTimeout());
  List<String> configDependencies=pigService.getConfigDependencies();
  assertEquals(1,configDependencies.size());
  assertEquals("global",configDependencies.get(0));
  assertEquals("global",pigService.getConfigDependenciesWithComponents().get(0));
  ComponentInfo client=pigService.getClientComponent();
  assertNotNull(client);
  assertEquals("PIG",client.getName());
  assertEquals("0+",client.getCardinality());
  assertEquals("CLIENT",client.getCategory());
  assertEquals("configuration",pigService.getConfigDir());
  assertEquals("2.0",pigService.getSchemaVersion());
  Map<String,ServiceOsSpecific> osInfoMap=pigService.getOsSpecifics();
  assertEquals(1,osInfoMap.size());
  ServiceOsSpecific osSpecific=osInfoMap.get("centos6");
  assertNotNull(osSpecific);
  assertEquals("centos6",osSpecific.getOsFamily());
  assertNull(osSpecific.getRepo());
  List<ServiceOsSpecific.Package> packages=osSpecific.getPackages();
  assertEquals(2,packages.size());
  ServiceOsSpecific.Package pkg=packages.get(0);
  assertEquals("pig",pkg.getName());
  assertFalse(pkg.getSkipUpgrade());
  ServiceOsSpecific.Package lzoPackage=packages.get(1);
  assertEquals("lzo",lzoPackage.getName());
  assertTrue(lzoPackage.getSkipUpgrade());
  assertEquals(pigService.getParent(),"common-services/PIG/1.0");
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServicePackageFolder(){
  StackInfo stack=stackManager.getStack("HDP","0.1");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("0.1",stack.getVersion());
  ServiceInfo hdfsService1=stack.getService("HDFS");
  assertNotNull(hdfsService1);
  stack=stackManager.getStack("HDP","0.2");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("0.2",stack.getVersion());
  ServiceInfo hdfsService2=stack.getService("HDFS");
  assertNotNull(hdfsService2);
  String packageDir1=StringUtils.join(new String[]{"common-services","HDFS","1.0","package"},File.separator);
  String packageDir2=StringUtils.join(new String[]{"stacks_with_common_services","HDP","0.2","services","HDFS","package"},File.separator);
  assertEquals(packageDir1,hdfsService1.getServicePackageFolder());
  assertEquals(packageDir2,hdfsService2.getServicePackageFolder());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.StackManagerMiscTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test ensures the service status check is added into the action metadata when
 * the stack has no parent and is the only stack in the stack family
 */
@Test public void testGetServiceInfoFromSingleStack() throws Exception {
  MetainfoDAO metaInfoDao=createNiceMock(MetainfoDAO.class);
  StackDAO stackDao=createNiceMock(StackDAO.class);
  ActionMetadata actionMetadata=createNiceMock(ActionMetadata.class);
  OsFamily osFamily=createNiceMock(OsFamily.class);
  StackEntity stackEntity=createNiceMock(StackEntity.class);
  actionMetadata.addServiceCheckAction("HDFS");
  expect(stackDao.find(EasyMock.anyObject(String.class),EasyMock.anyObject(String.class))).andReturn(stackEntity).atLeastOnce();
  replay(metaInfoDao,stackDao,actionMetadata,osFamily);
  String singleStack=ClassLoader.getSystemClassLoader().getResource("single_stack").getPath();
  StackManager stackManager=new StackManager(new File(singleStack.replace(StackManager.PATH_DELIMITER,File.separator)),null,osFamily,metaInfoDao,actionMetadata,stackDao);
  Collection<StackInfo> stacks=stackManager.getStacks();
  assertEquals(1,stacks.size());
  assertNotNull(stacks.iterator().next().getService("HDFS"));
  verify(metaInfoDao,stackDao,actionMetadata,osFamily);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.StackManagerTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackServiceExtension(){
  StackInfo stack=stackManager.getStack("OTHER","1.0");
  assertNotNull(stack);
  assertEquals("OTHER",stack.getName());
  assertEquals("1.0",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(3,services.size());
  assertEquals(6,stack.getService("HDFS").getComponents().size());
  ServiceInfo sqoopService=stack.getService("SQOOP2");
  assertNotNull(sqoopService);
  assertEquals("Extended SQOOP",sqoopService.getComment());
  assertEquals("Extended Version",sqoopService.getVersion());
  assertNull(sqoopService.getServicePackageFolder());
  Collection<ComponentInfo> components=sqoopService.getComponents();
  assertEquals(1,components.size());
  ComponentInfo component=components.iterator().next();
  assertEquals("SQOOP",component.getName());
  StackInfo baseStack=stackManager.getStack("HDP","2.1.1");
  ServiceInfo baseSqoopService=baseStack.getService("SQOOP");
  assertEquals(baseSqoopService.isDeleted(),sqoopService.isDeleted());
  assertEquals(baseSqoopService.getAlertsFile(),sqoopService.getAlertsFile());
  assertEquals(baseSqoopService.getClientComponent(),sqoopService.getClientComponent());
  assertEquals(baseSqoopService.getCommandScript(),sqoopService.getCommandScript());
  assertEquals(baseSqoopService.getConfigDependencies(),sqoopService.getConfigDependencies());
  assertEquals(baseSqoopService.getConfigDir(),sqoopService.getConfigDir());
  assertEquals(baseSqoopService.getConfigDependenciesWithComponents(),sqoopService.getConfigDependenciesWithComponents());
  assertEquals(baseSqoopService.getConfigTypeAttributes(),sqoopService.getConfigTypeAttributes());
  assertEquals(baseSqoopService.getCustomCommands(),sqoopService.getCustomCommands());
  assertEquals(baseSqoopService.getExcludedConfigTypes(),sqoopService.getExcludedConfigTypes());
  assertEquals(baseSqoopService.getProperties(),sqoopService.getProperties());
  assertEquals(baseSqoopService.getMetrics(),sqoopService.getMetrics());
  assertNull(baseSqoopService.getMetricsFile());
  assertNull(sqoopService.getMetricsFile());
  assertEquals(baseSqoopService.getOsSpecifics(),sqoopService.getOsSpecifics());
  assertEquals(baseSqoopService.getRequiredServices(),sqoopService.getRequiredServices());
  assertEquals(baseSqoopService.getSchemaVersion(),sqoopService.getSchemaVersion());
  ServiceInfo stormService=stack.getService("STORM");
  assertNotNull(stormService);
  assertEquals("STORM",stormService.getName());
  ServiceInfo baseStormService=baseStack.getService("STORM");
  assertEquals("Apache Hadoop Stream processing framework (Extended)",stormService.getComment());
  assertEquals("New version",stormService.getVersion());
  String packageDir=StringUtils.join(new String[]{"stacks","OTHER","1.0","services","STORM","package"},File.separator);
  assertEquals(packageDir,stormService.getServicePackageFolder());
  List<ComponentInfo> stormServiceComponents=stormService.getComponents();
  List<ComponentInfo> baseStormServiceComponents=baseStormService.getComponents();
  assertEquals(new HashSet<ComponentInfo>(stormServiceComponents),new HashSet<ComponentInfo>(baseStormServiceComponents));
  assertEquals(baseStormService.isDeleted(),stormService.isDeleted());
  assertEquals(baseStormService.getAlertsFile(),stormService.getAlertsFile());
  assertEquals(baseStormService.getClientComponent(),stormService.getClientComponent());
  assertEquals(baseStormService.getCommandScript(),stormService.getCommandScript());
  assertEquals(baseStormService.getConfigDependencies(),stormService.getConfigDependencies());
  assertEquals(baseStormService.getConfigDir(),stormService.getConfigDir());
  assertEquals(baseStormService.getConfigDependenciesWithComponents(),stormService.getConfigDependenciesWithComponents());
  assertEquals(baseStormService.getConfigTypeAttributes(),stormService.getConfigTypeAttributes());
  assertEquals(baseStormService.getCustomCommands(),stormService.getCustomCommands());
  assertEquals(baseStormService.getExcludedConfigTypes(),stormService.getExcludedConfigTypes());
  assertEquals(baseStormService.getProperties(),stormService.getProperties());
  assertEquals(baseStormService.getMetrics(),stormService.getMetrics());
  assertNotNull(baseStormService.getMetricsFile());
  assertNotNull(stormService.getMetricsFile());
  assertFalse(baseStormService.getMetricsFile().equals(stormService.getMetricsFile()));
  assertEquals(baseStormService.getOsSpecifics(),stormService.getOsSpecifics());
  assertEquals(baseStormService.getRequiredServices(),stormService.getRequiredServices());
  assertEquals(baseStormService.getSchemaVersion(),stormService.getSchemaVersion());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testInheritanceAfterComponentDeletion(){
  StackInfo stack=stackManager.getStack("HDP","2.0.6");
  ServiceInfo yarnService=stack.getService("HBASE");
  assertNull(yarnService.getComponentByName("HBASE_CLIENT"));
  stack=stackManager.getStack("HDP","2.0.6.1");
  yarnService=stack.getService("HBASE");
  assertNull(yarnService.getComponentByName("HBASE_CLIENT"));
  stack=stackManager.getStack("HDP","2.0.8");
  yarnService=stack.getService("HBASE");
  assertNotNull(yarnService.getComponentByName("HBASE_CLIENT"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHDFSServiceContainsMetricsFile() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.0.6");
  ServiceInfo hdfsService=stack.getService("HDFS");
  assertEquals("HDFS",hdfsService.getName());
  assertNotNull(hdfsService.getMetricsFile());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testComponentDeletion(){
  StackInfo stack=stackManager.getStack("HDP","2.0.6");
  ServiceInfo yarnService=stack.getService("YARN");
  assertNull(yarnService.getComponentByName("YARN_CLIENT"));
  stack=stackManager.getStack("HDP","2.0.6.1");
  yarnService=stack.getService("YARN");
  assertNull(yarnService.getComponentByName("YARN_CLIENT"));
  stack=stackManager.getStack("HDP","2.0.7");
  yarnService=stack.getService("YARN");
  assertNotNull(yarnService.getComponentByName("YARN_CLIENT"));
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMonitoringServicePropertyInheritance() throws Exception {
  StackInfo stack=stackManager.getStack("HDP","2.0.8");
  Collection<ServiceInfo> allServices=stack.getServices();
  assertEquals(13,allServices.size());
  boolean monitoringServiceFound=false;
  for (  ServiceInfo serviceInfo : allServices) {
    if (serviceInfo.getName().equals("FAKENAGIOS")) {
      monitoringServiceFound=true;
      assertTrue(serviceInfo.isMonitoringService());
    }
 else {
      assertNull(serviceInfo.isMonitoringService());
    }
  }
  assertTrue(monitoringServiceFound);
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStack(){
  StackInfo stack=stackManager.getStack("HDP","0.1");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("0.1",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(3,services.size());
  Map<String,ServiceInfo> serviceMap=new HashMap<String,ServiceInfo>();
  for (  ServiceInfo service : services) {
    serviceMap.put(service.getName(),service);
  }
  ServiceInfo hdfsService=serviceMap.get("HDFS");
  assertNotNull(hdfsService);
  List<ComponentInfo> components=hdfsService.getComponents();
  assertEquals(6,components.size());
  List<PropertyInfo> properties=hdfsService.getProperties();
  assertEquals(62,properties.size());
  boolean hdfsPropFound=false;
  boolean hbasePropFound=false;
  for (  PropertyInfo p : properties) {
    if (p.getName().equals("hbase.regionserver.msginterval")) {
      assertEquals("hbase-site.xml",p.getFilename());
      hbasePropFound=true;
    }
 else     if (p.getName().equals("dfs.name.dir")) {
      assertEquals("hdfs-site.xml",p.getFilename());
      hdfsPropFound=true;
    }
  }
  assertTrue(hbasePropFound);
  assertTrue(hdfsPropFound);
  ServiceInfo mrService=serviceMap.get("MAPREDUCE");
  assertNotNull(mrService);
  components=mrService.getComponents();
  assertEquals(3,components.size());
  ServiceInfo pigService=serviceMap.get("PIG");
  assertNotNull(pigService);
  assertEquals("PIG",pigService.getName());
  assertEquals("1.0",pigService.getVersion());
  assertEquals("This is comment for PIG service",pigService.getComment());
  components=pigService.getComponents();
  assertEquals(1,components.size());
  CommandScriptDefinition commandScript=pigService.getCommandScript();
  assertEquals("scripts/service_check.py",commandScript.getScript());
  assertEquals(CommandScriptDefinition.Type.PYTHON,commandScript.getScriptType());
  assertEquals(300,commandScript.getTimeout());
  List<String> configDependencies=pigService.getConfigDependencies();
  assertEquals(1,configDependencies.size());
  assertEquals("global",configDependencies.get(0));
  assertEquals("global",pigService.getConfigDependenciesWithComponents().get(0));
  ComponentInfo client=pigService.getClientComponent();
  assertNotNull(client);
  assertEquals("PIG",client.getName());
  assertEquals("0+",client.getCardinality());
  assertEquals("CLIENT",client.getCategory());
  assertEquals("configuration",pigService.getConfigDir());
  assertEquals("2.0",pigService.getSchemaVersion());
  Map<String,ServiceOsSpecific> osInfoMap=pigService.getOsSpecifics();
  assertEquals(1,osInfoMap.size());
  ServiceOsSpecific osSpecific=osInfoMap.get("centos6");
  assertNotNull(osSpecific);
  assertEquals("centos6",osSpecific.getOsFamily());
  assertNull(osSpecific.getRepo());
  List<ServiceOsSpecific.Package> packages=osSpecific.getPackages();
  assertEquals(1,packages.size());
  ServiceOsSpecific.Package pkg=packages.get(0);
  assertEquals("pig",pkg.getName());
  assertNull(pigService.getParent());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetStackServiceInheritance(){
  StackInfo baseStack=stackManager.getStack("OTHER","1.0");
  StackInfo stack=stackManager.getStack("OTHER","2.0");
  assertEquals(4,stack.getServices().size());
  ServiceInfo service=stack.getService("SQOOP2");
  ServiceInfo baseSqoopService=baseStack.getService("SQOOP2");
  assertEquals("SQOOP2",service.getName());
  assertEquals("Inherited from parent",service.getComment());
  assertEquals("Extended from parent version",service.getVersion());
  assertNull(service.getServicePackageFolder());
  List<ComponentInfo> serviceComponents=service.getComponents();
  List<ComponentInfo> baseStormServiceCompoents=baseSqoopService.getComponents();
  assertEquals(serviceComponents,baseStormServiceCompoents);
  assertEquals(baseSqoopService.isDeleted(),service.isDeleted());
  assertEquals(baseSqoopService.getAlertsFile(),service.getAlertsFile());
  assertEquals(baseSqoopService.getClientComponent(),service.getClientComponent());
  assertEquals(baseSqoopService.getCommandScript(),service.getCommandScript());
  assertEquals(baseSqoopService.getConfigDependencies(),service.getConfigDependencies());
  assertEquals(baseSqoopService.getConfigDir(),service.getConfigDir());
  assertEquals(baseSqoopService.getConfigDependenciesWithComponents(),service.getConfigDependenciesWithComponents());
  assertEquals(baseSqoopService.getConfigTypeAttributes(),service.getConfigTypeAttributes());
  assertEquals(baseSqoopService.getCustomCommands(),service.getCustomCommands());
  assertEquals(baseSqoopService.getExcludedConfigTypes(),service.getExcludedConfigTypes());
  assertEquals(baseSqoopService.getProperties(),service.getProperties());
  assertEquals(baseSqoopService.getMetrics(),service.getMetrics());
  assertNull(baseSqoopService.getMetricsFile());
  assertNull(service.getMetricsFile());
  assertEquals(baseSqoopService.getOsSpecifics(),service.getOsSpecifics());
  assertEquals(baseSqoopService.getRequiredServices(),service.getRequiredServices());
  assertEquals(baseSqoopService.getSchemaVersion(),service.getSchemaVersion());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackVersionInheritance(){
  StackInfo stack=stackManager.getStack("HDP","2.1.1");
  assertNotNull(stack);
  assertEquals("HDP",stack.getName());
  assertEquals("2.1.1",stack.getVersion());
  Collection<ServiceInfo> services=stack.getServices();
  assertEquals(16,services.size());
  HashSet<String> expectedServices=new HashSet<String>();
  expectedServices.add("GANGLIA");
  expectedServices.add("HBASE");
  expectedServices.add("HCATALOG");
  expectedServices.add("HDFS");
  expectedServices.add("HIVE");
  expectedServices.add("MAPREDUCE2");
  expectedServices.add("OOZIE");
  expectedServices.add("PIG");
  expectedServices.add("SQOOP");
  expectedServices.add("YARN");
  expectedServices.add("ZOOKEEPER");
  expectedServices.add("STORM");
  expectedServices.add("FLUME");
  expectedServices.add("FAKENAGIOS");
  expectedServices.add("TEZ");
  expectedServices.add("AMBARI_METRICS");
  ServiceInfo pigService=null;
  for (  ServiceInfo service : services) {
    if (service.getName().equals("PIG")) {
      pigService=service;
    }
    assertTrue(expectedServices.remove(service.getName()));
  }
  assertTrue(expectedServices.isEmpty());
  assertNotNull(pigService);
  assertEquals("0.12.1.2.1.1",pigService.getVersion());
  assertEquals("Scripting platform for analyzing large datasets (Extended)",pigService.getComment());
  ServiceInfo basePigService=stackManager.getStack("HDP","2.0.5").getService("PIG");
  assertEquals("0.11.1.2.0.5.0",basePigService.getVersion());
  assertEquals(1,basePigService.getComponents().size());
  assertEquals(2,pigService.getComponents().size());
  assertEquals(0,basePigService.getProperties().size());
  assertEquals(1,pigService.getProperties().size());
  assertEquals("content",pigService.getProperties().get(0).getName());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHCFSServiceType(){
  StackInfo stack=stackManager.getStack("HDP","2.2.0.ECS");
  ServiceInfo service=stack.getService("ECS");
  assertEquals(service.getServiceType(),"HCFS");
  service=stack.getService("HDFS");
  assertNull(service);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.stack.ThemeModuleTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolve() throws Exception {
  File parentThemeFile=new File(this.getClass().getClassLoader().getResource("parent-theme.json").getFile());
  File childThemeFile=new File(this.getClass().getClassLoader().getResource("child-theme.json").getFile());
  ThemeModule parentModule=new ThemeModule(parentThemeFile);
  ThemeModule childModule=new ThemeModule(childThemeFile);
  childModule.resolve(parentModule,null,null);
  Theme childTheme=childModule.getModuleInfo().getThemeMap().get(ThemeModule.THEME_KEY);
  Theme parentTheme=parentModule.getModuleInfo().getThemeMap().get(ThemeModule.THEME_KEY);
  assertNotNull(childTheme.getThemeConfiguration().getLayouts());
  assertEquals(10,parentTheme.getThemeConfiguration().getPlacement().getConfigs().size());
  assertEquals(12,childTheme.getThemeConfiguration().getPlacement().getConfigs().size());
  assertEquals(10,parentTheme.getThemeConfiguration().getWidgets().size());
  assertEquals(12,childTheme.getThemeConfiguration().getWidgets().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigGroupTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDeleteConfigGroup() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  Long id=configGroup.getId();
  configGroup.delete();
  Assert.assertNull(configGroupDAO.findById(id));
}

</code></pre>

<br>
<pre class="type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  clusters=injector.getInstance(Clusters.class);
  configFactory=injector.getInstance(ConfigFactory.class);
  configGroupFactory=injector.getInstance(ConfigGroupFactory.class);
  configGroupDAO=injector.getInstance(ConfigGroupDAO.class);
  configGroupHostMappingDAO=injector.getInstance(ConfigGroupHostMappingDAO.class);
  clusterName="foo";
  clusters.addCluster(clusterName,new StackId("HDP-0.1"));
  cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
  clusters.addHost("h1");
  clusters.addHost("h2");
  Assert.assertNotNull(clusters.getHost("h1"));
  Assert.assertNotNull(clusters.getHost("h2"));
  clusters.getHost("h1").persist();
  clusters.getHost("h2").persist();
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveHost() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  Long id=configGroup.getId();
  configGroup=cluster.getConfigGroups().get(id);
  Assert.assertNotNull(configGroup);
  clusters.unmapHostFromCluster("h1",clusterName);
  Assert.assertNull(clusters.getHostsForCluster(clusterName).get("h1"));
  Assert.assertNotNull(configGroupHostMappingDAO.findByHostId(1L));
  Assert.assertTrue(configGroupHostMappingDAO.findByHostId(1L).isEmpty());
  Assert.assertFalse(configGroup.getHosts().containsKey(1L));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Transactional public void testUpdateConfigGroup() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  ConfigGroupEntity configGroupEntity=configGroupDAO.findById(configGroup.getId());
  Assert.assertNotNull(configGroupEntity);
  configGroup=configGroupFactory.createExisting(cluster,configGroupEntity);
  Host host=clusters.getHost("h2");
  configGroup.addHost(host);
  Assert.assertEquals(2,configGroup.getHosts().values().size());
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("key1","value1");
  Map<String,Map<String,String>> propertiesAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put("key1","true");
  propertiesAttributes.put("final",attributes);
  Config config=new ConfigImpl("test-site");
  config.setProperties(properties);
  config.setPropertiesAttributes(propertiesAttributes);
  config.setTag("version100");
  configGroup.addConfiguration(config);
  Assert.assertEquals(2,configGroup.getConfigurations().values().size());
  configGroup.setName("NewName");
  configGroup.setDescription("NewDesc");
  configGroup.setTag("NewTag");
  configGroup.persist();
  configGroup.refresh();
  configGroupEntity=configGroupDAO.findByName("NewName");
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals(2,configGroupEntity.getConfigGroupHostMappingEntities().size());
  Assert.assertEquals(2,configGroupEntity.getConfigGroupConfigMappingEntities().size());
  Assert.assertEquals("NewTag",configGroupEntity.getTag());
  Assert.assertEquals("NewDesc",configGroupEntity.getDescription());
  Assert.assertNotNull(cluster.getConfig("test-site","version100"));
  ConfigGroupConfigMappingEntity configMappingEntity=null;
  Object[] array=configGroupEntity.getConfigGroupConfigMappingEntities().toArray();
  for (  Object o : array) {
    if ("test-site".equals(((ConfigGroupConfigMappingEntity)o).getConfigType())) {
      configMappingEntity=(ConfigGroupConfigMappingEntity)o;
      break;
    }
  }
  Assert.assertNotNull(configMappingEntity);
  Assert.assertTrue(configMappingEntity.getClusterConfigEntity().getData().contains("{\"key1\":\"value1\"}"));
  Assert.assertEquals("{\"final\":{\"key1\":\"true\"}}",configMappingEntity.getClusterConfigEntity().getAttributes());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateNewConfigGroup() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  ConfigGroupEntity configGroupEntity=configGroupDAO.findByName("cg-test");
  Assert.assertNotNull(configGroupEntity);
  Assert.assertEquals("HDFS",configGroupEntity.getTag());
  ConfigGroupConfigMappingEntity configMappingEntity=configGroupEntity.getConfigGroupConfigMappingEntities().iterator().next();
  Assert.assertNotNull(configMappingEntity);
  Assert.assertEquals("hdfs-site",configMappingEntity.getConfigType());
  Assert.assertEquals("testversion",configMappingEntity.getVersionTag());
  Assert.assertNotNull(configMappingEntity.getClusterConfigEntity());
  Assert.assertTrue(configMappingEntity.getClusterConfigEntity().getData().contains("a"));
  Assert.assertEquals("{\"final\":{\"a\":\"true\"}}",configMappingEntity.getClusterConfigEntity().getAttributes());
  ConfigGroupHostMappingEntity hostMappingEntity=configGroupEntity.getConfigGroupHostMappingEntities().iterator().next();
  Assert.assertNotNull(hostMappingEntity);
  Assert.assertEquals("h1",hostMappingEntity.getHostname());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetConfigGroup() throws Exception {
  ConfigGroup configGroup=createConfigGroup();
  Assert.assertNotNull(configGroup);
  Assert.assertNotNull(cluster.getConfigGroups().get(configGroup.getId()));
  ConfigGroupEntity configGroupEntity=configGroupDAO.findById(configGroup.getId());
  Collection<ConfigGroupConfigMappingEntity> configMappingEntities=configGroupEntity.getConfigGroupConfigMappingEntities();
  Collection<ConfigGroupHostMappingEntity> hostMappingEntities=configGroupEntity.getConfigGroupHostMappingEntities();
  Assert.assertEquals(configGroup.getId(),configGroupEntity.getGroupId());
  Assert.assertEquals(configGroup.getTag(),configGroupEntity.getTag());
  Assert.assertNotNull(configMappingEntities);
  Assert.assertNotNull(hostMappingEntities);
  Assert.assertEquals("h1",hostMappingEntities.iterator().next().getHostname());
  ConfigGroupConfigMappingEntity configMappingEntity=configMappingEntities.iterator().next();
  Assert.assertEquals("hdfs-site",configMappingEntity.getConfigType());
  Assert.assertEquals("testversion",configMappingEntity.getVersionTag());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigHelperTest.RunWithCustomModule </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServicePropertiesDoNoRemoveExcluded() throws Exception {
  StackId mockStackVersion=createStrictMock(StackId.class);
  AmbariMetaInfo mockAmbariMetaInfo=injector.getInstance(AmbariMetaInfo.class);
  ServiceInfo mockServiceInfo=createStrictMock(ServiceInfo.class);
  PropertyInfo mockPropertyInfo1=createStrictMock(PropertyInfo.class);
  PropertyInfo mockPropertyInfo2=createStrictMock(PropertyInfo.class);
  List<PropertyInfo> serviceProperties=Arrays.asList(mockPropertyInfo1,mockPropertyInfo2);
  expect(mockStackVersion.getStackName()).andReturn("HDP").once();
  expect(mockStackVersion.getStackVersion()).andReturn("2.2").once();
  expect(mockAmbariMetaInfo.getService("HDP","2.2","SERVICE")).andReturn(mockServiceInfo).once();
  expect(mockServiceInfo.getProperties()).andReturn(serviceProperties).once();
  replay(mockAmbariMetaInfo,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
  mockAmbariMetaInfo.init();
  Set<PropertyInfo> result=injector.getInstance(ConfigHelper.class).getServiceProperties(mockStackVersion,"SERVICE",false);
  Assert.assertNotNull(result);
  Assert.assertEquals(2,result.size());
  verify(mockAmbariMetaInfo,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServicePropertiesRemoveExcluded() throws Exception {
  StackId mockStackVersion=createStrictMock(StackId.class);
  AmbariMetaInfo mockAmbariMetaInfo=injector.getInstance(AmbariMetaInfo.class);
  ServiceInfo mockServiceInfo=createStrictMock(ServiceInfo.class);
  PropertyInfo mockPropertyInfo1=createStrictMock(PropertyInfo.class);
  PropertyInfo mockPropertyInfo2=createStrictMock(PropertyInfo.class);
  List<PropertyInfo> serviceProperties=Arrays.asList(mockPropertyInfo1,mockPropertyInfo2);
  expect(mockStackVersion.getStackName()).andReturn("HDP").once();
  expect(mockStackVersion.getStackVersion()).andReturn("2.2").once();
  expect(mockAmbariMetaInfo.getService("HDP","2.2","SERVICE")).andReturn(mockServiceInfo).once();
  expect(mockServiceInfo.getProperties()).andReturn(serviceProperties).once();
  expect(mockServiceInfo.getExcludedConfigTypes()).andReturn(Collections.singleton("excluded-type")).once();
  expect(mockPropertyInfo1.getFilename()).andReturn("included-type.xml").times(2);
  expect(mockPropertyInfo2.getFilename()).andReturn("excluded-type.xml").once();
  replay(mockAmbariMetaInfo,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
  mockAmbariMetaInfo.init();
  Set<PropertyInfo> result=injector.getInstance(ConfigHelper.class).getServiceProperties(mockStackVersion,"SERVICE",true);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Assert.assertEquals("included-type.xml",result.iterator().next().getFilename());
  verify(mockAmbariMetaInfo,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetServicePropertiesSimpleInvocation() throws Exception {
  Cluster mockCluster=createStrictMock(Cluster.class);
  StackId mockStackVersion=createStrictMock(StackId.class);
  AmbariMetaInfo mockAmbariMetaInfo=injector.getInstance(AmbariMetaInfo.class);
  ServiceInfo mockServiceInfo=createStrictMock(ServiceInfo.class);
  PropertyInfo mockPropertyInfo1=createStrictMock(PropertyInfo.class);
  PropertyInfo mockPropertyInfo2=createStrictMock(PropertyInfo.class);
  List<PropertyInfo> serviceProperties=Arrays.asList(mockPropertyInfo1,mockPropertyInfo2);
  expect(mockCluster.getCurrentStackVersion()).andReturn(mockStackVersion).once();
  expect(mockStackVersion.getStackName()).andReturn("HDP").once();
  expect(mockStackVersion.getStackVersion()).andReturn("2.2").once();
  expect(mockAmbariMetaInfo.getService("HDP","2.2","SERVICE")).andReturn(mockServiceInfo).once();
  expect(mockServiceInfo.getProperties()).andReturn(serviceProperties).once();
  replay(mockAmbariMetaInfo,mockCluster,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
  mockAmbariMetaInfo.init();
  Set<PropertyInfo> result=injector.getInstance(ConfigHelper.class).getServiceProperties(mockCluster,"SERVICE");
  Assert.assertNotNull(result);
  Assert.assertEquals(2,result.size());
  verify(mockAmbariMetaInfo,mockCluster,mockStackVersion,mockServiceInfo,mockPropertyInfo1,mockPropertyInfo2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigHelperTest.RunWithInMemoryDefaultTestModule </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEffectivePropertiesWithOverrides() throws Exception {
  final Config config1=new ConfigImpl("core-site");
  config1.setTag("version122");
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("a","b");
  properties.put("c","d");
  config1.setProperties(properties);
  final Config config2=new ConfigImpl("global");
  config2.setTag("version122");
  Map<String,String> properties2=new HashMap<String,String>();
  properties2.put("namenode_heapsize","1111");
  config2.setProperties(properties2);
  Long groupId=addConfigGroup("g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config1);
      add(config2);
    }
  }
);
  Assert.assertNotNull(groupId);
  Map<String,Map<String,String>> propertyMap=configHelper.getEffectiveConfigProperties(cluster,configHelper.getEffectiveDesiredTags(cluster,"h1"));
  Assert.assertNotNull(propertyMap);
  Assert.assertTrue(propertyMap.containsKey("global"));
  Map<String,String> globalProps=propertyMap.get("global");
  Assert.assertEquals("1111",globalProps.get("namenode_heapsize"));
  Assert.assertEquals("/hadoop/hdfs/namenode",globalProps.get("dfs_namenode_name_dir"));
  Assert.assertTrue(propertyMap.containsKey("core-site"));
  Map<String,String> coreProps=propertyMap.get("core-site");
  Assert.assertTrue(coreProps.containsKey("a"));
  Assert.assertTrue(coreProps.containsKey("c"));
  Assert.assertEquals("30",coreProps.get("ipc.client.connect.max.retries"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEffectivePropertiesAttributesWithOverrides() throws Exception {
  final Config config1=new ConfigImpl("core-site");
  config1.setTag("version122");
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put("fs.trash.interval","11");
  attributes.put("b","y");
  Map<String,Map<String,String>> config1Attributes=new HashMap<String,Map<String,String>>();
  config1Attributes.put("attribute1",attributes);
  config1.setPropertiesAttributes(config1Attributes);
  final Config config2=new ConfigImpl("global");
  config2.setTag("version122");
  attributes=new HashMap<String,String>();
  attributes.put("namenode_heapsize","z");
  attributes.put("c","q");
  Map<String,Map<String,String>> config2Attributes=new HashMap<String,Map<String,String>>();
  config2Attributes.put("attribute2",attributes);
  config2.setPropertiesAttributes(config2Attributes);
  Long groupId=addConfigGroup("g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config1);
      add(config2);
    }
  }
);
  Assert.assertNotNull(groupId);
  Map<String,Map<String,Map<String,String>>> effectiveAttributes=configHelper.getEffectiveConfigAttributes(cluster,configHelper.getEffectiveDesiredTags(cluster,"h1"));
  Assert.assertNotNull(effectiveAttributes);
  Assert.assertEquals(4,effectiveAttributes.size());
  Assert.assertTrue(effectiveAttributes.containsKey("global"));
  Map<String,Map<String,String>> globalAttrs=effectiveAttributes.get("global");
  Assert.assertEquals(1,globalAttrs.size());
  Assert.assertTrue(globalAttrs.containsKey("attribute2"));
  Map<String,String> attribute2Occurances=globalAttrs.get("attribute2");
  Assert.assertEquals(3,attribute2Occurances.size());
  Assert.assertTrue(attribute2Occurances.containsKey("namenode_heapsize"));
  Assert.assertEquals("z",attribute2Occurances.get("namenode_heapsize"));
  Assert.assertTrue(attribute2Occurances.containsKey("dfs_namenode_name_dir"));
  Assert.assertEquals("3",attribute2Occurances.get("dfs_namenode_name_dir"));
  Assert.assertTrue(attribute2Occurances.containsKey("c"));
  Assert.assertEquals("q",attribute2Occurances.get("c"));
  Assert.assertTrue(effectiveAttributes.containsKey("core-site"));
  Map<String,Map<String,String>> coreAttrs=effectiveAttributes.get("core-site");
  Assert.assertEquals(1,coreAttrs.size());
  Assert.assertTrue(coreAttrs.containsKey("attribute1"));
  Map<String,String> attribute1Occurances=coreAttrs.get("attribute1");
  Assert.assertEquals(3,attribute1Occurances.size());
  Assert.assertTrue(attribute1Occurances.containsKey("ipc.client.connect.max.retries"));
  Assert.assertEquals("1",attribute1Occurances.get("ipc.client.connect.max.retries"));
  Assert.assertTrue(attribute1Occurances.containsKey("fs.trash.interval"));
  Assert.assertEquals("11",attribute1Occurances.get("fs.trash.interval"));
  Assert.assertTrue(attribute1Occurances.containsKey("b"));
  Assert.assertEquals("y",attribute1Occurances.get("b"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEffectiveTagsForHost() throws Exception {
  final Config config=new ConfigImpl("core-site");
  config.setTag("version122");
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("a","b");
  properties.put("c","d");
  config.setProperties(properties);
  Long groupId=addConfigGroup("g1","t1",new ArrayList<String>(){
{
      add("h1");
    }
  }
,new ArrayList<Config>(){
{
      add(config);
    }
  }
);
  Assert.assertNotNull(groupId);
  Map<String,Map<String,String>> configTags=configHelper.getEffectiveDesiredTags(cluster,"h1");
  Assert.assertNotNull(configTags);
  Map<String,String> tagsWithOverrides=configTags.get("core-site");
  Assert.assertNotNull(tagsWithOverrides);
  Assert.assertTrue(tagsWithOverrides.containsKey(ConfigHelper.CLUSTER_DEFAULT_TAG));
  Assert.assertEquals("version1",tagsWithOverrides.get(ConfigHelper.CLUSTER_DEFAULT_TAG));
  Assert.assertTrue(tagsWithOverrides.containsKey(groupId.toString()));
  Assert.assertEquals("version122",tagsWithOverrides.get(groupId.toString()));
}

</code></pre>

<br>
<pre class="type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(TestAuthenticationFactory.createAdministrator("admin"));
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  clusters=injector.getInstance(Clusters.class);
  configGroupFactory=injector.getInstance(ConfigGroupFactory.class);
  configHelper=injector.getInstance(ConfigHelper.class);
  managementController=injector.getInstance(AmbariManagementController.class);
  clusterName="c1";
  clusters.addCluster(clusterName,new StackId("HDP-2.0.6"));
  cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
  clusters.addHost("h1");
  clusters.addHost("h2");
  Assert.assertNotNull(clusters.getHost("h1"));
  Assert.assertNotNull(clusters.getHost("h2"));
  clusters.getHost("h1").persist();
  clusters.getHost("h2").persist();
  ConfigurationRequest cr=new ConfigurationRequest();
  cr.setClusterName(clusterName);
  cr.setType("core-site");
  cr.setVersionTag("version1");
  cr.setProperties(new HashMap<String,String>(){
{
      put("ipc.client.connect.max.retries","30");
      put("fs.trash.interval","30");
    }
  }
);
  cr.setPropertiesAttributes(new HashMap<String,Map<String,String>>(){
{
      Map<String,String> attrs=new HashMap<String,String>();
      attrs.put("ipc.client.connect.max.retries","1");
      attrs.put("fs.trash.interval","2");
      put("attribute1",attrs);
    }
  }
);
  final ClusterRequest clusterRequest1=new ClusterRequest(cluster.getClusterId(),clusterName,cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest1.setDesiredConfig(Collections.singletonList(cr));
  managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest1);
    }
  }
,null);
  ConfigurationRequest cr2=new ConfigurationRequest();
  cr2.setClusterName(clusterName);
  cr2.setType("flume-conf");
  cr2.setVersionTag("version1");
  final ClusterRequest clusterRequest2=new ClusterRequest(cluster.getClusterId(),clusterName,cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest2.setDesiredConfig(Collections.singletonList(cr2));
  managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest2);
    }
  }
,null);
  cr.setType("global");
  cr.setVersionTag("version1");
  cr.setProperties(new HashMap<String,String>(){
{
      put("dfs_namenode_name_dir","/hadoop/hdfs/namenode");
      put("namenode_heapsize","1024");
    }
  }
);
  cr.setPropertiesAttributes(new HashMap<String,Map<String,String>>(){
{
      Map<String,String> attrs=new HashMap<String,String>();
      attrs.put("dfs_namenode_name_dir","3");
      attrs.put("namenode_heapsize","4");
      put("attribute2",attrs);
    }
  }
);
  final ClusterRequest clusterRequest3=new ClusterRequest(cluster.getClusterId(),clusterName,cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest3.setDesiredConfig(Collections.singletonList(cr));
  managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest3);
    }
  }
,null);
  ConfigurationRequest cr4=new ConfigurationRequest();
  cr4.setClusterName(clusterName);
  cr4.setType("oozie-site");
  cr4.setVersionTag("version1");
  cr4.setProperties(new HashMap<String,String>(){
{
      put("oozie.authentication.type","simple");
      put("oozie.service.HadoopAccessorService.kerberos.enabled","false");
    }
  }
);
  cr4.setPropertiesAttributes(null);
  final ClusterRequest clusterRequest4=new ClusterRequest(cluster.getClusterId(),clusterName,cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest4.setDesiredConfig(Collections.singletonList(cr4));
  managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest4);
    }
  }
,null);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeAttributesWithNoAttributeOverrides() throws Exception {
  Map<String,Map<String,String>> persistedAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> persistedFinalAttrs=new HashMap<String,String>();
  persistedFinalAttrs.put("a","true");
  persistedFinalAttrs.put("c","true");
  persistedFinalAttrs.put("d","true");
  persistedAttributes.put("final",persistedFinalAttrs);
  Map<String,Map<String,String>> confGroupAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> confGroupProperties=new HashMap<String,String>();
  confGroupProperties.put("a","any");
  confGroupProperties.put("b","any");
  confGroupProperties.put("c","any");
  Config overrideConfig=new ConfigImpl(cluster,"type",confGroupProperties,confGroupAttributes,injector);
  Map<String,Map<String,String>> result=configHelper.overrideAttributes(overrideConfig,persistedAttributes);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Map<String,String> finalResultAttributes=result.get("final");
  Assert.assertNotNull(finalResultAttributes);
  Assert.assertEquals(1,finalResultAttributes.size());
  Assert.assertEquals("true",finalResultAttributes.get("d"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeAttributesWithNullAttributes() throws Exception {
  Map<String,Map<String,String>> persistedAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> persistedFinalAttrs=new HashMap<String,String>();
  persistedFinalAttrs.put("a","true");
  persistedFinalAttrs.put("c","true");
  persistedFinalAttrs.put("d","true");
  persistedAttributes.put("final",persistedFinalAttrs);
  Map<String,String> confGroupProperties=new HashMap<String,String>();
  confGroupProperties.put("a","any");
  confGroupProperties.put("b","any");
  confGroupProperties.put("c","any");
  Config overrideConfig=new ConfigImpl(cluster,"type",confGroupProperties,null,injector);
  Map<String,Map<String,String>> result=configHelper.overrideAttributes(overrideConfig,persistedAttributes);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Map<String,String> finalResultAttributes=result.get("final");
  Assert.assertNotNull(finalResultAttributes);
  Assert.assertEquals(3,finalResultAttributes.size());
  Assert.assertEquals("true",finalResultAttributes.get("a"));
  Assert.assertEquals("true",finalResultAttributes.get("c"));
  Assert.assertEquals("true",finalResultAttributes.get("d"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateConfigType() throws Exception {
  Config currentConfig=cluster.getDesiredConfigByType("core-site");
  Map<String,String> properties=currentConfig.getProperties();
  Map<String,Map<String,String>> propertiesAttributes=currentConfig.getPropertiesAttributes();
  Assert.assertNotNull(propertiesAttributes);
  Assert.assertEquals(1,propertiesAttributes.size());
  Assert.assertTrue(propertiesAttributes.containsKey("attribute1"));
  Assert.assertEquals("version1",currentConfig.getTag());
  Assert.assertEquals("30",properties.get("fs.trash.interval"));
  Assert.assertTrue(properties.containsKey("ipc.client.connect.max.retries"));
  Assert.assertTrue(propertiesAttributes.get("attribute1").containsKey("ipc.client.connect.max.retries"));
  Map<String,String> updates=new HashMap<String,String>();
  updates.put("new-property","new-value");
  updates.put("fs.trash.interval","updated-value");
  Collection<String> removals=Collections.singletonList("ipc.client.connect.max.retries");
  configHelper.updateConfigType(cluster,managementController,"core-site",updates,removals,"admin","Test note");
  Config updatedConfig=cluster.getDesiredConfigByType("core-site");
  propertiesAttributes=updatedConfig.getPropertiesAttributes();
  Assert.assertNotNull(propertiesAttributes);
  Assert.assertEquals(1,propertiesAttributes.size());
  Assert.assertTrue(propertiesAttributes.containsKey("attribute1"));
  Assert.assertFalse("version1".equals(updatedConfig.getTag()));
  properties=updatedConfig.getProperties();
  Assert.assertTrue(properties.containsKey("new-property"));
  Assert.assertEquals("new-value",properties.get("new-property"));
  Assert.assertTrue(properties.containsKey("fs.trash.interval"));
  Assert.assertEquals("updated-value",properties.get("fs.trash.interval"));
  Assert.assertEquals("2",propertiesAttributes.get("attribute1").get("fs.trash.interval"));
  Assert.assertFalse(properties.containsKey("ipc.client.connect.max.retries"));
  Assert.assertFalse(propertiesAttributes.get("attribute1").containsKey("ipc.client.connect.max.retries"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeAttributes() throws Exception {
  Map<String,Map<String,String>> persistedAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> persistedFinalAttrs=new HashMap<String,String>();
  persistedFinalAttrs.put("a","true");
  persistedFinalAttrs.put("c","true");
  persistedFinalAttrs.put("d","true");
  persistedAttributes.put("final",persistedFinalAttrs);
  Map<String,Map<String,String>> confGroupAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> confGroupFinalAttrs=new HashMap<String,String>();
  confGroupFinalAttrs.put("b","true");
  confGroupAttributes.put("final",confGroupFinalAttrs);
  Map<String,String> confGroupProperties=new HashMap<String,String>();
  confGroupProperties.put("a","any");
  confGroupProperties.put("b","any");
  confGroupProperties.put("c","any");
  Config overrideConfig=new ConfigImpl(cluster,"type",confGroupProperties,confGroupAttributes,injector);
  Map<String,Map<String,String>> result=configHelper.overrideAttributes(overrideConfig,persistedAttributes);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Map<String,String> finalResultAttributes=result.get("final");
  Assert.assertNotNull(finalResultAttributes);
  Assert.assertEquals(2,finalResultAttributes.size());
  Assert.assertEquals("true",finalResultAttributes.get("b"));
  Assert.assertEquals("true",finalResultAttributes.get("d"));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeAttributesWithNullProperties() throws Exception {
  Map<String,Map<String,String>> persistedAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> persistedFinalAttrs=new HashMap<String,String>();
  persistedFinalAttrs.put("a","true");
  persistedFinalAttrs.put("c","true");
  persistedFinalAttrs.put("d","true");
  persistedAttributes.put("final",persistedFinalAttrs);
  Map<String,Map<String,String>> confGroupAttributes=new HashMap<String,Map<String,String>>();
  Map<String,String> confGroupFinalAttrs=new HashMap<String,String>();
  confGroupFinalAttrs.put("b","true");
  confGroupAttributes.put("final",confGroupFinalAttrs);
  Config overrideConfig=new ConfigImpl(cluster,"type",null,confGroupAttributes,injector);
  Map<String,Map<String,String>> result=configHelper.overrideAttributes(overrideConfig,persistedAttributes);
  Assert.assertNotNull(result);
  Assert.assertEquals(1,result.size());
  Map<String,String> finalResultAttributes=result.get("final");
  Assert.assertNotNull(finalResultAttributes);
  Assert.assertEquals(4,finalResultAttributes.size());
  Assert.assertEquals("true",finalResultAttributes.get("a"));
  Assert.assertEquals("true",finalResultAttributes.get("b"));
  Assert.assertEquals("true",finalResultAttributes.get("c"));
  Assert.assertEquals("true",finalResultAttributes.get("d"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ConfigMergeHelperTest </h4><pre class="type-4 type-13 type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetConflicts() throws Exception {
  Cluster clusterMock=createNiceMock(Cluster.class);
  expect(clustersMock.getCluster(anyString())).andReturn(clusterMock);
  expect(clusterMock.getCurrentStackVersion()).andReturn(currentStackId);
  expect(clusterMock.getServices()).andReturn(new HashMap<String,Service>(){
{
      put("HDFS",createNiceMock(Service.class));
      put("ZK",createNiceMock(Service.class));
    }
  }
);
  Set<PropertyInfo> currentHDFSProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hdfs-env.xml","equal.key","equal-value"));
    }
  }
;
  Set<PropertyInfo> currentZKProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("zk-env.xml","different.key","different-value-1"));
    }
  }
;
  Set<PropertyInfo> currentStackProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hadoop-env.xml","equal.key","modified.value"));
    }
  }
;
  expect(ambariMetaInfoMock.getServiceProperties(currentStackId.getStackName(),currentStackId.getStackVersion(),"HDFS")).andReturn(currentHDFSProperties);
  expect(ambariMetaInfoMock.getServiceProperties(currentStackId.getStackName(),currentStackId.getStackVersion(),"ZK")).andReturn(currentZKProperties);
  expect(ambariMetaInfoMock.getStackProperties(currentStackId.getStackName(),currentStackId.getStackVersion())).andReturn(currentStackProperties);
  Set<PropertyInfo> newHDFSProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hdfs-env.xml","equal.key","equal-value"));
      add(createPropertyInfo("new-hdfs-config.xml","equal.key","equal-value"));
    }
  }
;
  Set<PropertyInfo> newZKProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("zk-env.xml","equal.key","different-value-2"));
      add(createPropertyInfo("zk-env.xml","new.key","new-value-2"));
    }
  }
;
  Set<PropertyInfo> newStackProperties=new HashSet<PropertyInfo>(){
{
      add(createPropertyInfo("hadoop-env.xml","equal.key","another.value"));
    }
  }
;
  expect(ambariMetaInfoMock.getServiceProperties(newStackId.getStackName(),newStackId.getStackVersion(),"HDFS")).andReturn(newHDFSProperties);
  expect(ambariMetaInfoMock.getServiceProperties(newStackId.getStackName(),newStackId.getStackVersion(),"ZK")).andReturn(newZKProperties);
  expect(ambariMetaInfoMock.getStackProperties(newStackId.getStackName(),newStackId.getStackVersion())).andReturn(newStackProperties);
  Map<String,String> desiredHdfsEnvProperties=new HashMap<String,String>(){
{
    }
  }
;
  expect(clusterMock.getDesiredConfigByType("hdfs-env.xml")).andReturn(createConfigMock(desiredHdfsEnvProperties));
  Map<String,String> desiredZkEnvProperties=new HashMap<String,String>(){
{
    }
  }
;
  expect(clusterMock.getDesiredConfigByType("hdfs-env.xml")).andReturn(createConfigMock(desiredZkEnvProperties));
  Map<String,String> desiredHadoopEnvProperties=new HashMap<String,String>(){
{
    }
  }
;
  expect(clusterMock.getDesiredConfigByType("hadoop-env.xml")).andReturn(createConfigMock(desiredHadoopEnvProperties));
  replay(clusterMock,clustersMock,ambariMetaInfoMock);
  ConfigMergeHelper configMergeHelper=injector.getInstance(ConfigMergeHelper.class);
  Map<String,Map<String,ThreeWayValue>> conflicts=configMergeHelper.getConflicts("clustername",newStackId);
  assertNotNull(conflicts);
  assertEquals(2,conflicts.size());
  for (  String key : conflicts.keySet()) {
    if (key.equals("hdfs-env")) {
      Map<String,ThreeWayValue> stringThreeWayValueMap=conflicts.get(key);
      assertEquals(1,stringThreeWayValueMap.size());
      assertEquals("equal-value",stringThreeWayValueMap.get("equal.key").oldStackValue);
      assertEquals("equal-value",stringThreeWayValueMap.get("equal.key").newStackValue);
      assertEquals("",stringThreeWayValueMap.get("equal.key").savedValue);
    }
 else     if (key.equals("hadoop-env")) {
      Map<String,ThreeWayValue> stringThreeWayValueMap=conflicts.get(key);
      assertEquals(1,stringThreeWayValueMap.size());
      assertEquals("modified.value",stringThreeWayValueMap.get("equal.key").oldStackValue);
      assertEquals("another.value",stringThreeWayValueMap.get("equal.key").newStackValue);
      assertEquals("",stringThreeWayValueMap.get("equal.key").savedValue);
    }
 else {
      fail("Unexpected key");
    }
  }
  assertEquals(2,conflicts.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.DesiredConfigTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDesiredConfig() throws Exception {
  DesiredConfig dc=new DesiredConfig();
  dc.setServiceName("service");
  dc.setTag("global");
  dc.setUser("_test");
  Assert.assertEquals("Expected service 'service'","service",dc.getServiceName());
  Assert.assertEquals("Expected version 'global'","global",dc.getTag());
  Assert.assertEquals("Expected no host overrides",0,dc.getHostOverrides().size());
  Assert.assertEquals("Expected user '_test'","_test",dc.getUser());
  List<DesiredConfig.HostOverride> hosts=Arrays.asList(new DesiredConfig.HostOverride("h1","v2"),new DesiredConfig.HostOverride("h2","v3"));
  dc.setHostOverrides(hosts);
  Assert.assertNotNull("Expected host overrides to be set",dc.getHostOverrides());
  Assert.assertEquals("Expected host override equality",hosts,dc.getHostOverrides());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostOverride() throws Exception {
  DesiredConfig.HostOverride override=new DesiredConfig.HostOverride("h1","v1");
  Assert.assertNotNull(override.getName());
  Assert.assertNotNull(override.getVersionTag());
  Assert.assertEquals("Expected override host 'h1'","h1",override.getName());
  Assert.assertEquals("Expected override version 'v1'","v1",override.getVersionTag());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.RequestExecutionTest </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDeleteRequestSchedule() throws Exception {
  RequestExecution requestExecution=createRequestSchedule();
  Assert.assertNotNull(requestExecution);
  Long id=requestExecution.getId();
  requestExecution.delete();
  Assert.assertNull(requestScheduleDAO.findById(id));
  Assert.assertNull(cluster.getAllRequestExecutions().get(id));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateRequestSchedule() throws Exception {
  RequestExecution requestExecution=createRequestSchedule();
  Assert.assertNotNull(requestExecution);
  RequestScheduleEntity scheduleEntity=requestScheduleDAO.findById(requestExecution.getId());
  Assert.assertNotNull(scheduleEntity);
  Assert.assertEquals(requestExecution.getBatch().getBatchSettings().getTaskFailureToleranceLimit(),scheduleEntity.getBatchTolerationLimit());
  Assert.assertEquals(scheduleEntity.getRequestScheduleBatchRequestEntities().size(),2);
  Collection<RequestScheduleBatchRequestEntity> batchRequestEntities=scheduleEntity.getRequestScheduleBatchRequestEntities();
  Assert.assertNotNull(batchRequestEntities);
  RequestScheduleBatchRequestEntity reqEntity1=null;
  RequestScheduleBatchRequestEntity reqEntity2=null;
  for (  RequestScheduleBatchRequestEntity reqEntity : batchRequestEntities) {
    if (reqEntity.getRequestUri().equals("testUri1")) {
      reqEntity1=reqEntity;
    }
 else     if (reqEntity.getRequestUri().equals("testUri2")) {
      reqEntity2=reqEntity;
    }
  }
  Assert.assertNotNull(reqEntity1);
  Assert.assertNotNull(reqEntity2);
  Assert.assertEquals(Long.valueOf(10L),reqEntity1.getBatchId());
  Assert.assertEquals(Long.valueOf(12L),reqEntity2.getBatchId());
  Assert.assertEquals(BatchRequest.Type.DELETE.name(),reqEntity1.getRequestType());
  Assert.assertEquals(BatchRequest.Type.POST.name(),reqEntity2.getRequestType());
  Assert.assertEquals(requestExecution.getSchedule().getMinutes(),scheduleEntity.getMinutes());
  Assert.assertEquals(requestExecution.getSchedule().getEndTime(),scheduleEntity.getEndTime());
}

</code></pre>

<br>
<pre class="type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  clusters=injector.getInstance(Clusters.class);
  metaInfo=injector.getInstance(AmbariMetaInfo.class);
  requestExecutionFactory=injector.getInstance(RequestExecutionFactory.class);
  requestScheduleDAO=injector.getInstance(RequestScheduleDAO.class);
  clusterName="foo";
  clusters.addCluster(clusterName,new StackId("HDP-0.1"));
  cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
  clusters.addHost("h1");
  clusters.addHost("h2");
  clusters.addHost("h3");
  Assert.assertNotNull(clusters.getHost("h1"));
  Assert.assertNotNull(clusters.getHost("h2"));
  Assert.assertNotNull(clusters.getHost("h3"));
  clusters.getHost("h1").persist();
  clusters.getHost("h2").persist();
  clusters.getHost("h3").persist();
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateRequestSchedule() throws Exception {
  RequestExecution requestExecution=createRequestSchedule();
  Assert.assertNotNull(requestExecution);
  Long id=requestExecution.getId();
  RequestScheduleEntity scheduleEntity=requestScheduleDAO.findById(id);
  Assert.assertNotNull(scheduleEntity);
  requestExecution=requestExecutionFactory.createExisting(cluster,scheduleEntity);
  Batch batches=new Batch();
  List<BatchRequest> batchRequests=new ArrayList<BatchRequest>();
  BatchRequest batchRequest1=new BatchRequest();
  batchRequest1.setOrderId(10L);
  batchRequest1.setType(BatchRequest.Type.PUT);
  batchRequest1.setUri("testUri3");
  BatchRequest batchRequest2=new BatchRequest();
  batchRequest2.setOrderId(12L);
  batchRequest2.setType(BatchRequest.Type.POST);
  batchRequest2.setUri("testUri4");
  batchRequest2.setBody("testBody");
  batchRequests.add(batchRequest1);
  batchRequests.add(batchRequest2);
  batches.getBatchRequests().addAll(batchRequests);
  requestExecution.setBatch(batches);
  requestExecution.getSchedule().setHours("11");
  requestExecution.persist();
  scheduleEntity=requestScheduleDAO.findById(id);
  Assert.assertNotNull(scheduleEntity);
  Collection<RequestScheduleBatchRequestEntity> batchRequestEntities=scheduleEntity.getRequestScheduleBatchRequestEntities();
  Assert.assertNotNull(batchRequestEntities);
  RequestScheduleBatchRequestEntity reqEntity1=null;
  RequestScheduleBatchRequestEntity reqEntity2=null;
  for (  RequestScheduleBatchRequestEntity reqEntity : batchRequestEntities) {
    if (reqEntity.getRequestUri().equals("testUri3")) {
      reqEntity1=reqEntity;
    }
 else     if (reqEntity.getRequestUri().equals("testUri4")) {
      reqEntity2=reqEntity;
    }
  }
  Assert.assertNotNull(reqEntity1);
  Assert.assertNotNull(reqEntity2);
  Assert.assertEquals(Long.valueOf(10L),reqEntity1.getBatchId());
  Assert.assertEquals(Long.valueOf(12L),reqEntity2.getBatchId());
  Assert.assertEquals(BatchRequest.Type.PUT.name(),reqEntity1.getRequestType());
  Assert.assertEquals(BatchRequest.Type.POST.name(),reqEntity2.getRequestType());
  Assert.assertEquals("11",scheduleEntity.getHours());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetRequestScheduleWithRequestBody() throws Exception {
  RequestExecution requestExecution=createRequestSchedule();
  Assert.assertNotNull(requestExecution);
  Assert.assertNotNull(cluster.getAllRequestExecutions().get(requestExecution.getId()));
  RequestScheduleEntity scheduleEntity=requestScheduleDAO.findById(requestExecution.getId());
  Assert.assertNotNull(scheduleEntity);
  requestExecution=requestExecutionFactory.createExisting(cluster,scheduleEntity);
  BatchRequest postBatchRequest=null;
  List<BatchRequest> batchRequests=requestExecution.getBatch().getBatchRequests();
  Assert.assertNotNull(batchRequests);
  for (  BatchRequest batchRequest : batchRequests) {
    if (batchRequest.getType().equals(BatchRequest.Type.POST.name())) {
      postBatchRequest=batchRequest;
    }
  }
  Assert.assertNotNull(postBatchRequest);
  Assert.assertNull(postBatchRequest.getBody());
  RequestScheduleResponse requestScheduleResponse=requestExecution.convertToResponseWithBody();
  Assert.assertNotNull(requestScheduleResponse);
  batchRequests=requestExecution.getBatch().getBatchRequests();
  Assert.assertNotNull(batchRequests);
  for (  BatchRequest batchRequest : batchRequests) {
    if (batchRequest.getType().equals(BatchRequest.Type.POST.name())) {
      postBatchRequest=batchRequest;
    }
  }
  Assert.assertNotNull(postBatchRequest);
  Assert.assertNotNull(postBatchRequest.getBody());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateStatus() throws Exception {
  RequestExecution requestExecution=createRequestSchedule();
  Assert.assertNotNull(requestExecution);
  Assert.assertNotNull(cluster.getAllRequestExecutions().get(requestExecution.getId()));
  RequestScheduleEntity scheduleEntity=requestScheduleDAO.findById(requestExecution.getId());
  Assert.assertNotNull(scheduleEntity);
  Assert.assertEquals(RequestExecution.Status.SCHEDULED.name(),scheduleEntity.getStatus());
  requestExecution.updateStatus(RequestExecution.Status.COMPLETED);
  scheduleEntity=requestScheduleDAO.findById(requestExecution.getId());
  Assert.assertNotNull(scheduleEntity);
  Assert.assertEquals(RequestExecution.Status.COMPLETED.name(),scheduleEntity.getStatus());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateBatchRequest() throws Exception {
  RequestExecution requestExecution=createRequestSchedule();
  Assert.assertNotNull(requestExecution);
  Assert.assertNotNull(cluster.getAllRequestExecutions().get(requestExecution.getId()));
  RequestScheduleEntity scheduleEntity=requestScheduleDAO.findById(requestExecution.getId());
  Assert.assertNotNull(scheduleEntity);
  Assert.assertEquals(RequestExecution.Status.SCHEDULED.name(),scheduleEntity.getStatus());
  Collection<RequestScheduleBatchRequestEntity> batchRequestEntities=scheduleEntity.getRequestScheduleBatchRequestEntities();
  Assert.assertNotNull(batchRequestEntities);
  Assert.assertEquals(2,batchRequestEntities.size());
  BatchRequestResponse batchRequestResponse=new BatchRequestResponse();
  batchRequestResponse.setRequestId(1L);
  batchRequestResponse.setReturnCode(200);
  batchRequestResponse.setReturnMessage("test");
  batchRequestResponse.setStatus("IN_PROGRESS");
  requestExecution.updateBatchRequest(10L,batchRequestResponse,false);
  scheduleEntity=requestScheduleDAO.findById(requestExecution.getId());
  RequestScheduleBatchRequestEntity testEntity=null;
  for (  RequestScheduleBatchRequestEntity entity : scheduleEntity.getRequestScheduleBatchRequestEntities()) {
    if (entity.getBatchId().equals(10L)) {
      testEntity=entity;
    }
  }
  Assert.assertNotNull(testEntity);
  Assert.assertEquals(200,testEntity.getReturnCode().intValue());
  Assert.assertEquals("test",testEntity.getReturnMessage());
  Assert.assertEquals("IN_PROGRESS",testEntity.getRequestStatus());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRequestSchedule() throws Exception {
  RequestExecution requestExecution=createRequestSchedule();
  Assert.assertNotNull(requestExecution);
  RequestScheduleEntity scheduleEntity=requestScheduleDAO.findById(requestExecution.getId());
  Assert.assertNotNull(scheduleEntity);
  Assert.assertNotNull(cluster.getAllRequestExecutions().get(requestExecution.getId()));
  Assert.assertNotNull(scheduleEntity);
  Assert.assertEquals(requestExecution.getBatch().getBatchSettings().getTaskFailureToleranceLimit(),scheduleEntity.getBatchTolerationLimit());
  Assert.assertEquals(scheduleEntity.getRequestScheduleBatchRequestEntities().size(),2);
  Collection<RequestScheduleBatchRequestEntity> batchRequestEntities=scheduleEntity.getRequestScheduleBatchRequestEntities();
  Assert.assertNotNull(batchRequestEntities);
  RequestScheduleBatchRequestEntity reqEntity1=null;
  RequestScheduleBatchRequestEntity reqEntity2=null;
  for (  RequestScheduleBatchRequestEntity reqEntity : batchRequestEntities) {
    if (reqEntity.getRequestUri().equals("testUri1")) {
      reqEntity1=reqEntity;
    }
 else     if (reqEntity.getRequestUri().equals("testUri2")) {
      reqEntity2=reqEntity;
    }
  }
  Assert.assertNotNull(reqEntity1);
  Assert.assertNotNull(reqEntity2);
  Assert.assertEquals(Long.valueOf(10L),reqEntity1.getBatchId());
  Assert.assertEquals(Long.valueOf(12L),reqEntity2.getBatchId());
  Assert.assertEquals(BatchRequest.Type.DELETE.name(),reqEntity1.getRequestType());
  Assert.assertEquals(BatchRequest.Type.POST.name(),reqEntity2.getRequestType());
  Assert.assertEquals(requestExecution.getSchedule().getMinutes(),scheduleEntity.getMinutes());
  Assert.assertEquals(requestExecution.getSchedule().getEndTime(),scheduleEntity.getEndTime());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServiceComponentTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAndSetServiceComponentInfo() throws AmbariException {
  String componentName="NAMENODE";
  ServiceComponent component=serviceComponentFactory.createNew(service,componentName);
  service.addServiceComponent(component);
  component.persist();
  ServiceComponent sc=service.getServiceComponent(componentName);
  Assert.assertNotNull(sc);
  sc.setDesiredState(State.INSTALLED);
  Assert.assertEquals(State.INSTALLED,sc.getDesiredState());
  sc.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  Assert.assertEquals("HDP-1.2.0",sc.getDesiredStackVersion().getStackId());
  ServiceComponentDesiredStateDAO serviceComponentDesiredStateDAO=injector.getInstance(ServiceComponentDesiredStateDAO.class);
  ServiceComponentDesiredStateEntityPK primaryKey=new ServiceComponentDesiredStateEntityPK();
  primaryKey.setClusterId(cluster.getClusterId());
  primaryKey.setComponentName(componentName);
  primaryKey.setServiceName(serviceName);
  ServiceComponentDesiredStateEntity serviceComponentDesiredStateEntity=serviceComponentDesiredStateDAO.findByPK(primaryKey);
  ServiceComponent sc1=serviceComponentFactory.createExisting(service,serviceComponentDesiredStateEntity);
  Assert.assertNotNull(sc1);
  Assert.assertEquals(State.INSTALLED,sc1.getDesiredState());
  Assert.assertEquals("HDP-1.2.0",sc1.getDesiredStackVersion().getStackId());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertToResponse() throws AmbariException {
  String componentName="NAMENODE";
  ServiceComponent component=serviceComponentFactory.createNew(service,componentName);
  service.addServiceComponent(component);
  component.persist();
  addHostToCluster("h1",service.getCluster().getClusterName());
  ServiceComponentHost sch=serviceComponentHostFactory.createNew(component,"h1");
  sch.setState(State.INSTALLED);
  Map<String,ServiceComponentHost> compHosts=new HashMap<String,ServiceComponentHost>();
  compHosts.put("h1",sch);
  component.addServiceComponentHosts(compHosts);
  Assert.assertEquals(1,component.getServiceComponentHosts().size());
  sch.persist();
  ServiceComponent sc=service.getServiceComponent(componentName);
  Assert.assertNotNull(sc);
  sc.setDesiredState(State.INSTALLED);
  sc.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  ServiceComponentResponse r=sc.convertToResponse();
  Assert.assertEquals(sc.getClusterName(),r.getClusterName());
  Assert.assertEquals(sc.getClusterId(),r.getClusterId().longValue());
  Assert.assertEquals(sc.getName(),r.getComponentName());
  Assert.assertEquals(sc.getServiceName(),r.getServiceName());
  Assert.assertEquals(sc.getDesiredStackVersion().getStackId(),r.getDesiredStackVersion());
  Assert.assertEquals(sc.getDesiredState().toString(),r.getDesiredState());
  Assert.assertEquals(1,r.getTotalCount());
  Assert.assertEquals(0,r.getStartedCount());
  Assert.assertEquals(1,r.getInstalledCount());
  StringBuilder sb=new StringBuilder();
  sc.debugDump(sb);
  Assert.assertFalse(sb.toString().isEmpty());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetServiceComponentHosts() throws AmbariException {
  String componentName="NAMENODE";
  ServiceComponent component=serviceComponentFactory.createNew(service,componentName);
  service.addServiceComponent(component);
  component.persist();
  ServiceComponent sc=service.getServiceComponent(componentName);
  Assert.assertNotNull(sc);
  Assert.assertTrue(sc.getServiceComponentHosts().isEmpty());
  try {
    serviceComponentHostFactory.createNew(sc,"h1");
    fail("Expected error for invalid host");
  }
 catch (  Exception e) {
  }
  addHostToCluster("h1",service.getCluster().getClusterName());
  addHostToCluster("h2",service.getCluster().getClusterName());
  addHostToCluster("h3",service.getCluster().getClusterName());
  HostEntity hostEntity1=hostDAO.findByName("h1");
  assertNotNull(hostEntity1);
  ServiceComponentHost sch1=serviceComponentHostFactory.createNew(sc,"h1");
  ServiceComponentHost sch2=serviceComponentHostFactory.createNew(sc,"h2");
  ServiceComponentHost failSch=serviceComponentHostFactory.createNew(sc,"h2");
  Map<String,ServiceComponentHost> compHosts=new HashMap<String,ServiceComponentHost>();
  compHosts.put("h1",sch1);
  compHosts.put("h2",sch2);
  compHosts.put("h3",failSch);
  try {
    sc.addServiceComponentHosts(compHosts);
    fail("Expected error for dups");
  }
 catch (  Exception e) {
  }
  Assert.assertTrue(sc.getServiceComponentHosts().isEmpty());
  compHosts.remove("h3");
  sc.addServiceComponentHosts(compHosts);
  Assert.assertEquals(2,sc.getServiceComponentHosts().size());
  sch1.persist();
  sch2.persist();
  ServiceComponentHost schCheck=sc.getServiceComponentHost("h2");
  Assert.assertNotNull(schCheck);
  Assert.assertEquals("h2",schCheck.getHostName());
  ServiceComponentHost sch3=serviceComponentHostFactory.createNew(sc,"h3");
  sc.addServiceComponentHost(sch3);
  sch3.persist();
  Assert.assertNotNull(sc.getServiceComponentHost("h3"));
  sch1.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  sch1.setState(State.STARTING);
  sch1.setStackVersion(new StackId("HDP-1.2.0"));
  sch1.setDesiredState(State.STARTED);
  HostComponentDesiredStateDAO desiredStateDAO=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentStateDAO liveStateDAO=injector.getInstance(HostComponentStateDAO.class);
  HostComponentDesiredStateEntityPK dPK=new HostComponentDesiredStateEntityPK();
  dPK.setClusterId(cluster.getClusterId());
  dPK.setComponentName(componentName);
  dPK.setHostId(hostEntity1.getHostId());
  dPK.setServiceName(serviceName);
  HostComponentDesiredStateEntity desiredStateEntity=desiredStateDAO.findByPK(dPK);
  HostComponentStateEntity stateEntity=liveStateDAO.findByIndex(cluster.getClusterId(),serviceName,componentName,hostEntity1.getHostId());
  ServiceComponentHost sch=serviceComponentHostFactory.createExisting(sc,stateEntity,desiredStateEntity);
  Assert.assertNotNull(sch);
  Assert.assertEquals(State.STARTING,sch.getState());
  Assert.assertEquals(State.STARTED,sch.getDesiredState());
  Assert.assertEquals("HDP-1.2.0",sch.getStackVersion().getStackId());
  Assert.assertEquals("HDP-1.2.0",sch.getDesiredStackVersion().getStackId());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateServiceComponent() throws AmbariException {
  String componentName="DATANODE2";
  ServiceComponent component=serviceComponentFactory.createNew(service,componentName);
  service.addServiceComponent(component);
  component.persist();
  ServiceComponent sc=service.getServiceComponent(componentName);
  Assert.assertNotNull(sc);
  Assert.assertEquals(componentName,sc.getName());
  Assert.assertEquals(serviceName,sc.getServiceName());
  Assert.assertEquals(cluster.getClusterId(),sc.getClusterId());
  Assert.assertEquals(cluster.getClusterName(),sc.getClusterName());
  Assert.assertEquals(State.INIT,sc.getDesiredState());
  Assert.assertFalse(sc.getDesiredStackVersion().getStackId().isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  clusters=injector.getInstance(Clusters.class);
  serviceFactory=injector.getInstance(ServiceFactory.class);
  serviceComponentFactory=injector.getInstance(ServiceComponentFactory.class);
  serviceComponentHostFactory=injector.getInstance(ServiceComponentHostFactory.class);
  helper=injector.getInstance(OrmTestHelper.class);
  hostDAO=injector.getInstance(HostDAO.class);
  metaInfo=injector.getInstance(AmbariMetaInfo.class);
  clusterName="foo";
  serviceName="HDFS";
  StackId stackId=new StackId("HDP-0.1");
  clusters.addCluster(clusterName,stackId);
  cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(stackId);
  Assert.assertNotNull(cluster);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServiceInfoTest </h4><pre class="type-4 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsRestartRequiredAfterRackChange() throws Exception {
  String serviceInfoXml="<metainfo>\n" + "  <schemaVersion>2.0</schemaVersion>\n" + "  <services>\n"+ "    <service>\n"+ "      <name>RESTART</name>\n"+ "      <displayName>RESTART</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "      <restartRequiredAfterRackChange>true</restartRequiredAfterRackChange>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>NO_RESTART</name>\n"+ "      <displayName>NO_RESTART</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "      <restartRequiredAfterRackChange>false</restartRequiredAfterRackChange>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>DEFAULT_RESTART</name>\n"+ "      <displayName>DEFAULT_RESTART</displayName>\n"+ "      <comment>Apache Hadoop Distributed File System</comment>\n"+ "      <version>2.1.0.2.0</version>\n"+ "    </service>\n"+ "    <service>\n"+ "      <name>HCFS_SERVICE</name>\n"+ "      <displayName>HCFS_SERVICE</displayName>\n"+ "      <comment>Hadoop Compatible File System</comment>\n"+ "      <version>2.1.1.0</version>\n"+ "      <serviceType>HCFS</serviceType>\n"+ "    </service>\n"+ "  </services>\n"+ "</metainfo>\n";
  Map<String,ServiceInfo> serviceInfoMap=getServiceInfo(serviceInfoXml);
  assertTrue(serviceInfoMap.get("RESTART").isRestartRequiredAfterRackChange());
  assertFalse(serviceInfoMap.get("NO_RESTART").isRestartRequiredAfterRackChange());
  assertNull(serviceInfoMap.get("DEFAULT_RESTART").isRestartRequiredAfterRackChange());
  assertEquals(serviceInfoMap.get("HCFS_SERVICE").getServiceType(),"HCFS");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.ServiceTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceMaintenance() throws Exception {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  ClusterServiceDAO dao=injector.getInstance(ClusterServiceDAO.class);
  ClusterServiceEntity entity=dao.findByClusterAndServiceNames(clusterName,serviceName);
  Assert.assertNotNull(entity);
  Assert.assertEquals(MaintenanceState.OFF,entity.getServiceDesiredStateEntity().getMaintenanceState());
  Assert.assertEquals(MaintenanceState.OFF,service.getMaintenanceState());
  service.setMaintenanceState(MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.ON,service.getMaintenanceState());
  entity=dao.findByClusterAndServiceNames(clusterName,serviceName);
  Assert.assertNotNull(entity);
  Assert.assertEquals(MaintenanceState.ON,entity.getServiceDesiredStateEntity().getMaintenanceState());
}

</code></pre>

<br>
<pre class="type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  clusters=injector.getInstance(Clusters.class);
  serviceFactory=injector.getInstance(ServiceFactory.class);
  serviceComponentFactory=injector.getInstance(ServiceComponentFactory.class);
  metaInfo=injector.getInstance(AmbariMetaInfo.class);
  clusterName="foo";
  clusters.addCluster(clusterName,new StackId("HDP-0.1"));
  cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateService() throws AmbariException {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  Assert.assertEquals(serviceName,service.getName());
  Assert.assertEquals(cluster.getClusterId(),service.getCluster().getClusterId());
  Assert.assertEquals(cluster.getClusterName(),service.getCluster().getClusterName());
  Assert.assertEquals(State.INIT,service.getDesiredState());
  Assert.assertEquals(SecurityState.UNSECURED,service.getSecurityState());
  Assert.assertFalse(service.getDesiredStackVersion().getStackId().isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAndSetServiceInfo() throws AmbariException {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  service.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  Assert.assertEquals("HDP-1.2.0",service.getDesiredStackVersion().getStackId());
  service.setDesiredState(State.INSTALLING);
  Assert.assertEquals(State.INSTALLING,service.getDesiredState());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertToResponse() throws AmbariException {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  ServiceResponse r=s.convertToResponse();
  Assert.assertEquals(s.getName(),r.getServiceName());
  Assert.assertEquals(s.getCluster().getClusterName(),r.getClusterName());
  Assert.assertEquals(s.getDesiredStackVersion().getStackId(),r.getDesiredStackVersion());
  Assert.assertEquals(s.getDesiredState().toString(),r.getDesiredState());
  service.setDesiredStackVersion(new StackId("HDP-1.2.0"));
  service.setDesiredState(State.INSTALLING);
  r=s.convertToResponse();
  Assert.assertEquals(s.getName(),r.getServiceName());
  Assert.assertEquals(s.getCluster().getClusterName(),r.getClusterName());
  Assert.assertEquals(s.getDesiredStackVersion().getStackId(),r.getDesiredStackVersion());
  Assert.assertEquals(s.getDesiredState().toString(),r.getDesiredState());
  StringBuilder sb=new StringBuilder();
  s.debugDump(sb);
  Assert.assertFalse(sb.toString().isEmpty());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecurityState() throws Exception {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  ClusterServiceDAO dao=injector.getInstance(ClusterServiceDAO.class);
  ClusterServiceEntity entity=dao.findByClusterAndServiceNames(clusterName,serviceName);
  Assert.assertNotNull(entity);
  Assert.assertEquals(SecurityState.UNSECURED,entity.getServiceDesiredStateEntity().getSecurityState());
  Assert.assertEquals(SecurityState.UNSECURED,service.getSecurityState());
  service.setSecurityState(SecurityState.SECURED_KERBEROS);
  Assert.assertEquals(SecurityState.SECURED_KERBEROS,service.getSecurityState());
  entity=dao.findByClusterAndServiceNames(clusterName,serviceName);
  Assert.assertNotNull(entity);
  Assert.assertEquals(SecurityState.SECURED_KERBEROS,entity.getServiceDesiredStateEntity().getSecurityState());
  for (  SecurityState state : SecurityState.ENDPOINT_STATES) {
    service.setSecurityState(state);
    Assert.assertEquals(state,service.getSecurityState());
  }
  for (  SecurityState state : SecurityState.TRANSITIONAL_STATES) {
    try {
      service.setSecurityState(state);
      Assert.fail(String.format("SecurityState %s is not a valid desired service state",state.toString()));
    }
 catch (    AmbariException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetServiceComponents() throws AmbariException {
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  Assert.assertTrue(s.getServiceComponents().isEmpty());
  ServiceComponent sc1=serviceComponentFactory.createNew(s,"NAMENODE");
  ServiceComponent sc2=serviceComponentFactory.createNew(s,"DATANODE1");
  ServiceComponent sc3=serviceComponentFactory.createNew(s,"DATANODE2");
  Map<String,ServiceComponent> comps=new HashMap<String,ServiceComponent>();
  comps.put(sc1.getName(),sc1);
  comps.put(sc2.getName(),sc2);
  s.addServiceComponents(comps);
  Assert.assertEquals(2,s.getServiceComponents().size());
  Assert.assertNotNull(s.getServiceComponent(sc1.getName()));
  Assert.assertNotNull(s.getServiceComponent(sc2.getName()));
  try {
    s.getServiceComponent(sc3.getName());
    fail("Expected error when looking for invalid component");
  }
 catch (  Exception e) {
  }
  s.addServiceComponent(sc3);
  sc1.persist();
  sc2.persist();
  sc3.persist();
  ServiceComponent sc4=s.addServiceComponent("HDFS_CLIENT");
  Assert.assertNotNull(s.getServiceComponent(sc4.getName()));
  Assert.assertEquals(State.INIT,s.getServiceComponent("HDFS_CLIENT").getDesiredState());
  Assert.assertTrue(sc4.isClientComponent());
  sc4.persist();
  Assert.assertEquals(4,s.getServiceComponents().size());
  Assert.assertNotNull(s.getServiceComponent(sc3.getName()));
  Assert.assertEquals(sc3.getName(),s.getServiceComponent(sc3.getName()).getName());
  Assert.assertEquals(s.getName(),s.getServiceComponent(sc3.getName()).getServiceName());
  Assert.assertEquals(cluster.getClusterName(),s.getServiceComponent(sc3.getName()).getClusterName());
  sc4.setDesiredState(State.INSTALLING);
  Assert.assertEquals(State.INSTALLING,s.getServiceComponent("HDFS_CLIENT").getDesiredState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.UpgradeHelperTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceCheckDowngradeStages() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack upgrade=upgrades.get("upgrade_test_checks");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,DOWNGRADE_VERSION,Direction.DOWNGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(5,groups.size());
  UpgradeGroupHolder zookeeperGroup=groups.get(3);
  assertEquals("ZOOKEEPER",zookeeperGroup.name);
  ManualTask manualTask=(ManualTask)zookeeperGroup.items.get(0).getTasks().get(0).getTasks().get(0);
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",manualTask.message);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that a Rolling Upgrades restarts the NameNodes in the following order: standby, active.
 * @throws Exception
 */
@Test public void testNamenodeOrder() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder mastersGroup=groups.get(2);
  assertEquals("CORE_MASTER",mastersGroup.name);
  List<String> orderedNameNodes=new LinkedList<String>();
  for (  StageWrapper sw : mastersGroup.items) {
    if (sw.getType().equals(StageWrapper.Type.RESTART) && sw.getText().toLowerCase().contains("NameNode".toLowerCase())) {
      for (      TaskWrapper tw : sw.getTasks()) {
        for (        String hostName : tw.getHosts()) {
          orderedNameNodes.add(hostName);
        }
      }
    }
  }
  assertEquals(2,orderedNameNodes.size());
  assertEquals("h2",orderedNameNodes.get(0));
  assertEquals("h1",orderedNameNodes.get(1));
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that multiple execute tasks with an annotation of synchronized="true" each run in their own stage.
 */
@Test public void testUpgradeWithMultipleTasksInOwnStage() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  assertTrue(upgrade.getType() == UpgradeType.ROLLING);
  List<Grouping> upgradePackGroups=upgrade.getGroups(Direction.UPGRADE);
  boolean foundService=false;
  for (  Grouping group : upgradePackGroups) {
    if (group.title.equals("Oozie")) {
      foundService=true;
    }
  }
  assertTrue(foundService);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  int numPrepareStages=0;
  for (  UpgradeGroupHolder group : groups) {
    if (group.name.equals("OOZIE")) {
      assertTrue(group.items.size() > 0);
      for (      StageWrapper sw : group.items) {
        if (sw.getText().equalsIgnoreCase("Preparing Oozie Server on h2 (Batch 1 of 2)") || sw.getText().equalsIgnoreCase("Preparing Oozie Server on h3 (Batch 2 of 2)")) {
          numPrepareStages++;
          List<TaskWrapper> taskWrappers=sw.getTasks();
          assertEquals(1,taskWrappers.size());
          List<Task> tasks=taskWrappers.get(0).getTasks();
          assertEquals(1,taskWrappers.get(0).getHosts().size());
          assertEquals(1,tasks.size());
          ExecuteTask task=(ExecuteTask)tasks.get(0);
          assertTrue("scripts/oozie_server.py".equalsIgnoreCase(task.script));
          assertTrue("stop".equalsIgnoreCase(task.function));
        }
        if (sw.getText().equalsIgnoreCase("Preparing Oozie Server on h2")) {
          numPrepareStages++;
          List<TaskWrapper> taskWrappers=sw.getTasks();
          assertEquals(1,taskWrappers.size());
          List<Task> tasks=taskWrappers.get(0).getTasks();
          assertEquals(1,taskWrappers.get(0).getHosts().size());
          assertEquals(1,tasks.size());
          ExecuteTask task=(ExecuteTask)tasks.get(0);
          assertTrue("scripts/oozie_server_upgrade.py".equalsIgnoreCase(task.script));
          assertTrue("upgrade_oozie_database_and_sharelib".equalsIgnoreCase(task.function));
        }
      }
    }
  }
  assertEquals(3,numPrepareStages);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeOrchestration() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,DOWNGRADE_VERSION,Direction.DOWNGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("OOZIE",groups.get(1).name);
  assertEquals("HIVE",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("CORE_MASTER",groups.get(4).name);
  assertEquals("ZOOKEEPER",groups.get(5).name);
  UpgradeGroupHolder postGroup=groups.get(6);
  assertEquals("POST_CLUSTER",postGroup.name);
  assertEquals("Finalize Downgrade",postGroup.title);
  assertEquals(3,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals(4,groups.get(0).items.size());
  assertEquals(8,groups.get(1).items.size());
  assertEquals(3,groups.get(2).items.size());
  assertEquals(8,groups.get(3).items.size());
  assertEquals(8,groups.get(4).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigureTaskWithMultipleConfigurations() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder hiveGroup=groups.get(4);
  assertEquals("HIVE",hiveGroup.name);
  ConfigureTask configureTask=(ConfigureTask)hiveGroup.items.get(2).getTasks().get(0).getTasks().get(0);
  Map<String,String> configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  String configurationJson=configProperties.get(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS);
  String transferJson=configProperties.get(ConfigureTask.PARAMETER_TRANSFERS);
  assertNotNull(configurationJson);
  assertNotNull(transferJson);
  List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue> keyValuePairs=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue>>(){
  }
.getType());
  List<ConfigUpgradeChangeDefinition.Transfer> transfers=m_gson.fromJson(transferJson,new TypeToken<List<ConfigUpgradeChangeDefinition.Transfer>>(){
  }
.getType());
  assertEquals("fooKey",keyValuePairs.get(0).key);
  assertEquals("fooValue",keyValuePairs.get(0).value);
  assertEquals("fooKey2",keyValuePairs.get(1).key);
  assertEquals("fooValue2",keyValuePairs.get(1).value);
  assertEquals("fooKey3",keyValuePairs.get(2).key);
  assertEquals("fooValue3",keyValuePairs.get(2).value);
  assertEquals("copy-key",transfers.get(0).fromKey);
  assertEquals("copy-key-to",transfers.get(0).toKey);
  assertEquals("move-key",transfers.get(1).fromKey);
  assertEquals("move-key-to",transfers.get(1).toKey);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeServerActionOrchestration() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_server_action_test"));
  UpgradePack upgrade=upgrades.get("upgrade_server_action_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(1,groups.size());
  UpgradeGroupHolder group=groups.get(0);
  assertEquals("CLUSTER_SERVER_ACTIONS",group.name);
  List<StageWrapper> stageWrappers=group.items;
  assertEquals(6,stageWrappers.size());
  assertEquals("Pre Upgrade",stageWrappers.get(0).getText());
  assertEquals("Pre Upgrade Zookeeper",stageWrappers.get(1).getText());
  assertEquals("Configuring",stageWrappers.get(2).getText());
  assertEquals("Configuring HDFS",stageWrappers.get(3).getText());
  assertEquals("Calculating Properties",stageWrappers.get(4).getText());
  assertEquals("Calculating HDFS Properties",stageWrappers.get(5).getText());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDowngradeAfterPartialUpgrade() throws Exception {
  Clusters clusters=injector.getInstance(Clusters.class);
  ServiceFactory serviceFactory=injector.getInstance(ServiceFactory.class);
  String clusterName="c1";
  StackId stackId=new StackId("HDP-2.1.1");
  clusters.addCluster(clusterName,stackId);
  Cluster c=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,c.getDesiredStackVersion().getStackVersion());
  c.createClusterVersion(stackId,c.getDesiredStackVersion().getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  for (int i=0; i < 2; i++) {
    String hostName="h" + (i + 1);
    clusters.addHost(hostName);
    Host host=clusters.getHost(hostName);
    Map<String,String> hostAttributes=new HashMap<String,String>();
    hostAttributes.put("os_family","redhat");
    hostAttributes.put("os_release_version","6");
    host.setHostAttributes(hostAttributes);
    host.persist();
    clusters.mapHostToCluster(hostName,clusterName);
  }
  c.addService(serviceFactory.createNew(c,"HDFS"));
  Service s=c.getService("HDFS");
  ServiceComponent sc=s.addServiceComponent("NAMENODE");
  sc.addServiceComponentHost("h1");
  sc.addServiceComponentHost("h2");
  List<ServiceComponentHost> schs=c.getServiceComponentHosts("HDFS","NAMENODE");
  assertEquals(2,schs.size());
  HostsType type=new HostsType();
  type.master="h1";
  type.secondary="h2";
  expect(m_masterHostResolver.getMasterAndHosts("ZOOKEEPER","ZOOKEEPER_SERVER")).andReturn(null).anyTimes();
  expect(m_masterHostResolver.getMasterAndHosts("HDFS","NAMENODE")).andReturn(type).anyTimes();
  expect(m_masterHostResolver.getCluster()).andReturn(c).anyTimes();
  replay(m_masterHostResolver);
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,DOWNGRADE_VERSION,Direction.DOWNGRADE,UpgradeType.ROLLING);
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_direction"));
  UpgradePack upgrade=upgrades.get("upgrade_direction");
  assertNotNull(upgrade);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(2,groups.size());
  UpgradeGroupHolder group=groups.get(0);
  assertEquals(1,group.items.size());
  assertEquals("PRE_POST_CLUSTER",group.name);
  group=groups.get(1);
  assertEquals("POST_CLUSTER",group.name);
  assertEquals(3,group.items.size());
  StageWrapper stage=group.items.get(1);
  assertEquals("NameNode Finalize",stage.getText());
  assertEquals(1,stage.getTasks().size());
  TaskWrapper task=stage.getTasks().get(0);
  assertEquals(1,task.getHosts().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManualTaskPostProcessing() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder zookeeperGroup=groups.get(1);
  assertEquals("ZOOKEEPER",zookeeperGroup.name);
  ManualTask manualTask=(ManualTask)zookeeperGroup.items.get(0).getTasks().get(0).getTasks().get(0);
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",manualTask.message);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConditionalDeleteTask() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder hiveGroup=groups.get(4);
  assertEquals("HIVE",hiveGroup.name);
  ConfigureTask configureTask=(ConfigureTask)hiveGroup.items.get(2).getTasks().get(0).getTasks().get(0);
  Map<String,String> hiveConfigs=new HashMap<String,String>();
  hiveConfigs.put("hive.server2.transport.mode","http");
  hiveConfigs.put("hive.server2.thrift.port","10001");
  hiveConfigs.put("condition","1");
  ConfigurationRequest configurationRequest=new ConfigurationRequest();
  configurationRequest.setClusterName(cluster.getClusterName());
  configurationRequest.setType("hive-site");
  configurationRequest.setVersionTag("version2");
  configurationRequest.setProperties(hiveConfigs);
  final ClusterRequest clusterRequest=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest.setDesiredConfig(Collections.singletonList(configurationRequest));
  m_managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest);
    }
  }
,null);
  Map<String,String> configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  String configurationJson=configProperties.get(ConfigureTask.PARAMETER_TRANSFERS);
  assertNotNull(configurationJson);
  List<ConfigUpgradeChangeDefinition.Transfer> transfers=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.Transfer>>(){
  }
.getType());
  assertEquals(10,transfers.size());
  assertEquals("copy-key",transfers.get(0).fromKey);
  assertEquals("copy-key-to",transfers.get(0).toKey);
  assertEquals("move-key",transfers.get(1).fromKey);
  assertEquals("move-key-to",transfers.get(1).toKey);
  assertEquals("delete-key",transfers.get(2).deleteKey);
  assertEquals("delete-http",transfers.get(3).deleteKey);
  assertEquals("delete-null-if-value",transfers.get(4).deleteKey);
  assertEquals("delete-blank-if-key",transfers.get(5).deleteKey);
  assertEquals("delete-blank-if-type",transfers.get(6).deleteKey);
  assertEquals("delete-thrift",transfers.get(7).deleteKey);
  assertEquals("delete-if-key-present",transfers.get(8).deleteKey);
  assertEquals("delete-if-key-absent",transfers.get(9).deleteKey);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeOrchestration() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("ZOOKEEPER",groups.get(1).name);
  assertEquals("CORE_MASTER",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("HIVE",groups.get(4).name);
  assertEquals("OOZIE",groups.get(5).name);
  UpgradeGroupHolder holder=groups.get(2);
  boolean found=false;
  for (  StageWrapper sw : holder.items) {
    if (sw.getTasksJson().contains("Upgrading your database")) {
      found=true;
    }
  }
  assertTrue("Expected to find replaced text for Upgrading",found);
  UpgradeGroupHolder group=groups.get(1);
  assertTrue(group.items.get(1).getText().contains("ZooKeeper1 Server2"));
  assertEquals(group.items.get(5).getText(),"Service Check Zk");
  group=groups.get(3);
  assertEquals(8,group.items.size());
  StageWrapper sw=group.items.get(3);
  assertEquals("Validate Partial Upgrade",sw.getText());
  assertEquals(1,sw.getTasks().size());
  assertEquals(1,sw.getTasks().get(0).getTasks().size());
  Task t=sw.getTasks().get(0).getTasks().get(0);
  assertEquals(ManualTask.class,t.getClass());
  ManualTask mt=(ManualTask)t;
  assertTrue(mt.message.contains("DataNode and NodeManager"));
  assertNotNull(mt.structuredOut);
  assertTrue(mt.structuredOut.contains("DATANODE"));
  assertTrue(mt.structuredOut.contains("NODEMANAGER"));
  UpgradeGroupHolder postGroup=groups.get(6);
  assertEquals("POST_CLUSTER",postGroup.name);
  assertEquals("Finalize Upgrade",postGroup.title);
  assertEquals(3,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals(4,groups.get(0).items.size());
  assertEquals(6,groups.get(1).items.size());
  assertEquals(9,groups.get(2).items.size());
  assertEquals(8,groups.get(3).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that hosts in MM are not included in the upgrade.
 * @throws Exception
 */
@Test public void testUpgradeOrchestrationWithHostsInMM() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  Host hostInMaintenanceMode=cluster.getHosts().iterator().next();
  hostInMaintenanceMode.setMaintenanceState(cluster.getClusterId(),MaintenanceState.ON);
  MasterHostResolver masterHostResolver=new MasterHostResolver(null,cluster,"");
  UpgradeContext context=new UpgradeContext(masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  for (  UpgradeGroupHolder group : groups) {
    for (    StageWrapper stageWrapper : group.items) {
      Set<String> hosts=stageWrapper.getHosts();
      assertFalse(hosts.contains(hostInMaintenanceMode.getHostName()));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeOrchestrationFullTask() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  ServiceInfo si=ambariMetaInfo.getService("HDP","2.1.1","ZOOKEEPER");
  si.setDisplayName("Zk");
  ComponentInfo ci=si.getComponentByName("ZOOKEEPER_SERVER");
  ci.setDisplayName("ZooKeeper1 Server2");
  assertTrue(upgrades.containsKey("upgrade_to_new_stack"));
  UpgradePack upgrade=upgrades.get("upgrade_to_new_stack");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(6,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("ZOOKEEPER",groups.get(1).name);
  assertEquals("CORE_MASTER",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("HIVE",groups.get(4).name);
  UpgradeGroupHolder holder=groups.get(2);
  boolean found=false;
  for (  StageWrapper sw : holder.items) {
    if (sw.getTasksJson().contains("Upgrading your database")) {
      found=true;
    }
  }
  assertTrue("Expected to find replaced text for Upgrading",found);
  UpgradeGroupHolder group=groups.get(1);
  assertTrue(group.items.get(1).getText().contains("ZooKeeper1 Server2"));
  assertEquals(group.items.get(4).getText(),"Service Check Zk");
  group=groups.get(3);
  assertEquals(8,group.items.size());
  StageWrapper sw=group.items.get(3);
  assertEquals("Validate Partial Upgrade",sw.getText());
  assertEquals(1,sw.getTasks().size());
  assertEquals(1,sw.getTasks().get(0).getTasks().size());
  Task t=sw.getTasks().get(0).getTasks().get(0);
  assertEquals(ManualTask.class,t.getClass());
  ManualTask mt=(ManualTask)t;
  assertTrue(mt.message.contains("DataNode and NodeManager"));
  assertNotNull(mt.structuredOut);
  assertTrue(mt.structuredOut.contains("DATANODE"));
  assertTrue(mt.structuredOut.contains("NODEMANAGER"));
  UpgradeGroupHolder postGroup=groups.get(5);
  assertEquals(postGroup.name,"POST_CLUSTER");
  assertEquals(postGroup.title,"Finalize Upgrade");
  assertEquals(4,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals("Run On All 2.2.1.0-1234",postGroup.items.get(3).getText());
  assertEquals(1,postGroup.items.get(3).getTasks().size());
  Set<String> hosts=postGroup.items.get(3).getTasks().get(0).getHosts();
  assertNotNull(hosts);
  assertEquals(4,hosts.size());
  assertEquals(4,groups.get(0).items.size());
  assertEquals(5,groups.get(1).items.size());
  assertEquals(9,groups.get(2).items.size());
  assertEquals(8,groups.get(3).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigureTask() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder hiveGroup=groups.get(4);
  assertEquals("HIVE",hiveGroup.name);
  ConfigureTask configureTask=(ConfigureTask)hiveGroup.items.get(1).getTasks().get(0).getTasks().get(0);
  Map<String,String> configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  String configurationJson=configProperties.get(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS);
  assertNotNull(configurationJson);
  List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue> keyValuePairs=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue>>(){
  }
.getType());
  assertEquals("hive.server2.thrift.port",keyValuePairs.get(0).key);
  assertEquals("10010",keyValuePairs.get(0).value);
  Map<String,String> hiveConfigs=new HashMap<String,String>();
  hiveConfigs.put("hive.server2.transport.mode","http");
  hiveConfigs.put("hive.server2.thrift.port","10001");
  ConfigurationRequest configurationRequest=new ConfigurationRequest();
  configurationRequest.setClusterName(cluster.getClusterName());
  configurationRequest.setType("hive-site");
  configurationRequest.setVersionTag("version2");
  configurationRequest.setProperties(hiveConfigs);
  final ClusterRequest clusterRequest=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),cluster.getDesiredStackVersion().getStackVersion(),null);
  clusterRequest.setDesiredConfig(Collections.singletonList(configurationRequest));
  m_managementController.updateClusters(new HashSet<ClusterRequest>(){
{
      add(clusterRequest);
    }
  }
,null);
  configProperties=configureTask.getConfigurationChanges(cluster,cup);
  assertFalse(configProperties.isEmpty());
  assertEquals(configProperties.get(ConfigureTask.PARAMETER_CONFIG_TYPE),"hive-site");
  configurationJson=configProperties.get(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS);
  assertNotNull(configurationJson);
  keyValuePairs=m_gson.fromJson(configurationJson,new TypeToken<List<ConfigUpgradeChangeDefinition.ConfigurationKeyValue>>(){
  }
.getType());
  assertEquals("hive.server2.http.port",keyValuePairs.get(0).key);
  assertEquals("10011",keyValuePairs.get(0).value);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeOrchestrationWithNoHeartbeat() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("foo","bar");
  assertTrue(upgrades.isEmpty());
  upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertNotNull(upgrade);
  Cluster cluster=makeCluster(false);
  Clusters clusters=injector.getInstance(Clusters.class);
  Host h4=clusters.getHost("h4");
  h4.setState(HostState.HEARTBEAT_LOST);
  h4.persist();
  List<ServiceComponentHost> schs=cluster.getServiceComponentHosts("h4");
  assertEquals(1,schs.size());
  assertEquals(HostState.HEARTBEAT_LOST,schs.get(0).getHostState());
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  assertEquals("PRE_CLUSTER",groups.get(0).name);
  assertEquals("ZOOKEEPER",groups.get(1).name);
  assertEquals("CORE_MASTER",groups.get(2).name);
  assertEquals("CORE_SLAVES",groups.get(3).name);
  assertEquals("HIVE",groups.get(4).name);
  assertEquals("OOZIE",groups.get(5).name);
  UpgradeGroupHolder postGroup=groups.get(6);
  assertEquals("POST_CLUSTER",postGroup.name);
  assertEquals("Finalize Upgrade",postGroup.title);
  assertEquals(3,postGroup.items.size());
  assertEquals("Confirm Finalize",postGroup.items.get(0).getText());
  assertEquals("Execute HDFS Finalize",postGroup.items.get(1).getText());
  assertEquals("Save Cluster State",postGroup.items.get(2).getText());
  assertEquals(StageWrapper.Type.SERVER_SIDE_ACTION,postGroup.items.get(2).getType());
  assertEquals(6,groups.get(1).items.size());
  assertEquals(9,groups.get(2).items.size());
  assertEquals(7,groups.get(3).items.size());
}

</code></pre>

<br>
<pre class="type-4 type-13 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceCheckUpgradeStages() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.2.0");
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack upgrade=upgrades.get("upgrade_test_checks");
  assertNotNull(upgrade);
  Cluster c=makeCluster();
  Set<String> additionalServices=new HashSet<String>(){
{
      add("HBASE");
      add("PIG");
      add("TEZ");
      add("AMBARI_METRICS");
    }
  }
;
  for (  String service : additionalServices) {
    c.addService(service);
  }
  int numServiceChecksExpected=0;
  Collection<Service> services=c.getServices().values();
  for (  Service service : services) {
    ServiceInfo si=ambariMetaInfo.getService(c.getCurrentStackVersion().getStackName(),c.getCurrentStackVersion().getStackVersion(),service.getName());
    if (null == si.getCommandScript()) {
      continue;
    }
    if (service.getName().equalsIgnoreCase("TEZ")) {
      assertTrue("Expect Tez to not have any service checks",false);
    }
    if (service.getName().equalsIgnoreCase("AMBARI_METRICS")) {
      continue;
    }
    numServiceChecksExpected++;
  }
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_22,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(7,groups.size());
  UpgradeGroupHolder holder=groups.get(3);
  assertEquals(holder.name,"SERVICE_CHECK_1");
  assertEquals(7,holder.items.size());
  int numServiceChecksActual=0;
  for (  StageWrapper sw : holder.items) {
    for (    Service service : services) {
      Pattern p=Pattern.compile(".*" + service.getName(),Pattern.CASE_INSENSITIVE);
      Matcher matcher=p.matcher(sw.getText());
      if (matcher.matches()) {
        numServiceChecksActual++;
        continue;
      }
    }
  }
  assertEquals(numServiceChecksActual,numServiceChecksExpected);
  UpgradeGroupHolder zookeeperGroup=groups.get(1);
  assertEquals("ZOOKEEPER",zookeeperGroup.name);
  ManualTask manualTask=(ManualTask)zookeeperGroup.items.get(0).getTasks().get(0).getTasks().get(0);
  assertEquals("This is a manual task with a placeholder of placeholder-rendered-properly",manualTask.message);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBuckets() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.containsKey("upgrade_bucket_test"));
  UpgradePack upgrade=upgrades.get("upgrade_bucket_test");
  assertNotNull(upgrade);
  makeCluster();
  UpgradeContext context=new UpgradeContext(m_masterHostResolver,HDP_21,HDP_21,UPGRADE_VERSION,Direction.UPGRADE,UpgradeType.ROLLING);
  List<UpgradeGroupHolder> groups=m_upgradeHelper.createSequence(upgrade,context);
  assertEquals(1,groups.size());
  UpgradeGroupHolder group=groups.iterator().next();
  assertEquals(22,group.items.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.alerts.AlertDefinitionHashTest </h4><pre class="type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test method for {@link org.apache.ambari.server.state.alert.AlertDefinitionHash#getHash(java.lang.String,java.lang.String)}.
 */
@Test public void testGetHash(){
  String hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertNotSame(AlertDefinitionHash.NULL_MD5_HASH,hash);
  assertEquals(hash,m_hash.getHash(CLUSTERNAME,HOSTNAME));
}

</code></pre>

<br>
<pre class="type-2 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link AlertDefinitionHash#invalidateAll()}.
 */
@Test public void testInvalidateAll(){
  String hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  m_hash.invalidateAll();
  String newHash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertEquals(hash,newHash);
  m_hash.invalidateAll();
  AlertDefinitionEntity agentScoped=new AlertDefinitionEntity();
  agentScoped.setDefinitionId(System.currentTimeMillis());
  agentScoped.setClusterId(1L);
  agentScoped.setHash(UUID.randomUUID().toString());
  agentScoped.setServiceName("AMBARI");
  agentScoped.setComponentName("AMBARI_AGENT");
  agentScoped.setScope(Scope.HOST);
  agentScoped.setScheduleInterval(1);
  m_agentDefinitions.add(agentScoped);
  newHash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotSame(hash,newHash);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link AlertDefinitionHash#isHashCached(String)}.
 */
@Test public void testIsHashCached(){
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  String hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  m_hash.invalidate(HOSTNAME);
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  m_hash.invalidateAll();
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link AlertDefinitionHash#invalidateHosts(AlertDefinitionEntity)}.
 */
@Test public void testInvalidateHosts(){
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  String hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  Set<String> invalidatedHosts=m_hash.invalidateHosts(m_hdfsHost);
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertNotNull(invalidatedHosts);
  assertEquals(1,invalidatedHosts.size());
  assertTrue(invalidatedHosts.contains(HOSTNAME));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Test public void testInvalidateHost(){
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertFalse(m_hash.isHashCached("foo",HOSTNAME));
  String hash=m_hash.getHash(CLUSTERNAME,HOSTNAME);
  assertNotNull(hash);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertFalse(m_hash.isHashCached("foo",HOSTNAME));
  m_hash.invalidate("foo",HOSTNAME);
  assertTrue(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertFalse(m_hash.isHashCached("foo",HOSTNAME));
  m_hash.invalidateAll();
  assertFalse(m_hash.isHashCached(CLUSTERNAME,HOSTNAME));
  assertFalse(m_hash.isHashCached("foo",HOSTNAME));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.alerts.AlertEventPublisherTest </h4><pre class="type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Before public void setup() throws Exception {
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  EventBusSynchronizer.synchronizeAmbariEventPublisher(injector);
  dispatchDao=injector.getInstance(AlertDispatchDAO.class);
  definitionDao=injector.getInstance(AlertDefinitionDAO.class);
  alertsDao=injector.getInstance(AlertsDAO.class);
  clusters=injector.getInstance(Clusters.class);
  serviceFactory=injector.getInstance(ServiceFactory.class);
  ormHelper=injector.getInstance(OrmTestHelper.class);
  aggregateMapping=injector.getInstance(AggregateDefinitionMapping.class);
  clusterName="foo";
  clusters.addCluster(clusterName,new StackId("HDP","2.0.6"));
  cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that {@link AlertDefinitionDeleteEvent} instances are fired when a
 * definition is removed.
 * @throws Exception
 */
@Test public void testAlertDefinitionRemoval() throws Exception {
  Assert.assertEquals(0,definitionDao.findAll().size());
  AlertDefinitionEntity definition=ormHelper.createAlertDefinition(1L);
  Assert.assertEquals(1,definitionDao.findAll().size());
  AggregateSource source=new AggregateSource();
  source.setAlertName(definition.getDefinitionName());
  AlertDefinition aggregate=new AlertDefinition();
  aggregate.setClusterId(1L);
  aggregate.setComponentName("DATANODE");
  aggregate.setEnabled(true);
  aggregate.setInterval(1);
  aggregate.setLabel("DataNode Aggregate");
  aggregate.setName("datanode_aggregate");
  aggregate.setScope(Scope.ANY);
  aggregate.setServiceName("HDFS");
  aggregate.setSource(source);
  aggregate.setUuid("uuid");
  aggregateMapping.registerAggregate(1L,aggregate);
  Assert.assertNotNull(aggregateMapping.getAggregateDefinition(1L,source.getAlertName()));
  definitionDao.remove(definition);
  Assert.assertNull(aggregateMapping.getAggregateDefinition(1L,source.getAlertName()));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that {@link AlertDefinitionChangedEvent} instances are fired when a
 * definition is updated.
 * @throws Exception
 */
@Test public void testAlertDefinitionChanged() throws Exception {
  installHdfsService();
  int definitionCount=definitionDao.findAll().size();
  AlertDefinitionEntity definition=ormHelper.createAlertDefinition(1L);
  Assert.assertEquals(definitionCount + 1,definitionDao.findAll().size());
  AggregateSource source=new AggregateSource();
  Reporting reporting=new Reporting();
  ReportTemplate okTemplate=new ReportTemplate();
  okTemplate.setValue(50.0d);
  okTemplate.setText("foo");
  reporting.setOk(okTemplate);
  source.setReporting(reporting);
  source.setAlertName(definition.getDefinitionName());
  source.setType(SourceType.AGGREGATE);
  AlertDefinitionEntity aggregateEntity=new AlertDefinitionEntity();
  aggregateEntity.setClusterId(1L);
  aggregateEntity.setComponentName("DATANODE");
  aggregateEntity.setEnabled(true);
  aggregateEntity.setDefinitionName("datanode_aggregate");
  aggregateEntity.setScope(Scope.ANY);
  aggregateEntity.setServiceName("HDFS");
  aggregateEntity.setSource(new Gson().toJson(source));
  aggregateEntity.setHash(UUID.randomUUID().toString());
  aggregateEntity.setScheduleInterval(1);
  aggregateEntity.setSourceType(SourceType.AGGREGATE);
  definitionDao.create(aggregateEntity);
  AlertDefinition aggregate=aggregateMapping.getAggregateDefinition(1L,source.getAlertName());
  Assert.assertNotNull(aggregate);
  Assert.assertEquals("foo",aggregate.getSource().getReporting().getOk().getText());
  String sourceText=aggregateEntity.getSource();
  sourceText=sourceText.replace("foo","bar");
  aggregateEntity.setSource(sourceText);
  definitionDao.merge(aggregateEntity);
  aggregate=aggregateMapping.getAggregateDefinition(1L,source.getAlertName());
  Assert.assertNotNull(aggregate);
  Assert.assertEquals("bar",aggregate.getSource().getReporting().getOk().getText());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.alerts.InitialAlertEventTest </h4><pre class="type-7 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 */
@Before public void setup() throws Exception {
  m_injector=Guice.createInjector(Modules.override(new InMemoryDefaultTestModule()).with(new MockModule()));
  m_injector.getInstance(GuiceJpaInitializer.class);
  m_listener=m_injector.getInstance(MockEventListener.class);
  m_eventPublisher=m_injector.getInstance(AlertEventPublisher.class);
  EventBus synchronizedBus=EventBusSynchronizer.synchronizeAlertEventPublisher(m_injector);
  synchronizedBus.register(m_listener);
  m_definitionDao=m_injector.getInstance(AlertDefinitionDAO.class);
  m_clusters=m_injector.getInstance(Clusters.class);
  m_serviceFactory=m_injector.getInstance(ServiceFactory.class);
  m_alertsDao=m_injector.getInstance(AlertsDAO.class);
  m_clusterName="c1";
  m_clusters.addCluster(m_clusterName,new StackId("HDP","2.0.6"));
  m_cluster=m_clusters.getCluster(m_clusterName);
  Assert.assertNotNull(m_cluster);
  installHdfsService();
  Assert.assertEquals(1,m_cluster.getServices().size());
  Assert.assertEquals(6,m_definitionDao.findAll().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.AlertDataManagerTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAggregateAlerts() throws Exception {
  AlertDefinitionEntity definition=new AlertDefinitionEntity();
  definition.setDefinitionName("to_aggregate");
  definition.setLabel("My Label");
  definition.setLabel("My Description");
  definition.setServiceName(SERVICE);
  definition.setComponentName(null);
  definition.setClusterId(m_cluster.getClusterId());
  definition.setHash(UUID.randomUUID().toString());
  definition.setScheduleInterval(Integer.valueOf(60));
  definition.setScope(Scope.HOST);
  definition.setSource("{\"type\" : \"SCRIPT\"}");
  definition.setSourceType(SourceType.SCRIPT);
  m_definitionDao.create(definition);
  AlertDefinitionEntity aggDef=new AlertDefinitionEntity();
  aggDef.setDefinitionName("aggregate_test");
  aggDef.setServiceName(SERVICE);
  aggDef.setComponentName(null);
  aggDef.setClusterId(m_cluster.getClusterId());
  aggDef.setHash(UUID.randomUUID().toString());
  aggDef.setScheduleInterval(Integer.valueOf(60));
  aggDef.setScope(Scope.SERVICE);
  AggregateSource source=new AggregateSource();
  source.setAlertName("to_aggregate");
  Field field=Source.class.getDeclaredField("type");
  field.setAccessible(true);
  field.set(source,SourceType.AGGREGATE);
  Reporting reporting=new Reporting();
  ReportTemplate template=new ReportTemplate();
  template.setText("You are good {1}/{0}");
  reporting.setOk(template);
  template=new ReportTemplate();
  template.setText("Going bad {1}/{0}");
  template.setValue(Double.valueOf(0.33d));
  reporting.setWarning(template);
  template=new ReportTemplate();
  template.setText("On fire! {1}/{0}");
  template.setValue(Double.valueOf(0.66d));
  reporting.setCritical(template);
  source.setReporting(reporting);
  Gson gson=new Gson();
  aggDef.setSource(gson.toJson(source));
  aggDef.setSourceType(SourceType.AGGREGATE);
  m_definitionDao.create(aggDef);
  for (int i=0; i < 4; i++) {
    AlertHistoryEntity history=new AlertHistoryEntity();
    history.setAlertDefinition(definition);
    history.setAlertInstance(null);
    history.setAlertLabel(definition.getLabel());
    history.setAlertState(AlertState.OK);
    history.setAlertText("OK");
    history.setAlertTimestamp(Long.valueOf(1));
    history.setClusterId(m_cluster.getClusterId());
    history.setComponentName(definition.getComponentName());
    history.setHostName("h" + (i + 1));
    history.setServiceName(definition.getServiceName());
    m_dao.create(history);
    AlertCurrentEntity current=new AlertCurrentEntity();
    current.setAlertHistory(history);
    current.setLatestText(history.getAlertText());
    current.setLatestTimestamp(Long.valueOf(1L));
    current.setOriginalTimestamp(Long.valueOf(1L));
    m_dao.merge(current);
  }
  AlertEventPublisher publisher=m_injector.getInstance(AlertEventPublisher.class);
  EventBusSynchronizer.synchronizeAlertEventPublisher(m_injector);
  final AtomicReference<Alert> ref=new AtomicReference<Alert>();
  publisher.register(new TestListener(){
    @Override @Subscribe public void catchIt(    AlertReceivedEvent event){
      ref.set(event.getAlert());
    }
  }
);
  AlertAggregateListener listener=m_injector.getInstance(AlertAggregateListener.class);
  AlertDefinitionFactory factory=new AlertDefinitionFactory();
  AggregateDefinitionMapping aggregateMapping=m_injector.getInstance(AggregateDefinitionMapping.class);
  AlertDefinition aggregateDefinition=factory.coerce(aggDef);
  aggregateMapping.registerAggregate(m_cluster.getClusterId(),aggregateDefinition);
  Assert.assertEquals(aggregateDefinition,aggregateMapping.getAggregateDefinitions(m_cluster.getClusterId()).get(0));
  Assert.assertEquals(definition.getDefinitionName(),aggregateMapping.getAlertsWithAggregates(m_cluster.getClusterId()).get(0));
  AggregateSource as=(AggregateSource)aggregateDefinition.getSource();
  AlertDefinition aggregatedDefinition=aggregateMapping.getAggregateDefinition(m_cluster.getClusterId(),as.getAlertName());
  assertNotNull(aggregatedDefinition);
  Alert alert=new Alert(definition.getDefinitionName(),null,definition.getServiceName(),definition.getComponentName(),"h1",AlertState.OK);
  AlertCurrentEntity current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),"h1",definition.getDefinitionName());
  AlertStateChangeEvent event=new AlertStateChangeEvent(m_cluster.getClusterId(),alert,current,AlertState.OK);
  listener.onAlertStateChangeEvent(event);
  assertNotNull(ref.get());
  assertEquals(AlertState.OK,ref.get().getState());
  assertTrue(ref.get().getText().indexOf("0/4") > -1);
  current.getAlertHistory().setAlertState(AlertState.CRITICAL);
  m_dao.merge(current.getAlertHistory());
  listener.onAlertStateChangeEvent(event);
  assertEquals("aggregate_test",ref.get().getName());
  assertEquals(AlertState.OK,ref.get().getState());
  assertTrue(ref.get().getText().indexOf("1/4") > -1);
  current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),"h2",definition.getDefinitionName());
  current.getAlertHistory().setAlertState(AlertState.WARNING);
  m_dao.merge(current.getAlertHistory());
  listener.onAlertStateChangeEvent(event);
  assertEquals("aggregate_test",ref.get().getName());
  assertEquals(AlertState.WARNING,ref.get().getState());
  assertTrue(ref.get().getText().indexOf("2/4") > -1);
  current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),"h3",definition.getDefinitionName());
  current.getAlertHistory().setAlertState(AlertState.CRITICAL);
  m_dao.merge(current.getAlertHistory());
  listener.onAlertStateChangeEvent(event);
  assertEquals("aggregate_test",ref.get().getName());
  assertEquals(AlertState.CRITICAL,ref.get().getState());
  assertTrue(ref.get().getText().indexOf("3/4") > -1);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlertRecords(){
  Alert alert1=new Alert(ALERT_DEFINITION,null,SERVICE,COMPONENT,HOST1,AlertState.OK);
  alert1.setLabel(ALERT_LABEL);
  alert1.setText("Component component1 is OK");
  alert1.setTimestamp(1L);
  alert1.setCluster(m_cluster.getClusterName());
  Alert alert2=new Alert(ALERT_DEFINITION,null,SERVICE,COMPONENT,HOST2,AlertState.CRITICAL);
  alert2.setLabel(ALERT_LABEL);
  alert2.setText("Component component2 is not OK");
  alert2.setCluster(m_cluster.getClusterName());
  AlertReceivedListener listener=m_injector.getInstance(AlertReceivedListener.class);
  AlertReceivedEvent event1=new AlertReceivedEvent(m_cluster.getClusterId(),alert1);
  AlertReceivedEvent event2=new AlertReceivedEvent(m_cluster.getClusterId(),alert2);
  listener.onAlertEvent(event1);
  listener.onAlertEvent(event2);
  List<AlertCurrentEntity> allCurrent=m_dao.findCurrentByService(m_cluster.getClusterId(),SERVICE);
  assertEquals(2,allCurrent.size());
  List<AlertHistoryEntity> allHistory=m_dao.findAll(m_cluster.getClusterId());
  assertEquals(2,allHistory.size());
  AlertCurrentEntity current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),HOST1,ALERT_DEFINITION);
  assertNotNull(current);
  assertEquals(HOST1,current.getAlertHistory().getHostName());
  assertEquals(ALERT_DEFINITION,current.getAlertHistory().getAlertDefinition().getDefinitionName());
  assertEquals(ALERT_LABEL,current.getAlertHistory().getAlertLabel());
  assertEquals("Component component1 is OK",current.getAlertHistory().getAlertText());
  assertEquals(current.getAlertHistory().getAlertState(),AlertState.OK);
  assertEquals(1L,current.getOriginalTimestamp().longValue());
  assertEquals(1L,current.getLatestTimestamp().longValue());
  Long currentId=current.getAlertId();
  Long historyId=current.getAlertHistory().getAlertId();
  Alert alert3=new Alert(ALERT_DEFINITION,null,SERVICE,COMPONENT,HOST1,AlertState.OK);
  alert3.setLabel(ALERT_LABEL);
  alert3.setText("Component component1 is OK");
  alert3.setTimestamp(2L);
  alert3.setCluster(m_cluster.getClusterName());
  AlertReceivedEvent event3=new AlertReceivedEvent(m_cluster.getClusterId(),alert3);
  listener.onAlertEvent(event3);
  current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),HOST1,ALERT_DEFINITION);
  assertNotNull(current);
  assertEquals(currentId,current.getAlertId());
  assertEquals(historyId,current.getAlertHistory().getAlertId());
  assertEquals(HOST1,current.getAlertHistory().getHostName());
  assertEquals(ALERT_DEFINITION,current.getAlertHistory().getAlertDefinition().getDefinitionName());
  assertEquals(ALERT_LABEL,current.getAlertHistory().getAlertLabel());
  assertEquals("Component component1 is OK",current.getAlertHistory().getAlertText());
  assertEquals(current.getAlertHistory().getAlertState(),AlertState.OK);
  assertEquals(1L,current.getOriginalTimestamp().longValue());
  assertEquals(2L,current.getLatestTimestamp().longValue());
  allCurrent=m_dao.findCurrentByService(m_cluster.getClusterId(),SERVICE);
  assertEquals(2,allCurrent.size());
  allHistory=m_dao.findAll(m_cluster.getClusterId());
  assertEquals(2,allHistory.size());
  Alert alert4=new Alert(ALERT_DEFINITION,null,SERVICE,COMPONENT,HOST1,AlertState.WARNING);
  alert4.setLabel(ALERT_LABEL);
  alert4.setText("Component component1 is about to go down");
  alert4.setTimestamp(3L);
  alert4.setCluster(m_cluster.getClusterName());
  AlertReceivedEvent event4=new AlertReceivedEvent(m_cluster.getClusterId(),alert4);
  listener.onAlertEvent(event4);
  current=m_dao.findCurrentByHostAndName(m_cluster.getClusterId(),HOST1,ALERT_DEFINITION);
  assertNotNull(current);
  assertEquals(current.getAlertId(),currentId);
  assertFalse(historyId.equals(current.getAlertHistory().getAlertId()));
  assertEquals(HOST1,current.getAlertHistory().getHostName());
  assertEquals(ALERT_DEFINITION,current.getAlertHistory().getAlertDefinition().getDefinitionName());
  assertEquals(ALERT_LABEL,current.getAlertHistory().getAlertLabel());
  assertEquals("Component component1 is about to go down",current.getAlertHistory().getAlertText());
  assertEquals(current.getAlertHistory().getAlertState(),AlertState.WARNING);
  assertEquals(3L,current.getOriginalTimestamp().longValue());
  assertEquals(3L,current.getLatestTimestamp().longValue());
  allCurrent=m_dao.findCurrentByService(m_cluster.getClusterId(),SERVICE);
  assertEquals(2,allCurrent.size());
  allHistory=m_dao.findAll(m_cluster.getClusterId());
  assertEquals(3,allHistory.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClusterTest </h4><pre class="type-10 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransitionClusterVersionTransactionFail() throws Exception {
  createDefaultCluster();
  StackId stackId=new StackId("HDP","0.2");
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,"0.2","admin",RepositoryVersionState.INSTALLING);
  c1.transitionClusterVersion(stackId,"0.2",RepositoryVersionState.INSTALLED);
  c1.transitionClusterVersion(stackId,"0.2",RepositoryVersionState.UPGRADING);
  c1.transitionClusterVersion(stackId,"0.2",RepositoryVersionState.UPGRADED);
  try {
    ClusterVersionDAOMock.failOnCurrentVersionState=true;
    c1.transitionClusterVersion(stackId,"0.2",RepositoryVersionState.CURRENT);
    Assert.fail();
  }
 catch (  AmbariException e) {
  }
 finally {
    ClusterVersionDAOMock.failOnCurrentVersionState=false;
  }
  assertNotNull(c1.getCurrentClusterVersion());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteServiceWithConfigHistory() throws Exception {
  createDefaultCluster();
  c1.addService("HDFS").persist();
  Config config1=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=configFactory.createNew(c1,"core-site",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version2");
  config1.persist();
  c1.addConfig(config1);
  config2.persist();
  c1.addConfig(config2);
  Set<Config> configs=new HashSet<Config>();
  configs.add(config1);
  configs.add(config2);
  c1.addDesiredConfig("admin",configs);
  List<ServiceConfigVersionResponse> serviceConfigVersions=c1.getServiceConfigVersions();
  Assert.assertNotNull(serviceConfigVersions);
  Assert.assertEquals(1,serviceConfigVersions.size());
  Assert.assertEquals(Long.valueOf(1),serviceConfigVersions.get(0).getVersion());
  Assert.assertEquals(2,c1.getDesiredConfigs().size());
  Assert.assertEquals("version1",c1.getDesiredConfigByType("hdfs-site").getTag());
  Assert.assertEquals("version2",c1.getDesiredConfigByType("core-site").getTag());
  Map<String,Collection<ServiceConfigVersionResponse>> activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals(1,activeServiceConfigVersions.size());
  c1.deleteService("HDFS");
  Assert.assertEquals(0,c1.getServices().size());
  Assert.assertEquals(0,c1.getServiceConfigVersions().size());
  EntityManager em=injector.getProvider(EntityManager.class).get();
  Assert.assertEquals(0,em.createQuery("SELECT serviceConfig from ServiceConfigEntity serviceConfig").getResultList().size());
  Assert.assertEquals(2,em.createQuery("SELECT config from ClusterConfigEntity config").getResultList().size());
  List<ClusterConfigMappingEntity> configMappingEntities=em.createQuery("SELECT configmapping from ClusterConfigMappingEntity configmapping",ClusterConfigMappingEntity.class).getResultList();
  Assert.assertEquals(2,configMappingEntities.size());
  for (  ClusterConfigMappingEntity configMappingEntity : configMappingEntities) {
    if (StringUtils.equals(configMappingEntity.getType(),"core-site")) {
      assertEquals("core-site is not part of HDFS in test stack, should remain mapped to cluster",1,configMappingEntity.isSelected());
    }
    if (StringUtils.equals(configMappingEntity.getType(),"hdfs-site")) {
      assertEquals("hdfs-site should be unmapped from cluster when HDFS service is removed",0,configMappingEntity.isSelected());
    }
  }
  Assert.assertEquals(0,em.createNativeQuery("SELECT * from serviceconfigmapping").getResultList().size());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicClusterSetup() throws Exception {
  StackId stackVersion=new StackId("HDP-1.2.0");
  createDefaultCluster();
  String clusterName="c2";
  try {
    clusters.getCluster(clusterName);
    fail("Exception expected for invalid cluster");
  }
 catch (  Exception e) {
  }
  clusters.addCluster(clusterName,stackVersion);
  Cluster c2=clusters.getCluster(clusterName);
  Assert.assertNotNull(c2);
  Assert.assertEquals(clusterName,c2.getClusterName());
  c2.setClusterName("foo2");
  Assert.assertEquals("foo2",c2.getClusterName());
  Assert.assertNotNull(c2.getDesiredStackVersion());
  Assert.assertEquals("HDP-1.2.0",c2.getDesiredStackVersion().getStackId());
}

</code></pre>

<br>
<pre class="type-4 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDesiredConfigs() throws Exception {
  createDefaultCluster();
  Config config1=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version2");
  Config config3=configFactory.createNew(c1,"core-site",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config3.setTag("version2");
  c1.addConfig(config1);
  c1.addConfig(config2);
  c1.addConfig(config3);
  try {
    c1.addDesiredConfig(null,Collections.singleton(config1));
    fail("Cannot set a null user with config");
  }
 catch (  Exception e) {
  }
  c1.addDesiredConfig("_test1",Collections.singleton(config1));
  c1.addDesiredConfig("_test3",Collections.singleton(config3));
  Map<String,DesiredConfig> desiredConfigs=c1.getDesiredConfigs();
  Assert.assertFalse("Expect desired config not contain 'mapred-site'",desiredConfigs.containsKey("mapred-site"));
  Assert.assertTrue("Expect desired config contain " + config1.getType(),desiredConfigs.containsKey("global"));
  Assert.assertTrue("Expect desired config contain " + config3.getType(),desiredConfigs.containsKey("core-site"));
  Assert.assertEquals("Expect desired config for global should be " + config1.getTag(),config1.getTag(),desiredConfigs.get(config1.getType()).getTag());
  Assert.assertEquals("_test1",desiredConfigs.get(config1.getType()).getUser());
  Assert.assertEquals("_test3",desiredConfigs.get(config3.getType()).getUser());
  DesiredConfig dc=desiredConfigs.get(config1.getType());
  Assert.assertTrue("Expect no host-level overrides",(null == dc.getHostOverrides() || dc.getHostOverrides().size() == 0));
  c1.addDesiredConfig("_test2",Collections.singleton(config2));
  Assert.assertEquals("_test2",c1.getDesiredConfigs().get(config2.getType()).getUser());
  c1.addDesiredConfig("_test1",Collections.singleton(config1));
  Host host=clusters.getHost("h1");
  host.addDesiredConfig(c1.getClusterId(),true,"_test2",config2);
  desiredConfigs=c1.getDesiredConfigs();
  dc=desiredConfigs.get(config1.getType());
  Assert.assertNotNull("Expect host-level overrides",dc.getHostOverrides());
  Assert.assertEquals("Expect one host-level override",1,dc.getHostOverrides().size());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that hosts can be correctly transitioned into the "INSTALLING" state.
 * This method also tests that hosts in MM will not be transitioned, as per
 * the contract of{@link Cluster#transitionHostsToInstalling(ClusterVersionEntity)}.
 * @throws Exception
 */
@Test public void testTransitionHostVersions() throws Exception {
  createDefaultCluster();
  StackId stackId=new StackId("HDP","0.2");
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,"0.2","admin",RepositoryVersionState.INSTALLING);
  ClusterVersionEntity entityHDP2=null;
  for (  ClusterVersionEntity entity : c1.getAllClusterVersions()) {
    StackEntity repoVersionStackEntity=entity.getRepositoryVersion().getStack();
    StackId repoVersionStackId=new StackId(repoVersionStackEntity);
    if (repoVersionStackId.getStackName().equals("HDP") && repoVersionStackId.getStackVersion().equals("0.2")) {
      entityHDP2=entity;
      break;
    }
  }
  assertNotNull(entityHDP2);
  List<HostVersionEntity> hostVersionsH1Before=hostVersionDAO.findByClusterAndHost("c1","h1");
  assertEquals(1,hostVersionsH1Before.size());
  c1.transitionHostsToInstalling(entityHDP2);
  List<HostVersionEntity> hostVersionsH1After=hostVersionDAO.findByClusterAndHost("c1","h1");
  assertEquals(2,hostVersionsH1After.size());
  boolean checked=false;
  for (  HostVersionEntity entity : hostVersionsH1After) {
    StackEntity repoVersionStackEntity=entity.getRepositoryVersion().getStack();
    if (repoVersionStackEntity.getStackName().equals("HDP") && repoVersionStackEntity.getStackVersion().equals("0.2")) {
      assertEquals(RepositoryVersionState.INSTALLING,entity.getState());
      checked=true;
      break;
    }
  }
  assertTrue(checked);
  c1.transitionHostsToInstalling(entityHDP2);
  hostVersionsH1After=hostVersionDAO.findByClusterAndHost("c1","h1");
  assertEquals(2,hostVersionsH1After.size());
  checked=false;
  for (  HostVersionEntity entity : hostVersionsH1After) {
    StackEntity repoVersionStackEntity=entity.getRepositoryVersion().getStack();
    if (repoVersionStackEntity.getStackName().equals("HDP") && repoVersionStackEntity.getStackVersion().equals("0.2")) {
      assertEquals(RepositoryVersionState.INSTALLING,entity.getState());
      checked=true;
      break;
    }
  }
  assertTrue(checked);
  List<HostVersionEntity> hostVersionEntities=hostVersionDAO.findAll();
  for (  HostVersionEntity hostVersionEntity : hostVersionEntities) {
    hostVersionEntity.setState(RepositoryVersionState.INSTALL_FAILED);
    hostVersionDAO.merge(hostVersionEntity);
  }
  hostVersionEntities=hostVersionDAO.findAll();
  for (  HostVersionEntity hostVersionEntity : hostVersionEntities) {
    assertEquals(RepositoryVersionState.INSTALL_FAILED,hostVersionEntity.getState());
  }
  Collection<Host> hosts=c1.getHosts();
  Iterator<Host> iterator=hosts.iterator();
  Host hostInMaintenanceMode=iterator.next();
  Host hostNotInMaintenanceMode=iterator.next();
  hostInMaintenanceMode.setMaintenanceState(c1.getClusterId(),MaintenanceState.ON);
  c1.transitionHostsToInstalling(entityHDP2);
  List<HostVersionEntity> hostInMaintModeVersions=hostVersionDAO.findByClusterAndHost("c1",hostInMaintenanceMode.getHostName());
  List<HostVersionEntity> otherHostVersions=hostVersionDAO.findByClusterAndHost("c1",hostNotInMaintenanceMode.getHostName());
  for (  HostVersionEntity hostVersionEntity : hostInMaintModeVersions) {
    StackEntity repoVersionStackEntity=hostVersionEntity.getRepositoryVersion().getStack();
    if (repoVersionStackEntity.getStackName().equals("HDP") && repoVersionStackEntity.getStackVersion().equals("0.2")) {
      assertEquals(RepositoryVersionState.OUT_OF_SYNC,hostVersionEntity.getState());
    }
  }
  for (  HostVersionEntity hostVersionEntity : otherHostVersions) {
    StackEntity repoVersionStackEntity=hostVersionEntity.getRepositoryVersion().getStack();
    if (repoVersionStackEntity.getStackName().equals("HDP") && repoVersionStackEntity.getStackVersion().equals("0.2")) {
      assertEquals(RepositoryVersionState.INSTALLING,hostVersionEntity.getState());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceConfigVersions() throws Exception {
  createDefaultCluster();
  Config config1=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version2");
  c1.addConfig(config1);
  c1.addConfig(config2);
  c1.addDesiredConfig("admin",Collections.singleton(config1));
  List<ServiceConfigVersionResponse> serviceConfigVersions=c1.getServiceConfigVersions();
  Assert.assertNotNull(serviceConfigVersions);
  Assert.assertEquals(1,serviceConfigVersions.size());
  Map<String,Collection<ServiceConfigVersionResponse>> activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals(1,activeServiceConfigVersions.size());
  ServiceConfigVersionResponse hdfsResponse=activeServiceConfigVersions.get("HDFS").iterator().next();
  Assert.assertEquals("HDFS",hdfsResponse.getServiceName());
  Assert.assertEquals("c1",hdfsResponse.getClusterName());
  Assert.assertEquals("admin",hdfsResponse.getUserName());
  Assert.assertEquals("default",hdfsResponse.getGroupName());
  Assert.assertEquals(Long.valueOf(-1),hdfsResponse.getGroupId());
  Assert.assertEquals(Long.valueOf(1),hdfsResponse.getVersion());
  c1.addDesiredConfig("admin",Collections.singleton(config2));
  serviceConfigVersions=c1.getServiceConfigVersions();
  Assert.assertNotNull(serviceConfigVersions);
  Assert.assertEquals(2,serviceConfigVersions.size());
  activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals(1,activeServiceConfigVersions.size());
  hdfsResponse=activeServiceConfigVersions.get("HDFS").iterator().next();
  Assert.assertEquals("HDFS",hdfsResponse.getServiceName());
  Assert.assertEquals("c1",hdfsResponse.getClusterName());
  Assert.assertEquals("admin",hdfsResponse.getUserName());
  assertEquals(Long.valueOf(2),hdfsResponse.getVersion());
  c1.setServiceConfigVersion("HDFS",1L,"admin","test_note");
  serviceConfigVersions=c1.getServiceConfigVersions();
  Assert.assertNotNull(serviceConfigVersions);
  Assert.assertEquals(3,serviceConfigVersions.size());
  activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals(1,activeServiceConfigVersions.size());
  hdfsResponse=activeServiceConfigVersions.get("HDFS").iterator().next();
  Assert.assertEquals("HDFS",hdfsResponse.getServiceName());
  Assert.assertEquals("c1",hdfsResponse.getClusterName());
  Assert.assertEquals("admin",hdfsResponse.getUserName());
  assertEquals(Long.valueOf(3),hdfsResponse.getVersion());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testClusterRecovery() throws AmbariException {
  ClusterEntity entity=createDummyData();
  ClusterStateEntity clusterStateEntity=new ClusterStateEntity();
  clusterStateEntity.setCurrentStack(entity.getDesiredStack());
  entity.setClusterStateEntity(clusterStateEntity);
  ClusterImpl cluster=new ClusterImpl(entity,injector);
  Service service=cluster.getService("HDFS");
  Assert.assertEquals("HDFS",service.getName());
  Map<String,Service> services=cluster.getServices();
  Assert.assertNotNull(services.get("HDFS"));
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBootstrapHostVersion() throws Exception {
  String clusterName="c1";
  String v1="2.2.0-123";
  StackId stackId=new StackId("HDP-2.2.0");
  RepositoryVersionEntity rv1=helper.getOrCreateRepositoryVersion(stackId,v1);
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","5.9");
  Cluster cluster=createClusterForRU(clusterName,stackId,hostAttributes);
  Host deadHost=cluster.getHosts().iterator().next();
  deadHost.setState(HostState.UNHEALTHY);
  int versionedComponentCount=0;
  List<HostComponentStateEntity> hostComponentStates=hostComponentStateDAO.findAll();
  for (int i=0; i < hostComponentStates.size(); i++) {
    HostComponentStateEntity hce=hostComponentStates.get(i);
    ComponentInfo compInfo=metaInfo.getComponent(stackId.getStackName(),stackId.getStackVersion(),hce.getServiceName(),hce.getComponentName());
    if (hce.getHostName().equals(deadHost.getHostName())) {
      continue;
    }
    if (compInfo.isVersionAdvertised()) {
      hce.setVersion(v1);
      hostComponentStateDAO.merge(hce);
      versionedComponentCount++;
    }
    Service svc=cluster.getService(hce.getServiceName());
    ServiceComponent svcComp=svc.getServiceComponent(hce.getComponentName());
    ServiceComponentHost scHost=svcComp.getServiceComponentHost(hce.getHostName());
    scHost.recalculateHostVersionState();
    cluster.recalculateClusterVersionState(rv1);
    Collection<ClusterVersionEntity> clusterVersions=cluster.getAllClusterVersions();
    if (versionedComponentCount > 0) {
      RepositoryVersionEntity repositoryVersion=repositoryVersionDAO.findByStackAndVersion(stackId,v1);
      Assert.assertNotNull(repositoryVersion);
      Assert.assertTrue(clusterVersions != null && clusterVersions.size() == 1);
      if (versionedComponentCount == 1 && i < (hostComponentStates.size() - 1)) {
        Assert.assertEquals(clusterVersions.iterator().next().getState(),RepositoryVersionState.CURRENT);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleServiceVersionForMultipleConfigs() throws Exception {
  createDefaultCluster();
  Config config1=configFactory.createNew(c1,"hdfs-site",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("version1");
  Config config2=configFactory.createNew(c1,"core-site",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("version2");
  c1.addConfig(config1);
  c1.addConfig(config2);
  Set<Config> configs=new HashSet<Config>();
  configs.add(config1);
  configs.add(config2);
  c1.addDesiredConfig("admin",configs);
  List<ServiceConfigVersionResponse> serviceConfigVersions=c1.getServiceConfigVersions();
  Assert.assertNotNull(serviceConfigVersions);
  Assert.assertEquals(1,serviceConfigVersions.size());
  Assert.assertEquals(Long.valueOf(1),serviceConfigVersions.get(0).getVersion());
  Assert.assertEquals(2,c1.getDesiredConfigs().size());
  Assert.assertEquals("version1",c1.getDesiredConfigByType("hdfs-site").getTag());
  Assert.assertEquals("version2",c1.getDesiredConfigByType("core-site").getTag());
  Map<String,Collection<ServiceConfigVersionResponse>> activeServiceConfigVersions=c1.getActiveServiceConfigVersions();
  Assert.assertEquals(1,activeServiceConfigVersions.size());
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Comprehensive test for transitionHostVersion and recalculateClusterVersion.
 * It creates a cluster with 3 hosts and 3 services, one of which does not advertise a version.
 * It then verifies that all 3 hosts have a version of CURRENT, and so does the cluster.
 * It then adds one more host with a component, so its HostVersion will initialize in CURRENT.
 * Next, it distributes a repo so that it is INSTALLED on the 4 hosts.
 * It then adds one more host, whose HostVersion will be OUT_OF_SYNC for the new repo.
 * After redistributing bits again, it simulates an RU.
 * Finally, some of the hosts will end up with a HostVersion in UPGRADED, and others still in INSTALLED.
 * @throws Exception
 */
@Test public void testTransitionHostVersionAdvanced() throws Exception {
  String clusterName="c1";
  String v1="2.2.0-123";
  StackId stackId=new StackId("HDP-2.2.0");
  RepositoryVersionEntity rv1=helper.getOrCreateRepositoryVersion(stackId,v1);
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","5.9");
  Cluster cluster=createClusterForRU(clusterName,stackId,hostAttributes);
  int versionedComponentCount=0;
  List<HostComponentStateEntity> hostComponentStates=hostComponentStateDAO.findAll();
  for (int i=0; i < hostComponentStates.size(); i++) {
    HostComponentStateEntity hce=hostComponentStates.get(i);
    ComponentInfo compInfo=metaInfo.getComponent(stackId.getStackName(),stackId.getStackVersion(),hce.getServiceName(),hce.getComponentName());
    if (compInfo.isVersionAdvertised()) {
      hce.setVersion(v1);
      hostComponentStateDAO.merge(hce);
      versionedComponentCount++;
    }
    Service svc=cluster.getService(hce.getServiceName());
    ServiceComponent svcComp=svc.getServiceComponent(hce.getComponentName());
    ServiceComponentHost scHost=svcComp.getServiceComponentHost(hce.getHostName());
    scHost.recalculateHostVersionState();
    cluster.recalculateClusterVersionState(rv1);
    Collection<ClusterVersionEntity> clusterVersions=cluster.getAllClusterVersions();
    if (versionedComponentCount > 0) {
      RepositoryVersionEntity repositoryVersion=repositoryVersionDAO.findByStackAndVersion(stackId,v1);
      Assert.assertNotNull(repositoryVersion);
      Assert.assertTrue(clusterVersions != null && clusterVersions.size() == 1);
      if (versionedComponentCount == 1 && i < (hostComponentStates.size() - 1)) {
        Assert.assertEquals(clusterVersions.iterator().next().getState(),RepositoryVersionState.UPGRADING);
      }
      if (i == hostComponentStates.size() - 1) {
        Assert.assertEquals(clusterVersions.iterator().next().getState(),RepositoryVersionState.CURRENT);
      }
    }
  }
  addHost("h-4",hostAttributes);
  clusters.mapHostToCluster("h-4",clusterName);
  Service svc2=cluster.getService("ZOOKEEPER");
  Service svc3=cluster.getService("GANGLIA");
  ServiceComponent sc2CompA=svc2.getServiceComponent("ZOOKEEPER_SERVER");
  ServiceComponent sc2CompB=svc2.getServiceComponent("ZOOKEEPER_CLIENT");
  ServiceComponent sc3CompB=svc3.getServiceComponent("GANGLIA_MONITOR");
  ServiceComponentHost schHost4Serv2CompA=serviceComponentHostFactory.createNew(sc2CompA,"h-4");
  ServiceComponentHost schHost4Serv2CompB=serviceComponentHostFactory.createNew(sc2CompB,"h-4");
  ServiceComponentHost schHost4Serv3CompB=serviceComponentHostFactory.createNew(sc3CompB,"h-4");
  sc2CompA.addServiceComponentHost(schHost4Serv2CompA);
  sc2CompB.addServiceComponentHost(schHost4Serv2CompB);
  sc3CompB.addServiceComponentHost(schHost4Serv3CompB);
  schHost4Serv2CompA.persist();
  schHost4Serv2CompB.persist();
  schHost4Serv3CompB.persist();
  simulateStackVersionListener(stackId,v1,cluster,hostComponentStateDAO.findByHost("h-4"));
  Collection<HostVersionEntity> hostVersions=hostVersionDAO.findAll();
  Assert.assertEquals(hostVersions.size(),clusters.getHosts().size());
  HostVersionEntity h4Version1=hostVersionDAO.findByClusterStackVersionAndHost(clusterName,stackId,v1,"h-4");
  Assert.assertNotNull(h4Version1);
  Assert.assertEquals(h4Version1.getState(),RepositoryVersionState.CURRENT);
  String v2="2.2.0-456";
  RepositoryVersionEntity rv2=helper.getOrCreateRepositoryVersion(stackId,v2);
  for (  String hostName : clusters.getHostsForCluster(clusterName).keySet()) {
    HostEntity host=hostDAO.findByName(hostName);
    HostVersionEntity hve=new HostVersionEntity(host,rv2,RepositoryVersionState.INSTALLED);
    hostVersionDAO.create(hve);
  }
  cluster.createClusterVersion(stackId,v2,"admin",RepositoryVersionState.INSTALLING);
  cluster.transitionClusterVersion(stackId,v2,RepositoryVersionState.INSTALLED);
  ClusterVersionEntity cv2=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,stackId,v2);
  Assert.assertNotNull(cv2);
  Assert.assertEquals(cv2.getState(),RepositoryVersionState.INSTALLED);
  addHost("h-5",hostAttributes);
  clusters.mapHostToCluster("h-5",clusterName);
  ServiceComponentHost schHost5Serv3CompB=serviceComponentHostFactory.createNew(sc3CompB,"h-5");
  sc3CompB.addServiceComponentHost(schHost5Serv3CompB);
  schHost5Serv3CompB.persist();
  HostVersionEntity h5Version2=hostVersionDAO.findByClusterStackVersionAndHost(clusterName,stackId,v2,"h-5");
  Assert.assertNotNull(h5Version2);
  Assert.assertEquals(h5Version2.getState(),RepositoryVersionState.OUT_OF_SYNC);
  h5Version2.setState(RepositoryVersionState.INSTALLED);
  hostVersionDAO.merge(h5Version2);
  versionedComponentCount=0;
  hostComponentStates=hostComponentStateDAO.findAll();
  for (int i=0; i < hostComponentStates.size(); i++) {
    HostComponentStateEntity hce=hostComponentStates.get(i);
    ComponentInfo compInfo=metaInfo.getComponent(stackId.getStackName(),stackId.getStackVersion(),hce.getServiceName(),hce.getComponentName());
    if (compInfo.isVersionAdvertised()) {
      hce.setVersion(v2);
      hostComponentStateDAO.merge(hce);
      versionedComponentCount++;
    }
    Service svc=cluster.getService(hce.getServiceName());
    ServiceComponent svcComp=svc.getServiceComponent(hce.getComponentName());
    ServiceComponentHost scHost=svcComp.getServiceComponentHost(hce.getHostName());
    scHost.recalculateHostVersionState();
    cluster.recalculateClusterVersionState(rv2);
    Collection<ClusterVersionEntity> clusterVersions=cluster.getAllClusterVersions();
    if (versionedComponentCount > 0) {
      RepositoryVersionEntity repositoryVersion=repositoryVersionDAO.findByStackAndVersion(stackId,v2);
      Assert.assertNotNull(repositoryVersion);
      Assert.assertTrue(clusterVersions != null && clusterVersions.size() == 2);
      if (versionedComponentCount == 1 && i < (hostComponentStates.size() - 1)) {
        cv2=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,stackId,v2);
        Assert.assertEquals(cv2.getState(),RepositoryVersionState.UPGRADING);
      }
    }
  }
  cv2=clusterVersionDAO.findByClusterAndStackAndVersion(clusterName,stackId,v2);
  Assert.assertEquals(cv2.getState(),RepositoryVersionState.UPGRADING);
  Collection<HostVersionEntity> v2HostVersions=hostVersionDAO.findByClusterStackAndVersion(clusterName,stackId,v2);
  Assert.assertEquals(v2HostVersions.size(),clusters.getHostsForCluster(clusterName).size());
  for (  HostVersionEntity hve : v2HostVersions) {
    if (hve.getHostName().equals("h-3") || hve.getHostName().equals("h-5")) {
      Assert.assertEquals(hve.getState(),RepositoryVersionState.INSTALLED);
    }
 else {
      Assert.assertEquals(hve.getState(),RepositoryVersionState.UPGRADED);
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAndSetConfigs() throws Exception {
  createDefaultCluster();
  Map<String,Map<String,String>> c1PropAttributes=new HashMap<String,Map<String,String>>();
  c1PropAttributes.put("final",new HashMap<String,String>());
  c1PropAttributes.get("final").put("a","true");
  Map<String,Map<String,String>> c2PropAttributes=new HashMap<String,Map<String,String>>();
  c2PropAttributes.put("final",new HashMap<String,String>());
  c2PropAttributes.get("final").put("x","true");
  Config config1=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,c1PropAttributes);
  config1.setTag("version1");
  Config config2=configFactory.createNew(c1,"global",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,c2PropAttributes);
  config2.setTag("version2");
  Config config3=configFactory.createNew(c1,"core-site",new HashMap<String,String>(){
{
      put("x","y");
    }
  }
,new HashMap<String,Map<String,String>>());
  config3.setTag("version2");
  c1.addConfig(config1);
  c1.addConfig(config2);
  c1.addConfig(config3);
  c1.addDesiredConfig("_test",Collections.singleton(config1));
  Config res=c1.getDesiredConfigByType("global");
  Assert.assertNotNull("Expected non-null config",res);
  Assert.assertEquals("true",res.getPropertiesAttributes().get("final").get("a"));
  res=c1.getDesiredConfigByType("core-site");
  Assert.assertNull("Expected null config",res);
  c1.addDesiredConfig("_test",Collections.singleton(config2));
  res=c1.getDesiredConfigByType("global");
  Assert.assertEquals("Expected version tag to be 'version2'","version2",res.getTag());
  Assert.assertEquals("true",res.getPropertiesAttributes().get("final").get("x"));
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetServices() throws Exception {
  createDefaultCluster();
  Service s1=serviceFactory.createNew(c1,"HDFS");
  Service s2=serviceFactory.createNew(c1,"MAPREDUCE");
  c1.addService(s1);
  c1.addService(s2);
  s1.persist();
  s2.persist();
  Service s3=serviceFactory.createNew(c1,"MAPREDUCE");
  try {
    c1.addService(s3);
    fail("Expected error on adding dup service");
  }
 catch (  Exception e) {
  }
  Service s=c1.getService("HDFS");
  Assert.assertNotNull(s);
  Assert.assertEquals("HDFS",s.getName());
  Assert.assertEquals(c1.getClusterId(),s.getClusterId());
  try {
    c1.getService("HBASE");
    fail("Expected error for unknown service");
  }
 catch (  Exception e) {
  }
  Map<String,Service> services=c1.getServices();
  Assert.assertEquals(2,services.size());
  Assert.assertTrue(services.containsKey("HDFS"));
  Assert.assertTrue(services.containsKey("MAPREDUCE"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.cluster.ClustersTest </h4><pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClusterHostMapping() throws AmbariException {
  String c1="c1";
  String c2="c2";
  String h1="h1";
  String h2="h2";
  String h3="h3";
  String h4="h4";
  try {
    clusters.mapHostToCluster(h1,c1);
    fail("Expected exception for invalid cluster/host");
  }
 catch (  Exception e) {
  }
  StackId stackId=new StackId("HDP-0.1");
  clusters.addCluster(c1,stackId);
  clusters.addCluster(c2,stackId);
  Cluster cluster1=clusters.getCluster(c1);
  Cluster cluster2=clusters.getCluster(c2);
  Assert.assertNotNull(clusters.getCluster(c1));
  Assert.assertNotNull(clusters.getCluster(c2));
  cluster1.setDesiredStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  cluster1.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  cluster2.setDesiredStackVersion(stackId);
  cluster2.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  cluster2.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  try {
    clusters.mapHostToCluster(h1,c1);
    fail("Expected exception for invalid host");
  }
 catch (  Exception e) {
  }
  clusters.addHost(h1);
  clusters.addHost(h2);
  clusters.addHost(h3);
  Assert.assertNotNull(clusters.getHost(h1));
  setOsFamily(clusters.getHost(h1),"redhat","6.4");
  setOsFamily(clusters.getHost(h2),"redhat","5.9");
  setOsFamily(clusters.getHost(h3),"redhat","6.4");
  clusters.getHost(h1).persist();
  clusters.getHost(h2).persist();
  clusters.getHost(h3).persist();
  try {
    clusters.getClustersForHost(h4);
    fail("Expected exception for invalid host");
  }
 catch (  HostNotFoundException e) {
  }
  Set<Cluster> c=clusters.getClustersForHost(h3);
  Assert.assertEquals(0,c.size());
  clusters.mapHostToCluster(h1,c1);
  clusters.mapHostToCluster(h2,c1);
  try {
    clusters.mapHostToCluster(h1,c1);
    fail("Expected exception for duplicate");
  }
 catch (  DuplicateResourceException e) {
  }
  Cluster c3=(Cluster)clusters.getClustersForHost(h1).toArray()[0];
  Cluster c4=(Cluster)clusters.getClustersForHost(h2).toArray()[0];
  Assert.assertEquals(c3,c4);
  Set<String> hostnames=new HashSet<String>();
  hostnames.add(h1);
  hostnames.add(h2);
  clusters.mapHostsToCluster(hostnames,c2);
  c=clusters.getClustersForHost(h1);
  Assert.assertEquals(2,c.size());
  c=clusters.getClustersForHost(h2);
  Assert.assertEquals(2,c.size());
  Map<String,Host> hostsForC1=clusters.getHostsForCluster(c1);
  Assert.assertEquals(2,hostsForC1.size());
  Assert.assertTrue(hostsForC1.containsKey(h1));
  Assert.assertTrue(hostsForC1.containsKey(h2));
  Assert.assertNotNull(hostsForC1.get(h1));
  Assert.assertNotNull(hostsForC1.get(h2));
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetHost() throws AmbariException {
  String h1="h1";
  String h2="h2";
  String h3="h3";
  clusters.addHost(h1);
  try {
    clusters.addHost(h1);
    fail("Expected exception on duplicate host entry");
  }
 catch (  Exception e) {
  }
  clusters.addHost(h2);
  clusters.addHost(h3);
  List<Host> hosts=clusters.getHosts();
  Assert.assertEquals(3,hosts.size());
  Assert.assertNotNull(clusters.getHost(h1));
  Assert.assertNotNull(clusters.getHost(h2));
  Assert.assertNotNull(clusters.getHost(h3));
  Host h=clusters.getHost(h2);
  Assert.assertNotNull(h);
  try {
    clusters.getHost("foo");
    fail("Expected error for unknown host");
  }
 catch (  HostNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetCluster() throws AmbariException {
  StackId stackId=new StackId("HDP-2.1.1");
  String c1="foo";
  String c2="foo";
  clusters.addCluster(c1,stackId);
  try {
    clusters.addCluster(c1,stackId);
    fail("Exception should be thrown on invalid add");
  }
 catch (  AmbariException e) {
  }
  try {
    clusters.addCluster(c2,stackId);
    fail("Exception should be thrown on invalid add");
  }
 catch (  AmbariException e) {
  }
  c2="foo2";
  clusters.addCluster(c2,stackId);
  Assert.assertNotNull(clusters.getCluster(c1));
  Assert.assertNotNull(clusters.getCluster(c2));
  Assert.assertEquals(c1,clusters.getCluster(c1).getClusterName());
  Assert.assertEquals(c2,clusters.getCluster(c2).getClusterName());
  Map<String,Cluster> verifyClusters=clusters.getClusters();
  Assert.assertTrue(verifyClusters.containsKey(c1));
  Assert.assertTrue(verifyClusters.containsKey(c2));
  Assert.assertNotNull(verifyClusters.get(c1));
  Assert.assertNotNull(verifyClusters.get(c2));
  Cluster c=clusters.getCluster(c1);
  c.setClusterName("foobar");
  long cId=c.getClusterId();
  Cluster changed=clusters.getCluster("foobar");
  Assert.assertNotNull(changed);
  Assert.assertEquals(cId,changed.getClusterId());
  Assert.assertEquals("foobar",clusters.getClusterById(cId).getClusterName());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDebugDump() throws AmbariException {
  String c1="c1";
  String c2="c2";
  String h1="h1";
  String h2="h2";
  String h3="h3";
  StackId stackId=new StackId("HDP-0.1");
  clusters.addCluster(c1,stackId);
  clusters.addCluster(c2,stackId);
  Cluster cluster1=clusters.getCluster(c1);
  Cluster cluster2=clusters.getCluster(c2);
  Assert.assertNotNull(clusters.getCluster(c1));
  Assert.assertNotNull(clusters.getCluster(c2));
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  cluster1.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  cluster2.setDesiredStackVersion(stackId);
  cluster2.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  cluster2.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  clusters.addHost(h1);
  clusters.addHost(h2);
  clusters.addHost(h3);
  setOsFamily(clusters.getHost(h1),"redhat","6.4");
  setOsFamily(clusters.getHost(h2),"redhat","5.9");
  setOsFamily(clusters.getHost(h3),"redhat","6.4");
  clusters.getHost(h1).persist();
  clusters.getHost(h2).persist();
  clusters.getHost(h3).persist();
  clusters.mapHostToCluster(h1,c1);
  clusters.mapHostToCluster(h2,c1);
  StringBuilder sb=new StringBuilder();
  clusters.debugDump(sb);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteCluster() throws Exception {
  String c1="c1";
  final String h1="h1";
  final String h2="h2";
  StackId stackId=new StackId("HDP-0.1");
  clusters.addCluster(c1,stackId);
  Cluster cluster=clusters.getCluster(c1);
  cluster.setDesiredStackVersion(stackId);
  cluster.setCurrentStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  cluster.transitionClusterVersion(stackId,stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  final Config config1=injector.getInstance(ConfigFactory.class).createNew(cluster,"t1",new HashMap<String,String>(){
{
      put("prop1","val1");
    }
  }
,new HashMap<String,Map<String,String>>());
  config1.setTag("1");
  config1.persist();
  Config config2=injector.getInstance(ConfigFactory.class).createNew(cluster,"t1",new HashMap<String,String>(){
{
      put("prop2","val2");
    }
  }
,new HashMap<String,Map<String,String>>());
  config2.setTag("2");
  config2.persist();
  cluster.addDesiredConfig("_test",Collections.singleton(config1));
  clusters.addHost(h1);
  clusters.addHost(h2);
  Host host1=clusters.getHost(h1);
  Host host2=clusters.getHost(h2);
  setOsFamily(clusters.getHost(h1),"centos","5.9");
  setOsFamily(clusters.getHost(h2),"centos","5.9");
  host1.persist();
  host2.persist();
  clusters.mapHostsToCluster(new HashSet<String>(){
{
      addAll(Arrays.asList(h1,h2));
    }
  }
,c1);
  host1.addDesiredConfig(cluster.getClusterId(),true,"_test",config2);
  host1.persist();
  Service hdfs=cluster.addService("HDFS");
  hdfs.persist();
  Assert.assertNotNull(injector.getInstance(ClusterServiceDAO.class).findByClusterAndServiceNames(c1,"HDFS"));
  ServiceComponent nameNode=hdfs.addServiceComponent("NAMENODE");
  nameNode.persist();
  ServiceComponent dataNode=hdfs.addServiceComponent("DATANODE");
  dataNode.persist();
  ServiceComponent serviceCheckNode=hdfs.addServiceComponent("HDFS_CLIENT");
  serviceCheckNode.persist();
  ServiceComponentHost nameNodeHost=nameNode.addServiceComponentHost(h1);
  nameNodeHost.persist();
  HostEntity nameNodeHostEntity=hostDAO.findByName(nameNodeHost.getHostName());
  Assert.assertNotNull(nameNodeHostEntity);
  ServiceComponentHost dataNodeHost=dataNode.addServiceComponentHost(h2);
  dataNodeHost.persist();
  ServiceComponentHost serviceCheckNodeHost=serviceCheckNode.addServiceComponentHost(h2);
  serviceCheckNodeHost.persist();
  serviceCheckNodeHost.setState(State.UNKNOWN);
  HostComponentDesiredStateEntityPK hkdspk=new HostComponentDesiredStateEntityPK();
  hkdspk.setClusterId(nameNodeHost.getClusterId());
  hkdspk.setHostId(nameNodeHostEntity.getHostId());
  hkdspk.setServiceName(nameNodeHost.getServiceName());
  hkdspk.setComponentName(nameNodeHost.getServiceComponentName());
  Assert.assertNotNull(injector.getInstance(HostComponentStateDAO.class).findByIndex(nameNodeHost.getClusterId(),nameNodeHost.getServiceName(),nameNodeHost.getServiceComponentName(),nameNodeHostEntity.getHostId()));
  Assert.assertNotNull(injector.getInstance(HostComponentDesiredStateDAO.class).findByPK(hkdspk));
  Assert.assertEquals(2,injector.getProvider(EntityManager.class).get().createQuery("SELECT config FROM ClusterConfigEntity config").getResultList().size());
  Assert.assertEquals(1,injector.getProvider(EntityManager.class).get().createQuery("SELECT state FROM ClusterStateEntity state").getResultList().size());
  Assert.assertEquals(1,injector.getProvider(EntityManager.class).get().createQuery("SELECT config FROM ClusterConfigMappingEntity config").getResultList().size());
  Blueprint bp=createNiceMock(Blueprint.class);
  expect(bp.getName()).andReturn("TestBluePrint").anyTimes();
  Configuration clusterConfig=new Configuration(Maps.<String,Map<String,String>>newHashMap(),Maps.<String,Map<String,Map<String,String>>>newHashMap());
  Map<String,HostGroupInfo> hostGroups=Maps.newHashMap();
  TopologyRequest topologyRequest=createNiceMock(TopologyRequest.class);
  expect(topologyRequest.getType()).andReturn(TopologyRequest.Type.PROVISION).anyTimes();
  expect(topologyRequest.getBlueprint()).andReturn(bp).anyTimes();
  expect(topologyRequest.getClusterId()).andReturn(cluster.getClusterId()).anyTimes();
  expect(topologyRequest.getConfiguration()).andReturn(clusterConfig).anyTimes();
  expect(topologyRequest.getDescription()).andReturn("Test description").anyTimes();
  expect(topologyRequest.getHostGroupInfo()).andReturn(hostGroups).anyTimes();
  replay(bp,topologyRequest);
  persistedState.persistTopologyRequest(topologyRequest);
  Assert.assertEquals(1,topologyRequestDAO.findByClusterId(cluster.getClusterId()).size());
  clusters.deleteCluster(c1);
  Assert.assertEquals(2,hostDAO.findAll().size());
  Assert.assertNull(injector.getInstance(HostComponentStateDAO.class).findByIndex(nameNodeHost.getClusterId(),nameNodeHost.getServiceName(),nameNodeHost.getServiceComponentName(),nameNodeHostEntity.getHostId()));
  Assert.assertNull(injector.getInstance(HostComponentDesiredStateDAO.class).findByPK(hkdspk));
  Assert.assertEquals(0,injector.getProvider(EntityManager.class).get().createQuery("SELECT config FROM ClusterConfigEntity config").getResultList().size());
  Assert.assertEquals(0,injector.getProvider(EntityManager.class).get().createQuery("SELECT state FROM ClusterStateEntity state").getResultList().size());
  Assert.assertEquals(0,injector.getProvider(EntityManager.class).get().createQuery("SELECT config FROM ClusterConfigMappingEntity config").getResultList().size());
  Assert.assertEquals(0,topologyRequestDAO.findByClusterId(cluster.getClusterId()).size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAndGetClusterWithSecurityType() throws AmbariException {
  StackId stackId=new StackId("HDP-2.1.1");
  String c1="foo";
  SecurityType securityType=SecurityType.KERBEROS;
  clusters.addCluster(c1,stackId,securityType);
  Assert.assertNotNull(clusters.getCluster(c1));
  Assert.assertEquals(c1,clusters.getCluster(c1).getClusterName());
  Assert.assertEquals(securityType,clusters.getCluster(c1).getSecurityType());
}

</code></pre>

<br>
<pre class="type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetCurrentStackVersion() throws AmbariException {
  String c1="foo3";
  try {
    clusters.setCurrentStackVersion("",null);
    fail("Exception should be thrown on invalid set");
  }
 catch (  AmbariException e) {
  }
  try {
    clusters.setCurrentStackVersion(c1,null);
    fail("Exception should be thrown on invalid set");
  }
 catch (  AmbariException e) {
  }
  StackId stackId=new StackId("HDP-0.1");
  try {
    clusters.setCurrentStackVersion(c1,stackId);
    fail("Exception should be thrown on invalid set");
  }
 catch (  AmbariException e) {
    Assert.assertTrue(e.getMessage().contains("Cluster not found"));
  }
  clusters.addCluster(c1,stackId);
  clusters.setCurrentStackVersion(c1,stackId);
  Assert.assertNotNull(clusters.getCluster(c1));
  ClusterStateEntity entity=injector.getInstance(ClusterStateDAO.class).findByPK(clusters.getCluster(c1).getClusterId());
  Assert.assertNotNull(entity);
  Assert.assertTrue(entity.getCurrentStack().getStackName().equals(stackId.getStackName()) && entity.getCurrentStack().getStackVersion().equals(stackId.getStackVersion()));
  Assert.assertTrue(clusters.getCluster(c1).getCurrentStackVersion().getStackName().equals(stackId.getStackName()));
  Assert.assertTrue(clusters.getCluster(c1).getCurrentStackVersion().getStackVersion().equals(stackId.getStackVersion()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.host.HostTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostMaintenance() throws Exception {
  AmbariMetaInfo metaInfo=injector.getInstance(AmbariMetaInfo.class);
  StackId stackId=new StackId("HDP-0.1");
  clusters.addCluster("c1",stackId);
  Cluster c1=clusters.getCluster("c1");
  Assert.assertEquals("c1",c1.getClusterName());
  Assert.assertEquals(1,c1.getClusterId());
  clusters.addHost("h1");
  Host host=clusters.getHost("h1");
  host.setIPv4("ipv4");
  host.setIPv6("ipv6");
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","6.3");
  host.setHostAttributes(hostAttributes);
  host.persist();
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  c1.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  c1.setDesiredStackVersion(stackId);
  clusters.mapHostToCluster("h1","c1");
  HostEntity entity=hostDAO.findByName("h1");
  HostStateEntity stateEntity=entity.getHostStateEntity();
  Assert.assertNull(stateEntity.getMaintenanceState());
  Assert.assertEquals(MaintenanceState.OFF,host.getMaintenanceState(c1.getClusterId()));
  host.setMaintenanceState(c1.getClusterId(),MaintenanceState.ON);
  entity=hostDAO.findByName("h1");
  stateEntity=entity.getHostStateEntity();
  Assert.assertNotNull(stateEntity.getMaintenanceState());
  Assert.assertEquals(MaintenanceState.ON,host.getMaintenanceState(c1.getClusterId()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosComponentDescriptorTest </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testUpdate() throws AmbariException {
  KerberosComponentDescriptor componentDescriptor=createFromJSON();
  KerberosComponentDescriptor updatedComponentDescriptor=createFromMap();
  Assert.assertNotNull(componentDescriptor);
  Assert.assertNotNull(updatedComponentDescriptor);
  componentDescriptor.update(updatedComponentDescriptor);
  validateUpdatedData(componentDescriptor);
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToMap() throws AmbariException {
  KerberosComponentDescriptor descriptor=createFromMap();
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(MAP_VALUE,descriptor.toMap());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosConfigurationDescriptorTest </h4><pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJSONDeserializeMultiple(){
  List<Map<String,Object>> jsonData=new Gson().fromJson(JSON_MULTIPLE_VALUE,new TypeToken<List<Map<String,Object>>>(){
  }
.getType());
  List<KerberosConfigurationDescriptor> configurations=new ArrayList<KerberosConfigurationDescriptor>();
  for (  Map<String,Object> item : jsonData) {
    configurations.add(new KerberosConfigurationDescriptor(item));
  }
  Assert.assertNotNull(configurations);
  Assert.assertEquals(2,configurations.size());
  for (  KerberosConfigurationDescriptor configuration : configurations) {
    Assert.assertFalse(configuration.isContainer());
    String type=configuration.getType();
    Assert.assertEquals(2,configurations.size());
    Map<String,String> properties=configuration.getProperties();
    if ("configuration-type".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(2,properties.size());
      Assert.assertEquals("value1",properties.get("property1"));
      Assert.assertEquals("value2",properties.get("property2"));
    }
 else     if ("configuration-type2".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(3,properties.size());
      Assert.assertEquals("value1",properties.get("property1"));
      Assert.assertEquals("value2",properties.get("property2"));
      Assert.assertEquals("value3",properties.get("property3"));
      Assert.assertEquals("value1",configuration.getProperty("property1"));
      Assert.assertEquals("value2",configuration.getProperty("property2"));
      Assert.assertEquals("value3",configuration.getProperty("property3"));
    }
 else {
      Assert.fail("Missing expected configuration type");
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdate(){
  Map<String,Map<String,Object>> jsonData=new Gson().fromJson(JSON_SINGLE_VALUE,new TypeToken<Map<String,Map<String,Object>>>(){
  }
.getType());
  KerberosConfigurationDescriptor configuration=new KerberosConfigurationDescriptor(jsonData);
  KerberosConfigurationDescriptor updatedConfiguration=new KerberosConfigurationDescriptor(MAP_SINGLE_VALUE);
  Map<String,String> properties;
  properties=configuration.getProperties();
  Assert.assertEquals("configuration-type",configuration.getType());
  Assert.assertNotNull(properties);
  Assert.assertEquals(2,properties.size());
  Assert.assertEquals("${property-value1}",properties.get("property1"));
  Assert.assertEquals("${property.value2}",properties.get("property2"));
  configuration.update(updatedConfiguration);
  properties=configuration.getProperties();
  Assert.assertEquals("configuration-type",configuration.getType());
  Assert.assertNotNull(properties);
  Assert.assertEquals(2,properties.size());
  Assert.assertEquals("black",properties.get("property1"));
  Assert.assertEquals("white",properties.get("property2"));
  updatedConfiguration.setType("updated-type");
  configuration.update(updatedConfiguration);
  Assert.assertEquals("updated-type",configuration.getType());
  Assert.assertNotNull(properties);
  Assert.assertEquals(2,properties.size());
  Assert.assertEquals("black",properties.get("property1"));
  Assert.assertEquals("white",properties.get("property2"));
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJSONDeserialize(){
  Map<String,Map<String,Object>> jsonData=new Gson().fromJson(JSON_SINGLE_VALUE,new TypeToken<Map<String,Map<String,Object>>>(){
  }
.getType());
  KerberosConfigurationDescriptor configuration=new KerberosConfigurationDescriptor(jsonData);
  Assert.assertNotNull(configuration);
  Assert.assertFalse(configuration.isContainer());
  Map<String,String> properties=configuration.getProperties();
  Assert.assertEquals("configuration-type",configuration.getType());
  Assert.assertNotNull(properties);
  Assert.assertEquals(2,properties.size());
  Assert.assertEquals("${property-value1}",properties.get("property1"));
  Assert.assertEquals("${property.value2}",properties.get("property2"));
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapDeserializeMultiple(){
  List<KerberosConfigurationDescriptor> configurations=new ArrayList<KerberosConfigurationDescriptor>();
  for (  Map<String,Map<String,Object>> item : MAP_MULTIPLE_VALUES) {
    configurations.add(new KerberosConfigurationDescriptor(item));
  }
  Assert.assertNotNull(configurations);
  Assert.assertEquals(2,configurations.size());
  for (  KerberosConfigurationDescriptor configuration : configurations) {
    Assert.assertFalse(configuration.isContainer());
    String type=configuration.getType();
    Map<String,String> properties=configuration.getProperties();
    if ("configuration-type".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(2,properties.size());
      Assert.assertEquals("black",properties.get("property1"));
      Assert.assertEquals("white",properties.get("property2"));
      Assert.assertEquals("black",configuration.getProperty("property1"));
      Assert.assertEquals("white",configuration.getProperty("property2"));
    }
 else     if ("configuration-type2".equals(type)) {
      Assert.assertNotNull(properties);
      Assert.assertEquals(3,properties.size());
      Assert.assertEquals("red",properties.get("property1"));
      Assert.assertEquals("yellow",properties.get("property2"));
      Assert.assertEquals("green",properties.get("property3"));
      Assert.assertEquals("red",configuration.getProperty("property1"));
      Assert.assertEquals("yellow",configuration.getProperty("property2"));
      Assert.assertEquals("green",configuration.getProperty("property3"));
    }
 else {
      Assert.fail("Missing expected configuration type");
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapDeserialize(){
  KerberosConfigurationDescriptor configuration=new KerberosConfigurationDescriptor(MAP_SINGLE_VALUE);
  Map<String,String> properties=configuration.getProperties();
  Assert.assertNotNull(configuration);
  Assert.assertFalse(configuration.isContainer());
  Assert.assertEquals("configuration-type",configuration.getType());
  Assert.assertNotNull(properties);
  Assert.assertEquals(2,properties.size());
  Assert.assertEquals("black",properties.get("property1"));
  Assert.assertEquals("white",properties.get("property2"));
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToMap() throws AmbariException {
  KerberosConfigurationDescriptor descriptor=new KerberosConfigurationDescriptor(MAP_SINGLE_VALUE);
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(MAP_SINGLE_VALUE,descriptor.toMap());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosDescriptorTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetReferencedIdentityDescriptor_NameCollisions() throws IOException {
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_get_referenced_identity_descriptor.json");
  Assert.assertNotNull(systemResourceURL);
  KerberosDescriptor descriptor=KERBEROS_DESCRIPTOR_FACTORY.createInstance(new File(systemResourceURL.getFile()));
  KerberosIdentityDescriptor identity;
  identity=descriptor.getReferencedIdentityDescriptor("/collision");
  Assert.assertNotNull(identity);
  Assert.assertEquals("collision",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals(null,identity.getParent().getName());
  identity=descriptor.getReferencedIdentityDescriptor("/SERVICE1/collision");
  Assert.assertNotNull(identity);
  Assert.assertEquals("collision",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals("SERVICE1",identity.getParent().getName());
  identity=descriptor.getReferencedIdentityDescriptor("/SERVICE2/SERVICE2_COMPONENT1/collision");
  Assert.assertNotNull(identity);
  Assert.assertEquals("collision",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals("SERVICE2_COMPONENT1",identity.getParent().getName());
  Assert.assertNotNull(identity.getParent().getParent());
  Assert.assertEquals("SERVICE2",identity.getParent().getParent().getName());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetReferencedIdentityDescriptor_RelativePath() throws IOException {
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_get_referenced_identity_descriptor.json");
  Assert.assertNotNull(systemResourceURL);
  KerberosDescriptor descriptor=KERBEROS_DESCRIPTOR_FACTORY.createInstance(new File(systemResourceURL.getFile()));
  Assert.assertNotNull(descriptor);
  KerberosServiceDescriptor serviceDescriptor=descriptor.getService("SERVICE2");
  Assert.assertNotNull(serviceDescriptor);
  KerberosComponentDescriptor componentDescriptor=serviceDescriptor.getComponent("SERVICE2_COMPONENT1");
  Assert.assertNotNull(componentDescriptor);
  KerberosIdentityDescriptor identity;
  identity=componentDescriptor.getReferencedIdentityDescriptor("../service2_identity");
  Assert.assertNotNull(identity);
  Assert.assertEquals("service2_identity",identity.getName());
  Assert.assertEquals(serviceDescriptor,identity.getParent());
  identity=serviceDescriptor.getReferencedIdentityDescriptor("../service2_identity");
  Assert.assertNull(identity);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetReferencedIdentityDescriptor() throws IOException {
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_get_referenced_identity_descriptor.json");
  Assert.assertNotNull(systemResourceURL);
  KerberosDescriptor descriptor=KERBEROS_DESCRIPTOR_FACTORY.createInstance(new File(systemResourceURL.getFile()));
  KerberosIdentityDescriptor identity;
  identity=descriptor.getReferencedIdentityDescriptor("/stack_identity");
  Assert.assertNotNull(identity);
  Assert.assertEquals("stack_identity",identity.getName());
  identity=descriptor.getReferencedIdentityDescriptor("/SERVICE1/service1_identity");
  Assert.assertNotNull(identity);
  Assert.assertEquals("service1_identity",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals("SERVICE1",identity.getParent().getName());
  identity=descriptor.getReferencedIdentityDescriptor("/SERVICE2/SERVICE2_COMPONENT1/service2_component1_identity");
  Assert.assertNotNull(identity);
  Assert.assertEquals("service2_component1_identity",identity.getName());
  Assert.assertNotNull(identity.getParent());
  Assert.assertEquals("SERVICE2_COMPONENT1",identity.getParent().getName());
  Assert.assertNotNull(identity.getParent().getParent());
  Assert.assertEquals("SERVICE2",identity.getParent().getParent().getName());
}

</code></pre>

<br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testUpdate() throws AmbariException {
  KerberosDescriptor descriptor=createFromJSON();
  KerberosDescriptor updatedDescriptor=createFromMap();
  Assert.assertNotNull(descriptor);
  Assert.assertNotNull(updatedDescriptor);
  descriptor.update(updatedDescriptor);
  validateUpdatedData(descriptor);
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToMap() throws AmbariException {
  KerberosDescriptor descriptor=createFromMap();
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(MAP_VALUE,descriptor.toMap());
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFromMapViaGSON() throws AmbariException {
  Object data=new Gson().fromJson(JSON_VALUE,Object.class);
  Assert.assertNotNull(data);
  KerberosDescriptor descriptor=new KerberosDescriptor((Map<?,?>)data);
  validateFromJSON(descriptor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosIdentityDescriptorTest </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testUpdate(){
  KerberosIdentityDescriptor identityDescriptor=createFromJSON();
  KerberosIdentityDescriptor updatedIdentityDescriptor=createFromMap();
  Assert.assertNotNull(identityDescriptor);
  Assert.assertNotNull(updatedIdentityDescriptor);
  identityDescriptor.update(updatedIdentityDescriptor);
  validateUpdatedData(identityDescriptor);
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToMap() throws AmbariException {
  KerberosIdentityDescriptor descriptor=createFromMap();
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(MAP_VALUE,descriptor.toMap());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosKeytabDescriptorTest </h4><pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToMap() throws AmbariException {
  KerberosKeytabDescriptor descriptor=createFromMap();
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(MAP_VALUE,descriptor.toMap());
}

</code></pre>

<br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testUpdate(){
  KerberosKeytabDescriptor keytabDescriptor=createFromJSON();
  KerberosKeytabDescriptor updatedKeytabDescriptor=createFromMap();
  Assert.assertNotNull(keytabDescriptor);
  Assert.assertNotNull(updatedKeytabDescriptor);
  keytabDescriptor.update(updatedKeytabDescriptor);
  validateUpdatedData(keytabDescriptor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosPrincipalDescriptorTest </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testUpdate(){
  KerberosPrincipalDescriptor principalDescriptor=createFromJSON();
  KerberosPrincipalDescriptor updatedPrincipalDescriptor=createFromMap();
  Assert.assertNotNull(principalDescriptor);
  Assert.assertNotNull(updatedPrincipalDescriptor);
  principalDescriptor.update(updatedPrincipalDescriptor);
  validateUpdatedData(principalDescriptor);
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToMap() throws AmbariException {
  KerberosPrincipalDescriptor descriptor=createFromMap();
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(MAP_VALUE,descriptor.toMap());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateSparse(){
  KerberosPrincipalDescriptor principalDescriptor;
  KerberosPrincipalDescriptor updatedPrincipalDescriptor;
  principalDescriptor=createFromJSON();
  updatedPrincipalDescriptor=createFromJSONSparse();
  Assert.assertNotNull(principalDescriptor);
  Assert.assertNotNull(updatedPrincipalDescriptor);
  Assert.assertEquals("service/_HOST@_REALM",principalDescriptor.getValue());
  Assert.assertEquals("service-site/service.component.kerberos.principal",principalDescriptor.getConfiguration());
  Assert.assertEquals(KerberosPrincipalType.SERVICE,principalDescriptor.getType());
  Assert.assertEquals("localUser",principalDescriptor.getLocalUsername());
  principalDescriptor.update(updatedPrincipalDescriptor);
  Assert.assertEquals("serviceOther/_HOST@_REALM",principalDescriptor.getValue());
  Assert.assertEquals("service-site/service.component.kerberos.principal",principalDescriptor.getConfiguration());
  Assert.assertEquals(KerberosPrincipalType.SERVICE,principalDescriptor.getType());
  Assert.assertEquals("localUser",principalDescriptor.getLocalUsername());
  principalDescriptor=createFromMap();
  updatedPrincipalDescriptor=createFromMapSparse();
  Assert.assertNotNull(principalDescriptor);
  Assert.assertNotNull(updatedPrincipalDescriptor);
  Assert.assertEquals("user@_REALM",principalDescriptor.getValue());
  Assert.assertEquals("service-site/service.component.kerberos.https.principal",principalDescriptor.getConfiguration());
  Assert.assertEquals(KerberosPrincipalType.USER,principalDescriptor.getType());
  Assert.assertNull(principalDescriptor.getLocalUsername());
  principalDescriptor.update(updatedPrincipalDescriptor);
  Assert.assertEquals("userOther@_REALM",principalDescriptor.getValue());
  Assert.assertEquals("service-site/service.component.kerberos.https.principal",principalDescriptor.getConfiguration());
  Assert.assertEquals(KerberosPrincipalType.USER,principalDescriptor.getType());
  Assert.assertNull(principalDescriptor.getLocalUsername());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.kerberos.KerberosServiceDescriptorTest </h4><pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToMap() throws AmbariException {
  KerberosServiceDescriptor descriptor=createFromMap();
  Assert.assertNotNull(descriptor);
  Assert.assertEquals(MAP_VALUE,descriptor.toMap());
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileDeserialize() throws IOException {
  KerberosServiceDescriptor[] descriptors=createFromFile();
  Assert.assertNotNull(descriptors);
  Assert.assertEquals(2,descriptors.length);
}

</code></pre>

<br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testUpdate() throws AmbariException {
  KerberosServiceDescriptor serviceDescriptor=createFromJSON();
  KerberosServiceDescriptor updatedServiceDescriptor=createFromMap();
  Assert.assertNotNull(serviceDescriptor);
  Assert.assertNotNull(updatedServiceDescriptor);
  serviceDescriptor.update(updatedServiceDescriptor);
  validateUpdatedData(serviceDescriptor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.scheduler.BatchRequestJobTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTaskCountsPersistedWithTrigger() throws Exception {
  ExecutionScheduleManager scheduleManagerMock=createNiceMock(ExecutionScheduleManager.class);
  BatchRequestJob batchRequestJobMock=createMockBuilder(BatchRequestJob.class).withConstructor(scheduleManagerMock,100L).addMockedMethods("doWork").createMock();
  JobExecutionContext executionContext=createNiceMock(JobExecutionContext.class);
  JobDataMap jobDataMap=createNiceMock(JobDataMap.class);
  JobDetail jobDetail=createNiceMock(JobDetail.class);
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put(BatchRequestJob.BATCH_REQUEST_FAILED_TASKS_KEY,10);
  properties.put(BatchRequestJob.BATCH_REQUEST_TOTAL_TASKS_KEY,20);
  expect(scheduleManagerMock.continueOnMisfire(executionContext)).andReturn(true);
  expect(executionContext.getMergedJobDataMap()).andReturn(jobDataMap);
  expect(executionContext.getJobDetail()).andReturn(jobDetail);
  expect(jobDetail.getKey()).andReturn(JobKey.jobKey("testJob","testGroup"));
  expect(jobDataMap.getWrappedMap()).andReturn(properties);
  expect(jobDataMap.getString((String)anyObject())).andReturn("testJob").anyTimes();
  Capture<Trigger> triggerCapture=new Capture<Trigger>();
  scheduleManagerMock.scheduleJob(capture(triggerCapture));
  expectLastCall().once();
  replay(scheduleManagerMock,executionContext,jobDataMap,jobDetail);
  batchRequestJobMock.execute(executionContext);
  verify(scheduleManagerMock,executionContext,jobDataMap,jobDetail);
  Trigger trigger=triggerCapture.getValue();
  Assert.assertNotNull(trigger);
  JobDataMap savedMap=trigger.getJobDataMap();
  Assert.assertNotNull(savedMap);
  Assert.assertEquals(10,savedMap.getIntValue(BatchRequestJob.BATCH_REQUEST_FAILED_TASKS_KEY));
  Assert.assertEquals(20,savedMap.getIntValue(BatchRequestJob.BATCH_REQUEST_TOTAL_TASKS_KEY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.services.AlertNoticeDispatchServiceTest </h4><pre class="type-7 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void before(){
  m_dao=createStrictMock(AlertDispatchDAO.class);
  m_dispatchFactory=createStrictMock(DispatchFactory.class);
  m_metaInfo=createNiceMock(AmbariMetaInfo.class);
  m_injector=Guice.createInjector(Modules.override(new InMemoryDefaultTestModule()).with(new MockModule()));
  Assert.assertNotNull(m_injector);
  for (int i=0; i < 5; i++) {
    AlertDefinitionEntity definition=new AlertDefinitionEntity();
    definition.setDefinitionName("Alert Definition " + i);
    definition.setServiceName("Service " + i);
    definition.setComponentName(null);
    definition.setClusterId(1L);
    definition.setHash(UUID.randomUUID().toString());
    definition.setScheduleInterval(Integer.valueOf(60));
    definition.setScope(Scope.SERVICE);
    definition.setSource("{\"type\" : \"SCRIPT\"}");
    definition.setSourceType(SourceType.SCRIPT);
    m_definitions.add(definition);
  }
  calendar.clear();
  calendar.set(2014,Calendar.JANUARY,1);
  for (  AlertDefinitionEntity definition : m_definitions) {
    for (int i=0; i < 10; i++) {
      AlertHistoryEntity history=new AlertHistoryEntity();
      history.setServiceName(definition.getServiceName());
      history.setClusterId(1L);
      history.setAlertDefinition(definition);
      history.setAlertLabel(definition.getDefinitionName() + " " + i);
      history.setAlertText(definition.getDefinitionName() + " " + i);
      history.setAlertTimestamp(calendar.getTimeInMillis());
      history.setHostName(HOSTNAME);
      history.setAlertState(AlertState.OK);
      if (i == 0 || i == 5) {
        history.setAlertState(AlertState.CRITICAL);
      }
      calendar.add(Calendar.DATE,1);
      m_histories.add(history);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests a digest dispatch for email.
 * @throws Exception
 */
@Test public void testDigestDispatch() throws Exception {
  MockEmailDispatcher dispatcher=new MockEmailDispatcher();
  List<AlertNoticeEntity> notices=getSingleMockNotice(dispatcher.getType());
  AlertNoticeEntity notice=notices.get(0);
  EasyMock.expect(m_dao.findPendingNotices()).andReturn(notices).once();
  EasyMock.expect(m_dispatchFactory.getDispatcher("EMAIL")).andReturn(dispatcher).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).atLeastOnce();
  EasyMock.replay(m_dao,m_dispatchFactory);
  AlertNoticeDispatchService service=m_injector.getInstance(AlertNoticeDispatchService.class);
  service.startUp();
  service.setExecutor(new MockExecutor());
  service.runOneIteration();
  EasyMock.verify(m_dao,m_dispatchFactory);
  Notification notification=dispatcher.getNotification();
  assertNotNull(notification);
  assertTrue(notification.Subject.contains("OK[1]"));
  assertTrue(notification.Subject.contains("Critical[0]"));
  assertTrue(notification.Body.contains(ALERT_UNIQUE_TEXT));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Tests that a failed dispatch invokes the callback to mark the UUIDs of the
 * notices as FAILED.
 * @throws Exception
 */
@Test public void testFailedDispatch() throws Exception {
  MockEmailDispatcher dispatcher=new MockEmailDispatcher();
  List<AlertNoticeEntity> notices=getSingleMockNotice(dispatcher.getType());
  AlertNoticeEntity notice=notices.get(0);
  EasyMock.expect(m_dao.findPendingNotices()).andReturn(notices).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).once();
  EasyMock.expect(m_dao.findNoticeByUuid(ALERT_NOTICE_UUID_1)).andReturn(notice).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).once();
  EasyMock.expect(m_dispatchFactory.getDispatcher(dispatcher.getType())).andReturn(dispatcher).once();
  EasyMock.replay(m_dao,m_dispatchFactory);
  AlertNoticeDispatchService service=m_injector.getInstance(AlertNoticeDispatchService.class);
  service.setExecutor(new MockExecutor());
  service.runOneIteration();
  EasyMock.verify(m_dao,m_dispatchFactory);
  Notification notification=dispatcher.getNotification();
  assertNull(notification);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the parsing of the {@link AlertHistoryEntity} list into{@link AlertSummaryInfo}.
 * @throws Exception
 */
@Test public void testAlertSummaryInfo() throws Exception {
  AlertSummaryInfo alertInfo=new AlertSummaryInfo(m_histories);
  assertEquals(50,alertInfo.getAlerts().size());
  assertEquals(10,alertInfo.getAlerts("Service 1").size());
  assertEquals(10,alertInfo.getAlerts("Service 2").size());
  assertEquals(8,alertInfo.getAlerts("Service 1","OK").size());
  assertEquals(2,alertInfo.getAlerts("Service 1","CRITICAL").size());
  assertNull(alertInfo.getAlerts("Service 1","WARNING"));
  assertNull(alertInfo.getAlerts("Service 1","UNKNOWN"));
  assertEquals(5,alertInfo.getServices().size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that when a dispatcher doesn't call back, the{@link AlertNoticeEntity} will be put from{@link NotificationState#PENDING} to {@link NotificationState#DISPATCHED}.
 * @throws Exception
 */
@Test public void testDispatcherWithoutCallbacks() throws Exception {
  MockNoCallbackDispatcher dispatcher=new MockNoCallbackDispatcher();
  List<AlertNoticeEntity> notices=getSingleMockNotice(dispatcher.getType());
  AlertNoticeEntity notice=notices.get(0);
  EasyMock.expect(m_dao.findPendingNotices()).andReturn(notices).once();
  EasyMock.expect(m_dao.merge(notice)).andReturn(notice).atLeastOnce();
  EasyMock.expect(m_dispatchFactory.getDispatcher(dispatcher.getType())).andReturn(dispatcher).once();
  EasyMock.replay(m_dao,m_dispatchFactory);
  AlertNoticeDispatchService service=m_injector.getInstance(AlertNoticeDispatchService.class);
  service.startUp();
  service.setExecutor(new MockExecutor());
  service.runOneIteration();
  EasyMock.verify(m_dao,m_dispatchFactory);
  Notification notification=dispatcher.getNotification();
  assertNotNull(notification);
  assertEquals(NotificationState.DISPATCHED,notice.getNotifyState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.ConfigUpgradePackTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigUpgradeDefinitionParsing() throws Exception {
  ConfigUpgradePack cup=ambariMetaInfo.getConfigUpgradePack("HDP","2.1.1");
  Map<String,ConfigUpgradeChangeDefinition> changesByID=cup.enumerateConfigChangesByID();
  ConfigUpgradeChangeDefinition hdp_2_1_1_nm_pre_upgrade=changesByID.get("hdp_2_1_1_nm_pre_upgrade");
  assertEquals("core-site",hdp_2_1_1_nm_pre_upgrade.getConfigType());
  assertEquals(4,hdp_2_1_1_nm_pre_upgrade.getTransfers().size());
  ConfigUpgradeChangeDefinition.Transfer t1=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(0);
  assertEquals(TransferOperation.COPY,t1.operation);
  assertEquals("copy-key",t1.fromKey);
  assertEquals("copy-key-to",t1.toKey);
  ConfigUpgradeChangeDefinition.Transfer t2=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(1);
  assertEquals(TransferOperation.COPY,t2.operation);
  assertEquals("my-site",t2.fromType);
  assertEquals("my-copy-key",t2.fromKey);
  assertEquals("my-copy-key-to",t2.toKey);
  assertTrue(t2.keepKeys.isEmpty());
  ConfigUpgradeChangeDefinition.Transfer t3=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(2);
  assertEquals(TransferOperation.MOVE,t3.operation);
  assertEquals("move-key",t3.fromKey);
  assertEquals("move-key-to",t3.toKey);
  ConfigUpgradeChangeDefinition.Transfer t4=hdp_2_1_1_nm_pre_upgrade.getTransfers().get(3);
  assertEquals(TransferOperation.DELETE,t4.operation);
  assertEquals("delete-key",t4.deleteKey);
  assertNull(t4.toKey);
  assertTrue(t4.preserveEdits);
  assertEquals(1,t4.keepKeys.size());
  assertEquals("important-key",t4.keepKeys.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.OSFamilyTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFind() throws Exception {
  String expected_result="ubuntu12";
  String actual_result=os_family.find("debian12");
  Assert.assertNotNull(actual_result);
  Assert.assertEquals(expected_result,actual_result);
  expected_result="winsrv6";
  actual_result=os_family.find("win2012server6");
  Assert.assertNotNull(actual_result);
  Assert.assertEquals(expected_result,actual_result);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOSListing() throws Exception {
  Set<String> actual_oslist=os_family.os_list();
  Set<String> expected_oslist=new HashSet<String>(Arrays.asList("redhat6","oraclelinux5","suse11","fedora6","opensuse11","centos6","fedora5","centos5","ubuntu12","redhat5","sles11","oraclelinux6","debian12","sled11","win2012server6","win2012serverr26","win2008serverr26","win2008server6"));
  Assert.assertNotNull(actual_oslist);
  Assert.assertEquals(expected_oslist,actual_oslist);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindTypes() throws Exception {
  Set<String> expected_set=new HashSet<String>(Arrays.asList("ubuntu12","debian12"));
  Set<String> actual_set=os_family.findTypes("ubuntu12");
  Assert.assertNotNull(actual_set);
  Assert.assertEquals(expected_set,actual_set);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParsingOS() throws Exception {
  Map<String,String> expected_map=new HashMap<String,String>();
  expected_map.put("distro","ubuntu");
  expected_map.put("versions","12");
  String test_value="ubuntu12";
  Class[] parse_os_args={String.class};
  Method parse_os=os_family.getClass().getDeclaredMethod("parse_os",parse_os_args);
  parse_os.setAccessible(true);
  Object test_map=parse_os.invoke(os_family,test_value);
  parse_os.setAccessible(false);
  Assert.assertNotNull(test_map);
  Assert.assertEquals(expected_map.getClass().getName(),test_map.getClass().getName());
  Assert.assertEquals(expected_map,test_map);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.stack.UpgradePackTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectionForNonRolling() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_nonrolling"));
  UpgradePack upgrade=upgrades.get("upgrade_test_nonrolling");
  assertTrue(upgrade.getType() == UpgradeType.NON_ROLLING);
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  assertEquals(10,groups.size());
  Grouping group=null;
  ClusterGrouping clusterGroup=null;
  UpdateStackGrouping updateStackGroup=null;
  StopGrouping stopGroup=null;
  RestartGrouping restartGroup=null;
  group=groups.get(0);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Prepare Upgrade",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
  group=groups.get(1);
  assertEquals(StopGrouping.class,group.getClass());
  stopGroup=(StopGrouping)group;
  assertEquals("Stop Daemons for High-Level Services",stopGroup.title);
  assertNotNull(stopGroup.parallelScheduler);
  assertEquals(ParallelScheduler.DEFAULT_MAX_DEGREE_OF_PARALLELISM,stopGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Take Backups",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
  group=groups.get(3);
  assertEquals(StopGrouping.class,group.getClass());
  stopGroup=(StopGrouping)group;
  assertEquals("Stop Daemons for Low-Level Services",stopGroup.title);
  assertNotNull(stopGroup.parallelScheduler);
  assertEquals(ParallelScheduler.DEFAULT_MAX_DEGREE_OF_PARALLELISM,stopGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(4);
  assertEquals(UpdateStackGrouping.class,group.getClass());
  updateStackGroup=(UpdateStackGrouping)group;
  assertEquals("Update Desired Stack Id",updateStackGroup.title);
  assertNull(updateStackGroup.parallelScheduler);
  group=groups.get(5);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Set Version On All Hosts",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
  group=groups.get(6);
  assertEquals(RestartGrouping.class,group.getClass());
  restartGroup=(RestartGrouping)group;
  assertEquals("Zookeeper",restartGroup.title);
  assertNull(restartGroup.parallelScheduler);
  group=groups.get(7);
  assertEquals(RestartGrouping.class,group.getClass());
  restartGroup=(RestartGrouping)group;
  assertEquals("HDFS",restartGroup.title);
  assertNotNull(restartGroup.parallelScheduler);
  assertEquals(2,restartGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(8);
  assertEquals(RestartGrouping.class,group.getClass());
  restartGroup=(RestartGrouping)group;
  assertEquals("MR and YARN",restartGroup.title);
  assertNotNull(restartGroup.parallelScheduler);
  assertEquals(ParallelScheduler.DEFAULT_MAX_DEGREE_OF_PARALLELISM,restartGroup.parallelScheduler.maxDegreeOfParallelism);
  group=groups.get(9);
  assertEquals(ClusterGrouping.class,group.getClass());
  clusterGroup=(ClusterGrouping)group;
  assertEquals("Finalize {{direction.text.proper}}",clusterGroup.title);
  assertNull(clusterGroup.parallelScheduler);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupOrdersForRolling(){
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack upgrade=upgrades.get("upgrade_test_checks");
  PrerequisiteCheckConfig prerequisiteCheckConfig=upgrade.getPrerequisiteCheckConfig();
  assertNotNull(prerequisiteCheckConfig);
  assertNotNull(prerequisiteCheckConfig.globalProperties);
  assertTrue(prerequisiteCheckConfig.getGlobalProperties().containsKey("global-property-1"));
  assertEquals("global-value-1",prerequisiteCheckConfig.getGlobalProperties().get("global-property-1"));
  assertNotNull(prerequisiteCheckConfig.prerequisiteCheckProperties);
  assertEquals(2,prerequisiteCheckConfig.prerequisiteCheckProperties.size());
  assertNotNull(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheck"));
  assertTrue(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheck").containsKey("dfs-protocols-regex"));
  assertEquals("^([^:]*dfs|wasb|ecs):.*",prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesMapReduceDistributedCacheCheck").get("dfs-protocols-regex"));
  assertNotNull(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesTezDistributedCacheCheck"));
  assertTrue(prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesTezDistributedCacheCheck").containsKey("dfs-protocols-regex"));
  assertEquals("^([^:]*dfs|wasb|ecs):.*",prerequisiteCheckConfig.getCheckProperties("org.apache.ambari.server.checks.ServicesTezDistributedCacheCheck").get("dfs-protocols-regex"));
  List<String> expected_up=Arrays.asList("PRE_CLUSTER","ZOOKEEPER","CORE_MASTER","SERVICE_CHECK_1","CORE_SLAVES","SERVICE_CHECK_2","POST_CLUSTER");
  List<String> expected_down=Arrays.asList("PRE_CLUSTER","CORE_SLAVES","SERVICE_CHECK_2","CORE_MASTER","SERVICE_CHECK_1","ZOOKEEPER","POST_CLUSTER");
  Grouping serviceCheckGroup=null;
  int i=0;
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  for (  Grouping g : groups) {
    assertEquals(expected_up.get(i),g.name);
    i++;
    if (g.name.equals("SERVICE_CHECK_1")) {
      serviceCheckGroup=g;
    }
  }
  List<String> expected_priority=Arrays.asList("HDFS","HBASE","YARN");
  assertNotNull(serviceCheckGroup);
  assertEquals(ServiceCheckGrouping.class,serviceCheckGroup.getClass());
  ServiceCheckGrouping scg=(ServiceCheckGrouping)serviceCheckGroup;
  Set<String> priorities=scg.getPriorities();
  assertEquals(3,priorities.size());
  i=0;
  for (  String s : priorities) {
    assertEquals(expected_priority.get(i++),s);
  }
  i=0;
  groups=upgrade.getGroups(Direction.DOWNGRADE);
  for (  Grouping g : groups) {
    assertEquals(expected_down.get(i),g.name);
    i++;
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirectionForRolling() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_direction"));
  UpgradePack upgrade=upgrades.get("upgrade_direction");
  assertTrue(upgrade.getType() == UpgradeType.ROLLING);
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  assertEquals(4,groups.size());
  Grouping group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  ClusterGrouping cluster_group=(ClusterGrouping)group;
  assertEquals("Run on All",group.title);
  cluster_group=(ClusterGrouping)groups.get(3);
  List<ExecuteStage> stages=cluster_group.executionStages;
  assertEquals(3,stages.size());
  assertNotNull(stages.get(0).intendedDirection);
  assertEquals(Direction.DOWNGRADE,stages.get(0).intendedDirection);
  groups=upgrade.getGroups(Direction.DOWNGRADE);
  assertEquals(3,groups.size());
  group=groups.get(1);
  assertEquals(ClusterGrouping.class,group.getClass());
  assertEquals("Run on All",group.title);
  group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  assertEquals("Finalize Upgrade",group.title);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-17 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradeParsing() throws Exception {
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test"));
  UpgradePack upgrade=upgrades.get("upgrade_test");
  assertEquals("2.2.*.*",upgrade.getTarget());
  Map<String,List<String>> expectedStages=new LinkedHashMap<String,List<String>>(){
{
      put("ZOOKEEPER",Arrays.asList("ZOOKEEPER_SERVER"));
      put("HDFS",Arrays.asList("NAMENODE","DATANODE"));
    }
  }
;
  int i=0;
  for (  Entry<String,List<String>> entry : expectedStages.entrySet()) {
    assertTrue(upgrade.getTasks().containsKey(entry.getKey()));
    assertEquals(i++,indexOf(upgrade.getTasks(),entry.getKey()));
    assertEquals(entry.getValue().size(),upgrade.getTasks().get(entry.getKey()).size());
    int j=0;
    for (    String comp : entry.getValue()) {
      assertEquals(j++,indexOf(upgrade.getTasks().get(entry.getKey()),comp));
    }
  }
  assertTrue(upgrade.getTasks().containsKey("HDFS"));
  assertTrue(upgrade.getTasks().get("HDFS").containsKey("NAMENODE"));
  ProcessingComponent pc=upgrade.getTasks().get("HDFS").get("NAMENODE");
  assertNotNull(pc.preTasks);
  assertNotNull(pc.postTasks);
  assertNotNull(pc.tasks);
  assertNull(pc.preDowngradeTasks);
  assertNull(pc.postDowngradeTasks);
  assertEquals(1,pc.tasks.size());
  assertEquals(Task.Type.RESTART,pc.tasks.get(0).getType());
  assertEquals(RestartTask.class,pc.tasks.get(0).getClass());
  assertTrue(upgrade.getTasks().containsKey("ZOOKEEPER"));
  assertTrue(upgrade.getTasks().get("ZOOKEEPER").containsKey("ZOOKEEPER_SERVER"));
  pc=upgrade.getTasks().get("HDFS").get("DATANODE");
  assertNotNull(pc.preDowngradeTasks);
  assertEquals(0,pc.preDowngradeTasks.size());
  assertNotNull(pc.postDowngradeTasks);
  assertEquals(1,pc.postDowngradeTasks.size());
  pc=upgrade.getTasks().get("ZOOKEEPER").get("ZOOKEEPER_SERVER");
  assertNotNull(pc.preTasks);
  assertEquals(1,pc.preTasks.size());
  assertNotNull(pc.postTasks);
  assertEquals(1,pc.postTasks.size());
  assertNotNull(pc.tasks);
  assertEquals(1,pc.tasks.size());
  pc=upgrade.getTasks().get("YARN").get("NODEMANAGER");
  assertNotNull(pc.preTasks);
  assertEquals(2,pc.preTasks.size());
  Task t=pc.preTasks.get(1);
  assertEquals(ConfigureTask.class,t.getClass());
  ConfigureTask ct=(ConfigureTask)t;
  assertEquals("hdp_2_1_1_nm_pre_upgrade",ct.getId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.state.svccomphost.ServiceComponentHostTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecurityState() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  HostEntity hostEntity=hostDAO.findByName(hostName);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  HostComponentDesiredStateDAO daoHostComponentDesiredState=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentDesiredStateEntity entityHostComponentDesiredState;
  HostComponentDesiredStateEntityPK pkHostComponentDesiredState=new HostComponentDesiredStateEntityPK();
  pkHostComponentDesiredState.setClusterId(cluster.getClusterId());
  pkHostComponentDesiredState.setComponentName(sch1.getServiceComponentName());
  pkHostComponentDesiredState.setServiceName(sch1.getServiceName());
  pkHostComponentDesiredState.setHostId(hostEntity.getHostId());
  HostComponentStateDAO daoHostComponentState=injector.getInstance(HostComponentStateDAO.class);
  HostComponentStateEntity entityHostComponentState;
  for (  SecurityState state : SecurityState.values()) {
    sch1.setSecurityState(state);
    entityHostComponentState=daoHostComponentState.findByIndex(cluster.getClusterId(),sch1.getServiceName(),sch1.getServiceComponentName(),hostEntity.getHostId());
    Assert.assertNotNull(entityHostComponentState);
    Assert.assertEquals(state,entityHostComponentState.getSecurityState());
    try {
      sch1.setDesiredSecurityState(state);
      Assert.assertTrue(state.isEndpoint());
      entityHostComponentDesiredState=daoHostComponentDesiredState.findByPK(pkHostComponentDesiredState);
      Assert.assertNotNull(entityHostComponentDesiredState);
      Assert.assertEquals(state,entityHostComponentDesiredState.getSecurityState());
    }
 catch (    AmbariException e) {
      Assert.assertFalse(state.isEndpoint());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaintenance() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  Cluster cluster=clusters.getCluster(clusterName);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  HostEntity hostEntity=hostDAO.findByName(hostName);
  Assert.assertNotNull(hostEntity);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  ServiceComponentHost sch2=createNewServiceComponentHost(cluster,"HDFS","DATANODE",hostName);
  ServiceComponentHost sch3=createNewServiceComponentHost(cluster,"MAPREDUCE2","HISTORYSERVER",hostName);
  HostComponentDesiredStateEntityPK pk=new HostComponentDesiredStateEntityPK();
  pk.setClusterId(Long.valueOf(cluster.getClusterId()));
  pk.setComponentName(sch1.getServiceComponentName());
  pk.setServiceName(sch1.getServiceName());
  pk.setHostId(hostEntity.getHostId());
  HostComponentDesiredStateDAO dao=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentDesiredStateEntity entity=dao.findByPK(pk);
  Assert.assertEquals(MaintenanceState.OFF,entity.getMaintenanceState());
  Assert.assertEquals(MaintenanceState.OFF,sch1.getMaintenanceState());
  sch1.setMaintenanceState(MaintenanceState.ON);
  Assert.assertEquals(MaintenanceState.ON,sch1.getMaintenanceState());
  entity=dao.findByPK(pk);
  Assert.assertEquals(MaintenanceState.ON,entity.getMaintenanceState());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStaleConfigs() throws Exception {
  String stackVersion="HDP-2.0.6";
  StackId stackId=new StackId(stackVersion);
  String clusterName="c2";
  createCluster(stackId,clusterName);
  final String hostName="h3";
  Set<String> hostNames=new HashSet<String>();
  hostNames.add(hostName);
  addHostsToCluster(clusterName,hostAttributes,hostNames);
  final HostEntity hostEntity=hostDAO.findByName(hostName);
  Assert.assertNotNull(hostEntity.getHostId());
  Cluster cluster=clusters.getCluster(clusterName);
  Assert.assertNotNull(cluster);
  helper.getOrCreateRepositoryVersion(stackId,stackId.getStackVersion());
  cluster.createClusterVersion(stackId,stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  ServiceComponentHost sch1=createNewServiceComponentHost(cluster,"HDFS","NAMENODE",hostName);
  ServiceComponentHost sch2=createNewServiceComponentHost(cluster,"HDFS","DATANODE",hostName);
  ServiceComponentHost sch3=createNewServiceComponentHost(cluster,"MAPREDUCE2","HISTORYSERVER",hostName);
  sch1.setDesiredState(State.INSTALLED);
  sch1.setState(State.INSTALLING);
  sch1.setStackVersion(new StackId(stackVersion));
  sch2.setDesiredState(State.INSTALLED);
  sch2.setState(State.INSTALLING);
  sch2.setStackVersion(new StackId(stackVersion));
  sch3.setDesiredState(State.INSTALLED);
  sch3.setState(State.INSTALLING);
  sch3.setStackVersion(new StackId(stackVersion));
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"global","version1",new HashMap<String,String>(){
{
      put("a","b");
      put("dfs_namenode_name_dir","/foo1");
      put("mapred_log_dir_prefix","/foo2");
    }
  }
,new HashMap<String,Map<String,String>>());
  Map<String,Map<String,String>> actual=new HashMap<String,Map<String,String>>(){
{
      put("global",new HashMap<String,String>(){
{
          put("tag","version1");
        }
      }
);
    }
  }
;
  sch1.updateActualConfigs(actual);
  sch2.updateActualConfigs(actual);
  sch3.updateActualConfigs(actual);
  makeConfig(cluster,"foo","version1",new HashMap<String,String>(){
{
      put("a","c");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"hdfs-site","version1",new HashMap<String,String>(){
{
      put("a","b");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  actual.put("hdfs-site",new HashMap<String,String>(){
{
      put("tag","version1");
    }
  }
);
  sch1.updateActualConfigs(actual);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  sch1.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  sch2.updateActualConfigs(actual);
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  sch2.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"hdfs-site","version2",new HashMap<String,String>(){
{
      put("dfs.journalnode.http-address","http://foo");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  actual.get("hdfs-site").put("tag","version2");
  sch1.updateActualConfigs(actual);
  sch2.updateActualConfigs(actual);
  sch1.setRestartRequired(false);
  sch2.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  final Host host=clusters.getHostsForCluster(clusterName).get(hostName);
  Assert.assertNotNull(host);
  final Config c=configFactory.createNew(cluster,"hdfs-site",new HashMap<String,String>(){
{
      put("dfs.journalnode.http-address","http://goo");
    }
  }
,new HashMap<String,Map<String,String>>());
  c.setTag("version3");
  c.persist();
  cluster.addConfig(c);
  host.addDesiredConfig(cluster.getClusterId(),true,"user",c);
  ConfigGroup configGroup=configGroupFactory.createNew(cluster,"g1","t1","",new HashMap<String,Config>(){
{
      put("hdfs-site",c);
    }
  }
,new HashMap<Long,Host>(){
{
      put(hostEntity.getHostId(),host);
    }
  }
);
  configGroup.persist();
  cluster.addConfigGroup(configGroup);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  actual.get("hdfs-site").put(configGroup.getId().toString(),"version3");
  sch2.updateActualConfigs(actual);
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  sch2.setRestartRequired(false);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  sch1.updateActualConfigs(actual);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  sch1.setRestartRequired(false);
  Assert.assertFalse(sch1.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch2.convertToResponse().isStaleConfig());
  makeConfig(cluster,"global","version2",new HashMap<String,String>(){
{
      put("a","b");
      put("dfs_namenode_name_dir","/foo3");
      put("mapred_log_dir_prefix","/foo2");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  makeConfig(cluster,"core-site","version1",new HashMap<String,String>(){
{
      put("a","b");
      put("fs.trash.interval","360");
    }
  }
,new HashMap<String,Map<String,String>>());
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  actual.put("core-site",new HashMap<String,String>(){
{
      put("tag","version1");
    }
  }
);
  sch1.updateActualConfigs(actual);
  final Config c1=configFactory.createNew(cluster,"core-site",new HashMap<String,String>(){
{
      put("fs.trash.interval","400");
    }
  }
,new HashMap<String,Map<String,String>>());
  c1.setTag("version2");
  c1.persist();
  cluster.addConfig(c1);
  configGroup=configGroupFactory.createNew(cluster,"g2","t2","",new HashMap<String,Config>(){
{
      put("core-site",c1);
    }
  }
,new HashMap<Long,Host>(){
{
      put(hostEntity.getHostId(),host);
    }
  }
);
  configGroup.persist();
  cluster.addConfigGroup(configGroup);
  Assert.assertTrue(sch1.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch2.convertToResponse().isStaleConfig());
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  Long id=configGroup.getId();
  HashMap<String,String> tags=new HashMap<String,String>(2);
  tags.put("tag","version1");
  tags.put(id.toString(),"version2");
  actual.put("core-site",tags);
  sch3.updateActualConfigs(actual);
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  sch3.setRestartRequired(false);
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
  cluster.deleteConfigGroup(id);
  Assert.assertNull(cluster.getConfigGroups().get(id));
  sch3.updateActualConfigs(actual);
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  tags.remove(id.toString());
  sch3.updateActualConfigs(actual);
  Assert.assertTrue(sch3.convertToResponse().isStaleConfig());
  sch3.setRestartRequired(false);
  Assert.assertFalse(sch3.convertToResponse().isStaleConfig());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.testing.DBInconsistencyTests </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrphanedSCHDesiredEntityReAdd() throws Exception {
  Long clusterId=helper.createCluster();
  Assert.assertNotNull(clusterId);
  Cluster cluster=clusters.getCluster(OrmTestHelper.CLUSTER_NAME);
  Assert.assertNotNull(cluster);
  helper.addHost(clusters,cluster,"h1");
  helper.installHdfsService(cluster,serviceFactory,serviceComponentFactory,serviceComponentHostFactory,"h1");
  Collection<ServiceComponentHost> schList=clusters.getCluster(OrmTestHelper.CLUSTER_NAME).getServiceComponentHosts("HDFS","DATANODE");
  Assert.assertNotNull(schList);
  Collection<ServiceComponent> scList=cluster.getService("HDFS").getServiceComponents().values();
  Assert.assertNotNull(schList);
  cluster.deleteService("HDFS");
  List<HostComponentDesiredStateEntity> hostComponentDesiredStateEntities=hostComponentDesiredStateDAO.findAll();
  Assert.assertTrue(hostComponentDesiredStateEntities == null || hostComponentDesiredStateEntities.isEmpty());
  List<ServiceComponentDesiredStateEntity> serviceComponentDesiredStateEntities=serviceComponentDesiredStateDAO.findAll();
  Assert.assertTrue(serviceComponentDesiredStateEntities == null || serviceComponentDesiredStateEntities.isEmpty());
  EntityManager em=helper.getEntityManager();
  final EntityTransaction txn=em.getTransaction();
  txn.begin();
  for (  ServiceComponentHost sch : schList) {
    sch.setDesiredState(State.DISABLED);
  }
  for (  ServiceComponent sc : scList) {
    sc.setDesiredState(State.DISABLED);
  }
  txn.commit();
  hostComponentDesiredStateEntities=hostComponentDesiredStateDAO.findAll();
  Assert.assertTrue(hostComponentDesiredStateEntities == null || hostComponentDesiredStateEntities.isEmpty());
  serviceComponentDesiredStateEntities=serviceComponentDesiredStateDAO.findAll();
  Assert.assertTrue(serviceComponentDesiredStateEntities == null || serviceComponentDesiredStateEntities.isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore @Test public void testRefreshInSameTxn() throws Exception {
  Long clusterId=helper.createCluster();
  Assert.assertNotNull(clusterId);
  Cluster cluster=clusters.getCluster(OrmTestHelper.CLUSTER_NAME);
  Assert.assertNotNull(cluster);
  EntityManager em=helper.getEntityManager();
  final EntityTransaction txn=em.getTransaction();
  txn.begin();
  ClusterEntity entity=clusterDAO.findById(clusterId);
  entity.setProvisioningState(State.DISABLED);
  clusterDAO.merge(entity);
  Assert.assertEquals(State.DISABLED,entity.getProvisioningState());
  entity=clusterDAO.findById(clusterId);
  Assert.assertEquals(State.DISABLED,entity.getProvisioningState());
  entity.setProvisioningState(State.INIT);
  txn.commit();
  entity=clusterDAO.findById(clusterId);
  Assert.assertEquals(State.INIT,entity.getProvisioningState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.AsyncCallableServiceTest </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCallableServiceShouldRetryTaskExecutionTillTimeoutExceededWhenTaskThrowsException() throws Exception {
  expect(taskMock.call()).andThrow(new IllegalStateException("****************** TESTING ****************")).times(2,3);
  replay(taskMock);
  asyncCallableService=new AsyncCallableService(taskMock,timeout,delay,Executors.newScheduledThreadPool(2));
  Boolean serviceResult=asyncCallableService.call();
  verify();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertFalse("The expected boolean result is 'false'!",serviceResult);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCallableServiceShouldCancelTaskWhenTaskHangsAndTimeoutExceeded() throws Exception {
  Callable<Boolean> hangingTask=new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      Thread.sleep(10000000);
      return false;
    }
  }
;
  asyncCallableService=new AsyncCallableService(hangingTask,timeout,delay,Executors.newScheduledThreadPool(2));
  Boolean serviceResult=asyncCallableService.call();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertFalse("The expected boolean result is 'false'!",serviceResult);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCallableServiceShouldExitWhenTaskCompleted() throws Exception {
  expect(taskMock.call()).andReturn(Boolean.TRUE).times(1);
  replay(taskMock);
  asyncCallableService=new AsyncCallableService(taskMock,timeout,delay,Executors.newScheduledThreadPool(2));
  Boolean serviceResult=asyncCallableService.call();
  verify();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertTrue(serviceResult);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldAsyncCallableServiceRetryExecutionWhenTaskThrowsException() throws Exception {
  Callable<Boolean> hangingTask=new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      throw new IllegalStateException("****************** TESTING ****************");
    }
  }
;
  asyncCallableService=new AsyncCallableService(hangingTask,timeout,delay,Executors.newScheduledThreadPool(2));
  Boolean serviceResult=asyncCallableService.call();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertFalse("The expected boolean result is 'false'!",serviceResult);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCallableServiceShouldCancelTaskWhenTimeoutExceeded() throws Exception {
  expect(taskMock.call()).andThrow(new IllegalStateException("Prerequisites are not yet satisfied!")).anyTimes();
  replay(taskMock);
  asyncCallableService=new AsyncCallableService(taskMock,timeout,delay,Executors.newScheduledThreadPool(1));
  Boolean serviceResult=asyncCallableService.call();
  verify();
  Assert.assertNotNull("Service result must not be null",serviceResult);
  Assert.assertFalse("The expected boolean result is 'false'!",serviceResult);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.BlueprintFactoryTest </h4><pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testGetBlueprint_NotFound() throws Exception {
  expect(dao.findByName(BLUEPRINT_NAME)).andReturn(null).once();
  replay(dao,entity,configEntity);
  assertNull(factory.getBlueprint(BLUEPRINT_NAME));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.ConfigurationTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveProperty(){
  Configuration configuration=createConfigurationWithParents_PropsOnly();
  assertEquals("val3.1",configuration.removeProperty("type1","prop3"));
  assertNull(configuration.getPropertyValue("type1","prop3"));
  assertEquals("val9.3",configuration.removeProperty("type1","prop9"));
  assertNull(configuration.getPropertyValue("type1","prop9"));
  assertEquals("val1.3",configuration.removeProperty("type1","prop1"));
  assertNull(configuration.getPropertyValue("type1","prop1"));
  assertEquals("val4.3",configuration.removeProperty("type2","prop4"));
  assertNull(configuration.getPropertyValue("type2","prop4"));
  assertEquals("val2.2",configuration.removeProperty("type1","prop2"));
  assertNull(configuration.getPropertyValue("type1","prop2"));
  assertNull(configuration.getPropertyValue("typeXXX","XXXXX"));
  assertNull(configuration.getPropertyValue("type1","XXXXX"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.HostGroupInfoTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGetPredicate() throws Exception {
  HostGroupInfo group=new HostGroupInfo("test-name");
  assertNull(group.getPredicateString());
  assertNull(group.getPredicate());
  group.setPredicate("Hosts/host_name=awesome.host.com");
  assertEquals("Hosts/host_name=awesome.host.com",group.getPredicateString());
  assertEquals(new EqualsPredicate("Hosts/host_name","awesome.host.com"),group.getPredicate());
}

</code></pre>

<br>
<pre class="type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetGetGetConfiguration(){
  Configuration configuration=createNiceMock(Configuration.class);
  HostGroupInfo group=new HostGroupInfo("test-name");
  assertNull(group.getConfiguration());
  group.setConfiguration(configuration);
  assertSame(configuration,group.getConfiguration());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.topology.SecurityConfigurationFactoryTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldPersistKDWhenKDFoundInRequest() throws Exception {
  Capture<KerberosDescriptorEntity> kdEntityCaptor=EasyMock.newCapture();
  kerberosDescriptorDAO.create(capture(kdEntityCaptor));
  EasyMock.replay(kerberosDescriptorDAO);
  Map<String,Object> reuqestMap=new HashMap<>();
  Map<String,Object> security=new HashMap<>();
  security.put(SecurityConfigurationFactory.TYPE_PROPERTY_ID,SecurityType.KERBEROS.toString());
  security.put(SecurityConfigurationFactory.KERBEROS_DESCRIPTOR_PROPERTY_ID,testKDReqPropertyMap());
  reuqestMap.put(SecurityConfigurationFactory.SECURITY_PROPERTY_ID,security);
  testSubject.createSecurityConfigurationFromRequest(reuqestMap,true);
  EasyMock.verify(kerberosDescriptorDAO);
  Assert.assertEquals("The persisted descriptortext is not as expected","{\"test\":\"{\\\"test\\\":\\\"test json\\\"}\"}",kdEntityCaptor.getValue().getKerberosDescriptorText());
  Assert.assertNotNull("There is no generated kerberos descriptor reference in the persisting entity!",kdEntityCaptor.getValue().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog150Test </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetSourceVersion(){
  UpgradeCatalog150 upgradeCatalog150=injector.getInstance(UpgradeCatalog150.class);
  Assert.assertNull(upgradeCatalog150.getSourceVersion());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessDecommissionedDatanodes() throws Exception {
  ClusterEntity clusterEntity=upgradeCatalogHelper.createCluster(injector,CLUSTER_NAME,desiredStackEntity);
  ClusterServiceEntity clusterServiceEntity=upgradeCatalogHelper.createService(injector,clusterEntity,"HDFS");
  HostEntity hostEntity=upgradeCatalogHelper.createHost(injector,clusterEntity,HOST_NAME);
  ServiceComponentDesiredStateEntity componentDesiredStateEntity=new ServiceComponentDesiredStateEntity();
  componentDesiredStateEntity.setClusterId(clusterEntity.getClusterId());
  componentDesiredStateEntity.setServiceName(clusterServiceEntity.getServiceName());
  componentDesiredStateEntity.setClusterServiceEntity(clusterServiceEntity);
  componentDesiredStateEntity.setComponentName("DATANODE");
  componentDesiredStateEntity.setDesiredStack(desiredStackEntity);
  ServiceComponentDesiredStateDAO componentDesiredStateDAO=injector.getInstance(ServiceComponentDesiredStateDAO.class);
  componentDesiredStateDAO.create(componentDesiredStateEntity);
  HostComponentDesiredStateDAO hostComponentDesiredStateDAO=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentDesiredStateEntity hostComponentDesiredStateEntity=new HostComponentDesiredStateEntity();
  hostComponentDesiredStateEntity.setClusterId(clusterEntity.getClusterId());
  hostComponentDesiredStateEntity.setComponentName("DATANODE");
  hostComponentDesiredStateEntity.setAdminState(HostComponentAdminState.INSERVICE);
  hostComponentDesiredStateEntity.setServiceName(clusterServiceEntity.getServiceName());
  hostComponentDesiredStateEntity.setServiceComponentDesiredStateEntity(componentDesiredStateEntity);
  hostComponentDesiredStateEntity.setHostEntity(hostEntity);
  hostComponentDesiredStateEntity.setDesiredStack(desiredStackEntity);
  componentDesiredStateEntity.setHostComponentDesiredStateEntities(Collections.singletonList(hostComponentDesiredStateEntity));
  hostComponentDesiredStateDAO.create(hostComponentDesiredStateEntity);
  HostComponentDesiredStateEntity entity=hostComponentDesiredStateDAO.findAll().get(0);
  Assert.assertEquals(HostComponentAdminState.INSERVICE.name(),entity.getAdminState().name());
  KeyValueDAO keyValueDAO=injector.getInstance(KeyValueDAO.class);
  KeyValueEntity keyValueEntity=new KeyValueEntity();
  keyValueEntity.setKey("decommissionDataNodesTag");
  keyValueEntity.setValue("1394147791230");
  keyValueDAO.create(keyValueEntity);
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  ClusterConfigEntity configEntity=new ClusterConfigEntity();
  configEntity.setClusterEntity(clusterEntity);
  configEntity.setClusterId(clusterEntity.getClusterId());
  configEntity.setType("hdfs-exclude-file");
  configEntity.setTag("1394147791230");
  configEntity.setData("{\"datanodes\":\"" + HOST_NAME + "\"}");
  configEntity.setTimestamp(System.currentTimeMillis());
  configEntity.setStack(desiredStackEntity);
  configEntity.setStack(clusterEntity.getDesiredStack());
  clusterDAO.createConfig(configEntity);
  UpgradeCatalog150 upgradeCatalog150=injector.getInstance(UpgradeCatalog150.class);
  upgradeCatalog150.processDecommissionedDatanodes();
  entity=hostComponentDesiredStateDAO.findAll().get(0);
  Assert.assertEquals(HostComponentAdminState.DECOMMISSIONED.name(),entity.getAdminState().name());
  keyValueEntity=keyValueDAO.findByKey("decommissionDataNodesTag");
  Assert.assertNull(keyValueEntity);
  keyValueEntity=keyValueDAO.findByKey("decommissionDataNodesTag-Moved");
  Assert.assertNotNull(keyValueEntity);
  Assert.assertEquals("1394147791230",keyValueEntity.getValue());
}

</code></pre>

<br>
<pre class="type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  upgradeCatalogHelper=injector.getInstance(UpgradeCatalogHelper.class);
  injector.getInstance(AmbariMetaInfo.class);
  StackDAO stackDAO=injector.getInstance(StackDAO.class);
  desiredStackEntity=stackDAO.find(DESIRED_STACK.getStackName(),DESIRED_STACK.getStackVersion());
  Assert.assertNotNull(desiredStackEntity);
}

</code></pre>

<br>
<pre class="type-13 type-10 type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddMissingLog4jConfigs() throws Exception {
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  ClusterEntity clusterEntity=upgradeCatalogHelper.createCluster(injector,CLUSTER_NAME,desiredStackEntity);
  ClusterServiceEntity clusterServiceEntityMR=upgradeCatalogHelper.addService(injector,clusterEntity,"HDFS",desiredStackEntity);
  Long clusterId=clusterEntity.getClusterId();
  ClusterConfigEntity configEntity=clusterDAO.findConfig(clusterId,"hdfs-log4j","version1");
  Assert.assertNull(configEntity);
  for (  ClusterConfigMappingEntity ccme : clusterEntity.getConfigMappingEntities()) {
    if ("hdfs-log4j".equals(ccme.getType())) {
      Assert.fail();
    }
  }
  UpgradeCatalog150 upgradeCatalog150=injector.getInstance(UpgradeCatalog150.class);
  upgradeCatalog150.addMissingLog4jConfigs();
  configEntity=clusterDAO.findConfig(clusterId,"hdfs-log4j","version1");
  Assert.assertNotNull(configEntity);
  clusterEntity=clusterDAO.findById(1L);
  boolean failFlag=true;
  for (  ClusterConfigMappingEntity ccme : clusterEntity.getConfigMappingEntities()) {
    if ("hdfs-log4j".equals(ccme.getType())) {
      failFlag=false;
    }
  }
  Assert.assertFalse(failFlag);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog170Test </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void updateClusterProvisionState() throws AmbariException {
  StackDAO stackDAO=injector.getInstance(StackDAO.class);
  injector.getInstance(AmbariMetaInfo.class);
  StackEntity desiredStackEntity=stackDAO.find(DESIRED_STACK.getStackName(),DESIRED_STACK.getStackVersion());
  assertNotNull(desiredStackEntity);
  ClusterEntity clusterEntity=upgradeCatalogHelper.createCluster(injector,CLUSTER_NAME,desiredStackEntity);
  UpgradeCatalog170 upgradeCatalog170=injector.getInstance(UpgradeCatalog170.class);
  upgradeCatalog170.updateClusterProvisionState();
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  String assertMsg="updated provisioning state should be installed";
  String expectedState="INSTALLED";
  String actualState=clusterDAO.findById(1L).getProvisioningState().name();
  assertEquals(assertMsg,expectedState,actualState);
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testMoveHcatalogIntoHiveService() throws AmbariException {
  UpgradeCatalog170 upgradeCatalog170=injector.getInstance(UpgradeCatalog170.class);
  ServiceComponentDesiredStateDAO serviceComponentDesiredStateDAO=injector.getInstance(ServiceComponentDesiredStateDAO.class);
  HostComponentDesiredStateDAO hostComponentDesiredStateDAO=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentStateDAO hostComponentStateDAO=injector.getInstance(HostComponentStateDAO.class);
  StackDAO stackDAO=injector.getInstance(StackDAO.class);
  injector.getInstance(AmbariMetaInfo.class);
  StackEntity desiredStackEntity=stackDAO.find(DESIRED_STACK.getStackName(),DESIRED_STACK.getStackVersion());
  assertNotNull(desiredStackEntity);
  final ClusterEntity clusterEntity=upgradeCatalogHelper.createCluster(injector,CLUSTER_NAME,desiredStackEntity);
  final ClusterServiceEntity clusterServiceEntityHDFS=upgradeCatalogHelper.addService(injector,clusterEntity,"HDFS",desiredStackEntity);
  final ClusterServiceEntity clusterServiceEntityHIVE=upgradeCatalogHelper.addService(injector,clusterEntity,"HIVE",desiredStackEntity);
  final ClusterServiceEntity clusterServiceEntityHCATALOG=upgradeCatalogHelper.addService(injector,clusterEntity,"HCATALOG",desiredStackEntity);
  final ClusterServiceEntity clusterServiceEntityWEBHCAT=upgradeCatalogHelper.addService(injector,clusterEntity,"WEBHCAT",desiredStackEntity);
  final HostEntity hostEntity=upgradeCatalogHelper.createHost(injector,clusterEntity,HOST_NAME);
  upgradeCatalogHelper.addComponent(injector,clusterEntity,clusterServiceEntityHDFS,hostEntity,"NAMENODE",desiredStackEntity);
  upgradeCatalogHelper.addComponent(injector,clusterEntity,clusterServiceEntityHIVE,hostEntity,"HIVE_SERVER",desiredStackEntity);
  upgradeCatalogHelper.addComponent(injector,clusterEntity,clusterServiceEntityHCATALOG,hostEntity,"HCAT",desiredStackEntity);
  upgradeCatalogHelper.addComponent(injector,clusterEntity,clusterServiceEntityWEBHCAT,hostEntity,"WEBHCAT_SERVER",desiredStackEntity);
  upgradeCatalog170.moveHcatalogIntoHiveService();
  ServiceComponentDesiredStateEntityPK pkHCATInHive=new ServiceComponentDesiredStateEntityPK();
  pkHCATInHive.setComponentName("HCAT");
  pkHCATInHive.setClusterId(clusterEntity.getClusterId());
  pkHCATInHive.setServiceName("HIVE");
  ServiceComponentDesiredStateEntity serviceComponentDesiredStateEntity=serviceComponentDesiredStateDAO.findByPK(pkHCATInHive);
  assertNotNull(serviceComponentDesiredStateEntity);
  HostComponentDesiredStateEntityPK hcDesiredStateEntityPk=new HostComponentDesiredStateEntityPK();
  hcDesiredStateEntityPk.setServiceName("HIVE");
  hcDesiredStateEntityPk.setClusterId(clusterEntity.getClusterId());
  hcDesiredStateEntityPk.setComponentName("HCAT");
  hcDesiredStateEntityPk.setHostId(hostEntity.getHostId());
  HostComponentDesiredStateEntity hcDesiredStateEntity=hostComponentDesiredStateDAO.findByPK(hcDesiredStateEntityPk);
  assertNotNull(hcDesiredStateEntity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog200Test </h4><pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Tests that Nagios is correctly removed.
 * @throws Exception
 */
@Test public void testDeleteNagiosService() throws Exception {
  UpgradeCatalog200 upgradeCatalog200=injector.getInstance(UpgradeCatalog200.class);
  ServiceComponentDesiredStateDAO serviceComponentDesiredStateDAO=injector.getInstance(ServiceComponentDesiredStateDAO.class);
  HostComponentDesiredStateDAO hostComponentDesiredStateDAO=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentStateDAO hostComponentStateDAO=injector.getInstance(HostComponentStateDAO.class);
  ClusterServiceDAO clusterServiceDao=injector.getInstance(ClusterServiceDAO.class);
  StackDAO stackDAO=injector.getInstance(StackDAO.class);
  injector.getInstance(AmbariMetaInfo.class);
  StackEntity stackEntity=stackDAO.find(DESIRED_STACK.getStackName(),DESIRED_STACK.getStackVersion());
  assertNotNull(stackEntity);
  final ClusterEntity clusterEntity=upgradeCatalogHelper.createCluster(injector,CLUSTER_NAME,stackEntity);
  final ClusterServiceEntity clusterServiceEntityNagios=upgradeCatalogHelper.addService(injector,clusterEntity,"NAGIOS",stackEntity);
  final HostEntity hostEntity=upgradeCatalogHelper.createHost(injector,clusterEntity,HOST_NAME);
  upgradeCatalogHelper.addComponent(injector,clusterEntity,clusterServiceEntityNagios,hostEntity,"NAGIOS_SERVER",stackEntity);
  ServiceComponentDesiredStateEntityPK pkNagiosServer=new ServiceComponentDesiredStateEntityPK();
  pkNagiosServer.setComponentName("NAGIOS_SERVER");
  pkNagiosServer.setClusterId(clusterEntity.getClusterId());
  pkNagiosServer.setServiceName("NAGIOS");
  ServiceComponentDesiredStateEntity serviceComponentDesiredStateEntity=serviceComponentDesiredStateDAO.findByPK(pkNagiosServer);
  assertNotNull(serviceComponentDesiredStateEntity);
  HostComponentDesiredStateEntityPK hcDesiredStateEntityPk=new HostComponentDesiredStateEntityPK();
  hcDesiredStateEntityPk.setServiceName("NAGIOS");
  hcDesiredStateEntityPk.setClusterId(clusterEntity.getClusterId());
  hcDesiredStateEntityPk.setComponentName("NAGIOS_SERVER");
  hcDesiredStateEntityPk.setHostId(hostEntity.getHostId());
  HostComponentDesiredStateEntity hcDesiredStateEntity=hostComponentDesiredStateDAO.findByPK(hcDesiredStateEntityPk);
  assertNotNull(hcDesiredStateEntity);
  HostComponentStateEntity hcStateEntity=hostComponentStateDAO.findByIndex(clusterEntity.getClusterId(),"NAGIOS","NAGIOS_SERVER",hostEntity.getHostId());
  assertNotNull(hcStateEntity);
  ClusterServiceEntity clusterService=clusterServiceDao.findByClusterAndServiceNames(CLUSTER_NAME,"NAGIOS");
  upgradeCatalog200.removeNagiosService();
  clusterService=clusterServiceDao.findByClusterAndServiceNames(CLUSTER_NAME,"NAGIOS");
  assertNull(clusterService);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog210Test </h4><pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUpdateKerberosDescriptorArtifact_Simple() throws Exception {
  final KerberosDescriptorFactory kerberosDescriptorFactory=new KerberosDescriptorFactory();
  KerberosServiceDescriptor serviceDescriptor;
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_kerberos_descriptor_simple.json");
  assertNotNull(systemResourceURL);
  final KerberosDescriptor kerberosDescriptorOrig=kerberosDescriptorFactory.createInstance(new File(systemResourceURL.getFile()));
  assertNotNull(kerberosDescriptorOrig);
  assertNotNull(kerberosDescriptorOrig.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorOrig.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNull(serviceDescriptor.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorOrig.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
  UpgradeCatalog210 upgradeMock=createMockBuilder(UpgradeCatalog210.class).createMock();
  Capture<Map<String,Object>> updatedData=new Capture<Map<String,Object>>();
  ArtifactEntity artifactEntity=createNiceMock(ArtifactEntity.class);
  expect(artifactEntity.getArtifactData()).andReturn(kerberosDescriptorOrig.toMap()).once();
  artifactEntity.setArtifactData(capture(updatedData));
  expectLastCall().once();
  replay(artifactEntity,upgradeMock);
  upgradeMock.updateKerberosDescriptorArtifact(createNiceMock(ArtifactDAO.class),artifactEntity);
  verify(artifactEntity,upgradeMock);
  KerberosDescriptor kerberosDescriptorUpdated=new KerberosDescriptorFactory().createInstance(updatedData.getValue());
  assertNotNull(kerberosDescriptorUpdated);
  assertNull(kerberosDescriptorUpdated.getIdentity("/hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteStormRestApiServiceComponent() throws Exception {
  ClusterEntity clusterEntity=upgradeCatalogHelper.createCluster(injector,"c1",desiredStackEntity);
  ClusterServiceEntity clusterServiceEntity=upgradeCatalogHelper.createService(injector,clusterEntity,"STORM");
  HostEntity hostEntity=upgradeCatalogHelper.createHost(injector,clusterEntity,"h1");
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  ClusterStateDAO clusterStateDAO=injector.getInstance(ClusterStateDAO.class);
  ClusterStateEntity clusterStateEntity=new ClusterStateEntity();
  clusterStateEntity.setClusterId(clusterEntity.getClusterId());
  clusterStateEntity.setClusterEntity(clusterEntity);
  clusterStateEntity.setCurrentStack(desiredStackEntity);
  clusterStateDAO.create(clusterStateEntity);
  clusterEntity.setClusterStateEntity(clusterStateEntity);
  clusterDAO.merge(clusterEntity);
  ServiceComponentDesiredStateEntity componentDesiredStateEntity=new ServiceComponentDesiredStateEntity();
  componentDesiredStateEntity.setClusterId(clusterEntity.getClusterId());
  componentDesiredStateEntity.setServiceName(clusterServiceEntity.getServiceName());
  componentDesiredStateEntity.setClusterServiceEntity(clusterServiceEntity);
  componentDesiredStateEntity.setComponentName("STORM_REST_API");
  componentDesiredStateEntity.setDesiredStack(desiredStackEntity);
  ServiceComponentDesiredStateDAO componentDesiredStateDAO=injector.getInstance(ServiceComponentDesiredStateDAO.class);
  componentDesiredStateDAO.create(componentDesiredStateEntity);
  HostComponentDesiredStateDAO hostComponentDesiredStateDAO=injector.getInstance(HostComponentDesiredStateDAO.class);
  HostComponentDesiredStateEntity hostComponentDesiredStateEntity=new HostComponentDesiredStateEntity();
  hostComponentDesiredStateEntity.setClusterId(clusterEntity.getClusterId());
  hostComponentDesiredStateEntity.setComponentName("STORM_REST_API");
  hostComponentDesiredStateEntity.setAdminState(HostComponentAdminState.INSERVICE);
  hostComponentDesiredStateEntity.setServiceName(clusterServiceEntity.getServiceName());
  hostComponentDesiredStateEntity.setServiceComponentDesiredStateEntity(componentDesiredStateEntity);
  hostComponentDesiredStateEntity.setHostEntity(hostEntity);
  hostComponentDesiredStateEntity.setDesiredStack(desiredStackEntity);
  hostComponentDesiredStateDAO.create(hostComponentDesiredStateEntity);
  HostComponentDesiredStateEntity entity=hostComponentDesiredStateDAO.findAll().get(0);
  Assert.assertEquals(HostComponentAdminState.INSERVICE.name(),entity.getAdminState().name());
  UpgradeCatalog210 upgradeCatalog210=injector.getInstance(UpgradeCatalog210.class);
  upgradeCatalog210.removeStormRestApiServiceComponent();
  ServiceComponentDesiredStateEntityPK entityPK=new ServiceComponentDesiredStateEntityPK();
  entityPK.setClusterId(clusterEntity.getClusterId());
  entityPK.setServiceName("STORM");
  entityPK.setComponentName("STORM_REST_API");
  Assert.assertNull(componentDesiredStateDAO.findByPK(entityPK));
}

</code></pre>

<br>
<pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUpdateKerberosDescriptorArtifact_NoHDFSService() throws Exception {
  final KerberosDescriptorFactory kerberosDescriptorFactory=new KerberosDescriptorFactory();
  KerberosServiceDescriptor serviceDescriptor;
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_kerberos_descriptor_no_hdfs.json");
  assertNotNull(systemResourceURL);
  final KerberosDescriptor kerberosDescriptorOrig=kerberosDescriptorFactory.createInstance(new File(systemResourceURL.getFile()));
  assertNotNull(kerberosDescriptorOrig);
  assertNotNull(kerberosDescriptorOrig.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorOrig.getService("HDFS");
  assertNull(serviceDescriptor);
  serviceDescriptor=kerberosDescriptorOrig.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
  UpgradeCatalog210 upgradeMock=createMockBuilder(UpgradeCatalog210.class).createMock();
  Capture<Map<String,Object>> updatedData=new Capture<Map<String,Object>>();
  ArtifactEntity artifactEntity=createNiceMock(ArtifactEntity.class);
  expect(artifactEntity.getArtifactData()).andReturn(kerberosDescriptorOrig.toMap()).once();
  artifactEntity.setArtifactData(capture(updatedData));
  expectLastCall().once();
  replay(artifactEntity,upgradeMock);
  upgradeMock.updateKerberosDescriptorArtifact(createNiceMock(ArtifactDAO.class),artifactEntity);
  verify(artifactEntity,upgradeMock);
  KerberosDescriptor kerberosDescriptorUpdated=new KerberosDescriptorFactory().createInstance(updatedData.getValue());
  assertNotNull(kerberosDescriptorUpdated);
  assertNull(kerberosDescriptorUpdated.getIdentity("/hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog211Test </h4><pre class="type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateKerberosConfiguration() throws Exception {
  final AmbariManagementController controller=createNiceMock(AmbariManagementController.class);
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  final OsFamily osFamily=createNiceMock(OsFamily.class);
  final Map<String,String> propertiesKerberosEnv=new HashMap<String,String>(){
{
      put("create_attributes_template","create_attributes_template content");
      put("realm","EXAMPLE.COM");
      put("container_dn","");
      put("ldap_url","");
      put("encryption_types","aes des3-cbc-sha1 rc4 des-cbc-md5");
      put("kdc_host","c6407.ambari.apache.org");
      put("admin_server_host","c6407.ambari.apache.org");
      put("kdc_type","mit-kdc");
    }
  }
;
  final Config configKerberosEnv=createNiceMock(Config.class);
  expect(configKerberosEnv.getProperties()).andReturn(propertiesKerberosEnv).anyTimes();
  expect(configKerberosEnv.getTag()).andReturn("tag1").anyTimes();
  final Cluster cluster=createNiceMock(Cluster.class);
  expect(cluster.getDesiredConfigByType("kerberos-env")).andReturn(configKerberosEnv).once();
  final Injector injector=Guice.createInjector(new AbstractModule(){
    @Override protected void configure(){
      bind(AmbariManagementController.class).toInstance(controller);
      bind(DBAccessor.class).toInstance(dbAccessor);
      bind(OsFamily.class).toInstance(osFamily);
    }
  }
);
  expect(cluster.getConfigsByType("kerberos-env")).andReturn(Collections.singletonMap("tag1",configKerberosEnv)).once();
  expect(cluster.getDesiredConfigByType("kerberos-env")).andReturn(configKerberosEnv).once();
  Capture<ConfigurationRequest> captureCR=new Capture<ConfigurationRequest>();
  Capture<Cluster> clusterCapture=newCapture();
  Capture<String> typeCapture=newCapture();
  Capture<Map> propertiesCapture=newCapture();
  Capture<String> tagCapture=newCapture();
  Capture<Map> attributesCapture=newCapture();
  expect(controller.createConfig(capture(clusterCapture),capture(typeCapture),capture(propertiesCapture),capture(tagCapture),capture(attributesCapture))).andReturn(createNiceMock(Config.class)).once();
  replayAll();
  injector.getInstance(UpgradeCatalog211.class).updateKerberosConfigurations(cluster);
  verifyAll();
  Map<String,String> capturedCRProperties=propertiesCapture.getValue();
  Assert.assertNotNull(capturedCRProperties);
  Assert.assertFalse(capturedCRProperties.containsKey("create_attributes_template"));
  Assert.assertTrue(capturedCRProperties.containsKey("ad_create_attributes_template"));
  for (  String property : propertiesKerberosEnv.keySet()) {
    if ("create_attributes_template".equals(property)) {
      Assert.assertEquals("create_attributes_template/ad_create_attributes_template",propertiesKerberosEnv.get(property),capturedCRProperties.get("ad_create_attributes_template"));
    }
 else {
      Assert.assertEquals(property,propertiesKerberosEnv.get(property),capturedCRProperties.get(property));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog212Test </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldPerformPreDMLLogicIfClusterNameColumnExists() throws Exception {
  reset(dbAccessor);
  expect(dbAccessor.getConnection()).andReturn(connection).anyTimes();
  expect(connection.createStatement()).andReturn(statement);
  Capture<String> tableNameCaptor=newCapture();
  Capture<String> columnNameCaptor=newCapture();
  expect(dbAccessor.tableHasColumn(capture(tableNameCaptor),capture(columnNameCaptor))).andReturn(true);
  expect(statement.executeQuery(anyString())).andReturn(resultSet);
  statement.close();
  expect(resultSet.next()).andReturn(false);
  resultSet.close();
  replay(dbAccessor,connection,statement,resultSet);
  testSubject.executePreDMLUpdates();
  Assert.assertNotNull("The table name hasn't been captured",tableNameCaptor.getValue());
  Assert.assertEquals("The table name is not as expected",TOPOLOGY_REQUEST_TABLE,tableNameCaptor.getValue());
  Assert.assertNotNull("The column name hasn't been captured",columnNameCaptor.getValue());
  Assert.assertEquals("The column name is not as expected",TOPOLOGY_REQUEST_CLUSTER_NAME_COLUMN,columnNameCaptor.getValue());
  verify(dbAccessor,statement,resultSet);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldSkipPreDMLLogicIfClusterNameColumnDoesNotExist() throws Exception {
  reset(dbAccessor);
  Capture<String> tableNameCaptor=newCapture();
  Capture<String> columnNameCaptor=newCapture();
  expect(dbAccessor.tableHasColumn(capture(tableNameCaptor),capture(columnNameCaptor))).andReturn(false);
  replay(dbAccessor);
  testSubject.executePreDMLUpdates();
  Assert.assertNotNull("The table name hasn't been captured",tableNameCaptor.getValue());
  Assert.assertEquals("The table name is not as expected",TOPOLOGY_REQUEST_TABLE,tableNameCaptor.getValue());
  Assert.assertNotNull("The column name hasn't been captured",columnNameCaptor.getValue());
  Assert.assertEquals("The column name is not as expected",TOPOLOGY_REQUEST_CLUSTER_NAME_COLUMN,columnNameCaptor.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog220Test </h4><pre class="type-4 type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUpdateKerberosDescriptorArtifact() throws Exception {
  final KerberosDescriptorFactory kerberosDescriptorFactory=new KerberosDescriptorFactory();
  KerberosServiceDescriptor serviceDescriptor;
  URL systemResourceURL=ClassLoader.getSystemResource("kerberos/test_kerberos_descriptor_2_1_3.json");
  assertNotNull(systemResourceURL);
  final KerberosDescriptor kerberosDescriptorOrig=kerberosDescriptorFactory.createInstance(new File(systemResourceURL.getFile()));
  assertNotNull(kerberosDescriptorOrig);
  serviceDescriptor=kerberosDescriptorOrig.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorOrig.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNotNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
  UpgradeCatalog220 upgradeMock=createMockBuilder(UpgradeCatalog220.class).createMock();
  Capture<Map<String,Object>> updatedData=new Capture<Map<String,Object>>();
  ArtifactEntity artifactEntity=createNiceMock(ArtifactEntity.class);
  expect(artifactEntity.getArtifactData()).andReturn(kerberosDescriptorOrig.toMap()).once();
  artifactEntity.setArtifactData(capture(updatedData));
  expectLastCall().once();
  replay(artifactEntity,upgradeMock);
  upgradeMock.updateKerberosDescriptorArtifact(createNiceMock(ArtifactDAO.class),artifactEntity);
  verify(artifactEntity,upgradeMock);
  KerberosDescriptor kerberosDescriptorUpdated=new KerberosDescriptorFactory().createInstance(updatedData.getValue());
  assertNotNull(kerberosDescriptorUpdated);
  serviceDescriptor=kerberosDescriptorUpdated.getService("HDFS");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("hdfs"));
  KerberosComponentDescriptor namenodeComponent=serviceDescriptor.getComponent("NAMENODE");
  assertNotNull(namenodeComponent.getIdentity("hdfs"));
  serviceDescriptor=kerberosDescriptorUpdated.getService("OOZIE");
  assertNotNull(serviceDescriptor);
  assertNull(serviceDescriptor.getIdentity("/HDFS/hdfs"));
  assertNotNull(serviceDescriptor.getIdentity("/HDFS/NAMENODE/hdfs"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalog221Test </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecuteDDLUpdates() throws Exception {
  final DBAccessor dbAccessor=createNiceMock(DBAccessor.class);
  dbAccessor.createIndex(eq("idx_stage_request_id"),eq("stage"),eq("request_id"));
  expectLastCall().once();
  dbAccessor.createIndex(eq("idx_hrc_request_id"),eq("host_role_command"),eq("request_id"));
  expectLastCall().once();
  dbAccessor.createIndex(eq("idx_rsc_request_id"),eq("role_success_criteria"),eq("request_id"));
  expectLastCall().once();
  Capture<DBAccessor.DBColumnInfo> capturedHostGroupComponentProvisionColumn=EasyMock.newCapture();
  dbAccessor.addColumn(eq("hostgroup_component"),capture(capturedHostGroupComponentProvisionColumn));
  expectLastCall().once();
  replay(dbAccessor);
  Module module=new Module(){
    @Override public void configure(    Binder binder){
      binder.bind(DBAccessor.class).toInstance(dbAccessor);
      binder.bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      binder.bind(EntityManager.class).toInstance(entityManager);
    }
  }
;
  Injector injector=Guice.createInjector(module);
  UpgradeCatalog221 upgradeCatalog221=injector.getInstance(UpgradeCatalog221.class);
  upgradeCatalog221.executeDDLUpdates();
  assertEquals("Incorrect column name added","provision_action",capturedHostGroupComponentProvisionColumn.getValue().getName());
  assertNull("Incorrect default value added",capturedHostGroupComponentProvisionColumn.getValue().getDefaultValue());
  assertEquals("Incorrect column type added",String.class,capturedHostGroupComponentProvisionColumn.getValue().getType());
  assertEquals("Incorrect column length added",255,capturedHostGroupComponentProvisionColumn.getValue().getLength().intValue());
  assertTrue("Incorrect column nullable state added",capturedHostGroupComponentProvisionColumn.getValue().isNullable());
  verify(dbAccessor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.upgrade.UpgradeCatalogTest </h4><pre class="type-2 type-5 type-15 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateConfigurationProperties() throws Exception {
  AmbariManagementController controller=injector.getInstance(AmbariManagementController.class);
  ClusterRequest r=new ClusterRequest(null,"c1","HDP-0.1",null);
  controller.createCluster(r);
  Clusters clusters=injector.getInstance(Clusters.class);
  Cluster cluster=clusters.getCluster("c1");
  Assert.assertNotNull(cluster);
  Map<String,String> properties=new HashMap<String,String>(){
{
      put("a","b");
    }
  }
;
  final ClusterRequest cl=new ClusterRequest(cluster.getClusterId(),cluster.getClusterName(),cluster.getDesiredStackVersion().getStackVersion(),null);
  ConfigurationRequest cr=new ConfigurationRequest();
  cr.setClusterName(cluster.getClusterName());
  cr.setType("global");
  cr.setVersionTag("version1");
  cr.setProperties(properties);
  cl.setDesiredConfig(Collections.singletonList(cr));
  controller.updateClusters(new HashSet<ClusterRequest>(){
{
      add(cl);
    }
  }
,null);
  Config config=cluster.getConfig("global","version1");
  Assert.assertNotNull(config);
  Assert.assertEquals(properties,config.getProperties());
  UpgradeCatalog149 testCatalog=injector.getInstance(UpgradeCatalog149.class);
  testCatalog.updateConfigurationProperties("global",Collections.singletonMap("x","y"),false,false);
  config=cluster.getDesiredConfigByType("global");
  String version=config.getTag();
  Assert.assertNotNull(config);
  Assert.assertNotSame("version1",version);
  Assert.assertTrue(config.getProperties().containsKey("x"));
  Assert.assertEquals("y",config.getProperties().get("x"));
  testCatalog.updateConfigurationProperties("global",Collections.singletonMap("x","z"),true,false);
  config=cluster.getDesiredConfigByType("global");
  Assert.assertNotNull(config);
  Assert.assertNotSame(version,config.getTag());
  Assert.assertTrue(config.getProperties().containsKey("x"));
  Assert.assertEquals("z",config.getProperties().get("x"));
  version=config.getTag();
  testCatalog.updateConfigurationProperties("global",Collections.singletonMap("x","y"),false,false);
  config=cluster.getDesiredConfigByType("global");
  Assert.assertNotNull(config);
  Assert.assertSame(version,config.getTag());
  Assert.assertTrue(config.getProperties().containsKey("x"));
  Assert.assertEquals("z",config.getProperties().get("x"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpgradePath() throws Exception {
  SchemaUpgradeHelper schemaUpgradeHelper=injector.getInstance(SchemaUpgradeHelper.class);
  Set<UpgradeCatalog> upgradeCatalogSet=schemaUpgradeHelper.getAllUpgradeCatalogs();
  Assert.assertNotNull(upgradeCatalogSet);
  Assert.assertEquals(5,upgradeCatalogSet.size());
  List<UpgradeCatalog> upgradeCatalogs=schemaUpgradeHelper.getUpgradePath(null,"1.5.1");
  Assert.assertNotNull(upgradeCatalogs);
  Assert.assertEquals(2,upgradeCatalogs.size());
  Assert.assertEquals("1.4.9",upgradeCatalogs.get(0).getTargetVersion());
  Assert.assertEquals("1.5.0",upgradeCatalogs.get(1).getTargetVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestDateUtils </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertToDate() throws Exception {
  String time="2013-11-18T14:29:29-0000";
  Date date=DateUtils.convertToDate(time);
  Assert.assertNotNull(date);
  Calendar calendar=Calendar.getInstance();
  calendar.setTimeZone(TimeZone.getTimeZone("UTC"));
  calendar.set(Calendar.YEAR,2013);
  calendar.set(Calendar.MONTH,Calendar.NOVEMBER);
  calendar.set(Calendar.DAY_OF_MONTH,18);
  calendar.set(Calendar.HOUR_OF_DAY,14);
  calendar.set(Calendar.MINUTE,29);
  calendar.set(Calendar.SECOND,29);
  calendar.set(Calendar.MILLISECOND,0);
  Assert.assertEquals(0,date.compareTo(calendar.getTime()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestHTTPUtils </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHostAndPortFromProperty(){
  String value=null;
  HostAndPort hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertNull(hp);
  value="";
  hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertNull(hp);
  value="c6401.ambari.apache.org";
  hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertNull(hp);
  value="c6401.ambari.apache.org:";
  hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertNull(hp);
  value="c6401.ambari.apache.org:50070";
  hp=HTTPUtils.getHostAndPortFromProperty(value);
  Assert.assertEquals(hp.host,"c6401.ambari.apache.org");
  Assert.assertEquals(hp.port,50070);
  value="  c6401.ambari.apache.org:50070   ";
  Assert.assertEquals(hp.host,"c6401.ambari.apache.org");
  Assert.assertEquals(hp.port,50070);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.utils.TestParallel </h4><pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link org.apache.ambari.server.utils.Parallel} forLoop iteration exceptions
 * @throws Exception
 */
@Test public void testParallelForLoopIterationExceptions() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  final List<Integer> failForList=Arrays.asList(new Integer[]{2,5,7});
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer in1){
      if (failForList.contains(in1)) {
        throw new RuntimeException("Ignore this exception");
      }
      return in1 * in1;
    }
  }
);
  Assert.assertFalse(loopResult.getIsCompleted());
  Assert.assertNotNull(loopResult.getResult());
  List<Integer> output=loopResult.getResult();
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    if (failForList.contains(i)) {
      Assert.assertNull(output.get(i));
      output.set(i,i * i);
    }
 else {
      Assert.assertEquals(i * i,(int)output.get(i));
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests nested {@link org.apache.ambari.server.utils.Parallel} forLoop
 * @throws Exception
 */
@Test public void testNestedParallelForLoop() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  final ParallelLoopResult<Integer>[] innerLoopResults=new ParallelLoopResult[input.size()];
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    final Integer in1){
      int sq=in1 * in1;
      ParallelLoopResult<Integer> innerLoopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
        @Override public Integer run(        Integer in2){
          return in1 * in2;
        }
      }
);
      innerLoopResults[in1]=innerLoopResult;
      return in1 * in1;
    }
  }
);
  Assert.assertNotNull(loopResult);
  Assert.assertTrue(loopResult.getIsCompleted());
  List<Integer> output=loopResult.getResult();
  Assert.assertNotNull(output);
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    Assert.assertEquals(i * i,(int)output.get(i));
    ParallelLoopResult<Integer> innerLoopResult=innerLoopResults[i];
    Assert.assertNotNull(innerLoopResult);
    Assert.assertTrue(innerLoopResult.getIsCompleted());
    List<Integer> innerOutput=innerLoopResult.getResult();
    Assert.assertNotNull(innerOutput);
    Assert.assertEquals(input.size(),innerOutput.size());
    for (int j=0; j < input.size(); j++) {
      Assert.assertEquals(i * j,(int)innerOutput.get(j));
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link org.apache.ambari.server.utils.Parallel} forLoop base cases.
 * @throws Exception
 */
@Test public void testParallelForLoopBaseCases() throws Exception {
  ParallelLoopResult<Integer> nullLoopResult=Parallel.forLoop(null,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer integer){
      return integer;
    }
  }
);
  Assert.assertTrue(nullLoopResult.getIsCompleted());
  Assert.assertTrue(nullLoopResult.getResult().isEmpty());
  ParallelLoopResult<Integer> emptyLoopResult=Parallel.forLoop(new ArrayList<Integer>(),new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer integer){
      return integer;
    }
  }
);
  Assert.assertTrue(emptyLoopResult.getIsCompleted());
  Assert.assertTrue(emptyLoopResult.getResult().isEmpty());
  ParallelLoopResult<Integer> singleElementLoopResult=Parallel.forLoop(Collections.singletonList(7),new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer integer){
      return integer;
    }
  }
);
  Assert.assertTrue(singleElementLoopResult.getIsCompleted());
  List<Integer> singleElementList=singleElementLoopResult.getResult();
  Assert.assertTrue(singleElementLoopResult.getIsCompleted());
  Assert.assertFalse(singleElementList.isEmpty());
  Assert.assertEquals(1,singleElementList.size());
  Assert.assertNotNull(singleElementList.get(0));
}

</code></pre>

<br>
<pre class="type-4 type-12 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests Parallel.forLoop
 * @throws Exception
 */
@Test public void testParallelForLoop() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer in1){
      return in1 * in1;
    }
  }
);
  Assert.assertTrue(loopResult.getIsCompleted());
  Assert.assertNotNull(loopResult.getResult());
  List<Integer> output=loopResult.getResult();
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    Assert.assertEquals(i * i,(int)output.get(i));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-13 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link org.apache.ambari.server.utils.Parallel} forLoop iteration failures
 * @throws Exception
 */
@Test public void testParallelForLoopIterationFailures() throws Exception {
  final List<Integer> input=new LinkedList<Integer>();
  for (int i=0; i < 10; i++) {
    input.add(i);
  }
  final List<Integer> failForList=Arrays.asList(new Integer[]{2,5,7});
  ParallelLoopResult<Integer> loopResult=Parallel.forLoop(input,new LoopBody<Integer,Integer>(){
    @Override public Integer run(    Integer in1){
      if (failForList.contains(in1)) {
        return null;
      }
      return in1 * in1;
    }
  }
);
  Assert.assertFalse(loopResult.getIsCompleted());
  Assert.assertNotNull(loopResult.getResult());
  List<Integer> output=loopResult.getResult();
  Assert.assertEquals(input.size(),output.size());
  for (int i=0; i < input.size(); i++) {
    if (failForList.contains(i)) {
      Assert.assertNull(output.get(i));
      output.set(i,i * i);
    }
 else {
      Assert.assertEquals(i * i,(int)output.get(i));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.DefaultMaskerTest </h4><pre class="type-2 type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMask() throws Exception {
  final String source="unmasked";
  final String masked=masker.mask(source);
  Assert.assertNotNull(masked);
  Assert.assertTrue(masked.length() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewClassLoaderTest </h4><pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResource() throws Exception {
  ClassLoader parentClassLoader=createMock(ClassLoader.class);
  URL parentResource=new File("parent-resource").toURI().toURL();
  ViewConfig viewConfig=createNiceMock(ViewConfig.class);
  expect(parentClassLoader.getResource("parent-resource")).andReturn(parentResource).once();
  replay(parentClassLoader,viewConfig);
  File file=new File("./src/test/resources");
  URL testURL=file.toURI().toURL();
  URL[] urls=new URL[]{testURL};
  ViewClassLoader classLoader=new ViewClassLoader(viewConfig,parentClassLoader,urls);
  URL url=classLoader.getResource("ambari.properties");
  Assert.assertNotNull(url);
  url=classLoader.getResource("parent-resource");
  Assert.assertNotNull(url);
  Assert.assertSame(parentResource,url);
  verify(parentClassLoader,viewConfig);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-15 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadClass() throws Exception {
  TestClassLoader parentClassLoader=createMock(TestClassLoader.class);
  Class parentClass=Object.class;
  ViewConfig viewConfig=createNiceMock(ViewConfig.class);
  expect(parentClassLoader.getPackage("org.apache.ambari.server.view")).andReturn(null).anyTimes();
  expect(parentClassLoader.loadClass("java.lang.Object")).andReturn(parentClass).anyTimes();
  expect(parentClassLoader.loadClass("ParentClass")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("org.apache.ambari.server.controller.spi.ResourceProvider")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("org.apache.ambari.view.ViewContext")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("javax.xml.parsers.SAXParserFactory")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("com.google.inject.AbstractModule")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("org.slf4j.LoggerFactory")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("com.sun.jersey.api.ConflictException")).andReturn(parentClass).once();
  expect(parentClassLoader.loadClass("org.apache.velocity.VelocityContext")).andReturn(parentClass).once();
  replay(parentClassLoader,viewConfig);
  File file=new File("./target/test-classes");
  URL testURL=file.toURI().toURL();
  URL[] urls=new URL[]{testURL};
  ViewClassLoader classLoader=new ViewClassLoader(viewConfig,parentClassLoader,urls);
  Class clazz=classLoader.loadClass("ParentClass");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("org.apache.ambari.server.controller.spi.ResourceProvider");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("org.apache.ambari.view.ViewContext");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("javax.xml.parsers.SAXParserFactory");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("com.google.inject.AbstractModule");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("org.slf4j.LoggerFactory");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("com.sun.jersey.api.ConflictException");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  clazz=classLoader.loadClass("org.apache.velocity.VelocityContext");
  Assert.assertNotNull(clazz);
  Assert.assertSame(parentClass,clazz);
  verify(parentClassLoader,viewConfig);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewContextImplTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertiesWithParameters() throws Exception {
  InstanceConfig instanceConfig=createNiceMock(InstanceConfig.class);
  expect(instanceConfig.getName()).andReturn("Instance").anyTimes();
  replay(instanceConfig);
  ViewEntity viewDefinition=createNiceMock(ViewEntity.class);
  expect(viewDefinition.getName()).andReturn("View").anyTimes();
  expect(viewDefinition.getCommonName()).andReturn("View").times(2);
  expect(viewDefinition.getClassLoader()).andReturn(ViewContextImplTest.class.getClassLoader()).anyTimes();
  expect(viewDefinition.getConfiguration()).andReturn(ViewConfigTest.getConfig()).anyTimes();
  ViewParameterEntity parameter1=createNiceMock(ViewParameterEntity.class);
  expect(parameter1.getName()).andReturn("p1").anyTimes();
  ViewParameterEntity parameter2=createNiceMock(ViewParameterEntity.class);
  expect(parameter2.getName()).andReturn("p2").anyTimes();
  expect(viewDefinition.getParameters()).andReturn(Arrays.asList(parameter1,parameter2)).anyTimes();
  replay(viewDefinition,parameter1,parameter2);
  ViewInstanceEntity viewInstanceDefinition=createMockBuilder(ViewInstanceEntity.class).addMockedMethod("getUsername").addMockedMethod("getName").addMockedMethod("getViewEntity").withConstructor(viewDefinition,instanceConfig).createMock();
  expect(viewInstanceDefinition.getUsername()).andReturn("User").times(1);
  expect(viewInstanceDefinition.getUsername()).andReturn("User2").times(1);
  expect(viewInstanceDefinition.getName()).andReturn("Instance").anyTimes();
  expect(viewInstanceDefinition.getViewEntity()).andReturn(viewDefinition).anyTimes();
  replay(viewInstanceDefinition);
  ViewRegistry viewRegistry=createNiceMock(ViewRegistry.class);
  expect(viewRegistry.getCluster(viewInstanceDefinition)).andReturn(null).anyTimes();
  replay(viewRegistry);
  viewInstanceDefinition.putProperty("p1","/tmp/some/path/${username}");
  viewInstanceDefinition.putProperty("p2",new DefaultMasker().mask("/tmp/path/$viewName"));
  viewInstanceDefinition.putProperty("p3","/path/$instanceName");
  viewInstanceDefinition.putProperty("p4","/path/to/${unspecified_parameter}");
  viewInstanceDefinition.putProperty("p5","/path/to/${incorrect_parameter");
  viewInstanceDefinition.putProperty("p6","/path/to/\\${username}");
  viewInstanceDefinition.putProperty("p7","/path/to/\\$viewName");
  viewInstanceDefinition.putProperty("p8",null);
  ViewContextImpl viewContext=new ViewContextImpl(viewInstanceDefinition,viewRegistry);
  Map<String,String> properties=viewContext.getProperties();
  Assert.assertEquals(8,properties.size());
  Assert.assertEquals("/tmp/some/path/User",properties.get("p1"));
  Assert.assertEquals("/tmp/path/View",properties.get("p2"));
  Assert.assertEquals("/path/Instance",properties.get("p3"));
  Assert.assertEquals("/path/to/${unspecified_parameter}",properties.get("p4"));
  Assert.assertEquals("/path/to/${incorrect_parameter",properties.get("p5"));
  Assert.assertEquals("/path/to/${username}",properties.get("p6"));
  Assert.assertEquals("/path/to/$viewName",properties.get("p7"));
  Assert.assertNull(properties.get("p8"));
  properties=viewContext.getProperties();
  Assert.assertEquals(8,properties.size());
  Assert.assertEquals("/tmp/some/path/User2",properties.get("p1"));
  Assert.assertEquals("/tmp/path/View",properties.get("p2"));
  Assert.assertEquals("/path/Instance",properties.get("p3"));
  Assert.assertEquals("/path/to/${unspecified_parameter}",properties.get("p4"));
  Assert.assertEquals("/path/to/${incorrect_parameter",properties.get("p5"));
  Assert.assertEquals("/path/to/${username}",properties.get("p6"));
  Assert.assertEquals("/path/to/$viewName",properties.get("p7"));
  Assert.assertNull(properties.get("p8"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.ViewRegistryTest </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadViewArchives_exception() throws Exception {
  File viewDir=createNiceMock(File.class);
  File extractedArchiveDir=createNiceMock(File.class);
  File viewArchive=createNiceMock(File.class);
  File archiveDir=createNiceMock(File.class);
  File entryFile=createNiceMock(File.class);
  File classesDir=createNiceMock(File.class);
  File libDir=createNiceMock(File.class);
  File metaInfDir=createNiceMock(File.class);
  File fileEntry=createNiceMock(File.class);
  JarInputStream viewJarFile=createNiceMock(JarInputStream.class);
  JarEntry jarEntry=createNiceMock(JarEntry.class);
  FileOutputStream fos=createMock(FileOutputStream.class);
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName("MY_VIEW{1.0.0}");
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  viewDefinition.setResourceType(resourceTypeEntity);
  Set<ViewInstanceEntity> viewInstanceEntities=ViewInstanceEntityTest.getViewInstanceEntities(viewDefinition);
  viewDefinition.setInstances(viewInstanceEntities);
  Map<File,ViewConfig> viewConfigs=Collections.singletonMap(viewArchive,viewDefinition.getConfiguration());
  long resourceId=99L;
  for (  ViewInstanceEntity viewInstanceEntity : viewInstanceEntities) {
    ResourceEntity resourceEntity=new ResourceEntity();
    resourceEntity.setId(resourceId);
    resourceEntity.setResourceType(resourceTypeEntity);
    viewInstanceEntity.setResource(resourceEntity);
  }
  Map<String,File> files=new HashMap<String,File>();
  if (System.getProperty("os.name").contains("Windows")) {
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work",extractedArchiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}",archiveDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\view.xml",entryFile);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF/classes",classesDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\WEB-INF/lib",libDir);
    files.put("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}\\META-INF",metaInfDir);
  }
 else {
    files.put("/var/lib/ambari-server/resources/views/work",extractedArchiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}",archiveDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/view.xml",entryFile);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/classes",classesDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/WEB-INF/lib",libDir);
    files.put("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}/META-INF",metaInfDir);
  }
  Map<File,FileOutputStream> outputStreams=new HashMap<File,FileOutputStream>();
  outputStreams.put(entryFile,fos);
  Map<File,JarInputStream> jarFiles=new HashMap<File,JarInputStream>();
  jarFiles.put(viewArchive,viewJarFile);
  expect(configuration.getViewsDir()).andReturn(viewDir).anyTimes();
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views").anyTimes();
  }
 else {
    expect(viewDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views").anyTimes();
  }
  expect(configuration.getViewExtractionThreadPoolCoreSize()).andReturn(2).anyTimes();
  expect(configuration.getViewExtractionThreadPoolMaxSize()).andReturn(3).anyTimes();
  expect(configuration.getViewExtractionThreadPoolTimeout()).andReturn(10000L).anyTimes();
  expect(viewDir.listFiles()).andReturn(new File[]{viewArchive}).anyTimes();
  expect(viewArchive.isDirectory()).andReturn(false);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(viewArchive.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(viewArchive.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  expect(archiveDir.exists()).andReturn(false);
  if (System.getProperty("os.name").contains("Windows")) {
    expect(archiveDir.getAbsolutePath()).andReturn("\\var\\lib\\ambari-server\\resources\\views\\work\\MY_VIEW{1.0.0}").anyTimes();
  }
 else {
    expect(archiveDir.getAbsolutePath()).andReturn("/var/lib/ambari-server/resources/views/work/MY_VIEW{1.0.0}").anyTimes();
  }
  expect(archiveDir.mkdir()).andReturn(true);
  expect(archiveDir.toURI()).andReturn(new URI("file:./"));
  expect(metaInfDir.mkdir()).andReturn(true);
  expect(viewJarFile.getNextJarEntry()).andReturn(jarEntry);
  expect(viewJarFile.getNextJarEntry()).andReturn(null);
  expect(jarEntry.getName()).andReturn("view.xml");
  expect(jarEntry.isDirectory()).andReturn(false);
  expect(viewJarFile.read(anyObject(byte[].class))).andReturn(10);
  expect(viewJarFile.read(anyObject(byte[].class))).andReturn(-1);
  fos.write(anyObject(byte[].class),eq(0),eq(10));
  fos.flush();
  fos.close();
  viewJarFile.closeEntry();
  viewJarFile.close();
  expect(extractedArchiveDir.exists()).andReturn(false);
  expect(extractedArchiveDir.mkdir()).andReturn(true);
  expect(classesDir.exists()).andReturn(true);
  expect(classesDir.toURI()).andReturn(new URI("file:./"));
  expect(libDir.exists()).andReturn(true);
  expect(libDir.listFiles()).andReturn(new File[]{fileEntry});
  expect(fileEntry.toURI()).andReturn(new URI("file:./"));
  expect(viewDAO.findByName("MY_VIEW{1.0.0}")).andThrow(new IllegalArgumentException("Expected exception."));
  replay(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,fos,viewDAO);
  TestViewArchiveUtility archiveUtility=new TestViewArchiveUtility(viewConfigs,files,outputStreams,jarFiles,false);
  ViewRegistry registry=getRegistry(viewDAO,viewInstanceDAO,userDAO,memberDAO,privilegeDAO,resourceDAO,resourceTypeDAO,securityHelper,handlerList,null,archiveUtility,ambariMetaInfo);
  registry.readViewArchives();
  ViewEntity view=null;
  long timeout=System.currentTimeMillis() + 10000L;
  while ((view == null || !view.getStatus().equals(ViewDefinition.ViewStatus.ERROR)) && System.currentTimeMillis() < timeout) {
    view=registry.getDefinition("MY_VIEW","1.0.0");
  }
  Assert.assertNotNull(view);
  Assert.assertEquals(ViewDefinition.ViewStatus.ERROR,view.getStatus());
  verify(configuration,viewDir,extractedArchiveDir,viewArchive,archiveDir,entryFile,classesDir,libDir,metaInfDir,fileEntry,viewJarFile,jarEntry,fos,viewDAO);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListener_allVersions() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  TestListener listener=new TestListener();
  registry.registerListener(listener,"MY_VIEW",null);
  EventImpl event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertEquals(event,listener.getLastEvent());
  listener.clear();
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_2);
  registry.fireEvent(event);
  Assert.assertEquals(event,listener.getLastEvent());
  listener.clear();
  registry.unregisterListener(listener,"MY_VIEW",null);
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_2);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListener() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  TestListener listener=new TestListener();
  registry.registerListener(listener,"MY_VIEW","1.0.0");
  EventImpl event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertEquals(event,listener.getLastEvent());
  listener.clear();
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_2);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
  registry.unregisterListener(listener,"MY_VIEW","1.0.0");
  event=EventImplTest.getEvent("MyEvent",Collections.<String,String>emptyMap(),VIEW_XML_1);
  registry.fireEvent(event);
  Assert.assertNull(listener.getLastEvent());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDefinition() throws Exception {
  ViewEntity viewDefinition=ViewEntityTest.getViewEntity();
  ViewRegistry registry=ViewRegistry.getInstance();
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(10);
  resourceTypeEntity.setName(viewDefinition.getName());
  viewDefinition.setResourceType(resourceTypeEntity);
  registry.addDefinition(viewDefinition);
  viewDefinition.setStatus(ViewDefinition.ViewStatus.DEPLOYING);
  Assert.assertNull(registry.getDefinition(resourceTypeEntity));
  viewDefinition.setStatus(ViewDefinition.ViewStatus.DEPLOYED);
  Assert.assertEquals(viewDefinition,registry.getDefinition(resourceTypeEntity));
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRemoveInstanceData() throws Exception {
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  viewInstanceEntity.putInstanceData("foo","value");
  ViewInstanceDataEntity dataEntity=viewInstanceEntity.getInstanceData("foo");
  viewInstanceDAO.removeData(dataEntity);
  expect(viewInstanceDAO.merge(viewInstanceEntity)).andReturn(viewInstanceEntity);
  replay(viewDAO,viewInstanceDAO,securityHelper);
  registry.removeInstanceData(viewInstanceEntity,"foo");
  Assert.assertNull(viewInstanceEntity.getInstanceData("foo"));
  verify(viewDAO,viewInstanceDAO,securityHelper);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.InstanceConfigTest </h4><pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetIcon64() throws Exception {
  List<InstanceConfig> instances=getInstanceConfigs();
  Assert.assertEquals(2,instances.size());
  Assert.assertEquals("/this/is/the/icon/url/instance_1_icon64.png",instances.get(0).getIcon64());
  Assert.assertNull(instances.get(1).getIcon());
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDescription() throws Exception {
  List<InstanceConfig> instances=getInstanceConfigs();
  Assert.assertEquals(2,instances.size());
  Assert.assertEquals("This is a description.",instances.get(0).getDescription());
  Assert.assertNull(instances.get(1).getDescription());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperties() throws Exception {
  List<InstanceConfig> instances=getInstanceConfigs();
  Assert.assertEquals(2,instances.size());
  List<PropertyConfig> properties=instances.get(0).getProperties();
  Assert.assertEquals(2,properties.size());
  properties=instances.get(1).getProperties();
  Assert.assertEquals(1,properties.size());
  instances=getInstanceConfigs(xml_no_properties);
  Assert.assertEquals(1,instances.size());
  properties=instances.get(0).getProperties();
  Assert.assertNotNull(properties);
  Assert.assertEquals(0,properties.size());
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetIcon() throws Exception {
  List<InstanceConfig> instances=getInstanceConfigs();
  Assert.assertEquals(2,instances.size());
  Assert.assertEquals("/this/is/the/icon/url/instance_1_icon.png",instances.get(0).getIcon());
  Assert.assertNull(instances.get(1).getIcon());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.ParameterConfigTest </h4><pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLabel() throws Exception {
  List<ParameterConfig> parameters=getParameterConfigs();
  Assert.assertEquals(2,parameters.size());
  Assert.assertEquals("Label 1.",parameters.get(0).getLabel());
  Assert.assertNull(parameters.get(1).getLabel());
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterConfig() throws Exception {
  List<ParameterConfig> parameters=getParameterConfigs();
  Assert.assertEquals(2,parameters.size());
  Assert.assertNull(parameters.get(0).getClusterConfig());
  Assert.assertEquals("hdfs-site/dfs.namenode.http-address",parameters.get(1).getClusterConfig());
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPlaceholder() throws Exception {
  List<ParameterConfig> parameters=getParameterConfigs();
  Assert.assertEquals(2,parameters.size());
  Assert.assertEquals("Placeholder 1.",parameters.get(0).getPlaceholder());
  Assert.assertNull(parameters.get(1).getPlaceholder());
}

</code></pre>

<br>
<pre class="type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDefaultValue() throws Exception {
  List<ParameterConfig> parameters=getParameterConfigs();
  Assert.assertEquals(2,parameters.size());
  Assert.assertNull(parameters.get(0).getDefaultValue());
  Assert.assertEquals("Default value 1.",parameters.get(1).getDefaultValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.configuration.ViewConfigTest </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMinAmbariVersion() throws Exception {
  ViewConfig config=getConfig();
  Assert.assertNull(config.getMinAmbariVersion());
  config=getConfig(with_ambari_versions);
  Assert.assertEquals("1.6.1",config.getMinAmbariVersion());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMaxAmbariVersion() throws Exception {
  ViewConfig config=getConfig();
  Assert.assertNull(config.getMaxAmbariVersion());
  config=getConfig(with_ambari_versions);
  Assert.assertEquals("2.0.0",config.getMaxAmbariVersion());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws Exception {
  ViewConfig config=getConfig();
  List<ResourceConfig> resources=config.getResources();
  Assert.assertEquals(2,resources.size());
  Assert.assertEquals("resource",resources.get(0).getName());
  Assert.assertEquals("subresource",resources.get(1).getName());
  config=getConfig(minimal_xml);
  resources=config.getResources();
  Assert.assertNotNull(resources);
  Assert.assertEquals(0,resources.size());
}

</code></pre>

<br>
<pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetExtraClasspath() throws Exception {
  ViewConfig config=getConfig(system_xml);
  Assert.assertNull(config.getExtraClasspath());
  config=getConfig(EXTRA_CLASSPATH_XML);
  Assert.assertEquals("/var/lib/,/tmp/foo.jar",config.getExtraClasspath());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInstances() throws Exception {
  ViewConfig config=getConfig(xml);
  List<InstanceConfig> instances=config.getInstances();
  Assert.assertEquals(2,instances.size());
  Assert.assertEquals("INSTANCE1",instances.get(0).getName());
  Assert.assertEquals("INSTANCE2",instances.get(1).getName());
  config=getConfig(minimal_xml);
  instances=config.getInstances();
  Assert.assertNotNull(instances);
  Assert.assertEquals(0,instances.size());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetParameters() throws Exception {
  ViewConfig config=getConfig();
  List<ParameterConfig> parameters=config.getParameters();
  Assert.assertEquals(2,parameters.size());
  Assert.assertEquals("p1",parameters.get(0).getName());
  Assert.assertEquals("p2",parameters.get(1).getName());
  config=getConfig(minimal_xml);
  parameters=config.getParameters();
  Assert.assertNotNull(parameters);
  Assert.assertEquals(0,parameters.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.server.view.events.EventImplTest </h4><pre class="type-4 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetViewInstanceSubject() throws Exception {
  EventImpl event=getEvent("MyEvent",Collections.<String,String>emptyMap(),view_xml);
  Assert.assertNull(event.getViewInstanceSubject());
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  event=getEvent("MyEvent",Collections.<String,String>emptyMap(),viewInstanceEntity);
  Assert.assertEquals(viewInstanceEntity,event.getViewInstanceSubject());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.jobs.JobServiceTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createJobForcedContent() throws IOException, InterruptedException, HdfsApiException {
  HdfsApiMock hdfsApiMock=setupHdfsApiMock();
  JobService.JobRequest request=new JobService.JobRequest();
  request.job=new JobImpl();
  request.job.setForcedContent("Hello world");
  Response response=jobService.create(request,ServiceTestUtils.getResponseWithLocation(),ServiceTestUtils.getDefaultUriInfo());
  ServiceTestUtils.assertHTTPResponseCreated(response);
  JSONObject jobObj=(JSONObject)response.getEntity();
  assertResponseJobSanity(jobObj);
  Assert.assertNull(getFieldFromJobJSON(jobObj,"queryId"));
  Assert.assertEquals("",getFieldFromJobJSON(jobObj,"forcedContent"));
  Assert.assertEquals("Hello world",hdfsApiMock.getQueryOutputStream().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.resources.FileResourceServiceTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createFileResourceItem(){
  Response response=doCreateFileResourceItem();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("fileResource"));
  Assert.assertNotNull(((FileResourceItem)obj.get("fileResource")).getId());
  Assert.assertFalse(((FileResourceItem)obj.get("fileResource")).getId() == null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.savedQueries.SavedQueryServiceTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createSavedQuery(){
  Response response=doCreateSavedQuery();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("savedQuery"));
  Assert.assertNotNull(((SavedQuery)obj.get("savedQuery")).getId());
  Assert.assertTrue(((SavedQuery)obj.get("savedQuery")).getId() != null);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createSavedQueryAutoCreate(){
  Response response=doCreateSavedQuery("Test",null);
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("savedQuery"));
  Assert.assertNotNull(((SavedQuery)obj.get("savedQuery")).getId());
  Assert.assertFalse(((SavedQuery)obj.get("savedQuery")).getId() == null);
  Assert.assertFalse(((SavedQuery)obj.get("savedQuery")).getQueryFile().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.udfs.UDFServiceTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createUDF(){
  Response response=doCreateUDF();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("udf"));
  Assert.assertNotNull(((UDF)obj.get("udf")).getId());
  Assert.assertFalse(((UDF)obj.get("udf")).getId() == null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.hive.resources.upload.DataParserTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataParser() throws IOException {
  String str="1,a\n" + "2,b\n" + "3,c\n";
  StringReader sr=new StringReader(str);
  ParseOptions parseOptions=new ParseOptions();
  parseOptions.setOption(ParseOptions.OPTIONS_FILE_TYPE,ParseOptions.FILE_TYPE_CSV);
  parseOptions.setOption(ParseOptions.OPTIONS_HEADER,ParseOptions.HEADER_FIRST_RECORD);
  DataParser dp=new DataParser(sr,parseOptions);
  dp.parsePreview();
  Assert.assertNotNull(dp.getPreviewRows());
  Assert.assertNotNull(dp.getHeader());
  Assert.assertEquals(3,dp.getPreviewRows().size());
  Assert.assertEquals(2,dp.getHeader().size());
  ColumnDescription[] cd={new ColumnDescriptionImpl("1",ColumnDescriptionShort.DataTypes.INT.toString(),0),new ColumnDescriptionImpl("a",ColumnDescriptionShort.DataTypes.CHAR.toString(),1)};
  Assert.assertArrayEquals("Header Not Correct.",cd,dp.getHeader().toArray());
  sr.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.JobTest </h4><pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobStatusFlow() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  data.id="job_id_#";
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  Assert.assertEquals("-useHCatalog",do_stream.toString());
  Assert.assertEquals(201,response.getStatus());
  PigJob job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  Assert.assertTrue(job.isInProgress());
  reset(api);
  TempletonApi.JobInfo info=api.new JobInfo();
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_RUNNING);
  info.percentComplete="30% complete";
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_RUNNING,job.getStatus());
  Assert.assertTrue(job.isInProgress());
  Assert.assertEquals(30,(Object)job.getPercentComplete());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_SUCCEEDED);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_COMPLETED,job.getStatus());
  Assert.assertFalse(job.isInProgress());
  Assert.assertNull(job.getPercentComplete());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_PREP);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_RUNNING,job.getStatus());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_FAILED);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_FAILED,job.getStatus());
  Assert.assertFalse(job.isInProgress());
  reset(api);
  info=api.new JobInfo();
  info.status=new HashMap<String,Object>();
  info.status.put("runState",(double)JobResourceManager.RUN_STATE_KILLED);
  expect(api.checkJob(eq("job_id_#"))).andReturn(info);
  replay(api);
  response=jobService.getJob(job.getId());
  Assert.assertEquals(200,response.getStatus());
  job=((PigJob)((JSONObject)response.getEntity()).get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_KILLED,job.getStatus());
  Assert.assertFalse(job.isInProgress());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubmitJobNoArguments() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),(String)isNull())).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig",null,jobService);
  Assert.assertEquals("",do_stream.toString());
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("job"));
  Assert.assertNotNull(((PigJob)obj.get("job")).getId());
  Assert.assertFalse(((PigJob)obj.get("job")).getId().isEmpty());
  Assert.assertTrue(((PigJob)obj.get("job")).getStatusDir().startsWith("/tmp/.pigjobs/test"));
  PigJob job=((PigJob)obj.get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  Assert.assertTrue(job.isInProgress());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubmitJob() throws Exception {
  HdfsApi hdfsApi=createNiceMock(HdfsApi.class);
  hdfsApi.copy(eq("/tmp/script.pig"),startsWith("/tmp/.pigjobs/"));
  ByteArrayOutputStream do_stream=new ByteArrayOutputStream();
  FSDataOutputStream stream=new FSDataOutputStream(do_stream);
  expect(hdfsApi.create(anyString(),eq(true))).andReturn(stream);
  replay(hdfsApi);
  UserLocalObjects.setHdfsApi(hdfsApi,context);
  TempletonApi api=createNiceMock(TempletonApi.class);
  UserLocalObjects.setTempletonApi(api,context);
  TempletonApi.JobData data=api.new JobData();
  expect(api.runPigQuery((File)anyObject(),anyString(),eq("-useHCatalog"))).andReturn(data);
  replay(api);
  Response response=doCreateJob("Test","/tmp/script.pig","-useHCatalog",jobService);
  Assert.assertEquals("-useHCatalog",do_stream.toString());
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("job"));
  Assert.assertNotNull(((PigJob)obj.get("job")).getId());
  Assert.assertFalse(((PigJob)obj.get("job")).getId().isEmpty());
  Assert.assertTrue(((PigJob)obj.get("job")).getStatusDir().startsWith("/tmp/.pigjobs/test"));
  PigJob job=((PigJob)obj.get("job"));
  Assert.assertEquals(PigJob.PIG_JOB_STATE_SUBMITTED,job.getStatus());
  Assert.assertTrue(job.isInProgress());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.ScriptTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createScript(){
  Response response=doCreateScript();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("script"));
  Assert.assertNotNull(((PigScript)obj.get("script")).getId());
  Assert.assertFalse(((PigScript)obj.get("script")).getId().isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createScriptAutoCreate(){
  Response response=doCreateScript("Test",null);
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("script"));
  Assert.assertNotNull(((PigScript)obj.get("script")).getId());
  Assert.assertFalse(((PigScript)obj.get("script")).getId().isEmpty());
  Assert.assertFalse(((PigScript)obj.get("script")).getPigScript().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.pig.test.UDFTest </h4><pre class="type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createUDF(){
  Response response=doCreateUDF();
  Assert.assertEquals(201,response.getStatus());
  JSONObject obj=(JSONObject)response.getEntity();
  Assert.assertTrue(obj.containsKey("udf"));
  Assert.assertNotNull(((UDF)obj.get("udf")).getId());
  Assert.assertFalse(((UDF)obj.get("udf")).getId().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.ambari.view.utils.ambari.RemoteClusterTest </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRemoteClusterThatIsPresent() throws Exception {
  ViewContext viewContext=createNiceMock(ViewContext.class);
  Map<String,String> instanceProperties=new HashMap<String,String>();
  instanceProperties.put(AmbariApi.AMBARI_SERVER_URL_INSTANCE_PROPERTY,AMBARI_CLUSTER_REST_URL);
  instanceProperties.put(AmbariApi.AMBARI_SERVER_USERNAME_INSTANCE_PROPERTY,"admin");
  instanceProperties.put(AmbariApi.AMBARI_SERVER_PASSWORD_INSTANCE_PROPERTY,"admin");
  expect(viewContext.getProperties()).andReturn(instanceProperties).anyTimes();
  replay(viewContext);
  AmbariApi ambariApi=new AmbariApi(viewContext);
  Cluster cluster=ambariApi.getRemoteCluster();
  assertNotNull(cluster);
  assertEquals(cluster.getName(),"c1");
}

</code></pre>

<br>
<pre class="type-2 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetRemoteClusterThatIsNotPresent() throws Exception {
  ViewContext viewContext=createNiceMock(ViewContext.class);
  Map<String,String> instanceProperties=new HashMap<String,String>();
  expect(viewContext.getProperties()).andReturn(instanceProperties).anyTimes();
  replay(viewContext);
  AmbariApi ambariApi=new AmbariApi(viewContext);
  Cluster cluster=ambariApi.getRemoteCluster();
  assertNull(cluster);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestApplicationHistoryClientService </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationAttemptReport() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  writeApplicationAttemptStartData(appAttemptId);
  writeApplicationAttemptFinishData(appAttemptId);
  GetApplicationAttemptReportRequest request=GetApplicationAttemptReportRequest.newInstance(appAttemptId);
  GetApplicationAttemptReportResponse response=historyServer.getClientService().getClientHandler().getApplicationAttemptReport(request);
  ApplicationAttemptReport attemptReport=response.getApplicationAttemptReport();
  Assert.assertNotNull(attemptReport);
  Assert.assertEquals("appattempt_0_0001_000001",attemptReport.getApplicationAttemptId().toString());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplications() throws IOException, YarnException {
  ApplicationId appId=null;
  appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  ApplicationId appId1=ApplicationId.newInstance(0,2);
  writeApplicationStartData(appId1);
  writeApplicationFinishData(appId1);
  GetApplicationsRequest request=GetApplicationsRequest.newInstance();
  GetApplicationsResponse response=historyServer.getClientService().getClientHandler().getApplications(request);
  List<ApplicationReport> appReport=response.getApplicationList();
  Assert.assertNotNull(appReport);
  Assert.assertEquals(appId,appReport.get(0).getApplicationId());
  Assert.assertEquals(appId1,appReport.get(1).getApplicationId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationAttempts() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ApplicationAttemptId appAttemptId1=ApplicationAttemptId.newInstance(appId,2);
  writeApplicationAttemptStartData(appAttemptId);
  writeApplicationAttemptFinishData(appAttemptId);
  writeApplicationAttemptStartData(appAttemptId1);
  writeApplicationAttemptFinishData(appAttemptId1);
  GetApplicationAttemptsRequest request=GetApplicationAttemptsRequest.newInstance(appId);
  GetApplicationAttemptsResponse response=historyServer.getClientService().getClientHandler().getApplicationAttempts(request);
  List<ApplicationAttemptReport> attemptReports=response.getApplicationAttemptList();
  Assert.assertNotNull(attemptReports);
  Assert.assertEquals(appAttemptId,attemptReports.get(0).getApplicationAttemptId());
  Assert.assertEquals(appAttemptId1,attemptReports.get(1).getApplicationAttemptId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainers() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  ContainerId containerId1=ContainerId.newInstance(appAttemptId,2);
  writeContainerStartData(containerId);
  writeContainerFinishData(containerId);
  writeContainerStartData(containerId1);
  writeContainerFinishData(containerId1);
  writeApplicationFinishData(appId);
  GetContainersRequest request=GetContainersRequest.newInstance(appAttemptId);
  GetContainersResponse response=historyServer.getClientService().getClientHandler().getContainers(request);
  List<ContainerReport> containers=response.getContainerList();
  Assert.assertNotNull(containers);
  Assert.assertEquals(containerId,containers.get(1).getContainerId());
  Assert.assertEquals(containerId1,containers.get(0).getContainerId());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationReport() throws IOException, YarnException {
  ApplicationId appId=null;
  appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  GetApplicationReportRequest request=GetApplicationReportRequest.newInstance(appId);
  GetApplicationReportResponse response=historyServer.getClientService().getClientHandler().getApplicationReport(request);
  ApplicationReport appReport=response.getApplicationReport();
  Assert.assertNotNull(appReport);
  Assert.assertEquals("application_0_0001",appReport.getApplicationId().toString());
  Assert.assertEquals("test type",appReport.getApplicationType().toString());
  Assert.assertEquals("test queue",appReport.getQueue().toString());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerReport() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  writeContainerStartData(containerId);
  writeContainerFinishData(containerId);
  writeApplicationFinishData(appId);
  GetContainerReportRequest request=GetContainerReportRequest.newInstance(containerId);
  GetContainerReportResponse response=historyServer.getClientService().getClientHandler().getContainerReport(request);
  ContainerReport container=response.getContainerReport();
  Assert.assertNotNull(container);
  Assert.assertEquals(containerId,container.getContainerId());
  Assert.assertEquals(expectedLogUrl,container.getLogUrl());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestApplicationHistoryManagerImpl </h4><pre class="type-4 type-2 type-1 type-11 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testApplicationReport() throws IOException, YarnException {
  ApplicationId appId=null;
  appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  writeApplicationAttemptStartData(appAttemptId);
  writeApplicationAttemptFinishData(appAttemptId);
  ApplicationReport appReport=applicationHistoryManagerImpl.getApplication(appId);
  Assert.assertNotNull(appReport);
  Assert.assertEquals(appId,appReport.getApplicationId());
  Assert.assertEquals(appAttemptId,appReport.getCurrentApplicationAttemptId());
  Assert.assertEquals(appAttemptId.toString(),appReport.getHost());
  Assert.assertEquals("test type",appReport.getApplicationType().toString());
  Assert.assertEquals("test queue",appReport.getQueue().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestApplicationHistoryServer </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=50000) public void testStartStopServer() throws Exception {
  Configuration config=new YarnConfiguration();
  UserGroupInformation ugi=UserGroupInformation.createUserForTesting("ambari",new String[]{"ambari"});
  mockStatic(UserGroupInformation.class);
  expect(UserGroupInformation.getCurrentUser()).andReturn(ugi).anyTimes();
  expect(UserGroupInformation.isSecurityEnabled()).andReturn(false).anyTimes();
  config.set(YarnConfiguration.APPLICATION_HISTORY_STORE,"org.apache.hadoop.yarn.server.applicationhistoryservice.NullApplicationHistoryStore");
  Connection connection=createNiceMock(Connection.class);
  Statement stmt=createNiceMock(Statement.class);
  PreparedStatement preparedStatement=createNiceMock(PreparedStatement.class);
  ResultSet rs=createNiceMock(ResultSet.class);
  mockStatic(DriverManager.class);
  expect(DriverManager.getConnection("jdbc:phoenix:localhost:2181:/ams-hbase-unsecure")).andReturn(connection).anyTimes();
  expect(connection.createStatement()).andReturn(stmt).anyTimes();
  expect(connection.prepareStatement(anyString())).andReturn(preparedStatement).anyTimes();
  suppress(method(Statement.class,"executeUpdate",String.class));
  expect(preparedStatement.executeQuery()).andReturn(rs).anyTimes();
  expect(rs.next()).andReturn(false).anyTimes();
  preparedStatement.close();
  expectLastCall().anyTimes();
  connection.close();
  expectLastCall();
  EasyMock.replay(connection,stmt,preparedStatement,rs);
  replayAll();
  historyServer=new ApplicationHistoryServer();
  historyServer.init(config);
  verifyAll();
  assertEquals(STATE.INITED,historyServer.getServiceState());
  assertEquals(4,historyServer.getServices().size());
  ApplicationHistoryClientService historyService=historyServer.getClientService();
  assertNotNull(historyServer.getClientService());
  assertEquals(STATE.INITED,historyService.getServiceState());
  historyServer.start();
  assertEquals(STATE.STARTED,historyServer.getServiceState());
  assertEquals(STATE.STARTED,historyService.getServiceState());
  historyServer.stop();
  assertEquals(STATE.STOPPED,historyServer.getServiceState());
}

</code></pre>

<br>
<pre class="type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before @SuppressWarnings("all") public void setup() throws URISyntaxException, IOException {
  folder.create();
  File hbaseSite=folder.newFile("hbase-site.xml");
  File amsSite=folder.newFile("ams-site.xml");
  FileUtils.writeStringToFile(hbaseSite,"<configuration>\n" + "  <property>\n" + "    <name>hbase.defaults.for.version.skip</name>\n"+ "    <value>true</value>\n"+ "  </property>"+ "  <property> "+ "    <name>hbase.zookeeper.quorum</name>\n"+ "    <value>localhost</value>\n"+ "  </property>"+ "</configuration>");
  FileUtils.writeStringToFile(amsSite,"<configuration>\n" + "  <property>\n" + "    <name>test</name>\n"+ "    <value>testReady</value>\n"+ "  </property>\n"+ "  <property>\n"+ "    <name>timeline.metrics.host.aggregator.hourly.disabled</name>\n"+ "    <value>true</value>\n"+ "    <description>\n"+ "      Disable host based hourly aggregations.\n"+ "    </description>\n"+ "  </property>\n"+ "  <property>\n"+ "    <name>timeline.metrics.host.aggregator.minute.disabled</name>\n"+ "    <value>true</value>\n"+ "    <description>\n"+ "      Disable host based minute aggregations.\n"+ "    </description>\n"+ "  </property>\n"+ "  <property>\n"+ "    <name>timeline.metrics.cluster.aggregator.hourly.disabled</name>\n"+ "    <value>true</value>\n"+ "    <description>\n"+ "      Disable cluster based hourly aggregations.\n"+ "    </description>\n"+ "  </property>\n"+ "  <property>\n"+ "    <name>timeline.metrics.cluster.aggregator.minute.disabled</name>\n"+ "    <value>true</value>\n"+ "    <description>\n"+ "      Disable cluster based minute aggregations.\n"+ "    </description>\n"+ "  </property>"+ "</configuration>");
  ClassLoader currentClassLoader=Thread.currentThread().getContextClassLoader();
  URLClassLoader urlClassLoader=null;
  try {
    urlClassLoader=new URLClassLoader(new URL[]{folder.getRoot().toURI().toURL()},currentClassLoader);
  }
 catch (  MalformedURLException e) {
    e.printStackTrace();
  }
  Thread.currentThread().setContextClassLoader(urlClassLoader);
  metricsConf=new Configuration(false);
  metricsConf.addResource(Thread.currentThread().getContextClassLoader().getResource(METRICS_SITE_CONFIGURATION_FILE).toURI().toURL());
  assertNotNull(metricsConf.get("test"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestMemoryApplicationHistoryStore </h4><pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationAttemptHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numAppAttempts=5;
  writeApplicationStartData(appId);
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    writeApplicationAttemptStartData(appAttemptId);
    writeApplicationAttemptFinishData(appAttemptId);
  }
  Assert.assertEquals(numAppAttempts,store.getApplicationAttempts(appId).size());
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    ApplicationAttemptHistoryData data=store.getApplicationAttempt(appAttemptId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appAttemptId.toString(),data.getHost());
    Assert.assertEquals(appAttemptId.toString(),data.getDiagnosticsInfo());
  }
  writeApplicationFinishData(appId);
  appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptStartData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numApps=5;
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    writeApplicationStartData(appId);
    writeApplicationFinishData(appId);
  }
  Assert.assertEquals(numApps,store.getAllApplications().size());
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    ApplicationHistoryData data=store.getApplication(appId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appId.toString(),data.getApplicationName());
    Assert.assertEquals(appId.toString(),data.getDiagnosticsInfo());
  }
  appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationStartData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-10 type-2 type-5 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteContainerHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  writeApplicationAttemptStartData(appAttemptId);
  int numContainers=5;
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    writeContainerStartData(containerId);
    writeContainerFinishData(containerId);
  }
  Assert.assertEquals(numContainers,store.getContainers(appAttemptId).size());
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    ContainerHistoryData data=store.getContainer(containerId);
    Assert.assertNotNull(data);
    Assert.assertEquals(Priority.newInstance(containerId.getId()),data.getPriority());
    Assert.assertEquals(containerId.toString(),data.getDiagnosticsInfo());
  }
  ContainerHistoryData masterContainer=store.getAMContainer(appAttemptId);
  Assert.assertNotNull(masterContainer);
  Assert.assertEquals(ContainerId.newInstance(appAttemptId,1),masterContainer.getContainerId());
  writeApplicationAttemptFinishData(appAttemptId);
  containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerStartData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.TestPhoenixTransactSQL </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConditionClause() throws Exception {
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,null,null,false);
  String preparedClause=condition.getConditionClause().toString();
  String expectedClause="(METRIC_NAME IN (?, ?)) AND HOSTNAME = ? AND " + "APP_ID = ? AND INSTANCE_ID = ? AND SERVER_TIME >= ? AND SERVER_TIME < ?";
  Assert.assertNotNull(preparedClause);
  Assert.assertEquals(expectedClause,preparedClause);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLikeConditionClause() throws Exception {
  Condition condition=new DefaultCondition(Arrays.asList("cpu_user","some=%.metric"),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,null,null,false);
  String preparedClause=condition.getConditionClause().toString();
  String expectedClause="(METRIC_NAME IN (?) OR METRIC_NAME LIKE ?) AND HOSTNAME = ? AND " + "APP_ID = ? AND INSTANCE_ID = ? AND SERVER_TIME >= ? AND SERVER_TIME < ?";
  Assert.assertNotNull(preparedClause);
  Assert.assertEquals(expectedClause,preparedClause);
  condition=new DefaultCondition(Collections.<String>emptyList(),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,null,null,false);
  preparedClause=condition.getConditionClause().toString();
  expectedClause=" HOSTNAME = ? AND " + "APP_ID = ? AND INSTANCE_ID = ? AND SERVER_TIME >= ? AND SERVER_TIME < ?";
  Assert.assertNotNull(preparedClause);
  Assert.assertEquals(expectedClause,preparedClause);
  condition=new DefaultCondition(null,Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,null,null,false);
  preparedClause=condition.getConditionClause().toString();
  expectedClause=" HOSTNAME = ? AND " + "APP_ID = ? AND INSTANCE_ID = ? AND SERVER_TIME >= ? AND SERVER_TIME < ?";
  Assert.assertNotNull(preparedClause);
  Assert.assertEquals(expectedClause,preparedClause);
  condition=new DefaultCondition(Arrays.asList("some=%.metric"),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,null,null,false);
  preparedClause=condition.getConditionClause().toString();
  expectedClause="(METRIC_NAME LIKE ?) AND HOSTNAME = ? AND " + "APP_ID = ? AND INSTANCE_ID = ? AND SERVER_TIME >= ? AND SERVER_TIME < ?";
  Assert.assertNotNull(preparedClause);
  Assert.assertEquals(expectedClause,preparedClause);
  condition=new DefaultCondition(Arrays.asList("some=%.metric1","some=%.metric2","some=%.metric3"),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,null,null,false);
  preparedClause=condition.getConditionClause().toString();
  expectedClause="(METRIC_NAME LIKE ? OR METRIC_NAME LIKE ? OR METRIC_NAME LIKE ?) AND HOSTNAME = ? AND " + "APP_ID = ? AND INSTANCE_ID = ? AND SERVER_TIME >= ? AND SERVER_TIME < ?";
  Assert.assertNotNull(preparedClause);
  Assert.assertEquals(expectedClause,preparedClause);
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitByMetricNamesCondition() throws Exception {
  Condition c=new DefaultCondition(Arrays.asList("cpu_user","mem_free"),Collections.singletonList("h1"),"a1","i1",1407959718L,1407959918L,null,null,false);
  SplitByMetricNamesCondition condition=new SplitByMetricNamesCondition(c);
  condition.setCurrentMetric(c.getMetricNames().get(0));
  String preparedClause=condition.getConditionClause().toString();
  String expectedClause="METRIC_NAME = ? AND HOSTNAME = ? AND " + "APP_ID = ? AND INSTANCE_ID = ? AND SERVER_TIME >= ? AND SERVER_TIME < ?";
  Assert.assertNotNull(preparedClause);
  Assert.assertEquals(expectedClause,preparedClause);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.aggregators.ITClusterAggregator </h4><pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppLevelHostMetricAggregates() throws Exception {
  Configuration conf=getConfigurationForTest(false);
  conf.set(CLUSTER_AGGREGATOR_APP_IDS,"app1");
  TimelineMetricAggregator agg=TimelineMetricAggregatorFactory.createTimelineClusterAggregatorSecond(hdb,conf,new TimelineMetricMetadataManager(hdb,new Configuration()));
  TimelineMetricReadHelper readHelper=new TimelineMetricReadHelper(false);
  long startTime=System.currentTimeMillis();
  long ctime=startTime;
  long minute=60 * 1000;
  hdb.insertMetricRecords(prepareSingleTimelineMetric((ctime),"local1","app1",null,"app_metric_random",1));
  ctime+=10;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local1","cpu_user",1));
  ctime+=10;
  hdb.insertMetricRecords(prepareSingleTimelineMetric(ctime,"local2","cpu_user",2));
  long endTime=ctime + minute;
  boolean success=agg.doWork(startTime,endTime);
  Condition condition=new DefaultCondition(Collections.singletonList("cpu_user"),null,"app1",null,startTime,endTime,null,null,true);
  condition.setStatement(String.format(GET_CLUSTER_AGGREGATE_SQL,PhoenixTransactSQL.getNaiveTimeRangeHint(startTime,NATIVE_TIME_RANGE_DELTA),METRICS_CLUSTER_AGGREGATE_TABLE_NAME));
  PreparedStatement pstmt=PhoenixTransactSQL.prepareGetMetricsSqlStmt(conn,condition);
  ResultSet rs=pstmt.executeQuery();
  int recordCount=0;
  TimelineClusterMetric currentMetric=null;
  MetricClusterAggregate currentHostAggregate=null;
  while (rs.next()) {
    currentMetric=metricReader.fromResultSet(rs);
    currentHostAggregate=readHelper.getMetricClusterAggregateFromResultSet(rs);
    recordCount++;
  }
  assertEquals(3,recordCount);
  assertNotNull(currentMetric);
  assertEquals("cpu_user",currentMetric.getMetricName());
  assertEquals("app1",currentMetric.getAppId());
  assertNotNull(currentHostAggregate);
  assertEquals(1,currentHostAggregate.getNumberOfHosts());
  assertEquals(1.0d,currentHostAggregate.getSum());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.metrics.timeline.discovery.TestMetadataManager </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSaveMetricsMetadata() throws Exception {
  Map<TimelineMetricMetadataKey,TimelineMetricMetadata> cachedData=metadataManager.getMetadataCache();
  Assert.assertNotNull(cachedData);
  Assert.assertEquals(2,cachedData.size());
  TimelineMetricMetadataKey key1=new TimelineMetricMetadataKey("dummy_metric1","dummy_app1");
  TimelineMetricMetadataKey key2=new TimelineMetricMetadataKey("dummy_metric2","dummy_app2");
  TimelineMetricMetadata value1=new TimelineMetricMetadata("dummy_metric1","dummy_app1","Integer",null,1L,true);
  TimelineMetricMetadata value2=new TimelineMetricMetadata("dummy_metric2","dummy_app2","Integer",null,1L,true);
  Assert.assertEquals(value1,cachedData.get(key1));
  Assert.assertEquals(value2,cachedData.get(key2));
  TimelineMetricMetadataSync syncRunnable=new TimelineMetricMetadataSync(metadataManager);
  syncRunnable.run();
  Map<TimelineMetricMetadataKey,TimelineMetricMetadata> savedData=hdb.getTimelineMetricMetadata();
  Assert.assertNotNull(savedData);
  Assert.assertEquals(2,savedData.size());
  Assert.assertEquals(value1,savedData.get(key1));
  Assert.assertEquals(value2,savedData.get(key2));
  Map<String,Set<String>> cachedHostData=metadataManager.getHostedAppsCache();
  Map<String,Set<String>> savedHostData=metadataManager.getPersistedHostedAppsData();
  Assert.assertEquals(cachedData.size(),savedData.size());
  Assert.assertEquals("dummy_app1",cachedHostData.get("dummy_host1").iterator().next());
  Assert.assertEquals("dummy_app2",cachedHostData.get("dummy_host2").iterator().next());
  Assert.assertEquals("dummy_app1",savedHostData.get("dummy_host1").iterator().next());
  Assert.assertEquals("dummy_app2",savedHostData.get("dummy_host2").iterator().next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.webapp.TestTimelineWebServices </h4><pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEntity() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").path("type_1").path("id_1").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineEntity entity=response.getEntity(TimelineEntity.class);
  Assert.assertNotNull(entity);
  Assert.assertEquals("id_1",entity.getEntityId());
  Assert.assertEquals("type_1",entity.getEntityType());
  Assert.assertEquals(123l,entity.getStartTime().longValue());
  Assert.assertEquals(2,entity.getEvents().size());
  Assert.assertEquals(4,entity.getPrimaryFilters().size());
  Assert.assertEquals(4,entity.getOtherInfo().size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEntityFields1() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").path("type_1").path("id_1").queryParam("fields","events,otherinfo").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineEntity entity=response.getEntity(TimelineEntity.class);
  Assert.assertNotNull(entity);
  Assert.assertEquals("id_1",entity.getEntityId());
  Assert.assertEquals("type_1",entity.getEntityType());
  Assert.assertEquals(123l,entity.getStartTime().longValue());
  Assert.assertEquals(2,entity.getEvents().size());
  Assert.assertEquals(0,entity.getPrimaryFilters().size());
  Assert.assertEquals(4,entity.getOtherInfo().size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbout() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineWebServices.AboutInfo about=response.getEntity(TimelineWebServices.AboutInfo.class);
  Assert.assertNotNull(about);
  Assert.assertEquals("Timeline API",about.getAbout());
}

</code></pre>

<br>
<pre class="type-4 type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPostEntities() throws Exception {
  TimelineEntities entities=new TimelineEntities();
  TimelineEntity entity=new TimelineEntity();
  entity.setEntityId("test id");
  entity.setEntityType("test type");
  entity.setStartTime(System.currentTimeMillis());
  entities.addEntity(entity);
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").accept(MediaType.APPLICATION_JSON).type(MediaType.APPLICATION_JSON).post(ClientResponse.class,entities);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelinePutResponse putResposne=response.getEntity(TimelinePutResponse.class);
  Assert.assertNotNull(putResposne);
  Assert.assertEquals(0,putResposne.getErrors().size());
  response=r.path("ws").path("v1").path("timeline").path("test type").path("test id").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  entity=response.getEntity(TimelineEntity.class);
  Assert.assertNotNull(entity);
  Assert.assertEquals("test id",entity.getEntityId());
  Assert.assertEquals("test type",entity.getEntityType());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEvents() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").path("type_1").path("events").queryParam("entityId","id_1").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineEvents events=response.getEntity(TimelineEvents.class);
  Assert.assertNotNull(events);
  Assert.assertEquals(1,events.getAllEvents().size());
  TimelineEvents.EventsOfOneEntity partEvents=events.getAllEvents().get(0);
  Assert.assertEquals(2,partEvents.getEvents().size());
  TimelineEvent event1=partEvents.getEvents().get(0);
  Assert.assertEquals(456l,event1.getTimestamp());
  Assert.assertEquals("end_event",event1.getEventType());
  Assert.assertEquals(1,event1.getEventInfo().size());
  TimelineEvent event2=partEvents.getEvents().get(1);
  Assert.assertEquals(123l,event2.getTimestamp());
  Assert.assertEquals("start_event",event2.getEventType());
  Assert.assertEquals(0,event2.getEventInfo().size());
}

</code></pre>

<br>
<pre class="type-2 type-1 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEntityFields2() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").path("type_1").path("id_1").queryParam("fields","lasteventonly," + "primaryfilters,relatedentities").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineEntity entity=response.getEntity(TimelineEntity.class);
  Assert.assertNotNull(entity);
  Assert.assertEquals("id_1",entity.getEntityId());
  Assert.assertEquals("type_1",entity.getEntityType());
  Assert.assertEquals(123l,entity.getStartTime().longValue());
  Assert.assertEquals(1,entity.getEvents().size());
  Assert.assertEquals(4,entity.getPrimaryFilters().size());
  Assert.assertEquals(0,entity.getOtherInfo().size());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
