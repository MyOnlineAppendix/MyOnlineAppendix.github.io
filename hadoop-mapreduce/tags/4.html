<h3><span class=" glyphicon glyphicon-tag"/>&nbspInternalCallVerifier</h3><kbd>Verifies values of objects/variables related to AUT calls</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.conf.TestJobConf </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test deprecated accessor and mutator method for mapred.task.maxvmem
 */
@Test public void testMaxVirtualMemoryForTask(){
  JobConf configuration=new JobConf();
  configuration.set(MRJobConfig.MAP_MEMORY_MB,String.valueOf(300));
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,String.valueOf(-1));
  Assert.assertEquals(configuration.getMaxVirtualMemoryForTask(),300 * 1024 * 1024);
  configuration=new JobConf();
  configuration.set(MRJobConfig.MAP_MEMORY_MB,String.valueOf(-1));
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,String.valueOf(200));
  Assert.assertEquals(configuration.getMaxVirtualMemoryForTask(),200 * 1024 * 1024);
  configuration=new JobConf();
  configuration.set(MRJobConfig.MAP_MEMORY_MB,String.valueOf(-1));
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,String.valueOf(-1));
  configuration.set("mapred.task.maxvmem",String.valueOf(1 * 1024 * 1024));
  Assert.assertEquals(configuration.getMaxVirtualMemoryForTask(),1 * 1024 * 1024);
  configuration=new JobConf();
  configuration.set("mapred.task.maxvmem",String.valueOf(1 * 1024 * 1024));
  Assert.assertEquals(configuration.getMaxVirtualMemoryForTask(),1 * 1024 * 1024);
  configuration=new JobConf();
  configuration.setMaxVirtualMemoryForTask(2 * 1024 * 1024);
  Assert.assertEquals(configuration.getMemoryForMapTask(),2);
  Assert.assertEquals(configuration.getMemoryForReduceTask(),2);
  configuration=new JobConf();
  configuration.set(MRJobConfig.MAP_MEMORY_MB,String.valueOf(300));
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,String.valueOf(400));
  configuration.setMaxVirtualMemoryForTask(2 * 1024 * 1024);
  Assert.assertEquals(configuration.getMemoryForMapTask(),2);
  Assert.assertEquals(configuration.getMemoryForReduceTask(),2);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that negative values for MAPRED_TASK_MAXVMEM_PROPERTY cause
 * new configuration keys' values to be used.
 */
@Test public void testNegativeValueForTaskVmem(){
  JobConf configuration=new JobConf();
  configuration.set(JobConf.MAPRED_TASK_MAXVMEM_PROPERTY,"-3");
  configuration.set(MRJobConfig.MAP_MEMORY_MB,"4");
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,"5");
  Assert.assertEquals(4,configuration.getMemoryForMapTask());
  Assert.assertEquals(5,configuration.getMemoryForReduceTask());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProfileParamsGetter(){
  JobConf configuration=new JobConf();
  configuration.set(MRJobConfig.TASK_PROFILE_PARAMS,"test");
  Assert.assertEquals("test",configuration.getProfileParams());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-6 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProfileParamsDefaults(){
  JobConf configuration=new JobConf();
  Assert.assertNull(configuration.get(MRJobConfig.TASK_PROFILE_PARAMS));
  String result=configuration.getProfileParams();
  Assert.assertNotNull(result);
  Assert.assertTrue(result.contains("file=%s"));
  Assert.assertTrue(result.startsWith("-agentlib:hprof"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProfileParamsSetter(){
  JobConf configuration=new JobConf();
  configuration.setProfileParams("test");
  Assert.assertEquals("test",configuration.get(MRJobConfig.TASK_PROFILE_PARAMS));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Testing mapred.task.maxvmem replacement with new values
 */
@Test public void testMemoryConfigForMapOrReduceTask(){
  JobConf configuration=new JobConf();
  configuration.set(MRJobConfig.MAP_MEMORY_MB,String.valueOf(300));
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,String.valueOf(300));
  Assert.assertEquals(configuration.getMemoryForMapTask(),300);
  Assert.assertEquals(configuration.getMemoryForReduceTask(),300);
  configuration.set("mapred.task.maxvmem",String.valueOf(2 * 1024 * 1024));
  configuration.set(MRJobConfig.MAP_MEMORY_MB,String.valueOf(300));
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,String.valueOf(300));
  Assert.assertEquals(configuration.getMemoryForMapTask(),2);
  Assert.assertEquals(configuration.getMemoryForReduceTask(),2);
  configuration=new JobConf();
  configuration.set("mapred.task.maxvmem","-1");
  configuration.set(MRJobConfig.MAP_MEMORY_MB,String.valueOf(300));
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,String.valueOf(400));
  Assert.assertEquals(configuration.getMemoryForMapTask(),300);
  Assert.assertEquals(configuration.getMemoryForReduceTask(),400);
  configuration=new JobConf();
  configuration.set("mapred.task.maxvmem",String.valueOf(2 * 1024 * 1024));
  configuration.set(MRJobConfig.MAP_MEMORY_MB,"-1");
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,"-1");
  Assert.assertEquals(configuration.getMemoryForMapTask(),2);
  Assert.assertEquals(configuration.getMemoryForReduceTask(),2);
  configuration=new JobConf();
  configuration.set("mapred.task.maxvmem",String.valueOf(-1));
  configuration.set(MRJobConfig.MAP_MEMORY_MB,"-1");
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,"-1");
  Assert.assertEquals(configuration.getMemoryForMapTask(),-1);
  Assert.assertEquals(configuration.getMemoryForReduceTask(),-1);
  configuration=new JobConf();
  configuration.set("mapred.task.maxvmem",String.valueOf(2 * 1024 * 1024));
  configuration.set(MRJobConfig.MAP_MEMORY_MB,"3");
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,"3");
  Assert.assertEquals(configuration.getMemoryForMapTask(),2);
  Assert.assertEquals(configuration.getMemoryForReduceTask(),2);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that negative values for all memory configuration properties causes
 * APIs to disable memory limits
 */
@Test public void testNegativeValuesForMemoryParams(){
  JobConf configuration=new JobConf();
  configuration.set(JobConf.MAPRED_TASK_MAXVMEM_PROPERTY,"-4");
  configuration.set(MRJobConfig.MAP_MEMORY_MB,"-5");
  configuration.set(MRJobConfig.REDUCE_MEMORY_MB,"-6");
  Assert.assertEquals(JobConf.DISABLED_MEMORY_LIMIT,configuration.getMemoryForMapTask());
  Assert.assertEquals(JobConf.DISABLED_MEMORY_LIMIT,configuration.getMemoryForReduceTask());
  Assert.assertEquals(JobConf.DISABLED_MEMORY_LIMIT,configuration.getMaxVirtualMemoryForTask());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.slive.TestSlive </h4><pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMRFlow() throws Exception {
  ConfigExtractor extractor=getTestConfig(false);
  SliveTest s=new SliveTest(getBaseConfig());
  int ec=ToolRunner.run(s,getTestArgs(false));
  assertTrue(ec == 0);
  String resFile=extractor.getResultFile();
  File fn=new File(resFile);
  assertTrue(fn.exists());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataWriting() throws Exception {
  long byteAm=100;
  File fn=getTestFile();
  DataWriter writer=new DataWriter(rnd);
  FileOutputStream fs=new FileOutputStream(fn);
  GenerateOutput ostat=writer.writeSegment(byteAm,fs);
  LOG.info(ostat);
  fs.close();
  assertTrue(ostat.getBytesWritten() == byteAm);
  DataVerifier vf=new DataVerifier();
  FileInputStream fin=new FileInputStream(fn);
  VerifyOutput vfout=vf.verifyFile(byteAm,new DataInputStream(fin));
  LOG.info(vfout);
  fin.close();
  assertEquals(vfout.getBytesRead(),byteAm);
  assertTrue(vfout.getChunksDifferent() == 0);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testArguments() throws Exception {
  ConfigExtractor extractor=getTestConfig(true);
  assertEquals(extractor.getOpCount().intValue(),Constants.OperationType.values().length);
  assertEquals(extractor.getMapAmount().intValue(),2);
  assertEquals(extractor.getReducerAmount().intValue(),2);
  Range<Long> apRange=extractor.getAppendSize();
  assertEquals(apRange.getLower().intValue(),Constants.MEGABYTES * 1);
  assertEquals(apRange.getUpper().intValue(),Constants.MEGABYTES * 2);
  Range<Long> wRange=extractor.getWriteSize();
  assertEquals(wRange.getLower().intValue(),Constants.MEGABYTES * 1);
  assertEquals(wRange.getUpper().intValue(),Constants.MEGABYTES * 2);
  Range<Long> bRange=extractor.getBlockSize();
  assertEquals(bRange.getLower().intValue(),Constants.MEGABYTES * 1);
  assertEquals(bRange.getUpper().intValue(),Constants.MEGABYTES * 2);
  String resfile=extractor.getResultFile();
  assertEquals(resfile,getResultFile().toString());
  int durationMs=extractor.getDurationMilliseconds();
  assertEquals(durationMs,10 * 1000);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRange(){
  Range<Long> r=new Range<Long>(10L,20L);
  assertEquals(r.getLower().longValue(),10L);
  assertEquals(r.getUpper().longValue(),20L);
}

</code></pre>

<br>
<pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBadChunks() throws Exception {
  File fn=getTestFile();
  int byteAm=10000;
  FileOutputStream fout=new FileOutputStream(fn);
  byte[] bytes=new byte[byteAm];
  rnd.nextBytes(bytes);
  fout.write(bytes);
  fout.close();
  DataVerifier vf=new DataVerifier();
  VerifyOutput vout=new VerifyOutput(0,0,0,0);
  DataInputStream in=null;
  try {
    in=new DataInputStream(new FileInputStream(fn));
    vout=vf.verifyFile(byteAm,in);
  }
 catch (  Exception e) {
  }
 finally {
    if (in != null)     in.close();
  }
  assertTrue(vout.getChunksSame() == 0);
}

</code></pre>

<br>
<pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSelector() throws Exception {
  ConfigExtractor extractor=getTestConfig(false);
  RouletteSelector selector=new RouletteSelector(rnd);
  List<OperationWeight> sList=new LinkedList<OperationWeight>();
  Operation op=selector.select(sList);
  assertTrue(op == null);
  CreateOp cop=new CreateOp(extractor,rnd);
  sList.add(new OperationWeight(cop,1.0d));
  AppendOp aop=new AppendOp(extractor,rnd);
  sList.add(new OperationWeight(aop,0.01d));
  op=selector.select(sList);
  assertTrue(op == cop);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestBlockPlacementPolicyRaid </h4><pre class="type-11 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that the har parity files will be placed at the good locations when we
 * create them.
 */
@Test public void testChooseTargetForHarRaidFile() throws IOException {
  setupCluster();
  try {
    String[] racks={"/rack2","/rack2","/rack2","/rack2","/rack2","/rack2"};
    String[] hosts={"host2.rack2.com","host3.rack2.com","host4.rack2.com","host5.rack2.com","host6.rack2.com","host7.rack2.com"};
    cluster.startDataNodes(conf,6,true,null,racks,hosts,null);
    String harParity=raidrsHarTempPrefix + "/dir/file";
    int numBlocks=11;
    DFSTestUtil.createFile(fs,new Path(harParity),numBlocks,(short)1,0L);
    DFSTestUtil.waitReplication(fs,new Path(harParity),(short)1);
    FileStatus stat=fs.getFileStatus(new Path(harParity));
    BlockLocation[] loc=fs.getFileBlockLocations(stat,0,stat.getLen());
    int rsParityLength=RaidNode.rsParityLength(conf);
    for (int i=0; i < numBlocks - rsParityLength; i++) {
      Set<String> locations=new HashSet<String>();
      for (int j=0; j < rsParityLength; j++) {
        for (int k=0; k < loc[i + j].getNames().length; k++) {
          String name=loc[i + j].getNames()[k];
          LOG.info("Har Raid block location: " + name);
          Assert.assertTrue(locations.add(name));
        }
      }
    }
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-11 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that the parity files will be placed at the good locations when we
 * create them.
 */
@Test public void testChooseTargetForRaidFile() throws IOException {
  setupCluster();
  try {
    String src="/dir/file";
    String parity=raidrsTempPrefix + src;
    DFSTestUtil.createFile(fs,new Path(src),4,(short)1,0L);
    DFSTestUtil.waitReplication(fs,new Path(src),(short)1);
    refreshPolicy();
    setBlockPlacementPolicy(namesystem,policy);
    String[] racks={"/rack2","/rack2","/rack2","/rack2","/rack2","/rack2"};
    String[] hosts={"host2.rack2.com","host3.rack2.com","host4.rack2.com","host5.rack2.com","host6.rack2.com","host7.rack2.com"};
    cluster.startDataNodes(conf,6,true,null,racks,hosts,null);
    int numBlocks=6;
    DFSTestUtil.createFile(fs,new Path(parity),numBlocks,(short)2,0L);
    DFSTestUtil.waitReplication(fs,new Path(parity),(short)2);
    FileStatus srcStat=fs.getFileStatus(new Path(src));
    BlockLocation[] srcLoc=fs.getFileBlockLocations(srcStat,0,srcStat.getLen());
    FileStatus parityStat=fs.getFileStatus(new Path(parity));
    BlockLocation[] parityLoc=fs.getFileBlockLocations(parityStat,0,parityStat.getLen());
    int parityLen=RaidNode.rsParityLength(conf);
    for (int i=0; i < numBlocks / parityLen; i++) {
      Set<String> locations=new HashSet<String>();
      for (int j=0; j < srcLoc.length; j++) {
        String[] names=srcLoc[j].getNames();
        for (int k=0; k < names.length; k++) {
          LOG.info("Source block location: " + names[k]);
          locations.add(names[k]);
        }
      }
      for (int j=0; j < parityLen; j++) {
        String[] names=parityLoc[j + i * parityLen].getNames();
        for (int k=0; k < names.length; k++) {
          LOG.info("Parity block location: " + names[k]);
          Assert.assertTrue(locations.add(names[k]));
        }
      }
    }
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-11 type-4 type-7 type-5 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test BlockPlacementPolicyRaid actually deletes the correct replica.
 * Start 2 datanodes and create 1 source file and its parity file.
 * 1) Start host1, create the parity file with replication 1
 * 2) Start host2, create the source file with replication 2
 * 3) Set repliation of source file to 1
 * Verify that the policy should delete the block with more companion blocks.
 */
@Test public void testDeleteReplica() throws IOException {
  setupCluster();
  try {
    setBlockPlacementPolicy(namesystem,new BlockPlacementPolicyDefault(conf,namesystem,namesystem.clusterMap));
    DatanodeDescriptor datanode1=namesystem.datanodeMap.values().iterator().next();
    String source="/dir/file";
    String parity=xorPrefix + source;
    final Path parityPath=new Path(parity);
    DFSTestUtil.createFile(fs,parityPath,3,(short)1,0L);
    DFSTestUtil.waitReplication(fs,parityPath,(short)1);
    cluster.startDataNodes(conf,1,true,null,rack2,host2,null);
    DatanodeDescriptor datanode2=null;
    for (    DatanodeDescriptor d : namesystem.datanodeMap.values()) {
      if (!d.getName().equals(datanode1.getName())) {
        datanode2=d;
      }
    }
    Assert.assertTrue(datanode2 != null);
    cluster.waitActive();
    final Path sourcePath=new Path(source);
    DFSTestUtil.createFile(fs,sourcePath,5,(short)2,0L);
    DFSTestUtil.waitReplication(fs,sourcePath,(short)2);
    refreshPolicy();
    Assert.assertEquals(parity,policy.getParityFile(source));
    Assert.assertEquals(source,policy.getSourceFile(parity,xorPrefix));
    List<LocatedBlock> sourceBlocks=getBlocks(namesystem,source);
    List<LocatedBlock> parityBlocks=getBlocks(namesystem,parity);
    Assert.assertEquals(5,sourceBlocks.size());
    Assert.assertEquals(3,parityBlocks.size());
    Collection<LocatedBlock> companionBlocks;
    companionBlocks=getCompanionBlocks(namesystem,policy,sourceBlocks.get(0).getBlock());
    verifyCompanionBlocks(companionBlocks,sourceBlocks,parityBlocks,new int[]{0,1},new int[]{0});
    companionBlocks=getCompanionBlocks(namesystem,policy,sourceBlocks.get(1).getBlock());
    verifyCompanionBlocks(companionBlocks,sourceBlocks,parityBlocks,new int[]{0,1},new int[]{0});
    companionBlocks=getCompanionBlocks(namesystem,policy,sourceBlocks.get(2).getBlock());
    verifyCompanionBlocks(companionBlocks,sourceBlocks,parityBlocks,new int[]{2,3},new int[]{1});
    companionBlocks=getCompanionBlocks(namesystem,policy,sourceBlocks.get(3).getBlock());
    verifyCompanionBlocks(companionBlocks,sourceBlocks,parityBlocks,new int[]{2,3},new int[]{1});
    companionBlocks=getCompanionBlocks(namesystem,policy,sourceBlocks.get(4).getBlock());
    verifyCompanionBlocks(companionBlocks,sourceBlocks,parityBlocks,new int[]{4},new int[]{2});
    companionBlocks=getCompanionBlocks(namesystem,policy,parityBlocks.get(0).getBlock());
    verifyCompanionBlocks(companionBlocks,sourceBlocks,parityBlocks,new int[]{0,1},new int[]{0});
    companionBlocks=getCompanionBlocks(namesystem,policy,parityBlocks.get(1).getBlock());
    verifyCompanionBlocks(companionBlocks,sourceBlocks,parityBlocks,new int[]{2,3},new int[]{1});
    companionBlocks=getCompanionBlocks(namesystem,policy,parityBlocks.get(2).getBlock());
    verifyCompanionBlocks(companionBlocks,sourceBlocks,parityBlocks,new int[]{4},new int[]{2});
    refreshPolicy();
    setBlockPlacementPolicy(namesystem,policy);
    fs.setReplication(sourcePath,(short)1);
    DFSTestUtil.waitReplication(fs,sourcePath,(short)1);
    Map<String,Integer> counters=new HashMap<String,Integer>();
    refreshPolicy();
    for (int i=0; i < parityBlocks.size(); i++) {
      companionBlocks=getCompanionBlocks(namesystem,policy,parityBlocks.get(i).getBlock());
      counters=BlockPlacementPolicyRaid.countCompanionBlocks(companionBlocks,false);
      Assert.assertTrue(counters.get(datanode1.getName()) >= 1 && counters.get(datanode1.getName()) <= 2);
      Assert.assertTrue(counters.get(datanode1.getName()) + counters.get(datanode2.getName()) == companionBlocks.size());
      counters=BlockPlacementPolicyRaid.countCompanionBlocks(companionBlocks,true);
      Assert.assertTrue(counters.get(datanode1.getParent().getName()) >= 1 && counters.get(datanode1.getParent().getName()) <= 2);
      Assert.assertTrue(counters.get(datanode1.getParent().getName()) + counters.get(datanode2.getParent().getName()) == companionBlocks.size());
    }
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.JobClientUnitTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("deprecation") @Test public void testReduceTaskReportsWithNullJob() throws Exception {
  JobClient client=new JobClient();
  Cluster mockCluster=mock(Cluster.class);
  client.cluster=mockCluster;
  JobID id=new JobID("test",0);
  when(mockCluster.getJob(id)).thenReturn(null);
  TaskReport[] result=client.getReduceTaskReports(id);
  assertEquals(0,result.length);
  verify(mockCluster).getJob(id);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("deprecation") @Test public void testCleanupTaskReportsWithNullJob() throws Exception {
  JobClient client=new JobClient();
  Cluster mockCluster=mock(Cluster.class);
  client.cluster=mockCluster;
  JobID id=new JobID("test",0);
  when(mockCluster.getJob(id)).thenReturn(null);
  TaskReport[] result=client.getCleanupTaskReports(id);
  assertEquals(0,result.length);
  verify(mockCluster).getJob(id);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("deprecation") @Test public void testSetupTaskReportsWithNullJob() throws Exception {
  JobClient client=new JobClient();
  Cluster mockCluster=mock(Cluster.class);
  client.cluster=mockCluster;
  JobID id=new JobID("test",0);
  when(mockCluster.getJob(id)).thenReturn(null);
  TaskReport[] result=client.getSetupTaskReports(id);
  assertEquals(0,result.length);
  verify(mockCluster).getJob(id);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("deprecation") @Test public void testMapTaskReportsWithNullJob() throws Exception {
  JobClient client=new JobClient();
  Cluster mockCluster=mock(Cluster.class);
  client.cluster=mockCluster;
  JobID id=new JobID("test",0);
  when(mockCluster.getJob(id)).thenReturn(null);
  TaskReport[] result=client.getMapTaskReports(id);
  assertEquals(0,result.length);
  verify(mockCluster).getJob(id);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestCluster </h4><pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testProcessInfo() throws Exception {
  LOG.info("Process info of JobTracker is : " + cluster.getJTClient().getProcessInfo());
  Assert.assertNotNull(cluster.getJTClient().getProcessInfo());
  Collection<TTClient> tts=cluster.getTTClients();
  for (  TTClient tt : tts) {
    LOG.info("Process info of TaskTracker is : " + tt.getProcessInfo());
    Assert.assertNotNull(tt.getProcessInfo());
  }
}

</code></pre>

<br>
<pre class="type-10 type-11 type-13 type-14 type-4 type-7 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to verify the common properties of tasks.
 * @throws Exception
 */
@Test public void testTaskDetails() throws Exception {
  Configuration conf=new Configuration(cluster.getConf());
  JTProtocol wovenClient=cluster.getJTClient().getProxy();
  FinishTaskControlAction.configureControlActionForJob(conf);
  SleepJob job=new SleepJob();
  job.setConf(conf);
  Job rJob=job.createJob(1,1,100,100,100,100);
  JobClient client=cluster.getJTClient().getClient();
  rJob.submit();
  RunningJob rJob1=client.getJob(org.apache.hadoop.mapred.JobID.downgrade(rJob.getJobID()));
  JobID id=rJob.getJobID();
  JobInfo jInfo=wovenClient.getJobInfo(id);
  while (jInfo.getStatus().getRunState() != JobStatus.RUNNING) {
    Thread.sleep(1000);
    jInfo=wovenClient.getJobInfo(id);
  }
  LOG.info("Waiting till job starts running one map");
  TaskInfo[] myTaskInfos=wovenClient.getTaskInfo(id);
  boolean isOneTaskStored=false;
  String sometaskpid=null;
  org.apache.hadoop.mapreduce.TaskAttemptID sometaskId=null;
  TTClient myCli=null;
  for (  TaskInfo info : myTaskInfos) {
    if (!info.isSetupOrCleanup()) {
      String[] taskTrackers=info.getTaskTrackers();
      for (      String taskTracker : taskTrackers) {
        TTInfo ttInfo=wovenClient.getTTInfo(taskTracker);
        TTClient ttCli=cluster.getTTClient(ttInfo.getStatus().getHost());
        TaskID taskId=info.getTaskID();
        TTTaskInfo ttTaskInfo=ttCli.getProxy().getTask(taskId);
        Assert.assertNotNull(ttTaskInfo);
        Assert.assertNotNull(ttTaskInfo.getConf());
        Assert.assertNotNull(ttTaskInfo.getUser());
        Assert.assertTrue(ttTaskInfo.getTaskStatus().getProgress() >= 0.0);
        Assert.assertTrue(ttTaskInfo.getTaskStatus().getProgress() <= 1.0);
        String pid=ttTaskInfo.getPid();
        int i=1;
        while (pid.isEmpty()) {
          Thread.sleep(1000);
          LOG.info("Waiting for task to report its pid back");
          ttTaskInfo=ttCli.getProxy().getTask(taskId);
          pid=ttTaskInfo.getPid();
          if (i == 40) {
            Assert.fail("The task pid not reported for 40 seconds.");
          }
          i++;
        }
        if (!isOneTaskStored) {
          sometaskpid=pid;
          sometaskId=ttTaskInfo.getTaskStatus().getTaskID();
          myCli=ttCli;
          isOneTaskStored=true;
        }
        LOG.info("verified task progress to be between 0 and 1");
        State state=ttTaskInfo.getTaskStatus().getRunState();
        if (ttTaskInfo.getTaskStatus().getProgress() < 1.0 && ttTaskInfo.getTaskStatus().getProgress() > 0.0) {
          Assert.assertEquals(TaskStatus.State.RUNNING,state);
          LOG.info("verified run state as " + state);
        }
        FinishTaskControlAction action=new FinishTaskControlAction(org.apache.hadoop.mapred.TaskID.downgrade(info.getTaskID()));
        ttCli.getProxy().sendAction(action);
      }
    }
  }
  rJob.killJob();
  int i=1;
  while (!rJob.isComplete()) {
    Thread.sleep(1000);
    if (i == 40) {
      Assert.fail("The job not completed within 40 seconds after killing it.");
    }
    i++;
  }
  TTTaskInfo myTaskInfo=myCli.getProxy().getTask(sometaskId.getTaskID());
  i=0;
  while (myTaskInfo != null && !myTaskInfo.getPid().isEmpty()) {
    LOG.info("sleeping till task is retired from TT memory");
    Thread.sleep(1000);
    myTaskInfo=myCli.getProxy().getTask(sometaskId.getTaskID());
    if (i == 40) {
      Assert.fail("Task not retired from TT memory within 40 seconds of job completeing");
    }
    i++;
  }
  Assert.assertFalse(myCli.getProxy().isProcessTreeAlive(sometaskpid));
}

</code></pre>

<br>
<pre class="type-13 type-14 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testClusterRestart() throws Exception {
  cluster.stop();
  AbstractDaemonClient cli=cluster.getJTClient();
  int i=1;
  while (i < 40) {
    try {
      cli.ping();
      Thread.sleep(1000);
      i++;
    }
 catch (    Exception e) {
      break;
    }
  }
  if (i >= 40) {
    Assert.fail("JT on " + cli.getHostName() + " Should have been down.");
  }
  i=1;
  for (  AbstractDaemonClient tcli : cluster.getTTClients()) {
    i=1;
    while (i < 40) {
      try {
        tcli.ping();
        Thread.sleep(1000);
        i++;
      }
 catch (      Exception e) {
        break;
      }
    }
    if (i >= 40) {
      Assert.fail("TT on " + tcli.getHostName() + " Should have been down.");
    }
  }
  cluster.start();
  cli=cluster.getJTClient();
  i=1;
  while (i < 40) {
    try {
      cli.ping();
      break;
    }
 catch (    Exception e) {
      i++;
      Thread.sleep(1000);
      LOG.info("Waiting for Jobtracker on host : " + cli.getHostName() + " to come up.");
    }
  }
  if (i >= 40) {
    Assert.fail("JT on " + cli.getHostName() + " Should have been up.");
  }
  for (  AbstractDaemonClient tcli : cluster.getTTClients()) {
    i=1;
    while (i < 40) {
      try {
        tcli.ping();
        break;
      }
 catch (      Exception e) {
        i++;
        Thread.sleep(1000);
        LOG.info("Waiting for Tasktracker on host : " + tcli.getHostName() + " to come up.");
      }
    }
    if (i >= 40) {
      Assert.fail("TT on " + tcli.getHostName() + " Should have been Up.");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestCombineFileInputFormat </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test getSplits
 */
@Test @SuppressWarnings("unchecked") public void testSplits() throws IOException {
  JobConf job=new JobConf(defaultConf);
  localFs.delete(workDir,true);
  writeFile(localFs,new Path(workDir,"test.txt"),"the quick\nbrown\nfox jumped\nover\n the lazy\n dog\n");
  FileInputFormat.setInputPaths(job,workDir);
  CombineFileInputFormat format=new CombineFileInputFormat(){
    @Override public RecordReader getRecordReader(    InputSplit split,    JobConf job,    Reporter reporter) throws IOException {
      return new CombineFileRecordReader(job,(CombineFileSplit)split,reporter,CombineFileRecordReader.class);
    }
  }
;
  final int SIZE_SPLITS=1;
  LOG.info("Trying to getSplits with splits = " + SIZE_SPLITS);
  InputSplit[] splits=format.getSplits(job,SIZE_SPLITS);
  LOG.info("Got getSplits = " + splits.length);
  assertEquals("splits == " + SIZE_SPLITS,SIZE_SPLITS,splits.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestConcatenatedCompressedInput </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test using the bzip2 codec for reading
 */
@Test public void testBzip2() throws IOException {
  JobConf jobConf=new JobConf(defaultConf);
  CompressionCodec bzip2=new BZip2Codec();
  ReflectionUtils.setConf(bzip2,jobConf);
  localFs.delete(workDir,true);
  System.out.println(COLOR_BR_CYAN + "testBzip2() using non-native CBZip2InputStream (presumably)" + COLOR_NORMAL);
  final String fn="concat" + bzip2.getDefaultExtension();
  Path fnLocal=new Path(System.getProperty("test.concat.data","/tmp"),fn);
  Path fnHDFS=new Path(workDir,fn);
  localFs.copyFromLocalFile(fnLocal,fnHDFS);
  writeFile(localFs,new Path(workDir,"part2.txt.bz2"),bzip2,"this is a test\nof bzip2\n");
  FileInputFormat.setInputPaths(jobConf,workDir);
  TextInputFormat format=new TextInputFormat();
  format.configure(jobConf);
  format.setMinSplitSize(256);
  InputSplit[] splits=format.getSplits(jobConf,100);
  assertEquals("compressed splits == 2",2,splits.length);
  FileSplit tmp=(FileSplit)splits[0];
  if (tmp.getPath().getName().equals("part2.txt.bz2")) {
    splits[0]=splits[1];
    splits[1]=tmp;
  }
  List<Text> results=readSplit(format,splits[0],jobConf);
  assertEquals("splits[0] num lines",6,results.size());
  assertEquals("splits[0][5]","member #3",results.get(5).toString());
  results=readSplit(format,splits[1],jobConf);
  assertEquals("splits[1] num lines",2,results.size());
  assertEquals("splits[1][0]","this is a test",results.get(0).toString());
  assertEquals("splits[1][1]","of bzip2",results.get(1).toString());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test using the new BuiltInGzipDecompressor codec for reading gzip files.
 */
@Test public void testBuiltInGzipDecompressor() throws IOException {
  JobConf jobConf=new JobConf(defaultConf);
  jobConf.setBoolean("io.native.lib.available",false);
  CompressionCodec gzip=new GzipCodec();
  ReflectionUtils.setConf(gzip,jobConf);
  localFs.delete(workDir,true);
  assertEquals("[non-native (Java) codec]",org.apache.hadoop.io.compress.zlib.BuiltInGzipDecompressor.class,gzip.getDecompressorType());
  System.out.println(COLOR_BR_YELLOW + "testBuiltInGzipDecompressor() using" + " non-native (Java Inflater) Decompressor ("+ gzip.getDecompressorType()+ ")"+ COLOR_NORMAL);
  String fn1="testConcatThenCompress.txt" + gzip.getDefaultExtension();
  Path fnLocal1=new Path(System.getProperty("test.concat.data","/tmp"),fn1);
  Path fnHDFS1=new Path(workDir,fn1);
  localFs.copyFromLocalFile(fnLocal1,fnHDFS1);
  String fn2="testCompressThenConcat.txt" + gzip.getDefaultExtension();
  Path fnLocal2=new Path(System.getProperty("test.concat.data","/tmp"),fn2);
  Path fnHDFS2=new Path(workDir,fn2);
  localFs.copyFromLocalFile(fnLocal2,fnHDFS2);
  FileInputFormat.setInputPaths(jobConf,workDir);
  final FileInputStream in1=new FileInputStream(fnLocal1.toString());
  final FileInputStream in2=new FileInputStream(fnLocal2.toString());
  assertEquals("concat bytes available",2734,in1.available());
  assertEquals("concat bytes available",3413,in2.available());
  CompressionInputStream cin2=gzip.createInputStream(in2);
  LineReader in=new LineReader(cin2);
  Text out=new Text();
  int numBytes, totalBytes=0, lineNum=0;
  while ((numBytes=in.readLine(out)) > 0) {
    ++lineNum;
    totalBytes+=numBytes;
  }
  in.close();
  assertEquals("total uncompressed bytes in concatenated test file",5346,totalBytes);
  assertEquals("total uncompressed lines in concatenated test file",84,lineNum);
  doMultipleGzipBufferSizes(jobConf,false);
  doMultipleGzipBufferSizes(jobConf,true);
}

</code></pre>

<br>
<pre class="type-10 type-11 type-13 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test using the raw Inflater codec for reading gzip files.
 */
@Test public void testPrototypeInflaterGzip() throws IOException {
  CompressionCodec gzip=new GzipCodec();
  localFs.delete(workDir,true);
  System.out.println(COLOR_BR_BLUE + "testPrototypeInflaterGzip() using " + "non-native/Java Inflater and manual gzip header/trailer parsing"+ COLOR_NORMAL);
  final String fn="concat" + gzip.getDefaultExtension();
  Path fnLocal=new Path(System.getProperty("test.concat.data","/tmp"),fn);
  Path fnHDFS=new Path(workDir,fn);
  localFs.copyFromLocalFile(fnLocal,fnHDFS);
  final FileInputStream in=new FileInputStream(fnLocal.toString());
  assertEquals("concat bytes available",148,in.available());
  byte[] compressedBuf=new byte[256];
  int numBytesRead=in.read(compressedBuf,0,10);
  assertEquals("header bytes read",10,numBytesRead);
  assertEquals("1st byte",0x1f,compressedBuf[0] & 0xff);
  assertEquals("2nd byte",0x8b,compressedBuf[1] & 0xff);
  assertEquals("3rd byte (compression method)",8,compressedBuf[2] & 0xff);
  byte flags=(byte)(compressedBuf[3] & 0xff);
  if ((flags & 0x04) != 0) {
    numBytesRead=in.read(compressedBuf,0,2);
    assertEquals("XLEN bytes read",2,numBytesRead);
    int xlen=((compressedBuf[1] << 8) | compressedBuf[0]) & 0xffff;
    in.skip(xlen);
  }
  if ((flags & 0x08) != 0) {
    while ((numBytesRead=in.read()) != 0) {
      assertFalse("unexpected end-of-file while reading filename",numBytesRead == -1);
    }
  }
  if ((flags & 0x10) != 0) {
    while ((numBytesRead=in.read()) != 0) {
      assertFalse("unexpected end-of-file while reading comment",numBytesRead == -1);
    }
  }
  if ((flags & 0xe0) != 0) {
    assertTrue("reserved bits are set??",(flags & 0xe0) == 0);
  }
  if ((flags & 0x02) != 0) {
    numBytesRead=in.read(compressedBuf,0,2);
    assertEquals("CRC16 bytes read",2,numBytesRead);
    int crc16=((compressedBuf[1] << 8) | compressedBuf[0]) & 0xffff;
  }
  numBytesRead=in.read(compressedBuf);
  byte[] uncompressedBuf=new byte[256];
  Inflater inflater=new Inflater(true);
  inflater.setInput(compressedBuf,0,numBytesRead);
  try {
    int numBytesUncompressed=inflater.inflate(uncompressedBuf);
    String outString=new String(uncompressedBuf,0,numBytesUncompressed,"UTF-8");
    System.out.println("uncompressed data of first gzip member = [" + outString + "]");
  }
 catch (  java.util.zip.DataFormatException ex) {
    throw new IOException(ex.getMessage());
  }
  in.close();
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Extended bzip2 test, similar to BuiltInGzipDecompressor test above.
 */
@Test public void testMoreBzip2() throws IOException {
  JobConf jobConf=new JobConf(defaultConf);
  CompressionCodec bzip2=new BZip2Codec();
  ReflectionUtils.setConf(bzip2,jobConf);
  localFs.delete(workDir,true);
  System.out.println(COLOR_BR_MAGENTA + "testMoreBzip2() using non-native CBZip2InputStream (presumably)" + COLOR_NORMAL);
  String fn1="testConcatThenCompress.txt" + bzip2.getDefaultExtension();
  Path fnLocal1=new Path(System.getProperty("test.concat.data","/tmp"),fn1);
  Path fnHDFS1=new Path(workDir,fn1);
  localFs.copyFromLocalFile(fnLocal1,fnHDFS1);
  String fn2="testCompressThenConcat.txt" + bzip2.getDefaultExtension();
  Path fnLocal2=new Path(System.getProperty("test.concat.data","/tmp"),fn2);
  Path fnHDFS2=new Path(workDir,fn2);
  localFs.copyFromLocalFile(fnLocal2,fnHDFS2);
  FileInputFormat.setInputPaths(jobConf,workDir);
  final FileInputStream in1=new FileInputStream(fnLocal1.toString());
  final FileInputStream in2=new FileInputStream(fnLocal2.toString());
  assertEquals("concat bytes available",2567,in1.available());
  assertEquals("concat bytes available",3056,in2.available());
  doMultipleBzip2BufferSizes(jobConf,false);
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test using Hadoop's original, native-zlib gzip codec for reading.
 */
@Test public void testGzip() throws IOException {
  JobConf jobConf=new JobConf(defaultConf);
  CompressionCodec gzip=new GzipCodec();
  ReflectionUtils.setConf(gzip,jobConf);
  localFs.delete(workDir,true);
  if (org.apache.hadoop.io.compress.zlib.BuiltInGzipDecompressor.class == gzip.getDecompressorType()) {
    System.out.println(COLOR_BR_RED + "testGzip() using native-zlib Decompressor (" + gzip.getDecompressorType()+ ")"+ COLOR_NORMAL);
  }
 else {
    LOG.warn("testGzip() skipped:  native (C/C++) libs not loaded");
    return;
  }
  final String fn="concat" + gzip.getDefaultExtension();
  Path fnLocal=new Path(System.getProperty("test.concat.data","/tmp"),fn);
  Path fnHDFS=new Path(workDir,fn);
  localFs.copyFromLocalFile(fnLocal,fnHDFS);
  writeFile(localFs,new Path(workDir,"part2.txt.gz"),gzip,"this is a test\nof gzip\n");
  FileInputFormat.setInputPaths(jobConf,workDir);
  TextInputFormat format=new TextInputFormat();
  format.configure(jobConf);
  InputSplit[] splits=format.getSplits(jobConf,100);
  assertEquals("compressed splits == 2",2,splits.length);
  FileSplit tmp=(FileSplit)splits[0];
  if (tmp.getPath().getName().equals("part2.txt.gz")) {
    splits[0]=splits[1];
    splits[1]=tmp;
  }
  List<Text> results=readSplit(format,splits[0],jobConf);
  assertEquals("splits[0] num lines",6,results.size());
  assertEquals("splits[0][5]","member #3",results.get(5).toString());
  results=readSplit(format,splits[1],jobConf);
  assertEquals("splits[1] num lines",2,results.size());
  assertEquals("splits[1][0]","this is a test",results.get(0).toString());
  assertEquals("splits[1][1]","of gzip",results.get(1).toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestControlledJob </h4><pre class="type-11 type-13 type-14 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testControlledJob() throws Exception {
  Configuration conf=new Configuration(cluster.getConf());
  JTProtocol wovenClient=cluster.getJTClient().getProxy();
  FinishTaskControlAction.configureControlActionForJob(conf);
  SleepJob job=new SleepJob();
  job.setConf(conf);
  Job slpJob=job.createJob(1,0,100,100,100,100);
  slpJob.submit();
  JobClient client=cluster.getJTClient().getClient();
  RunningJob rJob=client.getJob(org.apache.hadoop.mapred.JobID.downgrade(slpJob.getJobID()));
  JobID id=rJob.getID();
  JobInfo jInfo=wovenClient.getJobInfo(id);
  while (jInfo.getStatus().getRunState() != JobStatus.RUNNING) {
    Thread.sleep(1000);
    jInfo=wovenClient.getJobInfo(id);
  }
  LOG.info("Waiting till job starts running one map");
  jInfo=wovenClient.getJobInfo(id);
  Assert.assertEquals(jInfo.runningMaps(),1);
  LOG.info("waiting for another cycle to " + "check if the maps dont finish off");
  Thread.sleep(1000);
  jInfo=wovenClient.getJobInfo(id);
  Assert.assertEquals(jInfo.runningMaps(),1);
  TaskInfo[] taskInfos=wovenClient.getTaskInfo(id);
  for (  TaskInfo info : taskInfos) {
    LOG.info("constructing control action to signal task to finish");
    FinishTaskControlAction action=new FinishTaskControlAction(TaskID.downgrade(info.getTaskID()));
    for (    TTClient cli : cluster.getTTClients()) {
      cli.getProxy().sendAction(action);
    }
  }
  jInfo=wovenClient.getJobInfo(id);
  int i=1;
  if (jInfo != null) {
    while (!jInfo.getStatus().isJobComplete()) {
      Thread.sleep(1000);
      jInfo=wovenClient.getJobInfo(id);
      if (jInfo == null) {
        break;
      }
      if (i > 40) {
        Assert.fail("Controlled Job with ID : " + jInfo.getID() + " has not completed in 40 seconds after signalling.");
      }
      i++;
    }
  }
  LOG.info("Job sucessfully completed after signalling!!!!");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestDistributedCacheModifiedFile </h4><pre class="type-10 type-11 type-13 type-14 type-4 type-7 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistributedCache() throws Exception {
  Configuration conf=new Configuration(cluster.getConf());
  JTProtocol wovenClient=cluster.getJTClient().getProxy();
  int count=0;
  boolean continueLoop=true;
  int countLoop=0;
  int taskTrackerCounter=0;
  ArrayList<String> taskTrackerCollection=new ArrayList<String>();
  boolean taskTrackerFound=false;
  do {
    SleepJob job=new SleepJob();
    job.setConf(conf);
    Job slpJob=job.createJob(5,1,1000,1000,100,100);
    String input="This will be the content of\n" + "distributed cache\n";
    DataOutputStream file=UtilsForTests.createTmpFileDFS(dfs,URIPATH,permission,input);
    DistributedCache.createSymlink(conf);
    URI uri=URI.create(uriPath);
    DistributedCache.addCacheFile(uri,conf);
    JobConf jconf=new JobConf(conf);
    FinishTaskControlAction.configureControlActionForJob(conf);
    slpJob.submit();
    RunningJob rJob=cluster.getJTClient().getClient().getJob(org.apache.hadoop.mapred.JobID.downgrade(slpJob.getJobID()));
    countLoop++;
    TTClient tClient=null;
    JobInfo jInfo=wovenClient.getJobInfo(rJob.getID());
    LOG.info("jInfo is :" + jInfo);
    Assert.assertNotNull("jobInfo is null",jInfo);
    count=0;
    while (jInfo.getStatus().getRunState() != JobStatus.RUNNING) {
      UtilsForTests.waitFor(10000);
      count++;
      jInfo=wovenClient.getJobInfo(rJob.getID());
      if (count > 10) {
        Assert.fail("job has not reached running state for more than" + "100 seconds. Failing at this point");
      }
    }
    LOG.info("job id is :" + rJob.getID().toString());
    TaskInfo[] taskInfos=cluster.getJTClient().getProxy().getTaskInfo(rJob.getID());
    boolean distCacheFileIsFound;
    for (    TaskInfo taskInfo : taskInfos) {
      distCacheFileIsFound=false;
      String[] taskTrackers=taskInfo.getTaskTrackers();
      for (      String taskTracker : taskTrackers) {
        taskTracker=UtilsForTests.getFQDNofTT(taskTracker);
        LOG.info("taskTracker is :" + taskTracker);
        taskTrackerFound=false;
        if (countLoop > 1) {
          if (taskTracker != null) {
            continueLoop=taskTrackerCollection.contains(taskTracker);
          }
          if (continueLoop) {
            taskTrackerFound=true;
          }
        }
        if (taskTracker != null)         taskTrackerCollection.add(taskTracker);
        if (countLoop > 1) {
          continueLoop=false;
        }
        tClient=cluster.getTTClient(taskTracker);
        if (tClient == null) {
          continue;
        }
        String[] localDirs=tClient.getMapredLocalDirs();
        int distributedFileCount=0;
        for (        String localDir : localDirs) {
          localDir=localDir + Path.SEPARATOR + TaskTracker.getPublicDistributedCacheDir();
          LOG.info("localDir is : " + localDir);
          FileStatus[] fileStatuses=tClient.listStatus(localDir,true,true);
          for (          FileStatus fileStatus : fileStatuses) {
            Path path=fileStatus.getPath();
            LOG.info("path is :" + path.toString());
            distCacheFileIsFound=(path.toString()).endsWith(distributedFileName);
            if (distCacheFileIsFound) {
              LOG.info("PATH found is :" + path.toString());
              distributedFileCount++;
              String filename=path.getName();
              FsPermission fsPerm=fileStatus.getPermission();
              Assert.assertTrue("File Permission is not 777",fsPerm.equals(new FsPermission("777")));
            }
          }
        }
        LOG.debug("The distributed FileCount is :" + distributedFileCount);
        LOG.debug("The taskTrackerFound is :" + taskTrackerFound);
        if (distributedFileCount != 2 && taskTrackerFound) {
          Assert.fail("The distributed cache file has to be two. " + "But found was " + distributedFileCount);
        }
 else         if (distributedFileCount > 1 && !taskTrackerFound) {
          Assert.fail("The distributed cache file cannot more than one." + " But found was " + distributedFileCount);
        }
 else         if (distributedFileCount < 1)         Assert.fail("The distributed cache file is less than one. " + "But found was " + distributedFileCount);
        if (!distCacheFileIsFound) {
          Assert.assertEquals("The distributed cache file does not exist",distCacheFileIsFound,false);
        }
      }
    }
    for (    TaskInfo taskInfoRemaining : taskInfos) {
      FinishTaskControlAction action=new FinishTaskControlAction(TaskID.downgrade(taskInfoRemaining.getTaskID()));
      Collection<TTClient> tts=cluster.getTTClients();
      for (      TTClient cli : tts) {
        cli.getProxy().sendAction(action);
      }
    }
    rJob.killJob();
    Thread.sleep(3000);
    TaskInfo[] myTaskInfos=wovenClient.getTaskInfo(rJob.getID());
    if (myTaskInfos != null) {
      for (      TaskInfo info : myTaskInfos) {
        if (info.isSetupOrCleanup()) {
          String[] taskTrackers=info.getTaskTrackers();
          for (          String taskTracker : taskTrackers) {
            taskTracker=UtilsForTests.getFQDNofTT(taskTracker);
            LOG.info("taskTracker is :" + taskTracker);
            if (taskTracker != null)             taskTrackerCollection.add(taskTracker);
          }
        }
      }
    }
    while (jInfo != null && !jInfo.getStatus().isJobComplete()) {
      Thread.sleep(10000);
      jInfo=wovenClient.getJobInfo(rJob.getID());
    }
  }
 while (continueLoop);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestDistributedCachePrivateFile </h4><pre class="type-10 type-11 type-13 type-14 type-4 type-7 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistributedCache() throws Exception {
  Configuration conf=new Configuration(cluster.getConf());
  JTProtocol wovenClient=cluster.getJTClient().getProxy();
  int count=0;
  SleepJob job=new SleepJob();
  job.setConf(conf);
  Job slpJob=job.createJob(5,1,1000,1000,100,100);
  DistributedCache.createSymlink(conf);
  URI uri=URI.create(uriPath);
  DistributedCache.addCacheFile(uri,conf);
  JobConf jconf=new JobConf(conf);
  FinishTaskControlAction.configureControlActionForJob(conf);
  slpJob.submit();
  RunningJob rJob=cluster.getJTClient().getClient().getJob(org.apache.hadoop.mapred.JobID.downgrade(slpJob.getJobID()));
  JobStatus[] jobStatus=client.getAllJobs();
  String userName=jobStatus[0].getUsername();
  TTClient tClient=null;
  JobInfo jInfo=wovenClient.getJobInfo(rJob.getID());
  LOG.info("jInfo is :" + jInfo);
  Assert.assertNotNull("jobInfo is null",jInfo);
  count=0;
  while (jInfo.getStatus().getRunState() != JobStatus.RUNNING) {
    UtilsForTests.waitFor(10000);
    count++;
    jInfo=wovenClient.getJobInfo(rJob.getID());
    if (count > 10) {
      Assert.fail("job has not reached running state for more than" + "100 seconds. Failing at this point");
    }
  }
  LOG.info("job id is :" + rJob.getID().toString());
  TaskInfo[] taskInfos=cluster.getJTClient().getProxy().getTaskInfo(rJob.getID());
  boolean distCacheFileIsFound;
  for (  TaskInfo taskInfo : taskInfos) {
    distCacheFileIsFound=false;
    String[] taskTrackers=taskInfo.getTaskTrackers();
    for (    String taskTracker : taskTrackers) {
      taskTracker=UtilsForTests.getFQDNofTT(taskTracker);
      tClient=cluster.getTTClient(taskTracker);
      String[] localDirs=tClient.getMapredLocalDirs();
      int distributedFileCount=0;
      String localDirOnly=null;
      boolean FileNotPresentForThisDirectoryPath=false;
      for (      String localDir : localDirs) {
        FileNotPresentForThisDirectoryPath=false;
        localDirOnly=localDir;
        localDirOnly=localDir + Path.SEPARATOR + TaskTracker.SUBDIR+ Path.SEPARATOR+ userName;
        localDir=localDir + Path.SEPARATOR + TaskTracker.getPrivateDistributedCacheDir(userName);
        FileStatus fileStatusMapredLocalDirUserName=null;
        try {
          fileStatusMapredLocalDirUserName=tClient.getFileStatus(localDirOnly,true);
        }
 catch (        Exception e) {
          LOG.info("LocalDirOnly :" + localDirOnly + " not found");
          FileNotPresentForThisDirectoryPath=true;
        }
        if (FileNotPresentForThisDirectoryPath)         continue;
        Path pathMapredLocalDirUserName=fileStatusMapredLocalDirUserName.getPath();
        FsPermission fsPermMapredLocalDirUserName=fileStatusMapredLocalDirUserName.getPermission();
        Assert.assertTrue("Directory Permission is not 700",fsPermMapredLocalDirUserName.equals(new FsPermission("700")));
        FileStatus[] fileStatuses=tClient.listStatus(localDir,true,true);
        for (        FileStatus fileStatus : fileStatuses) {
          Path path=fileStatus.getPath();
          LOG.info("path is :" + path.toString());
          distCacheFileIsFound=(path.toString()).endsWith(distributedFileName);
          if (distCacheFileIsFound) {
            LOG.info("PATH found is :" + path.toString());
            distributedFileCount++;
            String filename=path.getName();
            FsPermission fsPerm=fileStatus.getPermission();
            Assert.assertTrue("File Permission is not 777",fsPerm.equals(new FsPermission("777")));
          }
        }
      }
      LOG.info("Distributed File count is :" + distributedFileCount);
      if (distributedFileCount > 1) {
        Assert.fail("The distributed cache file is more than one");
      }
 else       if (distributedFileCount < 1)       Assert.fail("The distributed cache file is less than one");
      if (!distCacheFileIsFound) {
        Assert.assertEquals("The distributed cache file does not exist",distCacheFileIsFound,false);
      }
    }
    for (    TaskInfo taskInfoRemaining : taskInfos) {
      FinishTaskControlAction action=new FinishTaskControlAction(TaskID.downgrade(taskInfoRemaining.getTaskID()));
      Collection<TTClient> tts=cluster.getTTClients();
      for (      TTClient cli : tts) {
        cli.getProxy().sendAction(action);
      }
    }
    rJob.killJob();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestDistributedCacheUnModifiedFile </h4><pre class="type-10 type-11 type-13 type-14 type-4 type-7 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistributedCache() throws Exception {
  Configuration conf=new Configuration(cluster.getConf());
  JTProtocol wovenClient=cluster.getJTClient().getProxy();
  int count=0;
  boolean continueLoop=true;
  int countLoop=0;
  int taskTrackerCounter=0;
  ArrayList<String> taskTrackerCollection=new ArrayList<String>();
  do {
    SleepJob job=new SleepJob();
    job.setConf(conf);
    Job slpJob=job.createJob(5,1,1000,1000,100,100);
    DistributedCache.createSymlink(conf);
    URI uri=URI.create(uriPath);
    DistributedCache.addCacheFile(uri,conf);
    JobConf jconf=new JobConf(conf);
    FinishTaskControlAction.configureControlActionForJob(conf);
    slpJob.submit();
    RunningJob rJob=cluster.getJTClient().getClient().getJob(org.apache.hadoop.mapred.JobID.downgrade(slpJob.getJobID()));
    countLoop++;
    TTClient tClient=null;
    JobInfo jInfo=wovenClient.getJobInfo(rJob.getID());
    LOG.info("jInfo is :" + jInfo);
    Assert.assertNotNull("jobInfo is null",jInfo);
    count=0;
    while (jInfo.getStatus().getRunState() != JobStatus.RUNNING) {
      UtilsForTests.waitFor(10000);
      count++;
      jInfo=wovenClient.getJobInfo(rJob.getID());
      if (count > 10) {
        Assert.fail("job has not reached running state for more than" + "100 seconds. Failing at this point");
      }
    }
    LOG.info("job id is :" + rJob.getID().toString());
    TaskInfo[] taskInfos=cluster.getJTClient().getProxy().getTaskInfo(rJob.getID());
    boolean distCacheFileIsFound;
    for (    TaskInfo taskInfo : taskInfos) {
      distCacheFileIsFound=false;
      String[] taskTrackers=taskInfo.getTaskTrackers();
      for (      String taskTracker : taskTrackers) {
        taskTracker=UtilsForTests.getFQDNofTT(taskTracker);
        LOG.info("taskTracker is :" + taskTracker);
        if (countLoop > 1) {
          if (taskTracker != null) {
            continueLoop=taskTrackerCollection.contains(taskTracker);
          }
          if (!continueLoop) {
            break;
          }
        }
        if (taskTracker != null)         taskTrackerCollection.add(taskTracker);
        if (countLoop > 2) {
          continueLoop=false;
        }
        tClient=cluster.getTTClient(taskTracker);
        if (tClient == null) {
          continue;
        }
        String[] localDirs=tClient.getMapredLocalDirs();
        int distributedFileCount=0;
        for (        String localDir : localDirs) {
          localDir=localDir + Path.SEPARATOR + TaskTracker.getPublicDistributedCacheDir();
          LOG.info("localDir is : " + localDir);
          FileStatus[] fileStatuses=tClient.listStatus(localDir,true,true);
          for (          FileStatus fileStatus : fileStatuses) {
            Path path=fileStatus.getPath();
            LOG.info("path is :" + path.toString());
            distCacheFileIsFound=(path.toString()).endsWith(distributedFileName);
            if (distCacheFileIsFound) {
              LOG.info("PATH found is :" + path.toString());
              distributedFileCount++;
              String filename=path.getName();
              FsPermission fsPerm=fileStatus.getPermission();
              Assert.assertTrue("File Permission is not 777",fsPerm.equals(new FsPermission("777")));
            }
          }
        }
        if (distributedFileCount > 1) {
          Assert.fail("The distributed cache file is more than one");
        }
 else         if (distributedFileCount < 1)         Assert.fail("The distributed cache file is less than one");
        if (!distCacheFileIsFound) {
          Assert.assertEquals("The distributed cache file does not exist",distCacheFileIsFound,false);
        }
      }
    }
    for (    TaskInfo taskInfoRemaining : taskInfos) {
      FinishTaskControlAction action=new FinishTaskControlAction(TaskID.downgrade(taskInfoRemaining.getTaskID()));
      Collection<TTClient> tts=cluster.getTTClients();
      for (      TTClient cli : tts) {
        cli.getProxy().sendAction(action);
      }
    }
    rJob.killJob();
  }
 while (continueLoop);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestFileOwner </h4><pre class="type-13 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFilePermission() throws Exception {
  wovenClient=cluster.getJTClient().getProxy();
  Configuration conf=new Configuration(cluster.getConf());
  FinishTaskControlAction.configureControlActionForJob(conf);
  SleepJob job=new SleepJob();
  job.setConf(conf);
  Job slpJob=job.createJob(1,0,100,100,100,100);
  JobConf jconf=new JobConf(conf);
  slpJob.submit();
  RunningJob rJob=cluster.getJTClient().getClient().getJob(org.apache.hadoop.mapred.JobID.downgrade(slpJob.getJobID()));
  taskController=conf.get(TTConfig.TT_TASK_CONTROLLER);
  JobInfo info=wovenClient.getJobInfo(rJob.getID());
  Assert.assertNotNull("JobInfo is null",info);
  JobID id=rJob.getID();
  while (info.runningMaps() != 1) {
    Thread.sleep(1000);
    info=wovenClient.getJobInfo(id);
  }
  TaskInfo[] myTaskInfos=wovenClient.getTaskInfo(id);
  for (  TaskInfo tInfo : myTaskInfos) {
    if (!tInfo.isSetupOrCleanup()) {
      String[] taskTrackers=tInfo.getTaskTrackers();
      for (      String taskTracker : taskTrackers) {
        TTInfo ttInfo=wovenClient.getTTInfo(taskTracker);
        TTClient ttCli=cluster.getTTClient(ttInfo.getStatus().getHost());
        Assert.assertNotNull("TTClient instance is null",ttCli);
        TTTaskInfo ttTaskInfo=ttCli.getProxy().getTask(tInfo.getTaskID());
        Assert.assertNotNull("TTTaskInfo is null",ttTaskInfo);
        while (ttTaskInfo.getTaskStatus().getRunState() != TaskStatus.State.RUNNING) {
          Thread.sleep(100);
          ttTaskInfo=ttCli.getProxy().getTask(tInfo.getTaskID());
        }
        testPermissionWithTaskController(ttCli,conf,info);
        FinishTaskControlAction action=new FinishTaskControlAction(TaskID.downgrade(tInfo.getTaskID()));
        for (        TTClient cli : cluster.getTTClients()) {
          cli.getProxy().sendAction(action);
        }
      }
    }
  }
  JobInfo jInfo=wovenClient.getJobInfo(id);
  jInfo=cluster.getJTClient().getProxy().getJobInfo(id);
  while (!jInfo.getStatus().isJobComplete()) {
    Thread.sleep(100);
    jInfo=cluster.getJTClient().getProxy().getJobInfo(id);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestJobCounters </h4><pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests {@link TaskCounter}'s {@link TaskCounter.COMMITTED_HEAP_BYTES}. 
 * The test consists of running a low-memory job which consumes less heap 
 * memory and then running a high-memory job which consumes more heap memory, 
 * and then ensuring that COMMITTED_HEAP_BYTES of low-memory job is smaller 
 * than that of the high-memory job.
 * @throws IOException
 */
@Test @SuppressWarnings("deprecation") public void testHeapUsageCounter() throws Exception {
  JobConf conf=new JobConf();
  FileSystem fileSystem=FileSystem.getLocal(conf);
  Path rootDir=new Path(System.getProperty("test.build.data","/tmp"));
  Path testRootDir=new Path(rootDir,"testHeapUsageCounter");
  fileSystem.delete(testRootDir,true);
  fileSystem.setWorkingDirectory(testRootDir);
  fileSystem.deleteOnExit(testRootDir);
  MiniMRCluster mrCluster=new MiniMRCluster(1,fileSystem.getUri().toString(),1);
  try {
    conf=mrCluster.createJobConf();
    JobClient jobClient=new JobClient(conf);
    Path inDir=new Path(testRootDir,"in");
    createWordsFile(inDir,conf);
    RunningJob lowMemJob=runHeapUsageTestJob(conf,testRootDir,"-Xms32m -Xmx1G",0,0,fileSystem,jobClient,inDir);
    JobID lowMemJobID=lowMemJob.getID();
    long lowMemJobMapHeapUsage=getTaskCounterUsage(jobClient,lowMemJobID,1,0,TaskType.MAP);
    System.out.println("Job1 (low memory job) map task heap usage: " + lowMemJobMapHeapUsage);
    long lowMemJobReduceHeapUsage=getTaskCounterUsage(jobClient,lowMemJobID,1,0,TaskType.REDUCE);
    System.out.println("Job1 (low memory job) reduce task heap usage: " + lowMemJobReduceHeapUsage);
    RunningJob highMemJob=runHeapUsageTestJob(conf,testRootDir,"-Xms32m -Xmx1G",lowMemJobMapHeapUsage + 256 * 1024 * 1024,lowMemJobReduceHeapUsage + 256 * 1024 * 1024,fileSystem,jobClient,inDir);
    JobID highMemJobID=highMemJob.getID();
    long highMemJobMapHeapUsage=getTaskCounterUsage(jobClient,highMemJobID,1,0,TaskType.MAP);
    System.out.println("Job2 (high memory job) map task heap usage: " + highMemJobMapHeapUsage);
    long highMemJobReduceHeapUsage=getTaskCounterUsage(jobClient,highMemJobID,1,0,TaskType.REDUCE);
    System.out.println("Job2 (high memory job) reduce task heap usage: " + highMemJobReduceHeapUsage);
    assertTrue("Incorrect map heap usage reported by the map task",lowMemJobMapHeapUsage < highMemJobMapHeapUsage);
    assertTrue("Incorrect reduce heap usage reported by the reduce task",lowMemJobReduceHeapUsage < highMemJobReduceHeapUsage);
  }
  finally {
    mrCluster.shutdown();
    try {
      fileSystem.delete(testRootDir,true);
    }
 catch (    IOException ioe) {
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNewCounterA() throws Exception {
  final Job job=createJob();
  final Configuration conf=job.getConfiguration();
  conf.setInt(JobContext.IO_SORT_FACTOR,2);
  removeWordsFile(new Path(IN_DIR,"input5_2k_4"),conf);
  removeWordsFile(new Path(IN_DIR,"input5_2k_5"),conf);
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat.setInputPaths(job,IN_DIR);
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat.setOutputPath(job,new Path(OUT_DIR,"outputN0"));
  assertTrue(job.waitForCompletion(true));
  final Counters c1=Counters.downgrade(job.getCounters());
  validateCounters(c1,90112,15360,61440);
}

</code></pre>

<br>
<pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNewCounterC() throws Exception {
  final Job job=createJob();
  final Configuration conf=job.getConfiguration();
  conf.setInt(JobContext.IO_SORT_FACTOR,3);
  createWordsFile(new Path(IN_DIR,"input5_2k_4"),conf);
  createWordsFile(new Path(IN_DIR,"input5_2k_5"),conf);
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat.setInputPaths(job,IN_DIR);
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat.setOutputPath(job,new Path(OUT_DIR,"outputN2"));
  assertTrue(job.waitForCompletion(true));
  final Counters c1=Counters.downgrade(job.getCounters());
  validateCounters(c1,147456,25600,102400);
}

</code></pre>

<br>
<pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNewCounterB() throws Exception {
  final Job job=createJob();
  final Configuration conf=job.getConfiguration();
  conf.setInt(JobContext.IO_SORT_FACTOR,2);
  createWordsFile(new Path(IN_DIR,"input5_2k_4"),conf);
  removeWordsFile(new Path(IN_DIR,"input5_2k_5"),conf);
  org.apache.hadoop.mapreduce.lib.input.FileInputFormat.setInputPaths(job,IN_DIR);
  org.apache.hadoop.mapreduce.lib.output.FileOutputFormat.setOutputPath(job,new Path(OUT_DIR,"outputN1"));
  assertTrue(job.waitForCompletion(true));
  final Counters c1=Counters.downgrade(job.getCounters());
  validateCounters(c1,131072,20480,81920);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestJobQueueClient </h4><pre class="type-4 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetQueue() throws Exception {
  deleteQueuesConfigFile();
  Document doc=createDocument();
  createSimpleDocumentWithAcls(doc);
  writeToFile(doc,QUEUES_CONFIG_FILE_PATH);
  JobConf jobConf=new JobConf();
  String namenode="file:///";
  miniMRCluster=new MiniMRCluster(0,namenode,3,null,null,jobConf);
  JobClient jc=new JobClient(miniMRCluster.createJobConf());
  QueueInfo queueInfo=jc.getQueueInfo("q1");
  assertEquals("q1",queueInfo.getQueueName());
  queueInfo=jc.getQueueInfo("queue");
  assertNull(queueInfo);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQueueOrdering() throws Exception {
  JobQueueInfo[] roots=new JobQueueInfo[2];
  roots[0]=new JobQueueInfo("q1","q1 scheduling info");
  roots[1]=new JobQueueInfo("q2","q2 scheduling info");
  List<JobQueueInfo> children=new ArrayList<JobQueueInfo>();
  children.add(new JobQueueInfo("q1:1",null));
  children.add(new JobQueueInfo("q1:2",null));
  roots[0].setChildren(children);
  JobQueueClient client=new JobQueueClient(new JobConf());
  List<JobQueueInfo> allQueues=client.expandQueueList(roots);
  assertEquals(4,allQueues.size());
  assertEquals("q1",allQueues.get(0).getQueueName());
  assertEquals("q1:1",allQueues.get(1).getQueueName());
  assertEquals("q1:2",allQueues.get(2).getQueueName());
  assertEquals("q2",allQueues.get(3).getQueueName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestJobTrackerPlugins </h4><pre class="type-10 type-4 type-7 type-16 type-6 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  JobConf conf=new JobConf();
  conf.set(JTConfig.JT_IPC_ADDRESS,"localhost:0");
  conf.set(JTConfig.JT_HTTP_ADDRESS,"0.0.0.0:0");
  conf.setClass(JTConfig.JT_PLUGINS,FakeServicePlugin.class,ServicePlugin.class);
  assertNull("Plugin not created",FakeServicePlugin.getInstance());
  JobTracker jobTracker=JobTracker.startTracker(conf);
  assertNotNull("Plugin created",FakeServicePlugin.getInstance());
  assertSame("Service is jobTracker",FakeServicePlugin.getInstance().getService(),jobTracker);
  assertFalse("Plugin not stopped",FakeServicePlugin.getInstance().isStopped());
  jobTracker.close();
  assertTrue("Plugin stopped",FakeServicePlugin.getInstance().isStopped());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestJvmManager </h4><pre class="type-10 type-4 type-7 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
/** 
 * Tests the jvm kill from JvmRunner and JvmManager simultaneously.
 * Starts a process, which sleeps for 60 seconds, in a thread.
 * Calls JvmRunner.kill() in a thread.
 * Also calls JvmManager.taskKilled().
 * Makes sure that the jvm is killed and JvmManager could launch another task
 * properly.
 * @throws Exception
 */
@Test public void testJvmKill() throws Exception {
  JvmManagerForType mapJvmManager=jvmManager.getJvmManagerForType(TaskType.MAP);
  JobConf taskConf=new JobConf(ttConf);
  TaskAttemptID attemptID=new TaskAttemptID("test",0,TaskType.MAP,0,0);
  Task task=new MapTask(null,attemptID,0,null,1);
  task.setConf(taskConf);
  TaskInProgress tip=tt.new TaskInProgress(task,taskConf);
  File pidFile=new File(TEST_DIR,"pid");
  final TaskRunner taskRunner=task.createRunner(tt,tip);
  final Vector<String> vargs=new Vector<String>(2);
  vargs.add(writeScript("SLEEP","sleep 60\n",pidFile).getAbsolutePath());
  final File workDir=new File(TEST_DIR,"work");
  workDir.mkdir();
  final File stdout=new File(TEST_DIR,"stdout");
  final File stderr=new File(TEST_DIR,"stderr");
  Thread launcher=new Thread(){
    public void run(){
      try {
        taskRunner.launchJvmAndWait(null,vargs,stdout,stderr,100,workDir,null);
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
        return;
      }
    }
  }
;
  launcher.start();
  for (int i=0; i < 10; i++) {
    if (pidFile.exists()) {
      break;
    }
    UtilsForTests.waitFor(100);
  }
  assertTrue("pidFile is not present",pidFile.exists());
  BufferedReader in=new BufferedReader(new FileReader(pidFile));
  String pid=in.readLine();
  in.close();
  JVMId jvmid=mapJvmManager.runningTaskToJvm.get(taskRunner);
  jvmManager.setPidToJvm(jvmid,pid);
  final JvmRunner jvmRunner=mapJvmManager.jvmIdToRunner.get(jvmid);
  Thread killer=new Thread(){
    public void run(){
      jvmRunner.kill();
    }
  }
;
  killer.start();
  Thread.sleep(100);
  taskRunner.kill();
  assertTrue(jvmRunner.killed);
  attemptID=new TaskAttemptID("test",0,TaskType.MAP,0,1);
  task=new MapTask(null,attemptID,0,null,1);
  task.setConf(taskConf);
  tip=tt.new TaskInProgress(task,taskConf);
  TaskRunner taskRunner2=task.createRunner(tt,tip);
  Vector<String> vargs2=new Vector<String>(1);
  vargs2.add(writeScript("LS","ls",pidFile).getAbsolutePath());
  File workDir2=new File(TEST_DIR,"work2");
  workDir.mkdir();
  File stdout2=new File(TEST_DIR,"stdout2");
  File stderr2=new File(TEST_DIR,"stderr2");
  taskRunner2.launchJvmAndWait(null,vargs2,stdout2,stderr2,100,workDir2,null);
  killer.join();
  jvmRunner.join();
  launcher.join();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestMapRed </h4><pre class="type-11 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNullKeys() throws Exception {
  JobConf conf=new JobConf(TestMapRed.class);
  FileSystem fs=FileSystem.getLocal(conf);
  HashSet<String> values=new HashSet<String>();
  String m="AAAAAAAAAAAAAA";
  for (int i=1; i < 11; ++i) {
    values.add(m);
    m=m.replace((char)('A' + i - 1),(char)('A' + i));
  }
  Path testdir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(fs);
  fs.delete(testdir,true);
  Path inFile=new Path(testdir,"nullin/blah");
  SequenceFile.Writer w=SequenceFile.createWriter(fs,conf,inFile,NullWritable.class,Text.class,SequenceFile.CompressionType.NONE);
  Text t=new Text();
  for (  String s : values) {
    t.set(s);
    w.append(NullWritable.get(),t);
  }
  w.close();
  FileInputFormat.setInputPaths(conf,inFile);
  FileOutputFormat.setOutputPath(conf,new Path(testdir,"nullout"));
  conf.setMapperClass(NullMapper.class);
  conf.setReducerClass(IdentityReducer.class);
  conf.setOutputKeyClass(NullWritable.class);
  conf.setOutputValueClass(Text.class);
  conf.setInputFormat(SequenceFileInputFormat.class);
  conf.setOutputFormat(SequenceFileOutputFormat.class);
  conf.setNumReduceTasks(1);
  JobClient.runJob(conf);
  SequenceFile.Reader r=new SequenceFile.Reader(fs,new Path(testdir,"nullout/part-00000"),conf);
  m="AAAAAAAAAAAAAA";
  for (int i=1; r.next(NullWritable.get(),t); ++i) {
    assertTrue("Unexpected value: " + t,values.remove(t.toString()));
    m=m.replace((char)('A' + i - 1),(char)('A' + i));
  }
  assertTrue("Missing values: " + values.toString(),values.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestPushConfig </h4><pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This test about testing the pushConfig feature. The pushConfig functionality
 * available as part of the cluster process manager. The functionality takes
 * in local input directory and pushes all the files from the local to the 
 * remote conf directory. This functionality is required is change the config
 * on the fly and restart the cluster which will be used by other test cases
 * @throws Exception is thrown if pushConfig fails. 
 */
@Test public void testPushConfig() throws Exception {
  final String DUMMY_CONFIG_STRING="mapreduce.newdummy.conf";
  final String DUMMY_CONFIG_STRING_VALUE="HerriotTestRules";
  Configuration origconf=new Configuration(cluster.getConf());
  origconf.set(DUMMY_CONFIG_STRING,DUMMY_CONFIG_STRING_VALUE);
  String localDir=HadoopDaemonRemoteCluster.getDeployedHadoopConfDir() + File.separator + localConfDir;
  File lFile=new File(localDir);
  if (!lFile.exists()) {
    lFile.mkdir();
  }
  String mapredConf=localDir + File.separator + "mapred-site.xml";
  File file=new File(mapredConf);
  origconf.writeXml(new FileOutputStream(file));
  Configuration daemonConf=cluster.getJTClient().getProxy().getDaemonConf();
  Assert.assertTrue("Dummy varialble is expected to be null before restart.",daemonConf.get(DUMMY_CONFIG_STRING) == null);
  String newDir=cluster.getClusterManager().pushConfig(localDir);
  cluster.stop();
  AbstractDaemonClient cli=cluster.getJTClient();
  waitForClusterStop(cli);
  cluster.getClusterManager().start(newDir);
  cli=cluster.getJTClient();
  waitForClusterStart(cli);
  Configuration newconf=cluster.getJTClient().getProxy().getDaemonConf();
  Assert.assertTrue("Extra varialble is expected to be set",newconf.get(DUMMY_CONFIG_STRING).equals(DUMMY_CONFIG_STRING_VALUE));
  cluster.getClusterManager().stop(newDir);
  cli=cluster.getJTClient();
  waitForClusterStop(cli);
  cluster.getClusterManager().start();
  cli=cluster.getJTClient();
  waitForClusterStart(cli);
  daemonConf=cluster.getJTClient().getProxy().getDaemonConf();
  Assert.assertTrue("Dummy variable is expected to be null after restart.",daemonConf.get(DUMMY_CONFIG_STRING) == null);
  lFile.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestQueueManager </h4><pre class="type-4 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefault() throws Exception {
  deleteQueuesConfigFile();
  QueueManager qm=new QueueManager();
  Queue root=qm.getRoot();
  assertEquals(root.getChildren().size(),1);
  assertEquals(root.getChildren().iterator().next().getName(),"default");
  assertNull(root.getChildren().iterator().next().getChildren());
}

</code></pre>

<br>
<pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testhasAccess() throws Exception {
  deleteQueuesConfigFile();
  Document doc=createDocument();
  createSimpleDocumentWithAcls(doc);
  writeToFile(doc,QUEUES_CONFIG_FILE_PATH);
  QueueManager qm=new QueueManager(QUEUES_CONFIG_FILE_PATH,true);
  UserGroupInformation ugi;
  ugi=createUGI("u1");
  assertTrue(qm.hasAccess("p1" + NAME_SEPARATOR + "p12",QueueACL.SUBMIT_JOB,ugi));
  ugi=createUGI("u2");
  assertTrue(qm.hasAccess("p1" + NAME_SEPARATOR + "p12",QueueACL.ADMINISTER_JOBS,ugi));
  ugi=createUGI("u1");
  assertTrue(qm.hasAccess("p1" + NAME_SEPARATOR + "p11",QueueACL.SUBMIT_JOB,ugi));
  ugi=createUGI("u2");
  assertTrue(qm.hasAccess("p1" + NAME_SEPARATOR + "p11",QueueACL.ADMINISTER_JOBS,ugi));
  ugi=createUGI("u1");
  assertFalse(qm.hasAccess("p1" + NAME_SEPARATOR + "p13",QueueACL.SUBMIT_JOB,ugi));
  ugi=createUGI("u2");
  assertFalse(qm.hasAccess("p1" + NAME_SEPARATOR + "p13",QueueACL.ADMINISTER_JOBS,ugi));
  assertTrue(qm.isRunning("p1" + NAME_SEPARATOR + "p13"));
}

</code></pre>

<br>
<pre class="type-13 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the refresh of queues.
 * @throws Exception
 */
@Test public void testRefresh() throws Exception {
  deleteQueuesConfigFile();
  Document doc=createDocument();
  createSimpleDocument(doc);
  writeToFile(doc,QUEUES_CONFIG_FILE_PATH);
  QueueManager qm=new QueueManager(QUEUES_CONFIG_FILE_PATH,true);
  Queue beforeRefreshRoot=qm.getRoot();
  Set<Queue> rootQueues=beforeRefreshRoot.getChildren();
  for (  Queue qs : rootQueues) {
    if (qs.getName().equals("q1")) {
      assertEquals(qs.getProperties().getProperty("capacity"),"10");
      assertEquals(qs.getProperties().getProperty("maxCapacity"),"35");
    }
 else     if (qs.getName().equals("p1")) {
      Set<Queue> children=qs.getChildren();
      for (      Queue child : children) {
        if (child.getName().equals("p1" + NAME_SEPARATOR + "p12")) {
          assertTrue(child.getAcls().get(toFullPropertyName(child.getName(),ACL_SUBMIT_JOB_TAG)).isUserAllowed(createUGI("u1")));
          assertTrue(child.getAcls().get(toFullPropertyName(child.getName(),ACL_ADMINISTER_JOB_TAG)).isUserAllowed(createUGI("u2")));
          assertTrue(child.getState().equals(QueueState.STOPPED));
        }
 else {
          assertTrue(child.getState().equals(QueueState.RUNNING));
        }
      }
    }
  }
  deleteQueuesConfigFile();
  doc=createDocument();
  refreshSimpleDocument(doc);
  writeToFile(doc,QUEUES_CONFIG_FILE_PATH);
  QueueConfigurationParser cp=new QueueConfigurationParser(QUEUES_CONFIG_FILE_PATH,true);
  qm.getRoot().isHierarchySameAs(cp.getRoot());
  qm.setQueues(cp.getRoot().getChildren().toArray(new Queue[cp.getRoot().getChildren().size()]));
  Queue afterRefreshRoot=qm.getRoot();
  rootQueues=afterRefreshRoot.getChildren();
  for (  Queue qs : rootQueues) {
    if (qs.getName().equals("q1")) {
      assertEquals(qs.getProperties().getProperty("capacity"),"70");
      assertEquals(qs.getProperties().getProperty("maxCapacity"),"35");
    }
 else     if (qs.getName().equals("p1")) {
      Set<Queue> children=qs.getChildren();
      for (      Queue child : children) {
        if (child.getName().equals("p1" + NAME_SEPARATOR + "p12")) {
          assertTrue(child.getAcls().get(toFullPropertyName(child.getName(),ACL_SUBMIT_JOB_TAG)).isUserAllowed(createUGI("u3")));
          assertTrue(child.getAcls().get(toFullPropertyName(child.getName(),ACL_ADMINISTER_JOB_TAG)).isUserAllowed(createUGI("u4")));
          assertTrue(child.getState().equals(QueueState.RUNNING));
        }
 else {
          assertTrue(child.getState().equals(QueueState.STOPPED));
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-14 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobQueueInfoGeneration() throws Exception {
  deleteQueuesConfigFile();
  Document doc=createDocument();
  createSimpleDocument(doc);
  writeToFile(doc,QUEUES_CONFIG_FILE_PATH);
  QueueManager qm=new QueueManager(QUEUES_CONFIG_FILE_PATH,true);
  List<JobQueueInfo> rootQueues=qm.getRoot().getJobQueueInfo().getChildren();
  assertEquals(rootQueues.size(),2);
  List<String> names=new ArrayList<String>();
  for (  JobQueueInfo q : rootQueues) {
    names.add(q.getQueueName());
    if (q.getQueueName().equals("q1")) {
      Properties p=q.getProperties();
      assertEquals(p.getProperty("capacity"),"10");
      assertEquals(p.getProperty("maxCapacity"),"35");
      assertTrue(q.getChildren().isEmpty());
    }
 else     if (q.getQueueName().equals("p1")) {
      List<JobQueueInfo> children=q.getChildren();
      assertEquals(children.size(),2);
      for (      JobQueueInfo child : children) {
        if (child.getQueueName().equals("p1" + NAME_SEPARATOR + "p12")) {
          assertEquals(child.getQueueState(),QueueState.STOPPED.getStateName());
        }
 else         if (child.getQueueName().equals("p1" + NAME_SEPARATOR + "p11")) {
          assertEquals(child.getQueueState(),QueueState.RUNNING.getStateName());
        }
 else {
          fail("Only 2 children");
        }
      }
    }
 else {
      fail("Only 2 queues with q1 and p1 ");
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXMLParsing() throws Exception {
  deleteQueuesConfigFile();
  Document doc=createDocument();
  createSimpleDocument(doc);
  writeToFile(doc,QUEUES_CONFIG_FILE_PATH);
  QueueManager qm=new QueueManager(QUEUES_CONFIG_FILE_PATH,true);
  Set<Queue> rootQueues=qm.getRoot().getChildren();
  List<String> names=new ArrayList<String>();
  for (  Queue q : rootQueues) {
    names.add(q.getName());
  }
  assertEquals(rootQueues.size(),2);
  assertTrue(names.contains("q1"));
  assertTrue(names.contains("p1"));
  Set<String> leafNames=qm.getLeafQueueNames();
  Queue p=qm.getQueue("p1");
  Set<Queue> children=p.getChildren();
  assertTrue(children.size() == 2);
  assertTrue(leafNames.contains("p1" + NAME_SEPARATOR + "p11"));
  assertTrue(leafNames.contains("p1" + NAME_SEPARATOR + "p12"));
  Queue q=qm.getQueue("p1" + NAME_SEPARATOR + "p12");
  assertTrue(q.getAcls().get(toFullPropertyName(q.getName(),ACL_SUBMIT_JOB_TAG)).isUserAllowed(createUGI("u1")));
  assertTrue(q.getAcls().get(toFullPropertyName(q.getName(),ACL_ADMINISTER_JOB_TAG)).isUserAllowed(createUGI("u2")));
  assertTrue(q.getState().equals(QueueState.STOPPED));
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * checks the format of the dump in JSON format when 
 * QueueManager.dumpConfiguration(Writer) is called.
 * @throws Exception
 */
@Test public void testDumpConfiguration() throws Exception {
  deleteQueuesConfigFile();
  Document doc=createDocument();
  createSimpleDocument(doc);
  writeToFile(doc,QUEUES_CONFIG_FILE_PATH);
  StringWriter out=new StringWriter();
  Configuration conf=new Configuration(false);
  conf.setBoolean(MRConfig.MR_ACLS_ENABLED,true);
  QueueManager.dumpConfiguration(out,QUEUES_CONFIG_FILE_PATH,conf);
  ObjectMapper mapper=new ObjectMapper();
  JsonQueueTree queueTree=mapper.readValue(out.toString(),JsonQueueTree.class);
  assertEquals(2,queueTree.getQueues().length);
  HashMap<String,JsonQueue> topQueues=new HashMap<String,JsonQueue>();
  for (  JsonQueue topQueue : queueTree.getQueues()) {
    topQueues.put(topQueue.getName(),topQueue);
  }
  assertEquals(2,topQueues.get("p1").getChildren().length);
  HashMap<String,JsonQueue> childQueues=new HashMap<String,JsonQueue>();
  for (  JsonQueue child : topQueues.get("p1").getChildren()) {
    childQueues.put(child.getName(),child);
  }
  assertEquals("stopped",childQueues.get("p1:p12").getState());
  HashMap<String,JsonProperty> q1_properties=new HashMap<String,JsonProperty>();
  for (  JsonProperty prop : topQueues.get("q1").getProperties()) {
    q1_properties.put(prop.getKey(),prop);
  }
  assertEquals("10",q1_properties.get("capacity").getValue());
  assertEquals("35",q1_properties.get("maxCapacity").getValue());
  assertEquals("u1 ",childQueues.get("p1:p12").getAcl_submit_job());
  assertEquals("u2 ",childQueues.get("p1:p12").getAcl_administer_jobs());
}

</code></pre>

<br>
<pre class="type-14 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingConfigFile() throws Exception {
  deleteQueuesConfigFile();
  try {
    new QueueManager(QUEUES_CONFIG_FILE_PATH,true);
    fail("Should throw an exception for missing file when " + "explicitly passed.");
  }
 catch (  RuntimeException re) {
  }
  QueueManager qm=new QueueManager();
  List<JobQueueInfo> rootQueues=qm.getRoot().getJobQueueInfo().getChildren();
  assertEquals(1,rootQueues.size());
  assertEquals("default",rootQueues.get(0).getQueueName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestQueueManagerRefresh </h4><pre class="type-10 type-4 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to verify that the refresh of scheduler properties passes smoothly.
 * @throws Exception
 */
@Test public void testRefreshOfSchedulerProperties() throws Exception {
  JobQueueInfo[] queues=getSimpleQueueHierarchy();
  for (  JobQueueInfo jqi : queues) {
    Properties props=new Properties();
    props.setProperty("testing.property","testing.value." + jqi.getQueueName());
    jqi.setProperties(props);
  }
  writeQueueConfigurationFile(QUEUES_CONFIG_FILE_PATH,new JobQueueInfo[]{queues[0]});
  QueueManager qManager=new QueueManager();
  MyTaskScheduler myScheduler=new MyTaskScheduler();
  qManager.refreshQueues(null,myScheduler.new MyQueueRefresher());
  Map<String,Properties> schedProps=myScheduler.getSchedulerProperties();
  for (  JobQueueInfo jqi : queues) {
    String expectedVal="testing.value." + jqi.getQueueName();
    Properties qProperties=schedProps.get(jqi.getQueueName());
    assertNotNull("Properties should not be null for the SchedulerQueue " + jqi.getQueueName(),qProperties);
    String observedVal=qProperties.getProperty("testing.property");
    assertEquals("Properties for the SchedulerQueue " + jqi.getQueueName() + " are not reloaded properly!",expectedVal,observedVal);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test to verify that the scheduling information per queue in the{@link QueueManager} is retained across queue-refresh.
 * @throws Exception
 */
@Test public void testSchedulingInfoAfterRefresh() throws Exception {
  JobQueueInfo[] queues=getSimpleQueueHierarchy();
  writeQueueConfigurationFile(QUEUES_CONFIG_FILE_PATH,new JobQueueInfo[]{queues[0]});
  QueueManager qManager=new QueueManager();
  for (  String qName : qManager.getLeafQueueNames()) {
    qManager.setSchedulerInfo(qName,new String("scheduling-information-for-queue-" + qName));
  }
  qManager.refreshQueues(null,null);
  for (  String qName : qManager.getLeafQueueNames()) {
    assertEquals("scheduling-information-for-queue-" + qName,qManager.getSchedulerInfo(qName));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestQueueManagerWithJobTracker </h4><pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests job submission when acls are disabled
 * @throws Exception
 */
@Test public void testAclsDisabled() throws Exception {
  startCluster(false);
  Job job=submitSleepJob(0,0,0,0,true,"u2,g1","p1" + NAME_SEPARATOR + "p11",conf);
  assertTrue("Job submitted for u2 in queue p1:p11 is not successful.",job.isSuccessful());
  job=submitSleepJob(0,0,0,0,true,"u1,g1","p1" + NAME_SEPARATOR + "p11",conf);
  assertTrue("Job submitted for u2 in queue p1:p11 is not successful.",job.isSuccessful());
  job=submitSleepJob(1,1,0,0,false,"u1,g1","p1" + NAME_SEPARATOR + "p11",conf);
  final JobConf jobConf=miniMRCluster.createJobConf();
  UserGroupInformation ugi=UserGroupInformation.createUserForTesting("u3",new String[]{"g3"});
  Cluster cluster=ugi.doAs(new PrivilegedExceptionAction<Cluster>(){
    public Cluster run() throws IOException {
      return new Cluster(jobConf);
    }
  }
);
  JobID jobID=job.getStatus().getJobID();
  JobInProgress jip=miniMRCluster.getJobTrackerRunner().getJobTracker().getJob(org.apache.hadoop.mapred.JobID.downgrade(jobID));
  miniMRCluster.getJobTrackerRunner().getJobTracker().initJob(jip);
  cluster.getJob(jobID).killJob();
  assertEquals("job submitted for u1 and queue p1:p11 is not killed.",cluster.getJob(jobID).getStatus().getState(),(State.KILLED));
}

</code></pre>

<br>
<pre class="type-10 type-14 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the accessibility to kill a job
 * @throws Exception
 */
@Test public void testAccessToKillJob() throws Exception {
  startCluster(true);
  Job job=submitSleepJob(1,1,100,100,false,"u1,g1","p1" + NAME_SEPARATOR + "p11",conf);
  final JobConf jobConf=miniMRCluster.createJobConf();
  Cluster cluster=null;
  JobID jobID=job.getStatus().getJobID();
  JobTracker tracker=miniMRCluster.getJobTrackerRunner().getJobTracker();
  JobInProgress jip=tracker.getJob(org.apache.hadoop.mapred.JobID.downgrade(jobID));
  tracker.initJob(jip);
  try {
    final Configuration userConf=new Configuration(miniMRCluster.createJobConf());
    UserGroupInformation ugi=UserGroupInformation.createUserForTesting("someRandomUser",new String[]{"someRandomGroup"});
    cluster=ugi.doAs(new PrivilegedExceptionAction<Cluster>(){
      public Cluster run() throws IOException {
        return new Cluster(userConf);
      }
    }
);
    cluster.getJob(jobID).killJob();
    fail("user 'someRandomeUser' is neither u1 nor in the administer group list");
  }
 catch (  Exception e) {
    final Configuration userConf=new Configuration(miniMRCluster.createJobConf());
    UserGroupInformation ugi=UserGroupInformation.createUserForTesting("u1",new String[]{"g1"});
    cluster=ugi.doAs(new PrivilegedExceptionAction<Cluster>(){
      public Cluster run() throws IOException {
        return new Cluster(userConf);
      }
    }
);
    cluster.getJob(jobID).killJob();
    assertEquals("job submitted for u1 and queue p1:p11 is not killed.",cluster.getJob(jobID).getStatus().getState(),(State.KILLED));
  }
  job=submitSleepJob(1,1,100,100,false,"u1,g1","p1" + NAME_SEPARATOR + "p12",conf);
  jobID=job.getStatus().getJobID();
  jip=tracker.getJob(org.apache.hadoop.mapred.JobID.downgrade(jobID));
  tracker.initJob(jip);
  tracker.killJob(job.getJobID());
  assertEquals("job submitted for u1 and queue p1:p11 is not killed.",cluster.getJob(jobID).getStatus().getState(),(State.KILLED));
  final Configuration userConf=new Configuration(miniMRCluster.createJobConf());
  UserGroupInformation ugi=UserGroupInformation.createUserForTesting("u1",new String[]{"g1"});
  cluster=ugi.doAs(new PrivilegedExceptionAction<Cluster>(){
    public Cluster run() throws IOException {
      return new Cluster(userConf);
    }
  }
);
  job=submitSleepJob(1,1,10,10,false,"u1,g1","p1" + NAME_SEPARATOR + "p11",conf);
  jobID=job.getStatus().getJobID();
  jip=tracker.getJob(org.apache.hadoop.mapred.JobID.downgrade(jobID));
  tracker.initJob(jip);
  ugi=UserGroupInformation.createUserForTesting("u3",new String[]{"g3"});
  cluster=ugi.doAs(new PrivilegedExceptionAction<Cluster>(){
    public Cluster run() throws IOException {
      return new Cluster(jobConf);
    }
  }
);
  try {
    cluster.getJob(jobID).killJob();
    fail("u3 not in administer list");
  }
 catch (  Exception e) {
    ugi=UserGroupInformation.createUserForTesting("u1",new String[]{"g1"});
    cluster=ugi.doAs(new PrivilegedExceptionAction<Cluster>(){
      public Cluster run() throws IOException {
        return new Cluster(jobConf);
      }
    }
);
    assertFalse(cluster.getJob(jobID).isComplete());
    cluster.getJob(jobID).killJob();
    assertEquals("job submitted for u1 and queue p1:p11 is not killed.",cluster.getJob(jobID).getStatus().getState(),(State.KILLED));
  }
  ugi=UserGroupInformation.createUserForTesting("adminUser",new String[]{"g3"});
  checkAccessToKill(tracker,jobConf,ugi);
  ugi=UserGroupInformation.createUserForTesting("u3",new String[]{adminGroup});
  checkAccessToKill(tracker,jobConf,ugi);
  ugi=UserGroupInformation.createUserForTesting("u3",new String[]{deprecatedSuperGroup});
  checkAccessToKill(tracker,jobConf,ugi);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestRefreshOfQueues </h4><pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * @throws Throwable
 */
@Test public void testRefreshUserLimits() throws Throwable {
  JobQueueInfo[] queues=TestQueueManagerRefresh.getSimpleQueueHierarchy();
  queues[0].getProperties().setProperty(CapacitySchedulerConf.CAPACITY_PROPERTY,String.valueOf(100));
  queues[1].getProperties().setProperty(CapacitySchedulerConf.CAPACITY_PROPERTY,String.valueOf(50));
  queues[2].getProperties().setProperty(CapacitySchedulerConf.CAPACITY_PROPERTY,String.valueOf(50));
  queues[2].getProperties().setProperty(CapacitySchedulerConf.MINIMUM_USER_LIMIT_PERCENT_PROPERTY,String.valueOf(100));
  QueueManagerTestUtils.writeQueueConfigurationFile(queueConfigFile.getAbsolutePath(),new JobQueueInfo[]{queues[0]});
  setupAndStartSchedulerFramework(1,2,2);
  FakeJobInProgress job1=taskTrackerManager.submitJobAndInit(JobStatus.PREP,2,2,queues[2].getQueueName(),"user1");
  FakeJobInProgress job2=taskTrackerManager.submitJobAndInit(JobStatus.PREP,2,2,queues[2].getQueueName(),"user2");
  Map<String,String> expectedStrings=new HashMap<String,String>();
  expectedStrings.put(MAP,"attempt_test_0001_m_000001_0 on tt1");
  expectedStrings.put(REDUCE,"attempt_test_0001_r_000001_0 on tt1");
  checkMultipleTaskAssignment(taskTrackerManager,scheduler,"tt1",expectedStrings);
  expectedStrings.clear();
  expectedStrings.put(MAP,"attempt_test_0001_m_000002_0 on tt1");
  expectedStrings.put(REDUCE,"attempt_test_0001_r_000002_0 on tt1");
  checkMultipleTaskAssignment(taskTrackerManager,scheduler,"tt1",expectedStrings);
  assertNull(scheduler.assignTasks(taskTrackerManager.getTaskTracker("tt1")));
  taskTrackerManager.killJob(job1.getJobID());
  taskTrackerManager.killJob(job2.getJobID());
  queues[2].getProperties().setProperty(CapacitySchedulerConf.MINIMUM_USER_LIMIT_PERCENT_PROPERTY,String.valueOf(50));
  QueueManagerTestUtils.writeQueueConfigurationFile(queueConfigFile.getAbsolutePath(),new JobQueueInfo[]{queues[0]});
  refreshQueues(taskTrackerManager.getQueueManager(),null,scheduler);
  job1=taskTrackerManager.submitJobAndInit(JobStatus.PREP,2,2,queues[1].getQueueName(),"user1");
  job2=taskTrackerManager.submitJobAndInit(JobStatus.PREP,2,2,queues[2].getQueueName(),"user2");
  expectedStrings.clear();
  expectedStrings.put(MAP,"attempt_test_0003_m_000001_0 on tt1");
  expectedStrings.put(REDUCE,"attempt_test_0003_r_000001_0 on tt1");
  checkMultipleTaskAssignment(taskTrackerManager,scheduler,"tt1",expectedStrings);
  expectedStrings.clear();
  expectedStrings.put(MAP,"attempt_test_0004_m_000001_0 on tt1");
  expectedStrings.put(REDUCE,"attempt_test_0004_r_000001_0 on tt1");
  checkMultipleTaskAssignment(taskTrackerManager,scheduler,"tt1",expectedStrings);
}

</code></pre>

<br>
<pre class="type-10 type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @throws Throwable
 */
@Test public void testRefreshOfQueuesSanity() throws Throwable {
  JobQueueInfo[] queues=TestQueueManagerRefresh.getSimpleQueueHierarchy();
  Properties[] props=new Properties[3];
  for (int i=0; i < props.length; i++) {
    props[i]=queues[i].getProperties();
    props[i].setProperty(CapacitySchedulerConf.CAPACITY_PROPERTY,String.valueOf(i + 10));
    props[i].setProperty(CapacitySchedulerConf.MAX_CAPACITY_PROPERTY,String.valueOf(i + 15));
    props[i].setProperty(CapacitySchedulerConf.SUPPORTS_PRIORITY_PROPERTY,String.valueOf(false));
    props[i].setProperty(CapacitySchedulerConf.MAXIMUM_INITIALIZED_JOBS_PER_USER_PROPERTY,String.valueOf(i + 11));
    props[i].setProperty(CapacitySchedulerConf.MINIMUM_USER_LIMIT_PERCENT_PROPERTY,String.valueOf(i + 16));
  }
  QueueManagerTestUtils.writeQueueConfigurationFile(queueConfigFile.getAbsolutePath(),new JobQueueInfo[]{queues[0]});
  setupAndStartSchedulerFramework(0,0,0);
  Map<String,AbstractQueue> allQueues=getAllQueues(scheduler);
  for (int i=0; i < queues.length; i++) {
    String qName=queues[i].getQueueName();
    LOG.info("Queue name : " + qName);
    QueueSchedulingContext qsc=allQueues.get(qName).getQueueSchedulingContext();
    LOG.info("Context for queue " + qName + " is : "+ qsc);
    assertEquals(i + 10,qsc.getCapacityPercent(),0);
    assertEquals(i + 15,qsc.getMaxCapacityPercent(),0);
    assertEquals(Boolean.valueOf(false),Boolean.valueOf(qsc.supportsPriorities()));
    assertEquals(i + 16,qsc.getUlMin());
  }
  for (int i=0; i < props.length; i++) {
    props[i]=queues[i].getProperties();
    props[i].setProperty(CapacitySchedulerConf.CAPACITY_PROPERTY,String.valueOf(i + 20));
    props[i].setProperty(CapacitySchedulerConf.MAX_CAPACITY_PROPERTY,String.valueOf(i + 25));
    props[i].setProperty(CapacitySchedulerConf.SUPPORTS_PRIORITY_PROPERTY,String.valueOf(false));
    props[i].setProperty(CapacitySchedulerConf.MAXIMUM_INITIALIZED_JOBS_PER_USER_PROPERTY,String.valueOf(i + 5));
    props[i].setProperty(CapacitySchedulerConf.MINIMUM_USER_LIMIT_PERCENT_PROPERTY,String.valueOf(i + 10));
  }
  QueueManagerTestUtils.writeQueueConfigurationFile(queueConfigFile.getAbsolutePath(),new JobQueueInfo[]{queues[0]});
  refreshQueues(taskTrackerManager.getQueueManager(),null,scheduler);
  allQueues=getAllQueues(scheduler);
  for (int i=0; i < queues.length; i++) {
    String qName=queues[i].getQueueName();
    LOG.info("Queue name : " + qName);
    QueueSchedulingContext qsc=allQueues.get(qName).getQueueSchedulingContext();
    assertEquals(qName,qsc.getQueueName());
    LOG.info("Context for queue " + qName + " is : "+ qsc);
    assertEquals(i + 20,qsc.getCapacityPercent(),0);
    assertEquals(i + 25,qsc.getMaxCapacityPercent(),0);
    assertEquals(Boolean.valueOf(false),Boolean.valueOf(qsc.supportsPriorities()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestReporter </h4><pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test {@link Reporter}'s progress for a map-only job.
 * This will make sure that only the map phase decides the attempt's progress.
 */
@SuppressWarnings("deprecation") @Test public void testReporterProgressForMapOnlyJob() throws IOException {
  Path test=new Path(testRootTempDir,"testReporterProgressForMapOnlyJob");
  JobConf conf=new JobConf();
  conf.setMapperClass(ProgressTesterMapper.class);
  conf.setMapOutputKeyClass(Text.class);
  conf.setMaxMapAttempts(1);
  conf.setMaxReduceAttempts(0);
  RunningJob job=UtilsForTests.runJob(conf,new Path(test,"in"),new Path(test,"out"),1,0,INPUT);
  job.waitForCompletion();
  assertTrue("Job failed",job.isSuccessful());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test {@link Reporter}'s progress for map-reduce job.
 */
@SuppressWarnings("deprecation") @Test public void testReporterProgressForMRJob() throws IOException {
  Path test=new Path(testRootTempDir,"testReporterProgressForMRJob");
  JobConf conf=new JobConf();
  conf.setMapperClass(ProgressTesterMapper.class);
  conf.setReducerClass(ProgressTestingReducer.class);
  conf.setMapOutputKeyClass(Text.class);
  conf.setMaxMapAttempts(1);
  conf.setMaxReduceAttempts(1);
  RunningJob job=UtilsForTests.runJob(conf,new Path(test,"in"),new Path(test,"out"),1,1,INPUT);
  job.waitForCompletion();
  assertTrue("Job failed",job.isSuccessful());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestShuffleExceptionCount </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckException() throws IOException, InterruptedException, ClassNotFoundException, InstantiationException, IllegalAccessException {
  TestMapOutputServlet testServlet=new TestMapOutputServlet();
  JobConf conf=new JobConf();
  conf.setUser("testuser");
  conf.setJobName("testJob");
  conf.setSessionId("testSession");
  ContextFactory factory=ContextFactory.getFactory();
  factory.setAttribute("mapred.class","org.apache.hadoop.metrics.spi.NoEmitMetricsContext");
  TaskTracker tt=new TaskTracker();
  tt.setConf(conf);
  ShuffleServerMetrics shuffleMetrics=tt.new ShuffleServerMetrics(conf);
  String exceptionMsgRegex="Broken pipe";
  String exceptionStackRegex=null;
  IOException ie=new IOException("EOFException");
  testServlet.checkException(ie,exceptionMsgRegex,exceptionStackRegex,shuffleMetrics);
  MetricsContext context=factory.getContext("mapred");
  shuffleMetrics.doUpdates(context);
  Map<String,Collection<OutputRecord>> records=context.getAllRecords();
  Collection<OutputRecord> col=records.get("shuffleOutput");
  OutputRecord outputRecord=col.iterator().next();
  assertEquals(0,outputRecord.getMetric("shuffle_exceptions_caught").intValue());
  ie=new IOException("Broken pipe");
  testServlet.checkException(ie,exceptionMsgRegex,exceptionStackRegex,shuffleMetrics);
  shuffleMetrics.doUpdates(context);
  assertEquals(1,outputRecord.getMetric("shuffle_exceptions_caught").intValue());
  exceptionStackRegex=null;
  exceptionMsgRegex=null;
  testServlet.checkException(ie,exceptionMsgRegex,exceptionStackRegex,shuffleMetrics);
  shuffleMetrics.doUpdates(context);
  assertEquals(2,outputRecord.getMetric("shuffle_exceptions_caught").intValue());
  exceptionStackRegex=".*\\.doesnt\\$SelectSet\\.wakeup.*";
  exceptionMsgRegex=null;
  ie.setStackTrace(constructStackTrace());
  testServlet.checkException(ie,exceptionMsgRegex,exceptionStackRegex,shuffleMetrics);
  shuffleMetrics.doUpdates(context);
  assertEquals(2,outputRecord.getMetric("shuffle_exceptions_caught").intValue());
  exceptionStackRegex=".*\\.SelectorManager\\$SelectSet\\.wakeup.*";
  testServlet.checkException(ie,exceptionMsgRegex,exceptionStackRegex,shuffleMetrics);
  shuffleMetrics.doUpdates(context);
  assertEquals(3,outputRecord.getMetric("shuffle_exceptions_caught").intValue());
  exceptionMsgRegex="Broken pipe";
  ie.setStackTrace(constructStackTraceTwo());
  testServlet.checkException(ie,exceptionMsgRegex,exceptionStackRegex,shuffleMetrics);
  shuffleMetrics.doUpdates(context);
  assertEquals(4,outputRecord.getMetric("shuffle_exceptions_caught").intValue());
  exceptionStackRegex=".*[1-9]+BOGUSREGEX";
  testServlet.checkException(ie,exceptionMsgRegex,exceptionStackRegex,shuffleMetrics);
  shuffleMetrics.doUpdates(context);
  assertEquals(4,outputRecord.getMetric("shuffle_exceptions_caught").intValue());
  exceptionStackRegex=".*\\.SelectorManager\\$SelectSet\\.wakeup.*";
  exceptionMsgRegex="EOFException";
  testServlet.checkException(ie,exceptionMsgRegex,exceptionStackRegex,shuffleMetrics);
  shuffleMetrics.doUpdates(context);
  assertEquals(4,outputRecord.getMetric("shuffle_exceptions_caught").intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestSimulatorEndToEnd </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMain() throws Exception {
  final Configuration conf=new Configuration();
  conf.set(SimulatorJobSubmissionPolicy.JOB_SUBMISSION_POLICY,policy.name());
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootInputDir=new Path(System.getProperty("src.test.data","data")).makeQualified(lfs);
  final Path traceFile=new Path(rootInputDir,"19-jobs.trace.json.gz");
  final Path topologyFile=new Path(rootInputDir,"19-jobs.topology.json.gz");
  LOG.info("traceFile = " + traceFile.toString() + " topology = "+ topologyFile.toString());
  int numJobs=getNumberJobs(traceFile,conf);
  int nTrackers=getNumberTaskTrackers(topologyFile,conf);
  MockSimulatorEngine mockMumak=new MockSimulatorEngine(numJobs,nTrackers);
  Configuration mumakConf=new Configuration();
  mumakConf.set("mapred.jobtracker.taskScheduler",JobQueueTaskScheduler.class.getName());
  mumakConf.setBoolean(JTConfig.JT_PERSIST_JOBSTATUS,false);
  String[] args={traceFile.toString(),topologyFile.toString()};
  int res=ToolRunner.run(mumakConf,mockMumak,args);
  Assert.assertEquals(res,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestSimulatorEventQueue </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleGetPut(){
  SimulatorEventQueue queue=new SimulatorEventQueue();
  SimulatorEventListener listener=new TestListener();
  SimulatorEvent event=new TestEvent(listener,10);
  queue.add(event);
  SimulatorEvent first=queue.get();
  Assert.assertEquals(first.getTimeStamp(),event.getTimeStamp());
  Assert.assertEquals(first.getListener(),event.getListener());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListPut(){
  SimulatorEventQueue queue=new SimulatorEventQueue();
  SimulatorEventListener listener=new TestListener();
  List<SimulatorEvent> listEvent=new ArrayList<SimulatorEvent>();
  listEvent.add(new TestEvent(listener,10));
  listEvent.add(new TestEvent(listener,11));
  queue.addAll(listEvent);
  SimulatorEvent first=queue.get();
  Assert.assertEquals(first.getTimeStamp(),10);
  Assert.assertEquals(first.getListener(),listener);
  SimulatorEvent second=queue.get();
  Assert.assertEquals(second.getTimeStamp(),11);
  Assert.assertEquals(first.getListener(),listener);
}

</code></pre>

<br>
<pre class="type-11 type-13 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testKeepOrder(){
  SimulatorEventQueue queue=new SimulatorEventQueue();
  SimulatorEventListener listener=new TestListener();
  List<SimulatorEvent> listEvent=new ArrayList<SimulatorEvent>();
  int count=0;
  for (int i=0; i < random.nextInt(100); i++) {
    listEvent.clear();
    for (int j=0; j < random.nextInt(5); j++) {
      listEvent.add(new TestEventWithCount(listener,random.nextInt(10),count++));
    }
    queue.addAll(listEvent);
  }
  TestEventWithCount next;
  TestEventWithCount last=null;
  while ((next=(TestEventWithCount)queue.get()) != null) {
    if (last != null && last.getTimeStamp() == next.getTimeStamp()) {
      Assert.assertTrue(last.getCount() < next.getCount());
    }
    last=next;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestSimulatorJobTracker </h4><pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTrackerInteraction() throws IOException, InterruptedException {
  LOG.info("Testing Inter Tracker protocols");
  int now=0;
  JobConf jtConf=createJobConf();
  int NoMaps=2;
  int NoReduces=10;
  jtConf.set("fs.default.name","file:///");
  jtConf.set("mapred.jobtracker.taskScheduler",JobQueueTaskScheduler.class.getName());
  SimulatorJobTracker sjobTracker=SimulatorJobTracker.startTracker(jtConf,0);
  System.out.println("Created the SimulatorJobTracker successfully");
  sjobTracker.offerService();
  FakeJobClient jbc=new FakeJobClient(sjobTracker,NoMaps,NoReduces);
  int NoJobs=1;
  for (int i=0; i < NoJobs; i++) {
    jbc.submitNewJob();
  }
  org.apache.hadoop.mapreduce.JobStatus[] allJobs=sjobTracker.getAllJobs();
  Assert.assertTrue("allJobs queue length is " + allJobs.length,allJobs.length >= 1);
  for (  org.apache.hadoop.mapreduce.JobStatus js : allJobs) {
    LOG.info("From JTQueue: job id = " + js.getJobID());
  }
  Configuration ttConf=new Configuration();
  ttConf.set("mumak.tasktracker.tracker.name","tracker_host1.foo.com:localhost/127.0.0.1:9010");
  ttConf.set("mumak.tasktracker.host.name","host1.foo.com");
  ttConf.setInt("mapred.tasktracker.map.tasks.maximum",10);
  ttConf.setInt("mapred.tasktracker.reduce.tasks.maximum",10);
  ttConf.setInt("mumak.tasktracker.heartbeat.fuzz",-1);
  FakeTaskTracker fakeTracker=new FakeTaskTracker(sjobTracker,ttConf);
  int numLaunchTaskActions=0;
  for (int i=0; i < NoMaps * 2; ++i) {
    numLaunchTaskActions+=fakeTracker.sendFakeHeartbeat(now);
    if (numLaunchTaskActions >= NoMaps) {
      break;
    }
    now+=5;
    LOG.debug("Number of MapLaunchTasks=" + numLaunchTaskActions + " now = "+ now);
  }
  Assert.assertTrue("Failed to launch all maps: " + numLaunchTaskActions,numLaunchTaskActions >= NoMaps);
  LOG.info("Sending task completed status");
  numLaunchTaskActions+=fakeTracker.sendFakeHeartbeat(now);
  for (int i=0; i < NoReduces * 2; ++i) {
    if (numLaunchTaskActions >= NoMaps + NoReduces) {
      break;
    }
    numLaunchTaskActions+=fakeTracker.sendFakeHeartbeat(now);
    now+=5;
    LOG.debug("Number of ReduceLaunchTasks=" + numLaunchTaskActions + " now = "+ now);
  }
  Assert.assertTrue("Failed to launch all reduces: " + numLaunchTaskActions,numLaunchTaskActions >= NoMaps + NoReduces);
  numLaunchTaskActions+=fakeTracker.sendFakeHeartbeat(now);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskKilling </h4><pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifying whether task temporary output directory is cleaned up or not
 * after killing the task.
 */
@Test public void testDirCleanupAfterTaskKilled() throws IOException, InterruptedException {
  TaskInfo taskInfo=null;
  boolean isTempFolderExists=false;
  String localTaskDir=null;
  TTClient ttClient=null;
  TaskID tID=null;
  FileStatus filesStatus[]=null;
  Path inputDir=new Path("input");
  Path outputDir=new Path("output");
  Configuration conf=new Configuration(cluster.getConf());
  JobConf jconf=new JobConf(conf);
  jconf.setJobName("Word Count");
  jconf.setJarByClass(WordCount.class);
  jconf.setMapperClass(WordCount.MapClass.class);
  jconf.setCombinerClass(WordCount.Reduce.class);
  jconf.setReducerClass(WordCount.Reduce.class);
  jconf.setNumMapTasks(1);
  jconf.setNumReduceTasks(1);
  jconf.setMaxMapAttempts(20);
  jconf.setMaxReduceAttempts(20);
  jconf.setOutputKeyClass(Text.class);
  jconf.setOutputValueClass(IntWritable.class);
  cleanup(inputDir,conf);
  cleanup(outputDir,conf);
  createInput(inputDir,conf);
  FileInputFormat.setInputPaths(jconf,inputDir);
  FileOutputFormat.setOutputPath(jconf,outputDir);
  RunningJob runJob=jobClient.submitJob(jconf);
  JobID id=runJob.getID();
  JobInfo jInfo=remoteJTClient.getJobInfo(id);
  int counter=0;
  while (counter < 60) {
    if (jInfo.getStatus().getRunState() == JobStatus.RUNNING) {
      break;
    }
 else {
      UtilsForTests.waitFor(1000);
      jInfo=remoteJTClient.getJobInfo(id);
    }
    counter++;
  }
  Assert.assertTrue("Job has not been started for 1 min.",counter != 60);
  JobStatus[] jobStatus=jobClient.getAllJobs();
  String userName=jobStatus[0].getUsername();
  TaskInfo[] taskInfos=remoteJTClient.getTaskInfo(id);
  for (  TaskInfo taskinfo : taskInfos) {
    if (!taskinfo.isSetupOrCleanup()) {
      taskInfo=taskinfo;
      break;
    }
  }
  counter=0;
  while (counter < 30) {
    if (taskInfo.getTaskStatus().length > 0) {
      if (taskInfo.getTaskStatus()[0].getRunState() == TaskStatus.State.RUNNING) {
        break;
      }
    }
    UtilsForTests.waitFor(1000);
    taskInfo=remoteJTClient.getTaskInfo(taskInfo.getTaskID());
    counter++;
  }
  Assert.assertTrue("Task has not been started for 30 sec.",counter != 30);
  tID=TaskID.downgrade(taskInfo.getTaskID());
  FinishTaskControlAction action=new FinishTaskControlAction(tID);
  String[] taskTrackers=taskInfo.getTaskTrackers();
  counter=0;
  while (counter < 30) {
    if (taskTrackers.length != 0) {
      break;
    }
    UtilsForTests.waitFor(100);
    taskTrackers=taskInfo.getTaskTrackers();
    counter++;
  }
  String hostName=taskTrackers[0].split("_")[1];
  hostName=hostName.split(":")[0];
  ttClient=cluster.getTTClient(hostName);
  ttClient.getProxy().sendAction(action);
  String localDirs[]=ttClient.getMapredLocalDirs();
  TaskAttemptID taskAttID=new TaskAttemptID(tID,0);
  for (  String localDir : localDirs) {
    localTaskDir=localDir + "/" + TaskTracker.getLocalTaskDir(userName,id.toString(),taskAttID.toString());
    filesStatus=ttClient.listStatus(localTaskDir,true);
    if (filesStatus.length > 0) {
      isTempFolderExists=true;
      NetworkedJob networkJob=new JobClient.NetworkedJob(jInfo.getStatus(),jobClient.cluster);
      networkJob.killTask(taskAttID,false);
      break;
    }
  }
  Assert.assertTrue("Task Attempt directory " + taskAttID + " has not been found while task was running.",isTempFolderExists);
  taskInfo=remoteJTClient.getTaskInfo(tID);
  counter=0;
  while (counter < 60) {
    UtilsForTests.waitFor(1000);
    taskInfo=remoteJTClient.getTaskInfo(tID);
    filesStatus=ttClient.listStatus(localTaskDir,true);
    if (filesStatus.length == 0) {
      break;
    }
    counter++;
  }
  Assert.assertTrue("Task attempt temporary folder has not been cleaned.",isTempFolderExists && filesStatus.length == 0);
  counter=0;
  while (counter < 30) {
    UtilsForTests.waitFor(1000);
    taskInfo=remoteJTClient.getTaskInfo(tID);
    counter++;
  }
  taskInfo=remoteJTClient.getTaskInfo(tID);
  Assert.assertEquals("Task status has not been changed to KILLED.",TaskStatus.State.KILLED,taskInfo.getTaskStatus()[0].getRunState());
}

</code></pre>

<br>
<pre class="type-11 type-13 type-14 type-4 type-7 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllTaskAttemptKill() throws Exception {
  Configuration conf=new Configuration(cluster.getConf());
  JobStatus[] jobStatus=null;
  SleepJob job=new SleepJob();
  job.setConf(conf);
  Job slpJob=job.createJob(3,1,40000,1000,100,100);
  JobConf jconf=new JobConf(conf);
  slpJob.submit();
  RunningJob rJob=cluster.getJTClient().getClient().getJob(org.apache.hadoop.mapred.JobID.downgrade(slpJob.getJobID()));
  int MAX_MAP_TASK_ATTEMPTS=Integer.parseInt(jconf.get(MRJobConfig.MAP_MAX_ATTEMPTS));
  LOG.info("MAX_MAP_TASK_ATTEMPTS is : " + MAX_MAP_TASK_ATTEMPTS);
  Assert.assertTrue(MAX_MAP_TASK_ATTEMPTS > 0);
  TTClient tClient=null;
  TTClient[] ttClients=null;
  JobInfo jInfo=remoteJTClient.getJobInfo(rJob.getID());
  Assert.assertNotNull(jInfo.getStatus().getRunState());
  while (jInfo.getStatus().getRunState() != JobStatus.RUNNING) {
    try {
      Thread.sleep(10000);
    }
 catch (    InterruptedException e) {
    }
    ;
    jInfo=remoteJTClient.getJobInfo(rJob.getID());
  }
  JobID jobidStore=rJob.getID();
  jobidStore=JobID.downgrade(jobidStore);
  LOG.info("job id is :" + jobidStore.toString());
  TaskInfo[] taskInfos=null;
  boolean runningCount=false;
  int count=0;
  do {
    taskInfos=cluster.getJTClient().getProxy().getTaskInfo(rJob.getID());
    runningCount=false;
    for (    TaskInfo taskInfo : taskInfos) {
      TaskStatus[] taskStatuses=taskInfo.getTaskStatus();
      if (taskStatuses.length > 0) {
        LOG.info("taskStatuses[0].getRunState() is :" + taskStatuses[0].getRunState());
        if (taskStatuses[0].getRunState() == TaskStatus.State.RUNNING) {
          runningCount=true;
          break;
        }
 else {
          LOG.info("Sleeping 5 seconds");
          Thread.sleep(5000);
        }
      }
    }
    count++;
    if (count > 10) {
      Assert.fail("Since the sleep count has reached beyond a point" + "failing at this point");
    }
  }
 while (!runningCount);
  String taskIdKilled=null;
  for (int i=0; i < MAX_MAP_TASK_ATTEMPTS; i++) {
    taskInfos=cluster.getJTClient().getProxy().getTaskInfo(rJob.getID());
    for (    TaskInfo taskInfo : taskInfos) {
      TaskAttemptID taskAttemptID;
      if (!taskInfo.isSetupOrCleanup()) {
        TaskID taskid=TaskID.downgrade(taskInfo.getTaskID());
        LOG.info("taskid is :" + taskid);
        if (i == 0) {
          taskIdKilled=taskid.toString();
          taskAttemptID=new TaskAttemptID(taskid,i);
          LOG.info("taskAttemptid going to be killed is : " + taskAttemptID);
          (new JobClient.NetworkedJob(jInfo.getStatus(),jobClient.cluster)).killTask(taskAttemptID,true);
          checkTaskCompletionEvent(taskAttemptID,jInfo);
          break;
        }
 else {
          if (taskIdKilled.equals(taskid.toString())) {
            taskAttemptID=new TaskAttemptID(taskid,i);
            LOG.info("taskAttemptid going to be killed is : " + taskAttemptID);
            (new JobClient.NetworkedJob(jInfo.getStatus(),jobClient.cluster)).killTask(taskAttemptID,true);
            checkTaskCompletionEvent(taskAttemptID,jInfo);
            break;
          }
        }
      }
    }
  }
  while (jInfo != null && !jInfo.getStatus().isJobComplete()) {
    Thread.sleep(10000);
    jInfo=remoteJTClient.getJobInfo(rJob.getID());
  }
  jobStatus=jobClient.getAllJobs();
  JobStatus jobStatusFound=null;
  for (  JobStatus jobStatusTmp : jobStatus) {
    if (JobID.downgrade(jobStatusTmp.getJobID()).equals(jobidStore)) {
      jobStatusFound=jobStatusTmp;
      LOG.info("jobStatus found is :" + jobStatusFound.getJobId().toString());
    }
  }
  Assert.assertEquals("The job should have failed at this stage",JobStatus.FAILED,jobStatusFound.getRunState());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifying whether task temporary output directory is cleaned up or not
 * after failing the task.
 */
@Test public void testDirCleanupAfterTaskFailed() throws IOException, InterruptedException {
  TTClient ttClient=null;
  FileStatus filesStatus[]=null;
  String localTaskDir=null;
  TaskInfo taskInfo=null;
  TaskID tID=null;
  boolean isTempFolderExists=false;
  Path inputDir=new Path("input");
  Path outputDir=new Path("output");
  Configuration conf=new Configuration(cluster.getConf());
  JobConf jconf=new JobConf(conf);
  jconf.setJobName("Task Failed job");
  jconf.setJarByClass(UtilsForTests.class);
  jconf.setMapperClass(FailedMapperClass.class);
  jconf.setNumMapTasks(1);
  jconf.setNumReduceTasks(0);
  jconf.setMaxMapAttempts(1);
  cleanup(inputDir,conf);
  cleanup(outputDir,conf);
  createInput(inputDir,conf);
  FileInputFormat.setInputPaths(jconf,inputDir);
  FileOutputFormat.setOutputPath(jconf,outputDir);
  RunningJob runJob=jobClient.submitJob(jconf);
  JobID id=runJob.getID();
  JobInfo jInfo=remoteJTClient.getJobInfo(id);
  int counter=0;
  while (counter < 60) {
    if (jInfo.getStatus().getRunState() == JobStatus.RUNNING) {
      break;
    }
 else {
      UtilsForTests.waitFor(1000);
      jInfo=remoteJTClient.getJobInfo(id);
    }
    counter++;
  }
  Assert.assertTrue("Job has not been started for 1 min.",counter != 60);
  JobStatus[] jobStatus=jobClient.getAllJobs();
  String userName=jobStatus[0].getUsername();
  TaskInfo[] taskInfos=remoteJTClient.getTaskInfo(id);
  for (  TaskInfo taskinfo : taskInfos) {
    if (!taskinfo.isSetupOrCleanup()) {
      taskInfo=taskinfo;
      break;
    }
  }
  tID=TaskID.downgrade(taskInfo.getTaskID());
  FinishTaskControlAction action=new FinishTaskControlAction(tID);
  String[] taskTrackers=taskInfo.getTaskTrackers();
  counter=0;
  while (counter < 30) {
    if (taskTrackers.length != 0) {
      break;
    }
    UtilsForTests.waitFor(1000);
    taskInfo=remoteJTClient.getTaskInfo(taskInfo.getTaskID());
    taskTrackers=taskInfo.getTaskTrackers();
    counter++;
  }
  Assert.assertTrue("Task tracker not found.",taskTrackers.length != 0);
  String hostName=taskTrackers[0].split("_")[1];
  hostName=hostName.split(":")[0];
  ttClient=cluster.getTTClient(hostName);
  ttClient.getProxy().sendAction(action);
  counter=0;
  while (counter < 60) {
    if (taskInfo.getTaskStatus().length > 0) {
      if (taskInfo.getTaskStatus()[0].getRunState() == TaskStatus.State.RUNNING) {
        break;
      }
    }
    UtilsForTests.waitFor(1000);
    taskInfo=remoteJTClient.getTaskInfo(taskInfo.getTaskID());
    counter++;
  }
  Assert.assertTrue("Task has not been started for 1 min.",counter != 60);
  String localDirs[]=ttClient.getMapredLocalDirs();
  TaskAttemptID taskAttID=new TaskAttemptID(tID,0);
  for (  String localDir : localDirs) {
    localTaskDir=localDir + "/" + TaskTracker.getLocalTaskDir(userName,id.toString(),taskAttID.toString());
    filesStatus=ttClient.listStatus(localTaskDir,true);
    if (filesStatus.length > 0) {
      isTempFolderExists=true;
      break;
    }
  }
  taskInfo=remoteJTClient.getTaskInfo(taskInfo.getTaskID());
  Assert.assertTrue("Task Attempt directory " + taskAttID + " has not been found while task was running.",isTempFolderExists);
  counter=0;
  while (counter < 30) {
    UtilsForTests.waitFor(1000);
    taskInfo=remoteJTClient.getTaskInfo(tID);
    counter++;
  }
  Assert.assertEquals("Task status has not been changed to FAILED.",taskInfo.getTaskStatus()[0].getRunState(),TaskStatus.State.FAILED);
  filesStatus=ttClient.listStatus(localTaskDir,true);
  Assert.assertTrue("Temporary folder has not been cleanup.",filesStatus.length == 0);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifying the running job status whether it succeeds or not after failing
 * some of its tasks.
 * @throws ClassNotFoundException
 */
@Test public void testFailedTaskJobStatus() throws IOException, InterruptedException, ClassNotFoundException {
  Configuration conf=new Configuration(cluster.getConf());
  TaskInfo taskInfo=null;
  SleepJob job=new SleepJob();
  job.setConf(conf);
  Job slpJob=job.createJob(3,1,4000,4000,100,100);
  JobConf jobConf=new JobConf(conf);
  jobConf.setMaxMapAttempts(20);
  jobConf.setMaxReduceAttempts(20);
  slpJob.submit();
  RunningJob runJob=jobClient.getJob(org.apache.hadoop.mapred.JobID.downgrade(slpJob.getJobID()));
  JobID id=runJob.getID();
  JobInfo jInfo=remoteJTClient.getJobInfo(id);
  int counter=0;
  while (counter < 60) {
    if (jInfo.getStatus().getRunState() == JobStatus.RUNNING) {
      break;
    }
 else {
      UtilsForTests.waitFor(1000);
      jInfo=remoteJTClient.getJobInfo(id);
    }
    counter++;
  }
  Assert.assertTrue("Job has not been started for 1 min.",counter != 60);
  TaskInfo[] taskInfos=remoteJTClient.getTaskInfo(id);
  for (  TaskInfo taskinfo : taskInfos) {
    if (!taskinfo.isSetupOrCleanup()) {
      taskInfo=taskinfo;
    }
  }
  counter=0;
  taskInfo=remoteJTClient.getTaskInfo(taskInfo.getTaskID());
  while (counter < 60) {
    if (taskInfo.getTaskStatus().length > 0) {
      if (taskInfo.getTaskStatus()[0].getRunState() == TaskStatus.State.RUNNING) {
        break;
      }
    }
    UtilsForTests.waitFor(1000);
    taskInfo=remoteJTClient.getTaskInfo(taskInfo.getTaskID());
    counter++;
  }
  Assert.assertTrue("Task has not been started for 1 min.",counter != 60);
  NetworkedJob networkJob=new JobClient.NetworkedJob(jInfo.getStatus(),jobClient.cluster);
  TaskID tID=TaskID.downgrade(taskInfo.getTaskID());
  TaskAttemptID taskAttID=new TaskAttemptID(tID,0);
  networkJob.killTask(taskAttID,false);
  LOG.info("Waiting till the job is completed...");
  while (!jInfo.getStatus().isJobComplete()) {
    UtilsForTests.waitFor(100);
    jInfo=remoteJTClient.getJobInfo(id);
  }
  Assert.assertEquals("JobStatus",jInfo.getStatus().getRunState(),JobStatus.SUCCEEDED);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskLauncher </h4><pre class="type-10 type-4 type-6 type-5 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the case "task waiting to be launched is killed externally".
 * Launches a task which will wait for ever to get slots. Kill the
 * task and see if launcher is able to come out of the wait and pickup a
 * another task.
 * @throws IOException
 */
@Test public void testExternalKillForLaunchTask() throws IOException {
  JobConf ttConf=new JobConf();
  ttConf.setInt(TTConfig.TT_MAP_SLOTS,4);
  TaskTracker tt=new MyTaskTracker();
  tt.runningTasks=new LinkedHashMap<TaskAttemptID,TaskInProgress>();
  tt.setConf(ttConf);
  tt.setIndexCache(new IndexCache(ttConf));
  tt.setTaskMemoryManagerEnabledFlag();
  tt.setTaskTrackerInstrumentation(TaskTracker.createInstrumentation(tt,tt.getJobConf()));
  TaskLauncher mapLauncher=tt.new TaskLauncher(TaskType.MAP,4);
  mapLauncher.start();
  String jtId="test";
  TaskAttemptID attemptID=new TaskAttemptID(jtId,1,TaskType.MAP,0,0);
  Task task=new MapTask(null,attemptID,0,null,5);
  mapLauncher.addToTaskQueue(new LaunchTaskAction(task));
  TaskInProgress killTip=tt.runningTasks.get(attemptID);
  assertNotNull(killTip);
  for (int i=0; i < 300; i++) {
    if (mapLauncher.getNumWaitingTasksToLaunch() == 0) {
      break;
    }
    UtilsForTests.waitFor(100);
  }
  assertEquals("Launcher didnt pick up the task " + attemptID + "to launch",0,mapLauncher.getNumWaitingTasksToLaunch());
  tt.processKillTaskAction(new KillTaskAction(attemptID));
  assertEquals(TaskStatus.State.KILLED,killTip.getRunState());
  TaskAttemptID runningAttemptID=new TaskAttemptID(jtId,1,TaskType.MAP,0,expectedLaunchAttemptId);
  mapLauncher.addToTaskQueue(new LaunchTaskAction(new MapTask(null,runningAttemptID,0,null,1)));
  TaskInProgress runningTip=tt.runningTasks.get(runningAttemptID);
  assertNotNull(runningTip);
  for (int i=0; i < 300; i++) {
    if (runningTip.getRunState().equals(TaskStatus.State.RUNNING)) {
      break;
    }
    UtilsForTests.waitFor(100);
  }
  assertEquals(TaskStatus.State.RUNNING,runningTip.getRunState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskLogServlet </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPlaintextLogs() throws Exception {
  String attemptIdStr="attempt_123_0001_m_000001_0";
  setupValidLogs(attemptIdStr);
  HttpTester request=new HttpTester();
  request.setMethod("GET");
  request.setURI("/tasklog?plaintext=true&attemptid=" + attemptIdStr);
  request.setVersion("HTTP/1.0");
  HttpTester response=doRequest(request);
  assertEquals(HttpServletResponse.SC_BAD_REQUEST,response.getStatus());
  request.setURI("/tasklog?plaintext=true&filter=stdout&attemptid=" + attemptIdStr);
  response=doRequest(request);
  assertEquals("text/plain; charset=utf-8",response.getHeader("content-type"));
  assertEquals("<b>this is stdout",response.getContent());
  request.setURI("/tasklog?plaintext=true&filter=stdout" + "&attemptid=" + attemptIdStr + "&start=1&end=6");
  response=doRequest(request);
  assertEquals("text/plain; charset=utf-8",response.getHeader("content-type"));
  assertEquals("b>thi",response.getContent());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHtmlLogs() throws Exception {
  String attemptIdStr="attempt_123_0001_m_000001_0";
  setupValidLogs(attemptIdStr);
  HttpTester request=new HttpTester();
  request.setMethod("GET");
  request.setURI("/tasklog?attemptid=" + attemptIdStr);
  request.setVersion("HTTP/1.0");
  HttpTester response=doRequest(request);
  assertEquals(HttpServletResponse.SC_OK,response.getStatus());
  assertEquals("text/html; charset=utf-8",response.getHeader("content-type"));
  assertTrue(response.getContent().contains("&lt;b&gt;this is stderr"));
  assertTrue(response.getContent().contains("&lt;b&gt;this is stdout"));
  assertTrue(response.getContent().contains("&lt;b&gt;this is syslog"));
  request.setURI("/tasklog?attemptid=" + attemptIdStr + "&start=1&end=6");
  response=doRequest(request);
  assertEquals(HttpServletResponse.SC_OK,response.getStatus());
  assertEquals("text/html; charset=utf-8",response.getHeader("content-type"));
  assertFalse(response.getContent().contains("&lt;b"));
  assertFalse(response.getContent().contains("this is"));
  assertTrue(response.getContent().contains("b&gt;thi</pre>"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMissingParameters() throws Exception {
  HttpTester request=new HttpTester();
  request.setMethod("GET");
  request.setURI("/tasklog");
  request.setVersion("HTTP/1.0");
  HttpTester response=new HttpTester();
  response.parse(tester.getResponses(request.generate()));
  assertEquals(400,response.getStatus());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskOutputSize </h4><pre class="type-10 type-13 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTaskOutputSize() throws Exception {
  MiniMRCluster mr=new MiniMRCluster(1,"file:///",1);
  Path inDir=new Path(rootDir,"input");
  Path outDir=new Path(rootDir,"output");
  Job job=MapReduceTestUtil.createJob(mr.createJobConf(),inDir,outDir,1,1);
  job.waitForCompletion(true);
  assertTrue("Job failed",job.isSuccessful());
  JobTracker jt=mr.getJobTrackerRunner().getJobTracker();
  for (  TaskCompletionEvent tce : job.getTaskCompletionEvents(0,100)) {
    TaskStatus ts=jt.getTaskStatus(TaskAttemptID.downgrade(tce.getTaskAttemptId()));
    if (tce.isMapTask()) {
      assertTrue("map output size is not found for " + tce.getTaskAttemptId(),ts.getOutputSize() > 0);
    }
 else {
      assertEquals("task output size not expected for " + tce.getTaskAttemptId(),-1,ts.getOutputSize());
    }
  }
  job=MapReduceTestUtil.createJob(mr.createJobConf(),inDir,outDir,1,0);
  job.waitForCompletion(true);
  assertTrue("Job failed",job.isSuccessful());
  for (  TaskCompletionEvent tce : job.getTaskCompletionEvents(0,100)) {
    TaskStatus ts=jt.getTaskStatus(TaskAttemptID.downgrade(tce.getTaskAttemptId()));
    assertEquals("task output size not expected for " + tce.getTaskAttemptId(),-1,ts.getOutputSize());
  }
  job=MapReduceTestUtil.createFailJob(mr.createJobConf(),outDir,inDir);
  job.waitForCompletion(true);
  assertFalse("Job not failed",job.isSuccessful());
  for (  TaskCompletionEvent tce : job.getTaskCompletionEvents(0,100)) {
    TaskStatus ts=jt.getTaskStatus(TaskAttemptID.downgrade(tce.getTaskAttemptId()));
    assertEquals("task output size not expected for " + tce.getTaskAttemptId(),-1,ts.getOutputSize());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskOwner </h4><pre class="type-10 type-11 type-13 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProcessPermission() throws Exception {
  Configuration conf=cluster.getJTClient().getConf();
  Job job=new Job(conf,"user name check");
  job.setJarByClass(UserNamePermission.class);
  job.setMapperClass(UserNamePermission.UserNameMapper.class);
  job.setCombinerClass(UserNamePermission.UserNameReducer.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(Text.class);
  job.setReducerClass(UserNamePermission.UserNameReducer.class);
  job.setNumReduceTasks(1);
  FileInputFormat.addInputPath(job,inDir);
  FileOutputFormat.setOutputPath(job,outDir);
  job.waitForCompletion(true);
  FileSystem fs=outDir.getFileSystem(conf);
  Path[] fileList=FileUtil.stat2Paths(fs.listStatus(outDir,new Utils.OutputFileUtils.OutputFilesFilter()));
  for (int i=0; i < fileList.length; ++i) {
    LOG.info("File list[" + i + "]"+ ": "+ fileList[i]);
    BufferedReader file=new BufferedReader(new InputStreamReader(fs.open(fileList[i])));
    String line=file.readLine();
    while (line != null) {
      StringTokenizer token=new StringTokenizer(line);
      if (token.hasMoreTokens()) {
        LOG.info("First token " + token.nextToken());
        String userName=token.nextToken();
        LOG.info("Next token " + userName);
        Assert.assertEquals("The user name did not match permission violation ",userName,System.getProperty("user.name").toString());
        break;
      }
    }
    file.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskStatus </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the {@link TaskStatus} against large sized task-diagnostic-info and 
 * state-string. Does the following
 * - create Map/Reduce TaskStatus such that the task-diagnostic-info and 
 * state-string are small strings and check their contents
 * - append them with small string and check their contents
 * - append them with large string and check their size
 * - update the status using statusUpdate() calls and check the size/contents
 * - create Map/Reduce TaskStatus with large string and check their size
 */
@Test public void testTaskDiagnosticsAndStateString(){
  String test="hi";
  final int maxSize=16;
  TaskStatus status=new TaskStatus(null,0,0,null,test,test,null,null,null){
    @Override protected int getMaxStringSize(){
      return maxSize;
    }
    @Override public void addFetchFailedMap(    TaskAttemptID mapTaskId){
    }
    @Override public boolean getIsMap(){
      return false;
    }
  }
;
  assertEquals("Small diagnostic info test failed",status.getDiagnosticInfo(),test);
  assertEquals("Small state string test failed",status.getStateString(),test);
  String newDInfo=test.concat(test);
  status.setDiagnosticInfo(test);
  status.setStateString(newDInfo);
  assertEquals("Small diagnostic info append failed",newDInfo,status.getDiagnosticInfo());
  assertEquals("Small state-string append failed",newDInfo,status.getStateString());
  TaskStatus newStatus=(TaskStatus)status.clone();
  String newSInfo="hi1";
  newStatus.setStateString(newSInfo);
  status.statusUpdate(newStatus);
  newDInfo=newDInfo.concat(newStatus.getDiagnosticInfo());
  assertEquals("Status-update on diagnostic-info failed",newDInfo,status.getDiagnosticInfo());
  assertEquals("Status-update on state-string failed",newSInfo,status.getStateString());
  newSInfo="hi2";
  status.statusUpdate(0,newSInfo,null);
  assertEquals("Status-update on state-string failed",newSInfo,status.getStateString());
  newSInfo="hi3";
  status.statusUpdate(null,0,newSInfo,null,0);
  assertEquals("Status-update on state-string failed",newSInfo,status.getStateString());
  String large="hihihihihihihihihihi";
  status.setDiagnosticInfo(large);
  status.setStateString(large);
  assertEquals("Large diagnostic info append test failed",maxSize,status.getDiagnosticInfo().length());
  assertEquals("Large state-string append test failed",maxSize,status.getStateString().length());
  newStatus.setDiagnosticInfo(large + "0");
  newStatus.setStateString(large + "1");
  status.statusUpdate(newStatus);
  assertEquals("Status-update on diagnostic info failed",maxSize,status.getDiagnosticInfo().length());
  assertEquals("Status-update on state-string failed",maxSize,status.getStateString().length());
  status.statusUpdate(0,large + "2",null);
  assertEquals("Status-update on state-string failed",maxSize,status.getStateString().length());
  status.statusUpdate(null,0,large + "3",null,0);
  assertEquals("Status-update on state-string failed",maxSize,status.getStateString().length());
  status=new TaskStatus(null,0,0,null,large,large,null,null,null){
    @Override protected int getMaxStringSize(){
      return maxSize;
    }
    @Override public void addFetchFailedMap(    TaskAttemptID mapTaskId){
    }
    @Override public boolean getIsMap(){
      return false;
    }
  }
;
  assertEquals("Large diagnostic info test failed",maxSize,status.getDiagnosticInfo().length());
  assertEquals("Large state-string test failed",maxSize,status.getStateString().length());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskTrackerInstrumentation </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateInstrumentationWithEmptyParam(){
  JobConf conf=new JobConf();
  conf.set(TTConfig.TT_INSTRUMENTATION,"");
  TaskTracker tracker=new TaskTracker();
  tracker.setConf(conf);
  TaskTrackerInstrumentation inst=TaskTracker.createInstrumentation(tracker,conf);
  assertEquals(TaskTrackerMetricsInst.class.getName(),inst.getClass().getName());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateInstrumentationWithSingleClass(){
  JobConf conf=new JobConf();
  conf.set(TTConfig.TT_INSTRUMENTATION,DummyTaskTrackerInstrumentation.class.getName());
  TaskTracker tracker=new TaskTracker();
  TaskTrackerInstrumentation inst=TaskTracker.createInstrumentation(tracker,conf);
  assertEquals(DummyTaskTrackerInstrumentation.class.getName(),inst.getClass().getName());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateInstrumentationWithMultipleClasses(){
  JobConf conf=new JobConf();
  String dummyClass=DummyTaskTrackerInstrumentation.class.getName();
  String classList=dummyClass + "," + dummyClass;
  conf.set(TTConfig.TT_INSTRUMENTATION,classList);
  TaskTracker tracker=new TaskTracker();
  TaskTrackerInstrumentation inst=TaskTracker.createInstrumentation(tracker,conf);
  assertEquals(CompositeTaskTrackerInstrumentation.class.getName(),inst.getClass().getName());
  CompositeTaskTrackerInstrumentation comp=(CompositeTaskTrackerInstrumentation)inst;
  List<TaskTrackerInstrumentation> insts=comp.getInstrumentations();
  assertEquals(2,insts.size());
  assertEquals(DummyTaskTrackerInstrumentation.class.getName(),insts.get(0).getClass().getName());
  assertEquals(DummyTaskTrackerInstrumentation.class.getName(),insts.get(1).getClass().getName());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateInstrumentationWithDefaultClass(){
  JobConf conf=new JobConf();
  TaskTracker tracker=new TaskTracker();
  tracker.setConf(conf);
  TaskTrackerInstrumentation inst=TaskTracker.createInstrumentation(tracker,conf);
  assertEquals(TaskTrackerMetricsInst.class.getName(),inst.getClass().getName());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateInstrumentationWithInvalidParam(){
  JobConf conf=new JobConf();
  conf.set(TTConfig.TT_INSTRUMENTATION,"XYZ,ZZY");
  TaskTracker tracker=new TaskTracker();
  tracker.setConf(conf);
  TaskTrackerInstrumentation inst=TaskTracker.createInstrumentation(tracker,conf);
  assertEquals(TaskTrackerMetricsInst.class.getName(),inst.getClass().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskTrackerMemoryManager </h4><pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test to verify the check for whether a process tree is over limit or not.
 * @throws IOException if there was a problem setting up the
 * fake procfs directories or files.
 */
@Test public void testProcessTreeLimits() throws IOException {
  File procfsRootDir=new File(TEST_ROOT_DIR,"proc");
  String[] pids={"100","200","300","400","500","600","700"};
  try {
    TestProcfsBasedProcessTree.setupProcfsRootDir(procfsRootDir);
    TestProcfsBasedProcessTree.setupPidDirs(procfsRootDir,pids);
    TestProcfsBasedProcessTree.ProcessStatInfo[] procs=new TestProcfsBasedProcessTree.ProcessStatInfo[7];
    procs[0]=new TestProcfsBasedProcessTree.ProcessStatInfo(new String[]{"100","proc1","1","100","100","100000"});
    procs[1]=new TestProcfsBasedProcessTree.ProcessStatInfo(new String[]{"200","proc2","1","200","200","200000"});
    procs[2]=new TestProcfsBasedProcessTree.ProcessStatInfo(new String[]{"300","proc3","200","200","200","300000"});
    procs[3]=new TestProcfsBasedProcessTree.ProcessStatInfo(new String[]{"400","proc4","200","200","200","400000"});
    procs[4]=new TestProcfsBasedProcessTree.ProcessStatInfo(new String[]{"500","proc5","100","100","100","1500000"});
    procs[5]=new TestProcfsBasedProcessTree.ProcessStatInfo(new String[]{"600","proc6","1","600","600","100000"});
    procs[6]=new TestProcfsBasedProcessTree.ProcessStatInfo(new String[]{"700","proc7","600","600","600","100000"});
    TestProcfsBasedProcessTree.writeStatFiles(procfsRootDir,pids,procs);
    long limit=700000;
    TaskMemoryManagerThread test=new TaskMemoryManagerThread(1000000L,5000L);
    ProcfsBasedProcessTree pTree=new ProcfsBasedProcessTree("100",true,100L,procfsRootDir.getAbsolutePath());
    pTree.getProcessTree();
    assertTrue("tree rooted at 100 should be over limit " + "after first iteration.",test.isProcessTreeOverLimit(pTree,"dummyId",limit));
    pTree=new ProcfsBasedProcessTree("200",true,100L,procfsRootDir.getAbsolutePath());
    pTree.getProcessTree();
    assertFalse("tree rooted at 200 shouldn't be over limit " + "after one iteration.",test.isProcessTreeOverLimit(pTree,"dummyId",limit));
    pTree.getProcessTree();
    assertTrue("tree rooted at 200 should be over limit after 2 iterations",test.isProcessTreeOverLimit(pTree,"dummyId",limit));
    pTree=new ProcfsBasedProcessTree("600",true,100L,procfsRootDir.getAbsolutePath());
    pTree.getProcessTree();
    assertFalse("tree rooted at 600 should never be over limit.",test.isProcessTreeOverLimit(pTree,"dummyId",limit));
    pTree.getProcessTree();
    assertFalse("tree rooted at 600 should never be over limit.",test.isProcessTreeOverLimit(pTree,"dummyId",limit));
  }
  finally {
    FileUtil.fullyDelete(procfsRootDir);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test for verifying that tasks causing cumulative usage of physical memory
 * to go beyond TT's limit get killed.
 * @throws Exception
 */
@Test public void testTasksCumulativelyExceedingTTPhysicalLimits() throws Exception {
  if (!isProcfsBasedTreeAvailable()) {
    return;
  }
  JobConf fConf=new JobConf();
  fConf.setInt(TTConfig.TT_MEMORY_MANAGER_MONITORING_INTERVAL,100);
  LinuxResourceCalculatorPlugin memoryCalculatorPlugin=new LinuxResourceCalculatorPlugin();
  long totalPhysicalMemory=memoryCalculatorPlugin.getPhysicalMemorySize();
  long reservedPhysicalMemory=totalPhysicalMemory / (1024 * 1024) + 1;
  fConf.setLong(TTConfig.TT_RESERVED_PHYSCIALMEMORY_MB,reservedPhysicalMemory);
  long maxRssMemoryAllowedForAllTasks=totalPhysicalMemory - reservedPhysicalMemory * 1024 * 1024L;
  Pattern physicalMemoryOverLimitPattern=Pattern.compile("Killing one of the memory-consuming tasks - .*" + ", as the cumulative RSS memory usage of all the tasks on " + "the TaskTracker exceeds physical memory limit " + maxRssMemoryAllowedForAllTasks + ".");
  startCluster(fConf);
  Matcher mat=null;
  JobConf conf=new JobConf(miniMRCluster.createJobConf());
  conf.setLong(MRJobConfig.MAP_MEMORY_PHYSICAL_MB,2 * 1024L);
  conf.setLong(MRJobConfig.REDUCE_MEMORY_PHYSICAL_MB,2 * 1024L);
  JobClient jClient=new JobClient(conf);
  SleepJob sleepJob=new SleepJob();
  sleepJob.setConf(conf);
  Job job=sleepJob.createJob(1,1,100000,1,100000,1);
  job.submit();
  boolean TTOverFlowMsgPresent=false;
  while (true) {
    List<TaskReport> allTaskReports=new ArrayList<TaskReport>();
    allTaskReports.addAll(Arrays.asList(jClient.getSetupTaskReports(JobID.downgrade(job.getJobID()))));
    allTaskReports.addAll(Arrays.asList(jClient.getMapTaskReports(JobID.downgrade(job.getJobID()))));
    for (    TaskReport tr : allTaskReports) {
      String[] diag=tr.getDiagnostics();
      for (      String str : diag) {
        mat=physicalMemoryOverLimitPattern.matcher(str);
        if (mat.find()) {
          TTOverFlowMsgPresent=true;
        }
      }
    }
    if (TTOverFlowMsgPresent) {
      break;
    }
    assertFalse("Job should not finish successfully",job.isSuccessful());
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
    }
  }
  job.killJob();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskTrackerSlotManagement </h4><pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case to test addition of free slot when the job fails localization due
 * to cache file being modified after the job has started running.
 * @throws Exception
 */
@Test public void testFreeingOfTaskSlots() throws Exception {
  MiniMRCluster mrCluster=new MiniMRCluster(0,"file:///",1);
  Configuration conf=mrCluster.createJobConf();
  Cluster cluster=new Cluster(conf);
  conf.set(JobContext.MAP_DEBUG_SCRIPT,"/bin/echo");
  conf.set(JobContext.REDUCE_DEBUG_SCRIPT,"/bin/echo");
  Job j=MapReduceTestUtil.createJob(conf,new Path(TEST_DIR,"in"),new Path(TEST_DIR,"out"),0,0);
  j.addCacheFile(new URI(CACHE_FILE_PATH));
  j.setMaxMapAttempts(1);
  j.setMaxReduceAttempts(1);
  j.submit();
  File myFile=new File(CACHE_FILE_PATH);
  myFile.setLastModified(0L);
  mrCluster.startTaskTracker(null,null,0,1);
  j.waitForCompletion(false);
  Assert.assertFalse("Job successfully completed.",j.isSuccessful());
  ClusterMetrics metrics=cluster.getClusterStatus();
  Assert.assertEquals(0,metrics.getOccupiedMapSlots());
  Assert.assertEquals(0,metrics.getOccupiedReduceSlots());
  TaskTracker tt=mrCluster.getTaskTrackerRunner(0).getTaskTracker();
  Assert.assertEquals(metrics.getMapSlotCapacity(),tt.getFreeSlots(true));
  Assert.assertEquals(metrics.getReduceSlotCapacity(),tt.getFreeSlots(false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTextInputFormat </h4><pre class="type-10 type-11 type-13 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFormat() throws Exception {
  JobConf job=new JobConf(defaultConf);
  Path file=new Path(workDir,"test.txt");
  Reporter reporter=Reporter.NULL;
  int seed=new Random().nextInt();
  LOG.info("seed = " + seed);
  Random random=new Random(seed);
  localFs.delete(workDir,true);
  FileInputFormat.setInputPaths(job,workDir);
  for (int length=0; length < MAX_LENGTH; length+=random.nextInt(MAX_LENGTH / 10) + 1) {
    LOG.debug("creating; entries = " + length);
    Writer writer=new OutputStreamWriter(localFs.create(file));
    try {
      for (int i=0; i < length; i++) {
        writer.write(Integer.toString(i));
        writer.write("\n");
      }
    }
  finally {
      writer.close();
    }
    TextInputFormat format=new TextInputFormat();
    format.configure(job);
    LongWritable key=new LongWritable();
    Text value=new Text();
    for (int i=0; i < 3; i++) {
      int numSplits=random.nextInt(MAX_LENGTH / 20) + 1;
      LOG.debug("splitting: requesting = " + numSplits);
      InputSplit[] splits=format.getSplits(job,numSplits);
      LOG.debug("splitting: got =        " + splits.length);
      if (length == 0) {
        assertEquals("Files of length 0 are not returned from FileInputFormat.getSplits().",1,splits.length);
        assertEquals("Empty file length == 0",0,splits[0].getLength());
      }
      BitSet bits=new BitSet(length);
      for (int j=0; j < splits.length; j++) {
        LOG.debug("split[" + j + "]= "+ splits[j]);
        RecordReader<LongWritable,Text> reader=format.getRecordReader(splits[j],job,reporter);
        try {
          int count=0;
          while (reader.next(key,value)) {
            int v=Integer.parseInt(value.toString());
            LOG.debug("read " + v);
            if (bits.get(v)) {
              LOG.warn("conflict with " + v + " in split "+ j+ " at position "+ reader.getPos());
            }
            assertFalse("Key in multiple partitions.",bits.get(v));
            bits.set(v);
            count++;
          }
          LOG.debug("splits[" + j + "]="+ splits[j]+ " count="+ count);
        }
  finally {
          reader.close();
        }
      }
      assertEquals("Some keys in no partition.",length,bits.cardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test readLine for various kinds of line termination sequneces.
 * Varies buffer size to stress test.  Also check that returned
 * value matches the string length.
 * @throws Exception
 */
@Test public void testNewLines() throws Exception {
  final String STR="a\nbb\n\nccc\rdddd\r\r\r\n\r\neeeee";
  final int STRLENBYTES=STR.getBytes().length;
  Text out=new Text();
  for (int bufsz=1; bufsz < STRLENBYTES + 1; ++bufsz) {
    LineReader in=makeStream(STR,bufsz);
    int c=0;
    c+=in.readLine(out);
    assertEquals("line1 length, bufsz:" + bufsz,1,out.getLength());
    c+=in.readLine(out);
    assertEquals("line2 length, bufsz:" + bufsz,2,out.getLength());
    c+=in.readLine(out);
    assertEquals("line3 length, bufsz:" + bufsz,0,out.getLength());
    c+=in.readLine(out);
    assertEquals("line4 length, bufsz:" + bufsz,3,out.getLength());
    c+=in.readLine(out);
    assertEquals("line5 length, bufsz:" + bufsz,4,out.getLength());
    c+=in.readLine(out);
    assertEquals("line6 length, bufsz:" + bufsz,0,out.getLength());
    c+=in.readLine(out);
    assertEquals("line7 length, bufsz:" + bufsz,0,out.getLength());
    c+=in.readLine(out);
    assertEquals("line8 length, bufsz:" + bufsz,0,out.getLength());
    c+=in.readLine(out);
    assertEquals("line9 length, bufsz:" + bufsz,5,out.getLength());
    assertEquals("end of file, bufsz: " + bufsz,0,in.readLine(out));
    assertEquals("total bytes, bufsz: " + bufsz,c,STRLENBYTES);
  }
}

</code></pre>

<br>
<pre class="type-10 type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test readLine for correct interpretation of maxLineLength
 * (returned string should be clipped at maxLineLength, and the
 * remaining bytes on the same line should be thrown out).
 * Also check that returned value matches the string length.
 * Varies buffer size to stress test.
 * @throws Exception
 */
@Test public void testMaxLineLength() throws Exception {
  final String STR="a\nbb\n\nccc\rdddd\r\neeeee";
  final int STRLENBYTES=STR.getBytes().length;
  Text out=new Text();
  for (int bufsz=1; bufsz < STRLENBYTES + 1; ++bufsz) {
    LineReader in=makeStream(STR,bufsz);
    int c=0;
    c+=in.readLine(out,1);
    assertEquals("line1 length, bufsz: " + bufsz,1,out.getLength());
    c+=in.readLine(out,1);
    assertEquals("line2 length, bufsz: " + bufsz,1,out.getLength());
    c+=in.readLine(out,1);
    assertEquals("line3 length, bufsz: " + bufsz,0,out.getLength());
    c+=in.readLine(out,3);
    assertEquals("line4 length, bufsz: " + bufsz,3,out.getLength());
    c+=in.readLine(out,10);
    assertEquals("line5 length, bufsz: " + bufsz,4,out.getLength());
    c+=in.readLine(out,8);
    assertEquals("line5 length, bufsz: " + bufsz,5,out.getLength());
    assertEquals("end of file, bufsz: " + bufsz,0,in.readLine(out));
    assertEquals("total bytes, bufsz: " + bufsz,c,STRLENBYTES);
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test using the gzip codec for reading
 */
@Test public void testGzip() throws IOException {
  JobConf job=new JobConf(defaultConf);
  CompressionCodec gzip=new GzipCodec();
  ReflectionUtils.setConf(gzip,job);
  localFs.delete(workDir,true);
  writeFile(localFs,new Path(workDir,"part1.txt.gz"),gzip,"the quick\nbrown\nfox jumped\nover\n the lazy\n dog\n");
  writeFile(localFs,new Path(workDir,"part2.txt.gz"),gzip,"this is a test\nof gzip\n");
  FileInputFormat.setInputPaths(job,workDir);
  TextInputFormat format=new TextInputFormat();
  format.configure(job);
  InputSplit[] splits=format.getSplits(job,100);
  assertEquals("compressed splits == 2",2,splits.length);
  FileSplit tmp=(FileSplit)splits[0];
  if (tmp.getPath().getName().equals("part2.txt.gz")) {
    splits[0]=splits[1];
    splits[1]=tmp;
  }
  List<Text> results=readSplit(format,splits[0],job);
  assertEquals("splits[0] length",6,results.size());
  assertEquals("splits[0][5]"," dog",results.get(5).toString());
  results=readSplit(format,splits[1],job);
  assertEquals("splits[1] length",2,results.size());
  assertEquals("splits[1][0]","this is a test",results.get(0).toString());
  assertEquals("splits[1][1]","of gzip",results.get(1).toString());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test using the gzip codec and an empty input file
 */
@Test public void testGzipEmpty() throws IOException {
  JobConf job=new JobConf(defaultConf);
  CompressionCodec gzip=new GzipCodec();
  ReflectionUtils.setConf(gzip,job);
  localFs.delete(workDir,true);
  writeFile(localFs,new Path(workDir,"empty.gz"),gzip,"");
  FileInputFormat.setInputPaths(job,workDir);
  TextInputFormat format=new TextInputFormat();
  format.configure(job);
  InputSplit[] splits=format.getSplits(job,100);
  assertEquals("Compressed files of length 0 are not returned from FileInputFormat.getSplits().",1,splits.length);
  List<Text> results=readSplit(format,splits[0],job);
  assertEquals("Compressed empty file length == 0",0,results.size());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testMRMaxLine() throws Exception {
  final int MAXPOS=1024 * 1024;
  final int MAXLINE=10 * 1024;
  final int BUF=64 * 1024;
  final InputStream infNull=new InputStream(){
    int position=0;
    final int MAXPOSBUF=1024 * 1024 + BUF;
    @Override public int read(){
      ++position;
      return 0;
    }
    @Override public int read(    byte[] b){
      assertTrue("Read too many bytes from the stream",position < MAXPOSBUF);
      Arrays.fill(b,(byte)0);
      position+=b.length;
      return b.length;
    }
  }
;
  final LongWritable key=new LongWritable();
  final Text val=new Text();
  LOG.info("Reading a line from /dev/null");
  final Configuration conf=new Configuration(false);
  conf.setInt(org.apache.hadoop.mapreduce.lib.input.LineRecordReader.MAX_LINE_LENGTH,MAXLINE);
  conf.setInt("io.file.buffer.size",BUF);
  final LineRecordReader lrr=new LineRecordReader(infNull,0,MAXPOS,conf);
  assertFalse("Read a line from null",lrr.next(key,val));
}

</code></pre>

<br>
<pre class="type-10 type-11 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitableCodecs() throws IOException {
  JobConf conf=new JobConf(defaultConf);
  int seed=new Random().nextInt();
  CompressionCodec codec=null;
  try {
    codec=(CompressionCodec)ReflectionUtils.newInstance(conf.getClassByName("org.apache.hadoop.io.compress.BZip2Codec"),conf);
  }
 catch (  ClassNotFoundException cnfe) {
    throw new IOException("Illegal codec!");
  }
  Path file=new Path(workDir,"test" + codec.getDefaultExtension());
  Reporter reporter=Reporter.NULL;
  LOG.info("seed = " + seed);
  Random random=new Random(seed);
  FileSystem localFs=FileSystem.getLocal(conf);
  localFs.delete(workDir,true);
  FileInputFormat.setInputPaths(conf,workDir);
  final int MAX_LENGTH=500000;
  for (int length=MAX_LENGTH / 2; length < MAX_LENGTH; length+=random.nextInt(MAX_LENGTH / 4) + 1) {
    LOG.info("creating; entries = " + length);
    Writer writer=new OutputStreamWriter(codec.createOutputStream(localFs.create(file)));
    try {
      for (int i=0; i < length; i++) {
        writer.write(Integer.toString(i));
        writer.write("\n");
      }
    }
  finally {
      writer.close();
    }
    TextInputFormat format=new TextInputFormat();
    format.configure(conf);
    LongWritable key=new LongWritable();
    Text value=new Text();
    for (int i=0; i < 3; i++) {
      int numSplits=random.nextInt(MAX_LENGTH / 2000) + 1;
      LOG.info("splitting: requesting = " + numSplits);
      InputSplit[] splits=format.getSplits(conf,numSplits);
      LOG.info("splitting: got =        " + splits.length);
      BitSet bits=new BitSet(length);
      for (int j=0; j < splits.length; j++) {
        LOG.debug("split[" + j + "]= "+ splits[j]);
        RecordReader<LongWritable,Text> reader=format.getRecordReader(splits[j],conf,reporter);
        try {
          int counter=0;
          while (reader.next(key,value)) {
            int v=Integer.parseInt(value.toString());
            LOG.debug("read " + v);
            if (bits.get(v)) {
              LOG.warn("conflict with " + v + " in split "+ j+ " at position "+ reader.getPos());
            }
            assertFalse("Key in multiple partitions.",bits.get(v));
            bits.set(v);
            counter++;
          }
          if (counter > 0) {
            LOG.info("splits[" + j + "]="+ splits[j]+ " count="+ counter);
          }
 else {
            LOG.debug("splits[" + j + "]="+ splits[j]+ " count="+ counter);
          }
        }
  finally {
          reader.close();
        }
      }
      assertEquals("Some keys in no partition.",length,bits.cardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUTF8() throws Exception {
  LineReader in=makeStream("abcd\u20acbdcd\u20ac");
  Text line=new Text();
  in.readLine(line);
  assertEquals("readLine changed utf8 characters","abcd\u20acbdcd\u20ac",line.toString());
  in=makeStream("abc\u200axyz");
  in.readLine(line);
  assertEquals("split on fake newline","abc\u200axyz",line.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestUtils </h4><pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOutputFilesFilter(){
  PathFilter filter=new Utils.OutputFileUtils.OutputFilesFilter();
  for (  Path p : LOG_PATHS) {
    assertFalse(filter.accept(p));
  }
  for (  Path p : SUCCEEDED_PATHS) {
    assertFalse(filter.accept(p));
  }
  for (  Path p : PASS_PATHS) {
    assertTrue(filter.accept(p));
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLogFilter(){
  PathFilter filter=new Utils.OutputFileUtils.OutputLogFilter();
  for (  Path p : LOG_PATHS) {
    assertFalse(filter.accept(p));
  }
  for (  Path p : SUCCEEDED_PATHS) {
    assertTrue(filter.accept(p));
  }
  for (  Path p : PASS_PATHS) {
    assertTrue(filter.accept(p));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestWebUIAuthorization </h4><pre class="type-10 type-13 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Run a job and validate if JSPs/Servlets are going through authentication
 * and authorization.
 * @throws Exception 
 */
@Test public void testWebUIAuthorization() throws Exception {
  setupGroupsProvider();
  Properties props=new Properties();
  props.setProperty("hadoop.http.filter.initializers",DummyFilterInitializer.class.getName());
  props.setProperty(MRConfig.MR_ACLS_ENABLED,String.valueOf(true));
  props.setProperty("dfs.permissions.enabled","false");
  props.setProperty(JTConfig.PRIVATE_ACTIONS_KEY,"true");
  props.setProperty(MRJobConfig.SETUP_CLEANUP_NEEDED,"false");
  props.setProperty(MRConfig.MR_SUPERGROUP,"superGroup");
  props.setProperty(MRConfig.MR_ADMINS,mrAdminUser + " " + mrAdminGroup);
  String[] queueNames={"default"};
  String[] submitAclStrings={jobSubmitter + "," + jobSubmitter1+ ","+ jobSubmitter2+ ","+ jobSubmitter3};
  String[] adminsAclStrings=new String[]{qAdmin};
  startCluster(props,queueNames,submitAclStrings,adminsAclStrings);
  MiniMRCluster cluster=getMRCluster();
  int infoPort=cluster.getJobTrackerRunner().getJobTrackerInfoPort();
  JobConf clusterConf=cluster.createJobConf();
  JobConf conf=new JobConf(clusterConf);
  conf.set(MRJobConfig.JOB_ACL_VIEW_JOB,viewColleague + " group3");
  conf.set(MRJobConfig.JOB_ACL_MODIFY_JOB," group1,group3");
  Job job=startSleepJobAsUser(jobSubmitter,conf);
  org.apache.hadoop.mapreduce.JobID jobid=job.getJobID();
  String jtURL="http://localhost:" + infoPort;
  String jobTrackerJSP=jtURL + "/jobtracker.jsp?a=b";
  try {
    validateJobTrackerJSPAccess(jtURL);
    validateJobDetailsJSPAccess(jobid,jtURL);
    validateTaskGraphServletAccess(jobid,jtURL);
    validateJobTasksJSPAccess(jobid,jtURL);
    validateJobConfJSPAccess(jobid,jtURL);
    validateJobFailuresJSPAccess(jobid,jtURL);
    valiateJobBlacklistedTrackerJSPAccess(jobid,jtURL);
    validateJobTrackerJSPSetPriorityAction(jobid,jtURL);
    TaskID tipId=getTIPId(cluster,jobid);
    validateTaskStatsJSPAccess(jobid,jtURL,tipId);
    validateTaskDetailsJSPAccess(jobid,jtURL,tipId);
    validateJobTrackerJSPKillJobAction(jobid,jtURL);
  }
  finally {
    if (!job.isComplete()) {
      LOG.info("Killing job " + jobid + " from finally block");
      assertEquals(HttpURLConnection.HTTP_OK,getHttpStatusCode(jobTrackerJSP + "&killJobs=true&jobCheckBox=" + jobid.toString(),jobSubmitter,"GET"));
    }
  }
  validateJobDetailsJSPKillJob(cluster,clusterConf,jtURL);
  confirmJobTrackerJSPKillJobAsUser(cluster,conf,jtURL,viewAndModifyColleague);
  confirmJobTrackerJSPKillJobAsUser(cluster,conf,jtURL,jobSubmitter);
  confirmJobTrackerJSPKillJobAsUser(cluster,conf,jtURL,mrOwner);
  confirmJobTrackerJSPKillJobAsUser(cluster,conf,jtURL,superGroupMember);
  confirmJobTrackerJSPKillJobAsUser(cluster,conf,jtURL,mrAdminUser);
  confirmJobTrackerJSPKillJobAsUser(cluster,conf,jtURL,mrAdminGroupMember);
  confirmJobTrackerJSPKillJobAsUser(cluster,conf,jtURL,qAdmin);
  validateKillMultipleJobs(cluster,conf,jtURL);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestCompressionEmulationUtils </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test {@link CompressionEmulationUtil#getPossiblyDecompressedInputStream(Path,Configuration,long)}and{@link CompressionEmulationUtil#getPossiblyCompressedOutputStream(Path,Configuration)}.
 */
@Test public void testPossiblyCompressedDecompressedStreams() throws IOException {
  JobConf conf=new JobConf();
  FileSystem lfs=FileSystem.getLocal(conf);
  String inputLine="Hi Hello!";
  CompressionEmulationUtil.setCompressionEmulationEnabled(conf,true);
  CompressionEmulationUtil.setInputCompressionEmulationEnabled(conf,true);
  conf.setBoolean(FileOutputFormat.COMPRESS,true);
  conf.setClass(FileOutputFormat.COMPRESS_CODEC,GzipCodec.class,CompressionCodec.class);
  Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  Path tempDir=new Path(rootTempDir,"TestPossiblyCompressedDecompressedStreams");
  lfs.delete(tempDir,true);
  Path compressedFile=new Path(tempDir,"test");
  OutputStream out=CompressionEmulationUtil.getPossiblyCompressedOutputStream(compressedFile,conf);
  BufferedWriter writer=new BufferedWriter(new OutputStreamWriter(out));
  writer.write(inputLine);
  writer.close();
  compressedFile=compressedFile.suffix(".gz");
  InputStream in=CompressionEmulationUtil.getPossiblyDecompressedInputStream(compressedFile,conf,0);
  BufferedReader reader=new BufferedReader(new InputStreamReader(in));
  String readLine=reader.readLine();
  assertEquals("Compression/Decompression error",inputLine,readLine);
  reader.close();
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test compressible {@link GridmixRecord}.
 */
@Test public void testCompressibleGridmixRecord() throws IOException {
  JobConf conf=new JobConf();
  CompressionEmulationUtil.setCompressionEmulationEnabled(conf,true);
  CompressionEmulationUtil.setInputCompressionEmulationEnabled(conf,true);
  FileSystem lfs=FileSystem.getLocal(conf);
  int dataSize=1024 * 1024 * 10;
  float ratio=0.357F;
  Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  Path tempDir=new Path(rootTempDir,"TestPossiblyCompressibleGridmixRecord");
  lfs.delete(tempDir,true);
  GridmixRecord record=new GridmixRecord(dataSize,0);
  record.setCompressibility(true,ratio);
  conf.setClass(FileOutputFormat.COMPRESS_CODEC,GzipCodec.class,CompressionCodec.class);
  org.apache.hadoop.mapred.FileOutputFormat.setCompressOutput(conf,true);
  Path recordFile=new Path(tempDir,"record");
  OutputStream outStream=CompressionEmulationUtil.getPossiblyCompressedOutputStream(recordFile,conf);
  DataOutputStream out=new DataOutputStream(outStream);
  record.write(out);
  out.close();
  outStream.close();
  Path actualRecordFile=recordFile.suffix(".gz");
  InputStream in=CompressionEmulationUtil.getPossiblyDecompressedInputStream(actualRecordFile,conf,0);
  long compressedFileSize=lfs.listStatus(actualRecordFile)[0].getLen();
  GridmixRecord recordRead=new GridmixRecord();
  recordRead.readFields(new DataInputStream(in));
  assertEquals("Record size mismatch in a compressible GridmixRecord",dataSize,recordRead.getSize());
  assertTrue("Failed to generate a compressible GridmixRecord",recordRead.getSize() > compressedFileSize);
  float seenRatio=((float)compressedFileSize) / dataSize;
  assertEquals(CompressionEmulationUtil.standardizeCompressionRatio(ratio),CompressionEmulationUtil.standardizeCompressionRatio(seenRatio),1.0D);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test if {@link CompressionEmulationUtil#configureCompressionEmulation(org.apache.hadoop.mapred.JobConf,org.apache.hadoop.mapred.JobConf)}can extract compression related configuration parameters.
 */
@Test public void testExtractCompressionConfigs(){
  JobConf source=new JobConf();
  JobConf target=new JobConf();
  source.setBoolean(FileOutputFormat.COMPRESS,false);
  source.set(FileOutputFormat.COMPRESS_CODEC,"MyDefaultCodec");
  source.set(FileOutputFormat.COMPRESS_TYPE,"MyDefaultType");
  source.setBoolean(MRJobConfig.MAP_OUTPUT_COMPRESS,false);
  source.set(MRJobConfig.MAP_OUTPUT_COMPRESS_CODEC,"MyDefaultCodec2");
  CompressionEmulationUtil.configureCompressionEmulation(source,target);
  assertFalse(target.getBoolean(FileOutputFormat.COMPRESS,true));
  assertEquals("MyDefaultCodec",target.get(FileOutputFormat.COMPRESS_CODEC));
  assertEquals("MyDefaultType",target.get(FileOutputFormat.COMPRESS_TYPE));
  assertFalse(target.getBoolean(MRJobConfig.MAP_OUTPUT_COMPRESS,true));
  assertEquals("MyDefaultCodec2",target.get(MRJobConfig.MAP_OUTPUT_COMPRESS_CODEC));
  assertFalse(CompressionEmulationUtil.isInputCompressionEmulationEnabled(target));
  source.setBoolean(FileOutputFormat.COMPRESS,true);
  source.set(FileOutputFormat.COMPRESS_CODEC,"MyCodec");
  source.set(FileOutputFormat.COMPRESS_TYPE,"MyType");
  source.setBoolean(MRJobConfig.MAP_OUTPUT_COMPRESS,true);
  source.set(MRJobConfig.MAP_OUTPUT_COMPRESS_CODEC,"MyCodec2");
  org.apache.hadoop.mapred.FileInputFormat.setInputPaths(source,"file.gz");
  target=new JobConf();
  CompressionEmulationUtil.configureCompressionEmulation(source,target);
  assertTrue(target.getBoolean(FileOutputFormat.COMPRESS,false));
  assertEquals("MyCodec",target.get(FileOutputFormat.COMPRESS_CODEC));
  assertEquals("MyType",target.get(FileOutputFormat.COMPRESS_TYPE));
  assertTrue(target.getBoolean(MRJobConfig.MAP_OUTPUT_COMPRESS,false));
  assertEquals("MyCodec2",target.get(MRJobConfig.MAP_OUTPUT_COMPRESS_CODEC));
  assertTrue(CompressionEmulationUtil.isInputCompressionEmulationEnabled(target));
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test {@link RandomTextDataMapper} via {@link CompressionEmulationUtil}.
 */
@Test public void testRandomCompressedTextDataGenerator() throws Exception {
  int wordSize=10;
  int listSize=20;
  long dataSize=10 * 1024 * 1024;
  Configuration conf=new Configuration();
  CompressionEmulationUtil.setCompressionEmulationEnabled(conf,true);
  CompressionEmulationUtil.setInputCompressionEmulationEnabled(conf,true);
  conf.setInt(RandomTextDataGenerator.GRIDMIX_DATAGEN_RANDOMTEXT_LISTSIZE,listSize);
  conf.setInt(RandomTextDataGenerator.GRIDMIX_DATAGEN_RANDOMTEXT_WORDSIZE,wordSize);
  conf.setLong(GenerateData.GRIDMIX_GEN_BYTES,dataSize);
  FileSystem lfs=FileSystem.getLocal(conf);
  Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  Path tempDir=new Path(rootTempDir,"TestRandomCompressedTextDataGenr");
  lfs.delete(tempDir,true);
  runDataGenJob(conf,tempDir);
  FileStatus[] files=lfs.listStatus(tempDir,new Utils.OutputFileUtils.OutputFilesFilter());
  long size=0;
  long maxLineSize=0;
  for (  FileStatus status : files) {
    InputStream in=CompressionEmulationUtil.getPossiblyDecompressedInputStream(status.getPath(),conf,0);
    BufferedReader reader=new BufferedReader(new InputStreamReader(in));
    String line=reader.readLine();
    if (line != null) {
      long lineSize=line.getBytes().length;
      if (lineSize > maxLineSize) {
        maxLineSize=lineSize;
      }
      while (line != null) {
        for (        String word : line.split("\\s")) {
          size+=word.getBytes().length;
        }
        line=reader.readLine();
      }
    }
    reader.close();
  }
  assertTrue(size >= dataSize);
  assertTrue(size <= dataSize + maxLineSize);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestDistCacheEmulation </h4><pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test the configuration property for disabling/enabling emulation of
 * distributed cache load.
 */
@Test public void testDistCacheEmulationConfigurability() throws IOException {
  Configuration conf=new Configuration();
  JobConf jobConf=GridmixTestUtils.mrCluster.createJobConf(new JobConf(conf));
  Path ioPath=new Path("testDistCacheEmulationConfigurability").makeQualified(GridmixTestUtils.dfs);
  FileSystem fs=FileSystem.get(jobConf);
  FileSystem.mkdirs(fs,ioPath,new FsPermission((short)0777));
  dce=createDistributedCacheEmulator(jobConf,ioPath,false);
  assertTrue("Default configuration of " + DistributedCacheEmulator.GRIDMIX_EMULATE_DISTRIBUTEDCACHE + " is wrong.",dce.shouldEmulateDistCacheLoad());
  jobConf.setBoolean(DistributedCacheEmulator.GRIDMIX_EMULATE_DISTRIBUTEDCACHE,false);
  dce=createDistributedCacheEmulator(jobConf,ioPath,false);
  assertFalse("Disabling of emulation of distributed cache load by setting " + DistributedCacheEmulator.GRIDMIX_EMULATE_DISTRIBUTEDCACHE + " to false is not working.",dce.shouldEmulateDistCacheLoad());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate GenerateDistCacheData job if it creates dist cache files properly.
 * @throws Exception
 */
@Test public void testGenerateDistCacheData() throws Exception {
  long[] sortedFileSizes=new long[5];
  JobConf jobConf=runSetupGenerateDistCacheData(true,sortedFileSizes);
  GridmixJob gridmixJob=new GenerateDistCacheData(jobConf);
  Job job=gridmixJob.call();
  assertEquals("Number of reduce tasks in GenerateDistCacheData is not 0.",0,job.getNumReduceTasks());
  assertTrue("GenerateDistCacheData job failed.",job.waitForCompletion(false));
  validateDistCacheData(jobConf,sortedFileSizes);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestFilePool </h4><pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPool() throws Exception {
  final Random r=new Random();
  final Configuration conf=new Configuration();
  conf.setLong(FilePool.GRIDMIX_MIN_FILE,3 * 1024);
  final FilePool pool=new FilePool(conf,base);
  pool.refresh();
  final ArrayList<FileStatus> files=new ArrayList<FileStatus>();
  final int expectedPoolSize=(NFILES / 2 * (NFILES / 2 + 1) - 6) * 1024;
  assertEquals(expectedPoolSize,pool.getInputFiles(Long.MAX_VALUE,files));
  assertEquals(NFILES - 4,files.size());
  files.clear();
  assertEquals(expectedPoolSize,pool.getInputFiles(expectedPoolSize,files));
  files.clear();
  final long rand=r.nextInt(expectedPoolSize);
  assertTrue("Missed: " + rand,(NFILES / 2) * 1024 > rand - pool.getInputFiles(rand,files));
  conf.setLong(FilePool.GRIDMIX_MIN_FILE,0);
  pool.refresh();
  files.clear();
  assertEquals((NFILES / 2 * (NFILES / 2 + 1)) * 1024,pool.getInputFiles(Long.MAX_VALUE,files));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestGridMixDataGeneration </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Generate the data in a SERIAL submission policy with EchoUserResolver
 * mode and also set the no.of bytes per file in the data.Verify whether each 
 * file size matches with given per file size or not and also 
 * verify the overall size of generated data.
 * @throws Exception
 */
@Test public void testGenerateDataWithSERIALSubmission() throws Exception {
  conf=rtClient.getDaemonConf();
  long perNodeSizeInMB=500;
  final long inputSizeInMB=cSize * perNodeSizeInMB;
  String[] runtimeValues={"LOADJOB",EchoUserResolver.class.getName(),"SERIAL",inputSizeInMB + "m","file:///dev/null"};
  long bytesPerFile=200 * 1024 * 1024;
  String[] otherArgs={"-D",GridMixConfig.GRIDMIX_BYTES_PER_FILE + "=" + bytesPerFile,"-D",GridMixConfig.GRIDMIX_DISTCACHE_ENABLE + "=false","-D",GridMixConfig.GRIDMIX_COMPRESSION_ENABLE + "=false"};
  int exitCode=UtilsForGridmix.runGridmixJob(gridmixDir,conf,GridMixRunMode.DATA_GENERATION.getValue(),runtimeValues,otherArgs);
  Assert.assertEquals("Data generation has failed.",0,exitCode);
  LOG.info("Verify the eache file size in a generate data.");
  verifyEachNodeSize(new Path(gridmixDir,"input"),perNodeSizeInMB);
  verifyNumOfFilesGeneratedInEachNode(new Path(gridmixDir,"input"),perNodeSizeInMB,bytesPerFile);
  checkGeneratedDataAndJobStatus(inputSizeInMB);
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Generate the data in a REPLAY submission policy with RoundRobinUserResolver
 * mode and verify whether the generated data matches with the given 
 * input size or not.
 * @throws Exception
 */
@Test public void testGenerateDataWithREPLAYSubmission() throws Exception {
  conf=rtClient.getDaemonConf();
  final long inputSizeInMB=cSize * 300;
  String[] runtimeValues={"LOADJOB",RoundRobinUserResolver.class.getName(),"REPLAY",inputSizeInMB + "m","file://" + UtilsForGridmix.getProxyUsersFile(conf),"file:///dev/null"};
  String[] otherArgs={"-D",GridMixConfig.GRIDMIX_DISTCACHE_ENABLE + "=false","-D",GridMixConfig.GRIDMIX_COMPRESSION_ENABLE + "=false"};
  int exitCode=UtilsForGridmix.runGridmixJob(gridmixDir,conf,GridMixRunMode.DATA_GENERATION.getValue(),runtimeValues,otherArgs);
  Assert.assertEquals("Data generation has failed.",0,exitCode);
  checkGeneratedDataAndJobStatus(inputSizeInMB);
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Generate the data in a STRESS submission policy with SubmitterUserResolver 
 * mode and verify whether the generated data matches with given 
 * input size or not.
 * @throws IOException
 */
@Test public void testGenerateDataWithSTRESSSubmission() throws Exception {
  conf=rtClient.getDaemonConf();
  final long inputSizeInMB=cSize * 128;
  String[] runtimeValues={"LOADJOB",SubmitterUserResolver.class.getName(),"STRESS",inputSizeInMB + "m","file:///dev/null"};
  String[] otherArgs={"-D",GridMixConfig.GRIDMIX_DISTCACHE_ENABLE + "=false","-D",GridMixConfig.GRIDMIX_COMPRESSION_ENABLE + "=false"};
  int exitCode=UtilsForGridmix.runGridmixJob(gridmixDir,conf,GridMixRunMode.DATA_GENERATION.getValue(),runtimeValues,otherArgs);
  Assert.assertEquals("Data generation has failed.",0,exitCode);
  checkGeneratedDataAndJobStatus(inputSizeInMB);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestGridMixFilePool </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilesCountAndSizesForSpecifiedFilePool() throws Exception {
  conf=remoteClient.getDaemonConf();
  final long inputSizeInMB=clusterSize * 200;
  int[] fileSizesInMB={50,100,400,50,300,10,60,40,20,10,500};
  long targetSize=Long.MAX_VALUE;
  final int expFileCount=clusterSize + 4;
  String[] runtimeValues={"LOADJOB",SubmitterUserResolver.class.getName(),"STRESS",inputSizeInMB + "m","file:///dev/null"};
  String[] otherArgs={"-D",GridMixConfig.GRIDMIX_DISTCACHE_ENABLE + "=false","-D",GridMixConfig.GRIDMIX_COMPRESSION_ENABLE + "=false"};
  int exitCode=UtilsForGridmix.runGridmixJob(gridmixDir,conf,GridMixRunMode.DATA_GENERATION.getValue(),runtimeValues,otherArgs);
  Assert.assertEquals("Data generation has failed.",0,exitCode);
  createFiles(new Path(gridmixDir,"input"),fileSizesInMB);
  conf.setLong(FilePool.GRIDMIX_MIN_FILE,100 * 1024 * 1024);
  FilePool fpool=new FilePool(conf,new Path(gridmixDir,"input"));
  fpool.refresh();
  verifyFilesSizeAndCountForSpecifiedPool(expFileCount,targetSize,fpool);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestPseudoLocalFs </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test if a file on PseudoLocalFs of a specific size can be opened and read.
 * Validate the size of the data read.
 * Test the read methods of {@link PseudoLocalFs.RandomInputStream}.
 * @throws Exception
 */
@Test public void testPseudoLocalFsFileSize() throws Exception {
  long fileSize=10000;
  Path path=PseudoLocalFs.generateFilePath("myPsedoFile",fileSize);
  PseudoLocalFs pfs=new PseudoLocalFs();
  pfs.create(path);
  InputStream in=pfs.open(path,0);
  long totalSize=0;
  while (in.read() >= 0) {
    ++totalSize;
  }
  in.close();
  assertEquals("File size mismatch with read().",fileSize,totalSize);
  in=pfs.open(path,0);
  totalSize=0;
  byte[] b=new byte[1024];
  int bytesRead=in.read(b);
  while (bytesRead >= 0) {
    totalSize+=bytesRead;
    bytesRead=in.read(b);
  }
  assertEquals("File size mismatch with read(byte[]).",fileSize,totalSize);
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Pseudo Local File System methods like getFileStatus(), create(),
 * open(), exists() for <li> valid file paths and <li> invalid file paths.
 * @throws IOException
 */
@Test public void testPseudoLocalFsFileNames() throws IOException {
  PseudoLocalFs pfs=new PseudoLocalFs();
  Configuration conf=new Configuration();
  conf.setClass("fs.pseudo.impl",PseudoLocalFs.class,FileSystem.class);
  Path path=new Path("pseudo:///myPsedoFile.1234");
  FileSystem testFs=path.getFileSystem(conf);
  assertEquals("Failed to obtain a pseudo local file system object from path",pfs.getUri().getScheme(),testFs.getUri().getScheme());
  path=new Path("file:///myPsedoFile.12345");
  validateGetFileStatus(pfs,path,false);
  validateCreate(pfs,path,false);
  validateOpen(pfs,path,false);
  validateExists(pfs,path,false);
  path=new Path("pseudo:///myPsedoFile");
  validateGetFileStatus(pfs,path,false);
  validateCreate(pfs,path,false);
  validateOpen(pfs,path,false);
  validateExists(pfs,path,false);
  path=new Path("pseudo:///myPsedoFile.txt");
  validateGetFileStatus(pfs,path,false);
  validateCreate(pfs,path,false);
  validateOpen(pfs,path,false);
  validateExists(pfs,path,false);
  long fileSize=231456;
  path=PseudoLocalFs.generateFilePath("my.Psedo.File",fileSize);
  assertEquals("generateFilePath() failed.",fileSize,pfs.validateFileNameFormat(path));
  validateGetFileStatus(pfs,path,true);
  validateCreate(pfs,path,true);
  validateOpen(pfs,path,true);
  validateExists(pfs,path,true);
  path=new Path("myPsedoFile.1237");
  path=path.makeQualified(pfs);
  validateGetFileStatus(pfs,path,true);
  validateCreate(pfs,path,true);
  validateOpen(pfs,path,true);
  validateExists(pfs,path,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestRandomTextDataGenerator </h4><pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test if {@link RandomTextDataGenerator} can generate same words given the
 * same list-size, word-length and seed.
 */
@Test public void testRandomTextDataGeneratorRepeatability(){
  RandomTextDataGenerator rtdg1=new RandomTextDataGenerator(10,0L,5);
  List<String> words1=rtdg1.getRandomWords();
  RandomTextDataGenerator rtdg2=new RandomTextDataGenerator(10,0L,5);
  List<String> words2=rtdg2.getRandomWords();
  assertTrue("List mismatch",words1.equals(words2));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test if {@link RandomTextDataGenerator} can generate random words of 
 * desired size.
 */
@Test public void testRandomTextDataGenerator(){
  RandomTextDataGenerator rtdg=new RandomTextDataGenerator(10,0L,5);
  List<String> words=rtdg.getRandomWords();
  assertEquals("List size mismatch",10,words.size());
  Set<String> wordsSet=new HashSet<String>(words);
  assertEquals("List size mismatch due to duplicates",10,wordsSet.size());
  for (  String word : wordsSet) {
    assertEquals("Word size mismatch",5,word.length());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test if {@link RandomTextDataGenerator} can generate different words given 
 * different seeds.
 */
@Test public void testRandomTextDataGeneratorUniqueness(){
  RandomTextDataGenerator rtdg1=new RandomTextDataGenerator(10,1L,5);
  Set<String> words1=new HashSet(rtdg1.getRandomWords());
  RandomTextDataGenerator rtdg2=new RandomTextDataGenerator(10,0L,5);
  Set<String> words2=new HashSet(rtdg2.getRandomWords());
  assertFalse("List size mismatch across lists",words1.equals(words2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestSleepJob </h4><pre class="type-10 type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapTasksOnlySleepJobs() throws Exception {
  Configuration conf=new Configuration();
  conf.setBoolean(SleepJob.SLEEPJOB_MAPTASK_ONLY,true);
  DebugJobProducer jobProducer=new DebugJobProducer(5,conf);
  JobConf jconf=GridmixTestUtils.mrCluster.createJobConf(new JobConf(conf));
  UserGroupInformation ugi=UserGroupInformation.getLoginUser();
  JobStory story;
  int seq=1;
  while ((story=jobProducer.getNextJob()) != null) {
    GridmixJob gridmixJob=JobCreator.SLEEPJOB.createGridmixJob(jconf,0,story,new Path("ignored"),ugi,seq++);
    gridmixJob.buildSplits(null);
    Job job=gridmixJob.call();
    assertEquals(0,job.getNumReduceTasks());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestUserResolve </h4><pre class="type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubmitterResolver() throws Exception {
  final UserResolver rslv=new SubmitterUserResolver();
  assertFalse(rslv.needsTargetUsersList());
  UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
  assertEquals(ugi,rslv.getTargetUgi((UserGroupInformation)null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.lib.TestChain </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetReducerWithReducerByValueAsFalse() throws Exception {
  JobConf jobConf=new JobConf();
  JobConf reducerConf=new JobConf();
  Chain.setReducer(jobConf,MyReducer.class,Object.class,Object.class,Object.class,Object.class,false,reducerConf);
  boolean reduceByValue=reducerConf.getBoolean("chain.reducer.byValue",true);
  Assert.assertEquals("It should set chain.reducer.byValue as false " + "in reducerConf when we give value as false",false,reduceByValue);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetReducerWithReducerByValueAsTrue() throws Exception {
  JobConf jobConf=new JobConf();
  JobConf reducerConf=new JobConf();
  Chain.setReducer(jobConf,MyReducer.class,Object.class,Object.class,Object.class,Object.class,true,reducerConf);
  boolean reduceByValue=reducerConf.getBoolean("chain.reducer.byValue",false);
  Assert.assertEquals("It should set chain.reducer.byValue as true " + "in reducerConf when we give value as true",true,reduceByValue);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestCounters </h4><pre class="type-10 type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify counter value works
 */
@Test public void testCounterValue(){
  final int NUMBER_TESTS=100;
  final int NUMBER_INC=10;
  final Random rand=new Random();
  for (int i=0; i < NUMBER_TESTS; i++) {
    long initValue=rand.nextInt();
    long expectedValue=initValue;
    Counter counter=new Counter("foo","bar",expectedValue);
    assertEquals("Counter value is not initialized correctly",expectedValue,counter.getValue());
    for (int j=0; j < NUMBER_INC; j++) {
      int incValue=rand.nextInt();
      counter.increment(incValue);
      expectedValue+=incValue;
      assertEquals("Counter value is not incremented correctly",expectedValue,counter.getValue());
    }
    expectedValue=rand.nextInt();
    counter.setValue(expectedValue);
    assertEquals("Counter value is not set correctly",expectedValue,counter.getValue());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestLocalRunner </h4><pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Run a test with a misconfigured number of mappers.
 * Expect failure.
 */
@Test public void testInvalidMultiMapParallelism() throws Exception {
  Job job=Job.getInstance();
  Path inputPath=createMultiMapsInput();
  Path outputPath=getOutputPath();
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.getLocal(conf);
  if (fs.exists(outputPath)) {
    fs.delete(outputPath,true);
  }
  job.setMapperClass(StressMapper.class);
  job.setReducerClass(CountingReducer.class);
  job.setNumReduceTasks(1);
  LocalJobRunner.setLocalMaxRunningMaps(job,-6);
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean success=job.waitForCompletion(true);
  assertFalse("Job succeeded somehow",success);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-6 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the GC counter actually increments when we know that we've
 * spent some time in the GC during the mapper.
 */
@Test public void testGcCounter() throws Exception {
  Path inputPath=getInputPath();
  Path outputPath=getOutputPath();
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.getLocal(conf);
  if (fs.exists(outputPath)) {
    fs.delete(outputPath,true);
  }
  if (fs.exists(inputPath)) {
    fs.delete(inputPath,true);
  }
  createInputFile(inputPath,0,20);
  Job job=Job.getInstance();
  job.setMapperClass(GCMapper.class);
  job.setNumReduceTasks(0);
  job.getConfiguration().set("io.sort.mb","25");
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean ret=job.waitForCompletion(true);
  assertTrue("job failed",ret);
  Counter gcCounter=job.getCounters().findCounter(TaskCounter.GC_TIME_MILLIS);
  assertNotNull(gcCounter);
  assertTrue("No time spent in gc",gcCounter.getValue() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestMRJobClient </h4><pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMissingProfileOutput() throws Exception {
  Configuration conf=createJobConf();
  final String input="hello1\n";
  Job job=MapReduceTestUtil.createJob(conf,getInputDir(),getOutputDir(),1,1,input);
  job.setJobName("disable-profile-fetch");
  job.setProfileEnabled(true);
  job.setProfileParams("-agentlib:,verbose=n,file=%s");
  job.setMaxMapAttempts(1);
  job.setMaxReduceAttempts(1);
  job.setJobSetupCleanupNeeded(false);
  job.waitForCompletion(true);
  Job job2=MapReduceTestUtil.createJob(conf,getInputDir(),getOutputDir(),1,1,input);
  job2.setJobName("enable-profile-fetch");
  job2.setProfileEnabled(true);
  job2.setProfileParams("-agentlib:hprof=cpu=samples,heap=sites,force=n," + "thread=y,verbose=n,file=%s");
  job2.setProfileTaskRange(true,"0-1");
  job2.setProfileTaskRange(false,"");
  job2.setMaxMapAttempts(1);
  job2.setMaxReduceAttempts(1);
  job2.setJobSetupCleanupNeeded(false);
  job2.waitForCompletion(true);
  TaskReport[] reports=job2.getTaskReports(TaskType.MAP);
  assertTrue("No task reports found!",reports.length > 0);
  TaskReport report=reports[0];
  TaskID id=report.getTaskId();
  assertTrue(TaskType.MAP == id.getTaskType());
  System.out.println("Using task id: " + id);
  TaskAttemptID attemptId=new TaskAttemptID(id,0);
  File profileOutFile=new File(attemptId.toString() + ".profile");
  assertTrue("Couldn't find profiler output",profileOutFile.exists());
  assertTrue("Couldn't remove profiler output",profileOutFile.delete());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestTaskContext </h4><pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests context.setStatus method.
 * @throws IOException
 * @throws InterruptedException
 * @throws ClassNotFoundException
 */
@Test public void testContextStatus() throws IOException, InterruptedException, ClassNotFoundException {
  Path test=new Path(testRootTempDir,"testContextStatus");
  int numMaps=1;
  Job job=MapReduceTestUtil.createJob(createJobConf(),new Path(test,"in"),new Path(test,"out"),numMaps,0);
  job.setMapperClass(MyMapper.class);
  job.waitForCompletion(true);
  assertTrue("Job failed",job.isSuccessful());
  TaskReport[] reports=job.getTaskReports(TaskType.MAP);
  assertEquals(numMaps,reports.length);
  assertEquals(myStatus,reports[0].getState());
  int numReduces=1;
  job=MapReduceTestUtil.createJob(createJobConf(),new Path(test,"in"),new Path(test,"out"),numMaps,numReduces);
  job.setMapperClass(DataCopyMapper.class);
  job.setReducerClass(DataCopyReducer.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(Text.class);
  job.setMaxMapAttempts(1);
  job.setMaxReduceAttempts(0);
  job.waitForCompletion(true);
  assertTrue("Job failed",job.isSuccessful());
  reports=job.getTaskReports(TaskType.MAP);
  assertEquals(numMaps,reports.length);
  assertEquals("map > sort",reports[0].getState());
  reports=job.getTaskReports(TaskType.REDUCE);
  assertEquals(numReduces,reports.length);
  assertEquals("reduce > reduce",reports[0].getState());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests new MapReduce reduce task's context.getProgress() method.
 * @throws IOException
 * @throws InterruptedException
 * @throws ClassNotFoundException
 */
@Test public void testReduceContextProgress() throws IOException, InterruptedException, ClassNotFoundException {
  int numTasks=1;
  Path test=new Path(testRootTempDir,"testReduceContextProgress");
  Job job=MapReduceTestUtil.createJob(createJobConf(),new Path(test,"in"),new Path(test,"out"),numTasks,numTasks,INPUT);
  job.setMapperClass(ProgressCheckerMapper.class);
  job.setReducerClass(ProgressCheckerReducer.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMaxMapAttempts(1);
  job.setMaxReduceAttempts(1);
  job.waitForCompletion(true);
  assertTrue("Job failed",job.isSuccessful());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.input.TestFileInputFormat </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddInputPath() throws IOException {
  final Configuration conf=new Configuration();
  conf.set("fs.default.name","s3://abc:xyz@hostname/");
  final Job j=Job.getInstance(conf);
  j.getConfiguration().set("fs.default.name","s3://abc:xyz@hostname/");
  final FileSystem defaultfs=FileSystem.get(conf);
  System.out.println("defaultfs.getUri() = " + defaultfs.getUri());
{
    final Path original=new Path("file:/foo");
    System.out.println("original = " + original);
    FileInputFormat.addInputPath(j,original);
    final Path[] results=FileInputFormat.getInputPaths(j);
    System.out.println("results = " + Arrays.asList(results));
    assertEquals(1,results.length);
    assertEquals(original,results[0]);
  }
{
    final Path original=new Path("file:/bar");
    System.out.println("original = " + original);
    FileInputFormat.setInputPaths(j,original);
    final Path[] results=FileInputFormat.getInputPaths(j);
    System.out.println("results = " + Arrays.asList(results));
    assertEquals(1,results.length);
    assertEquals(original,results[0]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.input.TestLineRecordReader </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the case when a custom record delimiter is specified using the
 * textinputformat.record.delimiter configuration property
 * @throws IOException
 * @throws InterruptedException
 * @throws ClassNotFoundException
 */
@Test public void testCustomRecordDelimiters() throws IOException, InterruptedException, ClassNotFoundException {
  Configuration conf=new Configuration();
  conf.set("textinputformat.record.delimiter","\t\n");
  FileSystem localFs=FileSystem.getLocal(conf);
  localFs.delete(workDir,true);
  createInputFile(conf);
  createAndRunJob(conf);
  String expected="0\tabc\ndef\n9\tghi\njkl\n";
  this.assertEquals(expected,readOutputFile(conf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.input.TestMRKeyValueTextInputFormat </h4><pre class="type-10 type-11 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFormat() throws Exception {
  Job job=Job.getInstance(new Configuration(defaultConf));
  Path file=new Path(workDir,"test.txt");
  int seed=new Random().nextInt();
  LOG.info("seed = " + seed);
  Random random=new Random(seed);
  localFs.delete(workDir,true);
  FileInputFormat.setInputPaths(job,workDir);
  final int MAX_LENGTH=10000;
  for (int length=0; length < MAX_LENGTH; length+=random.nextInt(MAX_LENGTH / 10) + 1) {
    LOG.debug("creating; entries = " + length);
    Writer writer=new OutputStreamWriter(localFs.create(file));
    try {
      for (int i=0; i < length; i++) {
        writer.write(Integer.toString(i * 2));
        writer.write("\t");
        writer.write(Integer.toString(i));
        writer.write("\n");
      }
    }
  finally {
      writer.close();
    }
    KeyValueTextInputFormat format=new KeyValueTextInputFormat();
    for (int i=0; i < 3; i++) {
      int numSplits=random.nextInt(MAX_LENGTH / 20) + 1;
      LOG.debug("splitting: requesting = " + numSplits);
      List<InputSplit> splits=format.getSplits(job);
      LOG.debug("splitting: got =        " + splits.size());
      BitSet bits=new BitSet(length);
      for (int j=0; j < splits.size(); j++) {
        LOG.debug("split[" + j + "]= "+ splits.get(j));
        TaskAttemptContext context=MapReduceTestUtil.createDummyMapTaskAttemptContext(job.getConfiguration());
        RecordReader<Text,Text> reader=format.createRecordReader(splits.get(j),context);
        Class<?> clazz=reader.getClass();
        assertEquals("reader class is KeyValueLineRecordReader.",KeyValueLineRecordReader.class,clazz);
        MapContext<Text,Text,Text,Text> mcontext=new MapContextImpl<Text,Text,Text,Text>(job.getConfiguration(),context.getTaskAttemptID(),reader,null,null,MapReduceTestUtil.createDummyReporter(),splits.get(j));
        reader.initialize(splits.get(j),mcontext);
        Text key=null;
        Text value=null;
        try {
          int count=0;
          while (reader.nextKeyValue()) {
            key=reader.getCurrentKey();
            clazz=key.getClass();
            assertEquals("Key class is Text.",Text.class,clazz);
            value=reader.getCurrentValue();
            clazz=value.getClass();
            assertEquals("Value class is Text.",Text.class,clazz);
            final int k=Integer.parseInt(key.toString());
            final int v=Integer.parseInt(value.toString());
            assertEquals("Bad key",0,k % 2);
            assertEquals("Mismatched key/value",k / 2,v);
            LOG.debug("read " + v);
            assertFalse("Key in multiple partitions.",bits.get(v));
            bits.set(v);
            count++;
          }
          LOG.debug("splits[" + j + "]="+ splits.get(j)+ " count="+ count);
        }
  finally {
          reader.close();
        }
      }
      assertEquals("Some keys in no partition.",length,bits.cardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUTF8() throws Exception {
  LineReader in=makeStream("abcd\u20acbdcd\u20ac");
  Text line=new Text();
  in.readLine(line);
  assertEquals("readLine changed utf8 characters","abcd\u20acbdcd\u20ac",line.toString());
  in=makeStream("abc\u200axyz");
  in.readLine(line);
  assertEquals("split on fake newline","abc\u200axyz",line.toString());
}

</code></pre>

<br>
<pre class="type-10 type-11 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitableCodecs() throws Exception {
  final Job job=Job.getInstance(defaultConf);
  final Configuration conf=job.getConfiguration();
  CompressionCodec codec=null;
  try {
    codec=(CompressionCodec)ReflectionUtils.newInstance(conf.getClassByName("org.apache.hadoop.io.compress.BZip2Codec"),conf);
  }
 catch (  ClassNotFoundException cnfe) {
    throw new IOException("Illegal codec!");
  }
  Path file=new Path(workDir,"test" + codec.getDefaultExtension());
  int seed=new Random().nextInt();
  LOG.info("seed = " + seed);
  Random random=new Random(seed);
  localFs.delete(workDir,true);
  FileInputFormat.setInputPaths(job,workDir);
  final int MAX_LENGTH=500000;
  FileInputFormat.setMaxInputSplitSize(job,MAX_LENGTH / 20);
  for (int length=0; length < MAX_LENGTH; length+=random.nextInt(MAX_LENGTH / 4) + 1) {
    LOG.info("creating; entries = " + length);
    Writer writer=new OutputStreamWriter(codec.createOutputStream(localFs.create(file)));
    try {
      for (int i=0; i < length; i++) {
        writer.write(Integer.toString(i * 2));
        writer.write("\t");
        writer.write(Integer.toString(i));
        writer.write("\n");
      }
    }
  finally {
      writer.close();
    }
    KeyValueTextInputFormat format=new KeyValueTextInputFormat();
    assertTrue("KVTIF claims not splittable",format.isSplitable(job,file));
    for (int i=0; i < 3; i++) {
      int numSplits=random.nextInt(MAX_LENGTH / 2000) + 1;
      LOG.info("splitting: requesting = " + numSplits);
      List<InputSplit> splits=format.getSplits(job);
      LOG.info("splitting: got =        " + splits.size());
      BitSet bits=new BitSet(length);
      for (int j=0; j < splits.size(); j++) {
        LOG.debug("split[" + j + "]= "+ splits.get(j));
        TaskAttemptContext context=MapReduceTestUtil.createDummyMapTaskAttemptContext(job.getConfiguration());
        RecordReader<Text,Text> reader=format.createRecordReader(splits.get(j),context);
        Class<?> clazz=reader.getClass();
        MapContext<Text,Text,Text,Text> mcontext=new MapContextImpl<Text,Text,Text,Text>(job.getConfiguration(),context.getTaskAttemptID(),reader,null,null,MapReduceTestUtil.createDummyReporter(),splits.get(j));
        reader.initialize(splits.get(j),mcontext);
        Text key=null;
        Text value=null;
        try {
          int count=0;
          while (reader.nextKeyValue()) {
            key=reader.getCurrentKey();
            value=reader.getCurrentValue();
            final int k=Integer.parseInt(key.toString());
            final int v=Integer.parseInt(value.toString());
            assertEquals("Bad key",0,k % 2);
            assertEquals("Mismatched key/value",k / 2,v);
            LOG.debug("read " + k + ","+ v);
            assertFalse(k + "," + v+ " in multiple partitions.",bits.get(v));
            bits.set(v);
            count++;
          }
          if (count > 0) {
            LOG.info("splits[" + j + "]="+ splits.get(j)+ " count="+ count);
          }
 else {
            LOG.debug("splits[" + j + "]="+ splits.get(j)+ " count="+ count);
          }
        }
  finally {
          reader.close();
        }
      }
      assertEquals("Some keys in no partition.",length,bits.cardinality());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNewLines() throws Exception {
  LineReader in=makeStream("a\nbb\n\nccc\rdddd\r\neeeee");
  Text out=new Text();
  in.readLine(out);
  assertEquals("line1 length",1,out.getLength());
  in.readLine(out);
  assertEquals("line2 length",2,out.getLength());
  in.readLine(out);
  assertEquals("line3 length",0,out.getLength());
  in.readLine(out);
  assertEquals("line4 length",3,out.getLength());
  in.readLine(out);
  assertEquals("line5 length",4,out.getLength());
  in.readLine(out);
  assertEquals("line5 length",5,out.getLength());
  assertEquals("end of file",0,in.readLine(out));
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test using the gzip codec for reading
 */
@Test public void testGzip() throws IOException, InterruptedException {
  Configuration conf=new Configuration(defaultConf);
  CompressionCodec gzip=new GzipCodec();
  ReflectionUtils.setConf(gzip,conf);
  localFs.delete(workDir,true);
  writeFile(localFs,new Path(workDir,"part1.txt.gz"),gzip,"line-1\tthe quick\nline-2\tbrown\nline-3\t" + "fox jumped\nline-4\tover\nline-5\t the lazy\nline-6\t dog\n");
  writeFile(localFs,new Path(workDir,"part2.txt.gz"),gzip,"line-1\tthis is a test\nline-1\tof gzip\n");
  Job job=Job.getInstance(conf);
  FileInputFormat.setInputPaths(job,workDir);
  KeyValueTextInputFormat format=new KeyValueTextInputFormat();
  List<InputSplit> splits=format.getSplits(job);
  assertEquals("compressed splits == 2",2,splits.size());
  FileSplit tmp=(FileSplit)splits.get(0);
  if (tmp.getPath().getName().equals("part2.txt.gz")) {
    splits.set(0,splits.get(1));
    splits.set(1,tmp);
  }
  List<Text> results=readSplit(format,splits.get(0),job);
  assertEquals("splits[0] length",6,results.size());
  assertEquals("splits[0][0]","the quick",results.get(0).toString());
  assertEquals("splits[0][1]","brown",results.get(1).toString());
  assertEquals("splits[0][2]","fox jumped",results.get(2).toString());
  assertEquals("splits[0][3]","over",results.get(3).toString());
  assertEquals("splits[0][4]"," the lazy",results.get(4).toString());
  assertEquals("splits[0][5]"," dog",results.get(5).toString());
  results=readSplit(format,splits.get(1),job);
  assertEquals("splits[1] length",2,results.size());
  assertEquals("splits[1][0]","this is a test",results.get(0).toString());
  assertEquals("splits[1][1]","of gzip",results.get(1).toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.input.TestMultipleInputs </h4><pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoMultipleInputs() throws IOException {
  Path in1Dir=getDir(IN1_DIR);
  Path in2Dir=getDir(IN2_DIR);
  Path outDir=getDir(OUT_DIR);
  Configuration conf=createJobConf();
  FileSystem fs=FileSystem.get(conf);
  fs.delete(outDir,true);
  DataOutputStream file1=fs.create(new Path(in1Dir,"part-0"));
  file1.writeBytes("a\nb\nc\nd\ne");
  file1.close();
  DataOutputStream file2=fs.create(new Path(in2Dir,"part-0"));
  file2.writeBytes("a\tblah\nb\tblah\nc\tblah\nd\tblah\ne\tblah");
  file2.close();
  Job job=Job.getInstance(conf);
  job.setJobName("mi");
  MultipleInputs.addInputPath(job,in1Dir,TextInputFormat.class,MapClass.class);
  MultipleInputs.addInputPath(job,in2Dir,KeyValueTextInputFormat.class,KeyValueMapClass.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(Text.class);
  job.setReducerClass(ReducerClass.class);
  FileOutputFormat.setOutputPath(job,outDir);
  boolean success=false;
  try {
    success=job.waitForCompletion(true);
  }
 catch (  InterruptedException ie) {
    throw new RuntimeException(ie);
  }
catch (  ClassNotFoundException instante) {
    throw new RuntimeException(instante);
  }
  if (!success)   throw new RuntimeException("Job failed!");
  BufferedReader output=new BufferedReader(new InputStreamReader(fs.open(new Path(outDir,"part-r-00000"))));
  assertTrue(output.readLine().equals("a 2"));
  assertTrue(output.readLine().equals("b 2"));
  assertTrue(output.readLine().equals("c 2"));
  assertTrue(output.readLine().equals("d 2"));
  assertTrue(output.readLine().equals("e 2"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.jobcontrol.TestControlledJob </h4><pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAddingDependingJobToRunningJobFails() throws Exception {
  Configuration conf=new Configuration();
  ControlledJob job1=new ControlledJob(conf);
  job1.setJobState(ControlledJob.State.RUNNING);
  assertFalse(job1.addDependingJob(new ControlledJob(conf)));
}

</code></pre>

<br>
<pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAddingDependingJobToCompletedJobFails() throws Exception {
  Configuration conf=new Configuration();
  ControlledJob job1=new ControlledJob(conf);
  job1.setJobState(ControlledJob.State.SUCCESS);
  assertFalse(job1.addDependingJob(new ControlledJob(conf)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.jobcontrol.TestMapReduceJobControlWithMocks </h4><pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailedJob() throws Exception {
  JobControl jobControl=new JobControl("Test");
  ControlledJob job1=createFailedControlledJob(jobControl);
  ControlledJob job2=createSuccessfulControlledJob(jobControl);
  ControlledJob job3=createSuccessfulControlledJob(jobControl,job1,job2);
  ControlledJob job4=createSuccessfulControlledJob(jobControl,job3);
  runJobControl(jobControl);
  assertEquals("Success list",1,jobControl.getSuccessfulJobList().size());
  assertEquals("Failed list",3,jobControl.getFailedJobList().size());
  assertTrue(job1.getJobState() == ControlledJob.State.FAILED);
  assertTrue(job2.getJobState() == ControlledJob.State.SUCCESS);
  assertTrue(job3.getJobState() == ControlledJob.State.DEPENDENT_FAILED);
  assertTrue(job4.getJobState() == ControlledJob.State.DEPENDENT_FAILED);
  jobControl.stop();
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSuccessfulJobs() throws Exception {
  JobControl jobControl=new JobControl("Test");
  ControlledJob job1=createSuccessfulControlledJob(jobControl);
  ControlledJob job2=createSuccessfulControlledJob(jobControl);
  ControlledJob job3=createSuccessfulControlledJob(jobControl,job1,job2);
  ControlledJob job4=createSuccessfulControlledJob(jobControl,job3);
  runJobControl(jobControl);
  assertEquals("Success list",4,jobControl.getSuccessfulJobList().size());
  assertEquals("Failed list",0,jobControl.getFailedJobList().size());
  assertTrue(job1.getJobState() == ControlledJob.State.SUCCESS);
  assertTrue(job2.getJobState() == ControlledJob.State.SUCCESS);
  assertTrue(job3.getJobState() == ControlledJob.State.SUCCESS);
  assertTrue(job4.getJobState() == ControlledJob.State.SUCCESS);
  jobControl.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.security.TestBinaryTokenFile </h4><pre class="type-10 type-14 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * run a distributed job and verify that TokenCache is available
 * @throws IOException
 */
@Test public void testBinaryTokenFile() throws IOException {
  System.out.println("running dist job");
  jConf=mrCluster.createJobConf();
  String nnUri=dfsCluster.getURI().toString();
  jConf.set(MRJobConfig.JOB_NAMENODES,nnUri + "," + nnUri);
  jConf.set(JTConfig.JT_USER_NAME,"jt_id");
  String[] args={"-m","1","-r","1","-mt","1","-rt","1"};
  int res=-1;
  try {
    res=ToolRunner.run(jConf,new MySleepJob(),args);
  }
 catch (  Exception e) {
    System.out.println("Job failed with" + e.getLocalizedMessage());
    e.printStackTrace(System.out);
    fail("Job failed");
  }
  assertEquals("dist job res is not 0",res,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.security.TestTokenCache </h4><pre class="type-10 type-4 type-7 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetTokensForNamenodes() throws IOException {
  Credentials credentials=new Credentials();
  TokenCache.obtainTokensForNamenodesInternal(credentials,new Path[]{p1,p2},jConf);
  String fs_addr=SecurityUtil.buildDTServiceName(p1.toUri(),NameNode.DEFAULT_PORT);
  Token<DelegationTokenIdentifier> nnt=TokenCache.getDelegationToken(credentials,fs_addr);
  System.out.println("dt for " + p1 + "("+ fs_addr+ ")"+ " = "+ nnt);
  assertNotNull("Token for nn is null",nnt);
  Collection<Token<? extends TokenIdentifier>> tns=credentials.getAllTokens();
  assertEquals("number of tokens is not 1",1,tns.size());
  boolean found=false;
  for (  Token<? extends TokenIdentifier> t : tns) {
    if (t.getKind().equals(DelegationTokenIdentifier.HDFS_DELEGATION_KIND) && t.getService().equals(new Text(fs_addr))) {
      found=true;
    }
    assertTrue("didn't find token for " + p1,found);
  }
}

</code></pre>

<br>
<pre class="type-10 type-14 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * run a local job and verify that TokenCache is available
 * @throws NoSuchAlgorithmException
 * @throws IOException
 */
@Test public void testLocalJobTokenCache() throws NoSuchAlgorithmException, IOException {
  System.out.println("running local job");
  String[] args={"-m","1","-r","1","-mt","1","-rt","1"};
  jConf.set("mapreduce.job.credentials.json",tokenFileName.toString());
  int res=-1;
  try {
    res=ToolRunner.run(jConf,new MySleepJob(),args);
  }
 catch (  Exception e) {
    System.out.println("Job failed with" + e.getLocalizedMessage());
    e.printStackTrace(System.out);
    fail("local Job failed");
  }
  assertEquals("local job res is not 0",res,0);
}

</code></pre>

<br>
<pre class="type-10 type-14 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * run a distributed job and verify that TokenCache is available
 * @throws IOException
 */
@Test public void testTokenCache() throws IOException {
  System.out.println("running dist job");
  jConf=mrCluster.createJobConf();
  String nnUri=dfsCluster.getURI().toString();
  jConf.set(MRJobConfig.JOB_NAMENODES,nnUri + "," + nnUri);
  jConf.set(JTConfig.JT_USER_NAME,"jt_id");
  String[] args={"-tokenCacheFile",tokenFileName.toString(),"-m","1","-r","1","-mt","1","-rt","1"};
  int res=-1;
  try {
    res=ToolRunner.run(jConf,new MySleepJob(),args);
  }
 catch (  Exception e) {
    System.out.println("Job failed with" + e.getLocalizedMessage());
    e.printStackTrace(System.out);
    fail("Job failed");
  }
  assertEquals("dist job res is not 0",res,0);
}

</code></pre>

<br>
<pre class="type-10 type-13 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetTokensForHftpFS() throws IOException, URISyntaxException {
  HftpFileSystem hfs=mock(HftpFileSystem.class);
  DelegationTokenSecretManager dtSecretManager=dfsCluster.getNamesystem().getDelegationTokenSecretManager();
  String renewer="renewer";
  jConf.set(JTConfig.JT_USER_NAME,renewer);
  DelegationTokenIdentifier dtId=new DelegationTokenIdentifier(new Text("user"),new Text(renewer),null);
  final Token<DelegationTokenIdentifier> t=new Token<DelegationTokenIdentifier>(dtId,dtSecretManager);
  final URI uri=new URI("hftp://host:2222/file1");
  final String fs_addr=SecurityUtil.buildDTServiceName(uri,NameNode.DEFAULT_PORT);
  t.setService(new Text(fs_addr));
  Mockito.doAnswer(new Answer<URI>(){
    @Override public URI answer(    InvocationOnMock invocation) throws Throwable {
      return uri;
    }
  }
).when(hfs).getUri();
  Mockito.doAnswer(new Answer<Token<DelegationTokenIdentifier>>(){
    @Override public Token<DelegationTokenIdentifier> answer(    InvocationOnMock invocation) throws Throwable {
      return t;
    }
  }
).when(hfs).getDelegationToken(renewer);
  Mockito.doAnswer(new Answer<String>(){
    @Override public String answer(    InvocationOnMock invocation) throws Throwable {
      return fs_addr;
    }
  }
).when(hfs).getCanonicalServiceName();
  Credentials credentials=new Credentials();
  Path p=new Path(uri.toString());
  System.out.println("Path for hftp=" + p + "; fs_addr="+ fs_addr+ "; rn="+ renewer);
  TokenCache.obtainTokensForNamenodesInternal(hfs,credentials,jConf);
  Collection<Token<? extends TokenIdentifier>> tns=credentials.getAllTokens();
  assertEquals("number of tokens is not 1",1,tns.size());
  boolean found=false;
  for (  Token<? extends TokenIdentifier> tt : tns) {
    System.out.println("token=" + tt);
    if (tt.getKind().equals(DelegationTokenIdentifier.HDFS_DELEGATION_KIND) && tt.getService().equals(new Text(fs_addr))) {
      found=true;
      assertEquals("different token",tt,t);
    }
    assertTrue("didn't find token for " + p,found);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.security.TestTokenCacheOldApi </h4><pre class="type-10 type-14 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * run a local job and verify that TokenCache is available
 * @throws NoSuchAlgorithmException
 * @throws IOException
 */
@Test public void testLocalJobTokenCache() throws NoSuchAlgorithmException, IOException {
  String[] args={"-m","1","-r","1","-mt","1","-rt","1"};
  jConf.set("mapreduce.job.credentials.json",tokenFileName.toString());
  int res=-1;
  try {
    res=ToolRunner.run(jConf,new MyDummyJob(),args);
  }
 catch (  Exception e) {
    System.out.println("Job failed with" + e.getLocalizedMessage());
    e.printStackTrace(System.out);
    fail("local Job failed");
  }
  assertEquals("local job res is not 0",res,0);
}

</code></pre>

<br>
<pre class="type-10 type-14 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * run a distributed job and verify that TokenCache is available
 * @throws IOException
 */
@Test public void testTokenCache() throws IOException {
  jConf=mrCluster.createJobConf();
  NameNode nn=dfsCluster.getNameNode();
  URI nnUri=NameNode.getUri(nn.getNameNodeAddress());
  jConf.set(JobContext.JOB_NAMENODES,nnUri + "," + nnUri.toString());
  jConf.set(JobTracker.JT_USER_NAME,"jt_id");
  String[] args={"-tokenCacheFile",tokenFileName.toString(),"-m","1","-r","1","-mt","1","-rt","1"};
  int res=-1;
  try {
    res=ToolRunner.run(jConf,new MyDummyJob(),args);
  }
 catch (  Exception e) {
    System.out.println("Job failed with" + e.getLocalizedMessage());
    e.printStackTrace(System.out);
    Assert.fail("Job failed");
  }
  assertEquals("dist job res is not 0",res,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.security.token.TestDelegationTokenRenewal </h4><pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Basic idea of the test:
 * 1. create tokens.
 * 2. Mark one of them to be renewed in 2 seconds (istead of
 * 24 hourse)
 * 3. register them for renewal
 * 4. sleep for 3 seconds
 * 5. count number of renewals (should 3 initial ones + one extra)
 * 6. register another token for 2 seconds 
 * 7. cancel it immediately
 * 8. Sleep and check that the 2 seconds renew didn't happen 
 * (totally 5 reneals)
 * 9. check cancelation
 * @throws IOException
 * @throws URISyntaxException
 */
@Test public void testDTRenewal() throws IOException, URISyntaxException {
  MyFS dfs=(MyFS)FileSystem.get(conf);
  System.out.println("dfs=" + (Object)dfs);
  MyToken token1, token2, token3;
  token1=dfs.getDelegationToken(new Text("user1"));
  token2=dfs.getDelegationToken(new Text("user2"));
  token3=dfs.getDelegationToken(new Text("user3"));
  dfs.setTokenToRenewIn2Sec(token1);
  System.out.println("token=" + token1 + " should be renewed for 2 secs");
  String nn1=DelegationTokenRenewal.SCHEME + "://host1:0";
  String nn2=DelegationTokenRenewal.SCHEME + "://host2:0";
  String nn3=DelegationTokenRenewal.SCHEME + "://host3:0";
  Credentials ts=new Credentials();
  ts.addToken(new Text(nn1),token1);
  ts.addToken(new Text(nn2),token2);
  ts.addToken(new Text(nn3),token3);
  DelegationTokenRenewal.registerDelegationTokensForRenewal(new JobID("job1",1),ts,conf);
  int numberOfExpectedRenewals=3 + 1;
  int attempts=10;
  while (attempts-- > 0) {
    try {
      Thread.sleep(3 * 1000);
    }
 catch (    InterruptedException e) {
    }
    if (dfs.getCounter() == numberOfExpectedRenewals)     break;
  }
  System.out.println("Counter = " + dfs.getCounter() + ";t="+ dfs.getToken());
  assertEquals("renew wasn't called as many times as expected(4):",numberOfExpectedRenewals,dfs.getCounter());
  assertEquals("most recently renewed token mismatch",dfs.getToken(),token1);
  ts=new Credentials();
  MyToken token4=dfs.getDelegationToken(new Text("user4"));
  dfs.setTokenToRenewIn2Sec(token4);
  System.out.println("token=" + token4 + " should be renewed for 2 secs");
  String nn4=DelegationTokenRenewal.SCHEME + "://host4:0";
  ts.addToken(new Text(nn4),token4);
  JobID jid2=new JobID("job2",1);
  DelegationTokenRenewal.registerDelegationTokensForRenewal(jid2,ts,conf);
  DelegationTokenRenewal.removeDelegationTokenRenewalForJob(jid2);
  numberOfExpectedRenewals=dfs.getCounter();
  try {
    Thread.sleep(6 * 1000);
  }
 catch (  InterruptedException e) {
  }
  System.out.println("Counter = " + dfs.getCounter() + ";t="+ dfs.getToken());
  assertEquals("renew wasn't called as many times as expected",numberOfExpectedRenewals,dfs.getCounter());
  boolean exception=false;
  try {
    dfs.renewDelegationToken(token4);
  }
 catch (  InvalidToken ite) {
    exception=true;
  }
  assertTrue("Renew of canceled token didn't fail",exception);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.security.token.delegation.TestDelegationToken </h4><pre class="type-14 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelegationToken() throws Exception {
  JobClient client;
  client=user1.doAs(new PrivilegedExceptionAction<JobClient>(){
    @Override public JobClient run() throws Exception {
      return new JobClient(cluster.createJobConf());
    }
  }
);
  JobClient bobClient;
  bobClient=user2.doAs(new PrivilegedExceptionAction<JobClient>(){
    @Override public JobClient run() throws Exception {
      return new JobClient(cluster.createJobConf());
    }
  }
);
  Token<DelegationTokenIdentifier> token=client.getDelegationToken(new Text(user1.getUserName()));
  DataInputBuffer inBuf=new DataInputBuffer();
  byte[] bytes=token.getIdentifier();
  inBuf.reset(bytes,bytes.length);
  DelegationTokenIdentifier ident=new DelegationTokenIdentifier();
  ident.readFields(inBuf);
  assertEquals("alice",ident.getUser().getUserName());
  long createTime=ident.getIssueDate();
  long maxTime=ident.getMaxDate();
  long currentTime=System.currentTimeMillis();
  System.out.println("create time: " + createTime);
  System.out.println("current time: " + currentTime);
  System.out.println("max time: " + maxTime);
  assertTrue("createTime < current",createTime < currentTime);
  assertTrue("current < maxTime",currentTime < maxTime);
  client.renewDelegationToken(token);
  client.renewDelegationToken(token);
  try {
    bobClient.renewDelegationToken(token);
    Assert.fail("bob renew");
  }
 catch (  AccessControlException ace) {
  }
  try {
    bobClient.cancelDelegationToken(token);
    Assert.fail("bob renew");
  }
 catch (  AccessControlException ace) {
  }
  client.cancelDelegationToken(token);
  try {
    client.cancelDelegationToken(token);
    Assert.fail("second alice cancel");
  }
 catch (  InvalidToken it) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.util.TestLinuxResourceCalculatorPlugin </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test parsing /proc/meminfo
 * @throws IOException
 */
@Test public void testParsingProcMemFile() throws IOException {
  long memTotal=4058864L;
  long memFree=99632L;
  long inactive=567732L;
  long swapTotal=2096472L;
  long swapFree=1818480L;
  File tempFile=new File(FAKE_MEMFILE);
  tempFile.deleteOnExit();
  FileWriter fWriter=new FileWriter(FAKE_MEMFILE);
  fWriter.write(String.format(MEMINFO_FORMAT,memTotal,memFree,inactive,swapTotal,swapFree));
  fWriter.close();
  assertEquals(plugin.getAvailablePhysicalMemorySize(),1024L * (memFree + inactive));
  assertEquals(plugin.getAvailableVirtualMemorySize(),1024L * (memFree + inactive + swapFree));
  assertEquals(plugin.getPhysicalMemorySize(),1024L * memTotal);
  assertEquals(plugin.getVirtualMemorySize(),1024L * (memTotal + swapTotal));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test parsing /proc/stat and /proc/cpuinfo
 * @throws IOException
 */
@Test public void testParsingProcStatAndCpuFile() throws IOException {
  long numProcessors=8;
  long cpuFrequencyKHz=2392781;
  String fileContent="";
  for (int i=0; i < numProcessors; i++) {
    fileContent+=String.format(CPUINFO_FORMAT,i,cpuFrequencyKHz / 1000D) + "\n";
  }
  File tempFile=new File(FAKE_CPUFILE);
  tempFile.deleteOnExit();
  FileWriter fWriter=new FileWriter(FAKE_CPUFILE);
  fWriter.write(fileContent);
  fWriter.close();
  assertEquals(plugin.getNumProcessors(),numProcessors);
  assertEquals(plugin.getCpuFrequency(),cpuFrequencyKHz);
  long uTime=54972994;
  long nTime=188860;
  long sTime=19803373;
  tempFile=new File(FAKE_STATFILE);
  tempFile.deleteOnExit();
  updateStatFile(uTime,nTime,sTime);
  assertEquals(plugin.getCumulativeCpuTime(),FAKE_JIFFY_LENGTH * (uTime + nTime + sTime));
  assertEquals(plugin.getCpuUsage(),(float)(TaskTrackerStatus.UNAVAILABLE));
  uTime+=100L;
  plugin.advanceTime(200L);
  updateStatFile(uTime,nTime,sTime);
  assertEquals(plugin.getCumulativeCpuTime(),FAKE_JIFFY_LENGTH * (uTime + nTime + sTime));
  assertEquals(plugin.getCpuUsage(),6.25F);
  uTime+=600L;
  plugin.advanceTime(300L);
  updateStatFile(uTime,nTime,sTime);
  assertEquals(plugin.getCpuUsage(),25F);
  uTime+=1L;
  plugin.advanceTime(1L);
  updateStatFile(uTime,nTime,sTime);
  assertEquals(plugin.getCumulativeCpuTime(),FAKE_JIFFY_LENGTH * (uTime + nTime + sTime));
  assertEquals(plugin.getCpuUsage(),25F);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.util.TestMRAsyncDiskService </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRelativeToWorking(){
  assertEquals(".",relativeToWorking(System.getProperty("user.dir",".")));
  String cwd=System.getProperty("user.dir",".");
  Path cwdPath=new Path(cwd);
  Path subdir=new Path(cwdPath,"foo");
  assertEquals("foo",relativeToWorking(subdir.toUri().getPath()));
  Path subsubdir=new Path(subdir,"bar");
  assertEquals("foo/bar",relativeToWorking(subsubdir.toUri().getPath()));
  Path parent=new Path(cwdPath,"..");
  assertEquals("..",relativeToWorking(parent.toUri().getPath()));
  Path sideways=new Path(parent,"baz");
  assertEquals("../baz",relativeToWorking(sideways.toUri().getPath()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-6 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test creates some directories and then removes them through 
 * MRAsyncDiskService. 
 */
@Test public void testMRAsyncDiskService() throws Throwable {
  FileSystem localFileSystem=FileSystem.getLocal(new Configuration());
  String[] vols=new String[]{TEST_ROOT_DIR + "/0",TEST_ROOT_DIR + "/1"};
  MRAsyncDiskService service=new MRAsyncDiskService(localFileSystem,vols);
  String a="a";
  String b="b";
  String c="b/c";
  String d="d";
  File fa=new File(vols[0],a);
  File fb=new File(vols[1],b);
  File fc=new File(vols[1],c);
  File fd=new File(vols[1],d);
  fa.mkdirs();
  fb.mkdirs();
  fc.mkdirs();
  fd.mkdirs();
  assertTrue(fa.exists());
  assertTrue(fb.exists());
  assertTrue(fc.exists());
  assertTrue(fd.exists());
  service.moveAndDeleteRelativePath(vols[0],a);
  assertFalse(fa.exists());
  service.moveAndDeleteRelativePath(vols[1],b);
  assertFalse(fb.exists());
  assertFalse(fc.exists());
  assertFalse(service.moveAndDeleteRelativePath(vols[1],"not_exists"));
  IOException ee=null;
  try {
    service.moveAndDeleteAbsolutePath(TEST_ROOT_DIR + "/2");
  }
 catch (  IOException e) {
    ee=e;
  }
  assertNotNull("asyncDiskService should not be able to delete files " + "outside all volumes",ee);
  assertTrue(service.moveAndDeleteAbsolutePath(vols[1] + Path.SEPARATOR_CHAR + d));
  makeSureCleanedUp(vols,service);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.raid.TestBlockFixer </h4><pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests isXorParityFile and isRsParityFile
 */
@Test public void testIsParityFile() throws IOException {
  Configuration testConf=new Configuration();
  testConf.set("hdfs.raid.locations","/raid");
  testConf.set("hdfs.raidrs.locations","/raidrs");
  BlockFixer.BlockFixerHelper helper=new BlockFixer.BlockFixerHelper(testConf);
  assertFalse("incorrectly identified rs parity file as xor parity file",helper.isXorParityFile(new Path("/raidrs/test/test")));
  assertTrue("could not identify rs parity file",helper.isRsParityFile(new Path("/raidrs/test/test")));
  assertTrue("could not identify xor parity file",helper.isXorParityFile(new Path("/raid/test/test")));
  assertFalse("incorrectly identified xor parity file as rs parity file",helper.isRsParityFile(new Path("/raid/test/test")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.raid.TestBlockFixerDistConcurrency </h4><pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tests that we can have 2 concurrent jobs fixing files 
 * (dist block fixer)
 */
@Test public void testConcurrentJobs() throws Exception {
  LOG.info("Test testConcurrentJobs started.");
  long blockSize=8192L;
  int stripeLength=3;
  mySetup(stripeLength,-1);
  Path file1=new Path("/user/dhruba/raidtest/file1");
  Path file2=new Path("/user/dhruba/raidtest/file2");
  Path destPath=new Path("/destraid/user/dhruba/raidtest");
  long crc1=TestRaidDfs.createTestFilePartialLastBlock(fileSys,file1,1,20,blockSize);
  long crc2=TestRaidDfs.createTestFilePartialLastBlock(fileSys,file2,1,20,blockSize);
  long file1Len=fileSys.getFileStatus(file1).getLen();
  long file2Len=fileSys.getFileStatus(file2).getLen();
  LOG.info("Test testConcurrentJobs created test files");
  Configuration localConf=new Configuration(conf);
  localConf.set(RaidNode.RAID_LOCATION_KEY,"/destraid");
  localConf.setInt("raid.blockfix.interval",1000);
  localConf.set("raid.blockfix.classname","org.apache.hadoop.raid.DistBlockFixer");
  localConf.setLong("raid.blockfix.filespertask",2L);
  try {
    cnode=RaidNode.createRaidNode(null,localConf);
    TestRaidDfs.waitForFileRaided(LOG,fileSys,file1,destPath);
    TestRaidDfs.waitForFileRaided(LOG,fileSys,file2,destPath);
    cnode.stop();
    cnode.join();
    FileStatus file1Stat=fileSys.getFileStatus(file1);
    FileStatus file2Stat=fileSys.getFileStatus(file2);
    DistributedFileSystem dfs=(DistributedFileSystem)fileSys;
    LocatedBlocks file1Loc=RaidDFSUtil.getBlockLocations(dfs,file1.toUri().getPath(),0,file1Stat.getLen());
    LocatedBlocks file2Loc=RaidDFSUtil.getBlockLocations(dfs,file2.toUri().getPath(),0,file2Stat.getLen());
    String[] corruptFiles=RaidDFSUtil.getCorruptFiles(dfs);
    assertEquals("no corrupt files expected",0,corruptFiles.length);
    assertEquals("filesFixed() should return 0 before fixing files",0,cnode.blockFixer.filesFixed());
    int[] corruptBlockIdxs=new int[]{0,4,6};
    for (    int idx : corruptBlockIdxs)     corruptBlock(file1Loc.get(idx).getBlock());
    reportCorruptBlocks(dfs,file1,corruptBlockIdxs,blockSize);
    cnode=RaidNode.createRaidNode(null,localConf);
    DistBlockFixer blockFixer=(DistBlockFixer)cnode.blockFixer;
    long start=System.currentTimeMillis();
    while (blockFixer.jobsRunning() < 1 && System.currentTimeMillis() - start < 240000) {
      LOG.info("Test testBlockFix waiting for fixing job 1 to start");
      Thread.sleep(10);
    }
    assertEquals("job 1 not running",1,blockFixer.jobsRunning());
    for (    int idx : corruptBlockIdxs)     corruptBlock(file2Loc.get(idx).getBlock());
    reportCorruptBlocks(dfs,file2,corruptBlockIdxs,blockSize);
    while (blockFixer.jobsRunning() < 2 && System.currentTimeMillis() - start < 240000) {
      LOG.info("Test testBlockFix waiting for fixing job 2 to start");
      Thread.sleep(10);
    }
    assertEquals("2 jobs not running",2,blockFixer.jobsRunning());
    while (blockFixer.filesFixed() < 2 && System.currentTimeMillis() - start < 240000) {
      LOG.info("Test testBlockFix waiting for files to be fixed.");
      Thread.sleep(10);
    }
    assertEquals("files not fixed",2,blockFixer.filesFixed());
    dfs=getDFS(conf,dfs);
    try {
      Thread.sleep(5 * 1000);
    }
 catch (    InterruptedException ignore) {
    }
    assertTrue("file not fixed",TestRaidDfs.validateFile(dfs,file1,file1Len,crc1));
    assertTrue("file not fixed",TestRaidDfs.validateFile(dfs,file2,file2Len,crc2));
  }
 catch (  Exception e) {
    LOG.info("Test testConcurrentJobs exception " + e + StringUtils.stringifyException(e));
    throw e;
  }
 finally {
    myTearDown();
  }
}

</code></pre>

<br>
<pre class="type-10 type-11 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tests that the distributed block fixer obeys
 * the limit on how many files to fix simultaneously
 */
@Test public void testMaxPendingFiles() throws Exception {
  LOG.info("Test testMaxPendingFiles started.");
  long blockSize=8192L;
  int stripeLength=3;
  mySetup(stripeLength,-1);
  Path file1=new Path("/user/dhruba/raidtest/file1");
  Path file2=new Path("/user/dhruba/raidtest/file2");
  Path destPath=new Path("/destraid/user/dhruba/raidtest");
  long crc1=TestRaidDfs.createTestFilePartialLastBlock(fileSys,file1,1,20,blockSize);
  long crc2=TestRaidDfs.createTestFilePartialLastBlock(fileSys,file2,1,20,blockSize);
  long file1Len=fileSys.getFileStatus(file1).getLen();
  long file2Len=fileSys.getFileStatus(file2).getLen();
  LOG.info("Test testMaxPendingFiles created test files");
  Configuration localConf=new Configuration(conf);
  localConf.set(RaidNode.RAID_LOCATION_KEY,"/destraid");
  localConf.setInt("raid.blockfix.interval",1000);
  localConf.set("raid.blockfix.classname","org.apache.hadoop.raid.DistBlockFixer");
  localConf.setLong("raid.blockfix.filespertask",2L);
  localConf.setLong("raid.blockfix.maxpendingfiles",1L);
  try {
    cnode=RaidNode.createRaidNode(null,localConf);
    TestRaidDfs.waitForFileRaided(LOG,fileSys,file1,destPath);
    TestRaidDfs.waitForFileRaided(LOG,fileSys,file2,destPath);
    cnode.stop();
    cnode.join();
    FileStatus file1Stat=fileSys.getFileStatus(file1);
    FileStatus file2Stat=fileSys.getFileStatus(file2);
    DistributedFileSystem dfs=(DistributedFileSystem)fileSys;
    LocatedBlocks file1Loc=RaidDFSUtil.getBlockLocations(dfs,file1.toUri().getPath(),0,file1Stat.getLen());
    LocatedBlocks file2Loc=RaidDFSUtil.getBlockLocations(dfs,file2.toUri().getPath(),0,file2Stat.getLen());
    String[] corruptFiles=RaidDFSUtil.getCorruptFiles(dfs);
    assertEquals("no corrupt files expected",0,corruptFiles.length);
    assertEquals("filesFixed() should return 0 before fixing files",0,cnode.blockFixer.filesFixed());
    int[] corruptBlockIdxs=new int[]{0,4,6};
    for (    int idx : corruptBlockIdxs)     corruptBlock(file1Loc.get(idx).getBlock());
    reportCorruptBlocks(dfs,file1,corruptBlockIdxs,blockSize);
    corruptFiles=RaidDFSUtil.getCorruptFiles(dfs);
    cnode=RaidNode.createRaidNode(null,localConf);
    DistBlockFixer blockFixer=(DistBlockFixer)cnode.blockFixer;
    long start=System.currentTimeMillis();
    while (blockFixer.jobsRunning() < 1 && System.currentTimeMillis() - start < 240000) {
      LOG.info("Test testBlockFix waiting for fixing job 1 to start");
      Thread.sleep(10);
    }
    assertEquals("job not running",1,blockFixer.jobsRunning());
    for (    int idx : corruptBlockIdxs)     corruptBlock(file2Loc.get(idx).getBlock());
    reportCorruptBlocks(dfs,file2,corruptBlockIdxs,blockSize);
    corruptFiles=RaidDFSUtil.getCorruptFiles(dfs);
    while (blockFixer.filesFixed() < 2 && System.currentTimeMillis() - start < 240000) {
      assertTrue("too many jobs running",blockFixer.jobsRunning() <= 1);
      Thread.sleep(10);
    }
    assertEquals("files not fixed",2,blockFixer.filesFixed());
    dfs=getDFS(conf,dfs);
    try {
      Thread.sleep(5 * 1000);
    }
 catch (    InterruptedException ignore) {
    }
    assertTrue("file not fixed",TestRaidDfs.validateFile(dfs,file1,file1Len,crc1));
    assertTrue("file not fixed",TestRaidDfs.validateFile(dfs,file2,file2Len,crc2));
  }
 catch (  Exception e) {
    LOG.info("Test testMaxPendingFiles exception " + e + StringUtils.stringifyException(e));
    throw e;
  }
 finally {
    myTearDown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.TestMapredGroupMappingServiceRefresh </h4><pre class="type-10 type-11 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupMappingRefresh() throws Exception {
  MRAdmin admin=new MRAdmin(config);
  String[] args=new String[]{"-refreshUserToGroupsMappings"};
  Groups groups=Groups.getUserToGroupsMappingService(config);
  String user=UserGroupInformation.getLoginUser().getShortUserName();
  System.out.println("first attempt:");
  List<String> g1=groups.getGroups(user);
  String[] str_groups=new String[g1.size()];
  g1.toArray(str_groups);
  System.out.println(Arrays.toString(str_groups));
  System.out.println("second attempt, should be same:");
  List<String> g2=groups.getGroups(user);
  g2.toArray(str_groups);
  System.out.println(Arrays.toString(str_groups));
  for (int i=0; i < g2.size(); i++) {
    assertEquals("Should be same group ",g1.get(i),g2.get(i));
  }
  admin.run(args);
  System.out.println("third attempt(after refresh command), should be different:");
  List<String> g3=groups.getGroups(user);
  g3.toArray(str_groups);
  System.out.println(Arrays.toString(str_groups));
  for (int i=0; i < g3.size(); i++) {
    assertFalse("Should be different group ",g1.get(i).equals(g3.get(i)));
  }
  System.out.println("");
  Thread.sleep(groupRefreshTimeoutSec * 1100);
  System.out.println("fourth attempt(after timeout), should be different:");
  List<String> g4=groups.getGroups(user);
  g4.toArray(str_groups);
  System.out.println(Arrays.toString(str_groups));
  for (int i=0; i < g4.size(); i++) {
    assertFalse("Should be different group ",g3.get(i).equals(g4.get(i)));
  }
}

</code></pre>

<br>
<pre class="type-14 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRefreshSuperUserGroupsConfiguration() throws Exception {
  final String SUPER_USER="super_user";
  final String[] GROUP_NAMES1=new String[]{"gr1","gr2"};
  final String[] GROUP_NAMES2=new String[]{"gr3","gr4"};
  String userKeyGroups=ProxyUsers.getProxySuperuserGroupConfKey(SUPER_USER);
  String userKeyHosts=ProxyUsers.getProxySuperuserIpConfKey(SUPER_USER);
  config.set(userKeyGroups,"gr3,gr4,gr5");
  config.set(userKeyHosts,"127.0.0.1");
  ProxyUsers.refreshSuperUserGroupsConfiguration(config);
  UserGroupInformation ugi1=mock(UserGroupInformation.class);
  UserGroupInformation ugi2=mock(UserGroupInformation.class);
  UserGroupInformation suUgi=mock(UserGroupInformation.class);
  when(ugi1.getRealUser()).thenReturn(suUgi);
  when(ugi2.getRealUser()).thenReturn(suUgi);
  when(suUgi.getShortUserName()).thenReturn(SUPER_USER);
  when(suUgi.getUserName()).thenReturn(SUPER_USER + "L");
  when(ugi1.getShortUserName()).thenReturn("user1");
  when(ugi2.getShortUserName()).thenReturn("user2");
  when(ugi1.getUserName()).thenReturn("userL1");
  when(ugi2.getUserName()).thenReturn("userL2");
  when(ugi1.getGroupNames()).thenReturn(GROUP_NAMES1);
  when(ugi2.getGroupNames()).thenReturn(GROUP_NAMES2);
  try {
    ProxyUsers.authorize(ugi1,"127.0.0.1",config);
    fail("first auth for " + ugi1.getShortUserName() + " should've failed ");
  }
 catch (  AuthorizationException e) {
    System.err.println("auth for " + ugi1.getUserName() + " failed");
  }
  try {
    ProxyUsers.authorize(ugi2,"127.0.0.1",config);
    System.err.println("auth for " + ugi2.getUserName() + " succeeded");
  }
 catch (  AuthorizationException e) {
    fail("first auth for " + ugi2.getShortUserName() + " should've succeeded: "+ e.getLocalizedMessage());
  }
  String rsrc="testRefreshSuperUserGroupsConfiguration_rsrc.xml";
  addNewConfigResource(rsrc,userKeyGroups,"gr2",userKeyHosts,"127.0.0.1");
  MRAdmin admin=new MRAdmin(config);
  String[] args=new String[]{"-refreshSuperUserGroupsConfiguration"};
  admin.run(args);
  try {
    ProxyUsers.authorize(ugi2,"127.0.0.1",config);
    fail("second auth for " + ugi2.getShortUserName() + " should've failed ");
  }
 catch (  AuthorizationException e) {
    System.err.println("auth for " + ugi2.getUserName() + " failed");
  }
  try {
    ProxyUsers.authorize(ugi1,"127.0.0.1",config);
    System.err.println("auth for " + ugi1.getUserName() + " succeeded");
  }
 catch (  AuthorizationException e) {
    fail("second auth for " + ugi1.getShortUserName() + " should've succeeded: "+ e.getLocalizedMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestAutoInputFormat </h4><pre class="type-11 type-13 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings({"unchecked","deprecation"}) @Test public void testFormat() throws IOException {
  JobConf job=new JobConf(conf);
  FileSystem fs=FileSystem.getLocal(conf);
  Path dir=new Path(System.getProperty("test.build.data",".") + "/mapred");
  Path txtFile=new Path(dir,"auto.txt");
  Path seqFile=new Path(dir,"auto.seq");
  fs.delete(dir,true);
  FileInputFormat.setInputPaths(job,dir);
  Writer txtWriter=new OutputStreamWriter(fs.create(txtFile));
  try {
    for (int i=0; i < LINES_COUNT; i++) {
      txtWriter.write("" + (10 * i));
      txtWriter.write("\n");
    }
  }
  finally {
    txtWriter.close();
  }
  SequenceFile.Writer seqWriter=SequenceFile.createWriter(fs,conf,seqFile,IntWritable.class,LongWritable.class);
  try {
    for (int i=0; i < RECORDS_COUNT; i++) {
      IntWritable key=new IntWritable(11 * i);
      LongWritable value=new LongWritable(12 * i);
      seqWriter.append(key,value);
    }
  }
  finally {
    seqWriter.close();
  }
  AutoInputFormat format=new AutoInputFormat();
  InputSplit[] splits=format.getSplits(job,SPLITS_COUNT);
  for (  InputSplit split : splits) {
    RecordReader reader=format.getRecordReader(split,job,Reporter.NULL);
    Object key=reader.createKey();
    Object value=reader.createValue();
    try {
      while (reader.next(key,value)) {
        if (key instanceof LongWritable) {
          assertEquals("Wrong value class.",Text.class,value.getClass());
          assertTrue("Invalid value",Integer.parseInt(((Text)value).toString()) % 10 == 0);
        }
 else {
          assertEquals("Wrong key class.",IntWritable.class,key.getClass());
          assertEquals("Wrong value class.",LongWritable.class,value.getClass());
          assertTrue("Invalid key.",((IntWritable)key).get() % 11 == 0);
          assertTrue("Invalid value.",((LongWritable)value).get() % 12 == 0);
        }
      }
    }
  finally {
      reader.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestClassWithNoPackage </h4><pre class="type-10 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGoodClassOrNull() throws MalformedURLException {
  Configuration conf=new Configuration();
  conf.setClassLoader(new URLClassLoader(new URL[]{new URL("file",null,JAR)},conf.getClassLoader()));
  String defaultPackage=this.getClass().getPackage().getName();
  Class c=StreamUtil.goodClassOrNull(conf,NAME,defaultPackage);
  assertNotNull("Class " + NAME + " not found!",c);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestDumpTypedBytes </h4><pre class="type-10 type-11 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDumping() throws Exception {
  Configuration conf=new Configuration();
  MiniDFSCluster cluster=new MiniDFSCluster(conf,2,true,null);
  FileSystem fs=cluster.getFileSystem();
  PrintStream psBackup=System.out;
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  PrintStream psOut=new PrintStream(out);
  System.setOut(psOut);
  DumpTypedBytes dumptb=new DumpTypedBytes(conf);
  try {
    Path root=new Path("/typedbytestest");
    assertTrue(fs.mkdirs(root));
    assertTrue(fs.exists(root));
    OutputStreamWriter writer=new OutputStreamWriter(fs.create(new Path(root,"test.txt")));
    try {
      for (int i=0; i < 100; i++) {
        writer.write("" + (10 * i) + "\n");
      }
    }
  finally {
      writer.close();
    }
    String[] args=new String[1];
    args[0]="/typedbytestest";
    int ret=dumptb.run(args);
    assertEquals("Return value != 0.",0,ret);
    ByteArrayInputStream in=new ByteArrayInputStream(out.toByteArray());
    TypedBytesInput tbinput=new TypedBytesInput(new DataInputStream(in));
    int counter=0;
    Object key=tbinput.read();
    while (key != null) {
      assertEquals(Long.class,key.getClass());
      Object value=tbinput.read();
      assertEquals(String.class,value.getClass());
      assertTrue("Invalid output.",Integer.parseInt(value.toString()) % 10 == 0);
      counter++;
      key=tbinput.read();
    }
    assertEquals("Wrong number of outputs.",100,counter);
  }
  finally {
    try {
      fs.close();
    }
 catch (    Exception e) {
    }
    System.setOut(psBackup);
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestLoadTypedBytes </h4><pre class="type-11 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoading() throws Exception {
  Configuration conf=new Configuration();
  MiniDFSCluster cluster=new MiniDFSCluster(conf,2,true,null);
  FileSystem fs=cluster.getFileSystem();
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  TypedBytesOutput tboutput=new TypedBytesOutput(new DataOutputStream(out));
  for (int i=0; i < 100; i++) {
    tboutput.write(new Long(i));
    tboutput.write("" + (10 * i));
  }
  InputStream isBackup=System.in;
  ByteArrayInputStream in=new ByteArrayInputStream(out.toByteArray());
  System.setIn(in);
  LoadTypedBytes loadtb=new LoadTypedBytes(conf);
  try {
    Path root=new Path("/typedbytestest");
    assertTrue(fs.mkdirs(root));
    assertTrue(fs.exists(root));
    String[] args=new String[1];
    args[0]="/typedbytestest/test.seq";
    int ret=loadtb.run(args);
    assertEquals("Return value != 0.",0,ret);
    Path file=new Path(root,"test.seq");
    assertTrue(fs.exists(file));
    SequenceFile.Reader reader=new SequenceFile.Reader(fs,file,conf);
    int counter=0;
    TypedBytesWritable key=new TypedBytesWritable();
    TypedBytesWritable value=new TypedBytesWritable();
    while (reader.next(key,value)) {
      assertEquals(Long.class,key.getValue().getClass());
      assertEquals(String.class,value.getValue().getClass());
      assertTrue("Invalid record.",Integer.parseInt(value.toString()) % 10 == 0);
      counter++;
    }
    assertEquals("Wrong number of records.",100,counter);
  }
  finally {
    try {
      fs.close();
    }
 catch (    Exception e) {
    }
    System.setIn(isBackup);
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestMultipleCachefiles </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleCachefiles() throws Exception {
  boolean mayExit=false;
  MiniMRCluster mr=null;
  MiniDFSCluster dfs=null;
  try {
    Configuration conf=new Configuration();
    dfs=new MiniDFSCluster(conf,1,true,null);
    FileSystem fileSys=dfs.getFileSystem();
    String namenode=fileSys.getUri().toString();
    mr=new MiniMRCluster(1,namenode,3);
    String strJobtracker=JTConfig.JT_IPC_ADDRESS + "=localhost:" + mr.getJobTrackerPort();
    String strNamenode="fs.default.name=" + namenode;
    String argv[]=new String[]{"-input",INPUT_FILE,"-output",OUTPUT_DIR,"-mapper",map,"-reducer",reduce,"-jobconf",strNamenode,"-jobconf",strJobtracker,"-jobconf","stream.tmpdir=" + System.getProperty("test.build.data","/tmp"),"-jobconf",JobConf.MAPRED_MAP_TASK_JAVA_OPTS + "=" + "-Dcontrib.name="+ System.getProperty("contrib.name")+ " "+ "-Dbuild.test="+ System.getProperty("build.test")+ " "+ conf.get(JobConf.MAPRED_MAP_TASK_JAVA_OPTS,conf.get(JobConf.MAPRED_TASK_JAVA_OPTS,"")),"-jobconf",JobConf.MAPRED_REDUCE_TASK_JAVA_OPTS + "=" + "-Dcontrib.name="+ System.getProperty("contrib.name")+ " "+ "-Dbuild.test="+ System.getProperty("build.test")+ " "+ conf.get(JobConf.MAPRED_REDUCE_TASK_JAVA_OPTS,conf.get(JobConf.MAPRED_TASK_JAVA_OPTS,"")),"-cacheFile",fileSys.getUri() + CACHE_FILE + "#"+ mapString,"-cacheFile",fileSys.getUri() + CACHE_FILE_2 + "#"+ mapString2};
    fileSys.delete(new Path(OUTPUT_DIR),true);
    DataOutputStream file=fileSys.create(new Path(INPUT_FILE));
    file.writeBytes(mapString + "\n");
    file.writeBytes(mapString2 + "\n");
    file.close();
    file=fileSys.create(new Path(CACHE_FILE));
    file.writeBytes(cacheString + "\n");
    file.close();
    file=fileSys.create(new Path(CACHE_FILE_2));
    file.writeBytes(cacheString2 + "\n");
    file.close();
    job=new StreamJob(argv,mayExit);
    job.go();
    fileSys=dfs.getFileSystem();
    String line=null;
    String line2=null;
    Path[] fileList=FileUtil.stat2Paths(fileSys.listStatus(new Path(OUTPUT_DIR),new Utils.OutputFileUtils.OutputFilesFilter()));
    for (int i=0; i < fileList.length; i++) {
      System.out.println(fileList[i].toString());
      BufferedReader bread=new BufferedReader(new InputStreamReader(fileSys.open(fileList[i])));
      line=bread.readLine();
      System.out.println(line);
      line2=bread.readLine();
      System.out.println(line2);
    }
    assertEquals(cacheString + "\t",line);
    assertEquals(cacheString2 + "\t",line2);
  }
  finally {
    if (dfs != null) {
      dfs.shutdown();
    }
    if (mr != null) {
      mr.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestStreamJob </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOptions() throws Exception {
  StreamJob streamJob=new StreamJob();
  assertEquals(1,streamJob.run(new String[0]));
  assertEquals(0,streamJob.run(new String[]{"-help"}));
  assertEquals(0,streamJob.run(new String[]{"-info"}));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestStreamingCombiner </h4><pre class="type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCommandLine() throws Exception {
  super.testCommandLine();
  String counterGrp="org.apache.hadoop.mapred.Task$Counter";
  Counters counters=job.running_.getCounters();
  assertTrue(counters.findCounter(counterGrp,"COMBINE_INPUT_RECORDS").getValue() != 0);
  assertTrue(counters.findCounter(counterGrp,"COMBINE_OUTPUT_RECORDS").getValue() != 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestSymLink </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSymLink() throws Exception {
  boolean mayExit=false;
  MiniMRCluster mr=null;
  MiniDFSCluster dfs=null;
  try {
    Configuration conf=new Configuration();
    dfs=new MiniDFSCluster(conf,1,true,null);
    FileSystem fileSys=dfs.getFileSystem();
    String namenode=fileSys.getUri().toString();
    mr=new MiniMRCluster(1,namenode,3);
    String strJobtracker=JTConfig.JT_IPC_ADDRESS + "=localhost:" + mr.getJobTrackerPort();
    String strNamenode="fs.default.name=" + namenode;
    String argv[]=new String[]{"-input",INPUT_FILE,"-output",OUTPUT_DIR,"-mapper",map,"-reducer",reduce,"-jobconf",strNamenode,"-jobconf",strJobtracker,"-jobconf","stream.tmpdir=" + System.getProperty("test.build.data","/tmp"),"-jobconf",JobConf.MAPRED_MAP_TASK_JAVA_OPTS + "=" + "-Dcontrib.name="+ System.getProperty("contrib.name")+ " "+ "-Dbuild.test="+ System.getProperty("build.test")+ " "+ conf.get(JobConf.MAPRED_MAP_TASK_JAVA_OPTS,conf.get(JobConf.MAPRED_TASK_JAVA_OPTS,"")),"-jobconf",JobConf.MAPRED_REDUCE_TASK_JAVA_OPTS + "=" + "-Dcontrib.name="+ System.getProperty("contrib.name")+ " "+ "-Dbuild.test="+ System.getProperty("build.test")+ " "+ conf.get(JobConf.MAPRED_REDUCE_TASK_JAVA_OPTS,conf.get(JobConf.MAPRED_TASK_JAVA_OPTS,"")),"-cacheFile",fileSys.getUri() + CACHE_FILE + "#testlink"};
    fileSys.delete(new Path(OUTPUT_DIR),true);
    DataOutputStream file=fileSys.create(new Path(INPUT_FILE));
    file.writeBytes(mapString);
    file.close();
    file=fileSys.create(new Path(CACHE_FILE));
    file.writeBytes(cacheString);
    file.close();
    job=new StreamJob(argv,mayExit);
    job.go();
    fileSys=dfs.getFileSystem();
    String line=null;
    Path[] fileList=FileUtil.stat2Paths(fileSys.listStatus(new Path(OUTPUT_DIR),new Utils.OutputFileUtils.OutputFilesFilter()));
    for (int i=0; i < fileList.length; i++) {
      System.out.println(fileList[i].toString());
      BufferedReader bread=new BufferedReader(new InputStreamReader(fileSys.open(fileList[i])));
      line=bread.readLine();
      System.out.println(line);
    }
    assertEquals(cacheString + "\t",line);
  }
  finally {
    if (dfs != null) {
      dfs.shutdown();
    }
    if (mr != null) {
      mr.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestUlimit </h4><pre class="type-14 type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests the setting of memory limit for streaming processes.
 * This will launch a streaming app which will allocate 10MB memory.
 * First, program is launched with sufficient memory. And test expects
 * it to succeed. Then program is launched with insufficient memory and 
 * is expected to be a failure.  
 */
@Test public void testCommandLine(){
  if (UtilTest.isCygwin()) {
    return;
  }
  try {
    final int numSlaves=2;
    Configuration conf=new Configuration();
    dfs=new MiniDFSCluster(conf,numSlaves,true,null);
    fs=dfs.getFileSystem();
    mr=new MiniMRCluster(numSlaves,fs.getUri().toString(),1);
    writeInputFile(fs,inputPath);
    map=UtilTest.makeJavaCommand(UlimitApp.class,new String[]{});
    runProgram(SET_MEMORY_LIMIT);
    fs.delete(outputPath,true);
    assertFalse("output not cleaned up",fs.exists(outputPath));
    mr.waitUntilIdle();
  }
 catch (  IOException e) {
    fail(StringUtils.stringifyException(e));
  }
 finally {
    if (mr != null) {
      mr.shutdown();
    }
    if (dfs != null) {
      dfs.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.rumen.TestHistograms </h4><pre class="type-10 type-11 type-13 type-14 type-4 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws IOExceptionThere should be files in the directory named by
 * ${test.build.data}/rumen/histogram-test .
 * There will be pairs of files, inputXxx.json and goldXxx.json .
 * We read the input file as a HistogramRawTestData in json. Then we
 * create a Histogram using the data field, and then a
 * LoggedDiscreteCDF using the percentiles and scale field. Finally,
 * we read the corresponding goldXxx.json as a LoggedDiscreteCDF and
 * deepCompare them.
 */
@Test public void testHistograms() throws IOException {
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs);
  final Path rootInputFile=new Path(rootInputDir,"rumen/histogram-tests");
  FileStatus[] tests=lfs.listStatus(rootInputFile);
  for (int i=0; i < tests.length; ++i) {
    Path filePath=tests[i].getPath();
    String fileName=filePath.getName();
    if (fileName.startsWith("input")) {
      String testName=fileName.substring("input".length());
      Path goldFilePath=new Path(rootInputFile,"gold" + testName);
      assertTrue("Gold file dies not exist",lfs.exists(goldFilePath));
      LoggedDiscreteCDF newResult=histogramFileToCDF(filePath,lfs);
      System.out.println("Testing a Histogram for " + fileName);
      FSDataInputStream goldStream=lfs.open(goldFilePath);
      JsonObjectMapperParser<LoggedDiscreteCDF> parser=new JsonObjectMapperParser<LoggedDiscreteCDF>(goldStream,LoggedDiscreteCDF.class);
      try {
        LoggedDiscreteCDF dcdf=parser.getNext();
        dcdf.deepCompare(newResult,new TreePath(null,"<root>"));
      }
 catch (      DeepInequalityException e) {
        fail(e.path.toString());
      }
 finally {
        parser.close();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.rumen.TestPiecewiseLinearInterpolation </h4><pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOneRun(){
  LoggedDiscreteCDF input=new LoggedDiscreteCDF();
  input.setMinimum(100000L);
  input.setMaximum(1100000L);
  ArrayList<LoggedSingleRelativeRanking> rankings=new ArrayList<LoggedSingleRelativeRanking>();
  rankings.add(makeRR(0.1,200000L));
  rankings.add(makeRR(0.5,800000L));
  rankings.add(makeRR(0.9,1000000L));
  input.setRankings(rankings);
  input.setNumberValues(3);
  CDFRandomGenerator gen=new CDFPiecewiseLinearRandomGenerator(input);
  Histogram values=new Histogram();
  for (int i=0; i < 1000000; ++i) {
    long value=gen.randomValue();
    values.enter(value);
  }
  int[] percentiles=new int[99];
  for (int i=0; i < 99; ++i) {
    percentiles[i]=i + 1;
  }
  long[] result=values.getCDF(100,percentiles);
  long sumErrorSquares=0L;
  for (int i=0; i < 10; ++i) {
    long error=result[i] - (10000L * i + 100000L);
    System.out.println("element " + i + ", got "+ result[i]+ ", expected "+ (10000L * i + 100000L)+ ", error = "+ error);
    sumErrorSquares+=error * error;
  }
  for (int i=10; i < 50; ++i) {
    long error=result[i] - (15000L * i + 50000L);
    System.out.println("element " + i + ", got "+ result[i]+ ", expected "+ (15000L * i + 50000L)+ ", error = "+ error);
    sumErrorSquares+=error * error;
  }
  for (int i=50; i < 90; ++i) {
    long error=result[i] - (5000L * i + 550000L);
    System.out.println("element " + i + ", got "+ result[i]+ ", expected "+ (5000L * i + 550000L)+ ", error = "+ error);
    sumErrorSquares+=error * error;
  }
  for (int i=90; i <= 100; ++i) {
    long error=result[i] - (10000L * i + 100000L);
    System.out.println("element " + i + ", got "+ result[i]+ ", expected "+ (10000L * i + 100000L)+ ", error = "+ error);
    sumErrorSquares+=error * error;
  }
  double realSumErrorSquares=(double)sumErrorSquares;
  double normalizedError=realSumErrorSquares / 100 / rankings.get(1).getDatum()/ rankings.get(1).getDatum();
  double RMSNormalizedError=Math.sqrt(normalizedError);
  System.out.println("sumErrorSquares = " + sumErrorSquares);
  System.out.println("normalizedError: " + normalizedError + ", RMSNormalizedError: "+ RMSNormalizedError);
  System.out.println("Cumulative error is " + RMSNormalizedError);
  assertTrue("The RMS relative error per bucket, " + RMSNormalizedError + ", exceeds our tolerance of "+ maximumRelativeError,RMSNormalizedError <= maximumRelativeError);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.rumen.TestRumenFolder </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFoldingSmallTrace() throws Exception {
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  @SuppressWarnings("deprecation") final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs);
  @SuppressWarnings("deprecation") final Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs);
  final Path rootInputFile=new Path(rootInputDir,"rumen/small-trace-test");
  final Path tempDir=new Path(rootTempDir,"TestRumenJobTraces");
  lfs.delete(tempDir,true);
  final Path foldedTracePath=new Path(tempDir,"folded-trace.json");
  final Path inputFile=new Path(rootInputFile,"folder-input-trace.json.gz");
  System.out.println("folded trace result path = " + foldedTracePath);
  String[] args={"-input-cycle","100S","-output-duration","300S","-skew-buffer-length","1","-seed","100","-concentration","2",inputFile.toString(),foldedTracePath.toString()};
  final Path foldedGoldFile=new Path(rootInputFile,"goldFoldedTrace.json.gz");
  Folder folder=new Folder();
  int result=ToolRunner.run(folder,args);
  assertEquals("Non-zero exit",0,result);
  TestRumenFolder.<LoggedJob>jsonFileMatchesGold(conf,lfs,foldedTracePath,foldedGoldFile,LoggedJob.class,"trace");
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStartsAfterOption() throws Exception {
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  @SuppressWarnings("deprecation") final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs);
  @SuppressWarnings("deprecation") final Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs);
  final Path rootInputFile=new Path(rootInputDir,"rumen/small-trace-test");
  final Path tempDir=new Path(rootTempDir,"TestRumenJobTraces");
  lfs.delete(tempDir,true);
  final Path inputFile=new Path(rootInputFile,"goldFoldedTrace.json.gz");
  final Path foldedTracePath=new Path(tempDir,"folded-skippedjob-trace.json");
  String[] args={"-input-cycle","300S","-output-duration","300S","-starts-after","30S",inputFile.toString(),foldedTracePath.toString()};
  Folder folder=new Folder();
  int result=ToolRunner.run(folder,args);
  assertEquals("Non-zero exit",0,result);
  TestRumenFolder.<LoggedJob>checkValidityAfterSkippingJobs(conf,lfs,foldedTracePath,inputFile,LoggedJob.class,"trace",30000,300000);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.rumen.TestRumenJobTraces </h4><pre class="type-10 type-4 type-6 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoop20JHParser() throws Exception {
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  final Path rootInputPath=new Path(rootInputDir,"rumen/small-trace-test");
  final Path inputPath=new Path(rootInputPath,"v20-single-input-log.gz");
  RewindableInputStream ris=getRewindableInputStream(inputPath,conf);
  assertNotNull(ris);
  Hadoop20JHParser parser=null;
  try {
    assertEquals("Hadoop20JHParser can't parse the test file " + inputPath,true,Hadoop20JHParser.canParse(ris));
    ris.rewind();
    parser=new Hadoop20JHParser(ris);
    ArrayList<String> seenEvents=new ArrayList<String>(150);
    getHistoryEvents(parser,seenEvents,null);
    validateSeenHistoryEvents(seenEvents,goldLines);
  }
  finally {
    if (parser != null) {
      parser.close();
    }
    ris.close();
  }
}

</code></pre>

<br>
<pre class="type-13 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTopologyBuilder() throws Exception {
  final TopologyBuilder subject=new TopologyBuilder();
  subject.process(new Properties());
  subject.process(new TaskAttemptFinishedEvent(TaskAttemptID.forName("attempt_200904211745_0003_m_000004_0"),TaskType.valueOf("MAP"),"STATUS",1234567890L,"/194\\.6\\.134\\.64/cluster50261\\.secondleveldomain\\.com","SUCCESS",null));
  subject.process(new TaskAttemptUnsuccessfulCompletionEvent(TaskAttemptID.forName("attempt_200904211745_0003_m_000004_1"),TaskType.valueOf("MAP"),"STATUS",1234567890L,"/194\\.6\\.134\\.80/cluster50262\\.secondleveldomain\\.com","MACHINE_EXPLODED"));
  subject.process(new TaskAttemptUnsuccessfulCompletionEvent(TaskAttemptID.forName("attempt_200904211745_0003_m_000004_2"),TaskType.valueOf("MAP"),"STATUS",1234567890L,"/194\\.6\\.134\\.80/cluster50263\\.secondleveldomain\\.com","MACHINE_EXPLODED"));
  subject.process(new TaskStartedEvent(TaskID.forName("task_200904211745_0003_m_000004"),1234567890L,TaskType.valueOf("MAP"),"/194\\.6\\.134\\.80/cluster50263\\.secondleveldomain\\.com"));
  final LoggedNetworkTopology topology=subject.build();
  List<LoggedNetworkTopology> racks=topology.getChildren();
  assertEquals("Wrong number of racks",2,racks.size());
  boolean sawSingleton=false;
  boolean sawDoubleton=false;
  for (  LoggedNetworkTopology rack : racks) {
    List<LoggedNetworkTopology> nodes=rack.getChildren();
    if (rack.getName().endsWith(".64")) {
      assertEquals("The singleton rack has the wrong number of elements",1,nodes.size());
      sawSingleton=true;
    }
 else     if (rack.getName().endsWith(".80")) {
      assertEquals("The doubleton rack has the wrong number of elements",2,nodes.size());
      sawDoubleton=true;
    }
 else {
      assertTrue("Unrecognized rack name",false);
    }
  }
  assertTrue("Did not see singleton rack",sawSingleton);
  assertTrue("Did not see doubleton rack",sawDoubleton);
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRumenViaDispatch() throws Exception {
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  final Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  final Path rootInputPath=new Path(rootInputDir,"rumen/small-trace-test");
  final Path tempDir=new Path(rootTempDir,"TestRumenViaDispatch");
  lfs.delete(tempDir,true);
  final Path topologyPath=new Path(tempDir,"dispatch-topology.json");
  final Path tracePath=new Path(tempDir,"dispatch-trace.json");
  final Path inputPath=new Path(rootInputPath,"dispatch-sample-v20-jt-log.gz");
  System.out.println("topology result file = " + topologyPath);
  System.out.println("testRumenViaDispatch() trace result file = " + tracePath);
  String demuxerClassName=ConcatenatedInputFilesDemuxer.class.getName();
  String[] args={"-demuxer",demuxerClassName,tracePath.toString(),topologyPath.toString(),inputPath.toString()};
  final Path topologyGoldFile=new Path(rootInputPath,"dispatch-topology-output.json.gz");
  final Path traceGoldFile=new Path(rootInputPath,"dispatch-trace-output.json.gz");
  Tool analyzer=new TraceBuilder();
  int result=ToolRunner.run(analyzer,args);
  assertEquals("Non-zero exit",0,result);
  TestRumenJobTraces.<LoggedNetworkTopology>jsonFileMatchesGold(conf,topologyPath,topologyGoldFile,LoggedNetworkTopology.class,"topology");
  TestRumenJobTraces.<LoggedJob>jsonFileMatchesGold(conf,tracePath,traceGoldFile,LoggedJob.class,"trace");
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBracketedCounters() throws Exception {
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  final Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  final Path rootInputPath=new Path(rootInputDir,"rumen/small-trace-test");
  final Path tempDir=new Path(rootTempDir,"TestBracketedCounters");
  lfs.delete(tempDir,true);
  final Path topologyPath=new Path(tempDir,"dispatch-topology.json");
  final Path tracePath=new Path(tempDir,"dispatch-trace.json");
  final Path inputPath=new Path(rootInputPath,"counters-format-test-logs");
  System.out.println("topology result file = " + topologyPath);
  System.out.println("testBracketedCounters() trace result file = " + tracePath);
  final Path goldPath=new Path(rootInputPath,"counters-test-trace.json.gz");
  String[] args={tracePath.toString(),topologyPath.toString(),inputPath.toString()};
  Tool analyzer=new TraceBuilder();
  int result=ToolRunner.run(analyzer,args);
  assertEquals("Non-zero exit",0,result);
  TestRumenJobTraces.<LoggedJob>jsonFileMatchesGold(conf,tracePath,goldPath,LoggedJob.class,"trace");
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test {@link ResourceUsageMetrics}.
 */
@Test public void testResourceUsageMetrics() throws Exception {
  final long cpuUsage=100;
  final long pMemUsage=200;
  final long vMemUsage=300;
  final long heapUsage=400;
  ResourceUsageMetrics metrics=new ResourceUsageMetrics();
  metrics.setCumulativeCpuUsage(cpuUsage);
  metrics.setPhysicalMemoryUsage(pMemUsage);
  metrics.setVirtualMemoryUsage(vMemUsage);
  metrics.setHeapUsage(heapUsage);
  assertEquals("Cpu usage values mismatch via set",cpuUsage,metrics.getCumulativeCpuUsage());
  assertEquals("Physical memory usage values mismatch via set",pMemUsage,metrics.getPhysicalMemoryUsage());
  assertEquals("Virtual memory usage values mismatch via set",vMemUsage,metrics.getVirtualMemoryUsage());
  assertEquals("Heap usage values mismatch via set",heapUsage,metrics.getHeapUsage());
  testResourceUsageMetricViaDeepCompare(metrics,cpuUsage,vMemUsage,pMemUsage,heapUsage,true);
  testResourceUsageMetricViaDeepCompare(metrics,0,vMemUsage,pMemUsage,heapUsage,false);
  testResourceUsageMetricViaDeepCompare(metrics,cpuUsage,vMemUsage,0,heapUsage,false);
  testResourceUsageMetricViaDeepCompare(metrics,cpuUsage,0,pMemUsage,heapUsage,false);
  testResourceUsageMetricViaDeepCompare(metrics,cpuUsage,vMemUsage,pMemUsage,0,false);
  ResourceUsageMetrics metrics2=new ResourceUsageMetrics(){
    @Override public int size(){
      return -1;
    }
  }
;
  metrics2.setCumulativeCpuUsage(cpuUsage);
  metrics2.setPhysicalMemoryUsage(pMemUsage);
  metrics2.setVirtualMemoryUsage(vMemUsage);
  metrics2.setHeapUsage(heapUsage);
  testResourceUsageMetricViaDeepCompare(metrics2,cpuUsage,vMemUsage,pMemUsage,heapUsage,false);
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests if {@link TraceBuilder} can correctly identify and parse jobhistory
 * filenames. The testcase checks if {@link TraceBuilder}- correctly identifies a jobhistory filename without suffix
 * - correctly parses a jobhistory filename without suffix to extract out 
 * the jobid
 * - correctly identifies a jobhistory filename with suffix
 * - correctly parses a jobhistory filename with suffix to extract out the 
 * jobid
 * - correctly identifies a job-configuration filename stored along with the 
 * jobhistory files
 */
@Test public void testJobHistoryFilenameParsing() throws IOException {
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  String user="test";
  org.apache.hadoop.mapred.JobID jid=new org.apache.hadoop.mapred.JobID("12345",1);
  final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  Path jhFilename=JobHistory.getJobHistoryFile(rootInputDir,jid,user);
  JobID extractedJID=JobID.forName(TraceBuilder.extractJobID(jhFilename.getName()));
  assertEquals("TraceBuilder failed to parse the current JH filename",jid,extractedJID);
  jhFilename=jhFilename.suffix(JobHistory.getOldFileSuffix("123"));
  extractedJID=JobID.forName(TraceBuilder.extractJobID(jhFilename.getName()));
  assertEquals("TraceBuilder failed to parse the current JH filename" + "(old-suffix)",jid,extractedJID);
  Path jhConfFilename=JobHistory.getConfFile(rootInputDir,jid);
  assertTrue("TraceBuilder failed to parse the current JH conf filename",TraceBuilder.isJobConfXml(jhConfFilename.getName(),null));
  jhConfFilename=jhConfFilename.suffix(JobHistory.getOldFileSuffix("123"));
  assertTrue("TraceBuilder failed to parse the current JH conf filename" + " (old suffix)",TraceBuilder.isJobConfXml(jhConfFilename.getName(),null));
}

</code></pre>

<br>
<pre class="type-10 type-4 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test if {@link CurrentJHParser} can read events from current JH files.
 */
@Test public void testCurrentJHParser() throws Exception {
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  final Path tempDir=new Path(rootTempDir,"TestCurrentJHParser");
  lfs.delete(tempDir,true);
  conf.setInt(TTConfig.TT_MAP_SLOTS,1);
  conf.setInt(TTConfig.TT_REDUCE_SLOTS,1);
  MiniMRCluster mrCluster=new MiniMRCluster(1,"file:///",1,null,null,new JobConf(conf));
  Path inDir=new Path(tempDir,"input");
  Path outDir=new Path(tempDir,"output");
  JobHistoryParser parser=null;
  RewindableInputStream ris=null;
  ArrayList<String> seenEvents=new ArrayList<String>(15);
  try {
    JobConf jConf=mrCluster.createJobConf();
    Job job=MapReduceTestUtil.createJob(jConf,inDir,outDir,1,1);
    job.setJobSetupCleanupNeeded(false);
    job.setOutputFormatClass(MyOutputFormat.class);
    job.waitForCompletion(false);
    assertTrue("Job failed",job.isSuccessful());
    JobID id=job.getJobID();
    JobClient jc=new JobClient(jConf);
    String user=jc.getAllJobs()[0].getUsername();
    Path jhPath=new Path(mrCluster.getJobTrackerRunner().getJobTracker().getJobHistoryDir());
    Path inputPath=JobHistory.getJobHistoryFile(jhPath,id,user);
    for (int i=0; i < 100; ++i) {
      if (lfs.exists(inputPath)) {
        break;
      }
      TimeUnit.MILLISECONDS.wait(100);
    }
    assertTrue("Missing job history file",lfs.exists(inputPath));
    ris=getRewindableInputStream(inputPath,conf);
    parser=JobHistoryParserFactory.getParser(ris);
    JobBuilder builder=new JobBuilder(id.toString());
    getHistoryEvents(parser,seenEvents,builder);
    System.out.println("testCurrentJHParser validating using gold std ");
    String[] goldLinesExpected=new String[]{JSE,JPCE,JIE,JSCE,TSE,ASE,MFE,TFE,TSE,ASE,RFE,TFE,JFE};
    validateSeenHistoryEvents(seenEvents,goldLinesExpected);
    Counters counters=job.getTaskReports(TaskType.MAP)[0].getTaskCounters();
    LoggedJob loggedJob=builder.build();
    LoggedTaskAttempt attempt=loggedJob.getMapTasks().get(0).getAttempts().get(0);
    ResourceUsageMetrics metrics=attempt.getResourceUsageMetrics();
    testResourceUsageMetricViaDeepCompare(metrics,counters.findCounter(TaskCounter.CPU_MILLISECONDS).getValue(),counters.findCounter(TaskCounter.VIRTUAL_MEMORY_BYTES).getValue(),counters.findCounter(TaskCounter.PHYSICAL_MEMORY_BYTES).getValue(),counters.findCounter(TaskCounter.COMMITTED_HEAP_BYTES).getValue(),true);
  }
  finally {
    mrCluster.shutdown();
    if (ris != null) {
      ris.close();
    }
    if (parser != null) {
      parser.close();
    }
    lfs.delete(tempDir,true);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test if the {@link JobConfigurationParser} can correctly extract out 
 * key-value pairs from the job configuration.
 */
@Test public void testJobConfigurationParsing() throws Exception {
  final FileSystem lfs=FileSystem.getLocal(new Configuration());
  final Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  final Path tempDir=new Path(rootTempDir,"TestJobConfigurationParser");
  lfs.delete(tempDir,true);
  JobConf jConf=new JobConf(false);
  String key="test.data";
  String value="hello world";
  jConf.set(key,value);
  Path jobConfPath=new Path(tempDir.toString(),"job.xml");
  lfs.delete(jobConfPath,false);
  DataOutputStream jobConfStream=lfs.create(jobConfPath);
  jConf.writeXml(jobConfStream);
  jobConfStream.close();
  Properties properties=JobConfigurationParser.parse(lfs.open(jobConfPath));
  assertEquals("Total number of extracted properties (" + properties.size() + ") doesn't match the expected size of 1 ["+ "JobConfigurationParser]",1,properties.size());
  assertTrue("Key " + key + " is missing in the configuration extracted "+ "[JobConfigurationParser]",properties.keySet().contains(key));
  assertEquals("JobConfigurationParser couldn't recover the parameters" + " correctly",value,properties.get(key));
  LoggedJob job=new LoggedJob();
  job.setJobProperties(properties);
  ZombieJob zjob=new ZombieJob(job,null);
  Configuration zconf=zjob.getJobConf();
  assertEquals("ZombieJob couldn't recover the parameters correctly",value,zconf.get(key));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.rumen.TestZombieJob </h4><pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRecordIOInfo(){
  JobStory job=jobStories.get(3);
  TaskInfo mapTask=job.getTaskInfo(TaskType.MAP,113);
  TaskInfo reduceTask=job.getTaskInfo(TaskType.REDUCE,0);
  assertEquals(mapTaskCounts[0],mapTask.getInputBytes());
  assertEquals(mapTaskCounts[1],mapTask.getInputRecords());
  assertEquals(mapTaskCounts[2],mapTask.getOutputBytes());
  assertEquals(mapTaskCounts[3],mapTask.getOutputRecords());
  assertEquals(mapTaskCounts[4],mapTask.getTaskMemory());
  assertEquals(reduceTaskCounts[0],reduceTask.getInputBytes());
  assertEquals(reduceTaskCounts[1],reduceTask.getInputRecords());
  assertEquals(reduceTaskCounts[2],reduceTask.getOutputBytes());
  assertEquals(reduceTaskCounts[3],reduceTask.getOutputRecords());
  assertEquals(reduceTaskCounts[4],reduceTask.getTaskMemory());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFirstJob(){
  JobStory job=jobStories.get(0);
  assertEquals(1,job.getNumberMaps());
  assertEquals(1,job.getNumberReduces());
  TaskAttemptInfo taInfo=null;
  long expectedRuntime=2423;
  taInfo=job.getMapTaskAttemptInfoAdjusted(14,0,1);
  assertEquals(expectedRuntime,taInfo.getRuntime());
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  taInfo=job.getMapTaskAttemptInfoAdjusted(14,0,2);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  taInfo=job.getMapTaskAttemptInfoAdjusted(14,0,0);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  expectedRuntime=97502;
  taInfo=job.getTaskAttemptInfo(TaskType.REDUCE,14,0);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  taInfo=job.getTaskAttemptInfo(TaskType.REDUCE,14,0);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFourthJob(){
  JobStory job=jobStories.get(3);
  assertEquals(131,job.getNumberMaps());
  assertEquals(47,job.getNumberReduces());
  TaskAttemptInfo taInfo=null;
  long runtime=5268;
  taInfo=job.getMapTaskAttemptInfoAdjusted(113,1,1);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  assertEquals(runtime,taInfo.getRuntime());
  taInfo=job.getMapTaskAttemptInfoAdjusted(113,1,2);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  assertEquals(runtime,taInfo.getRuntime() / 2);
  taInfo=job.getMapTaskAttemptInfoAdjusted(113,1,0);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  assertEquals((long)(runtime / 1.5),taInfo.getRuntime());
  taInfo=job.getMapTaskAttemptInfoAdjusted(113,0,1);
  assertEquals(18592,taInfo.getRuntime());
  assertEquals(State.FAILED,taInfo.getRunState());
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSecondJob(){
  JobStory job=jobStories.get(1);
  assertEquals(20,job.getNumberMaps());
  assertEquals(1,job.getNumberReduces());
  TaskAttemptInfo taInfo=null;
  taInfo=job.getMapTaskAttemptInfoAdjusted(17,1,1);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  taInfo=job.getMapTaskAttemptInfoAdjusted(17,1,2);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  taInfo=job.getMapTaskAttemptInfoAdjusted(17,1,0);
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
  taInfo=job.getMapTaskAttemptInfoAdjusted(14,0,1);
  assertEquals(1927,taInfo.getRuntime());
  assertEquals(State.SUCCEEDED,taInfo.getRunState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.typedbytes.TestIO </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIO() throws IOException {
  ArrayList vector=new ArrayList();
  vector.add("test");
  vector.add(false);
  vector.add(12345);
  List list=new LinkedList();
  list.add("another test");
  list.add(true);
  list.add(123456789L);
  Map<Object,Object> map=new HashMap<Object,Object>();
  map.put("one",1);
  map.put("vector",vector);
  Buffer buffer=new Buffer(new byte[]{1,2,3,4});
  buffer.setCapacity(10);
  Object[] objects=new Object[]{buffer,(byte)123,true,12345,123456789L,(float)1.2,1.234,"random string",vector,list,map};
  FileOutputStream ostream=new FileOutputStream(tmpfile);
  DataOutputStream dostream=new DataOutputStream(ostream);
  TypedBytesOutput out=new TypedBytesOutput(dostream);
  for (  Object obj : objects) {
    out.write(obj);
  }
  dostream.close();
  ostream.close();
  FileInputStream istream=new FileInputStream(tmpfile);
  DataInputStream distream=new DataInputStream(istream);
  TypedBytesInput in=new TypedBytesInput(distream);
  for (  Object obj : objects) {
    assertEquals(obj,in.read());
  }
  distream.close();
  istream.close();
  istream=new FileInputStream(tmpfile);
  distream=new DataInputStream(istream);
  in=new TypedBytesInput(distream);
  for (  Object obj : objects) {
    byte[] bytes=in.readRaw();
    ByteArrayInputStream bais=new ByteArrayInputStream(bytes);
    DataInputStream dis=new DataInputStream(bais);
    assertEquals(obj,(new TypedBytesInput(dis)).read());
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    TypedBytesOutput tbout=new TypedBytesOutput(new DataOutputStream(baos));
    tbout.writeRaw(bytes);
    bais=new ByteArrayInputStream(bytes);
    dis=new DataInputStream(bais);
    assertEquals(obj,(new TypedBytesInput(dis)).read());
  }
  distream.close();
  istream.close();
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRecordIO() throws IOException {
  RecRecord1 r1=new RecRecord1();
  r1.setBoolVal(true);
  r1.setByteVal((byte)0x66);
  r1.setFloatVal(3.145F);
  r1.setDoubleVal(1.5234);
  r1.setIntVal(-4567);
  r1.setLongVal(-2367L);
  r1.setStringVal("random text");
  r1.setBufferVal(new Buffer());
  r1.setVectorVal(new ArrayList<String>());
  r1.setMapVal(new TreeMap<String,String>());
  RecRecord0 r0=new RecRecord0();
  r0.setStringVal("other random text");
  r1.setRecordVal(r0);
  FileOutputStream ostream=new FileOutputStream(tmpfile);
  DataOutputStream dostream=new DataOutputStream(ostream);
  TypedBytesRecordOutput out=TypedBytesRecordOutput.get(dostream);
  r1.serialize(out,"");
  dostream.close();
  ostream.close();
  FileInputStream istream=new FileInputStream(tmpfile);
  DataInputStream distream=new DataInputStream(istream);
  TypedBytesRecordInput in=TypedBytesRecordInput.get(distream);
  RecRecord1 r2=new RecRecord1();
  r2.deserialize(in,"");
  distream.close();
  istream.close();
  assertEquals(r1,r2);
}

</code></pre>

<br>
<pre class="type-10 type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWritableIO() throws IOException {
  Writable[] vectorValues=new Writable[]{new Text("test1"),new Text("test2"),new Text("test3")};
  ArrayWritable vector=new ArrayWritable(Text.class,vectorValues);
  MapWritable map=new MapWritable();
  map.put(new Text("one"),new VIntWritable(1));
  map.put(new Text("two"),new VLongWritable(2));
  Writable[] writables=new Writable[]{new BytesWritable(new byte[]{1,2,3,4}),new ByteWritable((byte)123),new BooleanWritable(true),new VIntWritable(12345),new VLongWritable(123456789L),new FloatWritable((float)1.2),new DoubleWritable(1.234),new Text("random string")};
  TypedBytesWritable tbw=new TypedBytesWritable();
  tbw.setValue("typed bytes text");
  RecRecord1 r1=new RecRecord1();
  r1.setBoolVal(true);
  r1.setByteVal((byte)0x66);
  r1.setFloatVal(3.145F);
  r1.setDoubleVal(1.5234);
  r1.setIntVal(-4567);
  r1.setLongVal(-2367L);
  r1.setStringVal("random text");
  r1.setBufferVal(new Buffer());
  r1.setVectorVal(new ArrayList<String>());
  r1.setMapVal(new TreeMap<String,String>());
  RecRecord0 r0=new RecRecord0();
  r0.setStringVal("other random text");
  r1.setRecordVal(r0);
  FileOutputStream ostream=new FileOutputStream(tmpfile);
  DataOutputStream dostream=new DataOutputStream(ostream);
  TypedBytesWritableOutput out=new TypedBytesWritableOutput(dostream);
  for (  Writable w : writables) {
    out.write(w);
  }
  out.write(tbw);
  out.write(vector);
  out.write(map);
  out.write(r1);
  dostream.close();
  ostream.close();
  FileInputStream istream=new FileInputStream(tmpfile);
  DataInputStream distream=new DataInputStream(istream);
  TypedBytesWritableInput in=new TypedBytesWritableInput(distream);
  for (  Writable w : writables) {
    assertEquals(w,in.read());
  }
  assertEquals(tbw.getValue().toString(),in.read().toString());
  assertEquals(ArrayWritable.class,in.readType());
  ArrayWritable aw=in.readArray();
  Writable[] writables1=vector.get(), writables2=aw.get();
  assertEquals(writables1.length,writables2.length);
  for (int i=0; i < writables1.length; i++) {
    assertEquals(((Text)writables1[i]).toString(),((TypedBytesWritable)writables2[i]).getValue());
  }
  assertEquals(MapWritable.class,in.readType());
  MapWritable mw=in.readMap();
  assertEquals(map.entrySet(),mw.entrySet());
  assertEquals(Type.LIST,TypedBytesInput.get(distream).readType());
  assertEquals(r1.getBoolVal(),TypedBytesInput.get(distream).read());
  assertEquals(r1.getByteVal(),TypedBytesInput.get(distream).read());
  assertEquals(r1.getIntVal(),TypedBytesInput.get(distream).read());
  assertEquals(r1.getLongVal(),TypedBytesInput.get(distream).read());
  assertEquals(r1.getFloatVal(),TypedBytesInput.get(distream).read());
  assertEquals(r1.getDoubleVal(),TypedBytesInput.get(distream).read());
  assertEquals(r1.getStringVal(),TypedBytesInput.get(distream).read());
  Object prevObj=null, obj=TypedBytesInput.get(distream).read();
  while (obj != null) {
    prevObj=obj;
    obj=TypedBytesInput.get(distream).read();
  }
  List recList=(List)prevObj;
  assertEquals(r0.getStringVal(),recList.get(0));
  distream.close();
  istream.close();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
