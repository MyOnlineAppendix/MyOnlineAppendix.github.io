<h3><span class=" glyphicon glyphicon-tag"/>&nbspIdentityVerifier</h3><kbd>Verifies whether two objects/variables are the same</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.crypto.key.kms.server.TestKMS </h4><pre class="type-9 type-7 type-10 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKMSProvider() throws Exception {
  Configuration conf=new Configuration();
  conf.set("hadoop.security.authentication","kerberos");
  UserGroupInformation.setConfiguration(conf);
  File confDir=getTestDir();
  conf=createBaseKMSConf(confDir);
  writeConf(confDir,conf);
  runServer(null,null,confDir,new KMSCallable(){
    @Override public Void call() throws Exception {
      Date started=new Date();
      Configuration conf=new Configuration();
      URI uri=createKMSUri(getKMSUrl());
      KeyProvider kp=new KMSClientProvider(uri,conf);
      Assert.assertTrue(kp.getKeys().isEmpty());
      Assert.assertEquals(0,kp.getKeysMetadata().length);
      KeyProvider.Options options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      options.setDescription("l1");
      KeyProvider.KeyVersion kv0=kp.createKey("k1",options);
      Assert.assertNotNull(kv0);
      Assert.assertNotNull(kv0.getVersionName());
      Assert.assertNotNull(kv0.getMaterial());
      KeyProvider.KeyVersion kv1=kp.getKeyVersion(kv0.getVersionName());
      Assert.assertEquals(kv0.getVersionName(),kv1.getVersionName());
      Assert.assertNotNull(kv1.getMaterial());
      KeyProvider.KeyVersion cv1=kp.getCurrentKey("k1");
      Assert.assertEquals(kv0.getVersionName(),cv1.getVersionName());
      Assert.assertNotNull(cv1.getMaterial());
      KeyProvider.Metadata m1=kp.getMetadata("k1");
      Assert.assertEquals("AES/CTR/NoPadding",m1.getCipher());
      Assert.assertEquals("AES",m1.getAlgorithm());
      Assert.assertEquals(128,m1.getBitLength());
      Assert.assertEquals(1,m1.getVersions());
      Assert.assertNotNull(m1.getCreated());
      Assert.assertTrue(started.before(m1.getCreated()));
      List<KeyProvider.KeyVersion> lkv1=kp.getKeyVersions("k1");
      Assert.assertEquals(1,lkv1.size());
      Assert.assertEquals(kv0.getVersionName(),lkv1.get(0).getVersionName());
      Assert.assertNotNull(kv1.getMaterial());
      KeyProvider.KeyVersion kv2=kp.rollNewVersion("k1");
      Assert.assertNotSame(kv0.getVersionName(),kv2.getVersionName());
      Assert.assertNotNull(kv2.getMaterial());
      kv2=kp.getKeyVersion(kv2.getVersionName());
      boolean eq=true;
      for (int i=0; i < kv1.getMaterial().length; i++) {
        eq=eq && kv1.getMaterial()[i] == kv2.getMaterial()[i];
      }
      Assert.assertFalse(eq);
      KeyProvider.KeyVersion cv2=kp.getCurrentKey("k1");
      Assert.assertEquals(kv2.getVersionName(),cv2.getVersionName());
      Assert.assertNotNull(cv2.getMaterial());
      eq=true;
      for (int i=0; i < kv1.getMaterial().length; i++) {
        eq=eq && cv2.getMaterial()[i] == kv2.getMaterial()[i];
      }
      Assert.assertTrue(eq);
      List<KeyProvider.KeyVersion> lkv2=kp.getKeyVersions("k1");
      Assert.assertEquals(2,lkv2.size());
      Assert.assertEquals(kv1.getVersionName(),lkv2.get(0).getVersionName());
      Assert.assertNotNull(lkv2.get(0).getMaterial());
      Assert.assertEquals(kv2.getVersionName(),lkv2.get(1).getVersionName());
      Assert.assertNotNull(lkv2.get(1).getMaterial());
      KeyProvider.Metadata m2=kp.getMetadata("k1");
      Assert.assertEquals("AES/CTR/NoPadding",m2.getCipher());
      Assert.assertEquals("AES",m2.getAlgorithm());
      Assert.assertEquals(128,m2.getBitLength());
      Assert.assertEquals(2,m2.getVersions());
      Assert.assertNotNull(m2.getCreated());
      Assert.assertTrue(started.before(m2.getCreated()));
      List<String> ks1=kp.getKeys();
      Assert.assertEquals(1,ks1.size());
      Assert.assertEquals("k1",ks1.get(0));
      KeyProvider.Metadata[] kms1=kp.getKeysMetadata("k1");
      Assert.assertEquals(1,kms1.length);
      Assert.assertEquals("AES/CTR/NoPadding",kms1[0].getCipher());
      Assert.assertEquals("AES",kms1[0].getAlgorithm());
      Assert.assertEquals(128,kms1[0].getBitLength());
      Assert.assertEquals(2,kms1[0].getVersions());
      Assert.assertNotNull(kms1[0].getCreated());
      Assert.assertTrue(started.before(kms1[0].getCreated()));
      KeyProvider.KeyVersion kv=kp.getCurrentKey("k1");
      KeyProviderCryptoExtension kpExt=KeyProviderCryptoExtension.createKeyProviderCryptoExtension(kp);
      EncryptedKeyVersion ek1=kpExt.generateEncryptedKey(kv.getName());
      Assert.assertEquals(KeyProviderCryptoExtension.EEK,ek1.getEncryptedKeyVersion().getVersionName());
      Assert.assertNotNull(ek1.getEncryptedKeyVersion().getMaterial());
      Assert.assertEquals(kv.getMaterial().length,ek1.getEncryptedKeyVersion().getMaterial().length);
      KeyProvider.KeyVersion k1=kpExt.decryptEncryptedKey(ek1);
      Assert.assertEquals(KeyProviderCryptoExtension.EK,k1.getVersionName());
      KeyProvider.KeyVersion k1a=kpExt.decryptEncryptedKey(ek1);
      Assert.assertArrayEquals(k1.getMaterial(),k1a.getMaterial());
      Assert.assertEquals(kv.getMaterial().length,k1.getMaterial().length);
      EncryptedKeyVersion ek2=kpExt.generateEncryptedKey(kv.getName());
      KeyProvider.KeyVersion k2=kpExt.decryptEncryptedKey(ek2);
      boolean isEq=true;
      for (int i=0; isEq && i < ek2.getEncryptedKeyVersion().getMaterial().length; i++) {
        isEq=k2.getMaterial()[i] == k1.getMaterial()[i];
      }
      Assert.assertFalse(isEq);
      kp.deleteKey("k1");
      Assert.assertNull(kp.getKeyVersion("k1"));
      Assert.assertNull(kp.getKeyVersions("k1"));
      Assert.assertNull(kp.getMetadata("k1"));
      Assert.assertTrue(kp.getKeys().isEmpty());
      Assert.assertEquals(0,kp.getKeysMetadata().length);
      options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      kp.createKey("k2",options);
      KeyProvider.Metadata meta=kp.getMetadata("k2");
      Assert.assertNull(meta.getDescription());
      Assert.assertTrue(meta.getAttributes().isEmpty());
      options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      options.setDescription("d");
      kp.createKey("k3",options);
      meta=kp.getMetadata("k3");
      Assert.assertEquals("d",meta.getDescription());
      Assert.assertTrue(meta.getAttributes().isEmpty());
      Map<String,String> attributes=new HashMap<String,String>();
      attributes.put("a","A");
      options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      options.setAttributes(attributes);
      kp.createKey("k4",options);
      meta=kp.getMetadata("k4");
      Assert.assertNull(meta.getDescription());
      Assert.assertEquals(attributes,meta.getAttributes());
      options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      options.setDescription("d");
      options.setAttributes(attributes);
      kp.createKey("k5",options);
      meta=kp.getMetadata("k5");
      Assert.assertEquals("d",meta.getDescription());
      Assert.assertEquals(attributes,meta.getAttributes());
      KeyProviderDelegationTokenExtension kpdte=KeyProviderDelegationTokenExtension.createKeyProviderDelegationTokenExtension(kp);
      Credentials credentials=new Credentials();
      kpdte.addDelegationTokens("foo",credentials);
      Assert.assertEquals(1,credentials.getAllTokens().size());
      InetSocketAddress kmsAddr=new InetSocketAddress(getKMSUrl().getHost(),getKMSUrl().getPort());
      Assert.assertEquals(new Text("kms-dt"),credentials.getToken(SecurityUtil.buildTokenService(kmsAddr)).getKind());
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestFileSystemCaching </h4><pre class="type-9 type-2 type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultFsUris() throws Exception {
  final Configuration conf=new Configuration();
  conf.set("fs.defaultfs.impl",DefaultFs.class.getName());
  final URI defaultUri=URI.create("defaultfs://host");
  FileSystem.setDefaultUri(conf,defaultUri);
  FileSystem fs=null;
  final FileSystem defaultFs=FileSystem.get(conf);
  assertEquals(defaultUri,defaultFs.getUri());
  fs=FileSystem.get(URI.create("defaultfs:/"),conf);
  assertSame(defaultFs,fs);
  fs=FileSystem.get(URI.create("defaultfs:///"),conf);
  assertSame(defaultFs,fs);
  fs=FileSystem.get(URI.create("defaultfs://host"),conf);
  assertSame(defaultFs,fs);
  fs=FileSystem.get(URI.create("defaultfs://host2"),conf);
  assertNotSame(defaultFs,fs);
  fs=FileSystem.get(URI.create("/"),conf);
  assertSame(defaultFs,fs);
  try {
    fs=FileSystem.get(URI.create("//host"),conf);
    fail("got fs with auth but no scheme");
  }
 catch (  Exception e) {
    assertEquals("No FileSystem for scheme: null",e.getMessage());
  }
  try {
    fs=FileSystem.get(URI.create("//host2"),conf);
    fail("got fs with auth but no scheme");
  }
 catch (  Exception e) {
    assertEquals("No FileSystem for scheme: null",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testUserFS() throws Exception {
  final Configuration conf=new Configuration();
  conf.set("fs.cachedfile.impl",FileSystem.getFileSystemClass("file",null).getName());
  FileSystem fsU1=FileSystem.get(new URI("cachedfile://a"),conf,"bar");
  FileSystem fsU2=FileSystem.get(new URI("cachedfile://a"),conf,"foo");
  assertNotSame(fsU1,fsU2);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@SuppressWarnings("unchecked") @Test public <T extends TokenIdentifier>void testCacheForUgi() throws Exception {
  final Configuration conf=new Configuration();
  conf.set("fs.cachedfile.impl",FileSystem.getFileSystemClass("file",null).getName());
  UserGroupInformation ugiA=UserGroupInformation.createRemoteUser("foo");
  UserGroupInformation ugiB=UserGroupInformation.createRemoteUser("bar");
  FileSystem fsA=ugiA.doAs(new PrivilegedExceptionAction<FileSystem>(){
    @Override public FileSystem run() throws Exception {
      return FileSystem.get(new URI("cachedfile://a"),conf);
    }
  }
);
  FileSystem fsA1=ugiA.doAs(new PrivilegedExceptionAction<FileSystem>(){
    @Override public FileSystem run() throws Exception {
      return FileSystem.get(new URI("cachedfile://a"),conf);
    }
  }
);
  assertSame(fsA,fsA1);
  FileSystem fsB=ugiB.doAs(new PrivilegedExceptionAction<FileSystem>(){
    @Override public FileSystem run() throws Exception {
      return FileSystem.get(new URI("cachedfile://a"),conf);
    }
  }
);
  assertNotSame(fsA,fsB);
  Token<T> t1=mock(Token.class);
  UserGroupInformation ugiA2=UserGroupInformation.createRemoteUser("foo");
  fsA=ugiA2.doAs(new PrivilegedExceptionAction<FileSystem>(){
    @Override public FileSystem run() throws Exception {
      return FileSystem.get(new URI("cachedfile://a"),conf);
    }
  }
);
  assertNotSame(fsA,fsA1);
  ugiA.addToken(t1);
  fsA=ugiA.doAs(new PrivilegedExceptionAction<FileSystem>(){
    @Override public FileSystem run() throws Exception {
      return FileSystem.get(new URI("cachedfile://a"),conf);
    }
  }
);
  assertSame(fsA,fsA1);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testCloseAllForUGI() throws Exception {
  final Configuration conf=new Configuration();
  conf.set("fs.cachedfile.impl",FileSystem.getFileSystemClass("file",null).getName());
  UserGroupInformation ugiA=UserGroupInformation.createRemoteUser("foo");
  FileSystem fsA=ugiA.doAs(new PrivilegedExceptionAction<FileSystem>(){
    @Override public FileSystem run() throws Exception {
      return FileSystem.get(new URI("cachedfile://a"),conf);
    }
  }
);
  FileSystem fsA1=ugiA.doAs(new PrivilegedExceptionAction<FileSystem>(){
    @Override public FileSystem run() throws Exception {
      return FileSystem.get(new URI("cachedfile://a"),conf);
    }
  }
);
  assertSame(fsA,fsA1);
  FileSystem.closeAllForUGI(ugiA);
  fsA1=ugiA.doAs(new PrivilegedExceptionAction<FileSystem>(){
    @Override public FileSystem run() throws Exception {
      return FileSystem.get(new URI("cachedfile://a"),conf);
    }
  }
);
  assertNotSame(fsA,fsA1);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testCacheDisabled() throws Exception {
  Configuration conf=new Configuration();
  conf.set("fs.uncachedfile.impl",FileSystem.getFileSystemClass("file",null).getName());
  conf.setBoolean("fs.uncachedfile.impl.disable.cache",true);
  FileSystem fs1=FileSystem.get(new URI("uncachedfile://a"),conf);
  FileSystem fs2=FileSystem.get(new URI("uncachedfile://a"),conf);
  assertNotSame(fs1,fs2);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testCacheEnabled() throws Exception {
  Configuration conf=new Configuration();
  conf.set("fs.cachedfile.impl",FileSystem.getFileSystemClass("file",null).getName());
  FileSystem fs1=FileSystem.get(new URI("cachedfile://a"),conf);
  FileSystem fs2=FileSystem.get(new URI("cachedfile://a"),conf);
  assertSame(fs1,fs2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestFileSystemTokens </h4><pre class="type-7 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithChildTokensOneExists() throws Exception {
  Credentials credentials=new Credentials();
  Text service1=new Text("singleTokenFs1");
  Text service2=new Text("singleTokenFs2");
  Token<?> token=mock(Token.class);
  credentials.addToken(service2,token);
  MockFileSystem fs1=createFileSystemForServiceName(service1);
  MockFileSystem fs2=createFileSystemForServiceName(service2);
  MockFileSystem fs3=createFileSystemForServiceName(null);
  MockFileSystem multiFs=createFileSystemForServiceName(null,fs1,fs2,fs3);
  multiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(multiFs,false);
  verifyTokenFetch(fs1,true);
  verifyTokenFetch(fs2,false);
  verifyTokenFetch(fs3,false);
  assertEquals(2,credentials.numberOfTokens());
  assertNotNull(credentials.getToken(service1));
  assertSame(token,credentials.getToken(service2));
}

</code></pre>

<br>
<pre class="type-7 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithMyOwnExistsAndChildTokens() throws Exception {
  Credentials credentials=new Credentials();
  Text service1=new Text("singleTokenFs1");
  Text service2=new Text("singleTokenFs2");
  Text myService=new Text("multiTokenFs");
  Token<?> token=mock(Token.class);
  credentials.addToken(myService,token);
  MockFileSystem fs1=createFileSystemForServiceName(service1);
  MockFileSystem fs2=createFileSystemForServiceName(service2);
  MockFileSystem multiFs=createFileSystemForServiceName(myService,fs1,fs2);
  multiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(multiFs,false);
  verifyTokenFetch(fs1,true);
  verifyTokenFetch(fs2,true);
  assertEquals(3,credentials.numberOfTokens());
  assertSame(token,credentials.getToken(myService));
  assertNotNull(credentials.getToken(service1));
  assertNotNull(credentials.getToken(service2));
}

</code></pre>

<br>
<pre class="type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithTokenExists() throws Exception {
  Credentials credentials=new Credentials();
  Text service=new Text("singleTokenFs");
  MockFileSystem fs=createFileSystemForServiceName(service);
  Token<?> token=mock(Token.class);
  credentials.addToken(service,token);
  fs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(fs,false);
  assertEquals(1,credentials.numberOfTokens());
  assertSame(token,credentials.getToken(service));
}

</code></pre>

<br>
<pre class="type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithDuplicateChildrenTokenExists() throws Exception {
  Credentials credentials=new Credentials();
  Text service=new Text("singleTokenFs1");
  Token<?> token=mock(Token.class);
  credentials.addToken(service,token);
  MockFileSystem fs=createFileSystemForServiceName(service);
  MockFileSystem multiFs=createFileSystemForServiceName(null,fs,new FilterFileSystem(fs));
  multiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(multiFs,false);
  verifyTokenFetch(fs,false);
  assertEquals(1,credentials.numberOfTokens());
  assertSame(token,credentials.getToken(service));
}

</code></pre>

<br>
<pre class="type-7 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithNestedDuplicatesChildren() throws Exception {
  Credentials credentials=new Credentials();
  Text service1=new Text("singleTokenFs1");
  Text service2=new Text("singleTokenFs2");
  Text service4=new Text("singleTokenFs4");
  Text multiService=new Text("multiTokenFs");
  Token<?> token2=mock(Token.class);
  credentials.addToken(service2,token2);
  MockFileSystem fs1=createFileSystemForServiceName(service1);
  MockFileSystem fs1B=createFileSystemForServiceName(service1);
  MockFileSystem fs2=createFileSystemForServiceName(service2);
  MockFileSystem fs3=createFileSystemForServiceName(null);
  MockFileSystem fs4=createFileSystemForServiceName(service4);
  MockFileSystem multiFs=createFileSystemForServiceName(multiService,fs1,fs1B,fs2,fs2,new FilterFileSystem(fs3),new FilterFileSystem(new FilterFileSystem(fs4)));
  MockFileSystem superMultiFs=createFileSystemForServiceName(null,fs1,fs1B,fs1,new FilterFileSystem(fs3),new FilterFileSystem(multiFs));
  superMultiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(superMultiFs,false);
  verifyTokenFetch(multiFs,true);
  verifyTokenFetch(fs1,true);
  verifyTokenFetch(fs2,false);
  verifyTokenFetch(fs3,false);
  verifyTokenFetch(fs4,true);
  assertEquals(4,credentials.numberOfTokens());
  assertNotNull(credentials.getToken(service1));
  assertNotNull(credentials.getToken(service2));
  assertSame(token2,credentials.getToken(service2));
  assertNotNull(credentials.getToken(multiService));
  assertNotNull(credentials.getToken(service4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestXAttr </h4><pre class="type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXAttrEquals(){
  assertNotSame(XATTR1,XATTR2);
  assertNotSame(XATTR2,XATTR3);
  assertNotSame(XATTR3,XATTR4);
  assertNotSame(XATTR4,XATTR5);
  assertEquals(XATTR,XATTR1);
  assertEquals(XATTR1,XATTR1);
  assertEquals(XATTR2,XATTR2);
  assertEquals(XATTR3,XATTR3);
  assertEquals(XATTR4,XATTR4);
  assertEquals(XATTR5,XATTR5);
  assertFalse(XATTR1.equals(XATTR2));
  assertFalse(XATTR2.equals(XATTR3));
  assertFalse(XATTR3.equals(XATTR4));
  assertFalse(XATTR4.equals(XATTR5));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.permission.TestAcl </h4><pre class="type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEntryEquals(){
  assertNotSame(ENTRY1,ENTRY2);
  assertNotSame(ENTRY1,ENTRY3);
  assertNotSame(ENTRY1,ENTRY4);
  assertNotSame(ENTRY2,ENTRY3);
  assertNotSame(ENTRY2,ENTRY4);
  assertNotSame(ENTRY3,ENTRY4);
  assertEquals(ENTRY1,ENTRY1);
  assertEquals(ENTRY2,ENTRY2);
  assertEquals(ENTRY1,ENTRY2);
  assertEquals(ENTRY2,ENTRY1);
  assertFalse(ENTRY1.equals(ENTRY3));
  assertFalse(ENTRY1.equals(ENTRY4));
  assertFalse(ENTRY3.equals(ENTRY4));
  assertFalse(ENTRY1.equals(null));
  assertFalse(ENTRY1.equals(new Object()));
}

</code></pre>

<br>
<pre class="type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStatusEquals(){
  assertNotSame(STATUS1,STATUS2);
  assertNotSame(STATUS1,STATUS3);
  assertNotSame(STATUS2,STATUS3);
  assertEquals(STATUS1,STATUS1);
  assertEquals(STATUS2,STATUS2);
  assertEquals(STATUS1,STATUS2);
  assertEquals(STATUS2,STATUS1);
  assertFalse(STATUS1.equals(STATUS3));
  assertFalse(STATUS2.equals(STATUS3));
  assertFalse(STATUS1.equals(null));
  assertFalse(STATUS1.equals(new Object()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.ha.TestFailoverController </h4><pre class="type-2 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailureToFenceOnFailbackFailsTheFailback() throws Exception {
  DummyHAService svc1=new DummyHAService(HAServiceState.ACTIVE,svc1Addr);
  DummyHAService svc2=new DummyHAService(HAServiceState.STANDBY,svc2Addr);
  Mockito.doThrow(new IOException("Failed!")).when(svc2.proxy).transitionToActive(anyReqInfo());
  svc1.fencer=svc2.fencer=setupFencer(AlwaysFailFencer.class.getName());
  AlwaysFailFencer.fenceCalled=0;
  try {
    doFailover(svc1,svc2,false,false);
    fail("Failed over to service that won't transition to active");
  }
 catch (  FailoverFailedException ffe) {
  }
  assertEquals(HAServiceState.STANDBY,svc1.state);
  assertEquals(1,AlwaysFailFencer.fenceCalled);
  assertSame(svc2,AlwaysFailFencer.fencedSvc);
}

</code></pre>

<br>
<pre class="type-2 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFencingFailureDuringFailover() throws Exception {
  DummyHAService svc1=new DummyHAService(HAServiceState.ACTIVE,svc1Addr);
  DummyHAService svc2=new DummyHAService(HAServiceState.STANDBY,svc2Addr);
  svc1.fencer=svc2.fencer=setupFencer(AlwaysFailFencer.class.getName());
  AlwaysFailFencer.fenceCalled=0;
  try {
    doFailover(svc1,svc2,true,false);
    fail("Failed over even though fencing requested and failed");
  }
 catch (  FailoverFailedException ffe) {
  }
  assertEquals(1,AlwaysFailFencer.fenceCalled);
  assertSame(svc1,AlwaysFailFencer.fencedSvc);
  assertEquals(HAServiceState.STANDBY,svc1.state);
  assertEquals(HAServiceState.STANDBY,svc2.state);
}

</code></pre>

<br>
<pre class="type-2 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailoverFromFaultyServiceFencingFailure() throws Exception {
  DummyHAService svc1=new DummyHAService(HAServiceState.ACTIVE,svc1Addr);
  Mockito.doThrow(new ServiceFailedException("Failed!")).when(svc1.proxy).transitionToStandby(anyReqInfo());
  DummyHAService svc2=new DummyHAService(HAServiceState.STANDBY,svc2Addr);
  svc1.fencer=svc2.fencer=setupFencer(AlwaysFailFencer.class.getName());
  AlwaysFailFencer.fenceCalled=0;
  try {
    doFailover(svc1,svc2,false,false);
    fail("Failed over even though fencing failed");
  }
 catch (  FailoverFailedException ffe) {
  }
  assertEquals(1,AlwaysFailFencer.fenceCalled);
  assertSame(svc1,AlwaysFailFencer.fencedSvc);
  assertEquals(HAServiceState.ACTIVE,svc1.state);
  assertEquals(HAServiceState.STANDBY,svc2.state);
}

</code></pre>

<br>
<pre class="type-2 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWeFenceOnFailbackIfTransitionToActiveFails() throws Exception {
  DummyHAService svc1=new DummyHAService(HAServiceState.ACTIVE,svc1Addr);
  DummyHAService svc2=new DummyHAService(HAServiceState.STANDBY,svc2Addr);
  Mockito.doThrow(new ServiceFailedException("Failed!")).when(svc2.proxy).transitionToActive(anyReqInfo());
  svc1.fencer=svc2.fencer=setupFencer(AlwaysSucceedFencer.class.getName());
  AlwaysSucceedFencer.fenceCalled=0;
  try {
    doFailover(svc1,svc2,false,false);
    fail("Failed over to service that won't transition to active");
  }
 catch (  FailoverFailedException ffe) {
  }
  assertEquals(HAServiceState.ACTIVE,svc1.state);
  assertEquals(1,AlwaysSucceedFencer.fenceCalled);
  assertSame(svc2,AlwaysSucceedFencer.fencedSvc);
}

</code></pre>

<br>
<pre class="type-2 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailoverFromFaultyServiceSucceeds() throws Exception {
  DummyHAService svc1=new DummyHAService(HAServiceState.ACTIVE,svc1Addr);
  Mockito.doThrow(new ServiceFailedException("Failed!")).when(svc1.proxy).transitionToStandby(anyReqInfo());
  DummyHAService svc2=new DummyHAService(HAServiceState.STANDBY,svc2Addr);
  svc1.fencer=svc2.fencer=setupFencer(AlwaysSucceedFencer.class.getName());
  AlwaysSucceedFencer.fenceCalled=0;
  try {
    doFailover(svc1,svc2,false,false);
  }
 catch (  FailoverFailedException ffe) {
    fail("Faulty active prevented failover");
  }
  assertEquals(1,AlwaysSucceedFencer.fenceCalled);
  assertSame(svc1,AlwaysSucceedFencer.fencedSvc);
  assertEquals(HAServiceState.ACTIVE,svc1.state);
  assertEquals(HAServiceState.ACTIVE,svc2.state);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.ha.TestNodeFencer </h4><pre class="type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWhitespaceAndCommentsInConfig() throws BadFencingConfigurationException {
  NodeFencer fencer=setupFencer("\n" + " # the next one will always fail\n" + " " + AlwaysFailFencer.class.getName() + "(foo) # <- fails\n"+ AlwaysSucceedFencer.class.getName()+ "(bar) \n");
  assertTrue(fencer.fence(MOCK_TARGET));
  assertEquals(1,AlwaysFailFencer.fenceCalled);
  assertSame(MOCK_TARGET,AlwaysFailFencer.fencedSvc);
  assertEquals(1,AlwaysSucceedFencer.fenceCalled);
  assertSame(MOCK_TARGET,AlwaysSucceedFencer.fencedSvc);
  assertEquals("foo",AlwaysFailFencer.callArgs.get(0));
  assertEquals("bar",AlwaysSucceedFencer.callArgs.get(0));
}

</code></pre>

<br>
<pre class="type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArglessFencer() throws BadFencingConfigurationException {
  NodeFencer fencer=setupFencer(AlwaysSucceedFencer.class.getName());
  assertTrue(fencer.fence(MOCK_TARGET));
  assertEquals(1,AlwaysSucceedFencer.fenceCalled);
  assertSame(MOCK_TARGET,AlwaysSucceedFencer.fencedSvc);
  assertEquals(null,AlwaysSucceedFencer.callArgs.get(0));
}

</code></pre>

<br>
<pre class="type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleFencer() throws BadFencingConfigurationException {
  NodeFencer fencer=setupFencer(AlwaysSucceedFencer.class.getName() + "(foo)");
  assertTrue(fencer.fence(MOCK_TARGET));
  assertEquals(1,AlwaysSucceedFencer.fenceCalled);
  assertSame(MOCK_TARGET,AlwaysSucceedFencer.fencedSvc);
  assertEquals("foo",AlwaysSucceedFencer.callArgs.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestLeaseRenewer </h4><pre class="type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
/** 
 * Regression test for HDFS-2810. In this bug, the LeaseRenewer has handles
 * to several DFSClients with the same name, the first of which has no files
 * open. Previously, this was causing the lease to not get renewed.
 */
@Test public void testManyDfsClientsWhereSomeNotOpen() throws Exception {
  final DFSClient mockClient1=createMockClient();
  Mockito.doReturn(false).when(mockClient1).renewLease();
  assertSame(renewer,LeaseRenewer.getInstance(FAKE_AUTHORITY,FAKE_UGI_A,mockClient1));
  DFSOutputStream mockStream1=Mockito.mock(DFSOutputStream.class);
  long fileId=456L;
  renewer.put(fileId,mockStream1,mockClient1);
  final DFSClient mockClient2=createMockClient();
  Mockito.doReturn(true).when(mockClient2).renewLease();
  assertSame(renewer,LeaseRenewer.getInstance(FAKE_AUTHORITY,FAKE_UGI_A,mockClient2));
  DFSOutputStream mockStream2=Mockito.mock(DFSOutputStream.class);
  renewer.put(fileId,mockStream2,mockClient2);
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      try {
        Mockito.verify(mockClient1,Mockito.atLeastOnce()).renewLease();
        Mockito.verify(mockClient2,Mockito.atLeastOnce()).renewLease();
        return true;
      }
 catch (      AssertionError err) {
        LeaseRenewer.LOG.warn("Not yet satisfied",err);
        return false;
      }
catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
,100,10000);
  renewer.closeFile(fileId,mockClient1);
  renewer.closeFile(fileId,mockClient2);
}

</code></pre>

<br>
<pre class="type-9 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testInstanceSharing() throws IOException {
  LeaseRenewer lr=LeaseRenewer.getInstance(FAKE_AUTHORITY,FAKE_UGI_A,MOCK_DFSCLIENT);
  LeaseRenewer lr2=LeaseRenewer.getInstance(FAKE_AUTHORITY,FAKE_UGI_A,MOCK_DFSCLIENT);
  Assert.assertSame(lr,lr2);
  LeaseRenewer lr3=LeaseRenewer.getInstance(FAKE_AUTHORITY,FAKE_UGI_B,MOCK_DFSCLIENT);
  Assert.assertNotSame(lr,lr3);
  LeaseRenewer lr4=LeaseRenewer.getInstance("someOtherAuthority",FAKE_UGI_B,MOCK_DFSCLIENT);
  Assert.assertNotSame(lr,lr4);
  Assert.assertNotSame(lr3,lr4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestPeerCache </h4><pre class="type-13 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEviction() throws Exception {
  final int CAPACITY=3;
  PeerCache cache=new PeerCache(CAPACITY,100000);
  DatanodeID dnIds[]=new DatanodeID[CAPACITY + 1];
  FakePeer peers[]=new FakePeer[CAPACITY + 1];
  for (int i=0; i < dnIds.length; ++i) {
    dnIds[i]=new DatanodeID("192.168.0.1","fakehostname_" + i,"fake_datanode_id_" + i,100,101,102,103);
    peers[i]=new FakePeer(dnIds[i],false);
  }
  for (int i=0; i < CAPACITY; ++i) {
    cache.put(dnIds[i],peers[i]);
  }
  assertEquals(CAPACITY,cache.size());
  cache.put(dnIds[CAPACITY],peers[CAPACITY]);
  assertEquals(CAPACITY,cache.size());
  assertSame(null,cache.get(dnIds[0],false));
  for (int i=1; i < CAPACITY; ++i) {
    Peer peer=cache.get(dnIds[i],false);
    assertSame(peers[i],peer);
    assertTrue(!peer.isClosed());
    peer.close();
  }
  assertEquals(1,cache.size());
  cache.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.security.TestDelegationToken </h4><pre class="type-9 type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelegationTokenWebHdfsApi() throws Exception {
  ((Log4JLogger)NamenodeWebHdfsMethods.LOG).getLogger().setLevel(Level.ALL);
  final String uri=WebHdfsFileSystem.SCHEME + "://" + config.get(DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_KEY);
  final UserGroupInformation ugi=UserGroupInformation.createUserForTesting("JobTracker",new String[]{"user"});
  final WebHdfsFileSystem webhdfs=ugi.doAs(new PrivilegedExceptionAction<WebHdfsFileSystem>(){
    @Override public WebHdfsFileSystem run() throws Exception {
      return (WebHdfsFileSystem)FileSystem.get(new URI(uri),config);
    }
  }
);
{
    Credentials creds=new Credentials();
    final Token<?> tokens[]=webhdfs.addDelegationTokens("JobTracker",creds);
    Assert.assertEquals(1,tokens.length);
    Assert.assertEquals(1,creds.numberOfTokens());
    Assert.assertSame(tokens[0],creds.getAllTokens().iterator().next());
    checkTokenIdentifier(ugi,tokens[0]);
    final Token<?> tokens2[]=webhdfs.addDelegationTokens("JobTracker",creds);
    Assert.assertEquals(0,tokens2.length);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestBPOfferService </h4><pre class="type-9 type-7 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the DataNode determines the active NameNode correctly
 * based on the HA-related information in heartbeat responses.
 * See HDFS-2627.
 */
@Test public void testPickActiveNameNode() throws Exception {
  BPOfferService bpos=setupBPOSForNNs(mockNN1,mockNN2);
  bpos.start();
  try {
    waitForInitialization(bpos);
    assertNull(bpos.getActiveNN());
    mockHaStatuses[0]=new NNHAStatusHeartbeat(HAServiceState.ACTIVE,1);
    bpos.triggerHeartbeatForTests();
    assertSame(mockNN1,bpos.getActiveNN());
    mockHaStatuses[1]=new NNHAStatusHeartbeat(HAServiceState.ACTIVE,2);
    bpos.triggerHeartbeatForTests();
    assertSame(mockNN2,bpos.getActiveNN());
    bpos.triggerHeartbeatForTests();
    assertSame(mockNN2,bpos.getActiveNN());
    mockHaStatuses[1]=new NNHAStatusHeartbeat(HAServiceState.STANDBY,2);
    bpos.triggerHeartbeatForTests();
    assertNull(bpos.getActiveNN());
    mockHaStatuses[0]=new NNHAStatusHeartbeat(HAServiceState.ACTIVE,3);
    bpos.triggerHeartbeatForTests();
    assertSame(mockNN1,bpos.getActiveNN());
  }
  finally {
    bpos.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestDataNodeMultipleRegistrations </h4><pre class="type-9 type-7 type-10 type-19 type-1 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * start multiple NNs and single DN and verifies per BP registrations and
 * handshakes.
 * @throws IOException
 */
@Test public void test2NNRegistration() throws IOException {
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleFederatedTopology(2)).build();
  try {
    cluster.waitActive();
    NameNode nn1=cluster.getNameNode(0);
    NameNode nn2=cluster.getNameNode(1);
    assertNotNull("cannot create nn1",nn1);
    assertNotNull("cannot create nn2",nn2);
    String bpid1=FSImageTestUtil.getFSImage(nn1).getBlockPoolID();
    String bpid2=FSImageTestUtil.getFSImage(nn2).getBlockPoolID();
    String cid1=FSImageTestUtil.getFSImage(nn1).getClusterID();
    String cid2=FSImageTestUtil.getFSImage(nn2).getClusterID();
    int lv1=FSImageTestUtil.getFSImage(nn1).getLayoutVersion();
    int lv2=FSImageTestUtil.getFSImage(nn2).getLayoutVersion();
    int ns1=FSImageTestUtil.getFSImage(nn1).getNamespaceID();
    int ns2=FSImageTestUtil.getFSImage(nn2).getNamespaceID();
    assertNotSame("namespace ids should be different",ns1,ns2);
    LOG.info("nn1: lv=" + lv1 + ";cid="+ cid1+ ";bpid="+ bpid1+ ";uri="+ nn1.getNameNodeAddress());
    LOG.info("nn2: lv=" + lv2 + ";cid="+ cid2+ ";bpid="+ bpid2+ ";uri="+ nn2.getNameNodeAddress());
    DataNode dn=cluster.getDataNodes().get(0);
    final Map<String,Object> volInfos=dn.data.getVolumeInfoMap();
    Assert.assertTrue("No volumes in the fsdataset",volInfos.size() > 0);
    int i=0;
    for (    Map.Entry<String,Object> e : volInfos.entrySet()) {
      LOG.info("vol " + i++ + ") "+ e.getKey()+ ": "+ e.getValue());
    }
    assertEquals("number of volumes is wrong",2,volInfos.size());
    for (    BPOfferService bpos : dn.getAllBpOs()) {
      LOG.info("BP: " + bpos);
    }
    BPOfferService bpos1=dn.getAllBpOs()[0];
    BPOfferService bpos2=dn.getAllBpOs()[1];
    if (getNNSocketAddress(bpos1).equals(nn2.getNameNodeAddress())) {
      BPOfferService tmp=bpos1;
      bpos1=bpos2;
      bpos2=tmp;
    }
    assertEquals("wrong nn address",getNNSocketAddress(bpos1),nn1.getNameNodeAddress());
    assertEquals("wrong nn address",getNNSocketAddress(bpos2),nn2.getNameNodeAddress());
    assertEquals("wrong bpid",bpos1.getBlockPoolId(),bpid1);
    assertEquals("wrong bpid",bpos2.getBlockPoolId(),bpid2);
    assertEquals("wrong cid",dn.getClusterId(),cid1);
    assertEquals("cid should be same",cid2,cid1);
    assertEquals("namespace should be same",bpos1.bpNSInfo.namespaceID,ns1);
    assertEquals("namespace should be same",bpos2.bpNSInfo.namespaceID,ns2);
  }
  finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestStorageReport </h4><pre class="type-7 type-19 type-21 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that storage type and storage state are propagated
 * in Storage Reports.
 */
@Test public void testStorageReportHasStorageTypeAndState() throws IOException {
  assertNotSame(storageType,StorageType.DEFAULT);
  NameNode nn=cluster.getNameNode();
  DataNode dn=cluster.getDataNodes().get(0);
  DatanodeProtocolClientSideTranslatorPB nnSpy=DataNodeTestUtils.spyOnBposToNN(dn,nn);
  DataNodeTestUtils.triggerHeartbeat(dn);
  ArgumentCaptor<StorageReport[]> captor=ArgumentCaptor.forClass(StorageReport[].class);
  Mockito.verify(nnSpy).sendHeartbeat(any(DatanodeRegistration.class),captor.capture(),anyLong(),anyLong(),anyInt(),anyInt(),anyInt());
  StorageReport[] reports=captor.getValue();
  for (  StorageReport report : reports) {
    assertThat(report.getStorage().getStorageType(),is(storageType));
    assertThat(report.getStorage().getState(),is(DatanodeStorage.State.NORMAL));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestCheckpoint </h4><pre class="type-9 type-7 type-10 type-19 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests checkpoint in HDFS.
 */
@Test public void testCheckpoint() throws IOException {
  Path file1=new Path("checkpoint.dat");
  Path file2=new Path("checkpoint2.dat");
  Configuration conf=new HdfsConfiguration();
  conf.set(DFSConfigKeys.DFS_NAMENODE_SECONDARY_HTTP_ADDRESS_KEY,"0.0.0.0:0");
  replication=(short)conf.getInt(DFSConfigKeys.DFS_REPLICATION_KEY,3);
  MiniDFSCluster cluster=null;
  FileSystem fileSys=null;
  SecondaryNameNode secondary=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDatanodes).build();
    cluster.waitActive();
    fileSys=cluster.getFileSystem();
    assertTrue(!fileSys.exists(file1));
    assertTrue(!fileSys.exists(file2));
    DFSTestUtil.createFile(fileSys,file1,fileSize,fileSize,blockSize,replication,seed);
    checkFile(fileSys,file1,replication);
    secondary=startSecondaryNameNode(conf);
    secondary.doCheckpoint();
    MetricsRecordBuilder rb=getMetrics(NN_METRICS);
    assertCounterGt("GetImageNumOps",0,rb);
    assertCounterGt("GetEditNumOps",0,rb);
    assertCounterGt("PutImageNumOps",0,rb);
    assertGaugeGt("GetImageAvgTime",0.0,rb);
    assertGaugeGt("GetEditAvgTime",0.0,rb);
    assertGaugeGt("PutImageAvgTime",0.0,rb);
  }
  finally {
    fileSys.close();
    cleanup(secondary);
    secondary=null;
    cleanup(cluster);
    cluster=null;
  }
  Path tmpDir=new Path("/tmp_tmp");
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDatanodes).format(false).build();
    cluster.waitActive();
    fileSys=cluster.getFileSystem();
    checkFile(fileSys,file1,replication);
    cleanupFile(fileSys,file1);
    DFSTestUtil.createFile(fileSys,file2,fileSize,fileSize,blockSize,replication,seed);
    checkFile(fileSys,file2,replication);
    secondary=startSecondaryNameNode(conf);
    secondary.doCheckpoint();
    FSDirectory secondaryFsDir=secondary.getFSNamesystem().dir;
    INode rootInMap=secondaryFsDir.getInode(secondaryFsDir.rootDir.getId());
    assertSame(rootInMap,secondaryFsDir.rootDir);
    fileSys.delete(tmpDir,true);
    fileSys.mkdirs(tmpDir);
    secondary.doCheckpoint();
  }
  finally {
    fileSys.close();
    cleanup(secondary);
    secondary=null;
    cleanup(cluster);
    cluster=null;
  }
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDatanodes).format(false).build();
  cluster.waitActive();
  fileSys=cluster.getFileSystem();
  assertTrue(!fileSys.exists(file1));
  assertTrue(fileSys.exists(tmpDir));
  try {
    checkFile(fileSys,file2,replication);
  }
  finally {
    fileSys.close();
    cluster.shutdown();
    cluster=null;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestFSImageStorageInspector </h4><pre class="type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test with image, edits, and inprogress edits
 */
@Test public void testCurrentStorageInspector() throws IOException {
  FSImageTransactionalStorageInspector inspector=new FSImageTransactionalStorageInspector();
  StorageDirectory mockDir=FSImageTestUtil.mockStorageDirectory(NameNodeDirType.IMAGE_AND_EDITS,false,"/foo/current/" + getImageFileName(123),"/foo/current/" + getFinalizedEditsFileName(123,456),"/foo/current/" + getImageFileName(456),"/foo/current/" + getInProgressEditsFileName(457));
  inspector.inspectDirectory(mockDir);
  assertEquals(2,inspector.foundImages.size());
  FSImageFile latestImage=inspector.getLatestImages().get(0);
  assertEquals(456,latestImage.txId);
  assertSame(mockDir,latestImage.sd);
  assertTrue(inspector.isUpgradeFinalized());
  assertEquals(new File("/foo/current/" + getImageFileName(456)),latestImage.getFile());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestINodeFile </h4><pre class="type-9 type-7 type-10 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test whether the inode in inodeMap has been replaced after regular inode
 * replacement
 */
@Test public void testInodeReplacement() throws Exception {
  final Configuration conf=new Configuration();
  MiniDFSCluster cluster=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
    cluster.waitActive();
    final DistributedFileSystem hdfs=cluster.getFileSystem();
    final FSDirectory fsdir=cluster.getNamesystem().getFSDirectory();
    final Path dir=new Path("/dir");
    hdfs.mkdirs(dir);
    INodeDirectory dirNode=getDir(fsdir,dir);
    INode dirNodeFromNode=fsdir.getInode(dirNode.getId());
    assertSame(dirNode,dirNodeFromNode);
    hdfs.setQuota(dir,Long.MAX_VALUE - 1,Long.MAX_VALUE - 1);
    dirNode=getDir(fsdir,dir);
    assertTrue(dirNode.isWithQuota());
    dirNodeFromNode=fsdir.getInode(dirNode.getId());
    assertSame(dirNode,dirNodeFromNode);
    hdfs.setQuota(dir,-1,-1);
    dirNode=getDir(fsdir,dir);
    dirNodeFromNode=fsdir.getInode(dirNode.getId());
    assertSame(dirNode,dirNodeFromNode);
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.snapshot.TestNestedSnapshots </h4><pre class="type-2 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testSnapshotWithQuota() throws Exception {
  final String dirStr="/testSnapshotWithQuota/dir";
  final Path dir=new Path(dirStr);
  hdfs.mkdirs(dir,new FsPermission((short)0777));
  hdfs.allowSnapshot(dir);
  final int NS_QUOTA=6;
  hdfs.setQuota(dir,NS_QUOTA,HdfsConstants.QUOTA_DONT_SET);
  final Path foo=new Path(dir,"foo");
  final Path f1=new Path(foo,"f1");
  DFSTestUtil.createFile(hdfs,f1,BLOCKSIZE,REPLICATION,SEED);
{
    final Path snapshotPath=hdfs.createSnapshot(dir);
    final String snapshotName=snapshotPath.getName();
    Assert.assertTrue("snapshotName=" + snapshotName,Pattern.matches("s\\d\\d\\d\\d\\d\\d\\d\\d-\\d\\d\\d\\d\\d\\d\\.\\d\\d\\d",snapshotName));
    final Path parent=snapshotPath.getParent();
    Assert.assertEquals(HdfsConstants.DOT_SNAPSHOT_DIR,parent.getName());
    Assert.assertEquals(dir,parent.getParent());
  }
  final Path f2=new Path(foo,"f2");
  DFSTestUtil.createFile(hdfs,f2,BLOCKSIZE,REPLICATION,SEED);
  try {
    final Path f3=new Path(foo,"f3");
    DFSTestUtil.createFile(hdfs,f3,BLOCKSIZE,REPLICATION,SEED);
    Assert.fail();
  }
 catch (  NSQuotaExceededException e) {
    SnapshotTestHelper.LOG.info("The exception is expected.",e);
  }
  try {
    hdfs.createSnapshot(dir);
    Assert.fail();
  }
 catch (  NSQuotaExceededException e) {
    SnapshotTestHelper.LOG.info("The exception is expected.",e);
  }
  try {
    hdfs.setPermission(f1,new FsPermission((short)0));
    Assert.fail();
  }
 catch (  RemoteException e) {
    Assert.assertSame(NSQuotaExceededException.class,e.unwrapRemoteException().getClass());
    SnapshotTestHelper.LOG.info("The exception is expected.",e);
  }
  hdfs.setPermission(f2,new FsPermission((short)0));
  hdfs.setQuota(dir,NS_QUOTA + 2,HdfsConstants.QUOTA_DONT_SET);
  hdfs.createSnapshot(dir,"s1");
  hdfs.setPermission(foo,new FsPermission((short)0444));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.snapshot.TestRenameWithSnapshots </h4><pre class="type-9 type-2 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=300000) public void testRenameFromSDir2NonSDir() throws Exception {
  final String dirStr="/testRenameWithSnapshot";
  final String abcStr=dirStr + "/abc";
  final Path abc=new Path(abcStr);
  hdfs.mkdirs(abc,new FsPermission((short)0777));
  hdfs.allowSnapshot(abc);
  final Path foo=new Path(abc,"foo");
  DFSTestUtil.createFile(hdfs,foo,BLOCKSIZE,REPL,SEED);
  hdfs.createSnapshot(abc,"s0");
  try {
    hdfs.rename(abc,new Path(dirStr,"tmp"));
    fail("Expect exception since " + abc + " is snapshottable and already has snapshots");
  }
 catch (  IOException e) {
    GenericTestUtils.assertExceptionContains(abcStr + " is snapshottable and already has snapshots",e);
  }
  final String xyzStr=dirStr + "/xyz";
  final Path xyz=new Path(xyzStr);
  hdfs.mkdirs(xyz,new FsPermission((short)0777));
  final Path bar=new Path(xyz,"bar");
  hdfs.rename(foo,bar);
  final INode fooRef=fsdir.getINode(SnapshotTestHelper.getSnapshotPath(abc,"s0","foo").toString());
  Assert.assertTrue(fooRef.isReference());
  Assert.assertTrue(fooRef.asReference() instanceof INodeReference.WithName);
  final INodeReference.WithCount withCount=(INodeReference.WithCount)fooRef.asReference().getReferredINode();
  Assert.assertEquals(2,withCount.getReferenceCount());
  final INode barRef=fsdir.getINode(bar.toString());
  Assert.assertTrue(barRef.isReference());
  Assert.assertSame(withCount,barRef.asReference().getReferredINode());
  hdfs.delete(bar,false);
  Assert.assertEquals(1,withCount.getReferenceCount());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Unit test for HDFS-4842.
 */
@Test public void testRenameDirAndDeleteSnapshot_7() throws Exception {
  fsn.getSnapshotManager().setAllowNestedSnapshots(true);
  final Path test=new Path("/test");
  final Path dir1=new Path(test,"dir1");
  final Path dir2=new Path(test,"dir2");
  hdfs.mkdirs(dir1);
  hdfs.mkdirs(dir2);
  final Path foo=new Path(dir2,"foo");
  final Path bar=new Path(foo,"bar");
  final Path file=new Path(bar,"file");
  DFSTestUtil.createFile(hdfs,file,BLOCKSIZE,REPL,SEED);
  SnapshotTestHelper.createSnapshot(hdfs,test,"s0");
  SnapshotTestHelper.createSnapshot(hdfs,test,"s1");
  hdfs.delete(file,true);
  SnapshotTestHelper.createSnapshot(hdfs,dir2,"s2");
  final Path newfoo=new Path(dir1,foo.getName());
  hdfs.rename(foo,newfoo);
  hdfs.deleteSnapshot(test,"s1");
  final Path file_s2=SnapshotTestHelper.getSnapshotPath(dir2,"s2","foo/bar/file");
  assertFalse(hdfs.exists(file_s2));
  final Path file_s0=SnapshotTestHelper.getSnapshotPath(test,"s0","dir2/foo/bar/file");
  assertTrue(hdfs.exists(file_s0));
  INodeDirectory dir1Node=fsdir.getINode4Write(dir1.toString()).asDirectory();
  List<DirectoryDiff> dir1DiffList=dir1Node.getDiffs().asList();
  assertEquals(1,dir1DiffList.size());
  List<INode> dList=dir1DiffList.get(0).getChildrenDiff().getList(ListType.DELETED);
  assertTrue(dList.isEmpty());
  List<INode> cList=dir1DiffList.get(0).getChildrenDiff().getList(ListType.CREATED);
  assertEquals(1,cList.size());
  INode cNode=cList.get(0);
  INode fooNode=fsdir.getINode4Write(newfoo.toString());
  assertSame(cNode,fooNode);
  final Path newbar=new Path(newfoo,bar.getName());
  INodeDirectory barNode=fsdir.getINode4Write(newbar.toString()).asDirectory();
  assertSame(fooNode.asDirectory(),barNode.getParent());
  List<DirectoryDiff> barDiffList=barNode.getDiffs().asList();
  assertEquals(1,barDiffList.size());
  DirectoryDiff diff=barDiffList.get(0);
  INodeDirectory testNode=fsdir.getINode4Write(test.toString()).asDirectory();
  Snapshot s0=testNode.getSnapshot(DFSUtil.string2Bytes("s0"));
  assertEquals(s0.getId(),diff.getSnapshotId());
  assertEquals("file",diff.getChildrenDiff().getList(ListType.DELETED).get(0).getLocalName());
  INodeDirectory dir2Node=fsdir.getINode4Write(dir2.toString()).asDirectory();
  List<DirectoryDiff> dir2DiffList=dir2Node.getDiffs().asList();
  assertEquals(1,dir2DiffList.size());
  dList=dir2DiffList.get(0).getChildrenDiff().getList(ListType.DELETED);
  assertEquals(1,dList.size());
  final Path foo_s2=SnapshotTestHelper.getSnapshotPath(dir2,"s2",foo.getName());
  INodeReference.WithName fooNode_s2=(INodeReference.WithName)fsdir.getINode(foo_s2.toString());
  assertSame(dList.get(0),fooNode_s2);
  assertSame(fooNode.asReference().getReferredINode(),fooNode_s2.getReferredINode());
  restartClusterAndCheckImage(true);
}

</code></pre>

<br>
<pre class="type-2 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test undo where dst node being overwritten is a reference node
 */
@Test public void testRenameUndo_4() throws Exception {
  final Path sdir1=new Path("/dir1");
  final Path sdir2=new Path("/dir2");
  final Path sdir3=new Path("/dir3");
  hdfs.mkdirs(sdir1);
  hdfs.mkdirs(sdir2);
  hdfs.mkdirs(sdir3);
  final Path foo=new Path(sdir1,"foo");
  final Path bar=new Path(foo,"bar");
  DFSTestUtil.createFile(hdfs,bar,BLOCKSIZE,REPL,SEED);
  final Path foo2=new Path(sdir2,"foo2");
  hdfs.mkdirs(foo2);
  SnapshotTestHelper.createSnapshot(hdfs,sdir1,"s1");
  SnapshotTestHelper.createSnapshot(hdfs,sdir2,"s2");
  final Path foo3=new Path(sdir3,"foo3");
  hdfs.rename(foo2,foo3);
  INode foo3Node=fsdir.getINode4Write(foo3.toString());
  assertTrue(foo3Node.isReference());
  INodeDirectory dir3=fsdir.getINode4Write(sdir3.toString()).asDirectory();
  INodeDirectory mockDir3=spy(dir3);
  doReturn(false).when(mockDir3).addChild((INode)Mockito.isNull(),anyBoolean(),Mockito.anyInt());
  Mockito.when(mockDir3.addChild((INode)Mockito.isNotNull(),anyBoolean(),Mockito.anyInt())).thenReturn(false).thenCallRealMethod();
  INodeDirectory root=fsdir.getINode4Write("/").asDirectory();
  root.replaceChild(dir3,mockDir3,fsdir.getINodeMap());
  foo3Node.setParent(mockDir3);
  try {
    hdfs.rename(foo,foo3,Rename.OVERWRITE);
    fail("the rename from " + foo + " to "+ foo3+ " should fail");
  }
 catch (  IOException e) {
    GenericTestUtils.assertExceptionContains("rename from " + foo + " to "+ foo3+ " failed.",e);
  }
  final INode foo3Node_undo=fsdir.getINode4Write(foo3.toString());
  assertSame(foo3Node,foo3Node_undo);
  INodeReference.WithCount foo3_wc=(WithCount)foo3Node.asReference().getReferredINode();
  assertEquals(2,foo3_wc.getReferenceCount());
  assertSame(foo3Node,foo3_wc.getParentReference());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * After the following operations:
 * Rename a dir -> create a snapshot s on dst tree -> rename the renamed dir
 * again -> delete snapshot s on dst tree
 * Make sure we only delete the snapshot s under the renamed dir.
 */
@Test public void testRenameDirAndDeleteSnapshot_4() throws Exception {
  final Path sdir1=new Path("/dir1");
  final Path sdir2=new Path("/dir2");
  final Path foo=new Path(sdir1,"foo");
  final Path bar=new Path(foo,"bar");
  DFSTestUtil.createFile(hdfs,bar,BLOCKSIZE,REPL,SEED);
  hdfs.mkdirs(sdir2);
  SnapshotTestHelper.createSnapshot(hdfs,sdir1,"s1");
  SnapshotTestHelper.createSnapshot(hdfs,sdir2,"s2");
  final Path foo2=new Path(sdir2,"foo");
  hdfs.rename(foo,foo2);
  final Path bar2=new Path(foo2,"bar2");
  DFSTestUtil.createFile(hdfs,bar2,BLOCKSIZE,REPL,SEED);
  final Path bar3=new Path(foo2,"bar3");
  DFSTestUtil.createFile(hdfs,bar3,BLOCKSIZE,REPL,SEED);
  hdfs.createSnapshot(sdir2,"s3");
  hdfs.rename(foo2,foo);
  hdfs.deleteSnapshot(sdir2,"s3");
  final INodeDirectory dir1Node=fsdir.getINode4Write(sdir1.toString()).asDirectory();
  Quota.Counts q1=dir1Node.getDirectoryWithQuotaFeature().getSpaceConsumed();
  assertEquals(9,q1.get(Quota.NAMESPACE));
  final INodeDirectory dir2Node=fsdir.getINode4Write(sdir2.toString()).asDirectory();
  Quota.Counts q2=dir2Node.getDirectoryWithQuotaFeature().getSpaceConsumed();
  assertEquals(2,q2.get(Quota.NAMESPACE));
  final Path foo_s1=SnapshotTestHelper.getSnapshotPath(sdir1,"s1",foo.getName());
  final INode fooRef=fsdir.getINode(foo_s1.toString());
  assertTrue(fooRef instanceof INodeReference.WithName);
  INodeReference.WithCount wc=(WithCount)fooRef.asReference().getReferredINode();
  assertEquals(2,wc.getReferenceCount());
  INodeDirectory fooNode=wc.getReferredINode().asDirectory();
  ReadOnlyList<INode> children=fooNode.getChildrenList(Snapshot.CURRENT_STATE_ID);
  assertEquals(3,children.size());
  assertEquals(bar.getName(),children.get(0).getLocalName());
  assertEquals(bar2.getName(),children.get(1).getLocalName());
  assertEquals(bar3.getName(),children.get(2).getLocalName());
  List<DirectoryDiff> diffList=fooNode.getDiffs().asList();
  assertEquals(1,diffList.size());
  Snapshot s1=dir1Node.getSnapshot(DFSUtil.string2Bytes("s1"));
  assertEquals(s1.getId(),diffList.get(0).getSnapshotId());
  ChildrenDiff diff=diffList.get(0).getChildrenDiff();
  assertEquals(2,diff.getList(ListType.CREATED).size());
  assertEquals(0,diff.getList(ListType.DELETED).size());
  final INode fooRef2=fsdir.getINode4Write(foo.toString());
  assertTrue(fooRef2 instanceof INodeReference.DstReference);
  INodeReference.WithCount wc2=(WithCount)fooRef2.asReference().getReferredINode();
  assertSame(wc,wc2);
  assertSame(fooRef2,wc.getParentReference());
  restartClusterAndCheckImage(true);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test rename while the rename operation will exceed the quota in the dst
 * tree.
 */
@Test public void testRenameUndo_5() throws Exception {
  final Path test=new Path("/test");
  final Path dir1=new Path(test,"dir1");
  final Path dir2=new Path(test,"dir2");
  final Path subdir2=new Path(dir2,"subdir2");
  hdfs.mkdirs(dir1);
  hdfs.mkdirs(subdir2);
  final Path foo=new Path(dir1,"foo");
  final Path bar=new Path(foo,"bar");
  DFSTestUtil.createFile(hdfs,bar,BLOCKSIZE,REPL,SEED);
  SnapshotTestHelper.createSnapshot(hdfs,dir1,"s1");
  SnapshotTestHelper.createSnapshot(hdfs,dir2,"s2");
  hdfs.setQuota(dir2,5,Long.MAX_VALUE - 1);
  final Path foo2=new Path(subdir2,foo.getName());
  boolean rename=hdfs.rename(foo,foo2);
  assertFalse(rename);
  assertTrue(hdfs.exists(foo));
  assertTrue(hdfs.exists(bar));
  INodeDirectory dir1Node=fsdir.getINode4Write(dir1.toString()).asDirectory();
  List<INode> childrenList=ReadOnlyList.Util.asList(dir1Node.getChildrenList(Snapshot.CURRENT_STATE_ID));
  assertEquals(1,childrenList.size());
  INode fooNode=childrenList.get(0);
  assertTrue(fooNode.asDirectory().isWithSnapshot());
  INode barNode=fsdir.getINode4Write(bar.toString());
  assertTrue(barNode.getClass() == INodeFile.class);
  assertSame(fooNode,barNode.getParent());
  List<DirectoryDiff> diffList=dir1Node.getDiffs().asList();
  assertEquals(1,diffList.size());
  DirectoryDiff diff=diffList.get(0);
  assertTrue(diff.getChildrenDiff().getList(ListType.CREATED).isEmpty());
  assertTrue(diff.getChildrenDiff().getList(ListType.DELETED).isEmpty());
  INodeDirectory dir2Node=fsdir.getINode4Write(dir2.toString()).asDirectory();
  assertTrue(dir2Node.isSnapshottable());
  Quota.Counts counts=dir2Node.computeQuotaUsage();
  assertEquals(3,counts.get(Quota.NAMESPACE));
  assertEquals(0,counts.get(Quota.DISKSPACE));
  childrenList=ReadOnlyList.Util.asList(dir2Node.asDirectory().getChildrenList(Snapshot.CURRENT_STATE_ID));
  assertEquals(1,childrenList.size());
  INode subdir2Node=childrenList.get(0);
  assertSame(dir2Node,subdir2Node.getParent());
  assertSame(subdir2Node,fsdir.getINode4Write(subdir2.toString()));
  diffList=dir2Node.getDiffs().asList();
  assertEquals(1,diffList.size());
  diff=diffList.get(0);
  assertTrue(diff.getChildrenDiff().getList(ListType.CREATED).isEmpty());
  assertTrue(diff.getChildrenDiff().getList(ListType.DELETED).isEmpty());
}

</code></pre>

<br>
<pre class="type-9 type-2 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the rename undo when removing dst node fails
 */
@Test public void testRenameUndo_6() throws Exception {
  final Path test=new Path("/test");
  final Path dir1=new Path(test,"dir1");
  final Path dir2=new Path(test,"dir2");
  final Path sub_dir2=new Path(dir2,"subdir");
  final Path subsub_dir2=new Path(sub_dir2,"subdir");
  hdfs.mkdirs(dir1);
  hdfs.mkdirs(subsub_dir2);
  final Path foo=new Path(dir1,"foo");
  hdfs.mkdirs(foo);
  SnapshotTestHelper.createSnapshot(hdfs,dir1,"s1");
  SnapshotTestHelper.createSnapshot(hdfs,dir2,"s2");
  hdfs.setQuota(dir2,4,Long.MAX_VALUE - 1);
  try {
    hdfs.rename(foo,subsub_dir2,Rename.OVERWRITE);
    fail("Expect QuotaExceedException");
  }
 catch (  QuotaExceededException e) {
    String msg="Failed to record modification for snapshot: " + "The NameSpace quota (directories and files)" + " is exceeded: quota=4 file count=5";
    GenericTestUtils.assertExceptionContains(msg,e);
  }
  assertTrue(hdfs.exists(foo));
  INodeDirectory dir1Node=fsdir.getINode4Write(dir1.toString()).asDirectory();
  List<INode> childrenList=ReadOnlyList.Util.asList(dir1Node.getChildrenList(Snapshot.CURRENT_STATE_ID));
  assertEquals(1,childrenList.size());
  INode fooNode=childrenList.get(0);
  assertTrue(fooNode.asDirectory().isWithSnapshot());
  assertSame(dir1Node,fooNode.getParent());
  List<DirectoryDiff> diffList=dir1Node.getDiffs().asList();
  assertEquals(1,diffList.size());
  DirectoryDiff diff=diffList.get(0);
  assertTrue(diff.getChildrenDiff().getList(ListType.CREATED).isEmpty());
  assertTrue(diff.getChildrenDiff().getList(ListType.DELETED).isEmpty());
  INodeDirectory dir2Node=fsdir.getINode4Write(dir2.toString()).asDirectory();
  assertTrue(dir2Node.isSnapshottable());
  Quota.Counts counts=dir2Node.computeQuotaUsage();
  assertEquals(4,counts.get(Quota.NAMESPACE));
  assertEquals(0,counts.get(Quota.DISKSPACE));
  childrenList=ReadOnlyList.Util.asList(dir2Node.asDirectory().getChildrenList(Snapshot.CURRENT_STATE_ID));
  assertEquals(1,childrenList.size());
  INode subdir2Node=childrenList.get(0);
  assertTrue(subdir2Node.asDirectory().isWithSnapshot());
  assertSame(dir2Node,subdir2Node.getParent());
  assertSame(subdir2Node,fsdir.getINode4Write(sub_dir2.toString()));
  INode subsubdir2Node=fsdir.getINode4Write(subsub_dir2.toString());
  assertTrue(subsubdir2Node.getClass() == INodeDirectory.class);
  assertSame(subdir2Node,subsubdir2Node.getParent());
  diffList=(dir2Node).getDiffs().asList();
  assertEquals(1,diffList.size());
  diff=diffList.get(0);
  assertTrue(diff.getChildrenDiff().getList(ListType.CREATED).isEmpty());
  assertTrue(diff.getChildrenDiff().getList(ListType.DELETED).isEmpty());
  diffList=subdir2Node.asDirectory().getDiffs().asList();
  assertEquals(0,diffList.size());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test demonstrates that {@link INodeDirectory#removeChild(INode,Snapshot)}and {@link INodeDirectory#addChild(INode,boolean,Snapshot)}should use {@link INode#isInLatestSnapshot(Snapshot)} to check if the 
 * added/removed child should be recorded in snapshots.
 */
@Test public void testRenameDirAndDeleteSnapshot_5() throws Exception {
  final Path dir1=new Path("/dir1");
  final Path dir2=new Path("/dir2");
  final Path dir3=new Path("/dir3");
  hdfs.mkdirs(dir1);
  hdfs.mkdirs(dir2);
  hdfs.mkdirs(dir3);
  final Path foo=new Path(dir1,"foo");
  hdfs.mkdirs(foo);
  SnapshotTestHelper.createSnapshot(hdfs,dir1,"s1");
  final Path bar=new Path(foo,"bar");
  DFSTestUtil.createFile(hdfs,bar,BLOCKSIZE,REPL,SEED);
  hdfs.deleteSnapshot(dir1,"s1");
  SnapshotTestHelper.createSnapshot(hdfs,dir2,"s2");
  final Path foo2=new Path(dir2,foo.getName());
  hdfs.rename(foo,foo2);
  final Path bar2=new Path(dir2,"foo/bar");
  final Path bar3=new Path(dir3,"bar");
  hdfs.rename(bar2,bar3);
  hdfs.delete(foo2,true);
  assertTrue(hdfs.exists(bar3));
  INodeFile barNode=(INodeFile)fsdir.getINode4Write(bar3.toString());
  assertSame(fsdir.getINode4Write(dir3.toString()),barNode.getParent());
}

</code></pre>

<br>
<pre class="type-9 type-2 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test rename to an invalid name (xxx/.snapshot)
 */
@Test public void testRenameUndo_7() throws Exception {
  final Path root=new Path("/");
  final Path foo=new Path(root,"foo");
  final Path bar=new Path(foo,"bar");
  DFSTestUtil.createFile(hdfs,bar,BLOCKSIZE,REPL,SEED);
  SnapshotTestHelper.createSnapshot(hdfs,root,snap1);
  final Path invalid=new Path(foo,HdfsConstants.DOT_SNAPSHOT_DIR);
  try {
    hdfs.rename(bar,invalid);
    fail("expect exception since invalid name is used for rename");
  }
 catch (  Exception e) {
    GenericTestUtils.assertExceptionContains("\"" + HdfsConstants.DOT_SNAPSHOT_DIR + "\" is a reserved name",e);
  }
  INodeDirectory rootNode=fsdir.getINode4Write(root.toString()).asDirectory();
  INodeDirectory fooNode=fsdir.getINode4Write(foo.toString()).asDirectory();
  ReadOnlyList<INode> children=fooNode.getChildrenList(Snapshot.CURRENT_STATE_ID);
  assertEquals(1,children.size());
  List<DirectoryDiff> diffList=fooNode.getDiffs().asList();
  assertEquals(1,diffList.size());
  DirectoryDiff diff=diffList.get(0);
  Snapshot s1=rootNode.getSnapshot(DFSUtil.string2Bytes(snap1));
  assertEquals(s1.getId(),diff.getSnapshotId());
  assertTrue(diff.getChildrenDiff().getList(ListType.DELETED).isEmpty());
  assertTrue(diff.getChildrenDiff().getList(ListType.CREATED).isEmpty());
  INodeFile barNode=fsdir.getINode4Write(bar.toString()).asFile();
  assertSame(barNode,children.get(0));
  assertSame(fooNode,barNode.getParent());
  List<FileDiff> barDiffList=barNode.getDiffs().asList();
  assertEquals(1,barDiffList.size());
  FileDiff barDiff=barDiffList.get(0);
  assertEquals(s1.getId(),barDiff.getSnapshotId());
  hdfs.setSafeMode(SafeModeAction.SAFEMODE_ENTER);
  hdfs.saveNamespace();
  hdfs.setSafeMode(SafeModeAction.SAFEMODE_LEAVE);
  cluster.shutdown();
  cluster=new MiniDFSCluster.Builder(conf).format(false).numDataNodes(REPL).build();
  cluster.waitActive();
  restartClusterAndCheckImage(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.snapshot.TestSetQuotaWithSnapshot </h4><pre class="type-9 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test clear quota of a snapshottable dir or a dir with snapshot.
 */
@Test public void testClearQuota() throws Exception {
  final Path dir=new Path("/TestSnapshot");
  hdfs.mkdirs(dir);
  hdfs.allowSnapshot(dir);
  hdfs.setQuota(dir,HdfsConstants.QUOTA_DONT_SET,HdfsConstants.QUOTA_DONT_SET);
  INodeDirectory dirNode=fsdir.getINode4Write(dir.toString()).asDirectory();
  assertTrue(dirNode.isSnapshottable());
  assertEquals(0,dirNode.getDiffs().asList().size());
  hdfs.setQuota(dir,HdfsConstants.QUOTA_DONT_SET - 1,HdfsConstants.QUOTA_DONT_SET - 1);
  dirNode=fsdir.getINode4Write(dir.toString()).asDirectory();
  assertTrue(dirNode.isSnapshottable());
  assertEquals(0,dirNode.getDiffs().asList().size());
  hdfs.setQuota(dir,HdfsConstants.QUOTA_RESET,HdfsConstants.QUOTA_RESET);
  dirNode=fsdir.getINode4Write(dir.toString()).asDirectory();
  assertTrue(dirNode.isSnapshottable());
  assertEquals(0,dirNode.getDiffs().asList().size());
  SnapshotTestHelper.createSnapshot(hdfs,dir,"s1");
  hdfs.setQuota(dir,HdfsConstants.QUOTA_RESET,HdfsConstants.QUOTA_RESET);
  dirNode=fsdir.getINode4Write(dir.toString()).asDirectory();
  assertTrue(dirNode.isSnapshottable());
  assertEquals(1,dirNode.getDiffs().asList().size());
  SnapshottableDirectoryStatus[] status=hdfs.getSnapshottableDirListing();
  assertEquals(1,status.length);
  assertEquals(dir,status[0].getFullPath());
  final Path subDir=new Path(dir,"sub");
  hdfs.mkdirs(subDir);
  hdfs.createSnapshot(dir,"s2");
  final Path file=new Path(subDir,"file");
  DFSTestUtil.createFile(hdfs,file,BLOCKSIZE,REPLICATION,seed);
  hdfs.setQuota(dir,HdfsConstants.QUOTA_RESET,HdfsConstants.QUOTA_RESET);
  INode subNode=fsdir.getINode4Write(subDir.toString());
  assertTrue(subNode.asDirectory().isWithSnapshot());
  List<DirectoryDiff> diffList=subNode.asDirectory().getDiffs().asList();
  assertEquals(1,diffList.size());
  Snapshot s2=dirNode.getSnapshot(DFSUtil.string2Bytes("s2"));
  assertEquals(s2.getId(),diffList.get(0).getSnapshotId());
  List<INode> createdList=diffList.get(0).getChildrenDiff().getList(ListType.CREATED);
  assertEquals(1,createdList.size());
  assertSame(fsdir.getINode4Write(file.toString()),createdList.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.snapshot.TestSnapshotBlocksMap </h4><pre class="type-9 type-2 type-7 type-10 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test deleting a file with snapshots. Need to check the blocksMap to make
 * sure the corresponding record is updated correctly.
 */
@Test(timeout=60000) public void testDeletionWithSnapshots() throws Exception {
  Path file0=new Path(sub1,"file0");
  Path file1=new Path(sub1,"file1");
  Path sub2=new Path(sub1,"sub2");
  Path file2=new Path(sub2,"file2");
  Path file3=new Path(sub1,"file3");
  Path file4=new Path(sub1,"file4");
  Path file5=new Path(sub1,"file5");
  DFSTestUtil.createFile(hdfs,file0,4 * BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,file1,2 * BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,file2,3 * BLOCKSIZE,REPLICATION,seed);
{
    final INodeFile f2=assertBlockCollection(file2.toString(),3,fsdir,blockmanager);
    BlockInfo[] blocks=f2.getBlocks();
    hdfs.delete(sub2,true);
    for (    BlockInfo b : blocks) {
      assertNull(blockmanager.getBlockCollection(b));
    }
  }
  final String[] snapshots={"s0","s1","s2"};
  DFSTestUtil.createFile(hdfs,file3,5 * BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,sub1,snapshots[0]);
  DFSTestUtil.createFile(hdfs,file4,1 * BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,sub1,snapshots[1]);
  DFSTestUtil.createFile(hdfs,file5,7 * BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,sub1,snapshots[2]);
{
    INodeFile f1=assertBlockCollection(file1.toString(),2,fsdir,blockmanager);
    Assert.assertSame(INodeFile.class,f1.getClass());
    hdfs.setReplication(file1,(short)2);
    f1=assertBlockCollection(file1.toString(),2,fsdir,blockmanager);
    assertTrue(f1.isWithSnapshot());
    assertFalse(f1.isUnderConstruction());
  }
  final INodeFile f0=assertBlockCollection(file0.toString(),4,fsdir,blockmanager);
  BlockInfo[] blocks0=f0.getBlocks();
  Path snapshotFile0=SnapshotTestHelper.getSnapshotPath(sub1,"s0",file0.getName());
  assertBlockCollection(snapshotFile0.toString(),4,fsdir,blockmanager);
  hdfs.delete(file0,true);
  for (  BlockInfo b : blocks0) {
    assertNotNull(blockmanager.getBlockCollection(b));
  }
  assertBlockCollection(snapshotFile0.toString(),4,fsdir,blockmanager);
  String s1f0=SnapshotTestHelper.getSnapshotPath(sub1,"s1",file0.getName()).toString();
  assertBlockCollection(s1f0,4,fsdir,blockmanager);
  hdfs.deleteSnapshot(sub1,"s1");
  for (  BlockInfo b : blocks0) {
    assertNotNull(blockmanager.getBlockCollection(b));
  }
  assertBlockCollection(snapshotFile0.toString(),4,fsdir,blockmanager);
  try {
    INodeFile.valueOf(fsdir.getINode(s1f0),s1f0);
    fail("Expect FileNotFoundException when identifying the INode in a deleted Snapshot");
  }
 catch (  IOException e) {
    assertExceptionContains("File does not exist: " + s1f0,e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.util.TestLightWeightHashSet </h4><pre class="type-7 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetElement(){
  LightWeightHashSet<TestObject> objSet=new LightWeightHashSet<TestObject>();
  TestObject objA=new TestObject("object A");
  TestObject equalToObjA=new TestObject("object A");
  TestObject objB=new TestObject("object B");
  objSet.add(objA);
  objSet.add(objB);
  assertSame(objA,objSet.getElement(objA));
  assertSame(objA,objSet.getElement(equalToObjA));
  assertSame(objB,objSet.getElement(objB));
  assertNull(objSet.getElement(new TestObject("not in set")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.web.TestTokenAspect </h4><pre class="type-9 type-7 type-10 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRenewal() throws Exception {
  Configuration conf=new Configuration();
  Token<?> token1=mock(Token.class);
  Token<?> token2=mock(Token.class);
  final long renewCycle=100;
  DelegationTokenRenewer.renewCycle=renewCycle;
  UserGroupInformation ugi=UserGroupInformation.createUserForTesting("foo",new String[]{"bar"});
  DummyFs fs=spy(new DummyFs());
  doReturn(token1).doReturn(token2).when(fs).getDelegationToken(null);
  doReturn(token1).when(fs).getRenewToken();
  doThrow(new IOException("renew failed")).when(token1).renew(conf);
  doThrow(new IOException("get failed")).when(fs).addDelegationTokens(null,null);
  final URI uri=new URI("dummyfs://127.0.0.1:1234");
  TokenAspect<DummyFs> tokenAspect=new TokenAspect<DummyFs>(fs,SecurityUtil.buildTokenService(uri),DummyFs.TOKEN_KIND);
  fs.initialize(uri,conf);
  tokenAspect.initDelegationToken(ugi);
  tokenAspect.ensureTokenInitialized();
  DelegationTokenRenewer.RenewAction<?> action=getActionFromTokenAspect(tokenAspect);
  verify(fs).setDelegationToken(token1);
  assertTrue(action.isValid());
  Thread.sleep(renewCycle * 2);
  assertSame(action,getActionFromTokenAspect(tokenAspect));
  assertFalse(action.isValid());
  tokenAspect.ensureTokenInitialized();
  verify(fs,times(2)).getDelegationToken(anyString());
  verify(fs).setDelegationToken(token2);
  assertNotSame(action,getActionFromTokenAspect(tokenAspect));
  action=getActionFromTokenAspect(tokenAspect);
  assertTrue(action.isValid());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.ipc.TestSaslRPC </h4><pre class="type-9 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPerConnectionConf() throws Exception {
  TestTokenSecretManager sm=new TestTokenSecretManager();
  final Server server=new RPC.Builder(conf).setProtocol(TestSaslProtocol.class).setInstance(new TestSaslImpl()).setBindAddress(ADDRESS).setPort(0).setNumHandlers(5).setVerbose(true).setSecretManager(sm).build();
  server.start();
  final UserGroupInformation current=UserGroupInformation.getCurrentUser();
  final InetSocketAddress addr=NetUtils.getConnectAddress(server);
  TestTokenIdentifier tokenId=new TestTokenIdentifier(new Text(current.getUserName()));
  Token<TestTokenIdentifier> token=new Token<TestTokenIdentifier>(tokenId,sm);
  SecurityUtil.setTokenService(token,addr);
  current.addToken(token);
  Configuration newConf=new Configuration(conf);
  newConf.set(CommonConfigurationKeysPublic.HADOOP_RPC_SOCKET_FACTORY_CLASS_DEFAULT_KEY,"");
  Client client=null;
  TestSaslProtocol proxy1=null;
  TestSaslProtocol proxy2=null;
  TestSaslProtocol proxy3=null;
  int timeouts[]={111222,3333333};
  try {
    newConf.setInt(CommonConfigurationKeysPublic.IPC_CLIENT_CONNECTION_MAXIDLETIME_KEY,timeouts[0]);
    proxy1=RPC.getProxy(TestSaslProtocol.class,TestSaslProtocol.versionID,addr,newConf);
    proxy1.getAuthMethod();
    client=WritableRpcEngine.getClient(newConf);
    Set<ConnectionId> conns=client.getConnectionIds();
    assertEquals("number of connections in cache is wrong",1,conns.size());
    proxy2=RPC.getProxy(TestSaslProtocol.class,TestSaslProtocol.versionID,addr,newConf);
    proxy2.getAuthMethod();
    assertEquals("number of connections in cache is wrong",1,conns.size());
    newConf.setInt(CommonConfigurationKeysPublic.IPC_CLIENT_CONNECTION_MAXIDLETIME_KEY,timeouts[1]);
    proxy3=RPC.getProxy(TestSaslProtocol.class,TestSaslProtocol.versionID,addr,newConf);
    proxy3.getAuthMethod();
    assertEquals("number of connections in cache is wrong",2,conns.size());
    ConnectionId[] connsArray={RPC.getConnectionIdForProxy(proxy1),RPC.getConnectionIdForProxy(proxy2),RPC.getConnectionIdForProxy(proxy3)};
    assertEquals(connsArray[0],connsArray[1]);
    assertEquals(connsArray[0].getMaxIdleTime(),timeouts[0]);
    assertFalse(connsArray[0].equals(connsArray[2]));
    assertNotSame(connsArray[2].getMaxIdleTime(),timeouts[1]);
  }
  finally {
    server.stop();
    if (client != null) {
      client.getConnectionIds().clear();
    }
    if (proxy1 != null)     RPC.stopProxy(proxy1);
    if (proxy2 != null)     RPC.stopProxy(proxy2);
    if (proxy3 != null)     RPC.stopProxy(proxy3);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.ipc.TestSocketFactory </h4><pre class="type-9 type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSocketFactoryAsKeyInMap(){
  Map<SocketFactory,Integer> dummyCache=new HashMap<SocketFactory,Integer>();
  int toBeCached1=1;
  int toBeCached2=2;
  Configuration conf=new Configuration();
  conf.set(CommonConfigurationKeys.HADOOP_RPC_SOCKET_FACTORY_CLASS_DEFAULT_KEY,"org.apache.hadoop.ipc.TestSocketFactory$DummySocketFactory");
  final SocketFactory dummySocketFactory=NetUtils.getDefaultSocketFactory(conf);
  dummyCache.put(dummySocketFactory,toBeCached1);
  conf.set(CommonConfigurationKeys.HADOOP_RPC_SOCKET_FACTORY_CLASS_DEFAULT_KEY,"org.apache.hadoop.net.StandardSocketFactory");
  final SocketFactory defaultSocketFactory=NetUtils.getDefaultSocketFactory(conf);
  dummyCache.put(defaultSocketFactory,toBeCached2);
  Assert.assertEquals("The cache contains two elements",2,dummyCache.size());
  Assert.assertEquals("Equals of both socket factory shouldn't be same",defaultSocketFactory.equals(dummySocketFactory),false);
  assertSame(toBeCached2,dummyCache.remove(defaultSocketFactory));
  dummyCache.put(defaultSocketFactory,toBeCached2);
  assertSame(toBeCached1,dummyCache.remove(dummySocketFactory));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.service.security.TestGroupsService </h4><pre class="type-7 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @TestDir public void service() throws Exception {
  String dir=TestDirHelper.getTestDir().getAbsolutePath();
  Configuration conf=new Configuration(false);
  conf.set("server.services",StringUtils.join(",",Arrays.asList(GroupsService.class.getName())));
  Server server=new Server("server",dir,dir,dir,dir,conf);
  server.init();
  Groups groups=server.get(Groups.class);
  assertNotNull(groups);
  List<String> g=groups.getGroups(System.getProperty("user.name"));
  assertNotSame(g.size(),0);
  server.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestJob </h4><pre class="type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testUGICredentialsPropogation() throws Exception {
  Credentials creds=new Credentials();
  Token<?> token=mock(Token.class);
  Text tokenService=new Text("service");
  Text secretName=new Text("secret");
  byte secret[]=new byte[]{};
  creds.addToken(tokenService,token);
  creds.addSecretKey(secretName,secret);
  UserGroupInformation.getLoginUser().addCredentials(creds);
  JobConf jobConf=new JobConf();
  Job job=new Job(jobConf);
  assertSame(token,job.getCredentials().getToken(tokenService));
  assertSame(secret,job.getCredentials().getSecretKey(secretName));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.security.TestTokenCache </h4><pre class="type-7 type-10 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("deprecation") public void testBinaryCredentials() throws Exception {
  Path TEST_ROOT_DIR=new Path(System.getProperty("test.build.data","test/build/data"));
  String binaryTokenFile=FileSystem.getLocal(conf).makeQualified(new Path(TEST_ROOT_DIR,"tokenFile")).toUri().getPath();
  MockFileSystem fs1=createFileSystemForServiceName("service1");
  MockFileSystem fs2=createFileSystemForServiceName("service2");
  MockFileSystem fs3=createFileSystemForServiceName("service3");
  Credentials creds=new Credentials();
  Token<?> token1=fs1.getDelegationToken(renewer);
  Token<?> token2=fs2.getDelegationToken(renewer);
  creds.addToken(token1.getService(),token1);
  creds.addToken(token2.getService(),token2);
  conf.set(MRJobConfig.MAPREDUCE_JOB_CREDENTIALS_BINARY,binaryTokenFile);
  creds.writeTokenStorageFile(new Path(binaryTokenFile),conf);
  creds=new Credentials();
  Token<?> newerToken1=fs1.getDelegationToken(renewer);
  assertNotSame(newerToken1,token1);
  creds.addToken(newerToken1.getService(),newerToken1);
  checkToken(creds,newerToken1);
  TokenCache.obtainTokensForNamenodesInternal(fs1,creds,conf);
  checkToken(creds,newerToken1,token2);
  TokenCache.obtainTokensForNamenodesInternal(fs2,creds,conf);
  checkToken(creds,newerToken1,token2);
  TokenCache.obtainTokensForNamenodesInternal(fs3,creds,conf);
  Token<?> token3=creds.getToken(new Text(fs3.getCanonicalServiceName()));
  assertTrue(token3 != null);
  checkToken(creds,newerToken1,token2,token3);
  TokenCache.obtainTokensForNamenodesInternal(fs1,creds,conf);
  TokenCache.obtainTokensForNamenodesInternal(fs2,creds,conf);
  TokenCache.obtainTokensForNamenodesInternal(fs3,creds,conf);
  checkToken(creds,newerToken1,token2,token3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.TestMRJobs </h4><pre class="type-13 type-11 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=120000) public void testContainerRollingLog() throws IOException, InterruptedException, ClassNotFoundException {
  if (!(new File(MiniMRYarnCluster.APPJAR)).exists()) {
    LOG.info("MRAppJar " + MiniMRYarnCluster.APPJAR + " not found. Not running test.");
    return;
  }
  final SleepJob sleepJob=new SleepJob();
  final JobConf sleepConf=new JobConf(mrCluster.getConfig());
  sleepConf.set(MRJobConfig.MAP_LOG_LEVEL,Level.ALL.toString());
  final long userLogKb=4;
  sleepConf.setLong(MRJobConfig.TASK_USERLOG_LIMIT,userLogKb);
  sleepConf.setInt(MRJobConfig.TASK_LOG_BACKUPS,3);
  sleepConf.set(MRJobConfig.MR_AM_LOG_LEVEL,Level.ALL.toString());
  final long amLogKb=7;
  sleepConf.setLong(MRJobConfig.MR_AM_LOG_KB,amLogKb);
  sleepConf.setInt(MRJobConfig.MR_AM_LOG_BACKUPS,7);
  sleepJob.setConf(sleepConf);
  final Job job=sleepJob.createJob(1,0,1L,100,0L,0);
  job.setJarByClass(SleepJob.class);
  job.addFileToClassPath(APP_JAR);
  job.waitForCompletion(true);
  final JobId jobId=TypeConverter.toYarn(job.getJobID());
  final ApplicationId appID=jobId.getAppId();
  int pollElapsed=0;
  while (true) {
    Thread.sleep(1000);
    pollElapsed+=1000;
    if (TERMINAL_RM_APP_STATES.contains(mrCluster.getResourceManager().getRMContext().getRMApps().get(appID).getState())) {
      break;
    }
    if (pollElapsed >= 60000) {
      LOG.warn("application did not reach terminal state within 60 seconds");
      break;
    }
  }
  Assert.assertEquals(RMAppState.FINISHED,mrCluster.getResourceManager().getRMContext().getRMApps().get(appID).getState());
  final String appIdStr=appID.toString();
  final String appIdSuffix=appIdStr.substring("application_".length(),appIdStr.length());
  final String containerGlob="container_" + appIdSuffix + "_*_*";
  final String syslogGlob=appIdStr + Path.SEPARATOR + containerGlob+ Path.SEPARATOR+ TaskLog.LogName.SYSLOG;
  int numAppMasters=0;
  int numMapTasks=0;
  for (int i=0; i < NUM_NODE_MGRS; i++) {
    final Configuration nmConf=mrCluster.getNodeManager(i).getConfig();
    for (    String logDir : nmConf.getTrimmedStrings(YarnConfiguration.NM_LOG_DIRS)) {
      final Path absSyslogGlob=new Path(logDir + Path.SEPARATOR + syslogGlob);
      LOG.info("Checking for glob: " + absSyslogGlob);
      final FileStatus[] syslogs=localFs.globStatus(absSyslogGlob);
      for (      FileStatus slog : syslogs) {
        boolean foundAppMaster=job.isUber();
        final Path containerPathComponent=slog.getPath().getParent();
        if (!foundAppMaster) {
          final ContainerId cid=ConverterUtils.toContainerId(containerPathComponent.getName());
          foundAppMaster=(cid.getId() == 1);
        }
        final FileStatus[] sysSiblings=localFs.globStatus(new Path(containerPathComponent,TaskLog.LogName.SYSLOG + "*"));
        Arrays.sort(sysSiblings);
        if (foundAppMaster) {
          numAppMasters++;
        }
 else {
          numMapTasks++;
        }
        if (foundAppMaster) {
          Assert.assertSame("Unexpected number of AM sylog* files",sleepConf.getInt(MRJobConfig.MR_AM_LOG_BACKUPS,0) + 1,sysSiblings.length);
          Assert.assertTrue("AM syslog.1 length kb should be >= " + amLogKb,sysSiblings[1].getLen() >= amLogKb * 1024);
        }
 else {
          Assert.assertSame("Unexpected number of MR task sylog* files",sleepConf.getInt(MRJobConfig.TASK_LOG_BACKUPS,0) + 1,sysSiblings.length);
          Assert.assertTrue("MR syslog.1 length kb should be >= " + userLogKb,sysSiblings[1].getLen() >= userLogKb * 1024);
        }
      }
    }
  }
  Assert.assertEquals("No AppMaster log found!",1,numAppMasters);
  if (sleepConf.getBoolean(MRJobConfig.JOB_UBERTASK_ENABLE,false)) {
    Assert.assertEquals("MapTask log with uber found!",0,numMapTasks);
  }
 else {
    Assert.assertEquals("No MapTask log found!",1,numMapTasks);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.impl.TestMetricsSystemImpl </h4><pre class="type-7 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterDups(){
  MetricsSystem ms=new MetricsSystemImpl();
  TestSource ts1=new TestSource("ts1");
  TestSource ts2=new TestSource("ts2");
  ms.register("ts1","",ts1);
  MetricsSource s1=ms.getSource("ts1");
  assertNotNull(s1);
  ms.register("ts1","",ts2);
  MetricsSource s2=ms.getSource("ts1");
  assertNotNull(s2);
  assertNotSame(s1,s2);
  ms.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.impl.TestSinkQueue </h4><pre class="type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the consumer throwing exceptions
 * @throws Exception
 */
@Test public void testConsumerException() throws Exception {
  final SinkQueue<Integer> q=new SinkQueue<Integer>(1);
  final RuntimeException ex=new RuntimeException("expected");
  q.enqueue(1);
  try {
    q.consume(new Consumer<Integer>(){
      @Override public void consume(      Integer e){
        throw ex;
      }
    }
);
  }
 catch (  Exception expected) {
    assertSame("consumer exception",ex,expected);
  }
  assertEquals("queue size",1,q.size());
  assertEquals("element",1,(int)q.dequeue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.lib.TestInterns </h4><pre class="type-13 type-11 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testInfoOverflow(){
  MetricsInfo i0=info("m0","m desc");
  for (int i=0; i < MAX_INFO_NAMES + 1; ++i) {
    info("m" + i,"m desc");
    if (i < MAX_INFO_NAMES) {
      assertSame("m0 is still there",i0,info("m0","m desc"));
    }
  }
  assertNotSame("m0 is gone",i0,info("m0","m desc"));
  MetricsInfo i1=info("m1","m desc");
  for (int i=0; i < MAX_INFO_DESCS; ++i) {
    info("m1","m desc" + i);
    if (i < MAX_INFO_DESCS - 1) {
      assertSame("i1 is still there",i1,info("m1","m desc"));
    }
  }
  assertNotSame("i1 is gone",i1,info("m1","m desc"));
}

</code></pre>

<br>
<pre class="type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testInfo(){
  MetricsInfo info=info("m","m desc");
  assertSame("same info",info,info("m","m desc"));
}

</code></pre>

<br>
<pre class="type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testTag(){
  MetricsTag tag=tag("t","t desc","t value");
  assertSame("same tag",tag,tag("t","t desc","t value"));
}

</code></pre>

<br>
<pre class="type-13 type-11 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testTagOverflow(){
  MetricsTag t0=tag("t0","t desc","t value");
  for (int i=0; i < MAX_TAG_NAMES + 1; ++i) {
    tag("t" + i,"t desc","t value");
    if (i < MAX_TAG_NAMES) {
      assertSame("t0 still there",t0,tag("t0","t desc","t value"));
    }
  }
  assertNotSame("t0 is gone",t0,tag("t0","t desc","t value"));
  MetricsTag t1=tag("t1","t desc","t value");
  for (int i=0; i < MAX_TAG_VALUES; ++i) {
    tag("t1","t desc","t value" + i);
    if (i < MAX_TAG_VALUES - 1) {
      assertSame("t1 is still there",t1,tag("t1","t desc","t value"));
    }
  }
  assertNotSame("t1 is gone",t1,tag("t1","t desc","t value"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.lib.TestMetricsAnnotations </h4><pre class="type-9 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testHybrid(){
  HybridMetrics metrics=new HybridMetrics();
  MetricsSource source=MetricsAnnotations.makeSource(metrics);
  assertSame(metrics,source);
  metrics.C0.incr();
  MetricsRecordBuilder rb=getMetrics(source);
  MetricsCollector collector=rb.parent();
  verify(collector).addRecord("foo");
  verify(collector).addRecord("bar");
  verify(collector).addRecord(info("HybridMetrics","HybridMetrics"));
  verify(rb).setContext("foocontext");
  verify(rb).addCounter(info("C1","C1 desc"),1);
  verify(rb).setContext("barcontext");
  verify(rb).addGauge(info("G1","G1 desc"),1);
  verify(rb).add(tag(MsInfo.Context,"hybrid"));
  verify(rb).addCounter(info("C0","C0 desc"),1);
  verify(rb).addGauge(info("G0","G0"),0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.minikdc.TestMiniKdc </h4><pre class="type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testMiniKdcStart(){
  MiniKdc kdc=getKdc();
  Assert.assertNotSame(0,kdc.getPort());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.TestCredentials </h4><pre class="type-13 type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddTokensToUGI(){
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser("someone");
  Credentials creds=new Credentials();
  for (int i=0; i < service.length; i++) {
    creds.addToken(service[i],token[i]);
  }
  ugi.addCredentials(creds);
  creds=ugi.getCredentials();
  for (int i=0; i < service.length; i++) {
    assertSame(token[i],creds.getToken(service[i]));
  }
  assertEquals(service.length,creds.numberOfTokens());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.TestUserGroupInformation </h4><pre class="type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@SuppressWarnings("unchecked") @Test(timeout=30000) public <T extends TokenIdentifier>void testGetCreds() throws Exception {
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser("someone");
  Text service=new Text("service");
  Token<T> t1=mock(Token.class);
  when(t1.getService()).thenReturn(service);
  Token<T> t2=mock(Token.class);
  when(t2.getService()).thenReturn(new Text("service2"));
  Token<T> t3=mock(Token.class);
  when(t3.getService()).thenReturn(service);
  ugi.addToken(t1);
  ugi.addToken(t2);
  checkTokens(ugi,t1,t2);
  Credentials creds=ugi.getCredentials();
  creds.addToken(t3.getService(),t3);
  assertSame(t3,creds.getToken(service));
  checkTokens(ugi,t1,t2);
}

</code></pre>

<br>
<pre class="type-2 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test(timeout=30000) public <T extends TokenIdentifier>void testUGITokens() throws Exception {
  UserGroupInformation ugi=UserGroupInformation.createUserForTesting("TheDoctor",new String[]{"TheTARDIS"});
  Token<T> t1=mock(Token.class);
  when(t1.getService()).thenReturn(new Text("t1"));
  Token<T> t2=mock(Token.class);
  when(t2.getService()).thenReturn(new Text("t2"));
  Credentials creds=new Credentials();
  byte[] secretKey=new byte[]{};
  Text secretName=new Text("shhh");
  creds.addSecretKey(secretName,secretKey);
  ugi.addToken(t1);
  ugi.addToken(t2);
  ugi.addCredentials(creds);
  Collection<Token<? extends TokenIdentifier>> z=ugi.getTokens();
  assertTrue(z.contains(t1));
  assertTrue(z.contains(t2));
  assertEquals(2,z.size());
  Credentials ugiCreds=ugi.getCredentials();
  assertSame(secretKey,ugiCreds.getSecretKey(secretName));
  assertEquals(1,ugiCreds.numberOfSecretKeys());
  try {
    z.remove(t1);
    fail("Shouldn't be able to modify token collection from UGI");
  }
 catch (  UnsupportedOperationException uoe) {
  }
  Collection<Token<? extends TokenIdentifier>> otherSet=ugi.doAs(new PrivilegedExceptionAction<Collection<Token<?>>>(){
    @Override public Collection<Token<?>> run() throws IOException {
      return UserGroupInformation.getCurrentUser().getTokens();
    }
  }
);
  assertTrue(otherSet.contains(t1));
  assertTrue(otherSet.contains(t2));
}

</code></pre>

<br>
<pre class="type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@SuppressWarnings("unchecked") @Test(timeout=30000) public <T extends TokenIdentifier>void testAddNamedToken() throws Exception {
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser("someone");
  Token<T> t1=mock(Token.class);
  Text service1=new Text("t1");
  Text service2=new Text("t2");
  when(t1.getService()).thenReturn(service1);
  ugi.addToken(service1,t1);
  assertSame(t1,ugi.getCredentials().getToken(service1));
  ugi.addToken(service2,t1);
  assertSame(t1,ugi.getCredentials().getToken(service1));
  assertSame(t1,ugi.getCredentials().getToken(service2));
}

</code></pre>

<br>
<pre class="type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test(timeout=30000) public <T extends TokenIdentifier>void testGetCredsNotSame() throws Exception {
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser("someone");
  Credentials creds=ugi.getCredentials();
  assertNotSame(creds,ugi.getCredentials());
}

</code></pre>

<br>
<pre class="type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@SuppressWarnings("unchecked") @Test(timeout=30000) public <T extends TokenIdentifier>void testAddCreds() throws Exception {
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser("someone");
  Text service=new Text("service");
  Token<T> t1=mock(Token.class);
  when(t1.getService()).thenReturn(service);
  Token<T> t2=mock(Token.class);
  when(t2.getService()).thenReturn(new Text("service2"));
  byte[] secret=new byte[]{};
  Text secretKey=new Text("sshhh");
  Credentials creds=new Credentials();
  creds.addToken(t1.getService(),t1);
  creds.addToken(t2.getService(),t2);
  creds.addSecretKey(secretKey,secret);
  ugi.addCredentials(creds);
  checkTokens(ugi,t1,t2);
  assertSame(secret,ugi.getCredentials().getSecretKey(secretKey));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.ssl.TestSSLFactory </h4><pre class="type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnectionConfigurator() throws Exception {
  Configuration conf=createConfiguration(false,true);
  conf.set(SSLFactory.SSL_HOSTNAME_VERIFIER_KEY,"STRICT_IE6");
  SSLFactory sslFactory=new SSLFactory(SSLFactory.Mode.CLIENT,conf);
  try {
    sslFactory.init();
    HttpsURLConnection sslConn=(HttpsURLConnection)new URL("https://foo").openConnection();
    Assert.assertNotSame("STRICT_IE6",sslConn.getHostnameVerifier().toString());
    sslFactory.configure(sslConn);
    Assert.assertEquals("STRICT_IE6",sslConn.getHostnameVerifier().toString());
  }
  finally {
    sslFactory.destroy();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.service.TestGlobalStateChangeListener </h4><pre class="type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the {@link BreakableStateChangeListener} is picking up
 * the state changes and that its last event field is as expected.
 */
@Test public void testEventHistory(){
  register();
  BreakableService service=new BreakableService();
  assertListenerState(listener,Service.STATE.NOTINITED);
  assertEquals(0,listener.getEventCount());
  service.init(new Configuration());
  assertListenerState(listener,Service.STATE.INITED);
  assertSame(service,listener.getLastService());
  assertListenerEventCount(listener,1);
  service.start();
  assertListenerState(listener,Service.STATE.STARTED);
  assertListenerEventCount(listener,2);
  service.stop();
  assertListenerState(listener,Service.STATE.STOPPED);
  assertListenerEventCount(listener,3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.TestOptionsParser </h4><pre class="type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToString(){
  DistCpOptions option=new DistCpOptions(new Path("abc"),new Path("xyz"));
  String val="DistCpOptions{atomicCommit=false, syncFolder=false, deleteMissing=false, " + "ignoreFailures=false, maxMaps=20, sslConfigurationFile='null', copyStrategy='uniformsize', " + "sourceFileListing=abc, sourcePaths=null, targetPath=xyz, targetPathExists=true, "+ "preserveRawXattrs=false}";
  Assert.assertEquals(val,option.toString());
  Assert.assertNotSame(DistCpOptionSwitch.ATOMIC_COMMIT.toString(),DistCpOptionSwitch.ATOMIC_COMMIT.name());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestDirectBufferPool </h4><pre class="type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBuffersAreReset(){
  ByteBuffer a=pool.getBuffer(100);
  a.putInt(0xdeadbeef);
  assertEquals(96,a.remaining());
  pool.returnBuffer(a);
  ByteBuffer b=pool.getBuffer(100);
  assertSame(a,b);
  assertEquals(100,a.remaining());
  pool.returnBuffer(b);
}

</code></pre>

<br>
<pre class="type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasics(){
  ByteBuffer a=pool.getBuffer(100);
  assertEquals(100,a.capacity());
  assertEquals(100,a.remaining());
  pool.returnBuffer(a);
  ByteBuffer b=pool.getBuffer(100);
  assertSame(a,b);
  ByteBuffer c=pool.getBuffer(100);
  assertNotSame(b,c);
  pool.returnBuffer(b);
  pool.returnBuffer(c);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestStringInterner </h4><pre class="type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
"></span><br>
/** 
 * Test the same strong reference is returned for any 
 * of string instances that are equal to each other.
 */
@Test public void testStrongIntern(){
  String strongInternLiteralABC=strongIntern("ABC");
  String strongInternSubstringABC=strongIntern("ABCDE".substring(0,3));
  String strongInternHeapABC=strongIntern(new String("ABC"));
  assertSame(strongInternLiteralABC,strongInternSubstringABC);
  assertSame(strongInternLiteralABC,strongInternHeapABC);
  assertSame(strongInternSubstringABC,strongInternHeapABC);
}

</code></pre>

<br>
<pre class="type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
"></span><br>
/** 
 * Test the same weak reference is returned for any 
 * of string instances that are equal to each other.
 */
@Test public void testWeakIntern(){
  String weakInternLiteralABC=weakIntern("ABC");
  String weakInternSubstringABC=weakIntern("ABCDE".substring(0,3));
  String weakInternHeapABC=weakIntern(new String("ABC"));
  assertSame(weakInternLiteralABC,weakInternSubstringABC);
  assertSame(weakInternLiteralABC,weakInternHeapABC);
  assertSame(weakInternSubstringABC,weakInternHeapABC);
}

</code></pre>

<br>
<pre class="type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
"></span><br>
/** 
 * Test different references are returned for any of string 
 * instances that are equal to each other but not interned.
 */
@Test public void testNoIntern(){
  String literalABC="ABC";
  String substringABC="ABCDE".substring(0,3);
  String heapABC=new String("ABC");
  assertNotSame(literalABC,substringABC);
  assertNotSame(literalABC,heapABC);
  assertNotSame(substringABC,heapABC);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.TestYarnUncaughtExceptionHandler </h4><pre class="type-9 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
/** 
 * <p>
 * Throw {@code Error} inside thread and
 * check {@code YarnUncaughtExceptionHandler} instance
 * <p>
 * Used {@code ExitUtil} class to avoid jvm exit through{@code System.exit(-1) }
 * @throws InterruptedException
 */
@Test public void testUncaughtExceptionHandlerWithError() throws InterruptedException {
  ExitUtil.disableSystemExit();
  final YarnUncaughtExceptionHandler spyErrorHandler=spy(exHandler);
  final java.lang.Error error=new java.lang.Error("test-error");
  final Thread errorThread=new Thread(new Runnable(){
    @Override public void run(){
      throw error;
    }
  }
);
  errorThread.setUncaughtExceptionHandler(spyErrorHandler);
  assertSame(spyErrorHandler,errorThread.getUncaughtExceptionHandler());
  errorThread.start();
  errorThread.join();
  verify(spyErrorHandler).uncaughtException(errorThread,error);
}

</code></pre>

<br>
<pre class="type-9 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
/** 
 * Throw {@code YarnRuntimeException} inside thread and
 * check {@code YarnUncaughtExceptionHandler} instance
 * @throws InterruptedException
 */
@Test public void testUncaughtExceptionHandlerWithRuntimeException() throws InterruptedException {
  final YarnUncaughtExceptionHandler spyYarnHandler=spy(exHandler);
  final YarnRuntimeException yarnException=new YarnRuntimeException("test-yarn-runtime-exception");
  final Thread yarnThread=new Thread(new Runnable(){
    @Override public void run(){
      throw yarnException;
    }
  }
);
  yarnThread.setUncaughtExceptionHandler(spyYarnHandler);
  assertSame(spyYarnHandler,yarnThread.getUncaughtExceptionHandler());
  yarnThread.start();
  yarnThread.join();
  verify(spyYarnHandler).uncaughtException(yarnThread,yarnException);
}

</code></pre>

<br>
<pre class="type-9 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
/** 
 * <p>
 * Throw {@code OutOfMemoryError} inside thread and
 * check {@code YarnUncaughtExceptionHandler} instance
 * <p>
 * Used {@code ExitUtil} class to avoid jvm exit through{@code Runtime.getRuntime().halt(-1)}
 * @throws InterruptedException
 */
@Test public void testUncaughtExceptionHandlerWithOutOfMemoryError() throws InterruptedException {
  ExitUtil.disableSystemHalt();
  final YarnUncaughtExceptionHandler spyOomHandler=spy(exHandler);
  final OutOfMemoryError oomError=new OutOfMemoryError("out-of-memory-error");
  final Thread oomThread=new Thread(new Runnable(){
    @Override public void run(){
      throw oomError;
    }
  }
);
  oomThread.setUncaughtExceptionHandler(spyOomHandler);
  assertSame(spyOomHandler,oomThread.getUncaughtExceptionHandler());
  oomThread.start();
  oomThread.join();
  verify(spyOomHandler).uncaughtException(oomThread,oomError);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.api.TestApplicatonReport </h4><pre class="type-9 type-7 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationReport(){
  long timestamp=System.currentTimeMillis();
  ApplicationReport appReport1=createApplicationReport(1,1,timestamp);
  ApplicationReport appReport2=createApplicationReport(1,1,timestamp);
  ApplicationReport appReport3=createApplicationReport(1,1,timestamp);
  Assert.assertEquals(appReport1,appReport2);
  Assert.assertEquals(appReport2,appReport3);
  appReport1.setApplicationId(null);
  Assert.assertNull(appReport1.getApplicationId());
  Assert.assertNotSame(appReport1,appReport2);
  appReport2.setCurrentApplicationAttemptId(null);
  Assert.assertNull(appReport2.getCurrentApplicationAttemptId());
  Assert.assertNotSame(appReport2,appReport3);
  Assert.assertNull(appReport1.getAMRMToken());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.TestYarnApiClasses </h4><pre class="type-9 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test Resource request.
 * Test hashCode, equals and compare.
 */
@Test public void testResourceRequest(){
  Resource resource=recordFactory.newRecordInstance(Resource.class);
  Priority priority=recordFactory.newRecordInstance(Priority.class);
  ResourceRequest original=ResourceRequest.newInstance(priority,"localhost",resource,2);
  ResourceRequest copy=ResourceRequest.newInstance(priority,"localhost",resource,2);
  assertTrue(original.equals(copy));
  assertEquals(0,original.compareTo(copy));
  assertTrue(original.hashCode() == copy.hashCode());
  copy.setNumContainers(1);
  assertFalse(original.equals(copy));
  assertNotSame(0,original.compareTo(copy));
  assertFalse(original.hashCode() == copy.hashCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.api.impl.TestAMRMClient </h4><pre class="type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test(timeout=60000) public void testAMRMClient() throws YarnException, IOException {
  AMRMClient<ContainerRequest> amClient=null;
  try {
    amClient=AMRMClient.<ContainerRequest>createAMRMClient();
    amClient.setNMTokenCache(new NMTokenCache());
    Assert.assertNotSame(NMTokenCache.getSingleton(),amClient.getNMTokenCache());
    amClient.init(conf);
    amClient.start();
    amClient.registerApplicationMaster("Host",10000,"");
    testAllocation((AMRMClientImpl<ContainerRequest>)amClient);
    amClient.unregisterApplicationMaster(FinalApplicationStatus.SUCCEEDED,null,null);
  }
  finally {
    if (amClient != null && amClient.getServiceState() == STATE.STARTED) {
      amClient.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.cli.TestYarnCLI </h4><pre class="type-2 type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKillApplication() throws Exception {
  ApplicationCLI cli=createAndGetAppCLI();
  ApplicationId applicationId=ApplicationId.newInstance(1234,5);
  ApplicationReport newApplicationReport2=ApplicationReport.newInstance(applicationId,ApplicationAttemptId.newInstance(applicationId,1),"user","queue","appname","host",124,null,YarnApplicationState.FINISHED,"diagnostics","url",0,0,FinalApplicationStatus.SUCCEEDED,null,"N/A",0.53789f,"YARN",null);
  when(client.getApplicationReport(any(ApplicationId.class))).thenReturn(newApplicationReport2);
  int result=cli.run(new String[]{"application","-kill",applicationId.toString()});
  assertEquals(0,result);
  verify(client,times(0)).killApplication(any(ApplicationId.class));
  verify(sysOut).println("Application " + applicationId + " has already finished ");
  ApplicationReport newApplicationReport=ApplicationReport.newInstance(applicationId,ApplicationAttemptId.newInstance(applicationId,1),"user","queue","appname","host",124,null,YarnApplicationState.RUNNING,"diagnostics","url",0,0,FinalApplicationStatus.SUCCEEDED,null,"N/A",0.53789f,"YARN",null);
  when(client.getApplicationReport(any(ApplicationId.class))).thenReturn(newApplicationReport);
  result=cli.run(new String[]{"application","-kill",applicationId.toString()});
  assertEquals(0,result);
  verify(client).killApplication(any(ApplicationId.class));
  verify(sysOut).println("Killing application application_1234_0005");
  doThrow(new ApplicationNotFoundException("Application with id '" + applicationId + "' doesn't exist in RM.")).when(client).getApplicationReport(applicationId);
  cli=createAndGetAppCLI();
  try {
    int exitCode=cli.run(new String[]{"application","-kill",applicationId.toString()});
    verify(sysOut).println("Application with id '" + applicationId + "' doesn't exist in RM.");
    Assert.assertNotSame("should return non-zero exit code.",0,exitCode);
  }
 catch (  ApplicationNotFoundException appEx) {
    Assert.fail("application -kill should not throw" + "ApplicationNotFoundException. " + appEx);
  }
catch (  Exception e) {
    Assert.fail("Unexpected exception: " + e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.conf.TestYarnConfiguration </h4><pre class="type-9 type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRMWebUrlSpecified() throws Exception {
  YarnConfiguration conf=new YarnConfiguration();
  conf.set(YarnConfiguration.RM_WEBAPP_ADDRESS,"fortesting:24543");
  conf.set(YarnConfiguration.RM_ADDRESS,"rmtesting:9999");
  String rmWebUrl=WebAppUtils.getRMWebAppURLWithScheme(conf);
  String[] parts=rmWebUrl.split(":");
  Assert.assertEquals("RM Web URL Port is incrrect",24543,Integer.valueOf(parts[parts.length - 1]).intValue());
  Assert.assertNotSame("RM Web Url not resolved correctly. Should not be rmtesting","http://rmtesting:24543",rmWebUrl);
}

</code></pre>

<br>
<pre class="type-9 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testDefaultRMWebUrl() throws Exception {
  YarnConfiguration conf=new YarnConfiguration();
  String rmWebUrl=WebAppUtils.getRMWebAppURLWithScheme(conf);
  Assert.assertNotSame("RM Web Url is not correct","http://0.0.0.0:8088",rmWebUrl);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.TestDefaultContainerExecutor </h4><pre class="type-9 type-7 type-10 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerLaunchError() throws IOException, InterruptedException {
  Path localDir=new Path(BASE_TMP_PATH,"localDir");
  List<String> localDirs=new ArrayList<String>();
  localDirs.add(localDir.toString());
  List<String> logDirs=new ArrayList<String>();
  Path logDir=new Path(BASE_TMP_PATH,"logDir");
  logDirs.add(logDir.toString());
  Configuration conf=new Configuration();
  conf.set(CommonConfigurationKeys.FS_PERMISSIONS_UMASK_KEY,"077");
  conf.set(YarnConfiguration.NM_LOCAL_DIRS,localDir.toString());
  conf.set(YarnConfiguration.NM_LOG_DIRS,logDir.toString());
  FileContext lfs=FileContext.getLocalFSFileContext(conf);
  DefaultContainerExecutor mockExec=spy(new DefaultContainerExecutor(lfs));
  mockExec.setConf(conf);
  doAnswer(new Answer(){
    @Override public Object answer(    InvocationOnMock invocationOnMock) throws Throwable {
      String diagnostics=(String)invocationOnMock.getArguments()[0];
      assertTrue("Invalid Diagnostics message: " + diagnostics,diagnostics.contains("No such file or directory"));
      return null;
    }
  }
).when(mockExec).logOutput(any(String.class));
  String appSubmitter="nobody";
  String appId="APP_ID";
  String containerId="CONTAINER_ID";
  Container container=mock(Container.class);
  ContainerId cId=mock(ContainerId.class);
  ContainerLaunchContext context=mock(ContainerLaunchContext.class);
  HashMap<String,String> env=new HashMap<String,String>();
  when(container.getContainerId()).thenReturn(cId);
  when(container.getLaunchContext()).thenReturn(context);
  try {
    doAnswer(new Answer(){
      @Override public Object answer(      InvocationOnMock invocationOnMock) throws Throwable {
        ContainerDiagnosticsUpdateEvent event=(ContainerDiagnosticsUpdateEvent)invocationOnMock.getArguments()[0];
        assertTrue("Invalid Diagnostics message: " + event.getDiagnosticsUpdate(),event.getDiagnosticsUpdate().contains("No such file or directory"));
        return null;
      }
    }
).when(container).handle(any(ContainerDiagnosticsUpdateEvent.class));
    when(cId.toString()).thenReturn(containerId);
    when(cId.getApplicationAttemptId()).thenReturn(ApplicationAttemptId.newInstance(ApplicationId.newInstance(0,1),0));
    when(context.getEnvironment()).thenReturn(env);
    mockExec.createUserLocalDirs(localDirs,appSubmitter);
    mockExec.createUserCacheDirs(localDirs,appSubmitter);
    mockExec.createAppDirs(localDirs,appSubmitter,appId);
    mockExec.createAppLogDirs(appId,logDirs);
    Path scriptPath=new Path("file:///bin/echo");
    Path tokensPath=new Path("file:///dev/null");
    Path workDir=localDir;
    Path pidFile=new Path(workDir,"pid.txt");
    mockExec.init();
    mockExec.activateContainer(cId,pidFile);
    int ret=mockExec.launchContainer(container,scriptPath,tokensPath,appSubmitter,appId,workDir,localDirs,localDirs);
    Assert.assertNotSame(0,ret);
  }
  finally {
    mockExec.deleteAsUser(appSubmitter,localDir);
    mockExec.deleteAsUser(appSubmitter,logDir);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.TestLinuxContainerExecutorWithMocks </h4><pre class="type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerLaunchError() throws IOException {
  File f=new File("./src/test/resources/mock-container-executer-with-error");
  if (!FileUtil.canExecute(f)) {
    FileUtil.setExecutable(f,true);
  }
  String executorPath=f.getAbsolutePath();
  Configuration conf=new Configuration();
  conf.set(YarnConfiguration.NM_LINUX_CONTAINER_EXECUTOR_PATH,executorPath);
  conf.set(YarnConfiguration.NM_LOCAL_DIRS,"file:///bin/echo");
  conf.set(YarnConfiguration.NM_LOG_DIRS,"file:///dev/null");
  mockExec=spy(new LinuxContainerExecutor());
  doAnswer(new Answer(){
    @Override public Object answer(    InvocationOnMock invocationOnMock) throws Throwable {
      String diagnostics=(String)invocationOnMock.getArguments()[0];
      assertTrue("Invalid Diagnostics message: " + diagnostics,diagnostics.contains("badcommand"));
      return null;
    }
  }
).when(mockExec).logOutput(any(String.class));
  dirsHandler=new LocalDirsHandlerService();
  dirsHandler.init(conf);
  mockExec.setConf(conf);
  String appSubmitter="nobody";
  String cmd=String.valueOf(LinuxContainerExecutor.Commands.LAUNCH_CONTAINER.getValue());
  String appId="APP_ID";
  String containerId="CONTAINER_ID";
  Container container=mock(Container.class);
  ContainerId cId=mock(ContainerId.class);
  ContainerLaunchContext context=mock(ContainerLaunchContext.class);
  HashMap<String,String> env=new HashMap<String,String>();
  when(container.getContainerId()).thenReturn(cId);
  when(container.getLaunchContext()).thenReturn(context);
  doAnswer(new Answer(){
    @Override public Object answer(    InvocationOnMock invocationOnMock) throws Throwable {
      ContainerDiagnosticsUpdateEvent event=(ContainerDiagnosticsUpdateEvent)invocationOnMock.getArguments()[0];
      assertTrue("Invalid Diagnostics message: " + event.getDiagnosticsUpdate(),event.getDiagnosticsUpdate().contains("badcommand"));
      return null;
    }
  }
).when(container).handle(any(ContainerDiagnosticsUpdateEvent.class));
  when(cId.toString()).thenReturn(containerId);
  when(context.getEnvironment()).thenReturn(env);
  Path scriptPath=new Path("file:///bin/echo");
  Path tokensPath=new Path("file:///dev/null");
  Path workDir=new Path("/tmp");
  Path pidFile=new Path(workDir,"pid.txt");
  mockExec.activateContainer(cId,pidFile);
  int ret=mockExec.launchContainer(container,scriptPath,tokensPath,appSubmitter,appId,workDir,dirsHandler.getLocalDirs(),dirsHandler.getLogDirs());
  Assert.assertNotSame(0,ret);
  assertEquals(Arrays.asList(YarnConfiguration.DEFAULT_NM_NONSECURE_MODE_LOCAL_USER,appSubmitter,cmd,appId,containerId,workDir.toString(),"/bin/echo","/dev/null",pidFile.toString(),StringUtils.join(",",dirsHandler.getLocalDirs()),StringUtils.join(",",dirsHandler.getLogDirs()),"cgroups=none"),readMockParams());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.TestLocalResourcesTrackerImpl </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=100000) @SuppressWarnings("unchecked") public void testHierarchicalLocalCacheDirectories(){
  String user="testuser";
  DrainDispatcher dispatcher=null;
  try {
    Configuration conf=new Configuration();
    conf.set(YarnConfiguration.NM_LOCAL_CACHE_MAX_FILES_PER_DIRECTORY,"37");
    dispatcher=createDispatcher(conf);
    EventHandler<LocalizerEvent> localizerEventHandler=mock(EventHandler.class);
    EventHandler<LocalizerEvent> containerEventHandler=mock(EventHandler.class);
    dispatcher.register(LocalizerEventType.class,localizerEventHandler);
    dispatcher.register(ContainerEventType.class,containerEventHandler);
    DeletionService mockDelService=mock(DeletionService.class);
    ConcurrentMap<LocalResourceRequest,LocalizedResource> localrsrc=new ConcurrentHashMap<LocalResourceRequest,LocalizedResource>();
    LocalResourcesTracker tracker=new LocalResourcesTrackerImpl(user,null,dispatcher,localrsrc,true,conf,new NMNullStateStoreService());
    Path localDir=new Path("/tmp");
    ContainerId cId1=BuilderUtils.newContainerId(1,1,1,1);
    LocalResourceRequest lr1=createLocalResourceRequest(user,1,1,LocalResourceVisibility.PUBLIC);
    LocalizerContext lc1=new LocalizerContext(user,cId1,null);
    ResourceEvent reqEvent1=new ResourceRequestEvent(lr1,LocalResourceVisibility.PUBLIC,lc1);
    tracker.handle(reqEvent1);
    Path hierarchicalPath1=tracker.getPathForLocalization(lr1,localDir).getParent();
    ResourceLocalizedEvent rle1=new ResourceLocalizedEvent(lr1,new Path(hierarchicalPath1.toUri().toString() + Path.SEPARATOR + "file1"),120);
    tracker.handle(rle1);
    LocalResourceRequest lr2=createLocalResourceRequest(user,3,3,LocalResourceVisibility.PUBLIC);
    ResourceEvent reqEvent2=new ResourceRequestEvent(lr2,LocalResourceVisibility.PUBLIC,lc1);
    tracker.handle(reqEvent2);
    Path hierarchicalPath2=tracker.getPathForLocalization(lr2,localDir).getParent();
    ResourceFailedLocalizationEvent rfe2=new ResourceFailedLocalizationEvent(lr2,new Exception("Test").toString());
    tracker.handle(rfe2);
    Assert.assertNotSame(hierarchicalPath1,hierarchicalPath2);
    LocalResourceRequest lr3=createLocalResourceRequest(user,2,2,LocalResourceVisibility.PUBLIC);
    ResourceEvent reqEvent3=new ResourceRequestEvent(lr3,LocalResourceVisibility.PUBLIC,lc1);
    tracker.handle(reqEvent3);
    Path hierarchicalPath3=tracker.getPathForLocalization(lr3,localDir).getParent();
    ResourceLocalizedEvent rle3=new ResourceLocalizedEvent(lr3,new Path(hierarchicalPath3.toUri().toString() + Path.SEPARATOR + "file3"),120);
    tracker.handle(rle3);
    Assert.assertEquals(hierarchicalPath3.toUri().toString(),hierarchicalPath1.toUri().toString() + Path.SEPARATOR + "0");
    ResourceEvent relEvent1=new ResourceReleaseEvent(lr1,cId1);
    tracker.handle(relEvent1);
    int resources=0;
    Iterator<LocalizedResource> iter=tracker.iterator();
    while (iter.hasNext()) {
      iter.next();
      resources++;
    }
    Assert.assertEquals(2,resources);
    iter=tracker.iterator();
    while (iter.hasNext()) {
      LocalizedResource rsrc=iter.next();
      if (rsrc.getRefCount() == 0) {
        Assert.assertTrue(tracker.remove(rsrc,mockDelService));
        resources--;
      }
    }
    Assert.assertEquals(1,resources);
  }
  finally {
    if (dispatcher != null) {
      dispatcher.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestClientRMService </h4><pre class="type-9 type-7 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClusterNodes() throws Exception {
  MockRM rm=new MockRM(){
    protected ClientRMService createClientRMService(){
      return new ClientRMService(this.rmContext,scheduler,this.rmAppManager,this.applicationACLsManager,this.queueACLsManager,this.getRMContext().getRMDelegationTokenSecretManager());
    }
  }
;
  rm.start();
  MockNM node=rm.registerNode("host1:1234",1024);
  rm.sendNodeStarted(node);
  node.nodeHeartbeat(true);
  MockNM lostNode=rm.registerNode("host2:1235",1024);
  rm.sendNodeStarted(lostNode);
  lostNode.nodeHeartbeat(true);
  rm.NMwaitForState(lostNode.getNodeId(),NodeState.RUNNING);
  rm.sendNodeLost(lostNode);
  Configuration conf=new Configuration();
  YarnRPC rpc=YarnRPC.create(conf);
  InetSocketAddress rmAddress=rm.getClientRMService().getBindAddress();
  LOG.info("Connecting to ResourceManager at " + rmAddress);
  ApplicationClientProtocol client=(ApplicationClientProtocol)rpc.getProxy(ApplicationClientProtocol.class,rmAddress,conf);
  GetClusterNodesRequest request=GetClusterNodesRequest.newInstance(EnumSet.of(NodeState.RUNNING));
  List<NodeReport> nodeReports=client.getClusterNodes(request).getNodeReports();
  Assert.assertEquals(1,nodeReports.size());
  Assert.assertNotSame("Node is expected to be healthy!",NodeState.UNHEALTHY,nodeReports.get(0).getNodeState());
  node.nodeHeartbeat(false);
  nodeReports=client.getClusterNodes(request).getNodeReports();
  Assert.assertEquals("Unhealthy nodes should not show up by default",0,nodeReports.size());
  request=GetClusterNodesRequest.newInstance(EnumSet.of(NodeState.UNHEALTHY));
  nodeReports=client.getClusterNodes(request).getNodeReports();
  Assert.assertEquals(1,nodeReports.size());
  Assert.assertEquals("Node is expected to be unhealthy!",NodeState.UNHEALTHY,nodeReports.get(0).getNodeState());
  rm.registerNode("host3:1236",1024);
  request=GetClusterNodesRequest.newInstance(EnumSet.allOf(NodeState.class));
  nodeReports=client.getClusterNodes(request).getNodeReports();
  Assert.assertEquals(3,nodeReports.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.TestFairScheduler </h4><pre class="type-9 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoveRunnableApp() throws Exception {
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  QueueManager queueMgr=scheduler.getQueueManager();
  FSLeafQueue oldQueue=queueMgr.getLeafQueue("queue1",true);
  FSLeafQueue targetQueue=queueMgr.getLeafQueue("queue2",true);
  ApplicationAttemptId appAttId=createSchedulingRequest(1024,1,"queue1","user1",3);
  ApplicationId appId=appAttId.getApplicationId();
  RMNode node=MockNodes.newNodeInfo(1,Resources.createResource(1024));
  NodeAddedSchedulerEvent nodeEvent=new NodeAddedSchedulerEvent(node);
  NodeUpdateSchedulerEvent updateEvent=new NodeUpdateSchedulerEvent(node);
  scheduler.handle(nodeEvent);
  scheduler.handle(updateEvent);
  assertEquals(Resource.newInstance(1024,1),oldQueue.getResourceUsage());
  scheduler.update();
  assertEquals(Resource.newInstance(3072,3),oldQueue.getDemand());
  scheduler.moveApplication(appId,"queue2");
  FSAppAttempt app=scheduler.getSchedulerApp(appAttId);
  assertSame(targetQueue,app.getQueue());
  assertFalse(oldQueue.getRunnableAppSchedulables().contains(app));
  assertTrue(targetQueue.getRunnableAppSchedulables().contains(app));
  assertEquals(Resource.newInstance(0,0),oldQueue.getResourceUsage());
  assertEquals(Resource.newInstance(1024,1),targetQueue.getResourceUsage());
  assertEquals(0,oldQueue.getNumRunnableApps());
  assertEquals(1,targetQueue.getNumRunnableApps());
  assertEquals(1,queueMgr.getRootQueue().getNumRunnableApps());
  scheduler.update();
  assertEquals(Resource.newInstance(0,0),oldQueue.getDemand());
  assertEquals(Resource.newInstance(3072,3),targetQueue.getDemand());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.util.TestFSDownload </h4><pre class="type-10 type-15 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testDownloadPublicWithStatCache() throws IOException, URISyntaxException, InterruptedException, ExecutionException {
  final Configuration conf=new Configuration();
  FileContext files=FileContext.getLocalFSFileContext(conf);
  Path basedir=files.makeQualified(new Path("target",TestFSDownload.class.getSimpleName()));
  FileSystem f=basedir.getFileSystem(conf);
  assumeTrue(FSDownload.ancestorsHaveExecutePermissions(f,basedir,null));
  files.mkdir(basedir,null,true);
  conf.setStrings(TestFSDownload.class.getName(),basedir.toString());
  int size=512;
  final ConcurrentMap<Path,AtomicInteger> counts=new ConcurrentHashMap<Path,AtomicInteger>();
  final CacheLoader<Path,Future<FileStatus>> loader=FSDownload.createStatusCacheLoader(conf);
  final LoadingCache<Path,Future<FileStatus>> statCache=CacheBuilder.newBuilder().build(new CacheLoader<Path,Future<FileStatus>>(){
    public Future<FileStatus> load(    Path path) throws Exception {
      AtomicInteger count=counts.get(path);
      if (count == null) {
        count=new AtomicInteger(0);
        AtomicInteger existing=counts.putIfAbsent(path,count);
        if (existing != null) {
          count=existing;
        }
      }
      count.incrementAndGet();
      return loader.load(path);
    }
  }
);
  final int fileCount=3;
  List<Callable<Boolean>> tasks=new ArrayList<Callable<Boolean>>();
  for (int i=0; i < fileCount; i++) {
    Random rand=new Random();
    long sharedSeed=rand.nextLong();
    rand.setSeed(sharedSeed);
    System.out.println("SEED: " + sharedSeed);
    final Path path=new Path(basedir,"test-file-" + i);
    createFile(files,path,size,rand);
    final FileSystem fs=path.getFileSystem(conf);
    final FileStatus sStat=fs.getFileStatus(path);
    tasks.add(new Callable<Boolean>(){
      public Boolean call() throws IOException {
        return FSDownload.isPublic(fs,path,sStat,statCache);
      }
    }
);
  }
  ExecutorService exec=Executors.newFixedThreadPool(fileCount);
  try {
    List<Future<Boolean>> futures=exec.invokeAll(tasks);
    for (    Future<Boolean> future : futures) {
      assertTrue(future.get());
    }
    for (    AtomicInteger count : counts.values()) {
      assertSame(count.get(),1);
    }
  }
  finally {
    exec.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.webapp.test.TestWebAppTests </h4><pre class="type-9 type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testCreateInjector() throws Exception {
  Bar bar=new Bar();
  Injector injector=WebAppTests.createMockInjector(Foo.class,bar);
  logInstances(injector.getInstance(HttpServletRequest.class),injector.getInstance(HttpServletResponse.class),injector.getInstance(HttpServletResponse.class).getWriter());
  assertSame(bar,injector.getInstance(Foo.class));
}

</code></pre>

<br>
<pre class="type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testInstances() throws Exception {
  Injector injector=WebAppTests.createMockInjector(this);
  HttpServletRequest req=injector.getInstance(HttpServletRequest.class);
  HttpServletResponse res=injector.getInstance(HttpServletResponse.class);
  String val=req.getParameter("foo");
  PrintWriter out=res.getWriter();
  out.println("Hello world!");
  logInstances(req,res,out);
  assertSame(req,injector.getInstance(HttpServletRequest.class));
  assertSame(res,injector.getInstance(HttpServletResponse.class));
  assertSame(this,injector.getInstance(TestWebAppTests.class));
  verify(req).getParameter("foo");
  verify(res).getWriter();
  verify(out).println("Hello world!");
}

</code></pre>

<br>
<pre class="type-9 type-7 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testCreateInjector2(){
  final FooBar foobar=new FooBar();
  Bar bar=new Bar();
  Injector injector=WebAppTests.createMockInjector(Foo.class,bar,new AbstractModule(){
    @Override protected void configure(){
      bind(Bar.class).toInstance(foobar);
    }
  }
);
  assertNotSame(bar,injector.getInstance(Bar.class));
  assertSame(foobar,injector.getInstance(Bar.class));
}

</code></pre>

<br>
<pre class="type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testRequestScope(){
  Injector injector=WebAppTests.createMockInjector(this);
  assertSame(injector.getInstance(ScopeTest.class),injector.getInstance(ScopeTest.class));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
