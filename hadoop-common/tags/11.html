<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.TestRefreshCallQueue </h4><pre class="type-11 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  mockQueueConstructions=0;
  mockQueuePuts=0;
  int portRetries=5;
  int nnPort;
  for (; portRetries > 0; --portRetries) {
    nnPort=30000 + rand.nextInt(30000);
    config=new Configuration();
    callQueueConfigKey="ipc." + nnPort + ".callqueue.impl";
    config.setClass(callQueueConfigKey,MockCallQueue.class,BlockingQueue.class);
    config.set("hadoop.security.authorization","true");
    FileSystem.setDefaultUri(config,"hdfs://localhost:" + nnPort);
    fs=FileSystem.get(config);
    try {
      cluster=new MiniDFSCluster.Builder(config).nameNodePort(nnPort).build();
      cluster.waitActive();
      break;
    }
 catch (    BindException be) {
    }
  }
  if (portRetries == 0) {
    fail("Failed to pick an ephemeral port for the NameNode RPC server.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.conf.TestConfServlet </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteXml() throws Exception {
  StringWriter sw=new StringWriter();
  ConfServlet.writeResponse(getTestConf(),sw,"xml");
  String xml=sw.toString();
  DocumentBuilderFactory docBuilderFactory=DocumentBuilderFactory.newInstance();
  DocumentBuilder builder=docBuilderFactory.newDocumentBuilder();
  Document doc=builder.parse(new InputSource(new StringReader(xml)));
  NodeList nameNodes=doc.getElementsByTagName("name");
  boolean foundSetting=false;
  for (int i=0; i < nameNodes.getLength(); i++) {
    Node nameNode=nameNodes.item(i);
    String key=nameNode.getTextContent();
    System.err.println("xml key: " + key);
    if (TEST_KEY.equals(key)) {
      foundSetting=true;
      Element propertyElem=(Element)nameNode.getParentNode();
      String val=propertyElem.getElementsByTagName("value").item(0).getTextContent();
      assertEquals(TEST_VAL,val);
    }
  }
  assertTrue(foundSetting);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.conf.TestConfigurationDeprecation </h4><pre class="type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIteratorWithDeprecatedKeys(){
  Configuration conf=new Configuration();
  Configuration.addDeprecation("dK",new String[]{"nK"});
  conf.set("k","v");
  conf.set("dK","V");
  assertEquals("V",conf.get("dK"));
  assertEquals("V",conf.get("nK"));
  conf.set("nK","VV");
  assertEquals("VV",conf.get("dK"));
  assertEquals("VV",conf.get("nK"));
  boolean kFound=false;
  boolean dKFound=false;
  boolean nKFound=false;
  for (  Map.Entry<String,String> entry : conf) {
    if (entry.getKey().equals("k")) {
      assertEquals("v",entry.getValue());
      kFound=true;
    }
    if (entry.getKey().equals("dK")) {
      assertEquals("VV",entry.getValue());
      dKFound=true;
    }
    if (entry.getKey().equals("nK")) {
      assertEquals("VV",entry.getValue());
      nKFound=true;
    }
  }
  assertTrue("regular Key not found",kFound);
  assertTrue("deprecated Key not found",dKFound);
  assertTrue("new Key not found",nKFound);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.conf.TestDeprecatedKeys </h4><pre class="type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIteratorWithDeprecatedKeysMappedToMultipleNewKeys(){
  Configuration conf=new Configuration();
  Configuration.addDeprecation("dK",new String[]{"nK1","nK2"});
  conf.set("k","v");
  conf.set("dK","V");
  assertEquals("V",conf.get("dK"));
  assertEquals("V",conf.get("nK1"));
  assertEquals("V",conf.get("nK2"));
  conf.set("nK1","VV");
  assertEquals("VV",conf.get("dK"));
  assertEquals("VV",conf.get("nK1"));
  assertEquals("VV",conf.get("nK2"));
  conf.set("nK2","VVV");
  assertEquals("VVV",conf.get("dK"));
  assertEquals("VVV",conf.get("nK2"));
  assertEquals("VVV",conf.get("nK1"));
  boolean kFound=false;
  boolean dKFound=false;
  boolean nK1Found=false;
  boolean nK2Found=false;
  for (  Map.Entry<String,String> entry : conf) {
    if (entry.getKey().equals("k")) {
      assertEquals("v",entry.getValue());
      kFound=true;
    }
    if (entry.getKey().equals("dK")) {
      assertEquals("VVV",entry.getValue());
      dKFound=true;
    }
    if (entry.getKey().equals("nK1")) {
      assertEquals("VVV",entry.getValue());
      nK1Found=true;
    }
    if (entry.getKey().equals("nK2")) {
      assertEquals("VVV",entry.getValue());
      nK2Found=true;
    }
  }
  assertTrue("regular Key not found",kFound);
  assertTrue("deprecated Key not found",dKFound);
  assertTrue("new Key 1 not found",nK1Found);
  assertTrue("new Key 2 not found",nK2Found);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.crypto.key.TestKeyProviderCryptoExtension </h4><pre class="type-11 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenerateEncryptedKey() throws Exception {
  KeyProviderCryptoExtension.EncryptedKeyVersion ek1=kpExt.generateEncryptedKey(encryptionKey.getName());
  assertEquals("Version name of EEK should be EEK",KeyProviderCryptoExtension.EEK,ek1.getEncryptedKeyVersion().getVersionName());
  assertEquals("Name of EEK should be encryption key name",ENCRYPTION_KEY_NAME,ek1.getEncryptionKeyName());
  assertNotNull("Expected encrypted key material",ek1.getEncryptedKeyVersion().getMaterial());
  assertEquals("Length of encryption key material and EEK material should " + "be the same",encryptionKey.getMaterial().length,ek1.getEncryptedKeyVersion().getMaterial().length);
  KeyVersion k1=kpExt.decryptEncryptedKey(ek1);
  assertEquals(KeyProviderCryptoExtension.EK,k1.getVersionName());
  assertEquals(encryptionKey.getMaterial().length,k1.getMaterial().length);
  if (Arrays.equals(k1.getMaterial(),encryptionKey.getMaterial())) {
    fail("Encrypted key material should not equal encryption key material");
  }
  if (Arrays.equals(ek1.getEncryptedKeyVersion().getMaterial(),encryptionKey.getMaterial())) {
    fail("Encrypted key material should not equal decrypted key material");
  }
  KeyVersion k1a=kpExt.decryptEncryptedKey(ek1);
  assertArrayEquals(k1.getMaterial(),k1a.getMaterial());
  KeyProviderCryptoExtension.EncryptedKeyVersion ek2=kpExt.generateEncryptedKey(encryptionKey.getName());
  KeyVersion k2=kpExt.decryptEncryptedKey(ek2);
  if (Arrays.equals(k1.getMaterial(),k2.getMaterial())) {
    fail("Generated EEKs should have different material!");
  }
  if (Arrays.equals(ek1.getEncryptedKeyIv(),ek2.getEncryptedKeyIv())) {
    fail("Generated EEKs should have different IVs!");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.FSMainOperationsBaseTest </h4><pre class="type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCopyToLocalWithUseRawLocalFileSystemOption() throws Exception {
  Configuration conf=new Configuration();
  FileSystem fSys=new RawLocalFileSystem();
  Path fileToFS=new Path(getTestRootDir(),"fs.txt");
  Path fileToLFS=new Path(getTestRootDir(),"test.txt");
  Path crcFileAtLFS=new Path(getTestRootDir(),".test.txt.crc");
  fSys.initialize(new URI("file:///"),conf);
  writeFile(fSys,fileToFS);
  if (fSys.exists(crcFileAtLFS))   Assert.assertTrue("CRC files not deleted",fSys.delete(crcFileAtLFS,true));
  fSys.copyToLocalFile(false,fileToFS,fileToLFS,true);
  Assert.assertFalse("CRC files are created",fSys.exists(crcFileAtLFS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.FileContextMainOperationsBaseTest </h4><pre class="type-9 type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnsupportedSymlink() throws IOException {
  Path file=getTestRootPath(fc,"file");
  Path link=getTestRootPath(fc,"linkToFile");
  if (!fc.getDefaultFileSystem().supportsSymlinks()) {
    try {
      fc.createSymlink(file,link,false);
      Assert.fail("Created a symlink on a file system that " + "does not support symlinks.");
    }
 catch (    IOException e) {
    }
    createFile(file);
    try {
      fc.getLinkTarget(file);
      Assert.fail("Got a link target on a file system that " + "does not support symlinks.");
    }
 catch (    IOException e) {
    }
    Assert.assertEquals(fc.getFileStatus(file),fc.getFileLinkStatus(file));
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListCorruptFileBlocks() throws IOException {
  final Path rootPath=getTestRootPath(fc,"test");
  final Path path=new Path(rootPath,"zoo");
  createFile(path);
  try {
    final RemoteIterator<Path> remoteIterator=fc.listCorruptFileBlocks(path);
    if (listCorruptedBlocksSupported()) {
      assertTrue(remoteIterator != null);
      Path p;
      while (remoteIterator.hasNext()) {
        p=remoteIterator.next();
        System.out.println("corrupted block: " + p);
      }
      try {
        remoteIterator.next();
        fail();
      }
 catch (      NoSuchElementException nsee) {
      }
    }
 else {
      fail();
    }
  }
 catch (  UnsupportedOperationException uoe) {
    if (listCorruptedBlocksSupported()) {
      fail(uoe.toString());
    }
 else {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.FileContextPermissionBase </h4><pre class="type-9 type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetOwner() throws IOException {
  if (Path.WINDOWS) {
    System.out.println("Cannot run test for Windows");
    return;
  }
  String filename="bar";
  Path f=fileContextTestHelper.getTestRootPath(fc,filename);
  createFile(fc,f);
  List<String> groups=null;
  try {
    groups=getGroups();
    System.out.println(filename + ": " + fc.getFileStatus(f).getPermission());
  }
 catch (  IOException e) {
    System.out.println(StringUtils.stringifyException(e));
    System.out.println("Cannot run test");
    return;
  }
  if (groups == null || groups.size() < 1) {
    System.out.println("Cannot run test: need at least one group.  groups=" + groups);
    return;
  }
  try {
    String g0=groups.get(0);
    fc.setOwner(f,null,g0);
    Assert.assertEquals(g0,fc.getFileStatus(f).getGroup());
    if (groups.size() > 1) {
      String g1=groups.get(1);
      fc.setOwner(f,null,g1);
      Assert.assertEquals(g1,fc.getFileStatus(f).getGroup());
    }
 else {
      System.out.println("Not testing changing the group since user " + "belongs to only one group.");
    }
    try {
      fc.setOwner(f,null,null);
      fail("Exception expected.");
    }
 catch (    IllegalArgumentException iae) {
    }
  }
  finally {
    cleanupFile(fc,f);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.SymlinkBaseTest </h4><pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=10000) public void testSetTimes() throws IOException {
  Path file=new Path(testBaseDir1(),"file");
  Path link=new Path(testBaseDir1(),"linkToFile");
  createAndWriteFile(file);
  wrapper.createSymlink(file,link,false);
  long at=wrapper.getFileLinkStatus(link).getAccessTime();
  wrapper.setTimes(link,2L,3L);
  if (!"file".equals(getScheme())) {
    assertEquals(at,wrapper.getFileLinkStatus(link).getAccessTime());
    assertEquals(3,wrapper.getFileStatus(file).getAccessTime());
    assertEquals(2,wrapper.getFileStatus(file).getModificationTime());
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-10 type-15 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testStatLinkToFile() throws IOException {
  assumeTrue(!emulatingSymlinksOnWindows());
  Path file=new Path(testBaseDir1() + "/file");
  Path linkToFile=new Path(testBaseDir1() + "/linkToFile");
  createAndWriteFile(file);
  wrapper.createSymlink(file,linkToFile,false);
  assertFalse(wrapper.getFileLinkStatus(linkToFile).isDirectory());
  assertTrue(wrapper.isSymlink(linkToFile));
  assertTrue(wrapper.isFile(linkToFile));
  assertFalse(wrapper.isDir(linkToFile));
  assertEquals(file,wrapper.getLinkTarget(linkToFile));
  if (!"file".equals(getScheme())) {
    assertEquals(wrapper.getFileStatus(file),wrapper.getFileStatus(linkToFile));
    assertEquals(wrapper.makeQualified(file),wrapper.getFileStatus(linkToFile).getPath());
    assertEquals(wrapper.makeQualified(linkToFile),wrapper.getFileLinkStatus(linkToFile).getPath());
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testRenameSymlinkToExistingFile() throws IOException {
  Path file1=new Path(testBaseDir1(),"file");
  Path file2=new Path(testBaseDir1(),"someFile");
  Path link=new Path(testBaseDir1(),"linkToFile");
  createAndWriteFile(file1);
  createAndWriteFile(file2);
  wrapper.createSymlink(file2,link,false);
  try {
    wrapper.rename(link,file1);
    fail("Renamed w/o passing overwrite");
  }
 catch (  IOException e) {
    assertTrue(unwrapException(e) instanceof FileAlreadyExistsException);
  }
  wrapper.rename(link,file1,Rename.OVERWRITE);
  assertFalse(wrapper.exists(link));
  if (!emulatingSymlinksOnWindows()) {
    assertTrue(wrapper.getFileLinkStatus(file1).isSymlink());
    assertEquals(file2,wrapper.getLinkTarget(file1));
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testCreateLinkUsingPartQualPath2() throws IOException {
  Path link=new Path(testBaseDir1(),"linkToFile");
  Path fileWoScheme=new Path("//" + testURI().getAuthority() + testBaseDir1()+ "/file");
  if ("file".equals(getScheme())) {
    return;
  }
  wrapper.createSymlink(fileWoScheme,link,false);
  assertEquals(fileWoScheme,wrapper.getLinkTarget(link));
  assertEquals(fileWoScheme.toString(),wrapper.getFileLinkStatus(link).getSymlink().toString());
  try {
    readFile(link);
    fail("Accessed a file with w/o scheme");
  }
 catch (  IOException e) {
    if (wrapper instanceof FileContextTestWrapper) {
      assertEquals("No AbstractFileSystem for scheme: null",e.getMessage());
    }
 else     if (wrapper instanceof FileSystemTestWrapper) {
      assertEquals("No FileSystem for scheme: null",e.getMessage());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-7 type-10 type-15 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testCreateLinkUsingPartQualPath1() throws IOException {
  assumeTrue(!"file".equals(getScheme()));
  Path schemeAuth=new Path(testURI().toString());
  Path fileWoHost=new Path(getScheme() + "://" + testBaseDir1()+ "/file");
  Path link=new Path(testBaseDir1() + "/linkToFile");
  Path linkQual=new Path(schemeAuth,testBaseDir1() + "/linkToFile");
  FSTestWrapper localWrapper=wrapper.getLocalFSWrapper();
  wrapper.createSymlink(fileWoHost,link,false);
  assertEquals(fileWoHost,wrapper.getLinkTarget(linkQual));
  assertEquals(fileWoHost.toString(),wrapper.getFileLinkStatus(link).getSymlink().toString());
  assertEquals(fileWoHost.toString(),wrapper.getFileLinkStatus(linkQual).getSymlink().toString());
  if (wrapper instanceof FileContextTestWrapper) {
    assertEquals(fileWoHost.toString(),localWrapper.getFileLinkStatus(linkQual).getSymlink().toString());
  }
  try {
    readFile(link);
    fail("DFS requires URIs with schemes have an authority");
  }
 catch (  java.lang.RuntimeException e) {
    assertTrue(wrapper instanceof FileContextTestWrapper);
  }
catch (  FileNotFoundException e) {
    assertTrue(wrapper instanceof FileSystemTestWrapper);
    GenericTestUtils.assertExceptionContains("File does not exist: /test1/file",e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestFileUtil </h4><pre class="type-11 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that length on a symlink works as expected.
 */
@Test(timeout=30000) public void testSymlinkLength() throws Exception {
  Assert.assertFalse(del.exists());
  del.mkdirs();
  byte[] data="testSymLinkData".getBytes();
  File file=new File(del,FILE);
  File link=new File(del,"_link");
  FileOutputStream os=new FileOutputStream(file);
  os.write(data);
  os.close();
  Assert.assertEquals(0,link.length());
  FileUtil.symLink(file.getAbsolutePath(),link.getAbsolutePath());
  Assert.assertEquals(data.length,file.length());
  Assert.assertEquals(data.length,link.length());
  file.delete();
  Assert.assertFalse(file.exists());
  if (Shell.WINDOWS && !Shell.isJava7OrAbove()) {
    Assert.assertEquals(data.length,link.length());
  }
 else {
    Assert.assertEquals(0,link.length());
  }
  link.delete();
  Assert.assertFalse(link.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestHdfsNativeCodeLoader </h4><pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNativeCodeLoaded(){
  if (requireTestJni() == false) {
    LOG.info("TestNativeCodeLoader: libhadoop.so testing is not required.");
    return;
  }
  if (!NativeCodeLoader.isNativeCodeLoaded()) {
    String LD_LIBRARY_PATH=System.getenv().get("LD_LIBRARY_PATH");
    if (LD_LIBRARY_PATH == null)     LD_LIBRARY_PATH="";
    fail("TestNativeCodeLoader: libhadoop.so testing was required, but " + "libhadoop.so was not loaded.  LD_LIBRARY_PATH = " + LD_LIBRARY_PATH);
  }
  LOG.info("TestHdfsNativeCodeLoader: libhadoop.so is loaded.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestLocalFileSystem </h4><pre class="type-9 type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test(timeout=10000) public void testReportChecksumFailure() throws IOException {
  base.mkdirs();
  assertTrue(base.exists() && base.isDirectory());
  final File dir1=new File(base,"dir1");
  final File dir2=new File(dir1,"dir2");
  dir2.mkdirs();
  assertTrue(dir2.exists() && FileUtil.canWrite(dir2));
  final String dataFileName="corruptedData";
  final Path dataPath=new Path(new File(dir2,dataFileName).toURI());
  final Path checksumPath=fileSys.getChecksumFile(dataPath);
  final FSDataOutputStream fsdos=fileSys.create(dataPath);
  try {
    fsdos.writeUTF("foo");
  }
  finally {
    fsdos.close();
  }
  assertTrue(fileSys.pathToFile(dataPath).exists());
  final long dataFileLength=fileSys.getFileStatus(dataPath).getLen();
  assertTrue(dataFileLength > 0);
  assertTrue(fileSys.pathToFile(checksumPath).exists());
  final long checksumFileLength=fileSys.getFileStatus(checksumPath).getLen();
  assertTrue(checksumFileLength > 0);
  FileUtil.setWritable(base,false);
  FSDataInputStream dataFsdis=fileSys.open(dataPath);
  FSDataInputStream checksumFsdis=fileSys.open(checksumPath);
  boolean retryIsNecessary=fileSys.reportChecksumFailure(dataPath,dataFsdis,0,checksumFsdis,0);
  assertTrue(!retryIsNecessary);
  assertTrue(!fileSys.pathToFile(dataPath).exists());
  assertTrue(!fileSys.pathToFile(checksumPath).exists());
  File[] dir1files=dir1.listFiles(new FileFilter(){
    @Override public boolean accept(    File pathname){
      return pathname != null && !pathname.getName().equals("dir2");
    }
  }
);
  assertTrue(dir1files != null);
  assertTrue(dir1files.length == 1);
  File badFilesDir=dir1files[0];
  File[] badFiles=badFilesDir.listFiles();
  assertTrue(badFiles != null);
  assertTrue(badFiles.length == 2);
  boolean dataFileFound=false;
  boolean checksumFileFound=false;
  for (  File badFile : badFiles) {
    if (badFile.getName().startsWith(dataFileName)) {
      assertTrue(dataFileLength == badFile.length());
      dataFileFound=true;
    }
 else     if (badFile.getName().contains(dataFileName + ".crc")) {
      assertTrue(checksumFileLength == badFile.length());
      checksumFileFound=true;
    }
  }
  assertTrue(dataFileFound);
  assertTrue(checksumFileFound);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestPath </h4><pre class="type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=30000) public void testParent(){
  assertEquals(new Path("/foo"),new Path("/foo/bar").getParent());
  assertEquals(new Path("foo"),new Path("foo/bar").getParent());
  assertEquals(new Path("/"),new Path("/foo").getParent());
  assertEquals(null,new Path("/").getParent());
  if (Path.WINDOWS) {
    assertEquals(new Path("c:/"),new Path("c:/foo").getParent());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=30000) public void testChild(){
  assertEquals(new Path("."),new Path(".","."));
  assertEquals(new Path("/"),new Path("/","."));
  assertEquals(new Path("/"),new Path(".","/"));
  assertEquals(new Path("/foo"),new Path("/","foo"));
  assertEquals(new Path("/foo/bar"),new Path("/foo","bar"));
  assertEquals(new Path("/foo/bar/baz"),new Path("/foo/bar","baz"));
  assertEquals(new Path("/foo/bar/baz"),new Path("/foo","bar/baz"));
  assertEquals(new Path("foo"),new Path(".","foo"));
  assertEquals(new Path("foo/bar"),new Path("foo","bar"));
  assertEquals(new Path("foo/bar/baz"),new Path("foo","bar/baz"));
  assertEquals(new Path("foo/bar/baz"),new Path("foo/bar","baz"));
  assertEquals(new Path("/foo"),new Path("/bar","/foo"));
  if (Path.WINDOWS) {
    assertEquals(new Path("c:/foo"),new Path("/bar","c:/foo"));
    assertEquals(new Path("c:/foo"),new Path("d:/bar","c:/foo"));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=30000) public void testPathThreeArgContructor(){
  assertEquals(new Path("foo"),new Path(null,null,"foo"));
  assertEquals(new Path("scheme:///foo"),new Path("scheme",null,"/foo"));
  assertEquals(new Path("scheme://authority/foo"),new Path("scheme","authority","/foo"));
  if (Path.WINDOWS) {
    assertEquals(new Path("c:/foo/bar"),new Path(null,null,"c:/foo/bar"));
    assertEquals(new Path("c:/foo/bar"),new Path(null,null,"/c:/foo/bar"));
  }
 else {
    assertEquals(new Path("./a:b"),new Path(null,null,"a:b"));
  }
  if (Path.WINDOWS) {
    assertEquals(new Path("c:/foo/bar"),new Path("/fou",new Path(null,null,"c:/foo/bar")));
    assertEquals(new Path("c:/foo/bar"),new Path("/fou",new Path(null,null,"/c:/foo/bar")));
    assertEquals(new Path("/foo/bar"),new Path("/foo",new Path(null,null,"bar")));
  }
 else {
    assertEquals(new Path("/foo/bar/a:b"),new Path("/foo/bar",new Path(null,null,"a:b")));
    assertEquals(new Path("/a:b"),new Path("/foo/bar",new Path(null,null,"/a:b")));
  }
}

</code></pre>

<br>
<pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test(timeout=30000) public void testIsAbsolute(){
  assertTrue(new Path("/").isAbsolute());
  assertTrue(new Path("/foo").isAbsolute());
  assertFalse(new Path("foo").isAbsolute());
  assertFalse(new Path("foo/bar").isAbsolute());
  assertFalse(new Path(".").isAbsolute());
  if (Path.WINDOWS) {
    assertTrue(new Path("c:/a/b").isAbsolute());
    assertFalse(new Path("c:a/b").isAbsolute());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=30000) public void testNormalize() throws URISyntaxException {
  assertEquals("",new Path(".").toString());
  assertEquals("..",new Path("..").toString());
  assertEquals("/",new Path("/").toString());
  assertEquals("/",new Path("//").toString());
  assertEquals("/",new Path("///").toString());
  assertEquals("//foo/",new Path("//foo/").toString());
  assertEquals("//foo/",new Path("//foo//").toString());
  assertEquals("//foo/bar",new Path("//foo//bar").toString());
  assertEquals("/foo",new Path("/foo/").toString());
  assertEquals("/foo",new Path("/foo/").toString());
  assertEquals("foo",new Path("foo/").toString());
  assertEquals("foo",new Path("foo//").toString());
  assertEquals("foo/bar",new Path("foo//bar").toString());
  assertEquals("hdfs://foo/foo2/bar/baz/",new Path(new URI("hdfs://foo//foo2///bar/baz///")).toString());
  if (Path.WINDOWS) {
    assertEquals("c:/a/b",new Path("c:\\a\\b").toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestResolveHdfsSymlink </h4><pre class="type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests resolution of an hdfs symlink to the local file system.
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testFcResolveAfs() throws IOException, InterruptedException {
  Configuration conf=new Configuration();
  FileContext fcLocal=FileContext.getLocalFSFileContext();
  FileContext fcHdfs=FileContext.getFileContext(cluster.getFileSystem().getUri());
  final String localTestRoot=helper.getAbsoluteTestRootDir(fcLocal);
  Path alphaLocalPath=new Path(fcLocal.getDefaultFileSystem().getUri().toString(),new File(localTestRoot,"alpha").getAbsolutePath());
  DFSTestUtil.createFile(FileSystem.getLocal(conf),alphaLocalPath,16,(short)1,2);
  Path linkTarget=new Path(fcLocal.getDefaultFileSystem().getUri().toString(),localTestRoot);
  Path hdfsLink=new Path(fcHdfs.getDefaultFileSystem().getUri().toString(),"/tmp/link");
  fcHdfs.createSymlink(linkTarget,hdfsLink,true);
  Path alphaHdfsPathViaLink=new Path(fcHdfs.getDefaultFileSystem().getUri().toString() + "/tmp/link/alpha");
  Set<AbstractFileSystem> afsList=fcHdfs.resolveAbstractFileSystems(alphaHdfsPathViaLink);
  Assert.assertEquals(2,afsList.size());
  for (  AbstractFileSystem afs : afsList) {
    if ((!afs.equals(fcHdfs.getDefaultFileSystem())) && (!afs.equals(fcLocal.getDefaultFileSystem()))) {
      Assert.fail("Failed to resolve AFS correctly");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestSymlinkHdfs </h4><pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=10000) public void testCreateLinkToSlash() throws IOException {
  Path dir=new Path(testBaseDir1());
  Path file=new Path(testBaseDir1(),"file");
  Path link=new Path(testBaseDir1(),"linkToSlash");
  Path fileViaLink=new Path(testBaseDir1() + "/linkToSlash" + testBaseDir1()+ "/file");
  createAndWriteFile(file);
  wrapper.setWorkingDirectory(dir);
  wrapper.createSymlink(new Path("/"),link,false);
  readFile(fileViaLink);
  assertEquals(fileSize,wrapper.getFileStatus(fileViaLink).getLen());
  if (wrapper instanceof FileContextTestWrapper) {
    FSTestWrapper localWrapper=wrapper.getLocalFSWrapper();
    Path linkQual=new Path(cluster.getURI(0).toString(),fileViaLink);
    assertEquals(fileSize,localWrapper.getFileStatus(linkQual).getLen());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.azure.NativeAzureFileSystemBaseTest </h4><pre class="type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRenameFolder() throws Exception {
  for (  RenameFolderVariation variation : RenameFolderVariation.values()) {
    Path originalFolder=new Path("folderToRename");
    if (variation != RenameFolderVariation.CreateJustInnerFile) {
      assertTrue(fs.mkdirs(originalFolder));
    }
    Path innerFile=new Path(originalFolder,"innerFile");
    if (variation != RenameFolderVariation.CreateJustFolder) {
      assertTrue(fs.createNewFile(innerFile));
    }
    Path destination=new Path("renamedFolder");
    assertTrue(fs.rename(originalFolder,destination));
    assertTrue(fs.exists(destination));
    if (variation != RenameFolderVariation.CreateJustFolder) {
      assertTrue(fs.exists(new Path(destination,innerFile.getName())));
    }
    assertFalse(fs.exists(originalFolder));
    assertFalse(fs.exists(innerFile));
    fs.delete(destination,true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.azure.TestOutOfBandAzureBlobOperations </h4><pre class="type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests that when we create the file (or folder) x/y/z, we also create
 * explicit folder blobs for x and x/y
 */
@Test public void testCreatingDeepFileCreatesExplicitFolder() throws Exception {
  for (  DeepCreateTestVariation variation : DeepCreateTestVariation.values()) {
switch (variation) {
case File:
      assertTrue(fs.createNewFile(new Path("/x/y/z")));
    break;
case Folder:
  assertTrue(fs.mkdirs(new Path("/x/y/z")));
break;
}
assertTrue(backingStore.exists(AzureBlobStorageTestAccount.toMockUri("x")));
assertTrue(backingStore.exists(AzureBlobStorageTestAccount.toMockUri("x/y")));
fs.delete(new Path("/x"),true);
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.contract.AbstractContractRenameTest </h4><pre class="type-9 type-11 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Rename test -handles filesystems that will overwrite the destination
 * as well as those that do not (i.e. HDFS).
 * @throws Throwable
 */
@Test public void testRenameFileOverExistingFile() throws Throwable {
  describe("Verify renaming a file onto an existing file matches expectations");
  Path srcFile=path("source-256.txt");
  byte[] srcData=dataset(256,'a','z');
  writeDataset(getFileSystem(),srcFile,srcData,srcData.length,1024,false);
  Path destFile=path("dest-512.txt");
  byte[] destData=dataset(512,'A','Z');
  writeDataset(getFileSystem(),destFile,destData,destData.length,1024,false);
  assertIsFile(destFile);
  boolean renameOverwritesDest=isSupported(RENAME_OVERWRITES_DEST);
  boolean renameReturnsFalseOnRenameDestExists=!isSupported(RENAME_RETURNS_FALSE_IF_DEST_EXISTS);
  boolean destUnchanged=true;
  try {
    boolean renamed=rename(srcFile,destFile);
    if (renameOverwritesDest) {
      assertTrue("Rename returned false",renamed);
      destUnchanged=false;
    }
 else {
      if (renamed && !renameReturnsFalseOnRenameDestExists) {
        String destDirLS=generateAndLogErrorListing(srcFile,destFile);
        getLog().error("dest dir {}",destDirLS);
        fail("expected rename(" + srcFile + ", "+ destFile+ " ) to fail,"+ " but got success and destination of "+ destDirLS);
      }
    }
  }
 catch (  FileAlreadyExistsException e) {
    handleExpectedException(e);
  }
  ContractTestUtils.verifyFileContents(getFileSystem(),destFile,destUnchanged ? destData : srcData);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testRenameFileNonexistentDir() throws Throwable {
  describe("rename a file into a new file in the same directory");
  Path renameSrc=path("testRenameSrc");
  Path renameTarget=path("subdir/testRenameTarget");
  byte[] data=dataset(256,'a','z');
  writeDataset(getFileSystem(),renameSrc,data,data.length,1024 * 1024,false);
  boolean renameCreatesDestDirs=isSupported(RENAME_CREATES_DEST_DIRS);
  try {
    boolean rename=rename(renameSrc,renameTarget);
    if (renameCreatesDestDirs) {
      assertTrue(rename);
      ContractTestUtils.verifyFileContents(getFileSystem(),renameTarget,data);
    }
 else {
      assertFalse(rename);
      ContractTestUtils.verifyFileContents(getFileSystem(),renameSrc,data);
    }
  }
 catch (  FileNotFoundException e) {
    assertFalse(renameCreatesDestDirs);
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRenameNonexistentFile() throws Throwable {
  describe("rename a file into a new file in the same directory");
  Path missing=path("testRenameNonexistentFileSrc");
  Path target=path("testRenameNonexistentFileDest");
  boolean renameReturnsFalseOnFailure=isSupported(ContractOptions.RENAME_RETURNS_FALSE_IF_SOURCE_MISSING);
  mkdirs(missing.getParent());
  try {
    boolean renamed=rename(missing,target);
    if (!renameReturnsFalseOnFailure) {
      String destDirLS=generateAndLogErrorListing(missing,target);
      fail("expected rename(" + missing + ", "+ target+ " ) to fail,"+ " got a result of "+ renamed+ " and a destination directory of "+ destDirLS);
    }
 else {
      getLog().warn("Rename returned {} renaming a nonexistent file",renamed);
      assertFalse("Renaming a missing file returned true",renamed);
    }
  }
 catch (  FileNotFoundException e) {
    if (renameReturnsFalseOnFailure) {
      ContractTestUtils.fail("Renaming a missing file unexpectedly threw an exception",e);
    }
    handleExpectedException(e);
  }
catch (  IOException e) {
    handleRelaxedException("rename nonexistent file","FileNotFoundException",e);
  }
  assertPathDoesNotExist("rename nonexistent file created a destination file",target);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.contract.AbstractContractSeekTest </h4><pre class="type-9 type-11 type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Seek and read on a closed file.
 * Some filesystems let callers seek on a closed file -these must
 * still fail on the subsequent reads.
 * @throws Throwable
 */
@Test public void testSeekReadClosedFile() throws Throwable {
  boolean supportsSeekOnClosedFiles=isSupported(SUPPORTS_SEEK_ON_CLOSED_FILE);
  instream=getFileSystem().open(smallSeekFile);
  getLog().debug("Stream is of type " + instream.getClass().getCanonicalName());
  instream.close();
  try {
    instream.seek(0);
    if (!supportsSeekOnClosedFiles) {
      fail("seek succeeded on a closed stream");
    }
  }
 catch (  IOException e) {
  }
  try {
    int data=instream.available();
    fail("read() succeeded on a closed stream, got " + data);
  }
 catch (  IOException e) {
  }
  try {
    int data=instream.read();
    fail("read() succeeded on a closed stream, got " + data);
  }
 catch (  IOException e) {
  }
  try {
    byte[] buffer=new byte[1];
    int result=instream.read(buffer,0,1);
    fail("read(buffer, 0, 1) succeeded on a closed stream, got " + result);
  }
 catch (  IOException e) {
  }
  try {
    long offset=instream.getPos();
  }
 catch (  IOException e) {
  }
  instream.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.swift.TestSwiftFileSystemRename </h4><pre class="type-9 type-11 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Rename a file into a directory
 * @throws Exception
 */
@Test(timeout=SWIFT_TEST_TIMEOUT) public void testRenameFileIntoExistingDirectory() throws Exception {
  assumeRenameSupported();
  Path src=path("/test/olddir/file");
  createFile(src);
  Path dst=path("/test/new/newdir");
  fs.mkdirs(dst);
  rename(src,dst,true,false,true);
  Path newFile=path("/test/new/newdir/file");
  if (!fs.exists(newFile)) {
    String ls=ls(dst);
    LOG.info(ls(path("/test/new")));
    LOG.info(ls(path("/test/hadoop")));
    fail("did not find " + newFile + " - directory: "+ ls);
  }
  assertTrue("Destination changed",fs.exists(path("/test/new/newdir/file")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.ha.ClientBaseWithFixes </h4><pre class="type-4 type-11 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  LOG.info("tearDown starting");
  tearDownAll();
  stopServer();
  portNumLockFile.close();
  portNumFile.delete();
  if (tmpDir != null) {
    Assert.assertTrue("delete " + tmpDir.toString(),recursiveDelete(tmpDir));
  }
  serverFactory=null;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestBlockReaderFactory </h4><pre class="type-9 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the case where we have multiple threads waiting on the
 * ShortCircuitCache delivering a certain ShortCircuitReplica.
 * In this case, there should only be one call to
 * createShortCircuitReplicaInfo.  This one replica should be shared
 * by all threads.
 */
@Test(timeout=60000) public void testMultipleWaitersOnShortCircuitCache() throws Exception {
  final CountDownLatch latch=new CountDownLatch(1);
  final AtomicBoolean creationIsBlocked=new AtomicBoolean(true);
  final AtomicBoolean testFailed=new AtomicBoolean(false);
  DFSInputStream.tcpReadsDisabledForTesting=true;
  BlockReaderFactory.createShortCircuitReplicaInfoCallback=new ShortCircuitCache.ShortCircuitReplicaCreator(){
    @Override public ShortCircuitReplicaInfo createShortCircuitReplicaInfo(){
      Uninterruptibles.awaitUninterruptibly(latch);
      if (!creationIsBlocked.compareAndSet(true,false)) {
        Assert.fail("there were multiple calls to " + "createShortCircuitReplicaInfo.  Only one was expected.");
      }
      return null;
    }
  }
;
  TemporarySocketDirectory sockDir=new TemporarySocketDirectory();
  Configuration conf=createShortCircuitConf("testMultipleWaitersOnShortCircuitCache",sockDir);
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
  cluster.waitActive();
  final DistributedFileSystem dfs=cluster.getFileSystem();
  final String TEST_FILE="/test_file";
  final int TEST_FILE_LEN=4000;
  final int SEED=0xFADED;
  final int NUM_THREADS=10;
  DFSTestUtil.createFile(dfs,new Path(TEST_FILE),TEST_FILE_LEN,(short)1,SEED);
  Runnable readerRunnable=new Runnable(){
    @Override public void run(){
      try {
        byte contents[]=DFSTestUtil.readFileBuffer(dfs,new Path(TEST_FILE));
        Assert.assertFalse(creationIsBlocked.get());
        byte expected[]=DFSTestUtil.calculateFileContentsFromSeed(SEED,TEST_FILE_LEN);
        Assert.assertTrue(Arrays.equals(contents,expected));
      }
 catch (      Throwable e) {
        LOG.error("readerRunnable error",e);
        testFailed.set(true);
      }
    }
  }
;
  Thread threads[]=new Thread[NUM_THREADS];
  for (int i=0; i < NUM_THREADS; i++) {
    threads[i]=new Thread(readerRunnable);
    threads[i].start();
  }
  Thread.sleep(500);
  latch.countDown();
  for (int i=0; i < NUM_THREADS; i++) {
    Uninterruptibles.joinUninterruptibly(threads[i]);
  }
  cluster.shutdown();
  sockDir.close();
  Assert.assertFalse(testFailed.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDFSStorageStateRecovery </h4><pre class="type-9 type-13 type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This test iterates over the testCases table for Datanode storage and
 * attempts to startup the DataNode normally.
 */
@Test public void testDNStorageStates() throws Exception {
  String[] baseDirs;
  for (int numDirs=1; numDirs <= 2; numDirs++) {
    conf=new HdfsConfiguration();
    conf.setInt(DFSConfigKeys.DFS_DATANODE_SCAN_PERIOD_HOURS_KEY,-1);
    conf=UpgradeUtilities.initializeStorageStateConf(numDirs,conf);
    for (int i=0; i < NUM_DN_TEST_CASES; i++) {
      boolean[] testCase=testCases[i];
      boolean shouldRecover=testCase[SHOULD_RECOVER];
      boolean curAfterRecover=testCase[CURRENT_SHOULD_EXIST_AFTER_RECOVER];
      boolean prevAfterRecover=testCase[PREVIOUS_SHOULD_EXIST_AFTER_RECOVER];
      log("DATA_NODE recovery",numDirs,i,testCase);
      createNameNodeStorageState(new boolean[]{true,true,false,false,false});
      cluster=createCluster(conf);
      baseDirs=createDataNodeStorageState(testCase);
      if (!testCase[CURRENT_EXISTS] && !testCase[PREVIOUS_EXISTS] && !testCase[PREVIOUS_TMP_EXISTS]&& !testCase[REMOVED_TMP_EXISTS]) {
        cluster.startDataNodes(conf,1,false,StartupOption.REGULAR,null);
      }
 else {
        if (shouldRecover) {
          cluster.startDataNodes(conf,1,false,StartupOption.REGULAR,null);
          checkResultDataNode(baseDirs,curAfterRecover,prevAfterRecover);
        }
 else {
          cluster.startDataNodes(conf,1,false,StartupOption.REGULAR,null);
          assertFalse(cluster.getDataNodes().get(0).isDatanodeUp());
        }
      }
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This test iterates over the testCases table for block pool storage and
 * attempts to startup the DataNode normally.
 */
@Test public void testBlockPoolStorageStates() throws Exception {
  String[] baseDirs;
  String bpid=UpgradeUtilities.getCurrentBlockPoolID(null);
  for (int numDirs=1; numDirs <= 2; numDirs++) {
    conf=new HdfsConfiguration();
    conf.setInt("dfs.datanode.scan.period.hours",-1);
    conf=UpgradeUtilities.initializeStorageStateConf(numDirs,conf);
    for (int i=0; i < NUM_DN_TEST_CASES; i++) {
      boolean[] testCase=testCases[i];
      boolean shouldRecover=testCase[SHOULD_RECOVER];
      boolean curAfterRecover=testCase[CURRENT_SHOULD_EXIST_AFTER_RECOVER];
      boolean prevAfterRecover=testCase[PREVIOUS_SHOULD_EXIST_AFTER_RECOVER];
      log("BLOCK_POOL recovery",numDirs,i,testCase);
      createNameNodeStorageState(new boolean[]{true,true,false,false,false});
      cluster=createCluster(conf);
      baseDirs=createBlockPoolStorageState(bpid,testCase);
      if (!testCase[CURRENT_EXISTS] && !testCase[PREVIOUS_EXISTS] && !testCase[PREVIOUS_TMP_EXISTS]&& !testCase[REMOVED_TMP_EXISTS]) {
        cluster.startDataNodes(conf,1,false,StartupOption.REGULAR,null);
      }
 else {
        if (shouldRecover) {
          cluster.startDataNodes(conf,1,false,StartupOption.REGULAR,null);
          checkResultBlockPool(baseDirs,curAfterRecover,prevAfterRecover);
        }
 else {
          cluster.startDataNodes(conf,1,false,StartupOption.REGULAR,null);
          assertFalse(cluster.getDataNodes().get(0).isBPServiceAlive(bpid));
        }
      }
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
/** 
 * This test iterates over the testCases table and attempts
 * to startup the NameNode normally.
 */
@Test public void testNNStorageStates() throws Exception {
  String[] baseDirs;
  for (int numDirs=1; numDirs <= 2; numDirs++) {
    conf=new HdfsConfiguration();
    conf.setInt(DFSConfigKeys.DFS_DATANODE_SCAN_PERIOD_HOURS_KEY,-1);
    conf=UpgradeUtilities.initializeStorageStateConf(numDirs,conf);
    for (int i=0; i < NUM_NN_TEST_CASES; i++) {
      boolean[] testCase=testCases[i];
      boolean shouldRecover=testCase[SHOULD_RECOVER];
      boolean curAfterRecover=testCase[CURRENT_SHOULD_EXIST_AFTER_RECOVER];
      boolean prevAfterRecover=testCase[PREVIOUS_SHOULD_EXIST_AFTER_RECOVER];
      log("NAME_NODE recovery",numDirs,i,testCase);
      baseDirs=createNameNodeStorageState(testCase);
      if (shouldRecover) {
        cluster=createCluster(conf);
        checkResultNameNode(baseDirs,curAfterRecover,prevAfterRecover);
        cluster.shutdown();
      }
 else {
        try {
          cluster=createCluster(conf);
          throw new AssertionError("NameNode should have failed to start");
        }
 catch (        IOException expected) {
          if (!testCases[i][CURRENT_EXISTS] && !testCases[i][PREVIOUS_TMP_EXISTS] && !testCases[i][PREVIOUS_EXISTS]&& !testCases[i][REMOVED_TMP_EXISTS]) {
            assertTrue(expected.getLocalizedMessage().contains("NameNode is not formatted"));
          }
        }
      }
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDatanodeBlockScanner </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateScans() throws Exception {
  long startTime=Time.monotonicNow();
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(new Configuration()).numDataNodes(1).build();
  FileSystem fs=null;
  try {
    fs=cluster.getFileSystem();
    DataNode dataNode=cluster.getDataNodes().get(0);
    int infoPort=dataNode.getInfoPort();
    long scanTimeBefore=0, scanTimeAfter=0;
    for (int i=1; i < 10; i++) {
      Path fileName=new Path("/test" + i);
      DFSTestUtil.createFile(fs,fileName,1024,(short)1,1000L);
      waitForVerification(infoPort,fs,fileName,i,startTime,TIMEOUT);
      if (i > 1) {
        scanTimeAfter=DataNodeTestUtils.getLatestScanTime(dataNode,DFSTestUtil.getFirstBlock(fs,new Path("/test" + (i - 1))));
        assertFalse("scan time shoud not be 0",scanTimeAfter == 0);
        assertEquals("There should not be duplicate scan",scanTimeBefore,scanTimeAfter);
      }
      scanTimeBefore=DataNodeTestUtils.getLatestScanTime(dataNode,DFSTestUtil.getFirstBlock(fs,new Path("/test" + i)));
    }
    cluster.restartDataNode(0);
    Thread.sleep(10000);
    dataNode=cluster.getDataNodes().get(0);
    scanTimeAfter=DataNodeTestUtils.getLatestScanTime(dataNode,DFSTestUtil.getFirstBlock(fs,new Path("/test" + (9))));
    assertEquals("There should not be duplicate scan",scanTimeBefore,scanTimeAfter);
  }
  finally {
    IOUtils.closeStream(fs);
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDatanodeRegistration </h4><pre class="type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Regression test for HDFS-894 ensures that, when datanodes
 * are restarted, the new IPC port is registered with the
 * namenode.
 */
@Test public void testChangeIpcPort() throws Exception {
  HdfsConfiguration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).build();
    InetSocketAddress addr=new InetSocketAddress("localhost",cluster.getNameNodePort());
    DFSClient client=new DFSClient(addr,conf);
    cluster.restartDataNodes();
    DatanodeInfo[] report=client.datanodeReport(DatanodeReportType.ALL);
    long firstUpdateAfterRestart=report[0].getLastUpdate();
    boolean gotHeartbeat=false;
    for (int i=0; i < 10 && !gotHeartbeat; i++) {
      try {
        Thread.sleep(i * 1000);
      }
 catch (      InterruptedException ie) {
      }
      report=client.datanodeReport(DatanodeReportType.ALL);
      gotHeartbeat=(report[0].getLastUpdate() > firstUpdateAfterRestart);
    }
    if (!gotHeartbeat) {
      fail("Never got a heartbeat from restarted datanode.");
    }
    int realIpcPort=cluster.getDataNodes().get(0).getIpcPort();
    assertEquals(realIpcPort,report[0].getIpcPort());
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDecommission </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test using a "registration name" in a host include file.
 * Registration names are DataNode names specified in the configuration by
 * dfs.datanode.hostname.  The DataNode will send this name to the NameNode
 * as part of its registration.  Registration names are helpful when you
 * want to override the normal first result of DNS resolution on the
 * NameNode.  For example, a given datanode IP may map to two hostnames,
 * and you may want to choose which hostname is used internally in the
 * cluster.
 * It is not recommended to use a registration name which is not also a
 * valid DNS hostname for the DataNode.  See HDFS-5237 for background.
 */
@Test(timeout=360000) public void testIncludeByRegistrationName() throws IOException, InterruptedException {
  Configuration hdfsConf=new Configuration(conf);
  final String registrationName="127.0.0.100";
  final String nonExistentDn="127.0.0.10";
  hdfsConf.set(DFSConfigKeys.DFS_DATANODE_HOST_NAME_KEY,registrationName);
  cluster=new MiniDFSCluster.Builder(hdfsConf).numDataNodes(1).checkDataNodeHostConfig(true).setupHostsFile(true).build();
  cluster.waitActive();
  ArrayList<String> nodes=new ArrayList<String>();
  nodes.add(nonExistentDn);
  writeConfigFile(hostsFile,nodes);
  refreshNodes(cluster.getNamesystem(0),hdfsConf);
  DFSClient client=getDfsClient(cluster.getNameNode(0),hdfsConf);
  while (true) {
    DatanodeInfo info[]=client.datanodeReport(DatanodeReportType.DEAD);
    if (info.length == 1) {
      break;
    }
    LOG.info("Waiting for datanode to be marked dead");
    Thread.sleep(HEARTBEAT_INTERVAL * 1000);
  }
  int dnPort=cluster.getDataNodes().get(0).getXferPort();
  nodes=new ArrayList<String>();
  nodes.add(registrationName + ":" + dnPort);
  writeConfigFile(hostsFile,nodes);
  refreshNodes(cluster.getNamesystem(0),hdfsConf);
  cluster.restartDataNode(0);
  while (true) {
    DatanodeInfo info[]=client.datanodeReport(DatanodeReportType.LIVE);
    if (info.length == 1) {
      Assert.assertFalse(info[0].isDecommissioned());
      Assert.assertFalse(info[0].isDecommissionInProgress());
      assertEquals(registrationName,info[0].getHostName());
      break;
    }
    LOG.info("Waiting for datanode to come back");
    Thread.sleep(HEARTBEAT_INTERVAL * 1000);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestEncryptedTransfer </h4><pre class="type-9 type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientThatDoesNotSupportEncryption() throws IOException {
  MiniDFSCluster cluster=null;
  try {
    Configuration conf=new Configuration();
    conf.setInt(DFSConfigKeys.DFS_CLIENT_RETRY_WINDOW_BASE,10);
    cluster=new MiniDFSCluster.Builder(conf).build();
    FileSystem fs=getFileSystem(conf);
    writeTestDataToFile(fs);
    assertEquals(PLAIN_TEXT,DFSTestUtil.readFile(fs,TEST_PATH));
    fs.close();
    cluster.shutdown();
    setEncryptionConfigKeys(conf);
    cluster=new MiniDFSCluster.Builder(conf).manageDataDfsDirs(false).manageNameDfsDirs(false).format(false).startupOption(StartupOption.REGULAR).build();
    fs=getFileSystem(conf);
    DFSClient client=DFSClientAdapter.getDFSClient((DistributedFileSystem)fs);
    DFSClient spyClient=Mockito.spy(client);
    Mockito.doReturn(false).when(spyClient).shouldEncryptData();
    DFSClientAdapter.setDFSClient((DistributedFileSystem)fs,spyClient);
    LogCapturer logs=GenericTestUtils.LogCapturer.captureLogs(LogFactory.getLog(DataNode.class));
    try {
      assertEquals(PLAIN_TEXT,DFSTestUtil.readFile(fs,TEST_PATH));
      if (resolverClazz != null && !resolverClazz.endsWith("TestTrustedChannelResolver")) {
        fail("Should not have been able to read without encryption enabled.");
      }
    }
 catch (    IOException ioe) {
      GenericTestUtils.assertExceptionContains("Could not obtain block:",ioe);
    }
 finally {
      logs.stopCapturing();
    }
    fs.close();
    if (resolverClazz != null && !resolverClazz.endsWith("TestTrustedChannelResolver")) {
      GenericTestUtils.assertMatches(logs.getOutput(),"Failed to read expected encryption handshake from client at");
    }
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestFileAppend </h4><pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Old replica of the block should not be accepted as valid for append/read
 */
@Test public void testFailedAppendBlockRejection() throws Exception {
  Configuration conf=new HdfsConfiguration();
  conf.set("dfs.client.block.write.replace-datanode-on-failure.enable","false");
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(3).build();
  DistributedFileSystem fs=null;
  try {
    fs=cluster.getFileSystem();
    Path path=new Path("/test");
    FSDataOutputStream out=fs.create(path);
    out.writeBytes("hello\n");
    out.close();
    DataNodeProperties dnProp=cluster.stopDataNode(0);
    String dnAddress=dnProp.datanode.getXferAddress().toString();
    if (dnAddress.startsWith("/")) {
      dnAddress=dnAddress.substring(1);
    }
    for (int i=0; i < 2; i++) {
      out=fs.append(path);
      out.writeBytes("helloagain\n");
      out.close();
    }
    out=fs.append(path);
    cluster.restartDataNode(dnProp,true);
    Thread.sleep(2000);
    BlockLocation[] locations=fs.getFileBlockLocations(path,0,Long.MAX_VALUE);
    String[] names=locations[0].getNames();
    for (    String node : names) {
      if (node.equals(dnAddress)) {
        fail("Failed append should not be present in latest block locations.");
      }
    }
    out.close();
  }
  finally {
    IOUtils.closeStream(fs);
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestFileAppend3 </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * TC11: Racing rename
 * @throws IOException an exception might be thrown
 */
@Test public void testTC11() throws Exception {
  final Path p=new Path("/TC11/foo");
  System.out.println("p=" + p);
  final int len1=(int)BLOCK_SIZE;
{
    FSDataOutputStream out=fs.create(p,false,buffersize,REPLICATION,BLOCK_SIZE);
    AppendTestUtil.write(out,0,len1);
    out.close();
  }
  FSDataOutputStream out=fs.append(p);
  final int len2=(int)BLOCK_SIZE / 2;
  AppendTestUtil.write(out,len1,len2);
  out.hflush();
  final Path pnew=new Path(p + ".new");
  assertTrue(fs.rename(p,pnew));
  out.close();
  final long len=fs.getFileStatus(pnew).getLen();
  final LocatedBlocks locatedblocks=fs.dfs.getNamenode().getBlockLocations(pnew.toString(),0L,len);
  final int numblock=locatedblocks.locatedBlockCount();
  for (int i=0; i < numblock; i++) {
    final LocatedBlock lb=locatedblocks.get(i);
    final ExtendedBlock blk=lb.getBlock();
    final long size=lb.getBlockSize();
    if (i < numblock - 1) {
      assertEquals(BLOCK_SIZE,size);
    }
    for (    DatanodeInfo datanodeinfo : lb.getLocations()) {
      final DataNode dn=cluster.getDataNode(datanodeinfo.getIpcPort());
      final Block metainfo=DataNodeTestUtils.getFSDataset(dn).getStoredBlock(blk.getBlockPoolId(),blk.getBlockId());
      assertEquals(size,metainfo.getNumBytes());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestFileCreation </h4><pre class="type-9 type-11 type-7 type-10 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a file, write something, hflush but not close.
 * Then change lease period and wait for lease recovery.
 * Finally, read the block directly from each Datanode and verify the content.
 */
@Test public void testLeaseExpireHardLimit() throws Exception {
  System.out.println("testLeaseExpireHardLimit start");
  final long leasePeriod=1000;
  final int DATANODE_NUM=3;
  Configuration conf=new HdfsConfiguration();
  conf.setInt(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY,1000);
  conf.setInt(DFS_HEARTBEAT_INTERVAL_KEY,1);
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(DATANODE_NUM).build();
  DistributedFileSystem dfs=null;
  try {
    cluster.waitActive();
    dfs=cluster.getFileSystem();
    final String f=DIR + "foo";
    final Path fpath=new Path(f);
    HdfsDataOutputStream out=create(dfs,fpath,DATANODE_NUM);
    out.write("something".getBytes());
    out.hflush();
    int actualRepl=out.getCurrentBlockReplication();
    assertTrue(f + " should be replicated to " + DATANODE_NUM+ " datanodes.",actualRepl == DATANODE_NUM);
    cluster.setLeasePeriod(leasePeriod,leasePeriod);
    try {
      Thread.sleep(5 * leasePeriod);
    }
 catch (    InterruptedException e) {
    }
    LocatedBlocks locations=dfs.dfs.getNamenode().getBlockLocations(f,0,Long.MAX_VALUE);
    assertEquals(1,locations.locatedBlockCount());
    LocatedBlock locatedblock=locations.getLocatedBlocks().get(0);
    int successcount=0;
    for (    DatanodeInfo datanodeinfo : locatedblock.getLocations()) {
      DataNode datanode=cluster.getDataNode(datanodeinfo.getIpcPort());
      ExtendedBlock blk=locatedblock.getBlock();
      Block b=DataNodeTestUtils.getFSDataset(datanode).getStoredBlock(blk.getBlockPoolId(),blk.getBlockId());
      final File blockfile=DataNodeTestUtils.getFile(datanode,blk.getBlockPoolId(),b.getBlockId());
      System.out.println("blockfile=" + blockfile);
      if (blockfile != null) {
        BufferedReader in=new BufferedReader(new FileReader(blockfile));
        assertEquals("something",in.readLine());
        in.close();
        successcount++;
      }
    }
    System.out.println("successcount=" + successcount);
    assertTrue(successcount > 0);
  }
  finally {
    IOUtils.closeStream(dfs);
    cluster.shutdown();
  }
  System.out.println("testLeaseExpireHardLimit successful");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestLease </h4><pre class="type-9 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeaseAbort() throws Exception {
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
  try {
    cluster.waitActive();
    NamenodeProtocols preSpyNN=cluster.getNameNodeRpc();
    NamenodeProtocols spyNN=spy(preSpyNN);
    DFSClient dfs=new DFSClient(null,spyNN,conf,null);
    byte[] buf=new byte[1024];
    FSDataOutputStream c_out=createFsOut(dfs,dirString + "c");
    c_out.write(buf,0,1024);
    c_out.close();
    DFSInputStream c_in=dfs.open(dirString + "c");
    FSDataOutputStream d_out=createFsOut(dfs,dirString + "d");
    doThrow(new RemoteException(InvalidToken.class.getName(),"Your token is worthless")).when(spyNN).renewLease(anyString());
    LeaseRenewer originalRenewer=dfs.getLeaseRenewer();
    dfs.lastLeaseRenewal=Time.now() - HdfsConstants.LEASE_SOFTLIMIT_PERIOD - 1000;
    try {
      dfs.renewLease();
    }
 catch (    IOException e) {
    }
    try {
      d_out.write(buf,0,1024);
      LOG.info("Write worked beyond the soft limit as expected.");
    }
 catch (    IOException e) {
      Assert.fail("Write failed.");
    }
    dfs.lastLeaseRenewal=Time.now() - HdfsConstants.LEASE_HARDLIMIT_PERIOD - 1000;
    dfs.renewLease();
    try {
      d_out.write(buf,0,1024);
      d_out.close();
      Assert.fail("Write did not fail even after the fatal lease renewal failure");
    }
 catch (    IOException e) {
      LOG.info("Write failed as expected. ",e);
    }
    Thread.sleep(1000);
    Assert.assertTrue(originalRenewer.isEmpty());
    doNothing().when(spyNN).renewLease(anyString());
    try {
      int num=c_in.read(buf,0,1);
      if (num != 1) {
        Assert.fail("Failed to read 1 byte");
      }
      c_in.close();
    }
 catch (    IOException e) {
      LOG.error("Read failed with ",e);
      Assert.fail("Read after lease renewal failure failed");
    }
    try {
      c_out=createFsOut(dfs,dirString + "c");
      c_out.write(buf,0,1024);
      c_out.close();
    }
 catch (    IOException e) {
      LOG.error("Write failed with ",e);
      Assert.fail("Write failed");
    }
  }
  finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestLeaseRenewer </h4><pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRenewal() throws Exception {
  final AtomicInteger leaseRenewalCount=new AtomicInteger();
  Mockito.doAnswer(new Answer<Boolean>(){
    @Override public Boolean answer(    InvocationOnMock invocation) throws Throwable {
      leaseRenewalCount.incrementAndGet();
      return true;
    }
  }
).when(MOCK_DFSCLIENT).renewLease();
  DFSOutputStream mockStream=Mockito.mock(DFSOutputStream.class);
  long fileId=123L;
  renewer.put(fileId,mockStream,MOCK_DFSCLIENT);
  long failTime=Time.now() + 5000;
  while (Time.now() < failTime && leaseRenewalCount.get() == 0) {
    Thread.sleep(50);
  }
  if (leaseRenewalCount.get() == 0) {
    Assert.fail("Did not renew lease at all!");
  }
  renewer.closeFile(fileId,MOCK_DFSCLIENT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestReplication </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPendingReplicationRetry() throws IOException {
  MiniDFSCluster cluster=null;
  int numDataNodes=4;
  String testFile="/replication-test-file";
  Path testPath=new Path(testFile);
  byte buffer[]=new byte[1024];
  for (int i=0; i < buffer.length; i++) {
    buffer[i]='1';
  }
  try {
    Configuration conf=new HdfsConfiguration();
    conf.set(DFSConfigKeys.DFS_REPLICATION_KEY,Integer.toString(numDataNodes));
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDataNodes).build();
    cluster.waitActive();
    DFSClient dfsClient=new DFSClient(new InetSocketAddress("localhost",cluster.getNameNodePort()),conf);
    OutputStream out=cluster.getFileSystem().create(testPath);
    out.write(buffer);
    out.close();
    waitForBlockReplication(testFile,dfsClient.getNamenode(),numDataNodes,-1);
    ExtendedBlock block=dfsClient.getNamenode().getBlockLocations(testFile,0,Long.MAX_VALUE).get(0).getBlock();
    cluster.shutdown();
    cluster=null;
    for (int i=0; i < 25; i++) {
      buffer[i]='0';
    }
    int fileCount=0;
    for (int dnIndex=0; dnIndex < 3; dnIndex++) {
      File blockFile=MiniDFSCluster.getBlockFile(dnIndex,block);
      LOG.info("Checking for file " + blockFile);
      if (blockFile != null && blockFile.exists()) {
        if (fileCount == 0) {
          LOG.info("Deleting file " + blockFile);
          assertTrue(blockFile.delete());
        }
 else {
          LOG.info("Corrupting file " + blockFile);
          long len=blockFile.length();
          assertTrue(len > 50);
          RandomAccessFile blockOut=new RandomAccessFile(blockFile,"rw");
          try {
            blockOut.seek(len / 3);
            blockOut.write(buffer,0,25);
          }
  finally {
            blockOut.close();
          }
        }
        fileCount++;
      }
    }
    assertEquals(3,fileCount);
    LOG.info("Restarting minicluster after deleting a replica and corrupting 2 crcs");
    conf=new HdfsConfiguration();
    conf.set(DFSConfigKeys.DFS_REPLICATION_KEY,Integer.toString(numDataNodes));
    conf.set(DFSConfigKeys.DFS_NAMENODE_REPLICATION_PENDING_TIMEOUT_SEC_KEY,Integer.toString(2));
    conf.set("dfs.datanode.block.write.timeout.sec",Integer.toString(5));
    conf.set(DFSConfigKeys.DFS_NAMENODE_SAFEMODE_THRESHOLD_PCT_KEY,"0.75f");
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDataNodes * 2).format(false).build();
    cluster.waitActive();
    dfsClient=new DFSClient(new InetSocketAddress("localhost",cluster.getNameNodePort()),conf);
    waitForBlockReplication(testFile,dfsClient.getNamenode(),numDataNodes,-1);
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestSafeMode </h4><pre class="type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSafeModeWhenZeroBlockLocations() throws IOException {
  try {
    Path file1=new Path("/tmp/testManualSafeMode/file1");
    Path file2=new Path("/tmp/testManualSafeMode/file2");
    System.out.println("Created file1 and file2.");
    DFSTestUtil.createFile(fs,file1,1000,(short)1,0);
    DFSTestUtil.createFile(fs,file2,2000,(short)1,0);
    checkGetBlockLocationsWorks(fs,file1);
    NameNode namenode=cluster.getNameNode();
    dfs.setSafeMode(SafeModeAction.SAFEMODE_ENTER);
    assertTrue("should still be in SafeMode",namenode.isInSafeMode());
    checkGetBlockLocationsWorks(fs,file1);
    dfs.setSafeMode(SafeModeAction.SAFEMODE_LEAVE);
    assertFalse("should not be in SafeMode",namenode.isInSafeMode());
    cluster.shutdownDataNodes();
    cluster.shutdownNameNode(0);
    cluster.restartNameNode();
    cluster.waitActive();
    System.out.println("Restarted cluster with just the NameNode");
    namenode=cluster.getNameNode();
    assertTrue("No datanode is started. Should be in SafeMode",namenode.isInSafeMode());
    FileStatus stat=fs.getFileStatus(file1);
    try {
      fs.getFileBlockLocations(stat,0,1000);
      assertTrue("Should have got safemode exception",false);
    }
 catch (    SafeModeException e) {
    }
catch (    RemoteException re) {
      if (!re.getClassName().equals(SafeModeException.class.getName()))       assertTrue("Should have got safemode exception",false);
    }
    dfs.setSafeMode(SafeModeAction.SAFEMODE_LEAVE);
    assertFalse("Should not be in safemode",namenode.isInSafeMode());
    checkGetBlockLocationsWorks(fs,file1);
  }
  finally {
    if (fs != null)     fs.close();
    if (cluster != null)     cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.nfs.nfs3.TestRpcProgramNfs3 </h4><pre class="type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test(timeout=1000) public void testIdempotent(){
  Object[][] procedures={{Nfs3Constant.NFSPROC3.NULL,1},{Nfs3Constant.NFSPROC3.GETATTR,1},{Nfs3Constant.NFSPROC3.SETATTR,1},{Nfs3Constant.NFSPROC3.LOOKUP,1},{Nfs3Constant.NFSPROC3.ACCESS,1},{Nfs3Constant.NFSPROC3.READLINK,1},{Nfs3Constant.NFSPROC3.READ,1},{Nfs3Constant.NFSPROC3.WRITE,1},{Nfs3Constant.NFSPROC3.CREATE,0},{Nfs3Constant.NFSPROC3.MKDIR,0},{Nfs3Constant.NFSPROC3.SYMLINK,0},{Nfs3Constant.NFSPROC3.MKNOD,0},{Nfs3Constant.NFSPROC3.REMOVE,0},{Nfs3Constant.NFSPROC3.RMDIR,0},{Nfs3Constant.NFSPROC3.RENAME,0},{Nfs3Constant.NFSPROC3.LINK,0},{Nfs3Constant.NFSPROC3.READDIR,1},{Nfs3Constant.NFSPROC3.READDIRPLUS,1},{Nfs3Constant.NFSPROC3.FSSTAT,1},{Nfs3Constant.NFSPROC3.FSINFO,1},{Nfs3Constant.NFSPROC3.PATHCONF,1},{Nfs3Constant.NFSPROC3.COMMIT,1}};
  for (  Object[] procedure : procedures) {
    boolean idempotent=procedure[1].equals(Integer.valueOf(1));
    Nfs3Constant.NFSPROC3 proc=(Nfs3Constant.NFSPROC3)procedure[0];
    if (idempotent) {
      Assert.assertTrue(("Procedure " + proc + " should be idempotent"),proc.isIdempotent());
    }
 else {
      Assert.assertFalse(("Procedure " + proc + " should be non-idempotent"),proc.isIdempotent());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.security.token.block.TestBlockToken </h4><pre class="type-9 type-13 type-11 type-2 type-7 type-15 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that fast repeated invocations of createClientDatanodeProtocolProxy
 * will not end up using up thousands of sockets. This is a regression test
 * for HDFS-1965.
 */
@Test public void testBlockTokenRpcLeak() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  UserGroupInformation.setConfiguration(conf);
  Assume.assumeTrue(FD_DIR.exists());
  BlockTokenSecretManager sm=new BlockTokenSecretManager(blockKeyUpdateInterval,blockTokenLifetime,0,"fake-pool",null);
  Token<BlockTokenIdentifier> token=sm.generateToken(block3,EnumSet.allOf(BlockTokenSecretManager.AccessMode.class));
  final Server server=createMockDatanode(sm,token,conf);
  server.start();
  final InetSocketAddress addr=NetUtils.getConnectAddress(server);
  DatanodeID fakeDnId=DFSTestUtil.getLocalDatanodeID(addr.getPort());
  ExtendedBlock b=new ExtendedBlock("fake-pool",new Block(12345L));
  LocatedBlock fakeBlock=new LocatedBlock(b,new DatanodeInfo[0]);
  fakeBlock.setBlockToken(token);
  ClientDatanodeProtocol proxyToNoWhere=RPC.getProxy(ClientDatanodeProtocol.class,ClientDatanodeProtocol.versionID,new InetSocketAddress("1.1.1.1",1),UserGroupInformation.createRemoteUser("junk"),conf,NetUtils.getDefaultSocketFactory(conf));
  ClientDatanodeProtocol proxy=null;
  int fdsAtStart=countOpenFileDescriptors();
  try {
    long endTime=Time.now() + 3000;
    while (Time.now() < endTime) {
      proxy=DFSUtil.createClientDatanodeProtocolProxy(fakeDnId,conf,1000,false,fakeBlock);
      assertEquals(block3.getBlockId(),proxy.getReplicaVisibleLength(block3));
      if (proxy != null) {
        RPC.stopProxy(proxy);
      }
      LOG.info("Num open fds:" + countOpenFileDescriptors());
    }
    int fdsAtEnd=countOpenFileDescriptors();
    if (fdsAtEnd - fdsAtStart > 50) {
      fail("Leaked " + (fdsAtEnd - fdsAtStart) + " fds!");
    }
  }
  finally {
    server.stop();
  }
  RPC.stopProxy(proxyToNoWhere);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.blockmanagement.TestBlocksWithNotEnoughRacks </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorruptBlockRereplicatedAcrossRacks() throws Exception {
  Configuration conf=getConf();
  short REPLICATION_FACTOR=2;
  int fileLen=512;
  final Path filePath=new Path("/testFile");
  String racks[]={"/rack1","/rack1","/rack2","/rack2"};
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(racks.length).racks(racks).build();
  final FSNamesystem ns=cluster.getNameNode().getNamesystem();
  try {
    final FileSystem fs=cluster.getFileSystem();
    DFSTestUtil.createFile(fs,filePath,fileLen,REPLICATION_FACTOR,1L);
    final String fileContent=DFSTestUtil.readFile(fs,filePath);
    ExtendedBlock b=DFSTestUtil.getFirstBlock(fs,filePath);
    DFSTestUtil.waitForReplication(cluster,b,2,REPLICATION_FACTOR,0);
    int dnToCorrupt=DFSTestUtil.firstDnWithBlock(cluster,b);
    assertTrue(MiniDFSCluster.corruptReplica(dnToCorrupt,b));
    cluster.restartDataNode(dnToCorrupt);
    DFSTestUtil.waitCorruptReplicas(fs,ns,filePath,b,1);
    DFSTestUtil.waitForReplication(cluster,b,2,REPLICATION_FACTOR,0);
    for (int i=0; i < racks.length; i++) {
      String blockContent=cluster.readBlockOnDataNode(i,b);
      if (blockContent != null && i != dnToCorrupt) {
        assertEquals("Corrupt replica",fileContent,blockContent);
      }
    }
  }
  finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.blockmanagement.TestComputeInvalidateWork </h4><pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test if {@link FSNamesystem#computeInvalidateWork(int)}can schedule invalidate work correctly 
 */
@Test public void testCompInvalidate() throws Exception {
  final Configuration conf=new HdfsConfiguration();
  final int NUM_OF_DATANODES=3;
  final MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_OF_DATANODES).build();
  try {
    cluster.waitActive();
    final FSNamesystem namesystem=cluster.getNamesystem();
    final BlockManager bm=namesystem.getBlockManager();
    final int blockInvalidateLimit=bm.getDatanodeManager().blockInvalidateLimit;
    final DatanodeDescriptor[] nodes=bm.getDatanodeManager().getHeartbeatManager().getDatanodes();
    assertEquals(nodes.length,NUM_OF_DATANODES);
    namesystem.writeLock();
    try {
      for (int i=0; i < nodes.length; i++) {
        for (int j=0; j < 3 * blockInvalidateLimit + 1; j++) {
          Block block=new Block(i * (blockInvalidateLimit + 1) + j,0,GenerationStamp.LAST_RESERVED_STAMP);
          bm.addToInvalidates(block,nodes[i]);
        }
      }
      assertEquals(blockInvalidateLimit * NUM_OF_DATANODES,bm.computeInvalidateWork(NUM_OF_DATANODES + 1));
      assertEquals(blockInvalidateLimit * NUM_OF_DATANODES,bm.computeInvalidateWork(NUM_OF_DATANODES));
      assertEquals(blockInvalidateLimit * (NUM_OF_DATANODES - 1),bm.computeInvalidateWork(NUM_OF_DATANODES - 1));
      int workCount=bm.computeInvalidateWork(1);
      if (workCount == 1) {
        assertEquals(blockInvalidateLimit + 1,bm.computeInvalidateWork(2));
      }
 else {
        assertEquals(workCount,blockInvalidateLimit);
        assertEquals(2,bm.computeInvalidateWork(2));
      }
    }
  finally {
      namesystem.writeUnlock();
    }
  }
  finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestBlockRecovery </h4><pre class="type-4 type-11 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Cleans the resources and closes the instance of datanode
 * @throws IOException if an error occurred
 */
@After public void tearDown() throws IOException {
  if (!tearDownDone && dn != null) {
    try {
      dn.shutdown();
    }
 catch (    Exception e) {
      LOG.error("Cannot close: ",e);
    }
 finally {
      File dir=new File(DATA_DIR);
      if (dir.exists())       Assert.assertTrue("Cannot delete data-node dirs",FileUtil.fullyDelete(dir));
    }
    tearDownDone=true;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestAddBlockRetry </h4><pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Retry addBlock() while another thread is in chooseTarget().
 * See HDFS-4452.
 */
@Test public void testRetryAddBlockWhileInChooseTarget() throws Exception {
  final String src="/testRetryAddBlockWhileInChooseTarget";
  FSNamesystem ns=cluster.getNamesystem();
  BlockManager spyBM=spy(ns.getBlockManager());
  final NamenodeProtocols nn=cluster.getNameNodeRpc();
  Class<? extends FSNamesystem> nsClass=ns.getClass();
  Field bmField=nsClass.getDeclaredField("blockManager");
  bmField.setAccessible(true);
  bmField.set(ns,spyBM);
  doAnswer(new Answer<DatanodeStorageInfo[]>(){
    @Override public DatanodeStorageInfo[] answer(    InvocationOnMock invocation) throws Throwable {
      LOG.info("chooseTarget for " + src);
      DatanodeStorageInfo[] ret=(DatanodeStorageInfo[])invocation.callRealMethod();
      count++;
      if (count == 1) {
        LOG.info("Starting second addBlock for " + src);
        nn.addBlock(src,"clientName",null,null,INodeId.GRANDFATHER_INODE_ID,null);
        LocatedBlocks lbs=nn.getBlockLocations(src,0,Long.MAX_VALUE);
        assertEquals("Must be one block",1,lbs.getLocatedBlocks().size());
        lb2=lbs.get(0);
        assertEquals("Wrong replication",REPLICATION,lb2.getLocations().length);
      }
      return ret;
    }
  }
).when(spyBM).chooseTarget(Mockito.anyString(),Mockito.anyInt(),Mockito.<DatanodeDescriptor>any(),Mockito.<HashSet<Node>>any(),Mockito.anyLong(),Mockito.<List<String>>any());
  nn.create(src,FsPermission.getFileDefault(),"clientName",new EnumSetWritable<CreateFlag>(EnumSet.of(CreateFlag.CREATE)),true,(short)3,1024,null);
  LOG.info("Starting first addBlock for " + src);
  nn.addBlock(src,"clientName",null,null,INodeId.GRANDFATHER_INODE_ID,null);
  LocatedBlocks lbs=nn.getBlockLocations(src,0,Long.MAX_VALUE);
  assertEquals("Must be one block",1,lbs.getLocatedBlocks().size());
  lb1=lbs.get(0);
  assertEquals("Wrong replication",REPLICATION,lb1.getLocations().length);
  assertEquals("Blocks are not equal",lb1.getBlock(),lb2.getBlock());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestClusterId </h4><pre class="type-9 type-11 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test namenode format with -format -force -clusterid option when name
 * directory exists. Format should succeed.
 * @throws IOException
 */
@Test public void testFormatWithForceAndClusterId() throws IOException {
  if (!hdfsDir.mkdirs()) {
    fail("Failed to create dir " + hdfsDir.getPath());
  }
  String myId="testFormatWithForceAndClusterId";
  String[] argv={"-format","-force","-clusterid",myId};
  try {
    NameNode.createNameNode(argv,config);
    fail("createNameNode() did not call System.exit()");
  }
 catch (  ExitException e) {
    assertEquals("Format should have succeeded",0,e.status);
  }
  String cId=getClusterId(config);
  assertEquals("ClusterIds do not match",myId,cId);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test namenode format with -format -force options when name directory
 * exists. Format should succeed.
 * @throws IOException
 */
@Test public void testFormatWithForce() throws IOException {
  if (!hdfsDir.mkdirs()) {
    fail("Failed to create dir " + hdfsDir.getPath());
  }
  String[] argv={"-format","-force"};
  try {
    NameNode.createNameNode(argv,config);
    fail("createNameNode() did not call System.exit()");
  }
 catch (  ExitException e) {
    assertEquals("Format should have succeeded",0,e.status);
  }
  String cid=getClusterId(config);
  assertTrue("Didn't get new ClusterId",(cid != null && !cid.equals("")));
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test namenode format with -force -nonInteractive -force option. Format
 * should succeed.
 * @throws IOException
 */
@Test public void testFormatWithNonInteractiveAndForce() throws IOException {
  if (!hdfsDir.mkdirs()) {
    fail("Failed to create dir " + hdfsDir.getPath());
  }
  String[] argv={"-format","-nonInteractive","-force"};
  try {
    NameNode.createNameNode(argv,config);
    fail("createNameNode() did not call System.exit()");
  }
 catch (  ExitException e) {
    assertEquals("Format should have succeeded",0,e.status);
  }
  String cid=getClusterId(config);
  assertTrue("Didn't get new ClusterId",(cid != null && !cid.equals("")));
}

</code></pre>

<br>
<pre class="type-11 type-2 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test namenode format with -format option when a non empty name directory
 * exists. Enter N when prompted and format should be aborted.
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testFormatWithoutForceEnterNo() throws IOException, InterruptedException {
  File data=new File(hdfsDir,"file");
  if (!data.mkdirs()) {
    fail("Failed to create dir " + data.getPath());
  }
  InputStream origIn=System.in;
  ByteArrayInputStream bins=new ByteArrayInputStream("N\n".getBytes());
  System.setIn(bins);
  String[] argv={"-format"};
  try {
    NameNode.createNameNode(argv,config);
    fail("createNameNode() did not call System.exit()");
  }
 catch (  ExitException e) {
    assertEquals("Format should not have succeeded",1,e.status);
  }
  System.setIn(origIn);
  File version=new File(hdfsDir,"current/VERSION");
  assertFalse("Check version should not exist",version.exists());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test namenode format with -format option when an empty name directory
 * exists. Format should succeed.
 * @throws IOException
 */
@Test public void testFormatWithEmptyDir() throws IOException {
  if (!hdfsDir.mkdirs()) {
    fail("Failed to create dir " + hdfsDir.getPath());
  }
  String[] argv={"-format"};
  try {
    NameNode.createNameNode(argv,config);
    fail("createNameNode() did not call System.exit()");
  }
 catch (  ExitException e) {
    assertEquals("Format should have succeeded",0,e.status);
  }
  String cid=getClusterId(config);
  assertTrue("Didn't get new ClusterId",(cid != null && !cid.equals("")));
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test namenode format with -format option when a non empty name directory
 * exists. Enter Y when prompted and the format should succeed.
 * @throws IOException
 * @throws InterruptedException
 */
@Test public void testFormatWithoutForceEnterYes() throws IOException, InterruptedException {
  File data=new File(hdfsDir,"file");
  if (!data.mkdirs()) {
    fail("Failed to create dir " + data.getPath());
  }
  InputStream origIn=System.in;
  ByteArrayInputStream bins=new ByteArrayInputStream("Y\n".getBytes());
  System.setIn(bins);
  String[] argv={"-format"};
  try {
    NameNode.createNameNode(argv,config);
    fail("createNameNode() did not call System.exit()");
  }
 catch (  ExitException e) {
    assertEquals("Format should have succeeded",0,e.status);
  }
  System.setIn(origIn);
  String cid=getClusterId(config);
  assertTrue("Didn't get new ClusterId",(cid != null && !cid.equals("")));
}

</code></pre>

<br>
<pre class="type-11 type-2 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test namenode format with -format -nonInteractive options when a non empty
 * name directory exists. Format should not succeed.
 * @throws IOException
 */
@Test public void testFormatWithNonInteractive() throws IOException {
  File data=new File(hdfsDir,"file");
  if (!data.mkdirs()) {
    fail("Failed to create dir " + data.getPath());
  }
  String[] argv={"-format","-nonInteractive"};
  try {
    NameNode.createNameNode(argv,config);
    fail("createNameNode() did not call System.exit()");
  }
 catch (  ExitException e) {
    assertEquals("Format should have been aborted with exit code 1",1,e.status);
  }
  File version=new File(hdfsDir,"current/VERSION");
  assertFalse("Check version should not exist",version.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestDecommissioningStatus </h4><pre class="type-13 type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests Decommissioning Status in DFS.
 */
@Test public void testDecommissionStatus() throws IOException, InterruptedException {
  InetSocketAddress addr=new InetSocketAddress("localhost",cluster.getNameNodePort());
  DFSClient client=new DFSClient(addr,conf);
  DatanodeInfo[] info=client.datanodeReport(DatanodeReportType.LIVE);
  assertEquals("Number of Datanodes ",2,info.length);
  DistributedFileSystem fileSys=cluster.getFileSystem();
  DFSAdmin admin=new DFSAdmin(cluster.getConfiguration(0));
  short replicas=2;
  Path file1=new Path("decommission.dat");
  DFSTestUtil.createFile(fileSys,file1,fileSize,fileSize,blockSize,replicas,seed);
  Path file2=new Path("decommission1.dat");
  FSDataOutputStream st1=writeIncompleteFile(fileSys,file2,replicas);
  Thread.sleep(5000);
  FSNamesystem fsn=cluster.getNamesystem();
  final DatanodeManager dm=fsn.getBlockManager().getDatanodeManager();
  for (int iteration=0; iteration < numDatanodes; iteration++) {
    String downnode=decommissionNode(fsn,client,localFileSys,iteration);
    dm.refreshNodes(conf);
    decommissionedNodes.add(downnode);
    Thread.sleep(5000);
    final List<DatanodeDescriptor> decommissioningNodes=dm.getDecommissioningNodes();
    if (iteration == 0) {
      assertEquals(decommissioningNodes.size(),1);
      DatanodeDescriptor decommNode=decommissioningNodes.get(0);
      checkDecommissionStatus(decommNode,4,0,2);
      checkDFSAdminDecommissionStatus(decommissioningNodes.subList(0,1),fileSys,admin);
    }
 else {
      assertEquals(decommissioningNodes.size(),2);
      DatanodeDescriptor decommNode1=decommissioningNodes.get(0);
      DatanodeDescriptor decommNode2=decommissioningNodes.get(1);
      checkDecommissionStatus(decommNode1,4,4,2);
      checkDecommissionStatus(decommNode2,4,4,2);
      checkDFSAdminDecommissionStatus(decommissioningNodes.subList(0,2),fileSys,admin);
    }
  }
  writeConfigFile(localFileSys,excludeFile,null);
  dm.refreshNodes(conf);
  st1.close();
  cleanupFile(fileSys,file1);
  cleanupFile(fileSys,file2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestFSDirectory </h4><pre class="type-9 type-13 type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Dump the tree, make some changes, and then dump the tree again. 
 */
@Test public void testDumpTree() throws Exception {
  final INode root=fsdir.getINode("/");
  LOG.info("Original tree");
  final StringBuffer b1=root.dumpTreeRecursively();
  System.out.println("b1=" + b1);
  final BufferedReader in=new BufferedReader(new StringReader(b1.toString()));
  String line=in.readLine();
  checkClassName(line);
  for (; (line=in.readLine()) != null; ) {
    line=line.trim();
    if (!line.isEmpty() && !line.contains("snapshot")) {
      assertTrue("line=" + line,line.startsWith(INodeDirectory.DUMPTREE_LAST_ITEM) || line.startsWith(INodeDirectory.DUMPTREE_EXCEPT_LAST_ITEM));
      checkClassName(line);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestFsck </h4><pre class="type-9 type-13 type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFsckMoveAndDelete() throws Exception {
  final int MAX_MOVE_TRIES=5;
  DFSTestUtil util=new DFSTestUtil.Builder().setName("TestFsckMoveAndDelete").setNumFiles(5).build();
  MiniDFSCluster cluster=null;
  FileSystem fs=null;
  try {
    Configuration conf=new HdfsConfiguration();
    conf.setLong(DFSConfigKeys.DFS_BLOCKREPORT_INTERVAL_MSEC_KEY,10000L);
    conf.setInt(DFSConfigKeys.DFS_DATANODE_DIRECTORYSCAN_INTERVAL_KEY,1);
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(4).build();
    String topDir="/srcdat";
    fs=cluster.getFileSystem();
    cluster.waitActive();
    util.createFiles(fs,topDir);
    util.waitReplication(fs,topDir,(short)3);
    String outStr=runFsck(conf,0,true,"/");
    assertTrue(outStr.contains(NamenodeFsck.HEALTHY_STATUS));
    String[] fileNames=util.getFileNames(topDir);
    DFSClient dfsClient=new DFSClient(new InetSocketAddress("localhost",cluster.getNameNodePort()),conf);
    String corruptFileName=fileNames[0];
    ExtendedBlock block=dfsClient.getNamenode().getBlockLocations(corruptFileName,0,Long.MAX_VALUE).get(0).getBlock();
    for (int i=0; i < 4; i++) {
      File blockFile=MiniDFSCluster.getBlockFile(i,block);
      if (blockFile != null && blockFile.exists()) {
        assertTrue(blockFile.delete());
      }
    }
    outStr=runFsck(conf,1,false,"/");
    while (!outStr.contains(NamenodeFsck.CORRUPT_STATUS)) {
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException ignore) {
      }
      outStr=runFsck(conf,1,false,"/");
    }
    for (int i=0; i < MAX_MOVE_TRIES; i++) {
      outStr=runFsck(conf,1,true,"/","-move");
      assertTrue(outStr.contains(NamenodeFsck.CORRUPT_STATUS));
      String[] newFileNames=util.getFileNames(topDir);
      boolean found=false;
      for (      String f : newFileNames) {
        if (f.equals(corruptFileName)) {
          found=true;
          break;
        }
      }
      assertTrue(found);
    }
    outStr=runFsck(conf,1,true,"/","-move","-delete");
    assertTrue(outStr.contains(NamenodeFsck.CORRUPT_STATUS));
    outStr=runFsck(conf,0,true,"/");
    assertTrue(outStr.contains(NamenodeFsck.HEALTHY_STATUS));
    util.cleanup(fs,topDir);
    if (fs != null) {
      try {
        fs.close();
      }
 catch (      Exception e) {
      }
    }
    cluster.shutdown();
  }
  finally {
    if (fs != null) {
      try {
        fs.close();
      }
 catch (      Exception e) {
      }
    }
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testFsckMove() throws Exception {
  Configuration conf=new HdfsConfiguration();
  final int DFS_BLOCK_SIZE=1024;
  final int NUM_DATANODES=4;
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,DFS_BLOCK_SIZE);
  conf.setLong(DFSConfigKeys.DFS_BLOCKREPORT_INTERVAL_MSEC_KEY,10000L);
  conf.setInt(DFSConfigKeys.DFS_DATANODE_DIRECTORYSCAN_INTERVAL_KEY,1);
  DFSTestUtil util=new DFSTestUtil("TestFsck",5,3,(5 * DFS_BLOCK_SIZE) + (DFS_BLOCK_SIZE - 1),5 * DFS_BLOCK_SIZE);
  MiniDFSCluster cluster=null;
  FileSystem fs=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATANODES).build();
    String topDir="/srcdat";
    fs=cluster.getFileSystem();
    cluster.waitActive();
    util.createFiles(fs,topDir);
    util.waitReplication(fs,topDir,(short)3);
    String outStr=runFsck(conf,0,true,"/");
    assertTrue(outStr.contains(NamenodeFsck.HEALTHY_STATUS));
    DFSClient dfsClient=new DFSClient(new InetSocketAddress("localhost",cluster.getNameNodePort()),conf);
    String fileNames[]=util.getFileNames(topDir);
    CorruptedTestFile ctFiles[]=new CorruptedTestFile[]{new CorruptedTestFile(fileNames[0],Sets.newHashSet(0),dfsClient,NUM_DATANODES,DFS_BLOCK_SIZE),new CorruptedTestFile(fileNames[1],Sets.newHashSet(2,3),dfsClient,NUM_DATANODES,DFS_BLOCK_SIZE),new CorruptedTestFile(fileNames[2],Sets.newHashSet(4),dfsClient,NUM_DATANODES,DFS_BLOCK_SIZE),new CorruptedTestFile(fileNames[3],Sets.newHashSet(0,1,2,3),dfsClient,NUM_DATANODES,DFS_BLOCK_SIZE),new CorruptedTestFile(fileNames[4],Sets.newHashSet(1,2,3,4),dfsClient,NUM_DATANODES,DFS_BLOCK_SIZE)};
    int totalMissingBlocks=0;
    for (    CorruptedTestFile ctFile : ctFiles) {
      totalMissingBlocks+=ctFile.getTotalMissingBlocks();
    }
    for (    CorruptedTestFile ctFile : ctFiles) {
      ctFile.removeBlocks();
    }
    while (true) {
      outStr=runFsck(conf,1,false,"/");
      String numCorrupt=null;
      for (      String line : outStr.split(LINE_SEPARATOR)) {
        Matcher m=numCorruptBlocksPattern.matcher(line);
        if (m.matches()) {
          numCorrupt=m.group(1);
          break;
        }
      }
      if (numCorrupt == null) {
        throw new IOException("failed to find number of corrupt " + "blocks in fsck output.");
      }
      if (numCorrupt.equals(Integer.toString(totalMissingBlocks))) {
        assertTrue(outStr.contains(NamenodeFsck.CORRUPT_STATUS));
        break;
      }
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException ignore) {
      }
    }
    outStr=runFsck(conf,1,false,"/","-move");
    assertTrue(outStr.contains(NamenodeFsck.CORRUPT_STATUS));
    for (    CorruptedTestFile ctFile : ctFiles) {
      ctFile.checkSalvagedRemains();
    }
    outStr=runFsck(conf,1,true,"/","-delete");
    assertTrue(outStr.contains(NamenodeFsck.CORRUPT_STATUS));
    outStr=runFsck(conf,0,true,"/");
    assertTrue(outStr.contains(NamenodeFsck.HEALTHY_STATUS));
    util.cleanup(fs,topDir);
  }
  finally {
    if (fs != null) {
      try {
        fs.close();
      }
 catch (      Exception e) {
      }
    }
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestGenericJournalConf </h4><pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test that a implementation of JournalManager without a 
 * (Configuration,URI) constructor throws an exception
 */
@Test public void testBadConstructor() throws Exception {
  MiniDFSCluster cluster=null;
  Configuration conf=new Configuration();
  conf.set(DFSConfigKeys.DFS_NAMENODE_EDITS_PLUGIN_PREFIX + ".dummy",BadConstructorJournalManager.class.getName());
  conf.set(DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_KEY,"dummy://test");
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(0).build();
    cluster.waitActive();
    fail("Should have failed before this point");
  }
 catch (  IllegalArgumentException iae) {
    if (!iae.getMessage().contains("Unable to construct journal")) {
      fail("Should have failed with unable to construct exception");
    }
  }
 finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestMetaSave </h4><pre class="type-13 type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Tests that metasave overwrites the output file (not append).
 */
@Test public void testMetaSaveOverwrite() throws Exception {
  namesystem.metaSave("metaSaveOverwrite.out.txt");
  namesystem.metaSave("metaSaveOverwrite.out.txt");
  FileInputStream fis=null;
  InputStreamReader isr=null;
  BufferedReader rdr=null;
  try {
    fis=new FileInputStream(getLogFile("metaSaveOverwrite.out.txt"));
    isr=new InputStreamReader(fis);
    rdr=new BufferedReader(isr);
    boolean foundLiveDatanodesLine=false;
    String line=rdr.readLine();
    while (line != null) {
      if (line.startsWith("Live Datanodes")) {
        if (foundLiveDatanodesLine) {
          fail("multiple Live Datanodes lines, output file not overwritten");
        }
        foundLiveDatanodesLine=true;
      }
      line=rdr.readLine();
    }
  }
  finally {
    IOUtils.cleanup(null,rdr,isr,fis);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.ha.TestHASafeMode </h4><pre class="type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * DFS#isInSafeMode should check the ActiveNNs safemode in HA enabled cluster. HDFS-3507
 * @throws Exception
 */
@Test public void testIsInSafemode() throws Exception {
  NameNode nn2=cluster.getNameNode(1);
  assertTrue("nn2 should be in standby state",nn2.isStandbyState());
  InetSocketAddress nameNodeAddress=nn2.getNameNodeAddress();
  Configuration conf=new Configuration();
  DistributedFileSystem dfs=new DistributedFileSystem();
  try {
    dfs.initialize(URI.create("hdfs://" + nameNodeAddress.getHostName() + ":"+ nameNodeAddress.getPort()),conf);
    dfs.isInSafeMode();
    fail("StandBy should throw exception for isInSafeMode");
  }
 catch (  IOException e) {
    if (e instanceof RemoteException) {
      IOException sbExcpetion=((RemoteException)e).unwrapRemoteException();
      assertTrue("StandBy nn should not support isInSafeMode",sbExcpetion instanceof StandbyException);
    }
 else {
      throw e;
    }
  }
 finally {
    if (null != dfs) {
      dfs.close();
    }
  }
  cluster.transitionToStandby(0);
  cluster.transitionToActive(1);
  cluster.getNameNodeRpc(1).setSafeMode(SafeModeAction.SAFEMODE_ENTER,false);
  DistributedFileSystem dfsWithFailOver=(DistributedFileSystem)fs;
  assertTrue("ANN should be in SafeMode",dfsWithFailOver.isInSafeMode());
  cluster.getNameNodeRpc(1).setSafeMode(SafeModeAction.SAFEMODE_LEAVE,false);
  assertFalse("ANN should be out of SafeMode",dfsWithFailOver.isInSafeMode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.ha.TestPipelinesFailover </h4><pre class="type-9 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the scenario where the NN fails over after issuing a block
 * synchronization request, but before it is committed. The
 * DN running the recovery should then fail to commit the synchronization
 * and a later retry will succeed.
 */
@Test(timeout=30000) public void testFailoverRightBeforeCommitSynchronization() throws Exception {
  final Configuration conf=new Configuration();
  conf.setBoolean(DFSConfigKeys.DFS_PERMISSIONS_ENABLED_KEY,false);
  conf.setInt(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,BLOCK_SIZE);
  FSDataOutputStream stm=null;
  final MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleHATopology()).numDataNodes(3).build();
  try {
    cluster.waitActive();
    cluster.transitionToActive(0);
    Thread.sleep(500);
    LOG.info("Starting with NN 0 active");
    FileSystem fs=HATestUtil.configureFailoverFs(cluster,conf);
    stm=fs.create(TEST_PATH);
    AppendTestUtil.write(stm,0,BLOCK_SIZE / 2);
    stm.hflush();
    NameNode nn0=cluster.getNameNode(0);
    ExtendedBlock blk=DFSTestUtil.getFirstBlock(fs,TEST_PATH);
    DatanodeDescriptor expectedPrimary=DFSTestUtil.getExpectedPrimaryNode(nn0,blk);
    LOG.info("Expecting block recovery to be triggered on DN " + expectedPrimary);
    DataNode primaryDN=cluster.getDataNode(expectedPrimary.getIpcPort());
    DatanodeProtocolClientSideTranslatorPB nnSpy=DataNodeTestUtils.spyOnBposToNN(primaryDN,nn0);
    DelayAnswer delayer=new DelayAnswer(LOG);
    Mockito.doAnswer(delayer).when(nnSpy).commitBlockSynchronization(Mockito.eq(blk),Mockito.anyInt(),Mockito.anyLong(),Mockito.eq(true),Mockito.eq(false),(DatanodeID[])Mockito.anyObject(),(String[])Mockito.anyObject());
    DistributedFileSystem fsOtherUser=createFsAsOtherUser(cluster,conf);
    assertFalse(fsOtherUser.recoverLease(TEST_PATH));
    LOG.info("Waiting for commitBlockSynchronization call from primary");
    delayer.waitForCall();
    LOG.info("Failing over to NN 1");
    cluster.transitionToStandby(0);
    cluster.transitionToActive(1);
    delayer.proceed();
    delayer.waitForResult();
    Throwable t=delayer.getThrown();
    if (t == null) {
      fail("commitBlockSynchronization call did not fail on standby");
    }
    GenericTestUtils.assertExceptionContains("Operation category WRITE is not supported",t);
    loopRecoverLease(fsOtherUser,TEST_PATH);
    AppendTestUtil.check(fs,TEST_PATH,BLOCK_SIZE / 2);
  }
  finally {
    IOUtils.closeStream(stm);
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.tools.TestGetConf </h4><pre class="type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Tests commands other than {@link Command#NAMENODE}, {@link Command#BACKUP},{@link Command#SECONDARY} and {@link Command#NNRPCADDRESSES}
 */
@Test(timeout=10000) public void testTool() throws Exception {
  HdfsConfiguration conf=new HdfsConfiguration(false);
  for (  Command cmd : Command.values()) {
    CommandHandler handler=Command.getHandler(cmd.getName());
    if (handler.key != null && !"-confKey".equals(cmd.getName())) {
      String[] args={cmd.getName()};
      conf.set(handler.key,"value");
      assertTrue(runTool(conf,args,true).contains("value"));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.util.TestBestEffortLongFile </h4><pre class="type-11 type-8 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void cleanup(){
  if (FILE.exists()) {
    assertTrue(FILE.delete());
  }
  FILE.getParentFile().mkdirs();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.http.TestServletFilter </h4><pre class="type-13 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testServletFilter() throws Exception {
  Configuration conf=new Configuration();
  conf.set(HttpServer2.FILTER_INITIALIZER_PROPERTY,SimpleFilter.Initializer.class.getName());
  HttpServer2 http=createTestServer(conf);
  http.start();
  final String fsckURL="/fsck";
  final String stacksURL="/stacks";
  final String ajspURL="/a.jsp";
  final String logURL="/logs/a.log";
  final String hadooplogoURL="/static/hadoop-logo.jpg";
  final String[] urls={fsckURL,stacksURL,ajspURL,logURL,hadooplogoURL};
  final Random ran=new Random();
  final int[] sequence=new int[50];
  for (int i=0; i < sequence.length; i++) {
    sequence[i]=ran.nextInt(urls.length);
  }
  final String prefix="http://" + NetUtils.getHostPortString(http.getConnectorAddress(0));
  try {
    for (int i=0; i < sequence.length; i++) {
      access(prefix + urls[sequence[i]]);
      if (sequence[i] == 0) {
        assertEquals(null,uri);
      }
 else {
        assertEquals(urls[sequence[i]],uri);
        uri=null;
      }
    }
  }
  finally {
    http.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.TestMapFile </h4><pre class="type-11 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  LocalFileSystem fs=FileSystem.getLocal(conf);
  if (fs.exists(TEST_DIR) && !fs.delete(TEST_DIR,true)) {
    Assert.fail("Can't clean up test root dir");
  }
  fs.mkdirs(TEST_DIR);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Writer.testFix} method
 */
@Test public void testFix(){
  final String INDEX_LESS_MAP_FILE="testFix.mapfile";
  int PAIR_SIZE=20;
  MapFile.Writer writer=null;
  try {
    FileSystem fs=FileSystem.getLocal(conf);
    Path dir=new Path(TEST_DIR,INDEX_LESS_MAP_FILE);
    writer=createWriter(INDEX_LESS_MAP_FILE,IntWritable.class,Text.class);
    for (int i=0; i < PAIR_SIZE; i++)     writer.append(new IntWritable(0),new Text("value"));
    writer.close();
    File indexFile=new File(".","." + INDEX_LESS_MAP_FILE + "/index");
    boolean isDeleted=false;
    if (indexFile.exists())     isDeleted=indexFile.delete();
    if (isDeleted)     assertTrue("testFix error !!!",MapFile.fix(fs,dir,IntWritable.class,Text.class,true,conf) == PAIR_SIZE);
  }
 catch (  Exception ex) {
    fail("testFix error !!!");
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.compress.TestCodec </h4><pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLz4Codec() throws IOException {
  if (NativeCodeLoader.isNativeCodeLoaded()) {
    if (Lz4Codec.isNativeCodeLoaded()) {
      conf.setBoolean(CommonConfigurationKeys.IO_COMPRESSION_CODEC_LZ4_USELZ4HC_KEY,false);
      codecTest(conf,seed,0,"org.apache.hadoop.io.compress.Lz4Codec");
      codecTest(conf,seed,count,"org.apache.hadoop.io.compress.Lz4Codec");
      conf.setBoolean(CommonConfigurationKeys.IO_COMPRESSION_CODEC_LZ4_USELZ4HC_KEY,true);
      codecTest(conf,seed,0,"org.apache.hadoop.io.compress.Lz4Codec");
      codecTest(conf,seed,count,"org.apache.hadoop.io.compress.Lz4Codec");
    }
 else {
      Assert.fail("Native hadoop library available but lz4 not");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.compress.zlib.TestZlibCompressorDecompressor </h4><pre class="type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZlibCompressorDecompressorWithConfiguration(){
  Configuration conf=new Configuration();
  conf.setBoolean(CommonConfigurationKeys.IO_NATIVE_LIB_AVAILABLE_KEY,true);
  if (ZlibFactory.isNativeZlibLoaded(conf)) {
    byte[] rawData;
    int tryNumber=5;
    int BYTE_SIZE=10 * 1024;
    Compressor zlibCompressor=ZlibFactory.getZlibCompressor(conf);
    Decompressor zlibDecompressor=ZlibFactory.getZlibDecompressor(conf);
    rawData=generate(BYTE_SIZE);
    try {
      for (int i=0; i < tryNumber; i++)       compressDecompressZlib(rawData,(ZlibCompressor)zlibCompressor,(ZlibDecompressor)zlibDecompressor);
      zlibCompressor.reinit(conf);
    }
 catch (    Exception ex) {
      fail("testZlibCompressorDecompressorWithConfiguration ex error " + ex);
    }
  }
 else {
    assertTrue("ZlibFactory is using native libs against request",ZlibFactory.isNativeZlibLoaded(conf));
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testZlibCompressorDecompressorSetDictionary(){
  Configuration conf=new Configuration();
  conf.setBoolean(CommonConfigurationKeys.IO_NATIVE_LIB_AVAILABLE_KEY,true);
  if (ZlibFactory.isNativeZlibLoaded(conf)) {
    Compressor zlibCompressor=ZlibFactory.getZlibCompressor(conf);
    Decompressor zlibDecompressor=ZlibFactory.getZlibDecompressor(conf);
    checkSetDictionaryNullPointerException(zlibCompressor);
    checkSetDictionaryNullPointerException(zlibDecompressor);
    checkSetDictionaryArrayIndexOutOfBoundsException(zlibDecompressor);
    checkSetDictionaryArrayIndexOutOfBoundsException(zlibCompressor);
  }
 else {
    assertTrue("ZlibFactory is using native libs against request",ZlibFactory.isNativeZlibLoaded(conf));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.file.tfile.TestTFileByteArrays </h4><pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testFailureCompressionNotWorking() throws IOException {
  if (skip)   return;
  long rawDataSize=writeRecords(10 * records1stBlock,false);
  if (!compression.equalsIgnoreCase(Compression.Algorithm.NONE.getName())) {
    Assert.assertTrue(out.getPos() < rawDataSize);
  }
  closeOutput();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.nativeio.TestNativeIO </h4><pre class="type-11 type-2 type-7 type-10 type-15 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testRenameTo() throws Exception {
  final File TEST_DIR=new File(new File(System.getProperty("test.build.data","build/test/data")),"renameTest");
  assumeTrue(TEST_DIR.mkdirs());
  File nonExistentFile=new File(TEST_DIR,"nonexistent");
  File targetFile=new File(TEST_DIR,"target");
  try {
    NativeIO.renameTo(nonExistentFile,targetFile);
    Assert.fail();
  }
 catch (  NativeIOException e) {
    if (Path.WINDOWS) {
      Assert.assertEquals(String.format("The system cannot find the file specified.%n"),e.getMessage());
    }
 else {
      Assert.assertEquals(Errno.ENOENT,e.getErrno());
    }
  }
  File sourceFile=new File(TEST_DIR,"source");
  Assert.assertTrue(sourceFile.createNewFile());
  NativeIO.renameTo(sourceFile,sourceFile);
  NativeIO.renameTo(sourceFile,targetFile);
  sourceFile=new File(TEST_DIR,"source");
  Assert.assertTrue(sourceFile.createNewFile());
  File badTarget=new File(targetFile,"subdir");
  try {
    NativeIO.renameTo(sourceFile,badTarget);
    Assert.fail();
  }
 catch (  NativeIOException e) {
    if (Path.WINDOWS) {
      Assert.assertEquals(String.format("The parameter is incorrect.%n"),e.getMessage());
    }
 else {
      Assert.assertEquals(Errno.ENOTDIR,e.getErrno());
    }
  }
  FileUtils.deleteQuietly(TEST_DIR);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.ipc.TestRPC </h4><pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRPCBuilder() throws IOException {
  try {
    new RPC.Builder(null).setProtocol(TestProtocol.class).setInstance(new TestImpl()).setBindAddress(ADDRESS).setPort(0).setNumHandlers(5).setVerbose(true).build();
    fail("Didn't throw HadoopIllegalArgumentException");
  }
 catch (  Exception e) {
    if (!(e instanceof HadoopIllegalArgumentException)) {
      fail("Expecting HadoopIllegalArgumentException but caught " + e);
    }
  }
  try {
    new RPC.Builder(conf).setInstance(new TestImpl()).setBindAddress(ADDRESS).setPort(0).setNumHandlers(5).setVerbose(true).build();
    fail("Didn't throw HadoopIllegalArgumentException");
  }
 catch (  Exception e) {
    if (!(e instanceof HadoopIllegalArgumentException)) {
      fail("Expecting HadoopIllegalArgumentException but caught " + e);
    }
  }
  try {
    new RPC.Builder(conf).setProtocol(TestProtocol.class).setBindAddress(ADDRESS).setPort(0).setNumHandlers(5).setVerbose(true).build();
    fail("Didn't throw HadoopIllegalArgumentException");
  }
 catch (  Exception e) {
    if (!(e instanceof HadoopIllegalArgumentException)) {
      fail("Expecting HadoopIllegalArgumentException but caught " + e);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestCombineTextInputFormat </h4><pre class="type-9 type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test using the gzip codec for reading
 */
@Test(timeout=10000) public void testGzip() throws IOException {
  JobConf job=new JobConf(defaultConf);
  CompressionCodec gzip=new GzipCodec();
  ReflectionUtils.setConf(gzip,job);
  localFs.delete(workDir,true);
  writeFile(localFs,new Path(workDir,"part1.txt.gz"),gzip,"the quick\nbrown\nfox jumped\nover\n the lazy\n dog\n");
  writeFile(localFs,new Path(workDir,"part2.txt.gz"),gzip,"this is a test\nof gzip\n");
  FileInputFormat.setInputPaths(job,workDir);
  CombineTextInputFormat format=new CombineTextInputFormat();
  InputSplit[] splits=format.getSplits(job,100);
  assertEquals("compressed splits == 1",1,splits.length);
  List<Text> results=readSplit(format,splits[0],job);
  assertEquals("splits[0] length",8,results.size());
  final String[] firstList={"the quick","brown","fox jumped","over"," the lazy"," dog"};
  final String[] secondList={"this is a test","of gzip"};
  String first=results.get(0).toString();
  if (first.equals(firstList[0])) {
    testResults(results,firstList,secondList);
  }
 else   if (first.equals(secondList[0])) {
    testResults(results,secondList,firstList);
  }
 else {
    fail("unexpected first token!");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestConcatenatedCompressedInput </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test using the raw Inflater codec for reading gzip files.
 */
@Test public void testPrototypeInflaterGzip() throws IOException {
  CompressionCodec gzip=new GzipCodec();
  localFs.delete(workDir,true);
  System.out.println(COLOR_BR_BLUE + "testPrototypeInflaterGzip() using " + "non-native/Java Inflater and manual gzip header/trailer parsing"+ COLOR_NORMAL);
  final String fn="concat" + gzip.getDefaultExtension();
  Path fnLocal=new Path(System.getProperty("test.concat.data","/tmp"),fn);
  Path fnHDFS=new Path(workDir,fn);
  localFs.copyFromLocalFile(fnLocal,fnHDFS);
  final FileInputStream in=new FileInputStream(fnLocal.toString());
  assertEquals("concat bytes available",148,in.available());
  byte[] compressedBuf=new byte[256];
  int numBytesRead=in.read(compressedBuf,0,10);
  assertEquals("header bytes read",10,numBytesRead);
  assertEquals("1st byte",0x1f,compressedBuf[0] & 0xff);
  assertEquals("2nd byte",0x8b,compressedBuf[1] & 0xff);
  assertEquals("3rd byte (compression method)",8,compressedBuf[2] & 0xff);
  byte flags=(byte)(compressedBuf[3] & 0xff);
  if ((flags & 0x04) != 0) {
    numBytesRead=in.read(compressedBuf,0,2);
    assertEquals("XLEN bytes read",2,numBytesRead);
    int xlen=((compressedBuf[1] << 8) | compressedBuf[0]) & 0xffff;
    in.skip(xlen);
  }
  if ((flags & 0x08) != 0) {
    while ((numBytesRead=in.read()) != 0) {
      assertFalse("unexpected end-of-file while reading filename",numBytesRead == -1);
    }
  }
  if ((flags & 0x10) != 0) {
    while ((numBytesRead=in.read()) != 0) {
      assertFalse("unexpected end-of-file while reading comment",numBytesRead == -1);
    }
  }
  if ((flags & 0xe0) != 0) {
    assertTrue("reserved bits are set??",(flags & 0xe0) == 0);
  }
  if ((flags & 0x02) != 0) {
    numBytesRead=in.read(compressedBuf,0,2);
    assertEquals("CRC16 bytes read",2,numBytesRead);
    int crc16=((compressedBuf[1] << 8) | compressedBuf[0]) & 0xffff;
  }
  numBytesRead=in.read(compressedBuf);
  byte[] uncompressedBuf=new byte[256];
  Inflater inflater=new Inflater(true);
  inflater.setInput(compressedBuf,0,numBytesRead);
  try {
    int numBytesUncompressed=inflater.inflate(uncompressedBuf);
    String outString=new String(uncompressedBuf,0,numBytesUncompressed,"UTF-8");
    System.out.println("uncompressed data of first gzip member = [" + outString + "]");
  }
 catch (  java.util.zip.DataFormatException ex) {
    throw new IOException(ex.getMessage());
  }
  in.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestOldCombinerGrouping </h4><pre class="type-9 type-11 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCombiner() throws Exception {
  if (!new File(TEST_ROOT_DIR).mkdirs()) {
    throw new RuntimeException("Could not create test dir: " + TEST_ROOT_DIR);
  }
  File in=new File(TEST_ROOT_DIR,"input");
  if (!in.mkdirs()) {
    throw new RuntimeException("Could not create test dir: " + in);
  }
  File out=new File(TEST_ROOT_DIR,"output");
  PrintWriter pw=new PrintWriter(new FileWriter(new File(in,"data.txt")));
  pw.println("A|a,1");
  pw.println("A|b,2");
  pw.println("B|a,3");
  pw.println("B|b,4");
  pw.println("B|c,5");
  pw.close();
  JobConf job=new JobConf();
  job.set("mapreduce.framework.name","local");
  TextInputFormat.setInputPaths(job,new Path(in.getPath()));
  TextOutputFormat.setOutputPath(job,new Path(out.getPath()));
  job.setMapperClass(Map.class);
  job.setReducerClass(Reduce.class);
  job.setInputFormat(TextInputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(LongWritable.class);
  job.setOutputFormat(TextOutputFormat.class);
  job.setOutputValueGroupingComparator(GroupComparator.class);
  job.setCombinerClass(Combiner.class);
  job.setCombinerKeyGroupingComparator(GroupComparator.class);
  job.setInt("min.num.spills.for.combine",0);
  JobClient client=new JobClient(job);
  RunningJob runningJob=client.submitJob(job);
  runningJob.waitForCompletion();
  if (runningJob.isSuccessful()) {
    Counters counters=runningJob.getCounters();
    long combinerInputRecords=counters.getGroup("org.apache.hadoop.mapreduce.TaskCounter").getCounter("COMBINE_INPUT_RECORDS");
    long combinerOutputRecords=counters.getGroup("org.apache.hadoop.mapreduce.TaskCounter").getCounter("COMBINE_OUTPUT_RECORDS");
    Assert.assertTrue(combinerInputRecords > 0);
    Assert.assertTrue(combinerInputRecords > combinerOutputRecords);
    BufferedReader br=new BufferedReader(new FileReader(new File(out,"part-00000")));
    Set<String> output=new HashSet<String>();
    String line=br.readLine();
    Assert.assertNotNull(line);
    output.add(line.substring(0,1) + line.substring(4,5));
    line=br.readLine();
    Assert.assertNotNull(line);
    output.add(line.substring(0,1) + line.substring(4,5));
    line=br.readLine();
    Assert.assertNull(line);
    br.close();
    Set<String> expected=new HashSet<String>();
    expected.add("A2");
    expected.add("B5");
    Assert.assertEquals(expected,output);
  }
 else {
    Assert.fail("Job failed");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskLog </h4><pre class="type-9 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test TaskAttemptID
 * @throws IOException
 */
@Test(timeout=50000) public void testTaskLog() throws IOException {
  System.setProperty(YarnConfiguration.YARN_APP_CONTAINER_LOG_DIR,"testString");
  assertEquals(TaskLog.getMRv2LogDir(),"testString");
  TaskAttemptID taid=mock(TaskAttemptID.class);
  JobID jid=new JobID("job",1);
  when(taid.getJobID()).thenReturn(jid);
  when(taid.toString()).thenReturn("JobId");
  File f=TaskLog.getTaskLogFile(taid,true,LogName.STDOUT);
  assertTrue(f.getAbsolutePath().endsWith("testString" + File.separatorChar + "stdout"));
  File indexFile=TaskLog.getIndexFile(taid,true);
  if (!indexFile.getParentFile().exists()) {
    indexFile.getParentFile().mkdirs();
  }
  indexFile.delete();
  indexFile.createNewFile();
  TaskLog.syncLogs("location",taid,true);
  assertTrue(indexFile.getAbsolutePath().endsWith("userlogs" + File.separatorChar + "job_job_0001"+ File.separatorChar+ "JobId.cleanup"+ File.separatorChar+ "log.index"));
  f=TaskLog.getRealTaskLogFileLocation(taid,true,LogName.DEBUGOUT);
  if (f != null) {
    assertTrue(f.getAbsolutePath().endsWith("location" + File.separatorChar + "debugout"));
    FileUtils.copyFile(indexFile,f);
  }
  assertTrue(TaskLog.obtainLogDirOwner(taid).length() > 0);
  assertTrue(readTaskLog(TaskLog.LogName.DEBUGOUT,taid,true).length() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTextInputFormat </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=500000) public void testFormat() throws Exception {
  JobConf job=new JobConf(defaultConf);
  Path file=new Path(workDir,"test.txt");
  Reporter reporter=Reporter.NULL;
  int seed=new Random().nextInt();
  LOG.info("seed = " + seed);
  Random random=new Random(seed);
  localFs.delete(workDir,true);
  FileInputFormat.setInputPaths(job,workDir);
  for (int length=0; length < MAX_LENGTH; length+=random.nextInt(MAX_LENGTH / 10) + 1) {
    LOG.debug("creating; entries = " + length);
    Writer writer=new OutputStreamWriter(localFs.create(file));
    try {
      for (int i=0; i < length; i++) {
        writer.write(Integer.toString(i));
        writer.write("\n");
      }
    }
  finally {
      writer.close();
    }
    TextInputFormat format=new TextInputFormat();
    format.configure(job);
    LongWritable key=new LongWritable();
    Text value=new Text();
    for (int i=0; i < 3; i++) {
      int numSplits=random.nextInt(MAX_LENGTH / 20) + 1;
      LOG.debug("splitting: requesting = " + numSplits);
      InputSplit[] splits=format.getSplits(job,numSplits);
      LOG.debug("splitting: got =        " + splits.length);
      if (length == 0) {
        assertEquals("Files of length 0 are not returned from FileInputFormat.getSplits().",1,splits.length);
        assertEquals("Empty file length == 0",0,splits[0].getLength());
      }
      BitSet bits=new BitSet(length);
      for (int j=0; j < splits.length; j++) {
        LOG.debug("split[" + j + "]= "+ splits[j]);
        RecordReader<LongWritable,Text> reader=format.getRecordReader(splits[j],job,reporter);
        try {
          int count=0;
          while (reader.next(key,value)) {
            int v=Integer.parseInt(value.toString());
            LOG.debug("read " + v);
            if (bits.get(v)) {
              LOG.warn("conflict with " + v + " in split "+ j+ " at position "+ reader.getPos());
            }
            assertFalse("Key in multiple partitions.",bits.get(v));
            bits.set(v);
            count++;
          }
          LOG.debug("splits[" + j + "]="+ splits[j]+ " count="+ count);
        }
  finally {
          reader.close();
        }
      }
      assertEquals("Some keys in no partition.",length,bits.cardinality());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTextOutputFormat </h4><pre class="type-9 type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFormat() throws Exception {
  JobConf job=new JobConf();
  job.set(JobContext.TASK_ATTEMPT_ID,attempt);
  FileOutputFormat.setOutputPath(job,workDir.getParent().getParent());
  FileOutputFormat.setWorkOutputPath(job,workDir);
  FileSystem fs=workDir.getFileSystem(job);
  if (!fs.mkdirs(workDir)) {
    fail("Failed to create output directory");
  }
  String file="test_format.txt";
  Reporter reporter=Reporter.NULL;
  TextOutputFormat<Object,Object> theOutputFormat=new TextOutputFormat<Object,Object>();
  RecordWriter<Object,Object> theRecordWriter=theOutputFormat.getRecordWriter(localFs,job,file,reporter);
  Text key1=new Text("key1");
  Text key2=new Text("key2");
  Text val1=new Text("val1");
  Text val2=new Text("val2");
  NullWritable nullWritable=NullWritable.get();
  try {
    theRecordWriter.write(key1,val1);
    theRecordWriter.write(null,nullWritable);
    theRecordWriter.write(null,val1);
    theRecordWriter.write(nullWritable,val2);
    theRecordWriter.write(key2,nullWritable);
    theRecordWriter.write(key1,null);
    theRecordWriter.write(null,null);
    theRecordWriter.write(key2,val2);
  }
  finally {
    theRecordWriter.close(reporter);
  }
  File expectedFile=new File(new Path(workDir,file).toString());
  StringBuffer expectedOutput=new StringBuffer();
  expectedOutput.append(key1).append('\t').append(val1).append("\n");
  expectedOutput.append(val1).append("\n");
  expectedOutput.append(val2).append("\n");
  expectedOutput.append(key2).append("\n");
  expectedOutput.append(key1).append("\n");
  expectedOutput.append(key2).append('\t').append(val2).append("\n");
  String output=UtilsForTests.slurp(expectedFile);
  assertEquals(expectedOutput.toString(),output);
}

</code></pre>

<br>
<pre class="type-11 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test compressed file
 * @throws IOException
 */
@Test public void testCompress() throws IOException {
  JobConf job=new JobConf();
  job.set(JobContext.TASK_ATTEMPT_ID,attempt);
  job.set(org.apache.hadoop.mapreduce.lib.output.FileOutputFormat.COMPRESS,"true");
  FileOutputFormat.setOutputPath(job,workDir.getParent().getParent());
  FileOutputFormat.setWorkOutputPath(job,workDir);
  FileSystem fs=workDir.getFileSystem(job);
  if (!fs.mkdirs(workDir)) {
    fail("Failed to create output directory");
  }
  String file="test_compress.txt";
  Reporter reporter=Reporter.NULL;
  TextOutputFormat<Object,Object> theOutputFormat=new TextOutputFormat<Object,Object>();
  RecordWriter<Object,Object> theRecordWriter=theOutputFormat.getRecordWriter(localFs,job,file,reporter);
  Text key1=new Text("key1");
  Text key2=new Text("key2");
  Text val1=new Text("val1");
  Text val2=new Text("val2");
  NullWritable nullWritable=NullWritable.get();
  try {
    theRecordWriter.write(key1,val1);
    theRecordWriter.write(null,nullWritable);
    theRecordWriter.write(null,val1);
    theRecordWriter.write(nullWritable,val2);
    theRecordWriter.write(key2,nullWritable);
    theRecordWriter.write(key1,null);
    theRecordWriter.write(null,null);
    theRecordWriter.write(key2,val2);
  }
  finally {
    theRecordWriter.close(reporter);
  }
  StringBuffer expectedOutput=new StringBuffer();
  expectedOutput.append(key1).append("\t").append(val1).append("\n");
  expectedOutput.append(val1).append("\n");
  expectedOutput.append(val2).append("\n");
  expectedOutput.append(key2).append("\n");
  expectedOutput.append(key1).append("\n");
  expectedOutput.append(key2).append("\t").append(val2).append("\n");
  DefaultCodec codec=new DefaultCodec();
  codec.setConf(job);
  Path expectedFile=new Path(workDir,file + codec.getDefaultExtension());
  final FileInputStream istream=new FileInputStream(expectedFile.toString());
  CompressionInputStream cistream=codec.createInputStream(istream);
  LineReader reader=new LineReader(cistream);
  String output="";
  Text out=new Text();
  while (reader.readLine(out) > 0) {
    output+=out;
    output+="\n";
  }
  reader.close();
  assertEquals(expectedOutput.toString(),output);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFormatWithCustomSeparator() throws Exception {
  JobConf job=new JobConf();
  String separator="\u0001";
  job.set("mapreduce.output.textoutputformat.separator",separator);
  job.set(JobContext.TASK_ATTEMPT_ID,attempt);
  FileOutputFormat.setOutputPath(job,workDir.getParent().getParent());
  FileOutputFormat.setWorkOutputPath(job,workDir);
  FileSystem fs=workDir.getFileSystem(job);
  if (!fs.mkdirs(workDir)) {
    fail("Failed to create output directory");
  }
  String file="test_custom.txt";
  Reporter reporter=Reporter.NULL;
  TextOutputFormat<Object,Object> theOutputFormat=new TextOutputFormat<Object,Object>();
  RecordWriter<Object,Object> theRecordWriter=theOutputFormat.getRecordWriter(localFs,job,file,reporter);
  Text key1=new Text("key1");
  Text key2=new Text("key2");
  Text val1=new Text("val1");
  Text val2=new Text("val2");
  NullWritable nullWritable=NullWritable.get();
  try {
    theRecordWriter.write(key1,val1);
    theRecordWriter.write(null,nullWritable);
    theRecordWriter.write(null,val1);
    theRecordWriter.write(nullWritable,val2);
    theRecordWriter.write(key2,nullWritable);
    theRecordWriter.write(key1,null);
    theRecordWriter.write(null,null);
    theRecordWriter.write(key2,val2);
  }
  finally {
    theRecordWriter.close(reporter);
  }
  File expectedFile=new File(new Path(workDir,file).toString());
  StringBuffer expectedOutput=new StringBuffer();
  expectedOutput.append(key1).append(separator).append(val1).append("\n");
  expectedOutput.append(val1).append("\n");
  expectedOutput.append(val2).append("\n");
  expectedOutput.append(key2).append("\n");
  expectedOutput.append(key1).append("\n");
  expectedOutput.append(key2).append(separator).append(val2).append("\n");
  String output=UtilsForTests.slurp(expectedFile);
  assertEquals(expectedOutput.toString(),output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestYARNRunner </h4><pre class="type-9 type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test(timeout=20000) public void testAMAdminCommandOpts() throws Exception {
  JobConf jobConf=new JobConf();
  jobConf.set(MRJobConfig.MR_AM_ADMIN_COMMAND_OPTS,"-Djava.net.preferIPv4Stack=true");
  jobConf.set(MRJobConfig.MR_AM_COMMAND_OPTS,"-Xmx1024m");
  YARNRunner yarnRunner=new YARNRunner(jobConf);
  ApplicationSubmissionContext submissionContext=buildSubmitContext(yarnRunner,jobConf);
  ContainerLaunchContext containerSpec=submissionContext.getAMContainerSpec();
  List<String> commands=containerSpec.getCommands();
  int index=0;
  int adminIndex=0;
  int adminPos=-1;
  int userIndex=0;
  int userPos=-1;
  for (  String command : commands) {
    if (command != null) {
      adminPos=command.indexOf("-Djava.net.preferIPv4Stack=true");
      if (adminPos >= 0)       adminIndex=index;
      userPos=command.indexOf("-Xmx1024m");
      if (userPos >= 0)       userIndex=index;
    }
    index++;
  }
  assertTrue("AM admin command opts not in the commands.",adminPos > 0);
  assertTrue("AM user command opts not in the commands.",userPos > 0);
  if (adminIndex == userIndex) {
    assertTrue("AM admin command opts is after user command opts.",adminPos < userPos);
  }
 else {
    assertTrue("AM admin command opts is after user command opts.",adminIndex < userIndex);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestGridMixClasses </h4><pre class="type-9 type-11 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=120000) public void testSerialReaderThread() throws Exception {
  Configuration conf=new Configuration();
  File fin=new File("src" + File.separator + "test"+ File.separator+ "resources"+ File.separator+ "data"+ File.separator+ "wordcount2.json");
  JobStoryProducer jobProducer=new ZombieJobProducer(new Path(fin.getAbsolutePath()),null,conf);
  CountDownLatch startFlag=new CountDownLatch(1);
  UserResolver resolver=new SubmitterUserResolver();
  FakeJobSubmitter submitter=new FakeJobSubmitter();
  File ws=new File("target" + File.separator + this.getClass().getName());
  if (!ws.exists()) {
    Assert.assertTrue(ws.mkdirs());
  }
  SerialJobFactory jobFactory=new SerialJobFactory(submitter,jobProducer,new Path(ws.getAbsolutePath()),conf,startFlag,resolver);
  Path ioPath=new Path(ws.getAbsolutePath());
  jobFactory.setDistCacheEmulator(new DistributedCacheEmulator(conf,ioPath));
  Thread test=jobFactory.createReaderThread();
  test.start();
  Thread.sleep(1000);
  assertEquals(0,submitter.getJobs().size());
  startFlag.countDown();
  while (test.isAlive()) {
    Thread.sleep(1000);
    jobFactory.update(null);
  }
  assertEquals(2,submitter.getJobs().size());
}

</code></pre>

<br>
<pre class="type-13 type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=3000) public void testLoadJobLoadRecordReader() throws Exception {
  LoadJob.LoadRecordReader test=new LoadJob.LoadRecordReader();
  Configuration conf=new Configuration();
  FileSystem fs1=mock(FileSystem.class);
  when(fs1.open((Path)anyObject())).thenReturn(new FakeFSDataInputStream(new FakeInputStream()));
  Path p1=mock(Path.class);
  when(p1.getFileSystem((JobConf)anyObject())).thenReturn(fs1);
  FileSystem fs2=mock(FileSystem.class);
  when(fs2.open((Path)anyObject())).thenReturn(new FakeFSDataInputStream(new FakeInputStream()));
  Path p2=mock(Path.class);
  when(p2.getFileSystem((JobConf)anyObject())).thenReturn(fs2);
  Path[] paths={p1,p2};
  long[] start={0,0};
  long[] lengths={1000,1000};
  String[] locations={"temp1","temp2"};
  CombineFileSplit cfsplit=new CombineFileSplit(paths,start,lengths,locations);
  double[] reduceBytes={100,100};
  double[] reduceRecords={2,2};
  long[] reduceOutputBytes={500,500};
  long[] reduceOutputRecords={2,2};
  ResourceUsageMetrics metrics=new ResourceUsageMetrics();
  ResourceUsageMetrics[] rMetrics={new ResourceUsageMetrics(),new ResourceUsageMetrics()};
  LoadSplit input=new LoadSplit(cfsplit,2,3,1500L,2L,3000L,2L,reduceBytes,reduceRecords,reduceOutputBytes,reduceOutputRecords,metrics,rMetrics);
  TaskAttemptID taskId=new TaskAttemptID();
  TaskAttemptContext ctx=new TaskAttemptContextImpl(conf,taskId);
  test.initialize(input,ctx);
  GridmixRecord gr=test.getCurrentValue();
  int counter=0;
  while (test.nextKeyValue()) {
    gr=test.getCurrentValue();
    if (counter == 0) {
      assertEquals(0.5,test.getProgress(),0.001);
    }
 else     if (counter == 1) {
      assertEquals(1.0,test.getProgress(),0.001);
    }
    assertEquals(1000,gr.getSize());
    counter++;
  }
  assertEquals(1000,gr.getSize());
  assertEquals(2,counter);
  test.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.pipes.TestPipeApplication </h4><pre class="type-11 type-2 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test org.apache.hadoop.mapred.pipes.Submitter
 * @throws Exception
 */
@Test public void testSubmitter() throws Exception {
  JobConf conf=new JobConf();
  File[] psw=cleanTokenPasswordFile();
  System.setProperty("test.build.data","target/tmp/build/TEST_SUBMITTER_MAPPER/data");
  conf.set("hadoop.log.dir","target/tmp");
  Submitter.setIsJavaMapper(conf,false);
  Submitter.setIsJavaReducer(conf,false);
  Submitter.setKeepCommandFile(conf,false);
  Submitter.setIsJavaRecordReader(conf,false);
  Submitter.setIsJavaRecordWriter(conf,false);
  PipesPartitioner<IntWritable,Text> partitioner=new PipesPartitioner<IntWritable,Text>();
  partitioner.configure(conf);
  Submitter.setJavaPartitioner(conf,partitioner.getClass());
  assertEquals(PipesPartitioner.class,(Submitter.getJavaPartitioner(conf)));
  SecurityManager securityManager=System.getSecurityManager();
  PrintStream oldps=System.out;
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  ExitUtil.disableSystemExit();
  try {
    System.setOut(new PrintStream(out));
    Submitter.main(new String[0]);
    fail();
  }
 catch (  ExitUtil.ExitException e) {
    assertTrue(out.toString().contains(""));
    assertTrue(out.toString().contains("bin/hadoop pipes"));
    assertTrue(out.toString().contains("[-input <path>] // Input directory"));
    assertTrue(out.toString().contains("[-output <path>] // Output directory"));
    assertTrue(out.toString().contains("[-jar <jar file> // jar filename"));
    assertTrue(out.toString().contains("[-inputformat <class>] // InputFormat class"));
    assertTrue(out.toString().contains("[-map <class>] // Java Map class"));
    assertTrue(out.toString().contains("[-partitioner <class>] // Java Partitioner"));
    assertTrue(out.toString().contains("[-reduce <class>] // Java Reduce class"));
    assertTrue(out.toString().contains("[-writer <class>] // Java RecordWriter"));
    assertTrue(out.toString().contains("[-program <executable>] // executable URI"));
    assertTrue(out.toString().contains("[-reduces <num>] // number of reduces"));
    assertTrue(out.toString().contains("[-lazyOutput <true/false>] // createOutputLazily"));
    assertTrue(out.toString().contains("-conf <configuration file>     specify an application configuration file"));
    assertTrue(out.toString().contains("-D <property=value>            use value for given property"));
    assertTrue(out.toString().contains("-fs <local|namenode:port>      specify a namenode"));
    assertTrue(out.toString().contains("-jt <local|jobtracker:port>    specify a job tracker"));
    assertTrue(out.toString().contains("-files <comma separated list of files>    specify comma separated files to be copied to the map reduce cluster"));
    assertTrue(out.toString().contains("-libjars <comma separated list of jars>    specify comma separated jar files to include in the classpath."));
    assertTrue(out.toString().contains("-archives <comma separated list of archives>    specify comma separated archives to be unarchived on the compute machines."));
  }
 finally {
    System.setOut(oldps);
    System.setSecurityManager(securityManager);
    if (psw != null) {
      for (      File file : psw) {
        file.deleteOnExit();
      }
    }
  }
  try {
    File fCommand=getFileCommand(null);
    String[] args=new String[22];
    File input=new File(workSpace + File.separator + "input");
    if (!input.exists()) {
      Assert.assertTrue(input.createNewFile());
    }
    File outPut=new File(workSpace + File.separator + "output");
    FileUtil.fullyDelete(outPut);
    args[0]="-input";
    args[1]=input.getAbsolutePath();
    args[2]="-output";
    args[3]=outPut.getAbsolutePath();
    args[4]="-inputformat";
    args[5]="org.apache.hadoop.mapred.TextInputFormat";
    args[6]="-map";
    args[7]="org.apache.hadoop.mapred.lib.IdentityMapper";
    args[8]="-partitioner";
    args[9]="org.apache.hadoop.mapred.pipes.PipesPartitioner";
    args[10]="-reduce";
    args[11]="org.apache.hadoop.mapred.lib.IdentityReducer";
    args[12]="-writer";
    args[13]="org.apache.hadoop.mapred.TextOutputFormat";
    args[14]="-program";
    args[15]=fCommand.getAbsolutePath();
    args[16]="-reduces";
    args[17]="2";
    args[18]="-lazyOutput";
    args[19]="lazyOutput";
    args[20]="-jobconf";
    args[21]="mapreduce.pipes.isjavarecordwriter=false,mapreduce.pipes.isjavarecordreader=false";
    Submitter.main(args);
    fail();
  }
 catch (  ExitUtil.ExitException e) {
    assertEquals(e.status,0);
  }
 finally {
    System.setOut(oldps);
    System.setSecurityManager(securityManager);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.pipes.TestPipesNonJavaInputFormat </h4><pre class="type-11 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test PipesNonJavaInputFormat
 */
@Test public void testFormat() throws IOException {
  PipesNonJavaInputFormat inputFormat=new PipesNonJavaInputFormat();
  JobConf conf=new JobConf();
  Reporter reporter=mock(Reporter.class);
  RecordReader<FloatWritable,NullWritable> reader=inputFormat.getRecordReader(new FakeSplit(),conf,reporter);
  assertEquals(0.0f,reader.getProgress(),0.001);
  File input1=new File(workSpace + File.separator + "input1");
  if (!input1.getParentFile().exists()) {
    Assert.assertTrue(input1.getParentFile().mkdirs());
  }
  if (!input1.exists()) {
    Assert.assertTrue(input1.createNewFile());
  }
  File input2=new File(workSpace + File.separator + "input2");
  if (!input2.exists()) {
    Assert.assertTrue(input2.createNewFile());
  }
  conf.set(org.apache.hadoop.mapreduce.lib.input.FileInputFormat.INPUT_DIR,StringUtils.escapeString(input1.getAbsolutePath()) + "," + StringUtils.escapeString(input2.getAbsolutePath()));
  InputSplit[] splits=inputFormat.getSplits(conf,2);
  assertEquals(2,splits.length);
  PipesNonJavaInputFormat.PipesDummyRecordReader dummyRecordReader=new PipesNonJavaInputFormat.PipesDummyRecordReader(conf,splits[0]);
  assertNull(dummyRecordReader.createKey());
  assertNull(dummyRecordReader.createValue());
  assertEquals(0,dummyRecordReader.getPos());
  assertEquals(0.0,dummyRecordReader.getProgress(),0.001);
  assertTrue(dummyRecordReader.next(new FloatWritable(2.0f),NullWritable.get()));
  assertEquals(2.0,dummyRecordReader.getProgress(),0.001);
  dummyRecordReader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestCounters </h4><pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCountersIncrement(){
  Counters fCounters=new Counters();
  Counter fCounter=fCounters.findCounter(FRAMEWORK_COUNTER);
  fCounter.setValue(100);
  Counter gCounter=fCounters.findCounter("test","foo");
  gCounter.setValue(200);
  Counters counters=new Counters();
  counters.incrAllCounters(fCounters);
  Counter counter;
  for (  CounterGroup cg : fCounters) {
    CounterGroup group=counters.getGroup(cg.getName());
    if (group.getName().equals("test")) {
      counter=counters.findCounter("test","foo");
      assertEquals(200,counter.getValue());
    }
 else {
      counter=counters.findCounter(FRAMEWORK_COUNTER);
      assertEquals(100,counter.getValue());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestNewCombinerGrouping </h4><pre class="type-9 type-11 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCombiner() throws Exception {
  if (!new File(TEST_ROOT_DIR).mkdirs()) {
    throw new RuntimeException("Could not create test dir: " + TEST_ROOT_DIR);
  }
  File in=new File(TEST_ROOT_DIR,"input");
  if (!in.mkdirs()) {
    throw new RuntimeException("Could not create test dir: " + in);
  }
  File out=new File(TEST_ROOT_DIR,"output");
  PrintWriter pw=new PrintWriter(new FileWriter(new File(in,"data.txt")));
  pw.println("A|a,1");
  pw.println("A|b,2");
  pw.println("B|a,3");
  pw.println("B|b,4");
  pw.println("B|c,5");
  pw.close();
  JobConf conf=new JobConf();
  conf.set("mapreduce.framework.name","local");
  Job job=new Job(conf);
  TextInputFormat.setInputPaths(job,new Path(in.getPath()));
  TextOutputFormat.setOutputPath(job,new Path(out.getPath()));
  job.setMapperClass(Map.class);
  job.setReducerClass(Reduce.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(LongWritable.class);
  job.setOutputFormatClass(TextOutputFormat.class);
  job.setGroupingComparatorClass(GroupComparator.class);
  job.setCombinerKeyGroupingComparatorClass(GroupComparator.class);
  job.setCombinerClass(Combiner.class);
  job.getConfiguration().setInt("min.num.spills.for.combine",0);
  job.submit();
  job.waitForCompletion(false);
  if (job.isSuccessful()) {
    Counters counters=job.getCounters();
    long combinerInputRecords=counters.findCounter("org.apache.hadoop.mapreduce.TaskCounter","COMBINE_INPUT_RECORDS").getValue();
    long combinerOutputRecords=counters.findCounter("org.apache.hadoop.mapreduce.TaskCounter","COMBINE_OUTPUT_RECORDS").getValue();
    Assert.assertTrue(combinerInputRecords > 0);
    Assert.assertTrue(combinerInputRecords > combinerOutputRecords);
    BufferedReader br=new BufferedReader(new FileReader(new File(out,"part-r-00000")));
    Set<String> output=new HashSet<String>();
    String line=br.readLine();
    Assert.assertNotNull(line);
    output.add(line.substring(0,1) + line.substring(4,5));
    line=br.readLine();
    Assert.assertNotNull(line);
    output.add(line.substring(0,1) + line.substring(4,5));
    line=br.readLine();
    Assert.assertNull(line);
    br.close();
    Set<String> expected=new HashSet<String>();
    expected.add("A2");
    expected.add("B5");
    Assert.assertEquals(expected,output);
  }
 else {
    Assert.fail("Job failed");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.input.TestCombineTextInputFormat </h4><pre class="type-9 type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test using the gzip codec for reading
 */
@Test(timeout=10000) public void testGzip() throws IOException, InterruptedException {
  Configuration conf=new Configuration(defaultConf);
  CompressionCodec gzip=new GzipCodec();
  ReflectionUtils.setConf(gzip,conf);
  localFs.delete(workDir,true);
  writeFile(localFs,new Path(workDir,"part1.txt.gz"),gzip,"the quick\nbrown\nfox jumped\nover\n the lazy\n dog\n");
  writeFile(localFs,new Path(workDir,"part2.txt.gz"),gzip,"this is a test\nof gzip\n");
  Job job=Job.getInstance(conf);
  FileInputFormat.setInputPaths(job,workDir);
  CombineTextInputFormat format=new CombineTextInputFormat();
  List<InputSplit> splits=format.getSplits(job);
  assertEquals("compressed splits == 1",1,splits.size());
  List<Text> results=readSplit(format,splits.get(0),job);
  assertEquals("splits[0] length",8,results.size());
  final String[] firstList={"the quick","brown","fox jumped","over"," the lazy"," dog"};
  final String[] secondList={"this is a test","of gzip"};
  String first=results.get(0).toString();
  if (first.equals(firstList[0])) {
    testResults(results,firstList,secondList);
  }
 else   if (first.equals(secondList[0])) {
    testResults(results,secondList,firstList);
  }
 else {
    fail("unexpected first token!");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.TestMRJobs </h4><pre class="type-13 type-11 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=120000) public void testContainerRollingLog() throws IOException, InterruptedException, ClassNotFoundException {
  if (!(new File(MiniMRYarnCluster.APPJAR)).exists()) {
    LOG.info("MRAppJar " + MiniMRYarnCluster.APPJAR + " not found. Not running test.");
    return;
  }
  final SleepJob sleepJob=new SleepJob();
  final JobConf sleepConf=new JobConf(mrCluster.getConfig());
  sleepConf.set(MRJobConfig.MAP_LOG_LEVEL,Level.ALL.toString());
  final long userLogKb=4;
  sleepConf.setLong(MRJobConfig.TASK_USERLOG_LIMIT,userLogKb);
  sleepConf.setInt(MRJobConfig.TASK_LOG_BACKUPS,3);
  sleepConf.set(MRJobConfig.MR_AM_LOG_LEVEL,Level.ALL.toString());
  final long amLogKb=7;
  sleepConf.setLong(MRJobConfig.MR_AM_LOG_KB,amLogKb);
  sleepConf.setInt(MRJobConfig.MR_AM_LOG_BACKUPS,7);
  sleepJob.setConf(sleepConf);
  final Job job=sleepJob.createJob(1,0,1L,100,0L,0);
  job.setJarByClass(SleepJob.class);
  job.addFileToClassPath(APP_JAR);
  job.waitForCompletion(true);
  final JobId jobId=TypeConverter.toYarn(job.getJobID());
  final ApplicationId appID=jobId.getAppId();
  int pollElapsed=0;
  while (true) {
    Thread.sleep(1000);
    pollElapsed+=1000;
    if (TERMINAL_RM_APP_STATES.contains(mrCluster.getResourceManager().getRMContext().getRMApps().get(appID).getState())) {
      break;
    }
    if (pollElapsed >= 60000) {
      LOG.warn("application did not reach terminal state within 60 seconds");
      break;
    }
  }
  Assert.assertEquals(RMAppState.FINISHED,mrCluster.getResourceManager().getRMContext().getRMApps().get(appID).getState());
  final String appIdStr=appID.toString();
  final String appIdSuffix=appIdStr.substring("application_".length(),appIdStr.length());
  final String containerGlob="container_" + appIdSuffix + "_*_*";
  final String syslogGlob=appIdStr + Path.SEPARATOR + containerGlob+ Path.SEPARATOR+ TaskLog.LogName.SYSLOG;
  int numAppMasters=0;
  int numMapTasks=0;
  for (int i=0; i < NUM_NODE_MGRS; i++) {
    final Configuration nmConf=mrCluster.getNodeManager(i).getConfig();
    for (    String logDir : nmConf.getTrimmedStrings(YarnConfiguration.NM_LOG_DIRS)) {
      final Path absSyslogGlob=new Path(logDir + Path.SEPARATOR + syslogGlob);
      LOG.info("Checking for glob: " + absSyslogGlob);
      final FileStatus[] syslogs=localFs.globStatus(absSyslogGlob);
      for (      FileStatus slog : syslogs) {
        boolean foundAppMaster=job.isUber();
        final Path containerPathComponent=slog.getPath().getParent();
        if (!foundAppMaster) {
          final ContainerId cid=ConverterUtils.toContainerId(containerPathComponent.getName());
          foundAppMaster=(cid.getId() == 1);
        }
        final FileStatus[] sysSiblings=localFs.globStatus(new Path(containerPathComponent,TaskLog.LogName.SYSLOG + "*"));
        Arrays.sort(sysSiblings);
        if (foundAppMaster) {
          numAppMasters++;
        }
 else {
          numMapTasks++;
        }
        if (foundAppMaster) {
          Assert.assertSame("Unexpected number of AM sylog* files",sleepConf.getInt(MRJobConfig.MR_AM_LOG_BACKUPS,0) + 1,sysSiblings.length);
          Assert.assertTrue("AM syslog.1 length kb should be >= " + amLogKb,sysSiblings[1].getLen() >= amLogKb * 1024);
        }
 else {
          Assert.assertSame("Unexpected number of MR task sylog* files",sleepConf.getInt(MRJobConfig.TASK_LOG_BACKUPS,0) + 1,sysSiblings.length);
          Assert.assertTrue("MR syslog.1 length kb should be >= " + userLogKb,sysSiblings[1].getLen() >= userLogKb * 1024);
        }
      }
    }
  }
  Assert.assertEquals("No AppMaster log found!",1,numAppMasters);
  if (sleepConf.getBoolean(MRJobConfig.JOB_UBERTASK_ENABLE,false)) {
    Assert.assertEquals("MapTask log with uber found!",0,numMapTasks);
  }
 else {
    Assert.assertEquals("No MapTask log found!",1,numMapTasks);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.job.impl.TestTaskAttempt </h4><pre class="type-11 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHostResolveAttempt() throws Exception {
  TaskAttemptImpl.RequestContainerTransition rct=new TaskAttemptImpl.RequestContainerTransition(false);
  EventHandler eventHandler=mock(EventHandler.class);
  String[] hosts=new String[3];
  hosts[0]="192.168.1.1";
  hosts[1]="host2";
  hosts[2]="host3";
  TaskSplitMetaInfo splitInfo=new TaskSplitMetaInfo(hosts,0,128 * 1024 * 1024l);
  TaskAttemptImpl mockTaskAttempt=createMapTaskAttemptImplForTest(eventHandler,splitInfo);
  TaskAttemptImpl spyTa=spy(mockTaskAttempt);
  when(spyTa.resolveHost(hosts[0])).thenReturn("host1");
  spyTa.dataLocalHosts=spyTa.resolveHosts(splitInfo.getLocations());
  TaskAttemptEvent mockTAEvent=mock(TaskAttemptEvent.class);
  rct.transition(spyTa,mockTAEvent);
  verify(spyTa).resolveHost(hosts[0]);
  ArgumentCaptor<Event> arg=ArgumentCaptor.forClass(Event.class);
  verify(eventHandler,times(2)).handle(arg.capture());
  if (!(arg.getAllValues().get(1) instanceof ContainerRequestEvent)) {
    Assert.fail("Second Event not of type ContainerRequestEvent");
  }
  Map<String,Boolean> expected=new HashMap<String,Boolean>();
  expected.put("host1",true);
  expected.put("host2",true);
  expected.put("host3",true);
  ContainerRequestEvent cre=(ContainerRequestEvent)arg.getAllValues().get(1);
  String[] requestedHosts=cre.getHosts();
  for (  String h : requestedHosts) {
    expected.remove(h);
  }
  assertEquals(0,expected.size());
}

</code></pre>

<br>
<pre class="type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleRackRequest() throws Exception {
  TaskAttemptImpl.RequestContainerTransition rct=new TaskAttemptImpl.RequestContainerTransition(false);
  EventHandler eventHandler=mock(EventHandler.class);
  String[] hosts=new String[3];
  hosts[0]="host1";
  hosts[1]="host2";
  hosts[2]="host3";
  TaskSplitMetaInfo splitInfo=new TaskSplitMetaInfo(hosts,0,128 * 1024 * 1024l);
  TaskAttemptImpl mockTaskAttempt=createMapTaskAttemptImplForTest(eventHandler,splitInfo);
  TaskAttemptEvent mockTAEvent=mock(TaskAttemptEvent.class);
  rct.transition(mockTaskAttempt,mockTAEvent);
  ArgumentCaptor<Event> arg=ArgumentCaptor.forClass(Event.class);
  verify(eventHandler,times(2)).handle(arg.capture());
  if (!(arg.getAllValues().get(1) instanceof ContainerRequestEvent)) {
    Assert.fail("Second Event not of type ContainerRequestEvent");
  }
  ContainerRequestEvent cre=(ContainerRequestEvent)arg.getAllValues().get(1);
  String[] requestedRacks=cre.getRacks();
  assertEquals(1,requestedRacks.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.rm.TestRMContainerAllocator </h4><pre class="type-9 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapNodeLocality() throws Exception {
  LOG.info("Running testMapNodeLocality");
  Configuration conf=new Configuration();
  MyResourceManager rm=new MyResourceManager(conf);
  rm.start();
  DrainDispatcher dispatcher=(DrainDispatcher)rm.getRMContext().getDispatcher();
  RMApp app=rm.submitApp(1024);
  dispatcher.await();
  MockNM amNodeManager=rm.registerNode("amNM:1234",2048);
  amNodeManager.nodeHeartbeat(true);
  dispatcher.await();
  ApplicationAttemptId appAttemptId=app.getCurrentAppAttempt().getAppAttemptId();
  rm.sendAMLaunched(appAttemptId);
  dispatcher.await();
  JobId jobId=MRBuilderUtils.newJobId(appAttemptId.getApplicationId(),0);
  Job mockJob=mock(Job.class);
  when(mockJob.getReport()).thenReturn(MRBuilderUtils.newJobReport(jobId,"job","user",JobState.RUNNING,0,0,0,0,0,0,0,"jobfile",null,false,""));
  MyContainerAllocator allocator=new MyContainerAllocator(rm,conf,appAttemptId,mockJob);
  MockNM nodeManager1=rm.registerNode("h1:1234",3072);
  rm.registerNode("h2:1234",10240);
  MockNM nodeManager3=rm.registerNode("h3:1234",1536);
  dispatcher.await();
  ContainerRequestEvent event1=createReq(jobId,1,1024,new String[]{"h1"});
  allocator.sendRequest(event1);
  ContainerRequestEvent event2=createReq(jobId,2,1024,new String[]{"h1"});
  allocator.sendRequest(event2);
  ContainerRequestEvent event3=createReq(jobId,3,1024,new String[]{"h2"});
  allocator.sendRequest(event3);
  List<TaskAttemptContainerAssignedEvent> assigned=allocator.schedule();
  dispatcher.await();
  Assert.assertEquals("No of assignments must be 0",0,assigned.size());
  nodeManager3.nodeHeartbeat(true);
  nodeManager1.nodeHeartbeat(true);
  dispatcher.await();
  assigned=allocator.schedule();
  dispatcher.await();
  checkAssignments(new ContainerRequestEvent[]{event1,event2,event3},assigned,false);
  for (  TaskAttemptContainerAssignedEvent event : assigned) {
    if (event.getTaskAttemptID().equals(event3.getAttemptID())) {
      assigned.remove(event);
      Assert.assertTrue(event.getContainer().getNodeId().getHost().equals("h3"));
      break;
    }
  }
  checkAssignments(new ContainerRequestEvent[]{event1,event2},assigned,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.hs.TestJobListCache </h4><pre class="type-13 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=1000) public void testEviction() throws InterruptedException {
  int maxSize=2;
  JobListCache cache=new JobListCache(maxSize,1000);
  JobId jobId1=MRBuilderUtils.newJobId(1,1,1);
  HistoryFileInfo fileInfo1=Mockito.mock(HistoryFileInfo.class);
  Mockito.when(fileInfo1.getJobId()).thenReturn(jobId1);
  JobId jobId2=MRBuilderUtils.newJobId(2,2,2);
  HistoryFileInfo fileInfo2=Mockito.mock(HistoryFileInfo.class);
  Mockito.when(fileInfo2.getJobId()).thenReturn(jobId2);
  JobId jobId3=MRBuilderUtils.newJobId(3,3,3);
  HistoryFileInfo fileInfo3=Mockito.mock(HistoryFileInfo.class);
  Mockito.when(fileInfo3.getJobId()).thenReturn(jobId3);
  cache.addIfAbsent(fileInfo1);
  cache.addIfAbsent(fileInfo2);
  cache.addIfAbsent(fileInfo3);
  Collection<HistoryFileInfo> values;
  for (int i=0; i < 9; i++) {
    values=cache.values();
    if (values.size() > maxSize) {
      Thread.sleep(100);
    }
 else {
      assertFalse("fileInfo1 should have been evicted",values.contains(fileInfo1));
      return;
    }
  }
  fail("JobListCache didn't delete the extra entry");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.impl.TestMetricsSystemImpl </h4><pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInitFirstVerifyStopInvokedImmediately() throws Exception {
  DefaultMetricsSystem.shutdown();
  new ConfigBuilder().add("*.period",8).add("test.sink.test.class",TestSink.class.getName()).add("test.*.source.filter.exclude","s0").add("test.source.s1.metric.filter.exclude","X*").add("test.sink.sink1.metric.filter.exclude","Y*").add("test.sink.sink2.metric.filter.exclude","Y*").save(TestMetricsConfig.getTestFilename("hadoop-metrics2-test"));
  MetricsSystemImpl ms=new MetricsSystemImpl("Test");
  ms.start();
  ms.register("s0","s0 desc",new TestSource("s0rec"));
  TestSource s1=ms.register("s1","s1 desc",new TestSource("s1rec"));
  s1.c1.incr();
  s1.xxx.incr();
  s1.g1.set(2);
  s1.yyy.incr(2);
  s1.s1.add(0);
  MetricsSink sink1=mock(MetricsSink.class);
  MetricsSink sink2=mock(MetricsSink.class);
  ms.registerSink("sink1","sink1 desc",sink1);
  ms.registerSink("sink2","sink2 desc",sink2);
  ms.publishMetricsNow();
  ms.stop();
  ms.shutdown();
  verify(sink1,atMost(2)).putMetrics(r1.capture());
  List<MetricsRecord> mr1=r1.getAllValues();
  verify(sink2,atMost(2)).putMetrics(r2.capture());
  List<MetricsRecord> mr2=r2.getAllValues();
  if (mr1.size() != 0 && mr2.size() != 0) {
    checkMetricsRecords(mr1);
    assertEquals("output",mr1,mr2);
  }
 else   if (mr1.size() != 0) {
    checkMetricsRecords(mr1);
  }
 else   if (mr2.size() != 0) {
    checkMetricsRecords(mr2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.lib.TestInterns </h4><pre class="type-13 type-11 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testInfoOverflow(){
  MetricsInfo i0=info("m0","m desc");
  for (int i=0; i < MAX_INFO_NAMES + 1; ++i) {
    info("m" + i,"m desc");
    if (i < MAX_INFO_NAMES) {
      assertSame("m0 is still there",i0,info("m0","m desc"));
    }
  }
  assertNotSame("m0 is gone",i0,info("m0","m desc"));
  MetricsInfo i1=info("m1","m desc");
  for (int i=0; i < MAX_INFO_DESCS; ++i) {
    info("m1","m desc" + i);
    if (i < MAX_INFO_DESCS - 1) {
      assertSame("i1 is still there",i1,info("m1","m desc"));
    }
  }
  assertNotSame("i1 is gone",i1,info("m1","m desc"));
}

</code></pre>

<br>
<pre class="type-13 type-11 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testTagOverflow(){
  MetricsTag t0=tag("t0","t desc","t value");
  for (int i=0; i < MAX_TAG_NAMES + 1; ++i) {
    tag("t" + i,"t desc","t value");
    if (i < MAX_TAG_NAMES) {
      assertSame("t0 still there",t0,tag("t0","t desc","t value"));
    }
  }
  assertNotSame("t0 is gone",t0,tag("t0","t desc","t value"));
  MetricsTag t1=tag("t1","t desc","t value");
  for (int i=0; i < MAX_TAG_VALUES; ++i) {
    tag("t1","t desc","t value" + i);
    if (i < MAX_TAG_VALUES - 1) {
      assertSame("t1 is still there",t1,tag("t1","t desc","t value"));
    }
  }
  assertNotSame("t1 is gone",t1,tag("t1","t desc","t value"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.sink.TestFileSink </h4><pre class="type-4 type-11 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void after(){
  if (outFile != null) {
    outFile.delete();
    assertTrue(!outFile.exists());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.util.TestMetricsCache </h4><pre class="type-13 type-11 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testOverflow(){
  MetricsCache cache=new MetricsCache();
  MetricsCache.Record cr;
  Collection<MetricsTag> t0=Arrays.asList(makeTag("t0","0"));
  for (int i=0; i < MetricsCache.MAX_RECS_PER_NAME_DEFAULT + 1; ++i) {
    cr=cache.update(makeRecord("r",Arrays.asList(makeTag("t" + i,"" + i)),Arrays.asList(makeMetric("m",i))));
    checkMetricValue("new metric value",cr,"m",i);
    if (i < MetricsCache.MAX_RECS_PER_NAME_DEFAULT) {
      assertNotNull("t0 is still there",cache.get("r",t0));
    }
  }
  assertNull("t0 is gone",cache.get("r",t0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestNetUtils </h4><pre class="type-9 type-13 type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
/** 
 * Test for {@link NetUtils#isLocalAddress(java.net.InetAddress)}
 */
@Test public void testIsLocalAddress() throws Exception {
  assertTrue(NetUtils.isLocalAddress(InetAddress.getLocalHost()));
  Enumeration<NetworkInterface> interfaces=NetworkInterface.getNetworkInterfaces();
  if (interfaces != null) {
    while (interfaces.hasMoreElements()) {
      NetworkInterface i=interfaces.nextElement();
      Enumeration<InetAddress> addrs=i.getInetAddresses();
      if (addrs == null) {
        continue;
      }
      while (addrs.hasMoreElements()) {
        InetAddress addr=addrs.nextElement();
        assertTrue(NetUtils.isLocalAddress(addr));
      }
    }
  }
  assertFalse(NetUtils.isLocalAddress(InetAddress.getByName("8.8.8.8")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestNetworkTopology </h4><pre class="type-9 type-13 type-11 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks that chooseRandom works for an excluded rack.
 */
@Test public void testChooseRandomExcludedRack(){
  Map<Node,Integer> frequency=pickNodesAtRandom(100,"~" + "/d2");
  for (int j=0; j < dataNodes.length; j++) {
    int freq=frequency.get(dataNodes[j]);
    if (dataNodes[j].getNetworkLocation().startsWith("/d2")) {
      assertEquals(0,freq);
    }
 else {
      assertTrue(freq > 0);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestNetworkTopologyWithNodeGroup </h4><pre class="type-11 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks that adding a node with invalid topology will be failed 
 * with an exception to show topology is invalid.
 */
@Test public void testAddNodeWithInvalidTopology(){
  try {
    cluster.add(rackOnlyNode);
    fail("Exception should be thrown, so we should not have reached here.");
  }
 catch (  Exception e) {
    if (!(e instanceof IllegalArgumentException)) {
      fail("Expecting IllegalArgumentException, but caught:" + e);
    }
    assertTrue(e.getMessage().contains("illegal network location"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestSocketIOWithTimeout </h4><pre class="type-9 type-11 type-2 type-10 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSocketIOWithTimeout() throws Exception {
  Pipe pipe=Pipe.open();
  Pipe.SourceChannel source=pipe.source();
  Pipe.SinkChannel sink=pipe.sink();
  try {
    final InputStream in=new SocketInputStream(source,TIMEOUT);
    OutputStream out=new SocketOutputStream(sink,TIMEOUT);
    byte[] writeBytes=TEST_STRING.getBytes();
    byte[] readBytes=new byte[writeBytes.length];
    byte byteWithHighBit=(byte)0x80;
    out.write(writeBytes);
    out.write(byteWithHighBit);
    doIO(null,out,TIMEOUT);
    in.read(readBytes);
    assertTrue(Arrays.equals(writeBytes,readBytes));
    assertEquals(byteWithHighBit & 0xff,in.read());
    doIO(in,null,TIMEOUT);
    ((SocketInputStream)in).setTimeout(TIMEOUT * 2);
    doIO(in,null,TIMEOUT * 2);
    ((SocketInputStream)in).setTimeout(0);
    TestingThread thread=new TestingThread(ctx){
      @Override public void doWork() throws Exception {
        try {
          in.read();
          fail("Did not fail with interrupt");
        }
 catch (        InterruptedIOException ste) {
          LOG.info("Got expection while reading as expected : " + ste.getMessage());
        }
      }
    }
;
    ctx.addThread(thread);
    ctx.startThreads();
    Thread.sleep(1000);
    thread.interrupt();
    ctx.stop();
    assertTrue(source.isOpen());
    assertTrue(sink.isOpen());
    if (!Shell.WINDOWS && !Shell.PPC_64) {
      try {
        out.write(1);
        fail("Did not throw");
      }
 catch (      IOException ioe) {
        GenericTestUtils.assertExceptionContains("stream is closed",ioe);
      }
    }
    out.close();
    assertFalse(sink.isOpen());
    assertEquals(-1,in.read());
    in.close();
    assertFalse(source.isOpen());
  }
  finally {
    if (source != null) {
      source.close();
    }
    if (sink != null) {
      sink.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.unix.TestDomainSocket </h4><pre class="type-9 type-13 type-11 type-2 type-7 type-10 type-1 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test file descriptor passing.
 * @throws IOException
 */
@Test(timeout=180000) public void testFdPassing() throws Exception {
  final String TEST_PATH=new File(sockDir.getDir(),"test_sock").getAbsolutePath();
  final byte clientMsg1[]=new byte[]{0x11,0x22,0x33,0x44,0x55,0x66};
  final byte serverMsg1[]=new byte[]{0x31,0x30,0x32,0x34,0x31,0x33,0x44,0x1,0x1,0x1,0x1,0x1};
  final ArrayBlockingQueue<Throwable> threadResults=new ArrayBlockingQueue<Throwable>(2);
  final DomainSocket serv=DomainSocket.bindAndListen(TEST_PATH);
  final PassedFile passedFiles[]=new PassedFile[]{new PassedFile(1),new PassedFile(2)};
  final FileDescriptor passedFds[]=new FileDescriptor[passedFiles.length];
  for (int i=0; i < passedFiles.length; i++) {
    passedFds[i]=passedFiles[i].getInputStream().getFD();
  }
  Thread serverThread=new Thread(){
    public void run(){
      DomainSocket conn=null;
      try {
        conn=serv.accept();
        byte in1[]=new byte[clientMsg1.length];
        InputStream connInputStream=conn.getInputStream();
        IOUtils.readFully(connInputStream,in1,0,in1.length);
        Assert.assertTrue(Arrays.equals(clientMsg1,in1));
        DomainSocket domainConn=(DomainSocket)conn;
        domainConn.sendFileDescriptors(passedFds,serverMsg1,0,serverMsg1.length);
        conn.close();
      }
 catch (      Throwable e) {
        threadResults.add(e);
        Assert.fail(e.getMessage());
      }
      threadResults.add(new Success());
    }
  }
;
  serverThread.start();
  Thread clientThread=new Thread(){
    public void run(){
      try {
        DomainSocket client=DomainSocket.connect(TEST_PATH);
        OutputStream clientOutputStream=client.getOutputStream();
        InputStream clientInputStream=client.getInputStream();
        clientOutputStream.write(clientMsg1);
        DomainSocket domainConn=(DomainSocket)client;
        byte in1[]=new byte[serverMsg1.length];
        FileInputStream recvFis[]=new FileInputStream[passedFds.length];
        int r=domainConn.recvFileInputStreams(recvFis,in1,0,in1.length - 1);
        Assert.assertTrue(r > 0);
        IOUtils.readFully(clientInputStream,in1,r,in1.length - r);
        Assert.assertTrue(Arrays.equals(serverMsg1,in1));
        for (int i=0; i < passedFds.length; i++) {
          Assert.assertNotNull(recvFis[i]);
          passedFiles[i].checkInputStream(recvFis[i]);
        }
        for (        FileInputStream fis : recvFis) {
          fis.close();
        }
        client.close();
      }
 catch (      Throwable e) {
        threadResults.add(e);
      }
      threadResults.add(new Success());
    }
  }
;
  clientThread.start();
  for (int i=0; i < 2; i++) {
    Throwable t=threadResults.take();
    if (!(t instanceof Success)) {
      Assert.fail(t.getMessage() + ExceptionUtils.getStackTrace(t));
    }
  }
  serverThread.join(120000);
  clientThread.join(120000);
  serv.close();
  for (  PassedFile pf : passedFiles) {
    pf.cleanup();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.TestGroupsCaching </h4><pre class="type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupsCaching() throws Exception {
  conf.setLong(CommonConfigurationKeys.HADOOP_SECURITY_GROUPS_NEGATIVE_CACHE_SECS,0);
  Groups groups=new Groups(conf);
  groups.cacheGroupsAdd(Arrays.asList(myGroups));
  groups.refresh();
  FakeGroupMapping.clearBlackList();
  FakeGroupMapping.addToBlackList("user1");
  assertTrue(groups.getGroups("me").size() == 2);
  FakeGroupMapping.addToBlackList("me");
  assertTrue(groups.getGroups("me").size() == 2);
  try {
    LOG.error("We are not supposed to get here." + groups.getGroups("user1").toString());
    fail();
  }
 catch (  IOException ioe) {
    if (!ioe.getMessage().startsWith("No groups found")) {
      LOG.error("Got unexpected exception: " + ioe.getMessage());
      fail();
    }
  }
  FakeGroupMapping.clearBlackList();
  assertTrue(groups.getGroups("user1").size() == 2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.TestUGIWithSecurityOn </h4><pre class="type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetUGIFromKerberosSubject() throws IOException {
  String user1keyTabFilepath=System.getProperty("kdc.resource.dir") + "/keytabs/user1.keytab";
  UserGroupInformation ugi=UserGroupInformation.loginUserFromKeytabAndReturnUGI("user1@EXAMPLE.COM",user1keyTabFilepath);
  Set<KerberosPrincipal> principals=ugi.getSubject().getPrincipals(KerberosPrincipal.class);
  if (principals.isEmpty()) {
    Assert.fail("There should be a kerberos principal in the subject.");
  }
 else {
    UserGroupInformation ugi2=UserGroupInformation.getUGIFromSubject(ugi.getSubject());
    if (ugi2 != null) {
      ugi2.doAs(new PrivilegedAction(){
        @Override public Object run(){
          try {
            UserGroupInformation ugi3=UserGroupInformation.getCurrentUser();
            String doAsUserName=ugi3.getUserName();
            assertEquals(doAsUserName,"user1@EXAMPLE.COM");
            System.out.println("DO AS USERNAME: " + doAsUserName);
          }
 catch (          IOException e) {
            e.printStackTrace();
          }
          return null;
        }
      }
);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.TestUserGroupInformation </h4><pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=30000) public void testTestAuthMethod() throws Exception {
  UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
  for (  AuthenticationMethod am : AuthenticationMethod.values()) {
    if (am.getAuthMethod() != null) {
      ugi.setAuthenticationMethod(am.getAuthMethod());
      assertEquals(am,ugi.getAuthenticationMethod());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.authentication.util.TestKerberosUtil </h4><pre class="type-9 type-11 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPrincipalNamesFromKeytabWithPattern() throws IOException {
  createKeyTab(testKeytab,testPrincipals);
  Pattern httpPattern=Pattern.compile("HTTP/.*");
  String[] httpPrincipals=KerberosUtil.getPrincipalNames(testKeytab,httpPattern);
  Assert.assertNotNull("principals cannot be null",httpPrincipals);
  int expectedSize=0;
  List<String> httpPrincipalList=Arrays.asList(httpPrincipals);
  for (  String principal : testPrincipals) {
    if (httpPattern.matcher(principal).matches()) {
      Assert.assertTrue("missing principal " + principal,httpPrincipalList.contains(principal));
      expectedSize++;
    }
  }
  Assert.assertEquals(expectedSize,httpPrincipals.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.service.TestCompositeService </h4><pre class="type-13 type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServiceStartup(){
  ServiceManager serviceManager=new ServiceManager("ServiceManager");
  for (int i=0; i < NUM_OF_SERVICES; i++) {
    CompositeServiceImpl service=new CompositeServiceImpl(i);
    if (i == FAILED_SERVICE_SEQ_NUMBER) {
      service.setThrowExceptionOnStart(true);
    }
    serviceManager.addTestService(service);
  }
  CompositeServiceImpl[] services=serviceManager.getServices().toArray(new CompositeServiceImpl[0]);
  Configuration conf=new Configuration();
  serviceManager.init(conf);
  try {
    serviceManager.start();
    fail("Exception should have been thrown due to startup failure of last service");
  }
 catch (  ServiceTestRuntimeException e) {
    for (int i=0; i < NUM_OF_SERVICES - 1; i++) {
      if (i >= FAILED_SERVICE_SEQ_NUMBER && STOP_ONLY_STARTED_SERVICES) {
        assertEquals("Service state should have been ",STATE.INITED,services[NUM_OF_SERVICES - 1].getServiceState());
      }
 else {
        assertEquals("Service state should have been ",STATE.STOPPED,services[i].getServiceState());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestAutoInputFormat </h4><pre class="type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings({"unchecked","deprecation"}) @Test public void testFormat() throws IOException {
  JobConf job=new JobConf(conf);
  FileSystem fs=FileSystem.getLocal(conf);
  Path dir=new Path(System.getProperty("test.build.data",".") + "/mapred");
  Path txtFile=new Path(dir,"auto.txt");
  Path seqFile=new Path(dir,"auto.seq");
  fs.delete(dir,true);
  FileInputFormat.setInputPaths(job,dir);
  Writer txtWriter=new OutputStreamWriter(fs.create(txtFile));
  try {
    for (int i=0; i < LINES_COUNT; i++) {
      txtWriter.write("" + (10 * i));
      txtWriter.write("\n");
    }
  }
  finally {
    txtWriter.close();
  }
  SequenceFile.Writer seqWriter=SequenceFile.createWriter(fs,conf,seqFile,IntWritable.class,LongWritable.class);
  try {
    for (int i=0; i < RECORDS_COUNT; i++) {
      IntWritable key=new IntWritable(11 * i);
      LongWritable value=new LongWritable(12 * i);
      seqWriter.append(key,value);
    }
  }
  finally {
    seqWriter.close();
  }
  AutoInputFormat format=new AutoInputFormat();
  InputSplit[] splits=format.getSplits(job,SPLITS_COUNT);
  for (  InputSplit split : splits) {
    RecordReader reader=format.getRecordReader(split,job,Reporter.NULL);
    Object key=reader.createKey();
    Object value=reader.createValue();
    try {
      while (reader.next(key,value)) {
        if (key instanceof LongWritable) {
          assertEquals("Wrong value class.",Text.class,value.getClass());
          assertTrue("Invalid value",Integer.parseInt(((Text)value).toString()) % 10 == 0);
        }
 else {
          assertEquals("Wrong key class.",IntWritable.class,key.getClass());
          assertEquals("Wrong value class.",LongWritable.class,value.getClass());
          assertTrue("Invalid key.",((IntWritable)key).get() % 11 == 0);
          assertTrue("Invalid value.",((LongWritable)value).get() % 12 == 0);
        }
      }
    }
  finally {
      reader.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.TestHadoopArchives </h4><pre class="type-11 type-7 type-6 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testReadFileContent() throws Exception {
  fileList.add(createFile(inputPath,fs,"c c"));
  final Path sub1=new Path(inputPath,"sub 1");
  fs.mkdirs(sub1);
  fileList.add(createFile(inputPath,fs,sub1.getName(),"file x y z"));
  fileList.add(createFile(inputPath,fs,sub1.getName(),"file"));
  fileList.add(createFile(inputPath,fs,sub1.getName(),"x"));
  fileList.add(createFile(inputPath,fs,sub1.getName(),"y"));
  fileList.add(createFile(inputPath,fs,sub1.getName(),"z"));
  final Path sub2=new Path(inputPath,"sub 1 with suffix");
  fs.mkdirs(sub2);
  fileList.add(createFile(inputPath,fs,sub2.getName(),"z"));
  final byte[] binContent=prepareBin();
  fileList.add(createFile(inputPath,fs,binContent,sub2.getName(),"bin"));
  fileList.add(createFile(inputPath,fs,new byte[0],sub2.getName(),"zero-length"));
  final String fullHarPathStr=makeArchive();
  final HarFileSystem harFileSystem=new HarFileSystem(fs);
  try {
    final URI harUri=new URI(fullHarPathStr);
    harFileSystem.initialize(harUri,fs.getConf());
    int readFileCount=0;
    for (    final String pathStr0 : fileList) {
      final Path path=new Path(fullHarPathStr + Path.SEPARATOR + pathStr0);
      final String baseName=path.getName();
      final FileStatus status=harFileSystem.getFileStatus(path);
      if (status.isFile()) {
        final byte[] actualContentSimple=readAllSimple(harFileSystem.open(path),true);
        final byte[] actualContentBuffer=readAllWithBuffer(harFileSystem.open(path),true);
        assertArrayEquals(actualContentSimple,actualContentBuffer);
        final byte[] actualContentFully=readAllWithReadFully(actualContentSimple.length,harFileSystem.open(path),true);
        assertArrayEquals(actualContentSimple,actualContentFully);
        final byte[] actualContentSeek=readAllWithSeek(actualContentSimple.length,harFileSystem.open(path),true);
        assertArrayEquals(actualContentSimple,actualContentSeek);
        final byte[] actualContentRead4=readAllWithRead4(harFileSystem.open(path),true);
        assertArrayEquals(actualContentSimple,actualContentRead4);
        final byte[] actualContentSkip=readAllWithSkip(actualContentSimple.length,harFileSystem.open(path),harFileSystem.open(path),true);
        assertArrayEquals(actualContentSimple,actualContentSkip);
        if ("bin".equals(baseName)) {
          assertArrayEquals(binContent,actualContentSimple);
        }
 else         if ("zero-length".equals(baseName)) {
          assertEquals(0,actualContentSimple.length);
        }
 else {
          String actual=new String(actualContentSimple,"UTF-8");
          assertEquals(baseName,actual);
        }
        readFileCount++;
      }
    }
    assertEquals(fileList.size(),readFileCount);
  }
  finally {
    harFileSystem.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.mapred.TestCopyCommitter </h4><pre class="type-9 type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteMissingFlatInterleavedFiles(){
  TaskAttemptContext taskAttemptContext=getTaskAttemptContext(config);
  JobContext jobContext=new JobContextImpl(taskAttemptContext.getConfiguration(),taskAttemptContext.getTaskAttemptID().getJobID());
  Configuration conf=jobContext.getConfiguration();
  String sourceBase;
  String targetBase;
  FileSystem fs=null;
  try {
    OutputCommitter committer=new CopyCommitter(null,taskAttemptContext);
    fs=FileSystem.get(conf);
    sourceBase="/tmp1/" + String.valueOf(rand.nextLong());
    targetBase="/tmp1/" + String.valueOf(rand.nextLong());
    TestDistCpUtils.createFile(fs,sourceBase + "/1");
    TestDistCpUtils.createFile(fs,sourceBase + "/3");
    TestDistCpUtils.createFile(fs,sourceBase + "/4");
    TestDistCpUtils.createFile(fs,sourceBase + "/5");
    TestDistCpUtils.createFile(fs,sourceBase + "/7");
    TestDistCpUtils.createFile(fs,sourceBase + "/8");
    TestDistCpUtils.createFile(fs,sourceBase + "/9");
    TestDistCpUtils.createFile(fs,targetBase + "/2");
    TestDistCpUtils.createFile(fs,targetBase + "/4");
    TestDistCpUtils.createFile(fs,targetBase + "/5");
    TestDistCpUtils.createFile(fs,targetBase + "/7");
    TestDistCpUtils.createFile(fs,targetBase + "/9");
    TestDistCpUtils.createFile(fs,targetBase + "/A");
    DistCpOptions options=new DistCpOptions(Arrays.asList(new Path(sourceBase)),new Path("/out"));
    options.setSyncFolder(true);
    options.setDeleteMissing(true);
    options.appendToConf(conf);
    CopyListing listing=new GlobbedCopyListing(conf,CREDENTIALS);
    Path listingFile=new Path("/tmp1/" + String.valueOf(rand.nextLong()));
    listing.buildListing(listingFile,options);
    conf.set(DistCpConstants.CONF_LABEL_TARGET_WORK_PATH,targetBase);
    conf.set(DistCpConstants.CONF_LABEL_TARGET_FINAL_PATH,targetBase);
    committer.commitJob(jobContext);
    if (!TestDistCpUtils.checkIfFoldersAreInSync(fs,targetBase,sourceBase)) {
      Assert.fail("Source and target folders are not in sync");
    }
    Assert.assertEquals(fs.listStatus(new Path(targetBase)).length,4);
    committer.commitJob(jobContext);
    if (!TestDistCpUtils.checkIfFoldersAreInSync(fs,targetBase,sourceBase)) {
      Assert.fail("Source and target folders are not in sync");
    }
    Assert.assertEquals(fs.listStatus(new Path(targetBase)).length,4);
  }
 catch (  IOException e) {
    LOG.error("Exception encountered while testing for delete missing",e);
    Assert.fail("Delete missing failure");
  }
 finally {
    TestDistCpUtils.delete(fs,"/tmp1");
    conf.set(DistCpConstants.CONF_LABEL_DELETE_MISSING,"false");
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPreserveStatus(){
  TaskAttemptContext taskAttemptContext=getTaskAttemptContext(config);
  JobContext jobContext=new JobContextImpl(taskAttemptContext.getConfiguration(),taskAttemptContext.getTaskAttemptID().getJobID());
  Configuration conf=jobContext.getConfiguration();
  String sourceBase;
  String targetBase;
  FileSystem fs=null;
  try {
    OutputCommitter committer=new CopyCommitter(null,taskAttemptContext);
    fs=FileSystem.get(conf);
    FsPermission sourcePerm=new FsPermission((short)511);
    FsPermission initialPerm=new FsPermission((short)448);
    sourceBase=TestDistCpUtils.createTestSetup(fs,sourcePerm);
    targetBase=TestDistCpUtils.createTestSetup(fs,initialPerm);
    DistCpOptions options=new DistCpOptions(Arrays.asList(new Path(sourceBase)),new Path("/out"));
    options.preserve(FileAttribute.PERMISSION);
    options.appendToConf(conf);
    options.setTargetPathExists(false);
    CopyListing listing=new GlobbedCopyListing(conf,CREDENTIALS);
    Path listingFile=new Path("/tmp1/" + String.valueOf(rand.nextLong()));
    listing.buildListing(listingFile,options);
    conf.set(DistCpConstants.CONF_LABEL_TARGET_WORK_PATH,targetBase);
    committer.commitJob(jobContext);
    if (!checkDirectoryPermissions(fs,targetBase,sourcePerm)) {
      Assert.fail("Permission don't match");
    }
    committer.commitJob(jobContext);
    if (!checkDirectoryPermissions(fs,targetBase,sourcePerm)) {
      Assert.fail("Permission don't match");
    }
  }
 catch (  IOException e) {
    LOG.error("Exception encountered while testing for preserve status",e);
    Assert.fail("Preserve status failure");
  }
 finally {
    TestDistCpUtils.delete(fs,"/tmp1");
    conf.unset(DistCpConstants.CONF_LABEL_PRESERVE_STATUS);
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeleteMissing(){
  TaskAttemptContext taskAttemptContext=getTaskAttemptContext(config);
  JobContext jobContext=new JobContextImpl(taskAttemptContext.getConfiguration(),taskAttemptContext.getTaskAttemptID().getJobID());
  Configuration conf=jobContext.getConfiguration();
  String sourceBase;
  String targetBase;
  FileSystem fs=null;
  try {
    OutputCommitter committer=new CopyCommitter(null,taskAttemptContext);
    fs=FileSystem.get(conf);
    sourceBase=TestDistCpUtils.createTestSetup(fs,FsPermission.getDefault());
    targetBase=TestDistCpUtils.createTestSetup(fs,FsPermission.getDefault());
    String targetBaseAdd=TestDistCpUtils.createTestSetup(fs,FsPermission.getDefault());
    fs.rename(new Path(targetBaseAdd),new Path(targetBase));
    DistCpOptions options=new DistCpOptions(Arrays.asList(new Path(sourceBase)),new Path("/out"));
    options.setSyncFolder(true);
    options.setDeleteMissing(true);
    options.appendToConf(conf);
    CopyListing listing=new GlobbedCopyListing(conf,CREDENTIALS);
    Path listingFile=new Path("/tmp1/" + String.valueOf(rand.nextLong()));
    listing.buildListing(listingFile,options);
    conf.set(DistCpConstants.CONF_LABEL_TARGET_WORK_PATH,targetBase);
    conf.set(DistCpConstants.CONF_LABEL_TARGET_FINAL_PATH,targetBase);
    committer.commitJob(jobContext);
    if (!TestDistCpUtils.checkIfFoldersAreInSync(fs,targetBase,sourceBase)) {
      Assert.fail("Source and target folders are not in sync");
    }
    if (!TestDistCpUtils.checkIfFoldersAreInSync(fs,sourceBase,targetBase)) {
      Assert.fail("Source and target folders are not in sync");
    }
    committer.commitJob(jobContext);
    if (!TestDistCpUtils.checkIfFoldersAreInSync(fs,targetBase,sourceBase)) {
      Assert.fail("Source and target folders are not in sync");
    }
    if (!TestDistCpUtils.checkIfFoldersAreInSync(fs,sourceBase,targetBase)) {
      Assert.fail("Source and target folders are not in sync");
    }
  }
 catch (  Throwable e) {
    LOG.error("Exception encountered while testing for delete missing",e);
    Assert.fail("Delete missing failure");
  }
 finally {
    TestDistCpUtils.delete(fs,"/tmp1");
    conf.set(DistCpConstants.CONF_LABEL_DELETE_MISSING,"false");
  }
}

</code></pre>

<br>
<pre class="type-4 type-11 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void cleanupMetaFolder(){
  Path meta=new Path("/meta");
  try {
    if (cluster.getFileSystem().exists(meta)) {
      cluster.getFileSystem().delete(meta,true);
      Assert.fail("Expected meta folder to be deleted");
    }
  }
 catch (  IOException e) {
    LOG.error("Exception encountered while cleaning up folder",e);
    Assert.fail("Unable to clean up meta folder");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.rumen.TestHistograms </h4><pre class="type-9 type-13 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws IOExceptionThere should be files in the directory named by
 * ${test.build.data}/rumen/histogram-test .
 * There will be pairs of files, inputXxx.json and goldXxx.json .
 * We read the input file as a HistogramRawTestData in json. Then we
 * create a Histogram using the data field, and then a
 * LoggedDiscreteCDF using the percentiles and scale field. Finally,
 * we read the corresponding goldXxx.json as a LoggedDiscreteCDF and
 * deepCompare them.
 */
@Test public void testHistograms() throws IOException {
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs);
  final Path rootInputFile=new Path(rootInputDir,"rumen/histogram-tests");
  FileStatus[] tests=lfs.listStatus(rootInputFile);
  for (int i=0; i < tests.length; ++i) {
    Path filePath=tests[i].getPath();
    String fileName=filePath.getName();
    if (fileName.startsWith("input")) {
      String testName=fileName.substring("input".length());
      Path goldFilePath=new Path(rootInputFile,"gold" + testName);
      assertTrue("Gold file dies not exist",lfs.exists(goldFilePath));
      LoggedDiscreteCDF newResult=histogramFileToCDF(filePath,lfs);
      System.out.println("Testing a Histogram for " + fileName);
      FSDataInputStream goldStream=lfs.open(goldFilePath);
      JsonObjectMapperParser<LoggedDiscreteCDF> parser=new JsonObjectMapperParser<LoggedDiscreteCDF>(goldStream,LoggedDiscreteCDF.class);
      try {
        LoggedDiscreteCDF dcdf=parser.getNext();
        dcdf.deepCompare(newResult,new TreePath(null,"<root>"));
      }
 catch (      DeepInequalityException e) {
        fail(e.path.toString());
      }
 finally {
        parser.close();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestAsyncDiskService </h4><pre class="type-11 type-2 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test creates some ExampleTasks and runs them. 
 */
@Test public void testAsyncDiskService() throws Throwable {
  String[] vols=new String[]{"/0","/1"};
  AsyncDiskService service=new AsyncDiskService(vols);
  int total=100;
  for (int i=0; i < total; i++) {
    service.execute(vols[i % 2],new ExampleTask());
  }
  Exception e=null;
  try {
    service.execute("no_such_volume",new ExampleTask());
  }
 catch (  RuntimeException ex) {
    e=ex;
  }
  assertNotNull("Executing a task on a non-existing volume should throw an " + "Exception.",e);
  service.shutdown();
  if (!service.awaitTermination(5000)) {
    fail("AsyncDiskService didn't shutdown in 5 seconds.");
  }
  assertEquals(total,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestNativeCodeLoader </h4><pre class="type-11 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNativeCodeLoaded(){
  if (requireTestJni() == false) {
    LOG.info("TestNativeCodeLoader: libhadoop.so testing is not required.");
    return;
  }
  if (!NativeCodeLoader.isNativeCodeLoaded()) {
    fail("TestNativeCodeLoader: libhadoop.so testing was required, but " + "libhadoop.so was not loaded.");
  }
  assertFalse(NativeCodeLoader.getLibraryName().isEmpty());
  assertFalse(ZlibFactory.getLibraryName().isEmpty());
  if (NativeCodeLoader.buildSupportsSnappy()) {
    assertFalse(SnappyCodec.getLibraryName().isEmpty());
  }
  if (NativeCodeLoader.buildSupportsOpenssl()) {
    assertFalse(OpensslCipher.getLibraryName().isEmpty());
  }
  assertFalse(Lz4Codec.getLibraryName().isEmpty());
  LOG.info("TestNativeCodeLoader: libhadoop.so is loaded.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestReflectionUtils </h4><pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testThreadSafe() throws Exception {
  Thread[] th=new Thread[32];
  for (int i=0; i < th.length; i++) {
    th[i]=new Thread(){
      @Override public void run(){
        try {
          doTestCache();
        }
 catch (        Throwable t) {
          failure=t;
        }
      }
    }
;
    th[i].start();
  }
  for (int i=0; i < th.length; i++) {
    th[i].join();
  }
  if (failure != null) {
    failure.printStackTrace();
    fail(failure.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.applications.distributedshell.TestDistributedShell </h4><pre class="type-9 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=90000) public void testDSShellWithCustomLogPropertyFile() throws Exception {
  final File basedir=new File("target",TestDistributedShell.class.getName());
  final File tmpDir=new File(basedir,"tmpDir");
  tmpDir.mkdirs();
  final File customLogProperty=new File(tmpDir,"custom_log4j.properties");
  if (customLogProperty.exists()) {
    customLogProperty.delete();
  }
  if (!customLogProperty.createNewFile()) {
    Assert.fail("Can not create custom log4j property file.");
  }
  PrintWriter fileWriter=new PrintWriter(customLogProperty);
  fileWriter.write("log4j.rootLogger=debug,stdout");
  fileWriter.close();
  String[] args={"--jar",APPMASTER_JAR,"--num_containers","3","--shell_command","echo","--shell_args","HADOOP","--log_properties",customLogProperty.getAbsolutePath(),"--master_memory","512","--master_vcores","2","--container_memory","128","--container_vcores","1"};
  final Log LOG_Client=LogFactory.getLog(Client.class);
  Assert.assertTrue(LOG_Client.isInfoEnabled());
  Assert.assertFalse(LOG_Client.isDebugEnabled());
  final Log LOG_AM=LogFactory.getLog(ApplicationMaster.class);
  Assert.assertTrue(LOG_AM.isInfoEnabled());
  Assert.assertFalse(LOG_AM.isDebugEnabled());
  LOG.info("Initializing DS Client");
  final Client client=new Client(new Configuration(yarnCluster.getConfig()));
  boolean initSuccess=client.init(args);
  Assert.assertTrue(initSuccess);
  LOG.info("Running DS Client");
  boolean result=client.run();
  LOG.info("Client run completed. Result=" + result);
  Assert.assertTrue(verifyContainerLog(3,null,true,"DEBUG") > 10);
  Assert.assertTrue(LOG_Client.isInfoEnabled());
  Assert.assertTrue(LOG_Client.isDebugEnabled());
  Assert.assertTrue(LOG_AM.isInfoEnabled());
  Assert.assertTrue(LOG_AM.isDebugEnabled());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=90000) public void testDSShellWithShellScript() throws Exception {
  final File basedir=new File("target",TestDistributedShell.class.getName());
  final File tmpDir=new File(basedir,"tmpDir");
  tmpDir.mkdirs();
  final File customShellScript=new File(tmpDir,"custom_script.sh");
  if (customShellScript.exists()) {
    customShellScript.delete();
  }
  if (!customShellScript.createNewFile()) {
    Assert.fail("Can not create custom shell script file.");
  }
  PrintWriter fileWriter=new PrintWriter(customShellScript);
  fileWriter.write("echo testDSShellWithShellScript");
  fileWriter.close();
  System.out.println(customShellScript.getAbsolutePath());
  String[] args={"--jar",APPMASTER_JAR,"--num_containers","1","--shell_script",customShellScript.getAbsolutePath(),"--master_memory","512","--master_vcores","2","--container_memory","128","--container_vcores","1"};
  LOG.info("Initializing DS Client");
  final Client client=new Client(new Configuration(yarnCluster.getConfig()));
  boolean initSuccess=client.init(args);
  Assert.assertTrue(initSuccess);
  LOG.info("Running DS Client");
  boolean result=client.run();
  LOG.info("Client run completed. Result=" + result);
  List<String> expectedContent=new ArrayList<String>();
  expectedContent.add("testDSShellWithShellScript");
  verifyContainerLog(1,expectedContent,false,"");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.api.impl.TestAMRMClient </h4><pre class="type-9 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testAMRMClientMatchingFit() throws YarnException, IOException {
  AMRMClient<ContainerRequest> amClient=null;
  try {
    amClient=AMRMClient.<ContainerRequest>createAMRMClient();
    amClient.init(conf);
    amClient.start();
    amClient.registerApplicationMaster("Host",10000,"");
    Resource capability1=Resource.newInstance(1024,2);
    Resource capability2=Resource.newInstance(1024,1);
    Resource capability3=Resource.newInstance(1000,2);
    Resource capability4=Resource.newInstance(2000,1);
    Resource capability5=Resource.newInstance(1000,3);
    Resource capability6=Resource.newInstance(2000,1);
    Resource capability7=Resource.newInstance(2000,1);
    ContainerRequest storedContainer1=new ContainerRequest(capability1,nodes,racks,priority);
    ContainerRequest storedContainer2=new ContainerRequest(capability2,nodes,racks,priority);
    ContainerRequest storedContainer3=new ContainerRequest(capability3,nodes,racks,priority);
    ContainerRequest storedContainer4=new ContainerRequest(capability4,nodes,racks,priority);
    ContainerRequest storedContainer5=new ContainerRequest(capability5,nodes,racks,priority);
    ContainerRequest storedContainer6=new ContainerRequest(capability6,nodes,racks,priority);
    ContainerRequest storedContainer7=new ContainerRequest(capability7,nodes,racks,priority2,false);
    amClient.addContainerRequest(storedContainer1);
    amClient.addContainerRequest(storedContainer2);
    amClient.addContainerRequest(storedContainer3);
    amClient.addContainerRequest(storedContainer4);
    amClient.addContainerRequest(storedContainer5);
    amClient.addContainerRequest(storedContainer6);
    amClient.addContainerRequest(storedContainer7);
    List<? extends Collection<ContainerRequest>> matches;
    ContainerRequest storedRequest;
    Resource testCapability1=Resource.newInstance(1024,2);
    matches=amClient.getMatchingRequests(priority,node,testCapability1);
    verifyMatches(matches,1);
    storedRequest=matches.get(0).iterator().next();
    assertEquals(storedContainer1,storedRequest);
    amClient.removeContainerRequest(storedContainer1);
    Resource testCapability2=Resource.newInstance(2000,1);
    matches=amClient.getMatchingRequests(priority,node,testCapability2);
    verifyMatches(matches,2);
    int i=0;
    for (    ContainerRequest storedRequest1 : matches.get(0)) {
      if (i++ == 0) {
        assertEquals(storedContainer4,storedRequest1);
      }
 else {
        assertEquals(storedContainer6,storedRequest1);
      }
    }
    amClient.removeContainerRequest(storedContainer6);
    Resource testCapability3=Resource.newInstance(4000,4);
    matches=amClient.getMatchingRequests(priority,node,testCapability3);
    assert (matches.size() == 4);
    Resource testCapability4=Resource.newInstance(1024,2);
    matches=amClient.getMatchingRequests(priority,node,testCapability4);
    assert (matches.size() == 2);
    for (    Collection<ContainerRequest> testSet : matches) {
      assertEquals(1,testSet.size());
      ContainerRequest testRequest=testSet.iterator().next();
      assertTrue(testRequest != storedContainer4);
      assertTrue(testRequest != storedContainer5);
      assert (testRequest == storedContainer2 || testRequest == storedContainer3);
    }
    Resource testCapability5=Resource.newInstance(512,4);
    matches=amClient.getMatchingRequests(priority,node,testCapability5);
    assert (matches.size() == 0);
    Resource testCapability7=Resource.newInstance(2000,1);
    matches=amClient.getMatchingRequests(priority2,ResourceRequest.ANY,testCapability7);
    assert (matches.size() == 0);
    matches=amClient.getMatchingRequests(priority2,node,testCapability7);
    assert (matches.size() == 1);
    amClient.unregisterApplicationMaster(FinalApplicationStatus.SUCCEEDED,null,null);
  }
  finally {
    if (amClient != null && amClient.getServiceState() == STATE.STARTED) {
      amClient.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.api.impl.TestNMClient </h4><pre class="type-11 type-8 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws YarnException, IOException {
  conf=new YarnConfiguration();
  yarnCluster=new MiniYARNCluster(TestAMRMClient.class.getName(),nodeCount,1,1);
  yarnCluster.init(conf);
  yarnCluster.start();
  assertNotNull(yarnCluster);
  assertEquals(STATE.STARTED,yarnCluster.getServiceState());
  yarnClient=(YarnClientImpl)YarnClient.createYarnClient();
  yarnClient.init(conf);
  yarnClient.start();
  assertNotNull(yarnClient);
  assertEquals(STATE.STARTED,yarnClient.getServiceState());
  nodeReports=yarnClient.getNodeReports(NodeState.RUNNING);
  ApplicationSubmissionContext appContext=yarnClient.createApplication().getApplicationSubmissionContext();
  ApplicationId appId=appContext.getApplicationId();
  appContext.setApplicationName("Test");
  Priority pri=Priority.newInstance(0);
  appContext.setPriority(pri);
  appContext.setQueue("default");
  ContainerLaunchContext amContainer=Records.newRecord(ContainerLaunchContext.class);
  appContext.setAMContainerSpec(amContainer);
  appContext.setUnmanagedAM(true);
  SubmitApplicationRequest appRequest=Records.newRecord(SubmitApplicationRequest.class);
  appRequest.setApplicationSubmissionContext(appContext);
  yarnClient.submitApplication(appContext);
  int iterationsLeft=30;
  RMAppAttempt appAttempt=null;
  while (iterationsLeft > 0) {
    ApplicationReport appReport=yarnClient.getApplicationReport(appId);
    if (appReport.getYarnApplicationState() == YarnApplicationState.ACCEPTED) {
      attemptId=appReport.getCurrentApplicationAttemptId();
      appAttempt=yarnCluster.getResourceManager().getRMContext().getRMApps().get(attemptId.getApplicationId()).getCurrentAppAttempt();
      while (true) {
        if (appAttempt.getAppAttemptState() == RMAppAttemptState.LAUNCHED) {
          break;
        }
      }
      break;
    }
    sleep(1000);
    --iterationsLeft;
  }
  if (iterationsLeft == 0) {
    fail("Application hasn't bee started");
  }
  UserGroupInformation.setLoginUser(UserGroupInformation.createRemoteUser(UserGroupInformation.getCurrentUser().getUserName()));
  UserGroupInformation.getCurrentUser().addToken(appAttempt.getAMRMToken());
  nmTokenCache=new NMTokenCache();
  rmClient=(AMRMClientImpl<ContainerRequest>)AMRMClient.<ContainerRequest>createAMRMClient();
  rmClient.setNMTokenCache(nmTokenCache);
  rmClient.init(conf);
  rmClient.start();
  assertNotNull(rmClient);
  assertEquals(STATE.STARTED,rmClient.getServiceState());
  nmClient=(NMClientImpl)NMClient.createNMClient();
  nmClient.setNMTokenCache(rmClient.getNMTokenCache());
  nmClient.init(conf);
  nmClient.start();
  assertNotNull(nmClient);
  assertEquals(STATE.STARTED,nmClient.getServiceState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.api.impl.TestYarnClient </h4><pre class="type-9 type-13 type-11 type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testAMMRTokens() throws Exception {
  MiniYARNCluster cluster=new MiniYARNCluster("testMRAMTokens",1,1,1);
  YarnClient rmClient=null;
  try {
    cluster.init(new YarnConfiguration());
    cluster.start();
    final Configuration yarnConf=cluster.getConfig();
    rmClient=YarnClient.createYarnClient();
    rmClient.init(yarnConf);
    rmClient.start();
    ApplicationId appId=createApp(rmClient,false);
    waitTillAccepted(rmClient,appId);
    Assert.assertNull(rmClient.getAMRMToken(appId));
    appId=createApp(rmClient,true);
    waitTillAccepted(rmClient,appId);
    long start=System.currentTimeMillis();
    while (rmClient.getAMRMToken(appId) == null) {
      if (System.currentTimeMillis() - start > 20 * 1000) {
        Assert.fail("AMRM token is null");
      }
      Thread.sleep(100);
    }
    Assert.assertNotNull(rmClient.getAMRMToken(appId));
    UserGroupInformation other=UserGroupInformation.createUserForTesting("foo",new String[]{});
    appId=other.doAs(new PrivilegedExceptionAction<ApplicationId>(){
      @Override public ApplicationId run() throws Exception {
        YarnClient rmClient=YarnClient.createYarnClient();
        rmClient.init(yarnConf);
        rmClient.start();
        ApplicationId appId=createApp(rmClient,true);
        waitTillAccepted(rmClient,appId);
        long start=System.currentTimeMillis();
        while (rmClient.getAMRMToken(appId) == null) {
          if (System.currentTimeMillis() - start > 20 * 1000) {
            Assert.fail("AMRM token is null");
          }
          Thread.sleep(100);
        }
        Assert.assertNotNull(rmClient.getAMRMToken(appId));
        return appId;
      }
    }
);
    Assert.assertNull(rmClient.getAMRMToken(appId));
  }
  finally {
    if (rmClient != null) {
      rmClient.stop();
    }
    cluster.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.lib.TestZKClient </h4><pre class="type-4 type-9 type-11 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws IOException, InterruptedException {
  if (zks != null) {
    ZKDatabase zkDb=zks.getZKDatabase();
    factory.shutdown();
    try {
      zkDb.close();
    }
 catch (    IOException ie) {
    }
    final int PORT=Integer.parseInt(hostPort.split(":")[1]);
    Assert.assertTrue("waiting for server down",waitForServerDown("127.0.0.1:" + PORT,CONNECTION_TIMEOUT));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.logaggregation.TestAggregatedLogFormat </h4><pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testForCorruptedAggregatedLogs() throws Exception {
  Configuration conf=new Configuration();
  File workDir=new File(testWorkDir,"testReadAcontainerLogs1");
  Path remoteAppLogFile=new Path(workDir.getAbsolutePath(),"aggregatedLogFile");
  Path srcFileRoot=new Path(workDir.getAbsolutePath(),"srcFiles");
  ContainerId testContainerId=TestContainerId.newContainerId(1,1,1,1);
  Path t=new Path(srcFileRoot,testContainerId.getApplicationAttemptId().getApplicationId().toString());
  Path srcFilePath=new Path(t,testContainerId.toString());
  long numChars=950000;
  writeSrcFileAndALog(srcFilePath,"stdout",numChars,remoteAppLogFile,srcFileRoot,testContainerId);
  LogReader logReader=new LogReader(conf,remoteAppLogFile);
  LogKey rLogKey=new LogKey();
  DataInputStream dis=logReader.next(rLogKey);
  Writer writer=new StringWriter();
  try {
    LogReader.readAcontainerLogs(dis,writer);
  }
 catch (  Exception e) {
    if (e.toString().contains("NumberFormatException")) {
      Assert.fail("Aggregated logs are corrupted.");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.logaggregation.TestAggregatedLogsBlock </h4><pre class="type-9 type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
/** 
 * Log files was deleted.
 * @throws Exception
 */
@Test public void testNoLogs() throws Exception {
  FileUtil.fullyDelete(new File("target/logs"));
  Configuration configuration=getConfiguration();
  File f=new File("target/logs/logs/application_0_0001/container_0_0001_01_000001");
  if (!f.exists()) {
    assertTrue(f.mkdirs());
  }
  writeLog(configuration,"admin");
  AggregatedLogsBlockForTest aggregatedBlock=getAggregatedLogsBlockForTest(configuration,"admin","container_0_0001_01_000001");
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  PrintWriter printWriter=new PrintWriter(data);
  HtmlBlock html=new HtmlBlockForTest();
  HtmlBlock.Block block=new BlockForTest(html,printWriter,10,false);
  aggregatedBlock.render(block);
  block.getWriter().flush();
  String out=data.toString();
  assertTrue(out.contains("No logs available for container container_0_0001_01_000001"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.TestContainerExecutor </h4><pre class="type-9 type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=5000) public void testRunCommandwithPriority() throws Exception {
  Configuration conf=new Configuration();
  conf.setInt(YarnConfiguration.NM_CONTAINER_EXECUTOR_SCHED_PRIORITY,2);
  String[] command=ContainerExecutor.getRunCommand("echo","group1",conf);
  if (Shell.WINDOWS) {
    assertEquals("first command should be the run command for the platform",Shell.WINUTILS,command[0]);
  }
 else {
    assertEquals("first command should be nice","nice",command[0]);
    assertEquals("second command should be -n","-n",command[1]);
    assertEquals("third command should be the priority",Integer.toString(2),command[2]);
  }
  conf.setInt(YarnConfiguration.NM_CONTAINER_EXECUTOR_SCHED_PRIORITY,-5);
  command=ContainerExecutor.getRunCommand("echo","group1",conf);
  if (Shell.WINDOWS) {
    assertEquals("first command should be the run command for the platform",Shell.WINUTILS,command[0]);
  }
 else {
    assertEquals("first command should be nice","nice",command[0]);
    assertEquals("second command should be -n","-n",command[1]);
    assertEquals("third command should be the priority",Integer.toString(-5),command[2]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.TestNodeManagerResync </h4><pre class="type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNMSentContainerStatusOnResync() throws Exception {
  final ContainerStatus testCompleteContainer=TestNodeStatusUpdater.createContainerStatus(2,ContainerState.COMPLETE);
  final Container container=TestNodeStatusUpdater.getMockContainer(testCompleteContainer);
  NMContainerStatus report=createNMContainerStatus(2,ContainerState.COMPLETE);
  when(container.getNMContainerStatus()).thenReturn(report);
  NodeManager nm=new NodeManager(){
    int registerCount=0;
    @Override protected NodeStatusUpdater createNodeStatusUpdater(    Context context,    Dispatcher dispatcher,    NodeHealthCheckerService healthChecker){
      return new TestNodeStatusUpdaterResync(context,dispatcher,healthChecker,metrics){
        @Override protected ResourceTracker createResourceTracker(){
          return new MockResourceTracker(){
            @Override public RegisterNodeManagerResponse registerNodeManager(            RegisterNodeManagerRequest request) throws YarnException, IOException {
              if (registerCount == 0) {
                try {
                  Assert.assertEquals(0,request.getNMContainerStatuses().size());
                }
 catch (                AssertionError error) {
                  error.printStackTrace();
                  assertionFailedInThread.set(true);
                }
                getNMContext().getContainers().put(testCompleteContainer.getContainerId(),container);
              }
 else {
                List<NMContainerStatus> statuses=request.getNMContainerStatuses();
                try {
                  Assert.assertEquals(1,statuses.size());
                  Assert.assertEquals(testCompleteContainer.getContainerId(),statuses.get(0).getContainerId());
                }
 catch (                AssertionError error) {
                  error.printStackTrace();
                  assertionFailedInThread.set(true);
                }
              }
              registerCount++;
              return super.registerNodeManager(request);
            }
            @Override public NodeHeartbeatResponse nodeHeartbeat(            NodeHeartbeatRequest request){
              List<ContainerStatus> statuses=request.getNodeStatus().getContainersStatuses();
              try {
                Assert.assertEquals(1,statuses.size());
                Assert.assertEquals(testCompleteContainer.getContainerId(),statuses.get(0).getContainerId());
              }
 catch (              AssertionError error) {
                error.printStackTrace();
                assertionFailedInThread.set(true);
              }
              return YarnServerBuilderUtils.newNodeHeartbeatResponse(1,NodeAction.RESYNC,null,null,null,null,1000L);
            }
          }
;
        }
      }
;
    }
  }
;
  YarnConfiguration conf=createNMConfig();
  nm.init(conf);
  nm.start();
  try {
    syncBarrier.await();
  }
 catch (  BrokenBarrierException e) {
  }
  Assert.assertFalse(assertionFailedInThread.get());
  nm.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.TestNodeManagerShutdown </h4><pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testKillContainersOnShutdown() throws IOException, YarnException {
  nm=new TestNodeManager();
  nm.init(createNMConfig());
  nm.start();
  startContainer(nm,cId,localFS,tmpDir,processStartFile);
  final int MAX_TRIES=20;
  int numTries=0;
  while (!processStartFile.exists() && numTries < MAX_TRIES) {
    try {
      Thread.sleep(500);
    }
 catch (    InterruptedException ex) {
      ex.printStackTrace();
    }
    numTries++;
  }
  nm.stop();
  if (Shell.WINDOWS) {
    Assert.assertFalse("Process is still alive!",DefaultContainerExecutor.containerIsAlive(cId.toString()));
  }
 else {
    BufferedReader reader=new BufferedReader(new FileReader(processStartFile));
    boolean foundSigTermMessage=false;
    while (true) {
      String line=reader.readLine();
      if (line == null) {
        break;
      }
      if (line.contains("SIGTERM")) {
        foundSigTermMessage=true;
        break;
      }
    }
    Assert.assertTrue("Did not find sigterm message",foundSigTermMessage);
    reader.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.TestNodeStatusUpdater </h4><pre class="type-13 type-11 type-2 type-7 type-10 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNMRegistration() throws InterruptedException {
  nm=new NodeManager(){
    @Override protected NodeStatusUpdater createNodeStatusUpdater(    Context context,    Dispatcher dispatcher,    NodeHealthCheckerService healthChecker){
      return new MyNodeStatusUpdater(context,dispatcher,healthChecker,metrics);
    }
  }
;
  YarnConfiguration conf=createNMConfig();
  nm.init(conf);
  Object[] services=nm.getServices().toArray();
  Object lastService=services[services.length - 1];
  Assert.assertTrue("last service is NOT the node status updater",lastService instanceof NodeStatusUpdater);
  new Thread(){
    public void run(){
      try {
        nm.start();
      }
 catch (      Throwable e) {
        TestNodeStatusUpdater.this.nmStartError=e;
        throw new YarnRuntimeException(e);
      }
    }
  }
.start();
  System.out.println(" ----- thread already started.." + nm.getServiceState());
  int waitCount=0;
  while (nm.getServiceState() == STATE.INITED && waitCount++ != 50) {
    LOG.info("Waiting for NM to start..");
    if (nmStartError != null) {
      LOG.error("Error during startup. ",nmStartError);
      Assert.fail(nmStartError.getCause().getMessage());
    }
    Thread.sleep(2000);
  }
  if (nm.getServiceState() != STATE.STARTED) {
    Assert.fail("NodeManager failed to start");
  }
  waitCount=0;
  while (heartBeatID <= 3 && waitCount++ != 200) {
    Thread.sleep(1000);
  }
  Assert.assertFalse(heartBeatID <= 3);
  Assert.assertEquals("Number of registered NMs is wrong!!",1,this.registeredNodes.size());
  nm.stop();
}

</code></pre>

<br>
<pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test completed containerStatus get back up when heart beat lost, and will
 * be sent via next heart beat.
 */
@Test(timeout=200000) public void testCompletedContainerStatusBackup() throws Exception {
  nm=new NodeManager(){
    @Override protected NodeStatusUpdater createNodeStatusUpdater(    Context context,    Dispatcher dispatcher,    NodeHealthCheckerService healthChecker){
      MyNodeStatusUpdater2 myNodeStatusUpdater=new MyNodeStatusUpdater2(context,dispatcher,healthChecker,metrics);
      return myNodeStatusUpdater;
    }
    @Override protected NMContext createNMContext(    NMContainerTokenSecretManager containerTokenSecretManager,    NMTokenSecretManagerInNM nmTokenSecretManager,    NMStateStoreService store){
      return new MyNMContext(containerTokenSecretManager,nmTokenSecretManager);
    }
  }
;
  YarnConfiguration conf=createNMConfig();
  nm.init(conf);
  nm.start();
  int waitCount=0;
  while (heartBeatID <= 3 && waitCount++ != 20) {
    Thread.sleep(500);
  }
  if (assertionFailedInThread.get()) {
    Assert.fail("ContainerStatus Backup failed");
  }
  nm.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.TestAuxServices </h4><pre class="type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuxServices(){
  Configuration conf=new Configuration();
  conf.setStrings(YarnConfiguration.NM_AUX_SERVICES,new String[]{"Asrv","Bsrv"});
  conf.setClass(String.format(YarnConfiguration.NM_AUX_SERVICE_FMT,"Asrv"),ServiceA.class,Service.class);
  conf.setClass(String.format(YarnConfiguration.NM_AUX_SERVICE_FMT,"Bsrv"),ServiceB.class,Service.class);
  final AuxServices aux=new AuxServices();
  aux.init(conf);
  int latch=1;
  for (  Service s : aux.getServices()) {
    assertEquals(INITED,s.getServiceState());
    if (s instanceof ServiceA) {
      latch*=2;
    }
 else     if (s instanceof ServiceB) {
      latch*=3;
    }
 else     fail("Unexpected service type " + s.getClass());
  }
  assertEquals("Invalid mix of services",6,latch);
  aux.start();
  for (  Service s : aux.getServices()) {
    assertEquals(STARTED,s.getServiceState());
  }
  aux.stop();
  for (  Service s : aux.getServices()) {
    assertEquals(STOPPED,s.getServiceState());
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuxServicesMeta(){
  Configuration conf=new Configuration();
  conf.setStrings(YarnConfiguration.NM_AUX_SERVICES,new String[]{"Asrv","Bsrv"});
  conf.setClass(String.format(YarnConfiguration.NM_AUX_SERVICE_FMT,"Asrv"),ServiceA.class,Service.class);
  conf.setClass(String.format(YarnConfiguration.NM_AUX_SERVICE_FMT,"Bsrv"),ServiceB.class,Service.class);
  final AuxServices aux=new AuxServices();
  aux.init(conf);
  int latch=1;
  for (  Service s : aux.getServices()) {
    assertEquals(INITED,s.getServiceState());
    if (s instanceof ServiceA) {
      latch*=2;
    }
 else     if (s instanceof ServiceB) {
      latch*=3;
    }
 else     fail("Unexpected service type " + s.getClass());
  }
  assertEquals("Invalid mix of services",6,latch);
  aux.start();
  for (  Service s : aux.getServices()) {
    assertEquals(STARTED,s.getServiceState());
  }
  Map<String,ByteBuffer> meta=aux.getMetaData();
  assertEquals(2,meta.size());
  assertEquals("A",new String(meta.get("Asrv").array()));
  assertEquals("B",new String(meta.get("Bsrv").array()));
  aux.stop();
  for (  Service s : aux.getServices()) {
    assertEquals(STOPPED,s.getServiceState());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.TestContainerManager </h4><pre class="type-9 type-11 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerManagerInitialization() throws IOException {
  containerManager.start();
  InetAddress localAddr=InetAddress.getLocalHost();
  String fqdn=localAddr.getCanonicalHostName();
  if (!localAddr.getHostAddress().equals(fqdn)) {
    Assert.assertEquals(fqdn,context.getNodeId().getHost());
  }
  boolean throwsException=false;
  try {
    List<ContainerId> containerIds=new ArrayList<ContainerId>();
    ContainerId id=createContainerId(0);
    containerIds.add(id);
    GetContainerStatusesRequest request=GetContainerStatusesRequest.newInstance(containerIds);
    GetContainerStatusesResponse response=containerManager.getContainerStatuses(request);
    if (response.getFailedRequests().containsKey(id)) {
      throw response.getFailedRequests().get(id).deSerialize();
    }
  }
 catch (  Throwable e) {
    throwsException=true;
  }
  Assert.assertTrue(throwsException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.TestContainerLaunch </h4><pre class="type-9 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=10000) public void testEnvExpansion() throws IOException {
  Path logPath=new Path("/nm/container/logs");
  String input=Apps.crossPlatformify("HADOOP_HOME") + "/share/hadoop/common/*" + ApplicationConstants.CLASS_PATH_SEPARATOR+ Apps.crossPlatformify("HADOOP_HOME")+ "/share/hadoop/common/lib/*"+ ApplicationConstants.CLASS_PATH_SEPARATOR+ Apps.crossPlatformify("HADOOP_LOG_HOME")+ ApplicationConstants.LOG_DIR_EXPANSION_VAR;
  String res=ContainerLaunch.expandEnvironment(input,logPath);
  if (Shell.WINDOWS) {
    Assert.assertEquals("%HADOOP_HOME%/share/hadoop/common/*;" + "%HADOOP_HOME%/share/hadoop/common/lib/*;" + "%HADOOP_LOG_HOME%/nm/container/logs",res);
  }
 else {
    Assert.assertEquals("$HADOOP_HOME/share/hadoop/common/*:" + "$HADOOP_HOME/share/hadoop/common/lib/*:" + "$HADOOP_LOG_HOME/nm/container/logs",res);
  }
  System.out.println(res);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.TestLocalResourcesTrackerImpl </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-19 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=100000) @SuppressWarnings("unchecked") public void testHierarchicalLocalCacheDirectories(){
  String user="testuser";
  DrainDispatcher dispatcher=null;
  try {
    Configuration conf=new Configuration();
    conf.set(YarnConfiguration.NM_LOCAL_CACHE_MAX_FILES_PER_DIRECTORY,"37");
    dispatcher=createDispatcher(conf);
    EventHandler<LocalizerEvent> localizerEventHandler=mock(EventHandler.class);
    EventHandler<LocalizerEvent> containerEventHandler=mock(EventHandler.class);
    dispatcher.register(LocalizerEventType.class,localizerEventHandler);
    dispatcher.register(ContainerEventType.class,containerEventHandler);
    DeletionService mockDelService=mock(DeletionService.class);
    ConcurrentMap<LocalResourceRequest,LocalizedResource> localrsrc=new ConcurrentHashMap<LocalResourceRequest,LocalizedResource>();
    LocalResourcesTracker tracker=new LocalResourcesTrackerImpl(user,null,dispatcher,localrsrc,true,conf,new NMNullStateStoreService());
    Path localDir=new Path("/tmp");
    ContainerId cId1=BuilderUtils.newContainerId(1,1,1,1);
    LocalResourceRequest lr1=createLocalResourceRequest(user,1,1,LocalResourceVisibility.PUBLIC);
    LocalizerContext lc1=new LocalizerContext(user,cId1,null);
    ResourceEvent reqEvent1=new ResourceRequestEvent(lr1,LocalResourceVisibility.PUBLIC,lc1);
    tracker.handle(reqEvent1);
    Path hierarchicalPath1=tracker.getPathForLocalization(lr1,localDir).getParent();
    ResourceLocalizedEvent rle1=new ResourceLocalizedEvent(lr1,new Path(hierarchicalPath1.toUri().toString() + Path.SEPARATOR + "file1"),120);
    tracker.handle(rle1);
    LocalResourceRequest lr2=createLocalResourceRequest(user,3,3,LocalResourceVisibility.PUBLIC);
    ResourceEvent reqEvent2=new ResourceRequestEvent(lr2,LocalResourceVisibility.PUBLIC,lc1);
    tracker.handle(reqEvent2);
    Path hierarchicalPath2=tracker.getPathForLocalization(lr2,localDir).getParent();
    ResourceFailedLocalizationEvent rfe2=new ResourceFailedLocalizationEvent(lr2,new Exception("Test").toString());
    tracker.handle(rfe2);
    Assert.assertNotSame(hierarchicalPath1,hierarchicalPath2);
    LocalResourceRequest lr3=createLocalResourceRequest(user,2,2,LocalResourceVisibility.PUBLIC);
    ResourceEvent reqEvent3=new ResourceRequestEvent(lr3,LocalResourceVisibility.PUBLIC,lc1);
    tracker.handle(reqEvent3);
    Path hierarchicalPath3=tracker.getPathForLocalization(lr3,localDir).getParent();
    ResourceLocalizedEvent rle3=new ResourceLocalizedEvent(lr3,new Path(hierarchicalPath3.toUri().toString() + Path.SEPARATOR + "file3"),120);
    tracker.handle(rle3);
    Assert.assertEquals(hierarchicalPath3.toUri().toString(),hierarchicalPath1.toUri().toString() + Path.SEPARATOR + "0");
    ResourceEvent relEvent1=new ResourceReleaseEvent(lr1,cId1);
    tracker.handle(relEvent1);
    int resources=0;
    Iterator<LocalizedResource> iter=tracker.iterator();
    while (iter.hasNext()) {
      iter.next();
      resources++;
    }
    Assert.assertEquals(2,resources);
    iter=tracker.iterator();
    while (iter.hasNext()) {
      LocalizedResource rsrc=iter.next();
      if (rsrc.getRefCount() == 0) {
        Assert.assertTrue(tracker.remove(rsrc,mockDelService));
        resources--;
      }
    }
    Assert.assertEquals(1,resources);
  }
  finally {
    if (dispatcher != null) {
      dispatcher.stop();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) @SuppressWarnings("unchecked") public void testConsistency(){
  String user="testuser";
  DrainDispatcher dispatcher=null;
  try {
    Configuration conf=new Configuration();
    dispatcher=createDispatcher(conf);
    EventHandler<LocalizerEvent> localizerEventHandler=mock(EventHandler.class);
    EventHandler<LocalizerEvent> containerEventHandler=mock(EventHandler.class);
    dispatcher.register(LocalizerEventType.class,localizerEventHandler);
    dispatcher.register(ContainerEventType.class,containerEventHandler);
    ContainerId cId1=BuilderUtils.newContainerId(1,1,1,1);
    LocalizerContext lc1=new LocalizerContext(user,cId1,null);
    LocalResourceRequest req1=createLocalResourceRequest(user,1,1,LocalResourceVisibility.PUBLIC);
    LocalizedResource lr1=createLocalizedResource(req1,dispatcher);
    ConcurrentMap<LocalResourceRequest,LocalizedResource> localrsrc=new ConcurrentHashMap<LocalResourceRequest,LocalizedResource>();
    localrsrc.put(req1,lr1);
    LocalResourcesTracker tracker=new LocalResourcesTrackerImpl(user,null,dispatcher,localrsrc,false,conf,new NMNullStateStoreService());
    ResourceEvent req11Event=new ResourceRequestEvent(req1,LocalResourceVisibility.PUBLIC,lc1);
    ResourceEvent rel11Event=new ResourceReleaseEvent(req1,cId1);
    tracker.handle(req11Event);
    dispatcher.await();
    Assert.assertEquals(1,lr1.getRefCount());
    dispatcher.await();
    verifyTrackedResourceCount(tracker,1);
    ResourceLocalizedEvent rle=new ResourceLocalizedEvent(req1,new Path("file:///tmp/r1"),1);
    lr1.handle(rle);
    Assert.assertTrue(lr1.getState().equals(ResourceState.LOCALIZED));
    Assert.assertTrue(createdummylocalizefile(new Path("file:///tmp/r1")));
    LocalizedResource rsrcbefore=tracker.iterator().next();
    File resFile=new File(lr1.getLocalPath().toUri().getRawPath().toString());
    Assert.assertTrue(resFile.exists());
    Assert.assertTrue(resFile.delete());
    tracker.handle(req11Event);
    dispatcher.await();
    lr1.handle(rle);
    Assert.assertTrue(lr1.getState().equals(ResourceState.LOCALIZED));
    LocalizedResource rsrcafter=tracker.iterator().next();
    if (rsrcbefore == rsrcafter) {
      Assert.fail("Localized resource should not be equal");
    }
    tracker.handle(rel11Event);
  }
  finally {
    if (dispatcher != null) {
      dispatcher.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.TestResourceLocalizationService </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) @SuppressWarnings("unchecked") public void testLocalResourcePath() throws Exception {
  DrainDispatcher dispatcher1=null;
  try {
    dispatcher1=new DrainDispatcher();
    String user="testuser";
    ApplicationId appId=BuilderUtils.newApplicationId(1,1);
    List<Path> localDirs=new ArrayList<Path>();
    String[] sDirs=new String[1];
    for (int i=0; i < 1; ++i) {
      localDirs.add(lfs.makeQualified(new Path(basedir,i + "")));
      sDirs[i]=localDirs.get(i).toString();
    }
    conf.setStrings(YarnConfiguration.NM_LOCAL_DIRS,sDirs);
    LocalDirsHandlerService localDirHandler=new LocalDirsHandlerService();
    localDirHandler.init(conf);
    EventHandler<ApplicationEvent> applicationBus=mock(EventHandler.class);
    dispatcher1.register(ApplicationEventType.class,applicationBus);
    EventHandler<ContainerEvent> containerBus=mock(EventHandler.class);
    dispatcher1.register(ContainerEventType.class,containerBus);
    ContainerExecutor exec=mock(ContainerExecutor.class);
    DeletionService delService=mock(DeletionService.class);
    LocalDirsHandlerService dirsHandler=new LocalDirsHandlerService();
    dirsHandler.init(conf);
    dispatcher1.init(conf);
    dispatcher1.start();
    ResourceLocalizationService rls=new ResourceLocalizationService(dispatcher1,exec,delService,localDirHandler,new NMNullStateStoreService());
    dispatcher1.register(LocalizationEventType.class,rls);
    rls.init(conf);
    rls.handle(createApplicationLocalizationEvent(user,appId));
    Container container1=createMockContainer(user,1);
    String localizerId1=container1.getContainerId().toString();
    rls.getPrivateLocalizers().put(localizerId1,rls.new LocalizerRunner(new LocalizerContext(user,container1.getContainerId(),null),localizerId1));
    LocalResourceRequest reqPriv=new LocalResourceRequest(new Path("file:///tmp1"),123L,LocalResourceType.FILE,LocalResourceVisibility.PRIVATE,"");
    List<LocalResourceRequest> privList=new ArrayList<LocalResourceRequest>();
    privList.add(reqPriv);
    LocalResourceRequest reqApp=new LocalResourceRequest(new Path("file:///tmp2"),123L,LocalResourceType.FILE,LocalResourceVisibility.APPLICATION,"");
    List<LocalResourceRequest> appList=new ArrayList<LocalResourceRequest>();
    appList.add(reqApp);
    Map<LocalResourceVisibility,Collection<LocalResourceRequest>> rsrcs=new HashMap<LocalResourceVisibility,Collection<LocalResourceRequest>>();
    rsrcs.put(LocalResourceVisibility.APPLICATION,appList);
    rsrcs.put(LocalResourceVisibility.PRIVATE,privList);
    dispatcher1.getEventHandler().handle(new ContainerLocalizationRequestEvent(container1,rsrcs));
    Assert.assertTrue(waitForPrivateDownloadToStart(rls,localizerId1,2,500));
    String userCachePath=StringUtils.join(Path.SEPARATOR,Arrays.asList(localDirs.get(0).toUri().getRawPath(),ContainerLocalizer.USERCACHE,user,ContainerLocalizer.FILECACHE));
    String userAppCachePath=StringUtils.join(Path.SEPARATOR,Arrays.asList(localDirs.get(0).toUri().getRawPath(),ContainerLocalizer.USERCACHE,user,ContainerLocalizer.APPCACHE,appId.toString(),ContainerLocalizer.FILECACHE));
    int returnedResources=0;
    boolean appRsrc=false, privRsrc=false;
    while (returnedResources < 2) {
      LocalizerHeartbeatResponse response=rls.heartbeat(createLocalizerStatus(localizerId1));
      for (      ResourceLocalizationSpec resourceSpec : response.getResourceSpecs()) {
        returnedResources++;
        Path destinationDirectory=new Path(resourceSpec.getDestinationDirectory().getFile());
        if (resourceSpec.getResource().getVisibility() == LocalResourceVisibility.APPLICATION) {
          appRsrc=true;
          Assert.assertEquals(userAppCachePath,destinationDirectory.getParent().toUri().toString());
        }
 else         if (resourceSpec.getResource().getVisibility() == LocalResourceVisibility.PRIVATE) {
          privRsrc=true;
          Assert.assertEquals(userCachePath,destinationDirectory.getParent().toUri().toString());
        }
 else {
          throw new Exception("Unexpected resource recevied.");
        }
      }
    }
    Assert.assertTrue(appRsrc && privRsrc);
  }
  finally {
    if (dispatcher1 != null) {
      dispatcher1.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestAMAuthorization </h4><pre class="type-9 type-11 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthorizedAccess() throws Exception {
  MyContainerManager containerManager=new MyContainerManager();
  rm=new MockRMWithAMS(conf,containerManager);
  rm.start();
  MockNM nm1=rm.registerNode("localhost:1234",5120);
  Map<ApplicationAccessType,String> acls=new HashMap<ApplicationAccessType,String>(2);
  acls.put(ApplicationAccessType.VIEW_APP,"*");
  RMApp app=rm.submitApp(1024,"appname","appuser",acls);
  nm1.nodeHeartbeat(true);
  int waitCount=0;
  while (containerManager.containerTokens == null && waitCount++ < 20) {
    LOG.info("Waiting for AM Launch to happen..");
    Thread.sleep(1000);
  }
  Assert.assertNotNull(containerManager.containerTokens);
  RMAppAttempt attempt=app.getCurrentAppAttempt();
  ApplicationAttemptId applicationAttemptId=attempt.getAppAttemptId();
  waitForLaunchedState(attempt);
  final Configuration conf=rm.getConfig();
  final YarnRPC rpc=YarnRPC.create(conf);
  UserGroupInformation currentUser=UserGroupInformation.createRemoteUser(applicationAttemptId.toString());
  Credentials credentials=containerManager.getContainerCredentials();
  final InetSocketAddress rmBindAddress=rm.getApplicationMasterService().getBindAddress();
  Token<? extends TokenIdentifier> amRMToken=MockRMWithAMS.setupAndReturnAMRMToken(rmBindAddress,credentials.getAllTokens());
  currentUser.addToken(amRMToken);
  ApplicationMasterProtocol client=currentUser.doAs(new PrivilegedAction<ApplicationMasterProtocol>(){
    @Override public ApplicationMasterProtocol run(){
      return (ApplicationMasterProtocol)rpc.getProxy(ApplicationMasterProtocol.class,rm.getApplicationMasterService().getBindAddress(),conf);
    }
  }
);
  RegisterApplicationMasterRequest request=Records.newRecord(RegisterApplicationMasterRequest.class);
  RegisterApplicationMasterResponse response=client.registerApplicationMaster(request);
  Assert.assertNotNull(response.getClientToAMTokenMasterKey());
  if (UserGroupInformation.isSecurityEnabled()) {
    Assert.assertTrue(response.getClientToAMTokenMasterKey().array().length > 0);
  }
  Assert.assertEquals("Register response has bad ACLs","*",response.getApplicationACLs().get(ApplicationAccessType.VIEW_APP));
}

</code></pre>

<br>
<pre class="type-11 type-2 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnauthorizedAccess() throws Exception {
  MyContainerManager containerManager=new MyContainerManager();
  rm=new MockRMWithAMS(conf,containerManager);
  rm.start();
  MockNM nm1=rm.registerNode("localhost:1234",5120);
  RMApp app=rm.submitApp(1024);
  nm1.nodeHeartbeat(true);
  int waitCount=0;
  while (containerManager.containerTokens == null && waitCount++ < 40) {
    LOG.info("Waiting for AM Launch to happen..");
    Thread.sleep(1000);
  }
  Assert.assertNotNull(containerManager.containerTokens);
  RMAppAttempt attempt=app.getCurrentAppAttempt();
  ApplicationAttemptId applicationAttemptId=attempt.getAppAttemptId();
  waitForLaunchedState(attempt);
  final Configuration conf=rm.getConfig();
  final YarnRPC rpc=YarnRPC.create(conf);
  final InetSocketAddress serviceAddr=conf.getSocketAddr(YarnConfiguration.RM_SCHEDULER_ADDRESS,YarnConfiguration.DEFAULT_RM_SCHEDULER_ADDRESS,YarnConfiguration.DEFAULT_RM_SCHEDULER_PORT);
  UserGroupInformation currentUser=UserGroupInformation.createRemoteUser(applicationAttemptId.toString());
  ApplicationMasterProtocol client=currentUser.doAs(new PrivilegedAction<ApplicationMasterProtocol>(){
    @Override public ApplicationMasterProtocol run(){
      return (ApplicationMasterProtocol)rpc.getProxy(ApplicationMasterProtocol.class,serviceAddr,conf);
    }
  }
);
  RegisterApplicationMasterRequest request=Records.newRecord(RegisterApplicationMasterRequest.class);
  try {
    client.registerApplicationMaster(request);
    Assert.fail("Should fail with authorization error");
  }
 catch (  Exception e) {
    if (isCause(AccessControlException.class,e)) {
      String expectedMessage="";
      if (UserGroupInformation.isSecurityEnabled()) {
        expectedMessage="Client cannot authenticate via:[TOKEN]";
      }
 else {
        expectedMessage="SIMPLE authentication is not enabled.  Available:[TOKEN]";
      }
      Assert.assertTrue(e.getCause().getMessage().contains(expectedMessage));
    }
 else {
      throw e;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestRM </h4><pre class="type-9 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=80000) public void testInvalidateAMHostPortWhenAMFailedOrKilled() throws Exception {
  YarnConfiguration conf=new YarnConfiguration();
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,1);
  MockRM rm1=new MockRM(conf);
  rm1.start();
  RMApp app1=rm1.submitApp(200);
  MockNM nm1=new MockNM("127.0.0.1:1234",15120,rm1.getResourceTrackerService());
  nm1.registerNode();
  MockAM am1=MockRM.launchAndRegisterAM(app1,rm1,nm1);
  MockRM.finishAMAndVerifyAppState(app1,rm1,nm1,am1);
  RMApp app2=rm1.submitApp(200);
  MockAM am2=MockRM.launchAndRegisterAM(app2,rm1,nm1);
  nm1.nodeHeartbeat(am2.getApplicationAttemptId(),1,ContainerState.COMPLETE);
  am2.waitForState(RMAppAttemptState.FAILED);
  rm1.waitForState(app2.getApplicationId(),RMAppState.FAILED);
  RMApp app3=rm1.submitApp(200);
  MockAM am3=MockRM.launchAndRegisterAM(app3,rm1,nm1);
  rm1.killApp(app3.getApplicationId());
  rm1.waitForState(app3.getApplicationId(),RMAppState.KILLED);
  rm1.waitForState(am3.getApplicationAttemptId(),RMAppAttemptState.KILLED);
  GetApplicationsRequest request1=GetApplicationsRequest.newInstance(EnumSet.of(YarnApplicationState.FINISHED,YarnApplicationState.KILLED,YarnApplicationState.FAILED));
  GetApplicationsResponse response1=rm1.getClientRMService().getApplications(request1);
  List<ApplicationReport> appList1=response1.getApplicationList();
  Assert.assertEquals(3,appList1.size());
  for (  ApplicationReport report : appList1) {
    if (report.getApplicationId().equals(app2.getApplicationId()) || report.getApplicationId().equals(app3.getApplicationId())) {
      Assert.assertEquals("N/A",report.getHost());
      Assert.assertEquals(-1,report.getRpcPort());
    }
    if (report.getApplicationId().equals(app1.getApplicationId())) {
      Assert.assertFalse(report.getHost().equals("N/A"));
      Assert.assertTrue(report.getRpcPort() != -1);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestRMAdminService </h4><pre class="type-9 type-11 type-2 type-7 type-10 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRMInitialsWithFileSystemBasedConfigurationProvider() throws Exception {
  configuration.set(YarnConfiguration.RM_CONFIGURATION_PROVIDER_CLASS,"org.apache.hadoop.yarn.FileSystemBasedConfigurationProvider");
  final File excludeHostsFile=new File(tmpDir.toString(),"excludeHosts");
  if (excludeHostsFile.exists()) {
    excludeHostsFile.delete();
  }
  if (!excludeHostsFile.createNewFile()) {
    Assert.fail("Can not create " + "excludeHosts");
  }
  PrintWriter fileWriter=new PrintWriter(excludeHostsFile);
  fileWriter.write("0.0.0.0:123");
  fileWriter.close();
  uploadToRemoteFileSystem(new Path(excludeHostsFile.getAbsolutePath()));
  YarnConfiguration yarnConf=new YarnConfiguration();
  yarnConf.set(YarnConfiguration.YARN_ADMIN_ACL,"world:anyone:rwcda");
  yarnConf.set(YarnConfiguration.RM_NODES_EXCLUDE_FILE_PATH,this.workingPath + "/excludeHosts");
  uploadConfiguration(yarnConf,"yarn-site.xml");
  CapacitySchedulerConfiguration csConf=new CapacitySchedulerConfiguration();
  csConf.set("yarn.scheduler.capacity.maximum-applications","5000");
  uploadConfiguration(csConf,"capacity-scheduler.xml");
  String aclsString="alice,bob users,wheel";
  Configuration newConf=new Configuration();
  newConf.set("security.applicationclient.protocol.acl",aclsString);
  uploadConfiguration(newConf,"hadoop-policy.xml");
  Configuration conf=new Configuration();
  conf.setBoolean(CommonConfigurationKeysPublic.HADOOP_SECURITY_AUTHORIZATION,true);
  conf.set("hadoop.proxyuser.test.groups","test_groups");
  conf.set("hadoop.proxyuser.test.hosts","test_hosts");
  conf.setClass(CommonConfigurationKeys.HADOOP_SECURITY_GROUP_MAPPING,MockUnixGroupsMapping.class,GroupMappingServiceProvider.class);
  uploadConfiguration(conf,"core-site.xml");
  MockUnixGroupsMapping.updateGroups();
  ResourceManager resourceManager=null;
  try {
    try {
      resourceManager=new ResourceManager();
      resourceManager.init(configuration);
      resourceManager.start();
    }
 catch (    Exception ex) {
      fail("Should not get any exceptions");
    }
    Set<String> excludeHosts=resourceManager.getRMContext().getNodesListManager().getHostsReader().getExcludedHosts();
    Assert.assertTrue(excludeHosts.size() == 1);
    Assert.assertTrue(excludeHosts.contains("0.0.0.0:123"));
    String aclStringAfter=resourceManager.adminService.getAccessControlList().getAclString().trim();
    Assert.assertEquals(aclStringAfter,"world:anyone:rwcda");
    CapacityScheduler cs=(CapacityScheduler)resourceManager.getRMContext().getScheduler();
    int maxAppsAfter=cs.getConfiguration().getMaximumSystemApplications();
    Assert.assertEquals(maxAppsAfter,5000);
    ServiceAuthorizationManager adminServiceServiceManager=resourceManager.adminService.getServer().getServiceAuthorizationManager();
    verifyServiceACLsRefresh(adminServiceServiceManager,org.apache.hadoop.yarn.api.ApplicationClientProtocolPB.class,aclsString);
    ServiceAuthorizationManager clientRMServiceServiceManager=resourceManager.getRMContext().getClientRMService().getServer().getServiceAuthorizationManager();
    verifyServiceACLsRefresh(clientRMServiceServiceManager,org.apache.hadoop.yarn.api.ApplicationClientProtocolPB.class,aclsString);
    ServiceAuthorizationManager appMasterService=resourceManager.getRMContext().getApplicationMasterService().getServer().getServiceAuthorizationManager();
    verifyServiceACLsRefresh(appMasterService,org.apache.hadoop.yarn.api.ApplicationClientProtocolPB.class,aclsString);
    ServiceAuthorizationManager RTService=resourceManager.getRMContext().getResourceTrackerService().getServer().getServiceAuthorizationManager();
    verifyServiceACLsRefresh(RTService,org.apache.hadoop.yarn.api.ApplicationClientProtocolPB.class,aclsString);
    Assert.assertTrue(ProxyUsers.getDefaultImpersonationProvider().getProxyGroups().get("hadoop.proxyuser.test.groups").size() == 1);
    Assert.assertTrue(ProxyUsers.getDefaultImpersonationProvider().getProxyGroups().get("hadoop.proxyuser.test.groups").contains("test_groups"));
    Assert.assertTrue(ProxyUsers.getDefaultImpersonationProvider().getProxyHosts().get("hadoop.proxyuser.test.hosts").size() == 1);
    Assert.assertTrue(ProxyUsers.getDefaultImpersonationProvider().getProxyHosts().get("hadoop.proxyuser.test.hosts").contains("test_hosts"));
    List<String> groupAfter=Groups.getUserToGroupsMappingService(configuration).getGroups(UserGroupInformation.getCurrentUser().getUserName());
    Assert.assertTrue(groupAfter.contains("test_group_D") && groupAfter.contains("test_group_E") && groupAfter.contains("test_group_F")&& groupAfter.size() == 3);
  }
  finally {
    if (resourceManager != null) {
      resourceManager.stop();
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshNodesWithFileSystemBasedConfigurationProvider() throws IOException, YarnException {
  configuration.set(YarnConfiguration.RM_CONFIGURATION_PROVIDER_CLASS,"org.apache.hadoop.yarn.FileSystemBasedConfigurationProvider");
  uploadDefaultConfiguration();
  try {
    rm=new MockRM(configuration);
    rm.init(configuration);
    rm.start();
  }
 catch (  Exception ex) {
    fail("Should not get any exceptions");
  }
  final File excludeHostsFile=new File(tmpDir.toString(),"excludeHosts");
  if (excludeHostsFile.exists()) {
    excludeHostsFile.delete();
  }
  if (!excludeHostsFile.createNewFile()) {
    Assert.fail("Can not create " + "excludeHosts");
  }
  PrintWriter fileWriter=new PrintWriter(excludeHostsFile);
  fileWriter.write("0.0.0.0:123");
  fileWriter.close();
  uploadToRemoteFileSystem(new Path(excludeHostsFile.getAbsolutePath()));
  Configuration yarnConf=new YarnConfiguration();
  yarnConf.set(YarnConfiguration.RM_NODES_EXCLUDE_FILE_PATH,this.workingPath + "/excludeHosts");
  uploadConfiguration(yarnConf,YarnConfiguration.YARN_SITE_CONFIGURATION_FILE);
  rm.adminService.refreshNodes(RefreshNodesRequest.newInstance());
  Set<String> excludeHosts=rm.getNodesListManager().getHostsReader().getExcludedHosts();
  Assert.assertTrue(excludeHosts.size() == 1);
  Assert.assertTrue(excludeHosts.contains("0.0.0.0:123"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestRMRestart </h4><pre class="type-9 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testRMRestartGetApplicationList() throws Exception {
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,1);
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  MockRM rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("127.0.0.1:1234",15120,rm1.getResourceTrackerService());
  nm1.registerNode();
  RMApp app0=rm1.submitApp(200,"name","user",null,false,"default",1,null,"myType");
  MockAM am0=launchAM(app0,rm1,nm1);
  finishApplicationMaster(app0,rm1,nm1,am0);
  RMApp app1=rm1.submitApp(200,"name","user",null,false,"default",1,null,"myType");
  MockAM am1=launchAM(app1,rm1,nm1);
  nm1.nodeHeartbeat(am1.getApplicationAttemptId(),1,ContainerState.COMPLETE);
  am1.waitForState(RMAppAttemptState.FAILED);
  rm1.waitForState(app1.getApplicationId(),RMAppState.FAILED);
  RMApp app2=rm1.submitApp(200,"name","user",null,false,"default",1,null,"myType");
  MockAM am2=launchAM(app2,rm1,nm1);
  rm1.killApp(app2.getApplicationId());
  rm1.waitForState(app2.getApplicationId(),RMAppState.KILLED);
  rm1.waitForState(am2.getApplicationAttemptId(),RMAppAttemptState.KILLED);
  MockRM rm2=new MockRM(conf,memStore){
    @Override protected RMAppManager createRMAppManager(){
      return spy(super.createRMAppManager());
    }
  }
;
  rm2.start();
  GetApplicationsRequest request1=GetApplicationsRequest.newInstance(EnumSet.of(YarnApplicationState.FINISHED,YarnApplicationState.KILLED,YarnApplicationState.FAILED));
  GetApplicationsResponse response1=rm2.getClientRMService().getApplications(request1);
  List<ApplicationReport> appList1=response1.getApplicationList();
  boolean forApp0=false, forApp1=false, forApp2=false;
  for (  ApplicationReport report : appList1) {
    if (report.getApplicationId().equals(app0.getApplicationId())) {
      Assert.assertEquals(YarnApplicationState.FINISHED,report.getYarnApplicationState());
      forApp0=true;
    }
    if (report.getApplicationId().equals(app1.getApplicationId())) {
      Assert.assertEquals(YarnApplicationState.FAILED,report.getYarnApplicationState());
      forApp1=true;
    }
    if (report.getApplicationId().equals(app2.getApplicationId())) {
      Assert.assertEquals(YarnApplicationState.KILLED,report.getYarnApplicationState());
      forApp2=true;
    }
  }
  Assert.assertTrue(forApp0 && forApp1 && forApp2);
  Set<String> appTypes=new HashSet<String>();
  appTypes.add("myType");
  GetApplicationsRequest request2=GetApplicationsRequest.newInstance(appTypes);
  GetApplicationsResponse response2=rm2.getClientRMService().getApplications(request2);
  List<ApplicationReport> appList2=response2.getApplicationList();
  Assert.assertTrue(3 == appList2.size());
  verify(rm2.getRMAppManager(),times(3)).logApplicationSummary(isA(ApplicationId.class));
  rm1.stop();
  rm2.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestResourceManager </h4><pre class="type-9 type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=50000) public void testFilterOverrides() throws Exception {
  String filterInitializerConfKey="hadoop.http.filter.initializers";
  String[] filterInitializers={AuthenticationFilterInitializer.class.getName(),RMAuthenticationFilterInitializer.class.getName(),AuthenticationFilterInitializer.class.getName() + "," + RMAuthenticationFilterInitializer.class.getName(),AuthenticationFilterInitializer.class.getName() + ", " + RMAuthenticationFilterInitializer.class.getName(),AuthenticationFilterInitializer.class.getName() + ", " + this.getClass().getName()};
  for (  String filterInitializer : filterInitializers) {
    resourceManager=new ResourceManager();
    Configuration conf=new YarnConfiguration();
    conf.set(filterInitializerConfKey,filterInitializer);
    conf.set("hadoop.security.authentication","kerberos");
    conf.set("hadoop.http.authentication.type","kerberos");
    try {
      try {
        UserGroupInformation.setConfiguration(conf);
      }
 catch (      Exception e) {
        LOG.info("Got expected exception");
      }
      resourceManager.init(conf);
      resourceManager.startWepApp();
    }
 catch (    RuntimeException e) {
      String tmp=resourceManager.getConfig().get(filterInitializerConfKey);
      if (filterInitializer.contains(this.getClass().getName())) {
        Assert.assertEquals(RMAuthenticationFilterInitializer.class.getName() + "," + this.getClass().getName(),tmp);
      }
 else {
        Assert.assertEquals(RMAuthenticationFilterInitializer.class.getName(),tmp);
      }
      resourceManager.stop();
    }
  }
  String[] simpleFilterInitializers={"",StaticUserWebFilter.class.getName()};
  for (  String filterInitializer : simpleFilterInitializers) {
    resourceManager=new ResourceManager();
    Configuration conf=new YarnConfiguration();
    conf.set(filterInitializerConfKey,filterInitializer);
    try {
      UserGroupInformation.setConfiguration(conf);
      resourceManager.init(conf);
      resourceManager.startWepApp();
    }
 catch (    RuntimeException e) {
      String tmp=resourceManager.getConfig().get(filterInitializerConfKey);
      if (filterInitializer.equals(StaticUserWebFilter.class.getName())) {
        Assert.assertEquals(RMAuthenticationFilterInitializer.class.getName() + "," + StaticUserWebFilter.class.getName(),tmp);
      }
 else {
        Assert.assertEquals(RMAuthenticationFilterInitializer.class.getName(),tmp);
      }
      resourceManager.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestWorkPreservingRMRestart </h4><pre class="type-9 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=20000) public void testSchedulerRecovery() throws Exception {
  conf.setBoolean(CapacitySchedulerConfiguration.ENABLE_USER_METRICS,true);
  conf.set(CapacitySchedulerConfiguration.RESOURCE_CALCULATOR_CLASS,DominantResourceCalculator.class.getName());
  int containerMemory=1024;
  Resource containerResource=Resource.newInstance(containerMemory,1);
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("127.0.0.1:1234",8192,rm1.getResourceTrackerService());
  nm1.registerNode();
  RMApp app1=rm1.submitApp(200);
  MockAM am1=MockRM.launchAndRegisterAM(app1,rm1,nm1);
  rm1.clearQueueMetrics(app1);
  rm2=new MockRM(conf,memStore);
  rm2.start();
  nm1.setResourceTrackerService(rm2.getResourceTrackerService());
  RMApp recoveredApp1=rm2.getRMContext().getRMApps().get(app1.getApplicationId());
  RMAppAttempt loadedAttempt1=recoveredApp1.getCurrentAppAttempt();
  NMContainerStatus amContainer=TestRMRestart.createNMContainerStatus(am1.getApplicationAttemptId(),1,ContainerState.RUNNING);
  NMContainerStatus runningContainer=TestRMRestart.createNMContainerStatus(am1.getApplicationAttemptId(),2,ContainerState.RUNNING);
  NMContainerStatus completedContainer=TestRMRestart.createNMContainerStatus(am1.getApplicationAttemptId(),3,ContainerState.COMPLETE);
  nm1.registerNode(Arrays.asList(amContainer,runningContainer,completedContainer),null);
  waitForNumContainersToRecover(2,rm2,am1.getApplicationAttemptId());
  Set<ContainerId> launchedContainers=((RMNodeImpl)rm2.getRMContext().getRMNodes().get(nm1.getNodeId())).getLaunchedContainers();
  assertTrue(launchedContainers.contains(amContainer.getContainerId()));
  assertTrue(launchedContainers.contains(runningContainer.getContainerId()));
  rm2.waitForState(nm1,amContainer.getContainerId(),RMContainerState.RUNNING);
  rm2.waitForState(nm1,runningContainer.getContainerId(),RMContainerState.RUNNING);
  rm2.waitForContainerToComplete(loadedAttempt1,completedContainer);
  AbstractYarnScheduler scheduler=(AbstractYarnScheduler)rm2.getResourceScheduler();
  SchedulerNode schedulerNode1=scheduler.getSchedulerNode(nm1.getNodeId());
  Resource usedResources=Resources.multiply(containerResource,2);
  Resource nmResource=Resource.newInstance(nm1.getMemory(),nm1.getvCores());
  assertTrue(schedulerNode1.isValidContainer(amContainer.getContainerId()));
  assertTrue(schedulerNode1.isValidContainer(runningContainer.getContainerId()));
  assertFalse(schedulerNode1.isValidContainer(completedContainer.getContainerId()));
  assertEquals(2,schedulerNode1.getNumContainers());
  assertEquals(Resources.subtract(nmResource,usedResources),schedulerNode1.getAvailableResource());
  assertEquals(usedResources,schedulerNode1.getUsedResource());
  Resource availableResources=Resources.subtract(nmResource,usedResources);
  Map<ApplicationId,SchedulerApplication> schedulerApps=((AbstractYarnScheduler)rm2.getResourceScheduler()).getSchedulerApplications();
  SchedulerApplication schedulerApp=schedulerApps.get(recoveredApp1.getApplicationId());
  if (schedulerClass.equals(CapacityScheduler.class)) {
    checkCSQueue(rm2,schedulerApp,nmResource,nmResource,usedResources,2);
  }
 else   if (schedulerClass.equals(FifoScheduler.class)) {
    checkFifoQueue(schedulerApp,usedResources,availableResources);
  }
  SchedulerApplicationAttempt schedulerAttempt=schedulerApp.getCurrentAppAttempt();
  assertTrue(schedulerAttempt.getLiveContainers().contains(scheduler.getRMContainer(amContainer.getContainerId())));
  assertTrue(schedulerAttempt.getLiveContainers().contains(scheduler.getRMContainer(runningContainer.getContainerId())));
  assertEquals(schedulerAttempt.getCurrentConsumption(),usedResources);
  if (scheduler.getClass() != FairScheduler.class) {
    assertEquals(availableResources,schedulerAttempt.getHeadroom());
  }
  assertEquals((1 << 22) + 1,schedulerAttempt.getNewContainerId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.monitor.capacity.TestProportionalCapacityPreemptionPolicy </h4><pre class="type-11 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPolicyInitializeAfterSchedulerInitialized(){
  Configuration conf=new Configuration();
  conf.set(YarnConfiguration.RM_SCHEDULER_MONITOR_POLICIES,ProportionalCapacityPreemptionPolicy.class.getCanonicalName());
  conf.setBoolean(YarnConfiguration.RM_SCHEDULER_ENABLE_MONITORS,true);
  @SuppressWarnings("resource") MockRM rm=new MockRM(conf);
  rm.init(conf);
  for (  Service service : rm.getRMActiveService().getServices()) {
    if (service instanceof SchedulingMonitor) {
      ProportionalCapacityPreemptionPolicy policy=(ProportionalCapacityPreemptionPolicy)((SchedulingMonitor)service).getSchedulingEditPolicy();
      assertNotNull(policy.getResourceCalculator());
      return;
    }
  }
  fail("Failed to find SchedulingMonitor service, please check what happened");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.TestParentQueue </h4><pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSingleLevelQueuesPrecision() throws Exception {
  setupSingleLevelQueues(csConf);
  final String Q_A=CapacitySchedulerConfiguration.ROOT + "." + "a";
  csConf.setCapacity(Q_A,30);
  final String Q_B=CapacitySchedulerConfiguration.ROOT + "." + "b";
  csConf.setCapacity(Q_B,70.5F);
  Map<String,CSQueue> queues=new HashMap<String,CSQueue>();
  boolean exceptionOccured=false;
  try {
    CapacityScheduler.parseQueue(csContext,csConf,null,CapacitySchedulerConfiguration.ROOT,queues,queues,TestUtils.spyHook);
  }
 catch (  IllegalArgumentException ie) {
    exceptionOccured=true;
  }
  if (!exceptionOccured) {
    Assert.fail("Capacity is more then 100% so should be failed.");
  }
  csConf.setCapacity(Q_A,30);
  csConf.setCapacity(Q_B,70);
  exceptionOccured=false;
  queues.clear();
  try {
    CapacityScheduler.parseQueue(csContext,csConf,null,CapacitySchedulerConfiguration.ROOT,queues,queues,TestUtils.spyHook);
  }
 catch (  IllegalArgumentException ie) {
    exceptionOccured=true;
  }
  if (exceptionOccured) {
    Assert.fail("Capacity is 100% so should not be failed.");
  }
  csConf.setCapacity(Q_A,30);
  csConf.setCapacity(Q_B,70.005F);
  exceptionOccured=false;
  queues.clear();
  try {
    CapacityScheduler.parseQueue(csContext,csConf,null,CapacitySchedulerConfiguration.ROOT,queues,queues,TestUtils.spyHook);
  }
 catch (  IllegalArgumentException ie) {
    exceptionOccured=true;
  }
  if (exceptionOccured) {
    Assert.fail("Capacity is under PRECISION which is .05% so should not be failed.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.TestFairScheduler </h4><pre class="type-9 type-13 type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test to verify the behavior of{@link FSQueue#assignContainer(FSSchedulerNode)})
 * Create two queues under root (fifoQueue and fairParent), and two queues
 * under fairParent (fairChild1 and fairChild2). Submit two apps to the
 * fifoQueue and one each to the fairChild* queues, all apps requiring 4
 * containers each of the total 16 container capacity
 * Assert the number of containers for each app after 4, 8, 12 and 16 updates.
 * @throws Exception
 */
@Test(timeout=5000) public void testAssignContainer() throws Exception {
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  final String user="user1";
  final String fifoQueue="fifo";
  final String fairParent="fairParent";
  final String fairChild1=fairParent + ".fairChild1";
  final String fairChild2=fairParent + ".fairChild2";
  RMNode node1=MockNodes.newNodeInfo(1,Resources.createResource(8192,8),1,"127.0.0.1");
  RMNode node2=MockNodes.newNodeInfo(1,Resources.createResource(8192,8),2,"127.0.0.2");
  NodeAddedSchedulerEvent nodeEvent1=new NodeAddedSchedulerEvent(node1);
  NodeAddedSchedulerEvent nodeEvent2=new NodeAddedSchedulerEvent(node2);
  scheduler.handle(nodeEvent1);
  scheduler.handle(nodeEvent2);
  ApplicationAttemptId attId1=createSchedulingRequest(1024,fifoQueue,user,4);
  ApplicationAttemptId attId2=createSchedulingRequest(1024,fairChild1,user,4);
  ApplicationAttemptId attId3=createSchedulingRequest(1024,fairChild2,user,4);
  ApplicationAttemptId attId4=createSchedulingRequest(1024,fifoQueue,user,4);
  FSAppAttempt app1=scheduler.getSchedulerApp(attId1);
  FSAppAttempt app2=scheduler.getSchedulerApp(attId2);
  FSAppAttempt app3=scheduler.getSchedulerApp(attId3);
  FSAppAttempt app4=scheduler.getSchedulerApp(attId4);
  scheduler.getQueueManager().getLeafQueue(fifoQueue,true).setPolicy(SchedulingPolicy.parse("fifo"));
  scheduler.update();
  NodeUpdateSchedulerEvent updateEvent1=new NodeUpdateSchedulerEvent(node1);
  NodeUpdateSchedulerEvent updateEvent2=new NodeUpdateSchedulerEvent(node2);
  for (int i=0; i < 8; i++) {
    scheduler.handle(updateEvent1);
    scheduler.handle(updateEvent2);
    if ((i + 1) % 2 == 0) {
      String ERR="Wrong number of assigned containers after " + (i + 1) + " updates";
      if (i < 4) {
        assertEquals(ERR,(i + 1),app1.getLiveContainers().size());
        assertEquals(ERR,0,app4.getLiveContainers().size());
      }
 else {
        assertEquals(ERR,4,app1.getLiveContainers().size());
        assertEquals(ERR,(i - 3),app4.getLiveContainers().size());
      }
      assertEquals(ERR,(i + 1) / 2,app2.getLiveContainers().size());
      assertEquals(ERR,(i + 1) / 2,app3.getLiveContainers().size());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFairShareWithMinAlloc() throws Exception {
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<queue name=\"queueA\">");
  out.println("<minResources>1024mb,0vcores</minResources>");
  out.println("</queue>");
  out.println("<queue name=\"queueB\">");
  out.println("<minResources>2048mb,0vcores</minResources>");
  out.println("</queue>");
  out.println("</allocations>");
  out.close();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  RMNode node1=MockNodes.newNodeInfo(1,Resources.createResource(3 * 1024),1,"127.0.0.1");
  NodeAddedSchedulerEvent nodeEvent1=new NodeAddedSchedulerEvent(node1);
  scheduler.handle(nodeEvent1);
  createSchedulingRequest(2 * 1024,"queueA","user1");
  createSchedulingRequest(2 * 1024,"queueB","user1");
  scheduler.update();
  Collection<FSLeafQueue> queues=scheduler.getQueueManager().getLeafQueues();
  assertEquals(3,queues.size());
  for (  FSLeafQueue p : queues) {
    if (p.getName().equals("root.queueA")) {
      assertEquals(1024,p.getFairShare().getMemory());
    }
 else     if (p.getName().equals("root.queueB")) {
      assertEquals(2048,p.getFairShare().getMemory());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFairShareAndWeightsInNestedUserQueueRule() throws Exception {
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<queue name=\"parentq\" type=\"parent\">");
  out.println("<minResources>1024mb,0vcores</minResources>");
  out.println("</queue>");
  out.println("<queuePlacementPolicy>");
  out.println("<rule name=\"nestedUserQueue\">");
  out.println("     <rule name=\"specified\" create=\"false\" />");
  out.println("</rule>");
  out.println("<rule name=\"default\" />");
  out.println("</queuePlacementPolicy>");
  out.println("</allocations>");
  out.close();
  RMApp rmApp1=new MockRMApp(0,0,RMAppState.NEW);
  RMApp rmApp2=new MockRMApp(1,1,RMAppState.NEW);
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  int capacity=16 * 1024;
  RMNode node1=MockNodes.newNodeInfo(1,Resources.createResource(capacity),1,"127.0.0.1");
  NodeAddedSchedulerEvent nodeEvent1=new NodeAddedSchedulerEvent(node1);
  scheduler.handle(nodeEvent1);
  createSchedulingRequest(10 * 1024,"root.parentq","user1");
  createSchedulingRequest(10 * 1024,"root.parentq","user2");
  createSchedulingRequest(10 * 1024,"root.default","user3");
  scheduler.update();
  scheduler.getQueueManager().getRootQueue().setSteadyFairShare(scheduler.getClusterResource());
  scheduler.getQueueManager().getRootQueue().recomputeSteadyShares();
  Collection<FSLeafQueue> leafQueues=scheduler.getQueueManager().getLeafQueues();
  for (  FSLeafQueue leaf : leafQueues) {
    if (leaf.getName().equals("root.parentq.user1") || leaf.getName().equals("root.parentq.user2")) {
      assertEquals(capacity / 4,leaf.getFairShare().getMemory());
      assertEquals(capacity / 4,leaf.getSteadyFairShare().getMemory());
      assertEquals(1.0,leaf.getWeights().getWeight(ResourceType.MEMORY),0);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=5000) public void testIsStarvedForFairShare() throws Exception {
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<queue name=\"queueA\">");
  out.println("<weight>.25</weight>");
  out.println("</queue>");
  out.println("<queue name=\"queueB\">");
  out.println("<weight>.75</weight>");
  out.println("</queue>");
  out.println("</allocations>");
  out.close();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  RMNode node1=MockNodes.newNodeInfo(1,Resources.createResource(4 * 1024,4),1,"127.0.0.1");
  NodeAddedSchedulerEvent nodeEvent1=new NodeAddedSchedulerEvent(node1);
  scheduler.handle(nodeEvent1);
  createSchedulingRequest(3 * 1024,"queueA","user1");
  scheduler.update();
  NodeUpdateSchedulerEvent nodeEvent2=new NodeUpdateSchedulerEvent(node1);
  scheduler.handle(nodeEvent2);
  createSchedulingRequest(1 * 1024,"queueB","user1");
  scheduler.update();
  Collection<FSLeafQueue> queues=scheduler.getQueueManager().getLeafQueues();
  assertEquals(3,queues.size());
  for (  FSLeafQueue p : queues) {
    if (p.getName().equals("root.queueA")) {
      assertEquals(false,scheduler.isStarvedForFairShare(p));
    }
 else     if (p.getName().equals("root.queueB")) {
      assertEquals(true,scheduler.isStarvedForFairShare(p));
    }
  }
  scheduler.handle(nodeEvent2);
  for (  FSLeafQueue p : queues) {
    if (p.getName().equals("root.queueB")) {
      assertEquals(false,scheduler.isStarvedForFairShare(p));
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects are null
"></span><br>
@Test public void testDefaultRuleInitializesProperlyWhenPolicyNotConfigured() throws IOException {
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  conf.setBoolean(FairSchedulerConfiguration.ALLOW_UNDECLARED_POOLS,false);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("</allocations>");
  out.close();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  List<QueuePlacementRule> rules=scheduler.allocConf.placementPolicy.getRules();
  for (  QueuePlacementRule rule : rules) {
    if (rule instanceof Default) {
      Default defaultRule=(Default)rule;
      assertNotNull(defaultRule.defaultQueueName);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=5000) public void testIsStarvedForMinShare() throws Exception {
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<queue name=\"queueA\">");
  out.println("<minResources>2048mb,0vcores</minResources>");
  out.println("</queue>");
  out.println("<queue name=\"queueB\">");
  out.println("<minResources>2048mb,0vcores</minResources>");
  out.println("</queue>");
  out.println("</allocations>");
  out.close();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  RMNode node1=MockNodes.newNodeInfo(1,Resources.createResource(4 * 1024,4),1,"127.0.0.1");
  NodeAddedSchedulerEvent nodeEvent1=new NodeAddedSchedulerEvent(node1);
  scheduler.handle(nodeEvent1);
  createSchedulingRequest(3 * 1024,"queueA","user1");
  scheduler.update();
  NodeUpdateSchedulerEvent nodeEvent2=new NodeUpdateSchedulerEvent(node1);
  scheduler.handle(nodeEvent2);
  createSchedulingRequest(1 * 1024,"queueB","user1");
  scheduler.update();
  Collection<FSLeafQueue> queues=scheduler.getQueueManager().getLeafQueues();
  assertEquals(3,queues.size());
  for (  FSLeafQueue p : queues) {
    if (p.getName().equals("root.queueA")) {
      assertEquals(false,scheduler.isStarvedForMinShare(p));
    }
 else     if (p.getName().equals("root.queueB")) {
      assertEquals(true,scheduler.isStarvedForMinShare(p));
    }
  }
  scheduler.handle(nodeEvent2);
  for (  FSLeafQueue p : queues) {
    if (p.getName().equals("root.queueB")) {
      assertEquals(false,scheduler.isStarvedForMinShare(p));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.TestFairSchedulerFairShare </h4><pre class="type-13 type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFairShareWithDRFMultipleActiveQueuesUnderDifferentParent() throws IOException {
  int nodeMem=16 * 1024;
  int nodeVCores=10;
  createClusterWithQueuesAndOneNode(nodeMem,nodeVCores,"drf");
  createSchedulingRequest(2 * 1024,"root.parentA.childA1","user1");
  createSchedulingRequest(3 * 1024,"root.parentA.childA2","user2");
  createSchedulingRequest(1 * 1024,"root.parentB.childB1","user3");
  createSchedulingRequest(1 * 1024,"root.default","user4");
  scheduler.update();
  for (int i=1; i <= 2; i++) {
    assertEquals(40,(double)scheduler.getQueueManager().getLeafQueue("root.parentA.childA" + i,false).getFairShare().getMemory() / nodeMem * 100,.9);
    assertEquals(40,(double)scheduler.getQueueManager().getLeafQueue("root.parentA.childA" + i,false).getFairShare().getVirtualCores() / nodeVCores * 100,.9);
  }
  assertEquals(10,(double)scheduler.getQueueManager().getLeafQueue("root.parentB.childB1",false).getFairShare().getMemory() / nodeMem * 100,.9);
  assertEquals(10,(double)scheduler.getQueueManager().getLeafQueue("root.parentB.childB1",false).getFairShare().getVirtualCores() / nodeVCores * 100,.9);
  Collection<FSLeafQueue> leafQueues=scheduler.getQueueManager().getLeafQueues();
  for (  FSLeafQueue leaf : leafQueues) {
    if (leaf.getName().startsWith("root.parentA")) {
      assertEquals(0.2,(double)leaf.getSteadyFairShare().getMemory() / nodeMem,0.001);
      assertEquals(0.2,(double)leaf.getSteadyFairShare().getVirtualCores() / nodeVCores,0.001);
    }
 else     if (leaf.getName().startsWith("root.parentB")) {
      assertEquals(0.05,(double)leaf.getSteadyFairShare().getMemory() / nodeMem,0.001);
      assertEquals(0.1,(double)leaf.getSteadyFairShare().getVirtualCores() / nodeVCores,0.001);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFairShareNoAppsRunning() throws IOException {
  int nodeCapacity=16 * 1024;
  createClusterWithQueuesAndOneNode(nodeCapacity,"fair");
  scheduler.update();
  Collection<FSLeafQueue> leafQueues=scheduler.getQueueManager().getLeafQueues();
  for (  FSLeafQueue leaf : leafQueues) {
    if (leaf.getName().startsWith("root.parentA")) {
      assertEquals(0,(double)leaf.getFairShare().getMemory() / nodeCapacity,0);
    }
 else     if (leaf.getName().startsWith("root.parentB")) {
      assertEquals(0,(double)leaf.getFairShare().getMemory() / nodeCapacity,0);
    }
  }
  verifySteadyFairShareMemory(leafQueues,nodeCapacity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.security.TestDelegationTokenRenewer </h4><pre class="type-9 type-13 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testAppRejectionWithCancelledDelegationToken() throws Exception {
  MyFS dfs=(MyFS)FileSystem.get(conf);
  LOG.info("dfs=" + (Object)dfs.hashCode() + ";conf="+ conf.hashCode());
  MyToken token=dfs.getDelegationToken("user1");
  token.cancelToken();
  Credentials ts=new Credentials();
  ts.addToken(token.getKind(),token);
  ApplicationId appId=BuilderUtils.newApplicationId(0,0);
  delegationTokenRenewer.addApplicationAsync(appId,ts,true);
  int waitCnt=20;
  while (waitCnt-- > 0) {
    if (!eventQueue.isEmpty()) {
      Event evt=eventQueue.take();
      if (evt.getType() == RMAppEventType.APP_REJECTED) {
        Assert.assertTrue(((RMAppEvent)evt).getApplicationId().equals(appId));
        return;
      }
    }
 else {
      Thread.sleep(500);
    }
  }
  fail("App submission with a cancelled token should have failed");
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Basic idea of the test:
 * 0. Setup token KEEP_ALIVE
 * 1. create tokens.
 * 2. register them for renewal - to be cancelled on app complete
 * 3. Complete app.
 * 4. Verify token is alive within the KEEP_ALIVE time
 * 5. Verify token has been cancelled after the KEEP_ALIVE_TIME
 * @throws IOException
 * @throws URISyntaxException
 */
@Test(timeout=60000) public void testDTKeepAlive1() throws Exception {
  Configuration lconf=new Configuration(conf);
  lconf.setBoolean(YarnConfiguration.LOG_AGGREGATION_ENABLED,true);
  lconf.setLong(YarnConfiguration.RM_NM_EXPIRY_INTERVAL_MS,6000l);
  lconf.setLong(YarnConfiguration.RM_DELAYED_DELEGATION_TOKEN_REMOVAL_INTERVAL_MS,1000l);
  DelegationTokenRenewer localDtr=createNewDelegationTokenRenewer(lconf,counter);
  RMContext mockContext=mock(RMContext.class);
  ClientRMService mockClientRMService=mock(ClientRMService.class);
  when(mockContext.getClientRMService()).thenReturn(mockClientRMService);
  when(mockContext.getDelegationTokenRenewer()).thenReturn(localDtr);
  when(mockContext.getDispatcher()).thenReturn(dispatcher);
  InetSocketAddress sockAddr=InetSocketAddress.createUnresolved("localhost",1234);
  when(mockClientRMService.getBindAddress()).thenReturn(sockAddr);
  localDtr.setRMContext(mockContext);
  localDtr.init(lconf);
  localDtr.start();
  MyFS dfs=(MyFS)FileSystem.get(lconf);
  LOG.info("dfs=" + (Object)dfs.hashCode() + ";conf="+ lconf.hashCode());
  Credentials ts=new Credentials();
  MyToken token1=dfs.getDelegationToken("user1");
  String nn1=DelegationTokenRenewer.SCHEME + "://host1:0";
  ts.addToken(new Text(nn1),token1);
  ApplicationId applicationId_0=BuilderUtils.newApplicationId(0,0);
  localDtr.addApplicationAsync(applicationId_0,ts,true);
  waitForEventsToGetProcessed(localDtr);
  if (!eventQueue.isEmpty()) {
    Event evt=eventQueue.take();
    if (evt instanceof RMAppEvent) {
      Assert.assertEquals(((RMAppEvent)evt).getType(),RMAppEventType.START);
    }
 else {
      fail("RMAppEvent.START was expected!!");
    }
  }
  localDtr.applicationFinished(applicationId_0);
  waitForEventsToGetProcessed(localDtr);
  token1.renew(lconf);
  Thread.sleep(10000l);
  try {
    token1.renew(lconf);
    fail("Renewal of cancelled token should have failed");
  }
 catch (  InvalidToken ite) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesApps </h4><pre class="type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppStatistics() throws JSONException, Exception {
  try {
    rm.start();
    MockNM amNodeManager=rm.registerNode("127.0.0.1:1234",4096);
    Thread.sleep(1);
    RMApp app1=rm.submitApp(CONTAINER_MB,"",UserGroupInformation.getCurrentUser().getShortUserName(),null,false,null,2,null,"MAPREDUCE");
    amNodeManager.nodeHeartbeat(true);
    MockAM am=rm.sendAMLaunched(app1.getCurrentAppAttempt().getAppAttemptId());
    am.registerAppAttempt();
    am.unregisterAppAttempt();
    amNodeManager.nodeHeartbeat(app1.getCurrentAppAttempt().getAppAttemptId(),1,ContainerState.COMPLETE);
    rm.submitApp(CONTAINER_MB,"",UserGroupInformation.getCurrentUser().getShortUserName(),null,false,null,2,null,"MAPREDUCE");
    rm.submitApp(CONTAINER_MB,"",UserGroupInformation.getCurrentUser().getShortUserName(),null,false,null,2,null,"OTHER");
    WebResource r=resource();
    ClientResponse response=r.path("ws").path("v1").path("cluster").path("appstatistics").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    JSONObject json=response.getEntity(JSONObject.class);
    assertEquals("incorrect number of elements",1,json.length());
    JSONObject appsStatInfo=json.getJSONObject("appStatInfo");
    assertEquals("incorrect number of elements",1,appsStatInfo.length());
    JSONArray statItems=appsStatInfo.getJSONArray("statItem");
    assertEquals("incorrect number of elements",YarnApplicationState.values().length,statItems.length());
    for (int i=0; i < YarnApplicationState.values().length; ++i) {
      assertEquals("*",statItems.getJSONObject(0).getString("type"));
      if (statItems.getJSONObject(0).getString("state").equals("ACCEPTED")) {
        assertEquals("2",statItems.getJSONObject(0).getString("count"));
      }
 else       if (statItems.getJSONObject(0).getString("state").equals("FINISHED")) {
        assertEquals("1",statItems.getJSONObject(0).getString("count"));
      }
 else {
        assertEquals("0",statItems.getJSONObject(0).getString("count"));
      }
    }
    r=resource();
    response=r.path("ws").path("v1").path("cluster").path("appstatistics").queryParam("states",YarnApplicationState.ACCEPTED.toString()).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    json=response.getEntity(JSONObject.class);
    assertEquals("incorrect number of elements",1,json.length());
    appsStatInfo=json.getJSONObject("appStatInfo");
    assertEquals("incorrect number of elements",1,appsStatInfo.length());
    statItems=appsStatInfo.getJSONArray("statItem");
    assertEquals("incorrect number of elements",1,statItems.length());
    assertEquals("ACCEPTED",statItems.getJSONObject(0).getString("state"));
    assertEquals("*",statItems.getJSONObject(0).getString("type"));
    assertEquals("2",statItems.getJSONObject(0).getString("count"));
    r=resource();
    response=r.path("ws").path("v1").path("cluster").path("appstatistics").queryParam("applicationTypes","MAPREDUCE").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    json=response.getEntity(JSONObject.class);
    assertEquals("incorrect number of elements",1,json.length());
    appsStatInfo=json.getJSONObject("appStatInfo");
    assertEquals("incorrect number of elements",1,appsStatInfo.length());
    statItems=appsStatInfo.getJSONArray("statItem");
    assertEquals("incorrect number of elements",YarnApplicationState.values().length,statItems.length());
    for (int i=0; i < YarnApplicationState.values().length; ++i) {
      assertEquals("mapreduce",statItems.getJSONObject(0).getString("type"));
      if (statItems.getJSONObject(0).getString("state").equals("ACCEPTED")) {
        assertEquals("1",statItems.getJSONObject(0).getString("count"));
      }
 else       if (statItems.getJSONObject(0).getString("state").equals("FINISHED")) {
        assertEquals("1",statItems.getJSONObject(0).getString("count"));
      }
 else {
        assertEquals("0",statItems.getJSONObject(0).getString("count"));
      }
    }
    r=resource();
    response=r.path("ws").path("v1").path("cluster").path("appstatistics").queryParam("applicationTypes","MAPREDUCE,OTHER").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(Status.BAD_REQUEST,response.getClientResponseStatus());
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    json=response.getEntity(JSONObject.class);
    assertEquals("incorrect number of elements",1,json.length());
    JSONObject exception=json.getJSONObject("RemoteException");
    assertEquals("incorrect number of elements",3,exception.length());
    String message=exception.getString("message");
    String type=exception.getString("exception");
    String className=exception.getString("javaClassName");
    WebServicesTestUtils.checkStringContains("exception message","we temporarily support at most one applicationType",message);
    WebServicesTestUtils.checkStringEqual("exception type","BadRequestException",type);
    WebServicesTestUtils.checkStringEqual("exception className","org.apache.hadoop.yarn.webapp.BadRequestException",className);
    r=resource();
    response=r.path("ws").path("v1").path("cluster").path("appstatistics").queryParam("states",YarnApplicationState.FINISHED.toString() + "," + YarnApplicationState.ACCEPTED.toString()).queryParam("applicationTypes","MAPREDUCE").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    json=response.getEntity(JSONObject.class);
    assertEquals("incorrect number of elements",1,json.length());
    appsStatInfo=json.getJSONObject("appStatInfo");
    assertEquals("incorrect number of elements",1,appsStatInfo.length());
    statItems=appsStatInfo.getJSONArray("statItem");
    assertEquals("incorrect number of elements",2,statItems.length());
    JSONObject statItem1=statItems.getJSONObject(0);
    JSONObject statItem2=statItems.getJSONObject(1);
    assertTrue((statItem1.getString("state").equals("ACCEPTED") && statItem2.getString("state").equals("FINISHED")) || (statItem2.getString("state").equals("ACCEPTED") && statItem1.getString("state").equals("FINISHED")));
    assertEquals("mapreduce",statItem1.getString("type"));
    assertEquals("1",statItem1.getString("count"));
    assertEquals("mapreduce",statItem2.getString("type"));
    assertEquals("1",statItem2.getString("count"));
    r=resource();
    response=r.path("ws").path("v1").path("cluster").path("appstatistics").queryParam("states","wrong_state").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(Status.BAD_REQUEST,response.getClientResponseStatus());
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    json=response.getEntity(JSONObject.class);
    assertEquals("incorrect number of elements",1,json.length());
    exception=json.getJSONObject("RemoteException");
    assertEquals("incorrect number of elements",3,exception.length());
    message=exception.getString("message");
    type=exception.getString("exception");
    className=exception.getString("javaClassName");
    WebServicesTestUtils.checkStringContains("exception message","Invalid application-state wrong_state",message);
    WebServicesTestUtils.checkStringEqual("exception type","BadRequestException",type);
    WebServicesTestUtils.checkStringEqual("exception className","org.apache.hadoop.yarn.webapp.BadRequestException",className);
  }
  finally {
    rm.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesAppsModification </h4><pre class="type-9 type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleAppKillInvalidState() throws Exception {
  rm.start();
  MockNM amNodeManager=rm.registerNode("127.0.0.1:1234",2048);
  String[] mediaTypes={MediaType.APPLICATION_JSON,MediaType.APPLICATION_XML};
  MediaType[] contentTypes={MediaType.APPLICATION_JSON_TYPE,MediaType.APPLICATION_XML_TYPE};
  String[] targetStates={YarnApplicationState.FINISHED.toString(),"blah"};
  for (  String mediaType : mediaTypes) {
    for (    MediaType contentType : contentTypes) {
      for (      String targetStateString : targetStates) {
        RMApp app=rm.submitApp(CONTAINER_MB,"",webserviceUserName);
        amNodeManager.nodeHeartbeat(true);
        ClientResponse response;
        AppState targetState=new AppState(targetStateString);
        Object entity;
        if (contentType == MediaType.APPLICATION_JSON_TYPE) {
          entity=appStateToJSON(targetState);
        }
 else {
          entity=targetState;
        }
        response=this.constructWebResource("apps",app.getApplicationId().toString(),"state").entity(entity,contentType).accept(mediaType).put(ClientResponse.class);
        if (!isAuthenticationEnabled()) {
          assertEquals(Status.UNAUTHORIZED,response.getClientResponseStatus());
          continue;
        }
        assertEquals(Status.BAD_REQUEST,response.getClientResponseStatus());
      }
    }
  }
  rm.stop();
  return;
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=90000) public void testSingleAppKill() throws Exception {
  rm.start();
  MockNM amNodeManager=rm.registerNode("127.0.0.1:1234",2048);
  String[] mediaTypes={MediaType.APPLICATION_JSON,MediaType.APPLICATION_XML};
  MediaType[] contentTypes={MediaType.APPLICATION_JSON_TYPE,MediaType.APPLICATION_XML_TYPE};
  for (  String mediaType : mediaTypes) {
    for (    MediaType contentType : contentTypes) {
      RMApp app=rm.submitApp(CONTAINER_MB,"",webserviceUserName);
      amNodeManager.nodeHeartbeat(true);
      ClientResponse response=this.constructWebResource("apps",app.getApplicationId().toString(),"state").accept(mediaType).get(ClientResponse.class);
      AppState targetState=new AppState(YarnApplicationState.KILLED.toString());
      Object entity;
      if (contentType == MediaType.APPLICATION_JSON_TYPE) {
        entity=appStateToJSON(targetState);
      }
 else {
        entity=targetState;
      }
      response=this.constructWebResource("apps",app.getApplicationId().toString(),"state").entity(entity,contentType).accept(mediaType).put(ClientResponse.class);
      if (!isAuthenticationEnabled()) {
        assertEquals(Status.UNAUTHORIZED,response.getClientResponseStatus());
        continue;
      }
      assertEquals(Status.ACCEPTED,response.getClientResponseStatus());
      if (mediaType == MediaType.APPLICATION_JSON) {
        verifyAppStateJson(response,RMAppState.KILLING,RMAppState.ACCEPTED);
      }
 else {
        verifyAppStateXML(response,RMAppState.KILLING,RMAppState.ACCEPTED);
      }
      String locationHeaderValue=response.getHeaders().getFirst(HttpHeaders.LOCATION);
      Client c=Client.create();
      WebResource tmp=c.resource(locationHeaderValue);
      if (isAuthenticationEnabled()) {
        tmp=tmp.queryParam("user.name",webserviceUserName);
      }
      response=tmp.get(ClientResponse.class);
      assertEquals(Status.OK,response.getClientResponseStatus());
      assertTrue(locationHeaderValue.endsWith("/ws/v1/cluster/apps/" + app.getApplicationId().toString() + "/state"));
      while (true) {
        Thread.sleep(100);
        response=this.constructWebResource("apps",app.getApplicationId().toString(),"state").accept(mediaType).entity(entity,contentType).put(ClientResponse.class);
        assertTrue((response.getClientResponseStatus() == Status.ACCEPTED) || (response.getClientResponseStatus() == Status.OK));
        if (response.getClientResponseStatus() == Status.OK) {
          assertEquals(RMAppState.KILLED,app.getState());
          if (mediaType == MediaType.APPLICATION_JSON) {
            verifyAppStateJson(response,RMAppState.KILLED);
          }
 else {
            verifyAppStateXML(response,RMAppState.KILLED);
          }
          break;
        }
      }
    }
  }
  rm.stop();
  return;
}

</code></pre>

<br>
<pre class="type-9 type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleAppKillInvalidId() throws Exception {
  rm.start();
  MockNM amNodeManager=rm.registerNode("127.0.0.1:1234",2048);
  amNodeManager.nodeHeartbeat(true);
  String[] testAppIds={"application_1391705042196_0001","random_string"};
  for (  String testAppId : testAppIds) {
    AppState info=new AppState("KILLED");
    ClientResponse response=this.constructWebResource("apps",testAppId,"state").accept(MediaType.APPLICATION_XML).entity(info,MediaType.APPLICATION_XML).put(ClientResponse.class);
    if (!isAuthenticationEnabled()) {
      assertEquals(Status.UNAUTHORIZED,response.getClientResponseStatus());
      continue;
    }
    assertEquals(Status.NOT_FOUND,response.getClientResponseStatus());
  }
  rm.stop();
  return;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.webapp.TestRMWebServicesCapacitySched </h4><pre class="type-9 type-13 type-11 type-7 type-10 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test per user resources and resourcesUsed elements in the web services XML
 * @throws Exception
 */
@Test public void testPerUserResourcesXML() throws Exception {
  rm.start();
  try {
    rm.submitApp(10,"app1","user1",null,"b1");
    rm.submitApp(20,"app2","user2",null,"b1");
    WebResource r=resource();
    ClientResponse response=r.path("ws/v1/cluster/scheduler").accept(MediaType.APPLICATION_XML).get(ClientResponse.class);
    assertEquals(MediaType.APPLICATION_XML_TYPE,response.getType());
    String xml=response.getEntity(String.class);
    DocumentBuilder db=DocumentBuilderFactory.newInstance().newDocumentBuilder();
    InputSource is=new InputSource();
    is.setCharacterStream(new StringReader(xml));
    Document dom=db.parse(is);
    NodeList allUsers=dom.getElementsByTagName("users");
    for (int i=0; i < allUsers.getLength(); ++i) {
      Node perUserResources=allUsers.item(i);
      String queueName=getChildNodeByName(perUserResources.getParentNode(),"queueName").getTextContent();
      if (queueName.equals("b1")) {
        assertEquals(2,perUserResources.getChildNodes().getLength());
        NodeList users=perUserResources.getChildNodes();
        for (int j=0; j < users.getLength(); ++j) {
          Node user=users.item(j);
          String username=getChildNodeByName(user,"username").getTextContent();
          assertTrue(username.equals("user1") || username.equals("user2"));
          Integer.parseInt(getChildNodeByName(getChildNodeByName(user,"resourcesUsed"),"memory").getTextContent());
          Integer.parseInt(getChildNodeByName(user,"numActiveApplications").getTextContent());
          Integer.parseInt(getChildNodeByName(user,"numPendingApplications").getTextContent());
        }
      }
 else {
        assertEquals(0,perUserResources.getChildNodes().getLength());
      }
    }
    NodeList allResourcesUsed=dom.getElementsByTagName("resourcesUsed");
    for (int i=0; i < allResourcesUsed.getLength(); ++i) {
      Node resourcesUsed=allResourcesUsed.item(i);
      Integer.parseInt(getChildNodeByName(resourcesUsed,"memory").getTextContent());
      Integer.parseInt(getChildNodeByName(resourcesUsed,"vCores").getTextContent());
    }
  }
  finally {
    rm.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.webproxy.TestWebAppProxyServer </h4><pre class="type-11 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStart(){
  assertEquals(STATE.INITED,webAppProxy.getServiceState());
  webAppProxy.start();
  for (  Service service : webAppProxy.getServices()) {
    if (service instanceof WebAppProxy) {
      assertEquals(((WebAppProxy)service).getBindAddress(),proxyAddress);
    }
  }
  assertEquals(STATE.STARTED,webAppProxy.getServiceState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.sls.TestSLSRunner </h4><pre class="type-13 type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test @SuppressWarnings("all") public void testSimulatorRunning() throws Exception {
  File tempDir=new File("target",UUID.randomUUID().toString());
  final List<Throwable> exceptionList=Collections.synchronizedList(new ArrayList<Throwable>());
  Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler(){
    @Override public void uncaughtException(    Thread t,    Throwable e){
      exceptionList.add(e);
    }
  }
);
  File slsOutputDir=new File(tempDir.getAbsolutePath() + "/slsoutput/");
  String args[]=new String[]{"-inputrumen","src/main/data/2jobs2min-rumen-jh.json","-output",slsOutputDir.getAbsolutePath()};
  SLSRunner.main(args);
  int count=20;
  while (count >= 0) {
    Thread.sleep(1000);
    if (!exceptionList.isEmpty()) {
      SLSRunner.getRunner().stop();
      Assert.fail("TestSLSRunner catched exception from child thread " + "(TaskRunner.Task): " + exceptionList.get(0).getMessage());
      break;
    }
    count--;
  }
  SLSRunner.getRunner().stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.util.TestProcfsBasedProcessTree </h4><pre class="type-9 type-13 type-11 type-2 type-7 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testProcessTree() throws Exception {
  try {
    Assert.assertTrue(ProcfsBasedProcessTree.isAvailable());
  }
 catch (  Exception e) {
    LOG.info(StringUtils.stringifyException(e));
    Assert.assertTrue("ProcfsBaseProcessTree should be available on Linux",false);
    return;
  }
  Random rm=new Random();
  File tempFile=new File(TEST_ROOT_DIR,getClass().getName() + "_shellScript_" + rm.nextInt()+ ".sh");
  tempFile.deleteOnExit();
  shellScript=TEST_ROOT_DIR + File.separator + tempFile.getName();
  tempFile=new File(TEST_ROOT_DIR,getClass().getName() + "_pidFile_" + rm.nextInt()+ ".pid");
  tempFile.deleteOnExit();
  pidFile=TEST_ROOT_DIR + File.separator + tempFile.getName();
  lowestDescendant=TEST_ROOT_DIR + File.separator + "lowestDescendantPidFile";
  try {
    FileWriter fWriter=new FileWriter(shellScript);
    fWriter.write("# rogue task\n" + "sleep 1\n" + "echo hello\n"+ "if [ $1 -ne 0 ]\n"+ "then\n"+ " sh " + shellScript + " $(($1-1))\n"+ "else\n"+ " echo $$ > "+ lowestDescendant+ "\n"+ " while true\n do\n"+ "  sleep 5\n"+ " done\n"+ "fi");
    fWriter.close();
  }
 catch (  IOException ioe) {
    LOG.info("Error: " + ioe);
    return;
  }
  Thread t=new RogueTaskThread();
  t.start();
  String pid=getRogueTaskPID();
  LOG.info("Root process pid: " + pid);
  ProcfsBasedProcessTree p=createProcessTree(pid);
  p.updateProcessTree();
  LOG.info("ProcessTree: " + p.toString());
  File leaf=new File(lowestDescendant);
  while (!leaf.exists()) {
    try {
      Thread.sleep(500);
    }
 catch (    InterruptedException ie) {
      break;
    }
  }
  p.updateProcessTree();
  LOG.info("ProcessTree: " + p.toString());
  String processTreeDump=p.getProcessTreeDump();
  destroyProcessTree(pid);
  boolean isAlive=true;
  for (int tries=100; tries > 0; tries--) {
    if (isSetsidAvailable()) {
      isAlive=isAnyProcessInTreeAlive(p);
    }
 else {
      isAlive=isAlive(pid);
    }
    if (!isAlive) {
      break;
    }
    Thread.sleep(100);
  }
  if (isAlive) {
    fail("ProcessTree shouldn't be alive");
  }
  LOG.info("Process-tree dump follows: \n" + processTreeDump);
  Assert.assertTrue("Process-tree dump doesn't start with a proper header",processTreeDump.startsWith("\t|- PID PPID PGRPID SESSID CMD_NAME " + "USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) " + "RSSMEM_USAGE(PAGES) FULL_CMD_LINE\n"));
  for (int i=N; i >= 0; i--) {
    String cmdLineDump="\\|- [0-9]+ [0-9]+ [0-9]+ [0-9]+ \\(sh\\)" + " [0-9]+ [0-9]+ [0-9]+ [0-9]+ sh " + shellScript + " "+ i;
    Pattern pat=Pattern.compile(cmdLineDump);
    Matcher mat=pat.matcher(processTreeDump);
    Assert.assertTrue("Process-tree dump doesn't contain the cmdLineDump of " + i + "th process!",mat.find());
  }
  try {
    t.join(2000);
    LOG.info("RogueTaskThread successfully joined.");
  }
 catch (  InterruptedException ie) {
    LOG.info("Interrupted while joining RogueTaskThread.");
  }
  p.updateProcessTree();
  Assert.assertFalse("ProcessTree must have been gone",isAlive(pid));
  Assert.assertTrue("Cumulative vmem for the gone-process is " + p.getCumulativeVmem() + " . It should be zero.",p.getCumulativeVmem() == 0);
  Assert.assertTrue(p.toString().equals("[ ]"));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
