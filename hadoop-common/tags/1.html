<h3><span class=" glyphicon glyphicon-tag"/>&nbspNullVerifier</h3><kbd>Verifies whether objects are null</kbd><br><br><br><h4 style="margin:0px">Class: TestFuseDFS </h4><pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test concurrent creation and access of the mount 
 */
@Test public void testMultipleThreads() throws IOException {
  ArrayList<Thread> threads=new ArrayList<Thread>();
  final AtomicReference<String> errorMessage=new AtomicReference<String>();
  for (int i=0; i < 10; i++) {
    Thread t=new Thread(){
      public void run(){
        try {
          File d=new File(mountPoint,"dir" + getId());
          execWaitRet("mkdir " + d.getAbsolutePath());
          for (int j=0; j < 10; j++) {
            File f=new File(d,"file" + j);
            final String contents="thread " + getId() + " "+ j;
            createFile(f,contents);
          }
          for (int j=0; j < 10; j++) {
            File f=new File(d,"file" + j);
            execWaitRet("cat " + f.getAbsolutePath());
            execWaitRet("rm " + f.getAbsolutePath());
          }
          execWaitRet("rmdir " + d.getAbsolutePath());
        }
 catch (        IOException ie) {
          errorMessage.set(String.format("Exception %s",StringUtils.stringifyException(ie)));
        }
      }
    }
;
    t.start();
    threads.add(t);
  }
  for (  Thread t : threads) {
    try {
      t.join();
    }
 catch (    InterruptedException ie) {
      fail("Thread interrupted: " + ie.getMessage());
    }
  }
  assertNull(errorMessage.get(),errorMessage.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.conf.TestConfigurationDeprecation </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test is to ensure the correctness of loading of keys with respect to
 * being marked as final and that are related to deprecation.
 * @throws IOException
 */
@Test public void testDeprecationForFinalParameters() throws IOException {
  addDeprecationToConfiguration();
  out=new BufferedWriter(new FileWriter(CONFIG));
  startConfig();
  appendProperty("A","a",true);
  appendProperty("D","d");
  appendProperty("E","e");
  appendProperty("H","h",true);
  appendProperty("J","",true);
  endConfig();
  Path fileResource=new Path(CONFIG);
  conf.addResource(fileResource);
  assertEquals("a",conf.get("A"));
  assertEquals("a",conf.get("B"));
  assertEquals("d",conf.get("C"));
  assertEquals("d",conf.get("D"));
  assertEquals("e",conf.get("E"));
  assertEquals("e",conf.get("F"));
  assertEquals("h",conf.get("G"));
  assertEquals("h",conf.get("H"));
  assertNull(conf.get("I"));
  assertNull(conf.get("J"));
  out=new BufferedWriter(new FileWriter(CONFIG2));
  startConfig();
  appendProperty("B","b");
  appendProperty("C","c",true);
  appendProperty("F","f",true);
  appendProperty("G","g");
  appendProperty("I","i");
  endConfig();
  Path fileResource1=new Path(CONFIG2);
  conf.addResource(fileResource1);
  assertEquals("a",conf.get("A"));
  assertEquals("a",conf.get("B"));
  assertEquals("c",conf.get("C"));
  assertEquals("c",conf.get("D"));
  assertEquals("f",conf.get("E"));
  assertEquals("f",conf.get("F"));
  assertEquals("h",conf.get("G"));
  assertEquals("h",conf.get("H"));
  assertNull(conf.get("I"));
  assertNull(conf.get("J"));
  out=new BufferedWriter(new FileWriter(CONFIG3));
  startConfig();
  appendProperty("A","a1");
  appendProperty("B","b1");
  appendProperty("C","c1");
  appendProperty("D","d1");
  appendProperty("E","e1");
  appendProperty("F","f1");
  appendProperty("G","g1");
  appendProperty("H","h1");
  appendProperty("I","i1");
  appendProperty("J","j1");
  endConfig();
  fileResource=new Path(CONFIG);
  conf.addResource(fileResource);
  assertEquals("a",conf.get("A"));
  assertEquals("a",conf.get("B"));
  assertEquals("c",conf.get("C"));
  assertEquals("c",conf.get("D"));
  assertEquals("f",conf.get("E"));
  assertEquals("f",conf.get("F"));
  assertEquals("h",conf.get("G"));
  assertEquals("h",conf.get("H"));
  assertNull(conf.get("I"));
  assertNull(conf.get("J"));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnsetWithDeprecatedKeys(){
  Configuration conf=new Configuration();
  Configuration.addDeprecation("dK",new String[]{"nK"});
  conf.set("nK","VV");
  assertEquals("VV",conf.get("dK"));
  assertEquals("VV",conf.get("nK"));
  conf.unset("dK");
  assertNull(conf.get("dK"));
  assertNull(conf.get("nK"));
  conf.set("nK","VV");
  assertEquals("VV",conf.get("dK"));
  assertEquals("VV",conf.get("nK"));
  conf.unset("nK");
  assertNull(conf.get("dK"));
  assertNull(conf.get("nK"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.conf.TestJobConf </h4><pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProfileParamsDefaults(){
  JobConf configuration=new JobConf();
  String result=configuration.getProfileParams();
  Assert.assertNotNull(result);
  Assert.assertTrue(result.contains("file=%s"));
  Assert.assertTrue(result.startsWith("-agentlib:hprof"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.contrib.bkjournal.TestBookKeeperConfiguration </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Verify the BKJM is creating the bookie available default path, when there
 * is no 'dfs.namenode.bookkeeperjournal.zk.availablebookies' configured
 */
@Test public void testDefaultBKAvailablePath() throws Exception {
  Configuration conf=new Configuration();
  Assert.assertNull(BK_ROOT_PATH + " already exists",zkc.exists(BK_ROOT_PATH,false));
  NamespaceInfo nsi=newNSInfo();
  bkjm=new BookKeeperJournalManager(conf,URI.create("bookkeeper://" + HOSTPORT + "/hdfsjournal-DefaultBKPath"),nsi);
  bkjm.format(nsi);
  Assert.assertNotNull("Bookie available path : " + BK_ROOT_PATH + " doesn't exists",zkc.exists(BK_ROOT_PATH,false));
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Verify the BKJM is creating the bookie available path configured in
 * 'dfs.namenode.bookkeeperjournal.zk.availablebookies'
 */
@Test public void testWithConfiguringBKAvailablePath() throws Exception {
  String bkAvailablePath=BookKeeperJournalManager.BKJM_ZK_LEDGERS_AVAILABLE_PATH_DEFAULT;
  Configuration conf=new Configuration();
  conf.setStrings(BookKeeperJournalManager.BKJM_ZK_LEDGERS_AVAILABLE_PATH,bkAvailablePath);
  Assert.assertNull(bkAvailablePath + " already exists",zkc.exists(bkAvailablePath,false));
  NamespaceInfo nsi=newNSInfo();
  bkjm=new BookKeeperJournalManager(conf,URI.create("bookkeeper://" + HOSTPORT + "/hdfsjournal-WithBKPath"),nsi);
  bkjm.format(nsi);
  Assert.assertNotNull("Bookie available path : " + bkAvailablePath + " doesn't exists",zkc.exists(bkAvailablePath,false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.contrib.bkjournal.TestBookKeeperJournalManager </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testSimpleRecovery() throws Exception {
  NamespaceInfo nsi=newNSInfo();
  BookKeeperJournalManager bkjm=new BookKeeperJournalManager(conf,BKJMUtil.createJournalURI("/hdfsjournal-simplerecovery"),nsi);
  bkjm.format(nsi);
  EditLogOutputStream out=bkjm.startLogSegment(1,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  ;
  for (long i=1; i <= 100; i++) {
    FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
    op.setTransactionId(i);
    out.write(op);
  }
  out.setReadyToFlush();
  out.flush();
  out.abort();
  out.close();
  assertNull(zkc.exists(bkjm.finalizedLedgerZNode(1,100),false));
  assertNotNull(zkc.exists(bkjm.inprogressZNode(1),false));
  bkjm.recoverUnfinalizedSegments();
  assertNotNull(zkc.exists(bkjm.finalizedLedgerZNode(1,100),false));
  assertNull(zkc.exists(bkjm.inprogressZNode(1),false));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNumberOfTransactionsWithInprogressAtEnd() throws Exception {
  NamespaceInfo nsi=newNSInfo();
  BookKeeperJournalManager bkjm=new BookKeeperJournalManager(conf,BKJMUtil.createJournalURI("/hdfsjournal-inprogressAtEnd"),nsi);
  bkjm.format(nsi);
  long txid=1;
  for (long i=0; i < 3; i++) {
    long start=txid;
    EditLogOutputStream out=bkjm.startLogSegment(start,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
    for (long j=1; j <= DEFAULT_SEGMENT_SIZE; j++) {
      FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
      op.setTransactionId(txid++);
      out.write(op);
    }
    out.close();
    bkjm.finalizeLogSegment(start,(txid - 1));
    assertNotNull(zkc.exists(bkjm.finalizedLedgerZNode(start,(txid - 1)),false));
  }
  long start=txid;
  EditLogOutputStream out=bkjm.startLogSegment(start,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  for (long j=1; j <= DEFAULT_SEGMENT_SIZE / 2; j++) {
    FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
    op.setTransactionId(txid++);
    out.write(op);
  }
  out.setReadyToFlush();
  out.flush();
  out.abort();
  out.close();
  long numTrans=bkjm.getNumberOfTransactions(1,true);
  assertEquals((txid - 1),numTrans);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNumberOfTransactionsWithGaps() throws Exception {
  NamespaceInfo nsi=newNSInfo();
  BookKeeperJournalManager bkjm=new BookKeeperJournalManager(conf,BKJMUtil.createJournalURI("/hdfsjournal-gaps"),nsi);
  bkjm.format(nsi);
  long txid=1;
  for (long i=0; i < 3; i++) {
    long start=txid;
    EditLogOutputStream out=bkjm.startLogSegment(start,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
    for (long j=1; j <= DEFAULT_SEGMENT_SIZE; j++) {
      FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
      op.setTransactionId(txid++);
      out.write(op);
    }
    out.close();
    bkjm.finalizeLogSegment(start,txid - 1);
    assertNotNull(zkc.exists(bkjm.finalizedLedgerZNode(start,txid - 1),false));
  }
  zkc.delete(bkjm.finalizedLedgerZNode(DEFAULT_SEGMENT_SIZE + 1,DEFAULT_SEGMENT_SIZE * 2),-1);
  long numTrans=bkjm.getNumberOfTransactions(1,true);
  assertEquals(DEFAULT_SEGMENT_SIZE,numTrans);
  try {
    numTrans=bkjm.getNumberOfTransactions(DEFAULT_SEGMENT_SIZE + 1,true);
    fail("Should have thrown corruption exception by this point");
  }
 catch (  JournalManager.CorruptionException ce) {
  }
  numTrans=bkjm.getNumberOfTransactions((DEFAULT_SEGMENT_SIZE * 2) + 1,true);
  assertEquals(DEFAULT_SEGMENT_SIZE,numTrans);
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testSimpleWrite() throws Exception {
  NamespaceInfo nsi=newNSInfo();
  BookKeeperJournalManager bkjm=new BookKeeperJournalManager(conf,BKJMUtil.createJournalURI("/hdfsjournal-simplewrite"),nsi);
  bkjm.format(nsi);
  EditLogOutputStream out=bkjm.startLogSegment(1,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  for (long i=1; i <= 100; i++) {
    FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
    op.setTransactionId(i);
    out.write(op);
  }
  out.close();
  bkjm.finalizeLogSegment(1,100);
  String zkpath=bkjm.finalizedLedgerZNode(1,100);
  assertNotNull(zkc.exists(zkpath,false));
  assertNull(zkc.exists(bkjm.inprogressZNode(1),false));
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test that if we fail between finalizing an inprogress and deleting the
 * corresponding inprogress znode.
 */
@Test public void testRefinalizeAlreadyFinalizedInprogress() throws Exception {
  URI uri=BKJMUtil.createJournalURI("/hdfsjournal-refinalizeInprogressLedger");
  NamespaceInfo nsi=newNSInfo();
  BookKeeperJournalManager bkjm=new BookKeeperJournalManager(conf,uri,nsi);
  bkjm.format(nsi);
  EditLogOutputStream out=bkjm.startLogSegment(1,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  ;
  for (long i=1; i <= 100; i++) {
    FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
    op.setTransactionId(i);
    out.write(op);
  }
  out.close();
  bkjm.close();
  String inprogressZNode=bkjm.inprogressZNode(1);
  String finalizedZNode=bkjm.finalizedLedgerZNode(1,100);
  assertNotNull("inprogress znode doesn't exist",zkc.exists(inprogressZNode,null));
  assertNull("finalized znode exists",zkc.exists(finalizedZNode,null));
  byte[] inprogressData=zkc.getData(inprogressZNode,false,null);
  bkjm=new BookKeeperJournalManager(conf,uri,nsi);
  bkjm.recoverUnfinalizedSegments();
  bkjm.close();
  assertNull("inprogress znode exists",zkc.exists(inprogressZNode,null));
  assertNotNull("finalized znode doesn't exist",zkc.exists(finalizedZNode,null));
  zkc.create(inprogressZNode,inprogressData,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  bkjm=new BookKeeperJournalManager(conf,uri,nsi);
  bkjm.recoverUnfinalizedSegments();
  bkjm.close();
}

</code></pre>

<br>
<pre class="type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a bkjm namespace, write a journal from txid 1, close stream.
 * Try to create a new journal from txid 1. Should throw an exception.
 */
@Test public void testWriteRestartFrom1() throws Exception {
  NamespaceInfo nsi=newNSInfo();
  BookKeeperJournalManager bkjm=new BookKeeperJournalManager(conf,BKJMUtil.createJournalURI("/hdfsjournal-restartFrom1"),nsi);
  bkjm.format(nsi);
  long txid=1;
  long start=txid;
  EditLogOutputStream out=bkjm.startLogSegment(txid,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  for (long j=1; j <= DEFAULT_SEGMENT_SIZE; j++) {
    FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
    op.setTransactionId(txid++);
    out.write(op);
  }
  out.close();
  bkjm.finalizeLogSegment(start,(txid - 1));
  txid=1;
  try {
    out=bkjm.startLogSegment(txid,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
    fail("Shouldn't be able to start another journal from " + txid + " when one already exists");
  }
 catch (  Exception ioe) {
    LOG.info("Caught exception as expected",ioe);
  }
  txid=DEFAULT_SEGMENT_SIZE;
  try {
    out=bkjm.startLogSegment(txid,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
    fail("Shouldn't be able to start another journal from " + txid + " when one already exists");
  }
 catch (  IOException ioe) {
    LOG.info("Caught exception as expected",ioe);
  }
  txid=DEFAULT_SEGMENT_SIZE + 1;
  start=txid;
  out=bkjm.startLogSegment(start,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  assertNotNull(out);
  for (long j=1; j <= DEFAULT_SEGMENT_SIZE; j++) {
    FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
    op.setTransactionId(txid++);
    out.write(op);
  }
  out.close();
  bkjm.finalizeLogSegment(start,(txid - 1));
  txid=DEFAULT_SEGMENT_SIZE * 4;
  out=bkjm.startLogSegment(txid,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  assertNotNull(out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.crypto.key.TestKeyProvider </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetadata() throws Exception {
  DateFormat format=new SimpleDateFormat("y/m/d");
  Date date=format.parse("2013/12/25");
  KeyProvider.Metadata meta=new KeyProvider.Metadata("myCipher",100,null,null,date,123);
  assertEquals("myCipher",meta.getCipher());
  assertEquals(100,meta.getBitLength());
  assertNull(meta.getDescription());
  assertEquals(date,meta.getCreated());
  assertEquals(123,meta.getVersions());
  KeyProvider.Metadata second=new KeyProvider.Metadata(meta.serialize());
  assertEquals(meta.getCipher(),second.getCipher());
  assertEquals(meta.getBitLength(),second.getBitLength());
  assertNull(second.getDescription());
  assertTrue(second.getAttributes().isEmpty());
  assertEquals(meta.getCreated(),second.getCreated());
  assertEquals(meta.getVersions(),second.getVersions());
  int newVersion=second.addVersion();
  assertEquals(123,newVersion);
  assertEquals(124,second.getVersions());
  assertEquals(123,meta.getVersions());
  format=new SimpleDateFormat("y/m/d");
  date=format.parse("2013/12/25");
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.put("a","A");
  meta=new KeyProvider.Metadata("myCipher",100,"description",attributes,date,123);
  assertEquals("myCipher",meta.getCipher());
  assertEquals(100,meta.getBitLength());
  assertEquals("description",meta.getDescription());
  assertEquals(attributes,meta.getAttributes());
  assertEquals(date,meta.getCreated());
  assertEquals(123,meta.getVersions());
  second=new KeyProvider.Metadata(meta.serialize());
  assertEquals(meta.getCipher(),second.getCipher());
  assertEquals(meta.getBitLength(),second.getBitLength());
  assertEquals(meta.getDescription(),second.getDescription());
  assertEquals(meta.getAttributes(),second.getAttributes());
  assertEquals(meta.getCreated(),second.getCreated());
  assertEquals(meta.getVersions(),second.getVersions());
  newVersion=second.addVersion();
  assertEquals(123,newVersion);
  assertEquals(124,second.getVersions());
  assertEquals(123,meta.getVersions());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaterialGeneration() throws Exception {
  MyKeyProvider kp=new MyKeyProvider();
  KeyProvider.Options options=new KeyProvider.Options(new Configuration());
  options.setCipher(CIPHER);
  options.setBitLength(128);
  kp.createKey("hello",options);
  Assert.assertEquals(128,kp.size);
  Assert.assertEquals(CIPHER,kp.algorithm);
  Assert.assertNotNull(kp.material);
  kp=new MyKeyProvider();
  kp.rollNewVersion("hello");
  Assert.assertEquals(128,kp.size);
  Assert.assertEquals(CIPHER,kp.algorithm);
  Assert.assertNotNull(kp.material);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.crypto.key.TestKeyProviderCryptoExtension </h4><pre class="type-11 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenerateEncryptedKey() throws Exception {
  KeyProviderCryptoExtension.EncryptedKeyVersion ek1=kpExt.generateEncryptedKey(encryptionKey.getName());
  assertEquals("Version name of EEK should be EEK",KeyProviderCryptoExtension.EEK,ek1.getEncryptedKeyVersion().getVersionName());
  assertEquals("Name of EEK should be encryption key name",ENCRYPTION_KEY_NAME,ek1.getEncryptionKeyName());
  assertNotNull("Expected encrypted key material",ek1.getEncryptedKeyVersion().getMaterial());
  assertEquals("Length of encryption key material and EEK material should " + "be the same",encryptionKey.getMaterial().length,ek1.getEncryptedKeyVersion().getMaterial().length);
  KeyVersion k1=kpExt.decryptEncryptedKey(ek1);
  assertEquals(KeyProviderCryptoExtension.EK,k1.getVersionName());
  assertEquals(encryptionKey.getMaterial().length,k1.getMaterial().length);
  if (Arrays.equals(k1.getMaterial(),encryptionKey.getMaterial())) {
    fail("Encrypted key material should not equal encryption key material");
  }
  if (Arrays.equals(ek1.getEncryptedKeyVersion().getMaterial(),encryptionKey.getMaterial())) {
    fail("Encrypted key material should not equal decrypted key material");
  }
  KeyVersion k1a=kpExt.decryptEncryptedKey(ek1);
  assertArrayEquals(k1.getMaterial(),k1a.getMaterial());
  KeyProviderCryptoExtension.EncryptedKeyVersion ek2=kpExt.generateEncryptedKey(encryptionKey.getName());
  KeyVersion k2=kpExt.decryptEncryptedKey(ek2);
  if (Arrays.equals(k1.getMaterial(),k2.getMaterial())) {
    fail("Generated EEKs should have different material!");
  }
  if (Arrays.equals(ek1.getEncryptedKeyIv(),ek2.getEncryptedKeyIv())) {
    fail("Generated EEKs should have different IVs!");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.crypto.key.TestKeyProviderDelegationTokenExtension </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateExtension() throws Exception {
  Configuration conf=new Configuration();
  Credentials credentials=new Credentials();
  KeyProvider kp=new UserProvider.Factory().createProvider(new URI("user:///"),conf);
  KeyProviderDelegationTokenExtension kpDTE1=KeyProviderDelegationTokenExtension.createKeyProviderDelegationTokenExtension(kp);
  Assert.assertNotNull(kpDTE1);
  Assert.assertNull(kpDTE1.addDelegationTokens("user",credentials));
  MockKeyProvider mock=mock(MockKeyProvider.class);
  when(mock.addDelegationTokens("renewer",credentials)).thenReturn(new Token<?>[]{new Token(null,null,new Text("kind"),new Text("service"))});
  KeyProviderDelegationTokenExtension kpDTE2=KeyProviderDelegationTokenExtension.createKeyProviderDelegationTokenExtension(mock);
  Token<?>[] tokens=kpDTE2.addDelegationTokens("renewer",credentials);
  Assert.assertNotNull(tokens);
  Assert.assertEquals("kind",tokens[0].getKind().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.crypto.key.TestKeyProviderFactory </h4><pre class="type-9 type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJksProviderPasswordViaConfig() throws Exception {
  Configuration conf=new Configuration();
  final String ourUrl=JavaKeyStoreProvider.SCHEME_NAME + "://file" + tmpDir+ "/test.jks";
  File file=new File(tmpDir,"test.jks");
  file.delete();
  try {
    conf.set(KeyProviderFactory.KEY_PROVIDER_PATH,ourUrl);
    conf.set(JavaKeyStoreProvider.KEYSTORE_PASSWORD_FILE_KEY,"javakeystoreprovider.password");
    KeyProvider provider=KeyProviderFactory.getProviders(conf).get(0);
    provider.createKey("key3",new byte[16],KeyProvider.options(conf));
    provider.flush();
  }
 catch (  Exception ex) {
    Assert.fail("could not create keystore with password file");
  }
  KeyProvider provider=KeyProviderFactory.getProviders(conf).get(0);
  Assert.assertNotNull(provider.getCurrentKey("key3"));
  try {
    conf.set(JavaKeyStoreProvider.KEYSTORE_PASSWORD_FILE_KEY,"bar");
    KeyProviderFactory.getProviders(conf).get(0);
    Assert.fail("using non existing password file, it should fail");
  }
 catch (  IOException ex) {
  }
  try {
    conf.set(JavaKeyStoreProvider.KEYSTORE_PASSWORD_FILE_KEY,"core-site.xml");
    KeyProviderFactory.getProviders(conf).get(0);
    Assert.fail("using different password file, it should fail");
  }
 catch (  IOException ex) {
  }
  try {
    conf.unset(JavaKeyStoreProvider.KEYSTORE_PASSWORD_FILE_KEY);
    KeyProviderFactory.getProviders(conf).get(0);
    Assert.fail("No password file property, env not set, it should fail");
  }
 catch (  IOException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.crypto.key.kms.server.TestKMS </h4><pre class="type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testACLs() throws Exception {
  Configuration conf=new Configuration();
  conf.set("hadoop.security.authentication","kerberos");
  UserGroupInformation.setConfiguration(conf);
  final File testDir=getTestDir();
  conf=createBaseKMSConf(testDir);
  conf.set("hadoop.kms.authentication.type","kerberos");
  conf.set("hadoop.kms.authentication.kerberos.keytab",keytab.getAbsolutePath());
  conf.set("hadoop.kms.authentication.kerberos.principal","HTTP/localhost");
  conf.set("hadoop.kms.authentication.kerberos.name.rules","DEFAULT");
  for (  KMSACLs.Type type : KMSACLs.Type.values()) {
    conf.set(type.getConfigKey(),type.toString());
  }
  conf.set(KMSACLs.Type.CREATE.getConfigKey(),KMSACLs.Type.CREATE.toString() + ",SET_KEY_MATERIAL");
  conf.set(KMSACLs.Type.ROLLOVER.getConfigKey(),KMSACLs.Type.ROLLOVER.toString() + ",SET_KEY_MATERIAL");
  writeConf(testDir,conf);
  runServer(null,null,testDir,new KMSCallable(){
    @Override public Void call() throws Exception {
      final Configuration conf=new Configuration();
      conf.setInt(KeyProvider.DEFAULT_BITLENGTH_NAME,128);
      final URI uri=createKMSUri(getKMSUrl());
      doAs("client",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            kp.createKey("k",new KeyProvider.Options(conf));
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          try {
            kp.createKey("k",new byte[16],new KeyProvider.Options(conf));
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          try {
            kp.rollNewVersion("k");
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          try {
            kp.rollNewVersion("k",new byte[16]);
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          try {
            kp.getKeys();
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          try {
            kp.getKeysMetadata("k");
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          try {
            kp.getKeyVersion("k@0");
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          try {
            kp.getCurrentKey("k");
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          try {
            kp.getMetadata("k");
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          try {
            kp.getKeyVersions("k");
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      doAs("CREATE",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            KeyProvider.KeyVersion kv=kp.createKey("k0",new KeyProvider.Options(conf));
            Assert.assertNull(kv.getMaterial());
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      doAs("DELETE",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            kp.deleteKey("k0");
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      doAs("SET_KEY_MATERIAL",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            KeyProvider.KeyVersion kv=kp.createKey("k1",new byte[16],new KeyProvider.Options(conf));
            Assert.assertNull(kv.getMaterial());
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      doAs("ROLLOVER",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            KeyProvider.KeyVersion kv=kp.rollNewVersion("k1");
            Assert.assertNull(kv.getMaterial());
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      doAs("SET_KEY_MATERIAL",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            KeyProvider.KeyVersion kv=kp.rollNewVersion("k1",new byte[16]);
            Assert.assertNull(kv.getMaterial());
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      final KeyVersion currKv=doAs("GET",new PrivilegedExceptionAction<KeyVersion>(){
        @Override public KeyVersion run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            kp.getKeyVersion("k1@0");
            KeyVersion kv=kp.getCurrentKey("k1");
            return kv;
          }
 catch (          Exception ex) {
            Assert.fail(ex.toString());
          }
          return null;
        }
      }
);
      final EncryptedKeyVersion encKv=doAs("GENERATE_EEK",new PrivilegedExceptionAction<EncryptedKeyVersion>(){
        @Override public EncryptedKeyVersion run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            KeyProviderCryptoExtension kpCE=KeyProviderCryptoExtension.createKeyProviderCryptoExtension(kp);
            EncryptedKeyVersion ek1=kpCE.generateEncryptedKey(currKv.getName());
            return ek1;
          }
 catch (          Exception ex) {
            Assert.fail(ex.toString());
          }
          return null;
        }
      }
);
      doAs("DECRYPT_EEK",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            KeyProviderCryptoExtension kpCE=KeyProviderCryptoExtension.createKeyProviderCryptoExtension(kp);
            kpCE.decryptEncryptedKey(encKv);
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      doAs("GET_KEYS",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            kp.getKeys();
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      doAs("GET_METADATA",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          KeyProvider kp=new KMSClientProvider(uri,conf);
          try {
            kp.getMetadata("k1");
            kp.getKeysMetadata("k1");
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      KMSWebApp.getACLs().stopReloader();
      Thread.sleep(10);
      conf.set(KMSACLs.Type.CREATE.getConfigKey(),"foo");
      writeConf(testDir,conf);
      Thread.sleep(1000);
      KMSWebApp.getACLs().run();
      doAs("CREATE",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          try {
            KeyProvider kp=new KMSClientProvider(uri,conf);
            KeyProvider.KeyVersion kv=kp.createKey("k2",new KeyProvider.Options(conf));
            Assert.fail();
          }
 catch (          AuthorizationException ex) {
          }
catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServicePrincipalACLs() throws Exception {
  Configuration conf=new Configuration();
  conf.set("hadoop.security.authentication","kerberos");
  UserGroupInformation.setConfiguration(conf);
  File testDir=getTestDir();
  conf=createBaseKMSConf(testDir);
  conf.set("hadoop.kms.authentication.type","kerberos");
  conf.set("hadoop.kms.authentication.kerberos.keytab",keytab.getAbsolutePath());
  conf.set("hadoop.kms.authentication.kerberos.principal","HTTP/localhost");
  conf.set("hadoop.kms.authentication.kerberos.name.rules","DEFAULT");
  for (  KMSACLs.Type type : KMSACLs.Type.values()) {
    conf.set(type.getConfigKey()," ");
  }
  conf.set(KMSACLs.Type.CREATE.getConfigKey(),"client");
  writeConf(testDir,conf);
  runServer(null,null,testDir,new KMSCallable(){
    @Override public Void call() throws Exception {
      final Configuration conf=new Configuration();
      conf.setInt(KeyProvider.DEFAULT_BITLENGTH_NAME,128);
      conf.setInt(KeyProvider.DEFAULT_BITLENGTH_NAME,64);
      final URI uri=createKMSUri(getKMSUrl());
      doAs("client",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          try {
            KeyProvider kp=new KMSClientProvider(uri,conf);
            KeyProvider.KeyVersion kv=kp.createKey("ck0",new KeyProvider.Options(conf));
            Assert.assertNull(kv.getMaterial());
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      doAs("client/host",new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          try {
            KeyProvider kp=new KMSClientProvider(uri,conf);
            KeyProvider.KeyVersion kv=kp.createKey("ck1",new KeyProvider.Options(conf));
            Assert.assertNull(kv.getMaterial());
          }
 catch (          Exception ex) {
            Assert.fail(ex.getMessage());
          }
          return null;
        }
      }
);
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProxyUser() throws Exception {
  Configuration conf=new Configuration();
  conf.set("hadoop.security.authentication","kerberos");
  UserGroupInformation.setConfiguration(conf);
  final File testDir=getTestDir();
  conf=createBaseKMSConf(testDir);
  conf.set("hadoop.kms.authentication.type","kerberos");
  conf.set("hadoop.kms.authentication.kerberos.keytab",keytab.getAbsolutePath());
  conf.set("hadoop.kms.authentication.kerberos.principal","HTTP/localhost");
  conf.set("hadoop.kms.authentication.kerberos.name.rules","DEFAULT");
  conf.set("hadoop.kms.proxyuser.client.users","foo");
  conf.set("hadoop.kms.proxyuser.client.hosts","*");
  writeConf(testDir,conf);
  runServer(null,null,testDir,new KMSCallable(){
    @Override public Void call() throws Exception {
      final Configuration conf=new Configuration();
      conf.setInt(KeyProvider.DEFAULT_BITLENGTH_NAME,64);
      final URI uri=createKMSUri(getKMSUrl());
      UserGroupInformation clientUgi=UserGroupInformation.loginUserFromKeytabAndReturnUGI("client",keytab.getAbsolutePath());
      clientUgi.doAs(new PrivilegedExceptionAction<Void>(){
        @Override public Void run() throws Exception {
          final KeyProvider kp=new KMSClientProvider(uri,conf);
          kp.createKey("kAA",new KeyProvider.Options(conf));
          UserGroupInformation fooUgi=UserGroupInformation.createRemoteUser("foo");
          fooUgi.doAs(new PrivilegedExceptionAction<Void>(){
            @Override public Void run() throws Exception {
              Assert.assertNotNull(kp.createKey("kBB",new KeyProvider.Options(conf)));
              return null;
            }
          }
);
          UserGroupInformation foo1Ugi=UserGroupInformation.createRemoteUser("foo1");
          foo1Ugi.doAs(new PrivilegedExceptionAction<Void>(){
            @Override public Void run() throws Exception {
              try {
                kp.createKey("kCC",new KeyProvider.Options(conf));
                Assert.fail();
              }
 catch (              AuthorizationException ex) {
              }
catch (              Exception ex) {
                Assert.fail(ex.getMessage());
              }
              return null;
            }
          }
);
          return null;
        }
      }
);
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKMSProvider() throws Exception {
  Configuration conf=new Configuration();
  conf.set("hadoop.security.authentication","kerberos");
  UserGroupInformation.setConfiguration(conf);
  File confDir=getTestDir();
  conf=createBaseKMSConf(confDir);
  writeConf(confDir,conf);
  runServer(null,null,confDir,new KMSCallable(){
    @Override public Void call() throws Exception {
      Date started=new Date();
      Configuration conf=new Configuration();
      URI uri=createKMSUri(getKMSUrl());
      KeyProvider kp=new KMSClientProvider(uri,conf);
      Assert.assertTrue(kp.getKeys().isEmpty());
      Assert.assertEquals(0,kp.getKeysMetadata().length);
      KeyProvider.Options options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      options.setDescription("l1");
      KeyProvider.KeyVersion kv0=kp.createKey("k1",options);
      Assert.assertNotNull(kv0);
      Assert.assertNotNull(kv0.getVersionName());
      Assert.assertNotNull(kv0.getMaterial());
      KeyProvider.KeyVersion kv1=kp.getKeyVersion(kv0.getVersionName());
      Assert.assertEquals(kv0.getVersionName(),kv1.getVersionName());
      Assert.assertNotNull(kv1.getMaterial());
      KeyProvider.KeyVersion cv1=kp.getCurrentKey("k1");
      Assert.assertEquals(kv0.getVersionName(),cv1.getVersionName());
      Assert.assertNotNull(cv1.getMaterial());
      KeyProvider.Metadata m1=kp.getMetadata("k1");
      Assert.assertEquals("AES/CTR/NoPadding",m1.getCipher());
      Assert.assertEquals("AES",m1.getAlgorithm());
      Assert.assertEquals(128,m1.getBitLength());
      Assert.assertEquals(1,m1.getVersions());
      Assert.assertNotNull(m1.getCreated());
      Assert.assertTrue(started.before(m1.getCreated()));
      List<KeyProvider.KeyVersion> lkv1=kp.getKeyVersions("k1");
      Assert.assertEquals(1,lkv1.size());
      Assert.assertEquals(kv0.getVersionName(),lkv1.get(0).getVersionName());
      Assert.assertNotNull(kv1.getMaterial());
      KeyProvider.KeyVersion kv2=kp.rollNewVersion("k1");
      Assert.assertNotSame(kv0.getVersionName(),kv2.getVersionName());
      Assert.assertNotNull(kv2.getMaterial());
      kv2=kp.getKeyVersion(kv2.getVersionName());
      boolean eq=true;
      for (int i=0; i < kv1.getMaterial().length; i++) {
        eq=eq && kv1.getMaterial()[i] == kv2.getMaterial()[i];
      }
      Assert.assertFalse(eq);
      KeyProvider.KeyVersion cv2=kp.getCurrentKey("k1");
      Assert.assertEquals(kv2.getVersionName(),cv2.getVersionName());
      Assert.assertNotNull(cv2.getMaterial());
      eq=true;
      for (int i=0; i < kv1.getMaterial().length; i++) {
        eq=eq && cv2.getMaterial()[i] == kv2.getMaterial()[i];
      }
      Assert.assertTrue(eq);
      List<KeyProvider.KeyVersion> lkv2=kp.getKeyVersions("k1");
      Assert.assertEquals(2,lkv2.size());
      Assert.assertEquals(kv1.getVersionName(),lkv2.get(0).getVersionName());
      Assert.assertNotNull(lkv2.get(0).getMaterial());
      Assert.assertEquals(kv2.getVersionName(),lkv2.get(1).getVersionName());
      Assert.assertNotNull(lkv2.get(1).getMaterial());
      KeyProvider.Metadata m2=kp.getMetadata("k1");
      Assert.assertEquals("AES/CTR/NoPadding",m2.getCipher());
      Assert.assertEquals("AES",m2.getAlgorithm());
      Assert.assertEquals(128,m2.getBitLength());
      Assert.assertEquals(2,m2.getVersions());
      Assert.assertNotNull(m2.getCreated());
      Assert.assertTrue(started.before(m2.getCreated()));
      List<String> ks1=kp.getKeys();
      Assert.assertEquals(1,ks1.size());
      Assert.assertEquals("k1",ks1.get(0));
      KeyProvider.Metadata[] kms1=kp.getKeysMetadata("k1");
      Assert.assertEquals(1,kms1.length);
      Assert.assertEquals("AES/CTR/NoPadding",kms1[0].getCipher());
      Assert.assertEquals("AES",kms1[0].getAlgorithm());
      Assert.assertEquals(128,kms1[0].getBitLength());
      Assert.assertEquals(2,kms1[0].getVersions());
      Assert.assertNotNull(kms1[0].getCreated());
      Assert.assertTrue(started.before(kms1[0].getCreated()));
      KeyProvider.KeyVersion kv=kp.getCurrentKey("k1");
      KeyProviderCryptoExtension kpExt=KeyProviderCryptoExtension.createKeyProviderCryptoExtension(kp);
      EncryptedKeyVersion ek1=kpExt.generateEncryptedKey(kv.getName());
      Assert.assertEquals(KeyProviderCryptoExtension.EEK,ek1.getEncryptedKeyVersion().getVersionName());
      Assert.assertNotNull(ek1.getEncryptedKeyVersion().getMaterial());
      Assert.assertEquals(kv.getMaterial().length,ek1.getEncryptedKeyVersion().getMaterial().length);
      KeyProvider.KeyVersion k1=kpExt.decryptEncryptedKey(ek1);
      Assert.assertEquals(KeyProviderCryptoExtension.EK,k1.getVersionName());
      KeyProvider.KeyVersion k1a=kpExt.decryptEncryptedKey(ek1);
      Assert.assertArrayEquals(k1.getMaterial(),k1a.getMaterial());
      Assert.assertEquals(kv.getMaterial().length,k1.getMaterial().length);
      EncryptedKeyVersion ek2=kpExt.generateEncryptedKey(kv.getName());
      KeyProvider.KeyVersion k2=kpExt.decryptEncryptedKey(ek2);
      boolean isEq=true;
      for (int i=0; isEq && i < ek2.getEncryptedKeyVersion().getMaterial().length; i++) {
        isEq=k2.getMaterial()[i] == k1.getMaterial()[i];
      }
      Assert.assertFalse(isEq);
      kp.deleteKey("k1");
      Assert.assertNull(kp.getKeyVersion("k1"));
      Assert.assertNull(kp.getKeyVersions("k1"));
      Assert.assertNull(kp.getMetadata("k1"));
      Assert.assertTrue(kp.getKeys().isEmpty());
      Assert.assertEquals(0,kp.getKeysMetadata().length);
      options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      kp.createKey("k2",options);
      KeyProvider.Metadata meta=kp.getMetadata("k2");
      Assert.assertNull(meta.getDescription());
      Assert.assertTrue(meta.getAttributes().isEmpty());
      options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      options.setDescription("d");
      kp.createKey("k3",options);
      meta=kp.getMetadata("k3");
      Assert.assertEquals("d",meta.getDescription());
      Assert.assertTrue(meta.getAttributes().isEmpty());
      Map<String,String> attributes=new HashMap<String,String>();
      attributes.put("a","A");
      options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      options.setAttributes(attributes);
      kp.createKey("k4",options);
      meta=kp.getMetadata("k4");
      Assert.assertNull(meta.getDescription());
      Assert.assertEquals(attributes,meta.getAttributes());
      options=new KeyProvider.Options(conf);
      options.setCipher("AES/CTR/NoPadding");
      options.setBitLength(128);
      options.setDescription("d");
      options.setAttributes(attributes);
      kp.createKey("k5",options);
      meta=kp.getMetadata("k5");
      Assert.assertEquals("d",meta.getDescription());
      Assert.assertEquals(attributes,meta.getAttributes());
      KeyProviderDelegationTokenExtension kpdte=KeyProviderDelegationTokenExtension.createKeyProviderDelegationTokenExtension(kp);
      Credentials credentials=new Credentials();
      kpdte.addDelegationTokens("foo",credentials);
      Assert.assertEquals(1,credentials.getAllTokens().size());
      InetSocketAddress kmsAddr=new InetSocketAddress(getKMSUrl().getHost(),getKMSUrl().getPort());
      Assert.assertEquals(new Text("kms-dt"),credentials.getToken(SecurityUtil.buildTokenService(kmsAddr)).getKind());
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.FSMainOperationsBaseTest </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetWrappedInputStream() throws IOException {
  Path src=getTestRootPath(fSys,"test/hadoop/file");
  createFile(src);
  FSDataInputStream in=fSys.open(src);
  InputStream is=in.getWrappedStream();
  in.close();
  Assert.assertNotNull(is);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlobStatusNonExistentFile() throws Exception {
  FileStatus[] paths=fSys.globStatus(getTestRootPath(fSys,"test/hadoopfsdf"));
  Assert.assertNull(paths);
  paths=fSys.globStatus(getTestRootPath(fSys,"test/hadoopfsdf/?"));
  Assert.assertEquals(0,paths.length);
  paths=fSys.globStatus(getTestRootPath(fSys,"test/hadoopfsdf/xyz*/?"));
  Assert.assertEquals(0,paths.length);
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsStatus() throws Exception {
  FsStatus fsStatus=fSys.getStatus(null);
  Assert.assertNotNull(fsStatus);
  Assert.assertTrue(fsStatus.getUsed() >= 0);
  Assert.assertTrue(fsStatus.getRemaining() >= 0);
  Assert.assertTrue(fsStatus.getCapacity() >= 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.FileContextMainOperationsBaseTest </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlobStatusNonExistentFile() throws Exception {
  FileStatus[] paths=fc.util().globStatus(getTestRootPath(fc,"test/hadoopfsdf"));
  Assert.assertNull(paths);
  paths=fc.util().globStatus(getTestRootPath(fc,"test/hadoopfsdf/?"));
  Assert.assertEquals(0,paths.length);
  paths=fc.util().globStatus(getTestRootPath(fc,"test/hadoopfsdf/xyz*/?"));
  Assert.assertEquals(0,paths.length);
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsStatus() throws Exception {
  FsStatus fsStatus=fc.getFsStatus(null);
  Assert.assertNotNull(fsStatus);
  Assert.assertTrue(fsStatus.getUsed() >= 0);
  Assert.assertTrue(fsStatus.getRemaining() >= 0);
  Assert.assertTrue(fsStatus.getCapacity() >= 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.FileContextURIBase </h4><pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileStatus() throws IOException {
  String fileName="file1";
  Path path2=fc2.makeQualified(new Path(BASE,fileName));
  createFile(fc1,path2);
  FsStatus fc2Status=fc2.getFsStatus(path2);
  Assert.assertNotNull(fc2Status);
  Assert.assertTrue(fc2Status.getCapacity() > 0);
  Assert.assertTrue(fc2Status.getRemaining() > 0);
  Assert.assertTrue(fc2Status.getUsed() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestChecksumFileSystem </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorruptedChecksum() throws Exception {
  Path testPath=new Path(TEST_ROOT_DIR,"testCorruptChecksum");
  Path checksumPath=localFs.getChecksumFile(testPath);
  FSDataOutputStream out=localFs.create(testPath,true);
  out.write("testing 1 2 3".getBytes());
  out.close();
  assertTrue(localFs.exists(checksumPath));
  FileStatus stat=localFs.getFileStatus(checksumPath);
  out=localFs.getRawFileSystem().create(testPath,true);
  out.write("testing stale checksum".getBytes());
  out.close();
  assertTrue(localFs.exists(checksumPath));
  assertEquals(stat,localFs.getFileStatus(checksumPath));
  Exception e=null;
  try {
    localFs.setVerifyChecksum(true);
    readFile(localFs,testPath,1024);
  }
 catch (  ChecksumException ce) {
    e=ce;
  }
 finally {
    assertNotNull("got checksum error",e);
  }
  localFs.setVerifyChecksum(false);
  String str=readFile(localFs,testPath,1024);
  assertEquals("testing stale checksum",str);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestEnhancedByteBufferAccess </h4><pre class="type-9 type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZeroCopyMmapCache() throws Exception {
  HdfsConfiguration conf=initZeroCopyTest();
  MiniDFSCluster cluster=null;
  final Path TEST_PATH=new Path("/a");
  final int TEST_FILE_LENGTH=16385;
  final int RANDOM_SEED=23453;
  final String CONTEXT="testZeroCopyMmapCacheContext";
  FSDataInputStream fsIn=null;
  ByteBuffer results[]={null,null,null,null};
  DistributedFileSystem fs=null;
  conf.set(DFSConfigKeys.DFS_CLIENT_CONTEXT,CONTEXT);
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
  cluster.waitActive();
  fs=cluster.getFileSystem();
  DFSTestUtil.createFile(fs,TEST_PATH,TEST_FILE_LENGTH,(short)1,RANDOM_SEED);
  try {
    DFSTestUtil.waitReplication(fs,TEST_PATH,(short)1);
  }
 catch (  InterruptedException e) {
    Assert.fail("unexpected InterruptedException during " + "waitReplication: " + e);
  }
catch (  TimeoutException e) {
    Assert.fail("unexpected TimeoutException during " + "waitReplication: " + e);
  }
  fsIn=fs.open(TEST_PATH);
  byte original[]=new byte[TEST_FILE_LENGTH];
  IOUtils.readFully(fsIn,original,0,TEST_FILE_LENGTH);
  fsIn.close();
  fsIn=fs.open(TEST_PATH);
  final ShortCircuitCache cache=ClientContext.get(CONTEXT,new DFSClient.Conf(conf)).getShortCircuitCache();
  cache.accept(new CountingVisitor(0,5,5,0));
  results[0]=fsIn.read(null,4096,EnumSet.of(ReadOption.SKIP_CHECKSUMS));
  fsIn.seek(0);
  results[1]=fsIn.read(null,4096,EnumSet.of(ReadOption.SKIP_CHECKSUMS));
  final ExtendedBlock firstBlock=DFSTestUtil.getFirstBlock(fs,TEST_PATH);
  cache.accept(new CacheVisitor(){
    @Override public void visit(    int numOutstandingMmaps,    Map<ExtendedBlockId,ShortCircuitReplica> replicas,    Map<ExtendedBlockId,InvalidToken> failedLoads,    Map<Long,ShortCircuitReplica> evictable,    Map<Long,ShortCircuitReplica> evictableMmapped){
      ShortCircuitReplica replica=replicas.get(new ExtendedBlockId(firstBlock.getBlockId(),firstBlock.getBlockPoolId()));
      Assert.assertNotNull(replica);
      Assert.assertTrue(replica.hasMmap());
      Assert.assertNull(replica.getEvictableTimeNs());
    }
  }
);
  results[2]=fsIn.read(null,4096,EnumSet.of(ReadOption.SKIP_CHECKSUMS));
  results[3]=fsIn.read(null,4096,EnumSet.of(ReadOption.SKIP_CHECKSUMS));
  cache.accept(new CountingVisitor(3,5,2,0));
  for (  ByteBuffer buffer : results) {
    if (buffer != null) {
      fsIn.releaseBuffer(buffer);
    }
  }
  fsIn.close();
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    public Boolean get(){
      final MutableBoolean finished=new MutableBoolean(false);
      cache.accept(new CacheVisitor(){
        @Override public void visit(        int numOutstandingMmaps,        Map<ExtendedBlockId,ShortCircuitReplica> replicas,        Map<ExtendedBlockId,InvalidToken> failedLoads,        Map<Long,ShortCircuitReplica> evictable,        Map<Long,ShortCircuitReplica> evictableMmapped){
          finished.setValue(evictableMmapped.isEmpty());
        }
      }
);
      return finished.booleanValue();
    }
  }
,10,60000);
  cache.accept(new CountingVisitor(0,-1,-1,-1));
  fs.close();
  cluster.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestFileSystemTokens </h4><pre class="type-7 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithChildTokensOneExists() throws Exception {
  Credentials credentials=new Credentials();
  Text service1=new Text("singleTokenFs1");
  Text service2=new Text("singleTokenFs2");
  Token<?> token=mock(Token.class);
  credentials.addToken(service2,token);
  MockFileSystem fs1=createFileSystemForServiceName(service1);
  MockFileSystem fs2=createFileSystemForServiceName(service2);
  MockFileSystem fs3=createFileSystemForServiceName(null);
  MockFileSystem multiFs=createFileSystemForServiceName(null,fs1,fs2,fs3);
  multiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(multiFs,false);
  verifyTokenFetch(fs1,true);
  verifyTokenFetch(fs2,false);
  verifyTokenFetch(fs3,false);
  assertEquals(2,credentials.numberOfTokens());
  assertNotNull(credentials.getToken(service1));
  assertSame(token,credentials.getToken(service2));
}

</code></pre>

<br>
<pre class="type-7 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithMyOwnExistsAndChildTokens() throws Exception {
  Credentials credentials=new Credentials();
  Text service1=new Text("singleTokenFs1");
  Text service2=new Text("singleTokenFs2");
  Text myService=new Text("multiTokenFs");
  Token<?> token=mock(Token.class);
  credentials.addToken(myService,token);
  MockFileSystem fs1=createFileSystemForServiceName(service1);
  MockFileSystem fs2=createFileSystemForServiceName(service2);
  MockFileSystem multiFs=createFileSystemForServiceName(myService,fs1,fs2);
  multiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(multiFs,false);
  verifyTokenFetch(fs1,true);
  verifyTokenFetch(fs2,true);
  assertEquals(3,credentials.numberOfTokens());
  assertSame(token,credentials.getToken(myService));
  assertNotNull(credentials.getToken(service1));
  assertNotNull(credentials.getToken(service2));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithToken() throws Exception {
  Text service=new Text("singleTokenFs");
  MockFileSystem fs=createFileSystemForServiceName(service);
  Credentials credentials=new Credentials();
  fs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(fs,true);
  assertEquals(1,credentials.numberOfTokens());
  assertNotNull(credentials.getToken(service));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithDuplicateChildren() throws Exception {
  Credentials credentials=new Credentials();
  Text service=new Text("singleTokenFs1");
  MockFileSystem fs=createFileSystemForServiceName(service);
  MockFileSystem multiFs=createFileSystemForServiceName(null,fs,new FilterFileSystem(fs));
  multiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(multiFs,false);
  verifyTokenFetch(fs,true);
  assertEquals(1,credentials.numberOfTokens());
  assertNotNull(credentials.getToken(service));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithChildTokens() throws Exception {
  Credentials credentials=new Credentials();
  Text service1=new Text("singleTokenFs1");
  Text service2=new Text("singleTokenFs2");
  MockFileSystem fs1=createFileSystemForServiceName(service1);
  MockFileSystem fs2=createFileSystemForServiceName(service2);
  MockFileSystem fs3=createFileSystemForServiceName(null);
  MockFileSystem multiFs=createFileSystemForServiceName(null,fs1,fs2,fs3);
  multiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(multiFs,false);
  verifyTokenFetch(fs1,true);
  verifyTokenFetch(fs2,true);
  verifyTokenFetch(fs3,false);
  assertEquals(2,credentials.numberOfTokens());
  assertNotNull(credentials.getToken(service1));
  assertNotNull(credentials.getToken(service2));
}

</code></pre>

<br>
<pre class="type-7 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithNestedDuplicatesChildren() throws Exception {
  Credentials credentials=new Credentials();
  Text service1=new Text("singleTokenFs1");
  Text service2=new Text("singleTokenFs2");
  Text service4=new Text("singleTokenFs4");
  Text multiService=new Text("multiTokenFs");
  Token<?> token2=mock(Token.class);
  credentials.addToken(service2,token2);
  MockFileSystem fs1=createFileSystemForServiceName(service1);
  MockFileSystem fs1B=createFileSystemForServiceName(service1);
  MockFileSystem fs2=createFileSystemForServiceName(service2);
  MockFileSystem fs3=createFileSystemForServiceName(null);
  MockFileSystem fs4=createFileSystemForServiceName(service4);
  MockFileSystem multiFs=createFileSystemForServiceName(multiService,fs1,fs1B,fs2,fs2,new FilterFileSystem(fs3),new FilterFileSystem(new FilterFileSystem(fs4)));
  MockFileSystem superMultiFs=createFileSystemForServiceName(null,fs1,fs1B,fs1,new FilterFileSystem(fs3),new FilterFileSystem(multiFs));
  superMultiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(superMultiFs,false);
  verifyTokenFetch(multiFs,true);
  verifyTokenFetch(fs1,true);
  verifyTokenFetch(fs2,false);
  verifyTokenFetch(fs3,false);
  verifyTokenFetch(fs4,true);
  assertEquals(4,credentials.numberOfTokens());
  assertNotNull(credentials.getToken(service1));
  assertNotNull(credentials.getToken(service2));
  assertSame(token2,credentials.getToken(service2));
  assertNotNull(credentials.getToken(multiService));
  assertNotNull(credentials.getToken(service4));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFsWithMyOwnAndChildTokens() throws Exception {
  Credentials credentials=new Credentials();
  Text service1=new Text("singleTokenFs1");
  Text service2=new Text("singleTokenFs2");
  Text myService=new Text("multiTokenFs");
  Token<?> token=mock(Token.class);
  credentials.addToken(service2,token);
  MockFileSystem fs1=createFileSystemForServiceName(service1);
  MockFileSystem fs2=createFileSystemForServiceName(service2);
  MockFileSystem multiFs=createFileSystemForServiceName(myService,fs1,fs2);
  multiFs.addDelegationTokens(renewer,credentials);
  verifyTokenFetch(multiFs,true);
  verifyTokenFetch(fs1,true);
  verifyTokenFetch(fs2,false);
  assertEquals(3,credentials.numberOfTokens());
  assertNotNull(credentials.getToken(myService));
  assertNotNull(credentials.getToken(service1));
  assertNotNull(credentials.getToken(service2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestFileUtil </h4><pre class="type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testCopyMergeSingleDirectory() throws IOException {
  setupDirs();
  boolean copyMergeResult=copyMerge("partitioned","tmp/merged");
  Assert.assertTrue("Expected successful copyMerge result.",copyMergeResult);
  File merged=new File(TEST_DIR,"tmp/merged");
  Assert.assertTrue("File tmp/merged must exist after copyMerge.",merged.exists());
  BufferedReader rdr=new BufferedReader(new FileReader(merged));
  try {
    Assert.assertEquals("Line 1 of merged file must contain \"foo\".","foo",rdr.readLine());
    Assert.assertEquals("Line 2 of merged file must contain \"bar\".","bar",rdr.readLine());
    Assert.assertNull("Expected end of file reading merged file.",rdr.readLine());
  }
  finally {
    rdr.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testStat2Paths1(){
  assertNull(FileUtil.stat2Paths(null));
  FileStatus[] fileStatuses=new FileStatus[0];
  Path[] paths=FileUtil.stat2Paths(fileStatuses);
  assertEquals(0,paths.length);
  Path path1=new Path("file://foo");
  Path path2=new Path("file://moo");
  fileStatuses=new FileStatus[]{new FileStatus(3,false,0,0,0,path1),new FileStatus(3,false,0,0,0,path2)};
  paths=FileUtil.stat2Paths(fileStatuses);
  assertEquals(2,paths.length);
  assertEquals(paths[0],path1);
  assertEquals(paths[1],path2);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that getDU is able to handle cycles caused due to symbolic links
 * and that directory sizes are not added to the final calculated size
 * @throws IOException
 */
@Test(timeout=30000) public void testGetDU() throws Exception {
  setupDirs();
  long du=FileUtil.getDU(TEST_DIR);
  final long expected=2 * (3 + System.getProperty("line.separator").length());
  Assert.assertEquals(expected,du);
  final File doesNotExist=new File(tmp,"QuickBrownFoxJumpsOverTheLazyDog");
  long duDoesNotExist=FileUtil.getDU(doesNotExist);
  assertEquals(0,duDoesNotExist);
  File notADirectory=new File(partitioned,"part-r-00000");
  long duNotADirectoryActual=FileUtil.getDU(notADirectory);
  long duNotADirectoryExpected=3 + System.getProperty("line.separator").length();
  assertEquals(duNotADirectoryExpected,duNotADirectoryActual);
  try {
    try {
      FileUtil.chmod(notADirectory.getAbsolutePath(),"0000");
    }
 catch (    InterruptedException ie) {
      assertNull(ie);
    }
    assertFalse(FileUtil.canRead(notADirectory));
    final long du3=FileUtil.getDU(partitioned);
    assertEquals(expected,du3);
    try {
      FileUtil.chmod(partitioned.getAbsolutePath(),"0000");
    }
 catch (    InterruptedException ie) {
      assertNull(ie);
    }
    assertFalse(FileUtil.canRead(partitioned));
    final long du4=FileUtil.getDU(partitioned);
    assertEquals(0,du4);
  }
  finally {
    FileUtil.chmod(partitioned.getAbsolutePath(),"0777",true);
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testCreateJarWithClassPath() throws Exception {
  Assert.assertFalse(tmp.exists());
  Assert.assertTrue(tmp.mkdirs());
  List<File> wildcardMatches=Arrays.asList(new File(tmp,"wildcard1.jar"),new File(tmp,"wildcard2.jar"),new File(tmp,"wildcard3.JAR"),new File(tmp,"wildcard4.JAR"));
  for (  File wildcardMatch : wildcardMatches) {
    Assert.assertTrue("failure creating file: " + wildcardMatch,wildcardMatch.createNewFile());
  }
  Assert.assertTrue(new File(tmp,"text.txt").createNewFile());
  Assert.assertTrue(new File(tmp,"executable.exe").createNewFile());
  Assert.assertTrue(new File(tmp,"README").createNewFile());
  String wildcardPath=tmp.getCanonicalPath() + File.separator + "*";
  String nonExistentSubdir=tmp.getCanonicalPath() + Path.SEPARATOR + "subdir"+ Path.SEPARATOR;
  List<String> classPaths=Arrays.asList("","cp1.jar","cp2.jar",wildcardPath,"cp3.jar",nonExistentSubdir);
  String inputClassPath=StringUtils.join(File.pathSeparator,classPaths);
  String classPathJar=FileUtil.createJarWithClassPath(inputClassPath,new Path(tmp.getCanonicalPath()),System.getenv());
  JarFile jarFile=null;
  try {
    jarFile=new JarFile(classPathJar);
    Manifest jarManifest=jarFile.getManifest();
    Assert.assertNotNull(jarManifest);
    Attributes mainAttributes=jarManifest.getMainAttributes();
    Assert.assertNotNull(mainAttributes);
    Assert.assertTrue(mainAttributes.containsKey(Attributes.Name.CLASS_PATH));
    String classPathAttr=mainAttributes.getValue(Attributes.Name.CLASS_PATH);
    Assert.assertNotNull(classPathAttr);
    List<String> expectedClassPaths=new ArrayList<String>();
    for (    String classPath : classPaths) {
      if (classPath.length() == 0) {
        continue;
      }
      if (wildcardPath.equals(classPath)) {
        for (        File wildcardMatch : wildcardMatches) {
          expectedClassPaths.add(wildcardMatch.toURI().toURL().toExternalForm());
        }
      }
 else {
        File fileCp=null;
        if (!new Path(classPath).isAbsolute()) {
          fileCp=new File(tmp,classPath);
        }
 else {
          fileCp=new File(classPath);
        }
        if (nonExistentSubdir.equals(classPath)) {
          expectedClassPaths.add(fileCp.toURI().toURL().toExternalForm() + Path.SEPARATOR);
        }
 else {
          expectedClassPaths.add(fileCp.toURI().toURL().toExternalForm());
        }
      }
    }
    List<String> actualClassPaths=Arrays.asList(classPathAttr.split(" "));
    Collections.sort(expectedClassPaths);
    Collections.sort(actualClassPaths);
    Assert.assertEquals(expectedClassPaths,actualClassPaths);
  }
  finally {
    if (jarFile != null) {
      try {
        jarFile.close();
      }
 catch (      IOException e) {
        LOG.warn("exception closing jarFile: " + classPathJar,e);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestGlobPaths </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testMultiGlob() throws IOException {
  FileStatus[] status;
  Path d1=new Path(USER_DIR,"dir1");
  Path d11=new Path(d1,"subdir1");
  Path d12=new Path(d1,"subdir2");
  Path f111=new Path(d11,"f1");
  fs.createNewFile(f111);
  Path f112=new Path(d11,"f2");
  fs.createNewFile(f112);
  Path f121=new Path(d12,"f1");
  fs.createNewFile(f121);
  Path d2=new Path(USER_DIR,"dir2");
  Path d21=new Path(d2,"subdir1");
  fs.mkdirs(d21);
  Path d22=new Path(d2,"subdir2");
  Path f221=new Path(d22,"f1");
  fs.createNewFile(f221);
  Path d3=new Path(USER_DIR,"dir3");
  Path f31=new Path(d3,"f1");
  fs.createNewFile(f31);
  Path d32=new Path(d3,"f2");
  fs.mkdirs(d32);
  Path f32=new Path(d3,"subdir2");
  fs.createNewFile(f32);
  Path d33=new Path(d3,"subdir3");
  Path f333=new Path(d33,"f3");
  fs.createNewFile(f333);
  Path d331=new Path(d33,"f1");
  Path f3311=new Path(d331,"f1");
  fs.createNewFile(f3311);
  Path d4=new Path(USER_DIR,"dir4");
  fs.mkdirs(d4);
  Path root=new Path(USER_DIR);
  status=fs.globStatus(root);
  checkStatus(status,root);
  status=fs.globStatus(new Path(USER_DIR,"x"));
  assertNull(status);
  status=fs.globStatus(new Path("x"));
  assertNull(status);
  status=fs.globStatus(new Path(USER_DIR,"x/x"));
  assertNull(status);
  status=fs.globStatus(new Path("x/x"));
  assertNull(status);
  status=fs.globStatus(new Path(USER_DIR,"*"));
  checkStatus(status,d1,d2,d3,d4);
  status=fs.globStatus(new Path("*"));
  checkStatus(status,d1,d2,d3,d4);
  status=fs.globStatus(new Path(USER_DIR,"*/x"));
  checkStatus(status);
  status=fs.globStatus(new Path("*/x"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"x/*"));
  checkStatus(status);
  status=fs.globStatus(new Path("x/*"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"x/x/x/*"));
  checkStatus(status);
  status=fs.globStatus(new Path("x/x/x/*"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"*/*"));
  checkStatus(status,d11,d12,d21,d22,f31,d32,f32,d33);
  status=fs.globStatus(new Path("*/*"));
  checkStatus(status,d11,d12,d21,d22,f31,d32,f32,d33);
  status=fs.globStatus(new Path(USER_DIR,"dir*/*"));
  checkStatus(status,d11,d12,d21,d22,f31,d32,f32,d33);
  status=fs.globStatus(new Path("dir*/*"));
  checkStatus(status,d11,d12,d21,d22,f31,d32,f32,d33);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*"));
  checkStatus(status,d11,d12,d21,d22,f32,d33);
  status=fs.globStatus(new Path("dir*/subdir*"));
  checkStatus(status,d11,d12,d21,d22,f32,d33);
  status=fs.globStatus(new Path(USER_DIR,"dir*/f*"));
  checkStatus(status,f31,d32);
  status=fs.globStatus(new Path("dir*/f*"));
  checkStatus(status,f31,d32);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1"));
  checkStatus(status,d11,d21);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/*"));
  checkStatus(status,f111,f112);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/*/*"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/x"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/x*"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir2"));
  checkStatus(status,d12,d22,f32);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir2/*"));
  checkStatus(status,f121,f221);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir2/*/*"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir3"));
  checkStatus(status,d33);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir3/*"));
  checkStatus(status,d331,f333);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir3/*/*"));
  checkStatus(status,f3311);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir3/*/*/*"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/f1"));
  checkStatus(status,f111);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/f1*"));
  checkStatus(status,f111);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/f1/*"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/f1*/*"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/f1"));
  checkStatus(status,f111,f121,f221,d331);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/f1*"));
  checkStatus(status,f111,f121,f221,d331);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/f1/*"));
  checkStatus(status,f3311);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/f1*/*"));
  checkStatus(status,f3311);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/f1*/*"));
  checkStatus(status,f3311);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/f1*/x"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/f1*/*/*"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*"));
  checkStatus(status,d11,d12,d21,d22,f32,d33);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/*"));
  checkStatus(status,f111,f112,f121,f221,d331,f333);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/f*"));
  checkStatus(status,f111,f112,f121,f221,d331,f333);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/f*/*"));
  checkStatus(status,f3311);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/*/f1"));
  checkStatus(status,f3311);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir*/*/*"));
  checkStatus(status,f3311);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/f3"));
  checkStatus(status);
  status=fs.globStatus(new Path(USER_DIR,"dir*/subdir1/f3*"));
  checkStatus(status);
  status=fs.globStatus(new Path("{x}"));
  checkStatus(status);
  status=fs.globStatus(new Path("{x,y}"));
  checkStatus(status);
  status=fs.globStatus(new Path("dir*/{x,y}"));
  checkStatus(status);
  status=fs.globStatus(new Path("dir*/{f1,y}"));
  checkStatus(status,f31);
  status=fs.globStatus(new Path("{x,y}"));
  checkStatus(status);
  status=fs.globStatus(new Path("/{x/x,y/y}"));
  checkStatus(status);
  status=fs.globStatus(new Path("{x/x,y/y}"));
  checkStatus(status);
  status=fs.globStatus(new Path(Path.CUR_DIR));
  checkStatus(status,new Path(USER_DIR));
  status=fs.globStatus(new Path(USER_DIR + "{/dir1}"));
  checkStatus(status,d1);
  status=fs.globStatus(new Path(USER_DIR + "{/dir*}"));
  checkStatus(status,d1,d2,d3,d4);
  status=fs.globStatus(new Path(Path.SEPARATOR),trueFilter);
  checkStatus(status,new Path(Path.SEPARATOR));
  status=fs.globStatus(new Path(Path.CUR_DIR),trueFilter);
  checkStatus(status,new Path(USER_DIR));
  status=fs.globStatus(d1,trueFilter);
  checkStatus(status,d1);
  status=fs.globStatus(new Path(USER_DIR),trueFilter);
  checkStatus(status,new Path(USER_DIR));
  status=fs.globStatus(new Path(USER_DIR,"*"),trueFilter);
  checkStatus(status,d1,d2,d3,d4);
  status=fs.globStatus(new Path("/x/*"),trueFilter);
  checkStatus(status);
  status=fs.globStatus(new Path("/x"),trueFilter);
  assertNull(status);
  status=fs.globStatus(new Path("/x/x"),trueFilter);
  assertNull(status);
  PathFilter falseFilter=new PathFilter(){
    @Override public boolean accept(    Path path){
      return false;
    }
  }
;
  status=fs.globStatus(new Path(Path.SEPARATOR),falseFilter);
  assertNull(status);
  status=fs.globStatus(new Path(Path.CUR_DIR),falseFilter);
  assertNull(status);
  status=fs.globStatus(new Path(USER_DIR),falseFilter);
  assertNull(status);
  status=fs.globStatus(new Path(USER_DIR,"*"),falseFilter);
  checkStatus(status);
  status=fs.globStatus(new Path("/x/*"),falseFilter);
  checkStatus(status);
  status=fs.globStatus(new Path("/x"),falseFilter);
  assertNull(status);
  status=fs.globStatus(new Path("/x/x"),falseFilter);
  assertNull(status);
  cleanupDFS();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestLocalFileSystem </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test(timeout=1000) public void testHasFileDescriptor() throws IOException {
  Path path=new Path(TEST_ROOT_DIR,"test-file");
  writeFile(fileSys,path,1);
  BufferedFSInputStream bis=null;
  try {
    bis=new BufferedFSInputStream(new RawLocalFileSystem().new LocalFSFileInputStream(path),1024);
    assertNotNull(bis.getFileDescriptor());
  }
  finally {
    IOUtils.cleanup(null,bis);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestUrlStreamHandler </h4><pre class="type-9 type-13 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test opening and reading from an InputStream through a hdfs:// URL.
 * <p>
 * First generate a file with some content through the FileSystem API, then
 * try to open and read the file through the URL stream API.
 * @throws IOException
 */
@Test public void testDfsUrls() throws IOException {
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
  FileSystem fs=cluster.getFileSystem();
  FsUrlStreamHandlerFactory factory=new org.apache.hadoop.fs.FsUrlStreamHandlerFactory();
  java.net.URL.setURLStreamHandlerFactory(factory);
  Path filePath=new Path("/thefile");
  try {
    byte[] fileContent=new byte[1024];
    for (int i=0; i < fileContent.length; ++i)     fileContent[i]=(byte)i;
    OutputStream os=fs.create(filePath);
    os.write(fileContent);
    os.close();
    URI uri=fs.getUri();
    URL fileURL=new URL(uri.getScheme(),uri.getHost(),uri.getPort(),filePath.toString());
    InputStream is=fileURL.openStream();
    assertNotNull(is);
    byte[] bytes=new byte[4096];
    assertEquals(1024,is.read(bytes));
    is.close();
    for (int i=0; i < fileContent.length; ++i)     assertEquals(fileContent[i],bytes[i]);
    fs.delete(filePath,false);
  }
  finally {
    fs.close();
    cluster.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test opening and reading from an InputStream through a file:// URL.
 * @throws IOException
 * @throws URISyntaxException
 */
@Test public void testFileUrls() throws IOException, URISyntaxException {
  Configuration conf=new HdfsConfiguration();
  if (!TEST_ROOT_DIR.exists()) {
    if (!TEST_ROOT_DIR.mkdirs())     throw new IOException("Cannot create temporary directory: " + TEST_ROOT_DIR);
  }
  File tmpFile=new File(TEST_ROOT_DIR,"thefile");
  URI uri=tmpFile.toURI();
  FileSystem fs=FileSystem.get(uri,conf);
  try {
    byte[] fileContent=new byte[1024];
    for (int i=0; i < fileContent.length; ++i)     fileContent[i]=(byte)i;
    OutputStream os=fs.create(new Path(uri.getPath()));
    os.write(fileContent);
    os.close();
    URL fileURL=uri.toURL();
    InputStream is=fileURL.openStream();
    assertNotNull(is);
    byte[] bytes=new byte[4096];
    assertEquals(1024,is.read(bytes));
    is.close();
    for (int i=0; i < fileContent.length; ++i)     assertEquals(fileContent[i],bytes[i]);
    fs.delete(new Path(uri.getPath()),false);
  }
  finally {
    fs.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.TestVolumeId </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testToString(){
  String strEmpty=new HdfsVolumeId(new byte[]{}).toString();
  assertNotNull(strEmpty);
  String strNotEmpty=new HdfsVolumeId(new byte[]{(byte)1}).toString();
  assertNotNull(strNotEmpty);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.azure.NativeAzureFileSystemBaseTest </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetOwnerOnFolder() throws Exception {
  Path newFolder=new Path("testOwner");
  assertTrue(fs.mkdirs(newFolder));
  fs.setOwner(newFolder,"newUser",null);
  FileStatus newStatus=fs.getFileStatus(newFolder);
  assertNotNull(newStatus);
  assertEquals("newUser",newStatus.getOwner());
  assertTrue(newStatus.isDirectory());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListSlash() throws Exception {
  Path testFolder=new Path("/testFolder");
  Path testFile=new Path(testFolder,"testFile");
  assertTrue(fs.mkdirs(testFolder));
  assertTrue(fs.createNewFile(testFile));
  FileStatus status=fs.getFileStatus(new Path("/testFolder/."));
  assertNotNull(status);
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUriEncodingMoreComplexCharacters() throws Exception {
  String fileName="!#$'()*;=[]%";
  String directoryName="*;=[]%!#$'()";
  fs.create(new Path(directoryName,fileName)).close();
  FileStatus[] listing=fs.listStatus(new Path(directoryName));
  assertEquals(1,listing.length);
  assertEquals(fileName,listing[0].getPath().getName());
  FileStatus status=fs.getFileStatus(new Path(directoryName,fileName));
  assertEquals(fileName,status.getPath().getName());
  InputStream stream=fs.open(new Path(directoryName,fileName));
  assertNotNull(stream);
  stream.close();
  assertTrue(fs.delete(new Path(directoryName,fileName),true));
  assertTrue(fs.delete(new Path(directoryName),true));
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRenameImplicitFolder() throws Exception {
  Path testFile=new Path("deep/file/rename/test");
  FsPermission permission=FsPermission.createImmutable((short)644);
  createEmptyFile(testFile,permission);
  assertTrue(fs.rename(new Path("deep/file"),new Path("deep/renamed")));
  assertFalse(fs.exists(testFile));
  FileStatus newStatus=fs.getFileStatus(new Path("deep/renamed/rename/test"));
  assertNotNull(newStatus);
  assertEqualsIgnoreStickyBit(permission,newStatus.getPermission());
  assertTrue(fs.delete(new Path("deep"),true));
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreDeleteFolder() throws Exception {
  Path testFolder=new Path("storeDeleteFolder");
  assertFalse(fs.exists(testFolder));
  assertTrue(fs.mkdirs(testFolder));
  assertTrue(fs.exists(testFolder));
  FileStatus status=fs.getFileStatus(testFolder);
  assertNotNull(status);
  assertTrue(status.isDirectory());
  assertEquals(new FsPermission((short)0755),status.getPermission());
  Path innerFile=new Path(testFolder,"innerFile");
  assertTrue(fs.createNewFile(innerFile));
  assertTrue(fs.exists(innerFile));
  assertTrue(fs.delete(testFolder,true));
  assertFalse(fs.exists(innerFile));
  assertFalse(fs.exists(testFolder));
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreRetrieveFile() throws Exception {
  Path testFile=new Path("unit-test-file");
  writeString(testFile,"Testing");
  assertTrue(fs.exists(testFile));
  FileStatus status=fs.getFileStatus(testFile);
  assertNotNull(status);
  assertEquals(new FsPermission((short)0644),status.getPermission());
  assertEquals("Testing",readString(testFile));
  fs.delete(testFile,true);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetOwnerOnFile() throws Exception {
  Path newFile=new Path("testOwner");
  OutputStream output=fs.create(newFile);
  output.write(13);
  output.close();
  fs.setOwner(newFile,"newUser",null);
  FileStatus newStatus=fs.getFileStatus(newFile);
  assertNotNull(newStatus);
  assertEquals("newUser",newStatus.getOwner());
  assertEquals("supergroup",newStatus.getGroup());
  assertEquals(1,newStatus.getLen());
  fs.setOwner(newFile,null,"newGroup");
  newStatus=fs.getFileStatus(newFile);
  assertNotNull(newStatus);
  assertEquals("newUser",newStatus.getOwner());
  assertEquals("newGroup",newStatus.getGroup());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetPermissionOnFolder() throws Exception {
  Path newFolder=new Path("testPermission");
  assertTrue(fs.mkdirs(newFolder));
  FsPermission newPermission=new FsPermission((short)0600);
  fs.setPermission(newFolder,newPermission);
  FileStatus newStatus=fs.getFileStatus(newFolder);
  assertNotNull(newStatus);
  assertEquals(newPermission,newStatus.getPermission());
  assertTrue(newStatus.isDirectory());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetPermissionOnFile() throws Exception {
  Path newFile=new Path("testPermission");
  OutputStream output=fs.create(newFile);
  output.write(13);
  output.close();
  FsPermission newPermission=new FsPermission((short)0700);
  fs.setPermission(newFile,newPermission);
  FileStatus newStatus=fs.getFileStatus(newFile);
  assertNotNull(newStatus);
  assertEquals(newPermission,newStatus.getPermission());
  assertEquals("supergroup",newStatus.getGroup());
  assertEquals(UserGroupInformation.getCurrentUser().getShortUserName(),newStatus.getOwner());
  assertEquals(1,newStatus.getLen());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.azure.TestBlobMetadata </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that WASB understands the old-style ASV metadata and changes it when
 * it gets the chance.
 */
@Test public void testOldPermissionMetadata() throws Exception {
  Path selfishFile=new Path("/noOneElse");
  HashMap<String,String> metadata=new HashMap<String,String>();
  metadata.put("asv_permission",getExpectedPermissionString("rw-------"));
  backingStore.setContent(AzureBlobStorageTestAccount.toMockUri(selfishFile),new byte[]{},metadata);
  FsPermission justMe=new FsPermission(FsAction.READ_WRITE,FsAction.NONE,FsAction.NONE);
  FileStatus retrievedStatus=fs.getFileStatus(selfishFile);
  assertNotNull(retrievedStatus);
  assertEquals(justMe,retrievedStatus.getPermission());
  assertEquals(getExpectedOwner(),retrievedStatus.getOwner());
  assertEquals(NativeAzureFileSystem.AZURE_DEFAULT_GROUP_DEFAULT,retrievedStatus.getGroup());
  FsPermission meAndYou=new FsPermission(FsAction.READ_WRITE,FsAction.READ_WRITE,FsAction.NONE);
  fs.setPermission(selfishFile,meAndYou);
  metadata=backingStore.getMetadata(AzureBlobStorageTestAccount.toMockUri(selfishFile));
  assertNotNull(metadata);
  String storedPermission=metadata.get("hdi_permission");
  assertEquals(getExpectedPermissionString("rw-rw----"),storedPermission);
  assertNull(metadata.get("asv_permission"));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFolderMetadata() throws Exception {
  Path folder=new Path("/folder");
  FsPermission justRead=new FsPermission(FsAction.READ,FsAction.READ,FsAction.READ);
  fs.mkdirs(folder,justRead);
  HashMap<String,String> metadata=backingStore.getMetadata(AzureBlobStorageTestAccount.toMockUri(folder));
  assertNotNull(metadata);
  assertEquals("true",metadata.get("hdi_isfolder"));
  assertEquals(getExpectedPermissionString("r--r--r--"),metadata.get("hdi_permission"));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void testPermissionMetadata() throws Exception {
  FsPermission justMe=new FsPermission(FsAction.READ_WRITE,FsAction.NONE,FsAction.NONE);
  Path selfishFile=new Path("/noOneElse");
  fs.create(selfishFile,justMe,true,4096,fs.getDefaultReplication(),fs.getDefaultBlockSize(),null).close();
  HashMap<String,String> metadata=backingStore.getMetadata(AzureBlobStorageTestAccount.toMockUri(selfishFile));
  assertNotNull(metadata);
  String storedPermission=metadata.get("hdi_permission");
  assertEquals(getExpectedPermissionString("rw-------"),storedPermission);
  FileStatus retrievedStatus=fs.getFileStatus(selfishFile);
  assertNotNull(retrievedStatus);
  assertEquals(justMe,retrievedStatus.getPermission());
  assertEquals(getExpectedOwner(),retrievedStatus.getOwner());
  assertEquals(NativeAzureFileSystem.AZURE_DEFAULT_GROUP_DEFAULT,retrievedStatus.getGroup());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that WASB works well with an older version container with ASV-era
 * version and metadata.
 */
@Test public void testFirstContainerVersionMetadata() throws Exception {
  HashMap<String,String> containerMetadata=new HashMap<String,String>();
  containerMetadata.put(AzureNativeFileSystemStore.OLD_VERSION_METADATA_KEY,AzureNativeFileSystemStore.FIRST_WASB_VERSION);
  FsWithPreExistingContainer fsWithContainer=FsWithPreExistingContainer.create(containerMetadata);
  assertFalse(fsWithContainer.getFs().exists(new Path("/IDontExist")));
  assertEquals(0,fsWithContainer.getFs().listStatus(new Path("/")).length);
  assertEquals(AzureNativeFileSystemStore.FIRST_WASB_VERSION,fsWithContainer.getContainerMetadata().get(AzureNativeFileSystemStore.OLD_VERSION_METADATA_KEY));
  assertNull(fsWithContainer.getContainerMetadata().get(AzureNativeFileSystemStore.VERSION_METADATA_KEY));
  fsWithContainer.getFs().mkdirs(new Path("/dir"));
  assertEquals(AzureNativeFileSystemStore.CURRENT_WASB_VERSION,fsWithContainer.getContainerMetadata().get(AzureNativeFileSystemStore.VERSION_METADATA_KEY));
  assertNull(fsWithContainer.getContainerMetadata().get(AzureNativeFileSystemStore.OLD_VERSION_METADATA_KEY));
  fsWithContainer.close();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that WASB stamped the version in the container metadata if it does a
 * write operation to a pre-existing container.
 */
@Test public void testPreExistingContainerVersionMetadata() throws Exception {
  FsWithPreExistingContainer fsWithContainer=FsWithPreExistingContainer.create();
  assertFalse(fsWithContainer.getFs().exists(new Path("/IDontExist")));
  assertEquals(0,fsWithContainer.getFs().listStatus(new Path("/")).length);
  assertNull(fsWithContainer.getContainerMetadata());
  fsWithContainer.getFs().mkdirs(new Path("/dir"));
  assertNotNull(fsWithContainer.getContainerMetadata());
  assertEquals(AzureNativeFileSystemStore.CURRENT_WASB_VERSION,fsWithContainer.getContainerMetadata().get(AzureNativeFileSystemStore.VERSION_METADATA_KEY));
  fsWithContainer.close();
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that WASB stamped the version in the container metadata.
 */
@Test public void testContainerVersionMetadata() throws Exception {
  fs.createNewFile(new Path("/foo"));
  HashMap<String,String> containerMetadata=backingStore.getContainerMetadata();
  assertNotNull(containerMetadata);
  assertEquals(AzureNativeFileSystemStore.CURRENT_WASB_VERSION,containerMetadata.get(AzureNativeFileSystemStore.VERSION_METADATA_KEY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.azure.TestContainerChecks </h4><pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerCreateAfterDoesNotExist() throws Exception {
  testAccount=AzureBlobStorageTestAccount.create("",EnumSet.noneOf(CreateOptions.class));
  assumeNotNull(testAccount);
  CloudBlobContainer container=testAccount.getRealContainer();
  FileSystem fs=testAccount.getFileSystem();
  assertFalse(container.exists());
  try {
    assertNull(fs.listStatus(new Path("/")));
    assertTrue("Should've thrown.",false);
  }
 catch (  FileNotFoundException ex) {
    assertTrue("Unexpected exception: " + ex,ex.getMessage().contains("does not exist."));
  }
  assertFalse(container.exists());
  container.create();
  assertTrue(fs.createNewFile(new Path("/foo")));
  assertTrue(container.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.azure.TestNativeAzureFileSystemConcurrency </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLinkBlobs() throws Exception {
  Path filePath=new Path("/inProgress");
  FSDataOutputStream outputStream=fs.create(filePath);
  HashMap<String,String> metadata=backingStore.getMetadata(AzureBlobStorageTestAccount.toMockUri(filePath));
  assertNotNull(metadata);
  String linkValue=metadata.get(AzureNativeFileSystemStore.LINK_BACK_TO_UPLOAD_IN_PROGRESS_METADATA_KEY);
  assertNotNull(linkValue);
  assertTrue(backingStore.exists(AzureBlobStorageTestAccount.toMockUri(linkValue)));
  assertTrue(fs.exists(filePath));
  outputStream.close();
  metadata=backingStore.getMetadata(AzureBlobStorageTestAccount.toMockUri(filePath));
  assertNull(metadata.get(AzureNativeFileSystemStore.LINK_BACK_TO_UPLOAD_IN_PROGRESS_METADATA_KEY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.azure.TestOutOfBandAzureBlobOperations </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitFolderListed() throws Exception {
  createEmptyBlobOutOfBand("root/b");
  FileStatus[] obtained=fs.listStatus(new Path("/root/b"));
  assertNotNull(obtained);
  assertEquals(1,obtained.length);
  assertFalse(obtained[0].isDirectory());
  assertEquals("/root/b",obtained[0].getPath().toUri().getPath());
  obtained=fs.listStatus(new Path("/root"));
  assertNotNull(obtained);
  assertEquals(1,obtained.length);
  assertFalse(obtained[0].isDirectory());
  assertEquals("/root/b",obtained[0].getPath().toUri().getPath());
  FileStatus dirStatus=fs.getFileStatus(new Path("/root"));
  assertNotNull(dirStatus);
  assertTrue(dirStatus.isDirectory());
  assertEquals("/root",dirStatus.getPath().toUri().getPath());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetOwnerOnImplicitFolder() throws Exception {
  createEmptyBlobOutOfBand("root/b");
  fs.setOwner(new Path("/root"),"newOwner",null);
  FileStatus newStatus=fs.getFileStatus(new Path("/root"));
  assertNotNull(newStatus);
  assertEquals("newOwner",newStatus.getOwner());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetPermissionOnImplicitFolder() throws Exception {
  createEmptyBlobOutOfBand("root/b");
  FsPermission newPermission=new FsPermission((short)0600);
  fs.setPermission(new Path("/root"),newPermission);
  FileStatus newStatus=fs.getFileStatus(new Path("/root"));
  assertNotNull(newStatus);
  assertEquals(newPermission,newStatus.getPermission());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.azure.TestWasbFsck </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that we delete dangling files properly
 */
@Test public void testDelete() throws Exception {
  Path danglingFile=new Path("/crashedInTheMiddle");
  FSDataOutputStream stream=fs.create(danglingFile);
  stream.write(new byte[]{1,2,3});
  stream.flush();
  FileStatus fileStatus=fs.getFileStatus(danglingFile);
  assertNotNull(fileStatus);
  assertEquals(0,fileStatus.getLen());
  assertEquals(1,getNumTempBlobs());
  runFsck("-delete");
  assertEquals(0,getNumTempBlobs());
  assertFalse(fs.exists(danglingFile));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.azure.TestWasbUriAndConfiguration </h4><pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the cases when the URI is specified with no authority, i.e.
 * wasb:///path/to/file.
 */
@Test public void testNoUriAuthority() throws Exception {
  String[] wasbAliases=new String[]{"wasb","wasbs"};
  for (  String defaultScheme : wasbAliases) {
    for (    String wantedScheme : wasbAliases) {
      testAccount=AzureBlobStorageTestAccount.createMock();
      Configuration conf=testAccount.getFileSystem().getConf();
      String authority=testAccount.getFileSystem().getUri().getAuthority();
      URI defaultUri=new URI(defaultScheme,authority,null,null,null);
      conf.set("fs.default.name",defaultUri.toString());
      URI wantedUri=new URI(wantedScheme + ":///random/path");
      NativeAzureFileSystem obtained=(NativeAzureFileSystem)FileSystem.get(wantedUri,conf);
      assertNotNull(obtained);
      assertEquals(new URI(wantedScheme,authority,null,null,null),obtained.getUri());
      Path qualified=obtained.makeQualified(new Path(wantedUri));
      assertEquals(new URI(wantedScheme,authority,wantedUri.getPath(),null,null),qualified.toUri());
      testAccount.cleanup();
      FileSystem.closeAll();
    }
  }
  testAccount=AzureBlobStorageTestAccount.createMock();
  Configuration conf=testAccount.getFileSystem().getConf();
  conf.set("fs.default.name","file:///");
  try {
    FileSystem.get(new URI("wasb:///random/path"),conf);
    fail("Should've thrown.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.contract.AbstractFSContractTestBase </h4><pre class="type-8 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Setup: create the contract then init it
 * @throws Exception on any failure
 */
@Before public void setup() throws Exception {
  contract=createContract(createConfiguration());
  contract.init();
  assumeEnabled();
  fileSystem=contract.getTestFileSystem();
  assertNotNull("null filesystem",fileSystem);
  URI fsURI=fileSystem.getUri();
  LOG.info("Test filesystem = {} implemented by {}",fsURI,fileSystem);
  assertEquals("wrong filesystem of " + fsURI,contract.getScheme(),fsURI.getScheme());
  testPath=getContract().getTestPath();
  mkdirs(testPath);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.contract.localfs.TestLocalFSContractLoaded </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContractWorks() throws Throwable {
  String key=getContract().getConfKey(SUPPORTS_ATOMIC_RENAME);
  assertNotNull("not set: " + key,getContract().getConf().get(key));
  assertTrue("not true: " + key,getContract().isSupported(SUPPORTS_ATOMIC_RENAME,false));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testContractResourceOnClasspath() throws Throwable {
  URL url=this.getClass().getClassLoader().getResource(LocalFSContract.CONTRACT_XML);
  assertNotNull("could not find contract resource",url);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.shell.TestCommandFactory </h4><pre class="type-8 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void testSetup(){
  factory=new CommandFactory(conf);
  assertNotNull(factory);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInstances(){
  factory.registerCommands(TestRegistrar.class);
  Command instance;
  instance=factory.getInstance("blarg");
  assertNull(instance);
  instance=factory.getInstance("tc1");
  assertNotNull(instance);
  assertEquals(TestCommand1.class,instance.getClass());
  assertEquals("tc1",instance.getCommandName());
  instance=factory.getInstance("tc2");
  assertNotNull(instance);
  assertEquals(TestCommand2.class,instance.getClass());
  assertEquals("tc2",instance.getCommandName());
  instance=factory.getInstance("tc2.1");
  assertNotNull(instance);
  assertEquals(TestCommand2.class,instance.getClass());
  assertEquals("tc2.1",instance.getCommandName());
  factory.addClass(TestCommand4.class,"tc4");
  instance=factory.getInstance("tc4");
  assertNotNull(instance);
  assertEquals(TestCommand4.class,instance.getClass());
  assertEquals("tc4",instance.getCommandName());
  String usage=instance.getUsage();
  assertEquals("-tc4 tc4_usage",usage);
  assertEquals("tc4_description",instance.getDescription());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.swift.TestSwiftFileSystemBlockLocation </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test(timeout=SWIFT_TEST_TIMEOUT) public void testLocateNullStatus() throws Throwable {
  describe("verify that a null filestatus maps to a null location array");
  BlockLocation[] locations=getFs().getFileBlockLocations((FileStatus)null,0,1);
  assertNull(locations);
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=SWIFT_TEST_TIMEOUT) public void testLocateOutOfRangeLen() throws Throwable {
  describe("overshooting the length is legal, as long as the" + " origin location is valid");
  BlockLocation[] locations=getFs().getFileBlockLocations(createFileAndGetStatus(),0,data.length + 100);
  assertNotNull(locations);
  assertTrue(locations.length > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.swift.TestSwiftFileSystemExtendedContract </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test(timeout=SWIFT_TEST_TIMEOUT) public void testFilesystemHasURI() throws Throwable {
  assertNotNull(fs.getUri());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.swift.TestSwiftFileSystemPartitionedUploads </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tests functionality for big files ( > 5Gb) upload
 */
@Test(timeout=SWIFT_BULK_IO_TEST_TIMEOUT) public void testFilePartUpload() throws Throwable {
  final Path path=new Path("/test/testFilePartUpload");
  int len=8192;
  final byte[] src=SwiftTestUtils.dataset(len,32,144);
  FSDataOutputStream out=fs.create(path,false,getBufferSize(),(short)1,BLOCK_SIZE);
  try {
    int totalPartitionsToWrite=len / PART_SIZE_BYTES;
    assertPartitionsWritten("Startup",out,0);
    int firstWriteLen=2048;
    out.write(src,0,firstWriteLen);
    long expected=getExpectedPartitionsWritten(firstWriteLen,PART_SIZE_BYTES,false);
    SwiftUtils.debug(LOG,"First write: predict %d partitions written",expected);
    assertPartitionsWritten("First write completed",out,expected);
    int remainder=len - firstWriteLen;
    SwiftUtils.debug(LOG,"remainder: writing: %d bytes",remainder);
    out.write(src,firstWriteLen,remainder);
    expected=getExpectedPartitionsWritten(len,PART_SIZE_BYTES,false);
    assertPartitionsWritten("Remaining data",out,expected);
    out.close();
    expected=getExpectedPartitionsWritten(len,PART_SIZE_BYTES,true);
    assertPartitionsWritten("Stream closed",out,expected);
    Header[] headers=fs.getStore().getObjectHeaders(path,true);
    for (    Header header : headers) {
      LOG.info(header.toString());
    }
    byte[] dest=readDataset(fs,path,len);
    LOG.info("Read dataset from " + path + ": data length ="+ len);
    SwiftTestUtils.compareByteArrays(src,dest,len);
    FileStatus status;
    final Path qualifiedPath=path.makeQualified(fs);
    status=fs.getFileStatus(qualifiedPath);
    BlockLocation[] locations=fs.getFileBlockLocations(status,0,len);
    assertNotNull("Null getFileBlockLocations()",locations);
    assertTrue("empty array returned for getFileBlockLocations()",locations.length > 0);
    try {
      validatePathLen(path,len);
    }
 catch (    AssertionError e) {
      throw new AssumptionViolatedException(e,null);
    }
  }
  finally {
    IOUtils.closeStream(out);
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tests functionality for big files ( > 5Gb) upload
 */
@Test(timeout=SWIFT_BULK_IO_TEST_TIMEOUT) public void testFilePartUploadNoLengthCheck() throws IOException, URISyntaxException {
  final Path path=new Path("/test/testFilePartUploadLengthCheck");
  int len=8192;
  final byte[] src=SwiftTestUtils.dataset(len,32,144);
  FSDataOutputStream out=fs.create(path,false,getBufferSize(),(short)1,BLOCK_SIZE);
  try {
    int totalPartitionsToWrite=len / PART_SIZE_BYTES;
    assertPartitionsWritten("Startup",out,0);
    int firstWriteLen=2048;
    out.write(src,0,firstWriteLen);
    long expected=getExpectedPartitionsWritten(firstWriteLen,PART_SIZE_BYTES,false);
    SwiftUtils.debug(LOG,"First write: predict %d partitions written",expected);
    assertPartitionsWritten("First write completed",out,expected);
    int remainder=len - firstWriteLen;
    SwiftUtils.debug(LOG,"remainder: writing: %d bytes",remainder);
    out.write(src,firstWriteLen,remainder);
    expected=getExpectedPartitionsWritten(len,PART_SIZE_BYTES,false);
    assertPartitionsWritten("Remaining data",out,expected);
    out.close();
    expected=getExpectedPartitionsWritten(len,PART_SIZE_BYTES,true);
    assertPartitionsWritten("Stream closed",out,expected);
    Header[] headers=fs.getStore().getObjectHeaders(path,true);
    for (    Header header : headers) {
      LOG.info(header.toString());
    }
    byte[] dest=readDataset(fs,path,len);
    LOG.info("Read dataset from " + path + ": data length ="+ len);
    SwiftTestUtils.compareByteArrays(src,dest,len);
    FileStatus status=fs.getFileStatus(path);
    BlockLocation[] locations=fs.getFileBlockLocations(status,0,len);
    assertNotNull("Null getFileBlockLocations()",locations);
    assertTrue("empty array returned for getFileBlockLocations()",locations.length > 0);
  }
  finally {
    IOUtils.closeStream(out);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.viewfs.TestChRootedFileSystem </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testList() throws IOException {
  FileStatus fs=fSys.getFileStatus(new Path("/"));
  Assert.assertTrue(fs.isDirectory());
  Assert.assertEquals(fs.getPath(),chrootedTo);
  FileStatus[] dirPaths=fSys.listStatus(new Path("/"));
  Assert.assertEquals(0,dirPaths.length);
  fileSystemTestHelper.createFile(fSys,"/foo");
  fileSystemTestHelper.createFile(fSys,"/bar");
  fSys.mkdirs(new Path("/dirX"));
  fSys.mkdirs(fileSystemTestHelper.getTestRootPath(fSys,"/dirY"));
  fSys.mkdirs(new Path("/dirX/dirXX"));
  dirPaths=fSys.listStatus(new Path("/"));
  Assert.assertEquals(4,dirPaths.length);
  fs=FileSystemTestHelper.containsPath(new Path(chrootedTo,"foo"),dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue(fs.isFile());
  fs=FileSystemTestHelper.containsPath(new Path(chrootedTo,"bar"),dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue(fs.isFile());
  fs=FileSystemTestHelper.containsPath(new Path(chrootedTo,"dirX"),dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue(fs.isDirectory());
  fs=FileSystemTestHelper.containsPath(new Path(chrootedTo,"dirY"),dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue(fs.isDirectory());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.viewfs.TestChRootedFs </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testList() throws IOException {
  FileStatus fs=fc.getFileStatus(new Path("/"));
  Assert.assertTrue(fs.isDirectory());
  Assert.assertEquals(fs.getPath(),chrootedTo);
  FileStatus[] dirPaths=fc.util().listStatus(new Path("/"));
  Assert.assertEquals(0,dirPaths.length);
  fileContextTestHelper.createFileNonRecursive(fc,"/foo");
  fileContextTestHelper.createFileNonRecursive(fc,"/bar");
  fc.mkdir(new Path("/dirX"),FileContext.DEFAULT_PERM,false);
  fc.mkdir(fileContextTestHelper.getTestRootPath(fc,"/dirY"),FileContext.DEFAULT_PERM,false);
  fc.mkdir(new Path("/dirX/dirXX"),FileContext.DEFAULT_PERM,false);
  dirPaths=fc.util().listStatus(new Path("/"));
  Assert.assertEquals(4,dirPaths.length);
  fs=fileContextTestHelper.containsPath(fcTarget,"foo",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue(fs.isFile());
  fs=fileContextTestHelper.containsPath(fcTarget,"bar",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue(fs.isFile());
  fs=fileContextTestHelper.containsPath(fcTarget,"dirX",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue(fs.isDirectory());
  fs=fileContextTestHelper.containsPath(fcTarget,"dirY",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue(fs.isDirectory());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.viewfs.TestViewFileSystemDelegationTokenSupport </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Regression test for HADOOP-8408.
 */
@Test public void testGetCanonicalServiceNameWithNonDefaultMountTable() throws URISyntaxException, IOException {
  Configuration conf=new Configuration();
  ConfigUtil.addLink(conf,MOUNT_TABLE_NAME,"/user",new URI("file:///"));
  FileSystem viewFs=FileSystem.get(new URI(FsConstants.VIEWFS_SCHEME + "://" + MOUNT_TABLE_NAME),conf);
  String serviceName=viewFs.getCanonicalServiceName();
  assertNull(serviceName);
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetChildFileSystems() throws Exception {
  assertNull(fs1.getChildFileSystems());
  assertNull(fs2.getChildFileSystems());
  List<FileSystem> children=Arrays.asList(viewFs.getChildFileSystems());
  assertEquals(2,children.size());
  assertTrue(children.contains(fs1));
  assertTrue(children.contains(fs2));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetCanonicalServiceNameWithDefaultMountTable() throws URISyntaxException, IOException {
  Configuration conf=new Configuration();
  ConfigUtil.addLink(conf,"/user",new URI("file:///"));
  FileSystem viewFs=FileSystem.get(FsConstants.VIEWFS_URI,conf);
  String serviceName=viewFs.getCanonicalServiceName();
  assertNull(serviceName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.viewfs.ViewFileSystemBaseTest </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListOnMountTargetDirs() throws IOException {
  FileStatus[] dirPaths=fsView.listStatus(new Path("/data"));
  FileStatus fs;
  Assert.assertEquals(0,dirPaths.length);
  long len=fileSystemTestHelper.createFile(fsView,"/data/foo");
  dirPaths=fsView.listStatus(new Path("/data"));
  Assert.assertEquals(1,dirPaths.length);
  fs=fileSystemTestHelper.containsPath(fsView,"/data/foo",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("Created file shoudl appear as a file",fs.isFile());
  Assert.assertEquals(len,fs.getLen());
  fsView.mkdirs(fileSystemTestHelper.getTestRootPath(fsView,"/data/dirX"));
  dirPaths=fsView.listStatus(new Path("/data"));
  Assert.assertEquals(2,dirPaths.length);
  fs=fileSystemTestHelper.containsPath(fsView,"/data/foo",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("Created file shoudl appear as a file",fs.isFile());
  fs=fileSystemTestHelper.containsPath(fsView,"/data/dirX",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("Created dir should appear as a dir",fs.isDirectory());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test "readOps" (e.g. list, listStatus) 
 * on internal dirs of mount table
 * These operations should succeed.
 */
@Test public void testListOnInternalDirsOfMountTable() throws IOException {
  FileStatus[] dirPaths=fsView.listStatus(new Path("/"));
  FileStatus fs;
  verifyRootChildren(dirPaths);
  dirPaths=fsView.listStatus(new Path("/internalDir"));
  Assert.assertEquals(2,dirPaths.length);
  fs=fileSystemTestHelper.containsPath(fsView,"/internalDir/internalDir2",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("A mount should appear as symlink",fs.isDirectory());
  fs=fileSystemTestHelper.containsPath(fsView,"/internalDir/linkToDir2",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("A mount should appear as symlink",fs.isSymlink());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.fs.viewfs.ViewFsBaseTest </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test "readOps" (e.g. list, listStatus) 
 * on internal dirs of mount table
 * These operations should succeed.
 */
@Test public void testListOnInternalDirsOfMountTable() throws IOException {
  FileStatus[] dirPaths=fcView.util().listStatus(new Path("/"));
  FileStatus fs;
  Assert.assertEquals(7,dirPaths.length);
  fs=fileContextTestHelper.containsPath(fcView,"/user",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("A mount should appear as symlink",fs.isSymlink());
  fs=fileContextTestHelper.containsPath(fcView,"/data",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("A mount should appear as symlink",fs.isSymlink());
  fs=fileContextTestHelper.containsPath(fcView,"/internalDir",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("InternalDirs should appear as dir",fs.isDirectory());
  fs=fileContextTestHelper.containsPath(fcView,"/danglingLink",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("A mount should appear as symlink",fs.isSymlink());
  fs=fileContextTestHelper.containsPath(fcView,"/linkToAFile",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("A mount should appear as symlink",fs.isSymlink());
  dirPaths=fcView.util().listStatus(new Path("/internalDir"));
  Assert.assertEquals(2,dirPaths.length);
  fs=fileContextTestHelper.containsPath(fcView,"/internalDir/internalDir2",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("InternalDirs should appear as dir",fs.isDirectory());
  fs=fileContextTestHelper.containsPath(fcView,"/internalDir/linkToDir2",dirPaths);
  Assert.assertNotNull(fs);
  Assert.assertTrue("A mount should appear as symlink",fs.isSymlink());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDFSAddressConfig </h4><pre class="type-9 type-13 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDFSAddressConfig() throws IOException {
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).build();
  cluster.waitActive();
  ArrayList<DataNode> dns=cluster.getDataNodes();
  DataNode dn=dns.get(0);
  String selfSocketAddr=dn.getXferAddress().toString();
  System.out.println("DN Self Socket Addr == " + selfSocketAddr);
  assertTrue(selfSocketAddr.contains("/127.0.0.1:"));
  for (int i=0; i < dns.size(); i++) {
    DataNodeProperties dnp=cluster.stopDataNode(i);
    assertNotNull("Should have been able to stop simulated datanode",dnp);
  }
  conf.unset(DFS_DATANODE_ADDRESS_KEY);
  conf.unset(DFS_DATANODE_HTTP_ADDRESS_KEY);
  conf.unset(DFS_DATANODE_IPC_ADDRESS_KEY);
  cluster.startDataNodes(conf,1,true,StartupOption.REGULAR,null,null,null,false,true);
  dns=cluster.getDataNodes();
  dn=dns.get(0);
  selfSocketAddr=dn.getXferAddress().toString();
  System.out.println("DN Self Socket Addr == " + selfSocketAddr);
  assertTrue(selfSocketAddr.contains("/127.0.0.1:"));
  for (int i=0; i < dns.size(); i++) {
    DataNodeProperties dnp=cluster.stopDataNode(i);
    assertNotNull("Should have been able to stop simulated datanode",dnp);
  }
  conf.set(DFS_DATANODE_ADDRESS_KEY,"0.0.0.0:0");
  conf.set(DFS_DATANODE_HTTP_ADDRESS_KEY,"0.0.0.0:0");
  conf.set(DFS_DATANODE_IPC_ADDRESS_KEY,"0.0.0.0:0");
  cluster.startDataNodes(conf,1,true,StartupOption.REGULAR,null,null,null,false,true);
  dns=cluster.getDataNodes();
  dn=dns.get(0);
  selfSocketAddr=dn.getXferAddress().toString();
  System.out.println("DN Self Socket Addr == " + selfSocketAddr);
  assertTrue(selfSocketAddr.contains("/0.0.0.0:"));
  cluster.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDFSUtil </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetOnlyNameServiceIdOrNull(){
  HdfsConfiguration conf=new HdfsConfiguration();
  conf.set(DFS_NAMESERVICES,"ns1,ns2");
  assertNull(DFSUtil.getOnlyNameServiceIdOrNull(conf));
  conf.set(DFS_NAMESERVICES,"");
  assertNull(DFSUtil.getOnlyNameServiceIdOrNull(conf));
  conf.set(DFS_NAMESERVICES,"ns1");
  assertEquals("ns1",DFSUtil.getOnlyNameServiceIdOrNull(conf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDataTransferKeepalive </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Regression test for HDFS-3357. Check that the datanode is respecting
 * its configured keepalive timeout.
 */
@Test(timeout=30000) public void testDatanodeRespectsKeepAliveTimeout() throws Exception {
  Configuration clientConf=new Configuration(conf);
  final long CLIENT_EXPIRY_MS=60000L;
  clientConf.setLong(DFS_CLIENT_SOCKET_CACHE_EXPIRY_MSEC_KEY,CLIENT_EXPIRY_MS);
  clientConf.set(DFS_CLIENT_CONTEXT,"testDatanodeRespectsKeepAliveTimeout");
  DistributedFileSystem fs=(DistributedFileSystem)FileSystem.get(cluster.getURI(),clientConf);
  PeerCache peerCache=ClientContext.getFromConf(clientConf).getPeerCache();
  DFSTestUtil.createFile(fs,TEST_FILE,1L,(short)1,0L);
  assertEquals(0,peerCache.size());
  assertXceiverCount(0);
  DFSTestUtil.readFile(fs,TEST_FILE);
  assertEquals(1,peerCache.size());
  assertXceiverCount(1);
  Thread.sleep(DFS_DATANODE_SOCKET_REUSE_KEEPALIVE_DEFAULT + 1);
  assertXceiverCount(0);
  assertEquals(1,peerCache.size());
  Peer peer=peerCache.get(dn.getDatanodeId(),false);
  assertNotNull(peer);
  assertEquals(-1,peer.getInputStream().read());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDatanodeConfig </h4><pre class="type-9 type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that a data-node does not start if configuration specifies
 * incorrect URI scheme in data directory.
 * Test that a data-node starts if data directory is specified as
 * URI = "file:///path" or as a non URI path.
 */
@Test public void testDataDirectories() throws IOException {
  File dataDir=new File(BASE_DIR,"data").getCanonicalFile();
  Configuration conf=cluster.getConfiguration(0);
  String dnDir=makeURI("shv",null,fileAsURI(dataDir).getPath());
  conf.set(DFSConfigKeys.DFS_DATANODE_DATA_DIR_KEY,dnDir);
  DataNode dn=null;
  try {
    dn=DataNode.createDataNode(new String[]{},conf);
    fail();
  }
 catch (  Exception e) {
  }
 finally {
    if (dn != null) {
      dn.shutdown();
    }
  }
  assertNull("Data-node startup should have failed.",dn);
  String dnDir1=fileAsURI(dataDir).toString() + "1";
  String dnDir2=makeURI("file","localhost",fileAsURI(dataDir).getPath() + "2");
  String dnDir3=dataDir.getAbsolutePath() + "3";
  conf.set(DFSConfigKeys.DFS_DATANODE_DATA_DIR_KEY,dnDir1 + "," + dnDir2+ ","+ dnDir3);
  try {
    cluster.startDataNodes(conf,1,false,StartupOption.REGULAR,null);
    assertTrue("Data-node should startup.",cluster.isDataNodeUp());
  }
  finally {
    if (cluster != null) {
      cluster.shutdownDataNodes();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDecommission </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests decommission with replicas on the target datanode cannot be migrated
 * to other datanodes and satisfy the replication factor. Make sure the
 * datanode won't get stuck in decommissioning state.
 */
@Test(timeout=360000) public void testDecommission2() throws IOException {
  LOG.info("Starting test testDecommission");
  int numNamenodes=1;
  int numDatanodes=4;
  conf.setInt(DFSConfigKeys.DFS_REPLICATION_KEY,3);
  startCluster(numNamenodes,numDatanodes,conf);
  ArrayList<ArrayList<DatanodeInfo>> namenodeDecomList=new ArrayList<ArrayList<DatanodeInfo>>(numNamenodes);
  namenodeDecomList.add(0,new ArrayList<DatanodeInfo>(numDatanodes));
  Path file1=new Path("testDecommission2.dat");
  int replicas=4;
  ArrayList<DatanodeInfo> decommissionedNodes=namenodeDecomList.get(0);
  FileSystem fileSys=cluster.getFileSystem(0);
  FSNamesystem ns=cluster.getNamesystem(0);
  writeFile(fileSys,file1,replicas);
  int deadDecomissioned=ns.getNumDecomDeadDataNodes();
  int liveDecomissioned=ns.getNumDecomLiveDataNodes();
  DatanodeInfo decomNode=decommissionNode(0,null,decommissionedNodes,AdminStates.DECOMMISSIONED);
  decommissionedNodes.add(decomNode);
  assertEquals(deadDecomissioned,ns.getNumDecomDeadDataNodes());
  assertEquals(liveDecomissioned + 1,ns.getNumDecomLiveDataNodes());
  DFSClient client=getDfsClient(cluster.getNameNode(0),conf);
  assertEquals("All datanodes must be alive",numDatanodes,client.datanodeReport(DatanodeReportType.LIVE).length);
  assertNull(checkFile(fileSys,file1,replicas,decomNode.getXferAddr(),numDatanodes));
  cleanupFile(fileSys,file1);
  cluster.shutdown();
  startCluster(1,4,conf);
  cluster.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestDistributedFileSystem </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests error paths for{@link DistributedFileSystem#getFileBlockStorageLocations(java.util.List)}
 */
@Test(timeout=60000) public void testGetFileBlockStorageLocationsError() throws Exception {
  final Configuration conf=getTestConfiguration();
  conf.setBoolean(DFSConfigKeys.DFS_HDFS_BLOCKS_METADATA_ENABLED,true);
  conf.setInt(DFSConfigKeys.DFS_CLIENT_FILE_BLOCK_STORAGE_LOCATIONS_TIMEOUT_MS,1500);
  conf.setInt(CommonConfigurationKeysPublic.IPC_CLIENT_CONNECT_MAX_RETRIES_KEY,0);
  MiniDFSCluster cluster=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
    cluster.getDataNodes();
    final DistributedFileSystem fs=cluster.getFileSystem();
    final Path tmpFile1=new Path("/errorfile1.dat");
    final Path tmpFile2=new Path("/errorfile2.dat");
    DFSTestUtil.createFile(fs,tmpFile1,1024,(short)2,0xDEADDEADl);
    DFSTestUtil.createFile(fs,tmpFile2,1024,(short)2,0xDEADDEADl);
    GenericTestUtils.waitFor(new Supplier<Boolean>(){
      @Override public Boolean get(){
        try {
          List<BlockLocation> list=Lists.newArrayList();
          list.addAll(Arrays.asList(fs.getFileBlockLocations(tmpFile1,0,1024)));
          list.addAll(Arrays.asList(fs.getFileBlockLocations(tmpFile2,0,1024)));
          int totalRepl=0;
          for (          BlockLocation loc : list) {
            totalRepl+=loc.getHosts().length;
          }
          if (totalRepl == 4) {
            return true;
          }
        }
 catch (        IOException e) {
        }
        return false;
      }
    }
,500,30000);
    BlockLocation[] blockLocs1=fs.getFileBlockLocations(tmpFile1,0,1024);
    BlockLocation[] blockLocs2=fs.getFileBlockLocations(tmpFile2,0,1024);
    List<BlockLocation> allLocs=Lists.newArrayList();
    allLocs.addAll(Arrays.asList(blockLocs1));
    allLocs.addAll(Arrays.asList(blockLocs2));
    DataNodeFaultInjector injector=Mockito.mock(DataNodeFaultInjector.class);
    Mockito.doAnswer(new Answer<Void>(){
      @Override public Void answer(      InvocationOnMock invocation) throws Throwable {
        Thread.sleep(3000);
        return null;
      }
    }
).when(injector).getHdfsBlocksMetadata();
    DataNodeFaultInjector.instance=injector;
    BlockStorageLocation[] locs=fs.getFileBlockStorageLocations(allLocs);
    for (    BlockStorageLocation loc : locs) {
      assertEquals("Found more than 0 cached hosts although RPCs supposedly timed out",0,loc.getCachedHosts().length);
    }
    DataNodeFaultInjector.instance=new DataNodeFaultInjector();
    DataNodeProperties stoppedNode=cluster.stopDataNode(0);
    locs=fs.getFileBlockStorageLocations(allLocs);
    assertEquals("Expected two HdfsBlockLocation for two 1-block files",2,locs.length);
    for (    BlockStorageLocation l : locs) {
      assertEquals("Expected two replicas for each block",2,l.getHosts().length);
      assertEquals("Expected two VolumeIDs for each block",2,l.getVolumeIds().length);
      assertTrue("Expected one valid and one invalid volume",(l.getVolumeIds()[0] == null) ^ (l.getVolumeIds()[1] == null));
    }
    cluster.restartDataNode(stoppedNode,true);
    cluster.waitActive();
    fs.delete(tmpFile2,true);
    HATestUtil.waitForNNToIssueDeletions(cluster.getNameNode());
    cluster.triggerHeartbeats();
    HATestUtil.waitForDNDeletions(cluster);
    locs=fs.getFileBlockStorageLocations(allLocs);
    assertEquals("Expected two HdfsBlockLocations for two 1-block files",2,locs.length);
    assertNotNull(locs[0].getVolumeIds()[0]);
    assertNotNull(locs[0].getVolumeIds()[1]);
    assertNull(locs[1].getVolumeIds()[0]);
    assertNull(locs[1].getVolumeIds()[1]);
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestEncryptionZones </h4><pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getEncryptionZoneForPath as a non super user.
 */
@Test(timeout=60000) public void testGetEZAsNonSuperUser() throws Exception {
  final UserGroupInformation user=UserGroupInformation.createUserForTesting("user",new String[]{"mygroup"});
  final Path testRoot=new Path(fsHelper.getTestRootDir());
  final Path superPath=new Path(testRoot,"superuseronly");
  final Path superPathFile=new Path(superPath,"file1");
  final Path allPath=new Path(testRoot,"accessall");
  final Path allPathFile=new Path(allPath,"file1");
  final Path nonEZDir=new Path(testRoot,"nonEZDir");
  final Path nonEZFile=new Path(nonEZDir,"file1");
  final int len=8192;
  fsWrapper.mkdir(testRoot,new FsPermission((short)0777),true);
  fsWrapper.mkdir(superPath,new FsPermission((short)0700),false);
  fsWrapper.mkdir(allPath,new FsPermission((short)0777),false);
  fsWrapper.mkdir(nonEZDir,new FsPermission((short)0777),false);
  dfsAdmin.createEncryptionZone(superPath,TEST_KEY);
  dfsAdmin.createEncryptionZone(allPath,TEST_KEY);
  dfsAdmin.allowSnapshot(new Path("/"));
  final Path newSnap=fs.createSnapshot(new Path("/"));
  DFSTestUtil.createFile(fs,superPathFile,len,(short)1,0xFEED);
  DFSTestUtil.createFile(fs,allPathFile,len,(short)1,0xFEED);
  DFSTestUtil.createFile(fs,nonEZFile,len,(short)1,0xFEED);
  user.doAs(new PrivilegedExceptionAction(){
    @Override public Object run() throws Exception {
      final HdfsAdmin userAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
      try {
        userAdmin.getEncryptionZoneForPath(null);
        fail("should have thrown NPE");
      }
 catch (      NullPointerException e) {
      }
      assertEquals("expected ez path",allPath.toString(),userAdmin.getEncryptionZoneForPath(allPath).getPath().toString());
      assertEquals("expected ez path",allPath.toString(),userAdmin.getEncryptionZoneForPath(allPathFile).getPath().toString());
      try {
        userAdmin.getEncryptionZoneForPath(superPathFile);
        fail("expected AccessControlException");
      }
 catch (      AccessControlException e) {
        assertExceptionContains("Permission denied:",e);
      }
      assertNull("expected null for non-ez path",userAdmin.getEncryptionZoneForPath(nonEZDir));
      assertNull("expected null for non-ez path",userAdmin.getEncryptionZoneForPath(nonEZFile));
      String snapshottedAllPath=newSnap.toString() + allPath.toString();
      assertEquals("expected ez path",allPath.toString(),userAdmin.getEncryptionZoneForPath(new Path(snapshottedAllPath)).getPath().toString());
      fs.delete(allPathFile,false);
      assertEquals("expected ez path",allPath.toString(),userAdmin.getEncryptionZoneForPath(new Path(snapshottedAllPath)).getPath().toString());
      fs.delete(allPath,true);
      assertEquals("expected ez path",allPath.toString(),userAdmin.getEncryptionZoneForPath(new Path(snapshottedAllPath)).getPath().toString());
      assertNull("expected null for deleted file path",userAdmin.getEncryptionZoneForPath(allPathFile));
      assertNull("expected null for deleted directory path",userAdmin.getEncryptionZoneForPath(allPath));
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestFileAppend4 </h4><pre class="type-9 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case that stops a writer after finalizing a block but
 * before calling completeFile, and then tries to recover
 * the lease from another thread.
 */
@Test(timeout=60000) public void testRecoverFinalizedBlock() throws Throwable {
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(5).build();
  try {
    cluster.waitActive();
    NamenodeProtocols preSpyNN=cluster.getNameNodeRpc();
    NamenodeProtocols spyNN=spy(preSpyNN);
    GenericTestUtils.DelayAnswer delayer=new GenericTestUtils.DelayAnswer(LOG);
    doAnswer(delayer).when(spyNN).complete(anyString(),anyString(),(ExtendedBlock)anyObject(),anyLong());
    DFSClient client=new DFSClient(null,spyNN,conf,null);
    file1=new Path("/testRecoverFinalized");
    final OutputStream stm=client.create("/testRecoverFinalized",true);
    AppendTestUtil.write(stm,0,4096);
    final AtomicReference<Throwable> err=new AtomicReference<Throwable>();
    Thread t=new Thread(){
      @Override public void run(){
        try {
          stm.close();
        }
 catch (        Throwable t) {
          err.set(t);
        }
      }
    }
;
    t.start();
    LOG.info("Waiting for close to get to latch...");
    delayer.waitForCall();
    LOG.info("Killing lease checker");
    client.getLeaseRenewer().interruptAndJoin();
    FileSystem fs1=cluster.getFileSystem();
    FileSystem fs2=AppendTestUtil.createHdfsWithDifferentUsername(fs1.getConf());
    LOG.info("Recovering file");
    recoverFile(fs2);
    LOG.info("Telling close to proceed.");
    delayer.proceed();
    LOG.info("Waiting for close to finish.");
    t.join();
    LOG.info("Close finished.");
    Throwable thrownByClose=err.get();
    assertNotNull(thrownByClose);
    assertTrue(thrownByClose instanceof IOException);
    if (!thrownByClose.getMessage().contains("No lease on /testRecoverFinalized"))     throw thrownByClose;
  }
  finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case that stops a writer after finalizing a block but
 * before calling completeFile, recovers a file from another writer,
 * starts writing from that writer, and then has the old lease holder
 * call completeFile
 */
@Test(timeout=60000) public void testCompleteOtherLeaseHoldersFile() throws Throwable {
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(5).build();
  try {
    cluster.waitActive();
    NamenodeProtocols preSpyNN=cluster.getNameNodeRpc();
    NamenodeProtocols spyNN=spy(preSpyNN);
    GenericTestUtils.DelayAnswer delayer=new GenericTestUtils.DelayAnswer(LOG);
    doAnswer(delayer).when(spyNN).complete(anyString(),anyString(),(ExtendedBlock)anyObject(),anyLong());
    DFSClient client=new DFSClient(null,spyNN,conf,null);
    file1=new Path("/testCompleteOtherLease");
    final OutputStream stm=client.create("/testCompleteOtherLease",true);
    AppendTestUtil.write(stm,0,4096);
    final AtomicReference<Throwable> err=new AtomicReference<Throwable>();
    Thread t=new Thread(){
      @Override public void run(){
        try {
          stm.close();
        }
 catch (        Throwable t) {
          err.set(t);
        }
      }
    }
;
    t.start();
    LOG.info("Waiting for close to get to latch...");
    delayer.waitForCall();
    LOG.info("Killing lease checker");
    client.getLeaseRenewer().interruptAndJoin();
    FileSystem fs1=cluster.getFileSystem();
    FileSystem fs2=AppendTestUtil.createHdfsWithDifferentUsername(fs1.getConf());
    LOG.info("Recovering file");
    recoverFile(fs2);
    LOG.info("Opening file for append from new fs");
    FSDataOutputStream appenderStream=fs2.append(file1);
    LOG.info("Writing some data from new appender");
    AppendTestUtil.write(appenderStream,0,4096);
    LOG.info("Telling old close to proceed.");
    delayer.proceed();
    LOG.info("Waiting for close to finish.");
    t.join();
    LOG.info("Close finished.");
    Throwable thrownByClose=err.get();
    assertNotNull(thrownByClose);
    assertTrue(thrownByClose instanceof IOException);
    if (!thrownByClose.getMessage().contains("Lease mismatch"))     throw thrownByClose;
    appenderStream.close();
  }
  finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestFileConcurrentReader </h4><pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testImmediateReadOfNewFile() throws IOException {
  final int blockSize=64 * 1024;
  final int writeSize=10 * blockSize;
  Configuration conf=new Configuration();
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,blockSize);
  init(conf);
  final int requiredSuccessfulOpens=100;
  final Path file=new Path("/file1");
  final AtomicBoolean openerDone=new AtomicBoolean(false);
  final AtomicReference<String> errorMessage=new AtomicReference<String>();
  final FSDataOutputStream out=fileSystem.create(file);
  final Thread writer=new Thread(new Runnable(){
    @Override public void run(){
      try {
        while (!openerDone.get()) {
          out.write(DFSTestUtil.generateSequentialBytes(0,writeSize));
          out.hflush();
        }
      }
 catch (      IOException e) {
        LOG.warn("error in writer",e);
      }
 finally {
        try {
          out.close();
        }
 catch (        IOException e) {
          LOG.error("unable to close file");
        }
      }
    }
  }
);
  Thread opener=new Thread(new Runnable(){
    @Override public void run(){
      try {
        for (int i=0; i < requiredSuccessfulOpens; i++) {
          fileSystem.open(file).close();
        }
        openerDone.set(true);
      }
 catch (      IOException e) {
        openerDone.set(true);
        errorMessage.set(String.format("got exception : %s",StringUtils.stringifyException(e)));
      }
catch (      Exception e) {
        openerDone.set(true);
        errorMessage.set(String.format("got exception : %s",StringUtils.stringifyException(e)));
        writer.interrupt();
        fail("here");
      }
    }
  }
);
  writer.start();
  opener.start();
  try {
    writer.join();
    opener.join();
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
  }
  assertNull(errorMessage.get(),errorMessage.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestGetBlocks </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test if the datanodes returned by{@link ClientProtocol#getBlockLocations(String,long,long)} is correct
 * when stale nodes checking is enabled. Also test during the scenario when 1)
 * stale nodes checking is enabled, 2) a writing is going on, 3) a datanode
 * becomes stale happen simultaneously
 * @throws Exception
 */
@Test public void testReadSelectNonStaleDatanode() throws Exception {
  HdfsConfiguration conf=new HdfsConfiguration();
  conf.setBoolean(DFSConfigKeys.DFS_NAMENODE_AVOID_STALE_DATANODE_FOR_READ_KEY,true);
  long staleInterval=30 * 1000 * 60;
  conf.setLong(DFSConfigKeys.DFS_NAMENODE_STALE_DATANODE_INTERVAL_KEY,staleInterval);
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDatanodes).racks(racks).build();
  cluster.waitActive();
  InetSocketAddress addr=new InetSocketAddress("localhost",cluster.getNameNodePort());
  DFSClient client=new DFSClient(addr,conf);
  List<DatanodeDescriptor> nodeInfoList=cluster.getNameNode().getNamesystem().getBlockManager().getDatanodeManager().getDatanodeListForReport(DatanodeReportType.LIVE);
  assertEquals("Unexpected number of datanodes",numDatanodes,nodeInfoList.size());
  FileSystem fileSys=cluster.getFileSystem();
  FSDataOutputStream stm=null;
  try {
    final Path fileName=new Path("/file1");
    stm=fileSys.create(fileName,true,fileSys.getConf().getInt(CommonConfigurationKeys.IO_FILE_BUFFER_SIZE_KEY,4096),(short)3,blockSize);
    stm.write(new byte[(blockSize * 3) / 2]);
    stm.hflush();
    LocatedBlocks blocks=client.getNamenode().getBlockLocations(fileName.toString(),0,blockSize);
    DatanodeInfo[] nodes=blocks.get(0).getLocations();
    assertEquals(nodes.length,3);
    DataNode staleNode=null;
    DatanodeDescriptor staleNodeInfo=null;
    staleNode=this.stopDataNodeHeartbeat(cluster,nodes[0].getHostName());
    assertNotNull(staleNode);
    staleNodeInfo=cluster.getNameNode().getNamesystem().getBlockManager().getDatanodeManager().getDatanode(staleNode.getDatanodeId());
    staleNodeInfo.setLastUpdate(Time.now() - staleInterval - 1);
    LocatedBlocks blocksAfterStale=client.getNamenode().getBlockLocations(fileName.toString(),0,blockSize);
    DatanodeInfo[] nodesAfterStale=blocksAfterStale.get(0).getLocations();
    assertEquals(nodesAfterStale.length,3);
    assertEquals(nodesAfterStale[2].getHostName(),nodes[0].getHostName());
    DataNodeTestUtils.setHeartbeatsDisabledForTests(staleNode,false);
    staleNodeInfo.setLastUpdate(Time.now());
    LocatedBlock lastBlock=client.getLocatedBlocks(fileName.toString(),0,Long.MAX_VALUE).getLastLocatedBlock();
    nodes=lastBlock.getLocations();
    assertEquals(nodes.length,3);
    staleNode=this.stopDataNodeHeartbeat(cluster,nodes[0].getHostName());
    assertNotNull(staleNode);
    cluster.getNameNode().getNamesystem().getBlockManager().getDatanodeManager().getDatanode(staleNode.getDatanodeId()).setLastUpdate(Time.now() - staleInterval - 1);
    LocatedBlock lastBlockAfterStale=client.getLocatedBlocks(fileName.toString(),0,Long.MAX_VALUE).getLastLocatedBlock();
    nodesAfterStale=lastBlockAfterStale.getLocations();
    assertEquals(nodesAfterStale.length,3);
    assertEquals(nodesAfterStale[2].getHostName(),nodes[0].getHostName());
  }
  finally {
    if (stm != null) {
      stm.close();
    }
    if (client != null) {
      client.close();
    }
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.TestRollingUpgradeRollback </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRollbackCommand() throws Exception {
  final Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=null;
  final Path foo=new Path("/foo");
  final Path bar=new Path("/bar");
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(0).build();
    cluster.waitActive();
    final DistributedFileSystem dfs=cluster.getFileSystem();
    final DFSAdmin dfsadmin=new DFSAdmin(conf);
    dfs.mkdirs(foo);
    dfs.setSafeMode(SafeModeAction.SAFEMODE_ENTER);
    Assert.assertEquals(0,dfsadmin.run(new String[]{"-rollingUpgrade","prepare"}));
    dfs.setSafeMode(SafeModeAction.SAFEMODE_LEAVE);
    dfs.mkdirs(bar);
    NNStorage storage=cluster.getNamesystem().getFSImage().getStorage();
    checkNNStorage(storage,3,-1);
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
  NameNode nn=null;
  try {
    nn=NameNode.createNameNode(new String[]{"-rollingUpgrade","rollback"},conf);
    INode fooNode=nn.getNamesystem().getFSDirectory().getINode4Write(foo.toString());
    Assert.assertNotNull(fooNode);
    INode barNode=nn.getNamesystem().getFSDirectory().getINode4Write(bar.toString());
    Assert.assertNull(barNode);
    NNStorage storage=nn.getNamesystem().getFSImage().getStorage();
    checkNNStorage(storage,3,7);
  }
  finally {
    if (nn != null) {
      nn.stop();
      nn.join();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.qjournal.client.TestQuorumJournalManager </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReaderWhileAnotherWrites() throws Exception {
  QuorumJournalManager readerQjm=closeLater(createSpyingQJM());
  List<EditLogInputStream> streams=Lists.newArrayList();
  readerQjm.selectInputStreams(streams,0,false);
  assertEquals(0,streams.size());
  writeSegment(cluster,qjm,1,3,true);
  readerQjm.selectInputStreams(streams,0,false);
  try {
    assertEquals(1,streams.size());
    EditLogInputStream stream=streams.get(0);
    assertEquals(1,stream.getFirstTxId());
    assertEquals(3,stream.getLastTxId());
    verifyEdits(streams,1,3);
    assertNull(stream.readOp());
  }
  finally {
    IOUtils.cleanup(LOG,streams.toArray(new Closeable[0]));
    streams.clear();
  }
  writeSegment(cluster,qjm,4,3,false);
  readerQjm.selectInputStreams(streams,0,false);
  try {
    assertEquals(1,streams.size());
    EditLogInputStream stream=streams.get(0);
    assertEquals(1,stream.getFirstTxId());
    assertEquals(3,stream.getLastTxId());
    verifyEdits(streams,1,3);
  }
  finally {
    IOUtils.cleanup(LOG,streams.toArray(new Closeable[0]));
    streams.clear();
  }
  qjm.finalizeLogSegment(4,6);
  readerQjm.selectInputStreams(streams,0,false);
  try {
    assertEquals(2,streams.size());
    assertEquals(4,streams.get(1).getFirstTxId());
    assertEquals(6,streams.get(1).getLastTxId());
    verifyEdits(streams,1,6);
  }
  finally {
    IOUtils.cleanup(LOG,streams.toArray(new Closeable[0]));
    streams.clear();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.blockmanagement.TestBlockInfo </h4><pre class="type-9 type-13 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBlockListMoveToHead() throws Exception {
  LOG.info("BlockInfo moveToHead tests...");
  final int MAX_BLOCKS=10;
  DatanodeStorageInfo dd=DFSTestUtil.createDatanodeStorageInfo("s1","1.1.1.1");
  ArrayList<Block> blockList=new ArrayList<Block>(MAX_BLOCKS);
  ArrayList<BlockInfo> blockInfoList=new ArrayList<BlockInfo>();
  int headIndex;
  int curIndex;
  LOG.info("Building block list...");
  for (int i=0; i < MAX_BLOCKS; i++) {
    blockList.add(new Block(i,0,GenerationStamp.LAST_RESERVED_STAMP));
    blockInfoList.add(new BlockInfo(blockList.get(i),3));
    dd.addBlock(blockInfoList.get(i));
    assertEquals("Find datanode should be 0",0,blockInfoList.get(i).findStorageInfo(dd));
  }
  LOG.info("Checking list length...");
  assertEquals("Length should be MAX_BLOCK",MAX_BLOCKS,dd.numBlocks());
  Iterator<BlockInfo> it=dd.getBlockIterator();
  int len=0;
  while (it.hasNext()) {
    it.next();
    len++;
  }
  assertEquals("There should be MAX_BLOCK blockInfo's",MAX_BLOCKS,len);
  headIndex=dd.getBlockListHeadForTesting().findStorageInfo(dd);
  LOG.info("Moving each block to the head of the list...");
  for (int i=0; i < MAX_BLOCKS; i++) {
    curIndex=blockInfoList.get(i).findStorageInfo(dd);
    headIndex=dd.moveBlockToHead(blockInfoList.get(i),curIndex,headIndex);
    assertEquals("Block should be at the head of the list now.",blockInfoList.get(i),dd.getBlockListHeadForTesting());
  }
  LOG.info("Moving head to the head...");
  BlockInfo temp=dd.getBlockListHeadForTesting();
  curIndex=0;
  headIndex=0;
  dd.moveBlockToHead(temp,curIndex,headIndex);
  assertEquals("Moving head to the head of the list shopuld not change the list",temp,dd.getBlockListHeadForTesting());
  LOG.info("Checking elements of the list...");
  temp=dd.getBlockListHeadForTesting();
  assertNotNull("Head should not be null",temp);
  int c=MAX_BLOCKS - 1;
  while (temp != null) {
    assertEquals("Expected element is not on the list",blockInfoList.get(c--),temp);
    temp=temp.getNext(0);
  }
  LOG.info("Moving random blocks to the head of the list...");
  headIndex=dd.getBlockListHeadForTesting().findStorageInfo(dd);
  Random rand=new Random();
  for (int i=0; i < MAX_BLOCKS; i++) {
    int j=rand.nextInt(MAX_BLOCKS);
    curIndex=blockInfoList.get(j).findStorageInfo(dd);
    headIndex=dd.moveBlockToHead(blockInfoList.get(j),curIndex,headIndex);
    assertEquals("Block should be at the head of the list now.",blockInfoList.get(j),dd.getBlockListHeadForTesting());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.blockmanagement.TestBlockManager </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test that a source node for a highest-priority replication is chosen even if all available
 * source nodes have reached their replication limits.
 */
@Test public void testHighestPriReplSrcChosenDespiteMaxReplLimit() throws Exception {
  bm.maxReplicationStreams=0;
  bm.replicationStreamsHardLimit=1;
  long blockId=42;
  Block aBlock=new Block(blockId,0,0);
  List<DatanodeDescriptor> origNodes=getNodes(0,1);
  addBlockOnNodes(blockId,origNodes.subList(0,1));
  List<DatanodeDescriptor> cntNodes=new LinkedList<DatanodeDescriptor>();
  List<DatanodeStorageInfo> liveNodes=new LinkedList<DatanodeStorageInfo>();
  assertNotNull("Chooses source node for a highest-priority replication" + " even if all available source nodes have reached their replication" + " limits below the hard limit.",bm.chooseSourceDatanode(aBlock,cntNodes,liveNodes,new NumberReplicas(),UnderReplicatedBlocks.QUEUE_HIGHEST_PRIORITY));
  assertNull("Does not choose a source node for a less-than-highest-priority" + " replication since all available source nodes have reached" + " their replication limits.",bm.chooseSourceDatanode(aBlock,cntNodes,liveNodes,new NumberReplicas(),UnderReplicatedBlocks.QUEUE_VERY_UNDER_REPLICATED));
  DatanodeStorageInfo targets[]={origNodes.get(1).getStorageInfos()[0]};
  origNodes.get(0).addBlockToBeReplicated(aBlock,targets);
  assertNull("Does not choose a source node for a highest-priority" + " replication when all available nodes exceed the hard limit.",bm.chooseSourceDatanode(aBlock,cntNodes,liveNodes,new NumberReplicas(),UnderReplicatedBlocks.QUEUE_HIGHEST_PRIORITY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.blockmanagement.TestCorruptReplicaInfo </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorruptReplicaInfo() throws IOException, InterruptedException {
  CorruptReplicasMap crm=new CorruptReplicasMap();
  assertEquals("Number of corrupt blocks must initially be 0",0,crm.size());
  assertNull("Param n cannot be less than 0",crm.getCorruptReplicaBlockIds(-1,null));
  assertNull("Param n cannot be greater than 100",crm.getCorruptReplicaBlockIds(101,null));
  long[] l=crm.getCorruptReplicaBlockIds(0,null);
  assertNotNull("n = 0 must return non-null",l);
  assertEquals("n = 0 must return an empty list",0,l.length);
  int NUM_BLOCK_IDS=140;
  List<Long> block_ids=new LinkedList<Long>();
  for (int i=0; i < NUM_BLOCK_IDS; i++) {
    block_ids.add((long)i);
  }
  DatanodeDescriptor dn1=DFSTestUtil.getLocalDatanodeDescriptor();
  DatanodeDescriptor dn2=DFSTestUtil.getLocalDatanodeDescriptor();
  addToCorruptReplicasMap(crm,getBlock(0),dn1);
  assertEquals("Number of corrupt blocks not returning correctly",1,crm.size());
  addToCorruptReplicasMap(crm,getBlock(1),dn1);
  assertEquals("Number of corrupt blocks not returning correctly",2,crm.size());
  addToCorruptReplicasMap(crm,getBlock(1),dn2);
  assertEquals("Number of corrupt blocks not returning correctly",2,crm.size());
  crm.removeFromCorruptReplicasMap(getBlock(1));
  assertEquals("Number of corrupt blocks not returning correctly",1,crm.size());
  crm.removeFromCorruptReplicasMap(getBlock(0));
  assertEquals("Number of corrupt blocks not returning correctly",0,crm.size());
  for (  Long block_id : block_ids) {
    addToCorruptReplicasMap(crm,getBlock(block_id),dn1);
  }
  assertEquals("Number of corrupt blocks not returning correctly",NUM_BLOCK_IDS,crm.size());
  assertTrue("First five block ids not returned correctly ",Arrays.equals(new long[]{0,1,2,3,4},crm.getCorruptReplicaBlockIds(5,null)));
  LOG.info(crm.getCorruptReplicaBlockIds(10,7L));
  LOG.info(block_ids.subList(7,18));
  assertTrue("10 blocks after 7 not returned correctly ",Arrays.equals(new long[]{8,9,10,11,12,13,14,15,16,17},crm.getCorruptReplicaBlockIds(10,7L)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.blockmanagement.TestHost2NodesMap </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove() throws Exception {
  DatanodeDescriptor nodeNotInMap=DFSTestUtil.getDatanodeDescriptor("3.3.3.3","/d1/r4");
  assertFalse(map.remove(nodeNotInMap));
  assertTrue(map.remove(dataNodes[0]));
  assertTrue(map.getDatanodeByHost("1.1.1.1.") == null);
  assertTrue(map.getDatanodeByHost("2.2.2.2") == dataNodes[1]);
  DatanodeDescriptor node=map.getDatanodeByHost("3.3.3.3");
  assertTrue(node == dataNodes[2] || node == dataNodes[3]);
  assertNull(map.getDatanodeByHost("4.4.4.4"));
  assertTrue(map.remove(dataNodes[2]));
  assertNull(map.getDatanodeByHost("1.1.1.1"));
  assertEquals(map.getDatanodeByHost("2.2.2.2"),dataNodes[1]);
  assertEquals(map.getDatanodeByHost("3.3.3.3"),dataNodes[3]);
  assertTrue(map.remove(dataNodes[3]));
  assertNull(map.getDatanodeByHost("1.1.1.1"));
  assertEquals(map.getDatanodeByHost("2.2.2.2"),dataNodes[1]);
  assertNull(map.getDatanodeByHost("3.3.3.3"));
  assertFalse(map.remove(null));
  assertTrue(map.remove(dataNodes[1]));
  assertFalse(map.remove(dataNodes[1]));
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDatanodeByHost() throws Exception {
  assertEquals(map.getDatanodeByHost("1.1.1.1"),dataNodes[0]);
  assertEquals(map.getDatanodeByHost("2.2.2.2"),dataNodes[1]);
  DatanodeDescriptor node=map.getDatanodeByHost("3.3.3.3");
  assertTrue(node == dataNodes[2] || node == dataNodes[3]);
  assertNull(map.getDatanodeByHost("4.4.4.4"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.blockmanagement.TestPendingDataNodeMessages </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueues(){
  DatanodeDescriptor fakeDN=DFSTestUtil.getLocalDatanodeDescriptor();
  DatanodeStorage storage=new DatanodeStorage("STORAGE_ID");
  DatanodeStorageInfo storageInfo=new DatanodeStorageInfo(fakeDN,storage);
  msgs.enqueueReportedBlock(storageInfo,block1Gs1,ReplicaState.FINALIZED);
  msgs.enqueueReportedBlock(storageInfo,block1Gs2,ReplicaState.FINALIZED);
  assertEquals(2,msgs.count());
  assertNull(msgs.takeBlockQueue(block2Gs1));
  assertEquals(2,msgs.count());
  Queue<ReportedBlockInfo> q=msgs.takeBlockQueue(block1Gs2DifferentInstance);
  assertEquals("ReportedBlockInfo [block=blk_1_1, dn=127.0.0.1:50010, reportedState=FINALIZED]," + "ReportedBlockInfo [block=blk_1_2, dn=127.0.0.1:50010, reportedState=FINALIZED]",Joiner.on(",").join(q));
  assertEquals(0,msgs.count());
  assertNull(msgs.takeBlockQueue(block1Gs1));
  assertEquals(0,msgs.count());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.blockmanagement.TestReplicationPolicy </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * In this testcase, it tries to choose more targets than available nodes and
 * check the result. 
 * @throws Exception
 */
@Test public void testChooseTargetWithMoreThanAvailableNodes() throws Exception {
  for (int i=0; i < 2; i++) {
    updateHeartbeatWithUsage(dataNodes[i],2 * HdfsConstants.MIN_BLOCKS_FOR_WRITE * BLOCK_SIZE,0L,(HdfsConstants.MIN_BLOCKS_FOR_WRITE - 1) * BLOCK_SIZE,0L,0L,0L,0,0);
  }
  final LogVerificationAppender appender=new LogVerificationAppender();
  final Logger logger=Logger.getRootLogger();
  logger.addAppender(appender);
  DatanodeStorageInfo[] targets=chooseTarget(NUM_OF_DATANODES);
  assertEquals(targets.length,NUM_OF_DATANODES - 2);
  final List<LoggingEvent> log=appender.getLog();
  assertNotNull(log);
  assertFalse(log.size() == 0);
  final LoggingEvent lastLogEntry=log.get(log.size() - 1);
  assertTrue(Level.WARN.isGreaterOrEqual(lastLogEntry.getLevel()));
  assertTrue(((String)lastLogEntry.getMessage()).contains("in need of 2"));
  for (int i=0; i < 2; i++) {
    updateHeartbeatWithUsage(dataNodes[i],2 * HdfsConstants.MIN_BLOCKS_FOR_WRITE * BLOCK_SIZE,0L,HdfsConstants.MIN_BLOCKS_FOR_WRITE * BLOCK_SIZE,0L,0L,0L,0,0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.common.TestGetUriFromString </h4><pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
/** 
 * Test for a relative path, os independent
 * @throws IOException 
 */
@Test public void testRelativePathAsURI() throws IOException {
  URI u=Util.stringAsURI(RELATIVE_FILE_PATH);
  LOG.info("Uri: " + u);
  assertNotNull(u);
}

</code></pre>

<br>
<pre class="type-9 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for an OS dependent absolute paths.
 * @throws IOException 
 */
@Test public void testAbsolutePathAsURI() throws IOException {
  URI u=null;
  u=Util.stringAsURI(ABSOLUTE_PATH_WINDOWS);
  assertNotNull("Uri should not be null for Windows path" + ABSOLUTE_PATH_WINDOWS,u);
  assertEquals(URI_FILE_SCHEMA,u.getScheme());
  u=Util.stringAsURI(ABSOLUTE_PATH_UNIX);
  assertNotNull("Uri should not be null for Unix path" + ABSOLUTE_PATH_UNIX,u);
  assertEquals(URI_FILE_SCHEMA,u.getScheme());
}

</code></pre>

<br>
<pre class="type-9 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for a URI
 * @throws IOException 
 */
@Test public void testURI() throws IOException {
  LOG.info("Testing correct Unix URI: " + URI_UNIX);
  URI u=Util.stringAsURI(URI_UNIX);
  LOG.info("Uri: " + u);
  assertNotNull("Uri should not be null at this point",u);
  assertEquals(URI_FILE_SCHEMA,u.getScheme());
  assertEquals(URI_PATH_UNIX,u.getPath());
  LOG.info("Testing correct windows URI: " + URI_WINDOWS);
  u=Util.stringAsURI(URI_WINDOWS);
  LOG.info("Uri: " + u);
  assertNotNull("Uri should not be null at this point",u);
  assertEquals(URI_FILE_SCHEMA,u.getScheme());
  assertEquals(URI_PATH_WINDOWS.replace("%20"," "),u.getPath());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.common.TestJspHelper </h4><pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetUgiFromToken() throws IOException {
  conf.set(DFSConfigKeys.FS_DEFAULT_NAME_KEY,"hdfs://localhost:4321/");
  ServletContext context=mock(ServletContext.class);
  String realUser="TheDoctor";
  String user="TheNurse";
  conf.set(DFSConfigKeys.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  UserGroupInformation.setConfiguration(conf);
  UserGroupInformation ugi;
  HttpServletRequest request;
  Text ownerText=new Text(user);
  DelegationTokenIdentifier dtId=new DelegationTokenIdentifier(ownerText,ownerText,new Text(realUser));
  Token<DelegationTokenIdentifier> token=new Token<DelegationTokenIdentifier>(dtId,new DummySecretManager(0,0,0,0));
  String tokenString=token.encodeToUrlString();
  request=getMockRequest(null,null,null);
  when(request.getParameter(JspHelper.DELEGATION_PARAMETER_NAME)).thenReturn(tokenString);
  ugi=JspHelper.getUGI(context,request,conf);
  Assert.assertNotNull(ugi.getRealUser());
  Assert.assertEquals(ugi.getRealUser().getShortUserName(),realUser);
  Assert.assertEquals(ugi.getShortUserName(),user);
  checkUgiFromToken(ugi);
  request=getMockRequest(realUser,null,null);
  when(request.getParameter(JspHelper.DELEGATION_PARAMETER_NAME)).thenReturn(tokenString);
  ugi=JspHelper.getUGI(context,request,conf);
  Assert.assertNotNull(ugi.getRealUser());
  Assert.assertEquals(ugi.getRealUser().getShortUserName(),realUser);
  Assert.assertEquals(ugi.getShortUserName(),user);
  checkUgiFromToken(ugi);
  request=getMockRequest("rogue",null,null);
  when(request.getParameter(JspHelper.DELEGATION_PARAMETER_NAME)).thenReturn(tokenString);
  ugi=JspHelper.getUGI(context,request,conf);
  Assert.assertNotNull(ugi.getRealUser());
  Assert.assertEquals(ugi.getRealUser().getShortUserName(),realUser);
  Assert.assertEquals(ugi.getShortUserName(),user);
  checkUgiFromToken(ugi);
  request=getMockRequest(null,user,null);
  when(request.getParameter(JspHelper.DELEGATION_PARAMETER_NAME)).thenReturn(tokenString);
  ugi=JspHelper.getUGI(context,request,conf);
  Assert.assertNotNull(ugi.getRealUser());
  Assert.assertEquals(ugi.getRealUser().getShortUserName(),realUser);
  Assert.assertEquals(ugi.getShortUserName(),user);
  checkUgiFromToken(ugi);
  request=getMockRequest(null,null,"rogue");
  when(request.getParameter(JspHelper.DELEGATION_PARAMETER_NAME)).thenReturn(tokenString);
  try {
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad request allowed");
  }
 catch (  IOException ioe) {
    Assert.assertEquals("Usernames not matched: name=rogue != expected=" + user,ioe.getMessage());
  }
  request=getMockRequest(null,user,"rogue");
  when(request.getParameter(JspHelper.DELEGATION_PARAMETER_NAME)).thenReturn(tokenString);
  try {
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad request allowed");
  }
 catch (  IOException ioe) {
    Assert.assertEquals("Usernames not matched: name=rogue != expected=" + user,ioe.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNonProxyUgi() throws IOException {
  conf.set(DFSConfigKeys.FS_DEFAULT_NAME_KEY,"hdfs://localhost:4321/");
  ServletContext context=mock(ServletContext.class);
  String realUser="TheDoctor";
  String user="TheNurse";
  conf.set(DFSConfigKeys.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  UserGroupInformation.setConfiguration(conf);
  UserGroupInformation ugi;
  HttpServletRequest request;
  request=getMockRequest(null,null,null);
  try {
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad request allowed");
  }
 catch (  IOException ioe) {
    Assert.assertEquals("Security enabled but user not authenticated by filter",ioe.getMessage());
  }
  request=getMockRequest(null,realUser,null);
  try {
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad request allowed");
  }
 catch (  IOException ioe) {
    Assert.assertEquals("Security enabled but user not authenticated by filter",ioe.getMessage());
  }
  request=getMockRequest(realUser,null,null);
  ugi=JspHelper.getUGI(context,request,conf);
  Assert.assertNull(ugi.getRealUser());
  Assert.assertEquals(ugi.getShortUserName(),realUser);
  checkUgiFromAuth(ugi);
  request=getMockRequest(realUser,realUser,null);
  ugi=JspHelper.getUGI(context,request,conf);
  Assert.assertNull(ugi.getRealUser());
  Assert.assertEquals(ugi.getShortUserName(),realUser);
  checkUgiFromAuth(ugi);
  request=getMockRequest(realUser,user,null);
  try {
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad request allowed");
  }
 catch (  IOException ioe) {
    Assert.assertEquals("Usernames not matched: name=" + user + " != expected="+ realUser,ioe.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProxyUgi() throws IOException {
  conf.set(DFSConfigKeys.FS_DEFAULT_NAME_KEY,"hdfs://localhost:4321/");
  ServletContext context=mock(ServletContext.class);
  String realUser="TheDoctor";
  String user="TheNurse";
  conf.set(DFSConfigKeys.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  conf.set(DefaultImpersonationProvider.getTestProvider().getProxySuperuserGroupConfKey(realUser),"*");
  conf.set(DefaultImpersonationProvider.getTestProvider().getProxySuperuserIpConfKey(realUser),"*");
  ProxyUsers.refreshSuperUserGroupsConfiguration(conf);
  UserGroupInformation.setConfiguration(conf);
  UserGroupInformation ugi;
  HttpServletRequest request;
  request=getMockRequest(null,null,user);
  try {
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad request allowed");
  }
 catch (  IOException ioe) {
    Assert.assertEquals("Security enabled but user not authenticated by filter",ioe.getMessage());
  }
  request=getMockRequest(null,realUser,user);
  try {
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad request allowed");
  }
 catch (  IOException ioe) {
    Assert.assertEquals("Security enabled but user not authenticated by filter",ioe.getMessage());
  }
  request=getMockRequest(realUser,null,user);
  ugi=JspHelper.getUGI(context,request,conf);
  Assert.assertNotNull(ugi.getRealUser());
  Assert.assertEquals(ugi.getRealUser().getShortUserName(),realUser);
  Assert.assertEquals(ugi.getShortUserName(),user);
  checkUgiFromAuth(ugi);
  request=getMockRequest(realUser,realUser,user);
  ugi=JspHelper.getUGI(context,request,conf);
  Assert.assertNotNull(ugi.getRealUser());
  Assert.assertEquals(ugi.getRealUser().getShortUserName(),realUser);
  Assert.assertEquals(ugi.getShortUserName(),user);
  checkUgiFromAuth(ugi);
  request=getMockRequest(realUser,user,user);
  try {
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad request allowed");
  }
 catch (  IOException ioe) {
    Assert.assertEquals("Usernames not matched: name=" + user + " != expected="+ realUser,ioe.getMessage());
  }
  try {
    request=getMockRequest(user,null,realUser);
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad proxy request allowed");
  }
 catch (  AuthorizationException ae) {
    Assert.assertEquals("User: " + user + " is not allowed to impersonate "+ realUser,ae.getMessage());
  }
  try {
    request=getMockRequest(user,user,realUser);
    JspHelper.getUGI(context,request,conf);
    Assert.fail("bad proxy request allowed");
  }
 catch (  AuthorizationException ae) {
    Assert.assertEquals("User: " + user + " is not allowed to impersonate "+ realUser,ae.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestBPOfferService </h4><pre class="type-9 type-7 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the DataNode determines the active NameNode correctly
 * based on the HA-related information in heartbeat responses.
 * See HDFS-2627.
 */
@Test public void testPickActiveNameNode() throws Exception {
  BPOfferService bpos=setupBPOSForNNs(mockNN1,mockNN2);
  bpos.start();
  try {
    waitForInitialization(bpos);
    assertNull(bpos.getActiveNN());
    mockHaStatuses[0]=new NNHAStatusHeartbeat(HAServiceState.ACTIVE,1);
    bpos.triggerHeartbeatForTests();
    assertSame(mockNN1,bpos.getActiveNN());
    mockHaStatuses[1]=new NNHAStatusHeartbeat(HAServiceState.ACTIVE,2);
    bpos.triggerHeartbeatForTests();
    assertSame(mockNN2,bpos.getActiveNN());
    bpos.triggerHeartbeatForTests();
    assertSame(mockNN2,bpos.getActiveNN());
    mockHaStatuses[1]=new NNHAStatusHeartbeat(HAServiceState.STANDBY,2);
    bpos.triggerHeartbeatForTests();
    assertNull(bpos.getActiveNN());
    mockHaStatuses[0]=new NNHAStatusHeartbeat(HAServiceState.ACTIVE,3);
    bpos.triggerHeartbeatForTests();
    assertSame(mockNN1,bpos.getActiveNN());
  }
  finally {
    bpos.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestCachingStrategy </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test(timeout=120000) public void testFadviseAfterWriteThenRead() throws Exception {
  LOG.info("testFadviseAfterWriteThenRead");
  tracker.clear();
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=null;
  String TEST_PATH="/test";
  int TEST_PATH_LEN=MAX_TEST_FILE_LEN;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
    cluster.waitActive();
    FileSystem fs=cluster.getFileSystem();
    createHdfsFile(fs,new Path(TEST_PATH),TEST_PATH_LEN,true);
    ExtendedBlock block=cluster.getNameNode().getRpcServer().getBlockLocations(TEST_PATH,0,Long.MAX_VALUE).get(0).getBlock();
    String fadvisedFileName=MiniDFSCluster.getBlockFile(0,block).getName();
    Stats stats=tracker.getStats(fadvisedFileName);
    stats.assertDroppedInRange(0,TEST_PATH_LEN - WRITE_PACKET_SIZE);
    stats.clear();
    readHdfsFile(fs,new Path(TEST_PATH),Long.MAX_VALUE,true);
    Assert.assertNotNull(stats);
    stats.assertDroppedInRange(0,TEST_PATH_LEN - WRITE_PACKET_SIZE);
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test(timeout=120000) public void testNoFadviseAfterWriteThenRead() throws Exception {
  LOG.info("testNoFadviseAfterWriteThenRead");
  tracker.clear();
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=null;
  String TEST_PATH="/test";
  int TEST_PATH_LEN=MAX_TEST_FILE_LEN;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
    cluster.waitActive();
    FileSystem fs=cluster.getFileSystem();
    createHdfsFile(fs,new Path(TEST_PATH),TEST_PATH_LEN,false);
    ExtendedBlock block=cluster.getNameNode().getRpcServer().getBlockLocations(TEST_PATH,0,Long.MAX_VALUE).get(0).getBlock();
    String fadvisedFileName=MiniDFSCluster.getBlockFile(0,block).getName();
    Stats stats=tracker.getStats(fadvisedFileName);
    Assert.assertNull(stats);
    readHdfsFile(fs,new Path(TEST_PATH),Long.MAX_VALUE,false);
    Assert.assertNull(stats);
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test the scenario where the DataNode defaults to not dropping the cache,
 * but our client defaults are set.
 */
@Test(timeout=120000) public void testClientDefaults() throws Exception {
  LOG.info("testClientDefaults");
  tracker.clear();
  Configuration conf=new HdfsConfiguration();
  conf.setBoolean(DFSConfigKeys.DFS_DATANODE_DROP_CACHE_BEHIND_READS_KEY,false);
  conf.setBoolean(DFSConfigKeys.DFS_DATANODE_DROP_CACHE_BEHIND_WRITES_KEY,false);
  conf.setBoolean(DFSConfigKeys.DFS_CLIENT_CACHE_DROP_BEHIND_READS,true);
  conf.setBoolean(DFSConfigKeys.DFS_CLIENT_CACHE_DROP_BEHIND_WRITES,true);
  MiniDFSCluster cluster=null;
  String TEST_PATH="/test";
  int TEST_PATH_LEN=MAX_TEST_FILE_LEN;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
    cluster.waitActive();
    FileSystem fs=cluster.getFileSystem();
    createHdfsFile(fs,new Path(TEST_PATH),TEST_PATH_LEN,null);
    ExtendedBlock block=cluster.getNameNode().getRpcServer().getBlockLocations(TEST_PATH,0,Long.MAX_VALUE).get(0).getBlock();
    String fadvisedFileName=MiniDFSCluster.getBlockFile(0,block).getName();
    Stats stats=tracker.getStats(fadvisedFileName);
    stats.assertDroppedInRange(0,TEST_PATH_LEN - WRITE_PACKET_SIZE);
    stats.clear();
    readHdfsFile(fs,new Path(TEST_PATH),Long.MAX_VALUE,null);
    Assert.assertNotNull(stats);
    stats.assertDroppedInRange(0,TEST_PATH_LEN - WRITE_PACKET_SIZE);
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestDataNodeMetrics </h4><pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that round-trip acks in a datanode write pipeline are correctly 
 * measured. 
 */
@Test public void testRoundTripAckMetric() throws Exception {
  final int datanodeCount=2;
  final int interval=1;
  Configuration conf=new HdfsConfiguration();
  conf.set(DFSConfigKeys.DFS_METRICS_PERCENTILES_INTERVALS_KEY,"" + interval);
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(datanodeCount).build();
  try {
    cluster.waitActive();
    FileSystem fs=cluster.getFileSystem();
    Path testFile=new Path("/testRoundTripAckMetric.txt");
    FSDataOutputStream fsout=fs.create(testFile,(short)datanodeCount);
    DFSOutputStream dout=(DFSOutputStream)fsout.getWrappedStream();
    dout.setChunksPerPacket(5);
    dout.setArtificialSlowdown(3000);
    fsout.write(new byte[10000]);
    DatanodeInfo[] pipeline=null;
    int count=0;
    while (pipeline == null && count < 5) {
      pipeline=dout.getPipeline();
      System.out.println("Waiting for pipeline to be created.");
      Thread.sleep(1000);
      count++;
    }
    DatanodeInfo headInfo=pipeline[0];
    DataNode headNode=null;
    for (    DataNode datanode : cluster.getDataNodes()) {
      if (datanode.getDatanodeId().equals(headInfo)) {
        headNode=datanode;
        break;
      }
    }
    assertNotNull("Could not find the head of the datanode write pipeline",headNode);
    Thread.sleep((interval + 1) * 1000);
    MetricsRecordBuilder dnMetrics=getMetrics(headNode.getMetrics().name());
    assertTrue("Expected non-zero number of acks",getLongCounter("PacketAckRoundTripTimeNanosNumOps",dnMetrics) > 0);
    assertQuantileGauges("PacketAckRoundTripTimeNanos" + interval + "s",dnMetrics);
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestDataNodeMultipleRegistrations </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * starts single nn and single dn and verifies registration and handshake
 * @throws IOException
 */
@Test public void testFedSingleNN() throws IOException {
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).nameNodePort(9927).build();
  try {
    NameNode nn1=cluster.getNameNode();
    assertNotNull("cannot create nn1",nn1);
    String bpid1=FSImageTestUtil.getFSImage(nn1).getBlockPoolID();
    String cid1=FSImageTestUtil.getFSImage(nn1).getClusterID();
    int lv1=FSImageTestUtil.getFSImage(nn1).getLayoutVersion();
    LOG.info("nn1: lv=" + lv1 + ";cid="+ cid1+ ";bpid="+ bpid1+ ";uri="+ nn1.getNameNodeAddress());
    DataNode dn=cluster.getDataNodes().get(0);
    final Map<String,Object> volInfos=dn.data.getVolumeInfoMap();
    Assert.assertTrue("No volumes in the fsdataset",volInfos.size() > 0);
    int i=0;
    for (    Map.Entry<String,Object> e : volInfos.entrySet()) {
      LOG.info("vol " + i++ + ") "+ e.getKey()+ ": "+ e.getValue());
    }
    assertEquals("number of volumes is wrong",2,volInfos.size());
    for (    BPOfferService bpos : dn.getAllBpOs()) {
      LOG.info("reg: bpid=" + "; name=" + bpos.bpRegistration + "; sid="+ bpos.bpRegistration.getDatanodeUuid()+ "; nna="+ getNNSocketAddress(bpos));
    }
    BPOfferService bpos1=dn.getAllBpOs()[0];
    bpos1.triggerBlockReportForTests();
    assertEquals("wrong nn address",getNNSocketAddress(bpos1),nn1.getNameNodeAddress());
    assertEquals("wrong bpid",bpos1.getBlockPoolId(),bpid1);
    assertEquals("wrong cid",dn.getClusterId(),cid1);
    cluster.shutdown();
    assertEquals(0,dn.getAllBpOs().length);
    cluster=null;
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMiniDFSClusterWithMultipleNN() throws IOException {
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleFederatedTopology(2)).build();
  try {
    cluster.waitActive();
    Assert.assertEquals("(1)Should be 2 namenodes",2,cluster.getNumNameNodes());
    cluster.addNameNode(conf,0);
    Assert.assertEquals("(1)Should be 3 namenodes",3,cluster.getNumNameNodes());
  }
 catch (  IOException ioe) {
    Assert.fail("Failed to add NN to cluster:" + StringUtils.stringifyException(ioe));
  }
 finally {
    cluster.shutdown();
  }
  conf=new HdfsConfiguration();
  cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleFederatedTopology(1)).build();
  try {
    Assert.assertNotNull(cluster);
    cluster.waitActive();
    Assert.assertEquals("(2)Should be 1 namenodes",1,cluster.getNumNameNodes());
    cluster.addNameNode(conf,0);
    Assert.assertEquals("(2)Should be 2 namenodes",2,cluster.getNumNameNodes());
  }
 catch (  IOException ioe) {
    Assert.fail("Failed to add NN to cluster:" + StringUtils.stringifyException(ioe));
  }
 finally {
    cluster.shutdown();
  }
  conf=new HdfsConfiguration();
  cluster=new MiniDFSCluster.Builder(conf).build();
  try {
    cluster.waitActive();
    Assert.assertNotNull(cluster);
    Assert.assertEquals("(2)Should be 1 namenodes",1,cluster.getNumNameNodes());
    cluster.addNameNode(conf,9929);
    Assert.fail("shouldn't be able to add another NN to non federated cluster");
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().startsWith("cannot add namenode"));
    Assert.assertEquals("(3)Should be 1 namenodes",1,cluster.getNumNameNodes());
  }
 finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-19 type-1 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * start multiple NNs and single DN and verifies per BP registrations and
 * handshakes.
 * @throws IOException
 */
@Test public void test2NNRegistration() throws IOException {
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleFederatedTopology(2)).build();
  try {
    cluster.waitActive();
    NameNode nn1=cluster.getNameNode(0);
    NameNode nn2=cluster.getNameNode(1);
    assertNotNull("cannot create nn1",nn1);
    assertNotNull("cannot create nn2",nn2);
    String bpid1=FSImageTestUtil.getFSImage(nn1).getBlockPoolID();
    String bpid2=FSImageTestUtil.getFSImage(nn2).getBlockPoolID();
    String cid1=FSImageTestUtil.getFSImage(nn1).getClusterID();
    String cid2=FSImageTestUtil.getFSImage(nn2).getClusterID();
    int lv1=FSImageTestUtil.getFSImage(nn1).getLayoutVersion();
    int lv2=FSImageTestUtil.getFSImage(nn2).getLayoutVersion();
    int ns1=FSImageTestUtil.getFSImage(nn1).getNamespaceID();
    int ns2=FSImageTestUtil.getFSImage(nn2).getNamespaceID();
    assertNotSame("namespace ids should be different",ns1,ns2);
    LOG.info("nn1: lv=" + lv1 + ";cid="+ cid1+ ";bpid="+ bpid1+ ";uri="+ nn1.getNameNodeAddress());
    LOG.info("nn2: lv=" + lv2 + ";cid="+ cid2+ ";bpid="+ bpid2+ ";uri="+ nn2.getNameNodeAddress());
    DataNode dn=cluster.getDataNodes().get(0);
    final Map<String,Object> volInfos=dn.data.getVolumeInfoMap();
    Assert.assertTrue("No volumes in the fsdataset",volInfos.size() > 0);
    int i=0;
    for (    Map.Entry<String,Object> e : volInfos.entrySet()) {
      LOG.info("vol " + i++ + ") "+ e.getKey()+ ": "+ e.getValue());
    }
    assertEquals("number of volumes is wrong",2,volInfos.size());
    for (    BPOfferService bpos : dn.getAllBpOs()) {
      LOG.info("BP: " + bpos);
    }
    BPOfferService bpos1=dn.getAllBpOs()[0];
    BPOfferService bpos2=dn.getAllBpOs()[1];
    if (getNNSocketAddress(bpos1).equals(nn2.getNameNodeAddress())) {
      BPOfferService tmp=bpos1;
      bpos1=bpos2;
      bpos2=tmp;
    }
    assertEquals("wrong nn address",getNNSocketAddress(bpos1),nn1.getNameNodeAddress());
    assertEquals("wrong nn address",getNNSocketAddress(bpos2),nn2.getNameNodeAddress());
    assertEquals("wrong bpid",bpos1.getBlockPoolId(),bpid1);
    assertEquals("wrong bpid",bpos2.getBlockPoolId(),bpid2);
    assertEquals("wrong cid",dn.getClusterId(),cid1);
    assertEquals("cid should be same",cid2,cid1);
    assertEquals("namespace should be same",bpos1.bpNSInfo.namespaceID,ns1);
    assertEquals("namespace should be same",bpos2.bpNSInfo.namespaceID,ns2);
  }
  finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClusterIdMismatch() throws Exception {
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleFederatedTopology(2)).build();
  try {
    cluster.waitActive();
    DataNode dn=cluster.getDataNodes().get(0);
    BPOfferService[] bposs=dn.getAllBpOs();
    LOG.info("dn bpos len (should be 2):" + bposs.length);
    Assert.assertEquals("should've registered with two namenodes",bposs.length,2);
    cluster.addNameNode(conf,9938);
    Thread.sleep(500);
    bposs=dn.getAllBpOs();
    LOG.info("dn bpos len (should be 3):" + bposs.length);
    Assert.assertEquals("should've registered with three namenodes",bposs.length,3);
    StartupOption.FORMAT.setClusterId("DifferentCID");
    cluster.addNameNode(conf,9948);
    NameNode nn4=cluster.getNameNode(3);
    assertNotNull("cannot create nn4",nn4);
    Thread.sleep(500);
    bposs=dn.getAllBpOs();
    LOG.info("dn bpos len (still should be 3):" + bposs.length);
    Assert.assertEquals("should've registered with three namenodes",3,bposs.length);
  }
  finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestIncrementalBrVariations </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Verify that the NameNode can learn about new storages from incremental
 * block reports.
 * This tests the fix for the error condition seen in HDFS-6904.
 * @throws IOException
 * @throws InterruptedException
 */
@Test(timeout=60000) public void testNnLearnsNewStorages() throws IOException, InterruptedException {
  final String newStorageUuid=UUID.randomUUID().toString();
  final DatanodeStorage newStorage=new DatanodeStorage(newStorageUuid);
  StorageReceivedDeletedBlocks[] reports=makeReportForReceivedBlock(getDummyBlock(),newStorage);
  cluster.getNameNodeRpc().blockReceivedAndDeleted(dn0Reg,poolId,reports);
  DatanodeStorageInfo storageInfo=cluster.getNameNode().getNamesystem().getBlockManager().getDatanodeManager().getDatanode(dn0.getDatanodeId()).getStorageInfo(newStorageUuid);
  assertNotNull(storageInfo);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestSimulatedFSDataset </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetBlockReport() throws IOException {
  SimulatedFSDataset fsdataset=getSimulatedFSDataset();
  BlockListAsLongs blockReport=fsdataset.getBlockReport(bpid);
  assertEquals(0,blockReport.getNumberOfBlocks());
  addSomeBlocks(fsdataset);
  blockReport=fsdataset.getBlockReport(bpid);
  assertEquals(NUMBLOCKS,blockReport.getNumberOfBlocks());
  for (  Block b : blockReport) {
    assertNotNull(b);
    assertEquals(blockIdToLen(b.getBlockId()),b.getNumBytes());
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInjectionNonEmpty() throws IOException {
  SimulatedFSDataset fsdataset=getSimulatedFSDataset();
  BlockListAsLongs blockReport=fsdataset.getBlockReport(bpid);
  assertEquals(0,blockReport.getNumberOfBlocks());
  int bytesAdded=addSomeBlocks(fsdataset);
  blockReport=fsdataset.getBlockReport(bpid);
  assertEquals(NUMBLOCKS,blockReport.getNumberOfBlocks());
  for (  Block b : blockReport) {
    assertNotNull(b);
    assertEquals(blockIdToLen(b.getBlockId()),b.getNumBytes());
  }
  fsdataset=null;
  SimulatedFSDataset sfsdataset=getSimulatedFSDataset();
  bytesAdded+=addSomeBlocks(sfsdataset,NUMBLOCKS + 1);
  sfsdataset.getBlockReport(bpid);
  assertEquals(NUMBLOCKS,blockReport.getNumberOfBlocks());
  sfsdataset.getBlockReport(bpid);
  assertEquals(NUMBLOCKS,blockReport.getNumberOfBlocks());
  sfsdataset.injectBlocks(bpid,blockReport);
  blockReport=sfsdataset.getBlockReport(bpid);
  assertEquals(NUMBLOCKS * 2,blockReport.getNumberOfBlocks());
  for (  Block b : blockReport) {
    assertNotNull(b);
    assertEquals(blockIdToLen(b.getBlockId()),b.getNumBytes());
    assertEquals(blockIdToLen(b.getBlockId()),sfsdataset.getLength(new ExtendedBlock(bpid,b)));
  }
  assertEquals(bytesAdded,sfsdataset.getDfsUsed());
  assertEquals(sfsdataset.getCapacity() - bytesAdded,sfsdataset.getRemaining());
  conf.setLong(SimulatedFSDataset.CONFIG_PROPERTY_CAPACITY,10);
  try {
    sfsdataset=getSimulatedFSDataset();
    sfsdataset.addBlockPool(bpid,conf);
    sfsdataset.injectBlocks(bpid,blockReport);
    assertTrue("Expected an IO exception",false);
  }
 catch (  IOException e) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInjectionEmpty() throws IOException {
  SimulatedFSDataset fsdataset=getSimulatedFSDataset();
  BlockListAsLongs blockReport=fsdataset.getBlockReport(bpid);
  assertEquals(0,blockReport.getNumberOfBlocks());
  int bytesAdded=addSomeBlocks(fsdataset);
  blockReport=fsdataset.getBlockReport(bpid);
  assertEquals(NUMBLOCKS,blockReport.getNumberOfBlocks());
  for (  Block b : blockReport) {
    assertNotNull(b);
    assertEquals(blockIdToLen(b.getBlockId()),b.getNumBytes());
  }
  SimulatedFSDataset sfsdataset=getSimulatedFSDataset();
  sfsdataset.injectBlocks(bpid,blockReport);
  blockReport=sfsdataset.getBlockReport(bpid);
  assertEquals(NUMBLOCKS,blockReport.getNumberOfBlocks());
  for (  Block b : blockReport) {
    assertNotNull(b);
    assertEquals(blockIdToLen(b.getBlockId()),b.getNumBytes());
    assertEquals(blockIdToLen(b.getBlockId()),sfsdataset.getLength(new ExtendedBlock(bpid,b)));
  }
  assertEquals(bytesAdded,sfsdataset.getDfsUsed());
  assertEquals(sfsdataset.getCapacity() - bytesAdded,sfsdataset.getRemaining());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.TestStartSecureDataNode </h4><pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecureNameNode() throws Exception {
  MiniDFSCluster cluster=null;
  try {
    String nnPrincipal=System.getProperty("dfs.namenode.kerberos.principal");
    String nnSpnegoPrincipal=System.getProperty("dfs.namenode.kerberos.internal.spnego.principal");
    String nnKeyTab=System.getProperty("dfs.namenode.keytab.file");
    assertNotNull("NameNode principal was not specified",nnPrincipal);
    assertNotNull("NameNode SPNEGO principal was not specified",nnSpnegoPrincipal);
    assertNotNull("NameNode keytab was not specified",nnKeyTab);
    String dnPrincipal=System.getProperty("dfs.datanode.kerberos.principal");
    String dnKeyTab=System.getProperty("dfs.datanode.keytab.file");
    assertNotNull("DataNode principal was not specified",dnPrincipal);
    assertNotNull("DataNode keytab was not specified",dnKeyTab);
    Configuration conf=new HdfsConfiguration();
    conf.set(CommonConfigurationKeys.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
    conf.set(DFSConfigKeys.DFS_NAMENODE_KERBEROS_PRINCIPAL_KEY,nnPrincipal);
    conf.set(DFSConfigKeys.DFS_NAMENODE_KERBEROS_INTERNAL_SPNEGO_PRINCIPAL_KEY,nnSpnegoPrincipal);
    conf.set(DFSConfigKeys.DFS_NAMENODE_KEYTAB_FILE_KEY,nnKeyTab);
    conf.set(DFSConfigKeys.DFS_DATANODE_KERBEROS_PRINCIPAL_KEY,dnPrincipal);
    conf.set(DFSConfigKeys.DFS_DATANODE_KEYTAB_FILE_KEY,dnKeyTab);
    conf.set(DFSConfigKeys.DFS_DATANODE_ADDRESS_KEY,"127.0.0.1:1004");
    conf.set(DFSConfigKeys.DFS_DATANODE_HTTP_ADDRESS_KEY,"127.0.0.1:1006");
    conf.set(DFSConfigKeys.DFS_DATANODE_DATA_DIR_KEY,"700");
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_OF_DATANODES).checkDataNodeAddrConfig(true).build();
    cluster.waitActive();
    assertTrue(cluster.isDataNodeUp());
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    throw ex;
  }
 finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.TestInterDatanodeProtocol </h4><pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link FsDatasetImpl#initReplicaRecovery(String,ReplicaMap,Block,long,long)}
 */
@Test public void testInitReplicaRecovery() throws IOException {
  final long firstblockid=10000L;
  final long gs=7777L;
  final long length=22L;
  final ReplicaMap map=new ReplicaMap(this);
  String bpid="BP-TEST";
  final Block[] blocks=new Block[5];
  for (int i=0; i < blocks.length; i++) {
    blocks[i]=new Block(firstblockid + i,length,gs);
    map.add(bpid,createReplicaInfo(blocks[i]));
  }
{
    final Block b=blocks[0];
    final ReplicaInfo originalInfo=map.get(bpid,b);
    final long recoveryid=gs + 1;
    final ReplicaRecoveryInfo recoveryInfo=FsDatasetImpl.initReplicaRecovery(bpid,map,blocks[0],recoveryid,DFSConfigKeys.DFS_DATANODE_XCEIVER_STOP_TIMEOUT_MILLIS_DEFAULT);
    assertEquals(originalInfo,recoveryInfo);
    final ReplicaUnderRecovery updatedInfo=(ReplicaUnderRecovery)map.get(bpid,b);
    Assert.assertEquals(originalInfo.getBlockId(),updatedInfo.getBlockId());
    Assert.assertEquals(recoveryid,updatedInfo.getRecoveryID());
    final long recoveryid2=gs + 2;
    final ReplicaRecoveryInfo recoveryInfo2=FsDatasetImpl.initReplicaRecovery(bpid,map,blocks[0],recoveryid2,DFSConfigKeys.DFS_DATANODE_XCEIVER_STOP_TIMEOUT_MILLIS_DEFAULT);
    assertEquals(originalInfo,recoveryInfo2);
    final ReplicaUnderRecovery updatedInfo2=(ReplicaUnderRecovery)map.get(bpid,b);
    Assert.assertEquals(originalInfo.getBlockId(),updatedInfo2.getBlockId());
    Assert.assertEquals(recoveryid2,updatedInfo2.getRecoveryID());
    try {
      FsDatasetImpl.initReplicaRecovery(bpid,map,b,recoveryid,DFSConfigKeys.DFS_DATANODE_XCEIVER_STOP_TIMEOUT_MILLIS_DEFAULT);
      Assert.fail();
    }
 catch (    RecoveryInProgressException ripe) {
      System.out.println("GOOD: getting " + ripe);
    }
  }
{
    final long recoveryid=gs + 1;
    final Block b=new Block(firstblockid - 1,length,gs);
    ReplicaRecoveryInfo r=FsDatasetImpl.initReplicaRecovery(bpid,map,b,recoveryid,DFSConfigKeys.DFS_DATANODE_XCEIVER_STOP_TIMEOUT_MILLIS_DEFAULT);
    Assert.assertNull("Data-node should not have this replica.",r);
  }
{
    final long recoveryid=gs - 1;
    final Block b=new Block(firstblockid + 1,length,gs);
    try {
      FsDatasetImpl.initReplicaRecovery(bpid,map,b,recoveryid,DFSConfigKeys.DFS_DATANODE_XCEIVER_STOP_TIMEOUT_MILLIS_DEFAULT);
      Assert.fail();
    }
 catch (    IOException ioe) {
      System.out.println("GOOD: getting " + ioe);
    }
  }
{
    final long recoveryid=gs + 1;
    final Block b=new Block(firstblockid,length,gs + 1);
    try {
      FsDatasetImpl.initReplicaRecovery(bpid,map,b,recoveryid,DFSConfigKeys.DFS_DATANODE_XCEIVER_STOP_TIMEOUT_MILLIS_DEFAULT);
      fail("InitReplicaRecovery should fail because replica's " + "gs is less than the block's gs");
    }
 catch (    IOException e) {
      e.getMessage().startsWith("replica.getGenerationStamp() < block.getGenerationStamp(), block=");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.TestReplicaMap </h4><pre class="type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove(){
  try {
    map.remove(bpid,null);
    fail("Expected exception not thrown");
  }
 catch (  IllegalArgumentException expected) {
  }
  Block b=new Block(block);
  b.setGenerationStamp(0);
  assertNull(map.remove(bpid,b));
  b.setGenerationStamp(block.getGenerationStamp());
  b.setBlockId(0);
  assertNull(map.remove(bpid,b));
  assertNotNull(map.remove(bpid,block));
  assertNull(map.remove(bpid,0));
  map.add(bpid,new FinalizedReplica(block,null,null));
  assertNotNull(map.remove(bpid,block.getBlockId()));
}

</code></pre>

<br>
<pre class="type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for ReplicasMap.get(Block) and ReplicasMap.get(long) tests
 */
@Test public void testGet(){
  try {
    map.get(bpid,null);
    fail("Expected exception not thrown");
  }
 catch (  IllegalArgumentException expected) {
  }
  assertNotNull(map.get(bpid,block));
  Block b=new Block(block);
  b.setGenerationStamp(0);
  assertNull(map.get(bpid,b));
  b.setGenerationStamp(block.getGenerationStamp());
  b.setBlockId(0);
  assertNull(map.get(bpid,b));
  assertNotNull(map.get(bpid,block.getBlockId()));
  assertNull(map.get(bpid,0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.FSAclBaseTest </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetPermissionCannotSetAclBit() throws IOException {
  FileSystem.mkdirs(fs,path,FsPermission.createImmutable((short)0750));
  fs.setPermission(path,FsPermission.createImmutable((short)0700));
  assertPermission((short)0700);
  fs.setPermission(path,new FsAclPermission(FsPermission.createImmutable((short)0755)));
  INode inode=cluster.getNamesystem().getFSDirectory().getNode(path.toUri().getPath(),false);
  assertNotNull(inode);
  FsPermission perm=inode.getFsPermission();
  assertNotNull(perm);
  assertEquals(0755,perm.toShort());
  assertEquals(0755,perm.toExtendedShort());
  assertAclFeature(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestAllowFormat </h4><pre class="type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * start MiniDFScluster, try formatting with different settings
 * @throws IOException
 * @throws InterruptedException 
 */
@Test public void testAllowFormat() throws IOException {
  LOG.info("--starting mini cluster");
  NameNode nn;
  config.setBoolean(DFS_NAMENODE_SUPPORT_ALLOW_FORMAT_KEY,true);
  cluster=new MiniDFSCluster.Builder(config).manageDataDfsDirs(false).manageNameDfsDirs(false).build();
  cluster.waitActive();
  assertNotNull(cluster);
  nn=cluster.getNameNode();
  assertNotNull(nn);
  LOG.info("Mini cluster created OK");
  LOG.info("Verifying format will fail with allowformat false");
  config.setBoolean(DFS_NAMENODE_SUPPORT_ALLOW_FORMAT_KEY,false);
  try {
    cluster.shutdown();
    NameNode.format(config);
    fail("Format succeeded, when it should have failed");
  }
 catch (  IOException e) {
    assertTrue("Exception was not about formatting Namenode",e.getMessage().startsWith("The option " + DFS_NAMENODE_SUPPORT_ALLOW_FORMAT_KEY));
    LOG.info("Expected failure: " + StringUtils.stringifyException(e));
    LOG.info("Done verifying format will fail with allowformat false");
  }
  LOG.info("Verifying format will succeed with allowformat true");
  config.setBoolean(DFS_NAMENODE_SUPPORT_ALLOW_FORMAT_KEY,true);
  NameNode.format(config);
  LOG.info("Done verifying format will succeed with allowformat true");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestBackupNode </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that the backupnode will tail edits from the NN
 * and keep in sync, even while the NN rolls, checkpoints
 * occur, etc.
 */
@Test public void testBackupNodeTailsEdits() throws Exception {
  Configuration conf=new HdfsConfiguration();
  HAUtil.setAllowStandbyReads(conf,true);
  MiniDFSCluster cluster=null;
  FileSystem fileSys=null;
  BackupNode backup=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(0).build();
    fileSys=cluster.getFileSystem();
    backup=startBackupNode(conf,StartupOption.BACKUP,1);
    BackupImage bnImage=(BackupImage)backup.getFSImage();
    testBNInSync(cluster,backup,1);
    NameNode nn=cluster.getNameNode();
    NamenodeProtocols nnRpc=nn.getRpcServer();
    nnRpc.rollEditLog();
    assertEquals(bnImage.getEditLog().getCurSegmentTxId(),nn.getFSImage().getEditLog().getCurSegmentTxId());
    testBNInSync(cluster,backup,2);
    long nnImageBefore=nn.getFSImage().getStorage().getMostRecentCheckpointTxId();
    backup.doCheckpoint();
    long nnImageAfter=nn.getFSImage().getStorage().getMostRecentCheckpointTxId();
    assertTrue("nn should have received new checkpoint. before: " + nnImageBefore + " after: "+ nnImageAfter,nnImageAfter > nnImageBefore);
    testBNInSync(cluster,backup,3);
    StorageDirectory sd=bnImage.getStorage().getStorageDir(0);
    backup.stop();
    backup=null;
    EditLogFile editsLog=FSImageTestUtil.findLatestEditsLog(sd);
    assertEquals(editsLog.getFirstTxId(),nn.getFSImage().getEditLog().getCurSegmentTxId());
    assertTrue("Should not have finalized " + editsLog,editsLog.isInProgress());
    assertTrue(fileSys.mkdirs(new Path("/edit-while-bn-down")));
    backup=startBackupNode(conf,StartupOption.BACKUP,1);
    testBNInSync(cluster,backup,4);
    assertNotNull(backup.getNamesystem().getFileInfo("/edit-while-bn-down",false));
    backup.stop(false);
    assertTrue(fileSys.mkdirs(new Path("/edit-while-bn-down-2")));
  }
  finally {
    LOG.info("Shutting down...");
    if (backup != null)     backup.stop();
    if (fileSys != null)     fileSys.close();
    if (cluster != null)     cluster.shutdown();
  }
  assertStorageDirsMatch(cluster.getNameNode(),backup);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestCacheDirectives </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testListCachePoolPermissions() throws Exception {
  final UserGroupInformation myUser=UserGroupInformation.createRemoteUser("myuser");
  final DistributedFileSystem myDfs=(DistributedFileSystem)DFSTestUtil.getFileSystemAs(myUser,conf);
  final String poolName="poolparty";
  dfs.addCachePool(new CachePoolInfo(poolName).setMode(new FsPermission((short)0700)));
  RemoteIterator<CachePoolEntry> it=myDfs.listCachePools();
  CachePoolInfo info=it.next().getInfo();
  assertFalse(it.hasNext());
  assertEquals("Expected pool name",poolName,info.getPoolName());
  assertNull("Unexpected owner name",info.getOwnerName());
  assertNull("Unexpected group name",info.getGroupName());
  assertNull("Unexpected mode",info.getMode());
  assertNull("Unexpected limit",info.getLimit());
  final long limit=99;
  dfs.modifyCachePool(new CachePoolInfo(poolName).setOwnerName(myUser.getShortUserName()).setLimit(limit));
  it=myDfs.listCachePools();
  info=it.next().getInfo();
  assertFalse(it.hasNext());
  assertEquals("Expected pool name",poolName,info.getPoolName());
  assertEquals("Mismatched owner name",myUser.getShortUserName(),info.getOwnerName());
  assertNotNull("Expected group name",info.getGroupName());
  assertEquals("Mismatched mode",(short)0700,info.getMode().toShort());
  assertEquals("Mismatched limit",limit,(long)info.getLimit());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestCheckpoint </h4><pre class="type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommandLineParsing() throws ParseException {
  SecondaryNameNode.CommandLineOpts opts=new SecondaryNameNode.CommandLineOpts();
  opts.parse();
  assertNull(opts.getCommand());
  opts.parse("-checkpoint");
  assertEquals(SecondaryNameNode.CommandLineOpts.Command.CHECKPOINT,opts.getCommand());
  assertFalse(opts.shouldForceCheckpoint());
  opts.parse("-checkpoint","force");
  assertEquals(SecondaryNameNode.CommandLineOpts.Command.CHECKPOINT,opts.getCommand());
  assertTrue(opts.shouldForceCheckpoint());
  opts.parse("-geteditsize");
  assertEquals(SecondaryNameNode.CommandLineOpts.Command.GETEDITSIZE,opts.getCommand());
  opts.parse("-format");
  assertTrue(opts.shouldFormat());
  try {
    opts.parse("-geteditsize","-checkpoint");
    fail("Should have failed bad parsing for two actions");
  }
 catch (  ParseException e) {
    LOG.warn("Encountered ",e);
  }
  try {
    opts.parse("-checkpoint","xx");
    fail("Should have failed for bad checkpoint arg");
  }
 catch (  ParseException e) {
    LOG.warn("Encountered ",e);
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Regression test for HDFS-3835 - "Long-lived 2NN cannot perform a
 * checkpoint if security is enabled and the NN restarts without outstanding
 * delegation tokens"
 */
@Test public void testSecondaryNameNodeWithDelegationTokens() throws IOException {
  MiniDFSCluster cluster=null;
  SecondaryNameNode secondary=null;
  Configuration conf=new HdfsConfiguration();
  conf.setBoolean(DFSConfigKeys.DFS_NAMENODE_DELEGATION_TOKEN_ALWAYS_USE_KEY,true);
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDatanodes).format(true).build();
    assertNotNull(cluster.getNamesystem().getDelegationToken(new Text("atm")));
    secondary=startSecondaryNameNode(conf);
    secondary.doCheckpoint();
    cluster.getNameNodeRpc().setSafeMode(SafeModeAction.SAFEMODE_ENTER,false);
    cluster.getNameNodeRpc().saveNamespace();
    cluster.getNameNodeRpc().setSafeMode(SafeModeAction.SAFEMODE_LEAVE,false);
    secondary.doCheckpoint();
  }
  finally {
    cleanup(secondary);
    secondary=null;
    cleanup(cluster);
    cluster=null;
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
/** 
 * Test that the NN locks its storage and edits directories, and won't start up
 * if the directories are already locked
 */
@Test public void testNameDirLocking() throws IOException {
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=null;
  StorageDirectory savedSd=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(0).build();
    NNStorage storage=cluster.getNameNode().getFSImage().getStorage();
    for (    StorageDirectory sd : storage.dirIterable(null)) {
      assertLockFails(sd);
      savedSd=sd;
    }
  }
  finally {
    cleanup(cluster);
    cluster=null;
  }
  assertNotNull(savedSd);
  assertClusterStartFailsWhenDirLocked(conf,savedSd);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that, if the edits dir is separate from the name dir, it is
 * properly locked.
 */
@Test public void testSeparateEditsDirLocking() throws IOException {
  Configuration conf=new HdfsConfiguration();
  File nameDir=new File(MiniDFSCluster.getBaseDirectory(),"name");
  File editsDir=new File(MiniDFSCluster.getBaseDirectory(),"testSeparateEditsDirLocking");
  conf.set(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY,nameDir.getAbsolutePath());
  conf.set(DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_KEY,editsDir.getAbsolutePath());
  MiniDFSCluster cluster=null;
  StorageDirectory savedSd=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).manageNameDfsDirs(false).numDataNodes(0).build();
    NNStorage storage=cluster.getNameNode().getFSImage().getStorage();
    for (    StorageDirectory sd : storage.dirIterable(NameNodeDirType.EDITS)) {
      assertEquals(editsDir.getAbsoluteFile(),sd.getRoot());
      assertLockFails(sd);
      savedSd=sd;
    }
  }
  finally {
    cleanup(cluster);
    cluster=null;
  }
  assertNotNull(savedSd);
  assertClusterStartFailsWhenDirLocked(conf,savedSd);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestEditLog </h4><pre class="type-9 type-2 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEditChecksum() throws Exception {
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=null;
  FileSystem fileSys=null;
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATA_NODES).build();
  cluster.waitActive();
  fileSys=cluster.getFileSystem();
  final FSNamesystem namesystem=cluster.getNamesystem();
  FSImage fsimage=namesystem.getFSImage();
  final FSEditLog editLog=fsimage.getEditLog();
  fileSys.mkdirs(new Path("/tmp"));
  Iterator<StorageDirectory> iter=fsimage.getStorage().dirIterator(NameNodeDirType.EDITS);
  LinkedList<StorageDirectory> sds=new LinkedList<StorageDirectory>();
  while (iter.hasNext()) {
    sds.add(iter.next());
  }
  editLog.close();
  cluster.shutdown();
  for (  StorageDirectory sd : sds) {
    File editFile=NNStorage.getFinalizedEditsFile(sd,1,3);
    assertTrue(editFile.exists());
    long fileLen=editFile.length();
    LOG.debug("Corrupting Log File: " + editFile + " len: "+ fileLen);
    RandomAccessFile rwf=new RandomAccessFile(editFile,"rw");
    rwf.seek(fileLen - 4);
    int b=rwf.readInt();
    rwf.seek(fileLen - 4);
    rwf.writeInt(b + 1);
    rwf.close();
  }
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATA_NODES).format(false).build();
    fail("should not be able to start");
  }
 catch (  IOException e) {
    assertNotNull("Cause of exception should be ChecksumException",e.getCause());
    assertEquals("Cause of exception should be ChecksumException",ChecksumException.class,e.getCause().getClass());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestEditLogRace </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The logSync() method in FSEditLog is unsynchronized whiel syncing
 * so that other threads can concurrently enqueue edits while the prior
 * sync is ongoing. This test checks that the log is saved correctly
 * if the saveImage occurs while the syncing thread is in the unsynchronized middle section.
 * This replicates the following manual test proposed by Konstantin:
 * I start the name-node in debugger.
 * I do -mkdir and stop the debugger in logSync() just before it does flush.
 * Then I enter safe mode with another client
 * I start saveNamepsace and stop the debugger in
 * FSImage.saveFSImage() -> FSEditLog.createEditLogFile()
 * -> EditLogFileOutputStream.create() ->
 * after truncating the file but before writing LAYOUT_VERSION into it.
 * Then I let logSync() run.
 * Then I terminate the name-node.
 * After that the name-node wont start, since the edits file is broken.
 */
@Test public void testSaveImageWhileSyncInProgress() throws Exception {
  Configuration conf=getConf();
  NameNode.initMetrics(conf,NamenodeRole.NAMENODE);
  DFSTestUtil.formatNameNode(conf);
  final FSNamesystem namesystem=FSNamesystem.loadFromDisk(conf);
  try {
    FSImage fsimage=namesystem.getFSImage();
    FSEditLog editLog=fsimage.getEditLog();
    JournalAndStream jas=editLog.getJournals().get(0);
    EditLogFileOutputStream spyElos=spy((EditLogFileOutputStream)jas.getCurrentStream());
    jas.setCurrentStreamForTests(spyElos);
    final AtomicReference<Throwable> deferredException=new AtomicReference<Throwable>();
    final CountDownLatch waitToEnterFlush=new CountDownLatch(1);
    final Thread doAnEditThread=new Thread(){
      @Override public void run(){
        try {
          LOG.info("Starting mkdirs");
          namesystem.mkdirs("/test",new PermissionStatus("test","test",new FsPermission((short)00755)),true);
          LOG.info("mkdirs complete");
        }
 catch (        Throwable ioe) {
          LOG.fatal("Got exception",ioe);
          deferredException.set(ioe);
          waitToEnterFlush.countDown();
        }
      }
    }
;
    Answer<Void> blockingFlush=new Answer<Void>(){
      @Override public Void answer(      InvocationOnMock invocation) throws Throwable {
        LOG.info("Flush called");
        if (Thread.currentThread() == doAnEditThread) {
          LOG.info("edit thread: Telling main thread we made it to flush section...");
          waitToEnterFlush.countDown();
          LOG.info("edit thread: sleeping for " + BLOCK_TIME + "secs");
          Thread.sleep(BLOCK_TIME * 1000);
          LOG.info("Going through to flush. This will allow the main thread to continue.");
        }
        invocation.callRealMethod();
        LOG.info("Flush complete");
        return null;
      }
    }
;
    doAnswer(blockingFlush).when(spyElos).flush();
    doAnEditThread.start();
    LOG.info("Main thread: waiting to enter flush...");
    waitToEnterFlush.await();
    assertNull(deferredException.get());
    LOG.info("Main thread: detected that logSync is in unsynchronized section.");
    LOG.info("Trying to enter safe mode.");
    LOG.info("This should block for " + BLOCK_TIME + "sec, since flush will sleep that long");
    long st=Time.now();
    namesystem.setSafeMode(SafeModeAction.SAFEMODE_ENTER);
    long et=Time.now();
    LOG.info("Entered safe mode");
    assertTrue(et - st > (BLOCK_TIME - 1) * 1000);
    namesystem.saveNamespace();
    LOG.info("Joining on edit thread...");
    doAnEditThread.join();
    assertNull(deferredException.get());
    assertEquals(3,verifyEditLogs(namesystem,fsimage,NNStorage.getFinalizedEditsFileName(1,3),1));
    assertEquals(1,verifyEditLogs(namesystem,fsimage,NNStorage.getInProgressEditsFileName(4),4));
  }
  finally {
    LOG.info("Closing namesystem");
    if (namesystem != null)     namesystem.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Most of the FSNamesystem methods have a synchronized section where they
 * update the name system itself and write to the edit log, and then
 * unsynchronized, they call logSync. This test verifies that, if an
 * operation has written to the edit log but not yet synced it,
 * we wait for that sync before entering safe mode.
 */
@Test public void testSaveRightBeforeSync() throws Exception {
  Configuration conf=getConf();
  NameNode.initMetrics(conf,NamenodeRole.NAMENODE);
  DFSTestUtil.formatNameNode(conf);
  final FSNamesystem namesystem=FSNamesystem.loadFromDisk(conf);
  try {
    FSImage fsimage=namesystem.getFSImage();
    FSEditLog editLog=spy(fsimage.getEditLog());
    fsimage.editLog=editLog;
    final AtomicReference<Throwable> deferredException=new AtomicReference<Throwable>();
    final CountDownLatch waitToEnterSync=new CountDownLatch(1);
    final Thread doAnEditThread=new Thread(){
      @Override public void run(){
        try {
          LOG.info("Starting mkdirs");
          namesystem.mkdirs("/test",new PermissionStatus("test","test",new FsPermission((short)00755)),true);
          LOG.info("mkdirs complete");
        }
 catch (        Throwable ioe) {
          LOG.fatal("Got exception",ioe);
          deferredException.set(ioe);
          waitToEnterSync.countDown();
        }
      }
    }
;
    Answer<Void> blockingSync=new Answer<Void>(){
      @Override public Void answer(      InvocationOnMock invocation) throws Throwable {
        LOG.info("logSync called");
        if (Thread.currentThread() == doAnEditThread) {
          LOG.info("edit thread: Telling main thread we made it just before logSync...");
          waitToEnterSync.countDown();
          LOG.info("edit thread: sleeping for " + BLOCK_TIME + "secs");
          Thread.sleep(BLOCK_TIME * 1000);
          LOG.info("Going through to logSync. This will allow the main thread to continue.");
        }
        invocation.callRealMethod();
        LOG.info("logSync complete");
        return null;
      }
    }
;
    doAnswer(blockingSync).when(editLog).logSync();
    doAnEditThread.start();
    LOG.info("Main thread: waiting to just before logSync...");
    waitToEnterSync.await();
    assertNull(deferredException.get());
    LOG.info("Main thread: detected that logSync about to be called.");
    LOG.info("Trying to enter safe mode.");
    LOG.info("This should block for " + BLOCK_TIME + "sec, since we have pending edits");
    long st=Time.now();
    namesystem.setSafeMode(SafeModeAction.SAFEMODE_ENTER);
    long et=Time.now();
    LOG.info("Entered safe mode");
    assertTrue(et - st > (BLOCK_TIME - 1) * 1000);
    namesystem.saveNamespace();
    LOG.info("Joining on edit thread...");
    doAnEditThread.join();
    assertNull(deferredException.get());
    assertEquals(3,verifyEditLogs(namesystem,fsimage,NNStorage.getFinalizedEditsFileName(1,3),1));
    assertEquals(1,verifyEditLogs(namesystem,fsimage,NNStorage.getInProgressEditsFileName(4),4));
  }
  finally {
    LOG.info("Closing namesystem");
    if (namesystem != null)     namesystem.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestFSNamesystemMBean </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Configuration conf=new Configuration();
  MiniDFSCluster cluster=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).build();
    cluster.waitActive();
    FSNamesystem fsn=cluster.getNameNode().namesystem;
    MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
    ObjectName mxbeanName=new ObjectName("Hadoop:service=NameNode,name=FSNamesystemState");
    String snapshotStats=(String)(mbs.getAttribute(mxbeanName,"SnapshotStats"));
    @SuppressWarnings("unchecked") Map<String,Object> stat=(Map<String,Object>)JSON.parse(snapshotStats);
    assertTrue(stat.containsKey("SnapshottableDirectories") && (Long)stat.get("SnapshottableDirectories") == fsn.getNumSnapshottableDirs());
    assertTrue(stat.containsKey("Snapshots") && (Long)stat.get("Snapshots") == fsn.getNumSnapshots());
    Object pendingDeletionBlocks=mbs.getAttribute(mxbeanName,"PendingDeletionBlocks");
    assertNotNull(pendingDeletionBlocks);
    assertTrue(pendingDeletionBlocks instanceof Long);
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestFsck </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the # of missing block replicas and expected replicas is correct
 * @throws IOException
 */
@Test public void testFsckMissingReplicas() throws IOException {
  final short REPL_FACTOR=2;
  final short NUM_REPLICAS=1;
  final short NUM_BLOCKS=3;
  final long blockSize=512;
  Configuration conf=new Configuration();
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,blockSize);
  MiniDFSCluster cluster=null;
  DistributedFileSystem dfs=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_REPLICAS).build();
    assertNotNull("Failed Cluster Creation",cluster);
    cluster.waitClusterUp();
    dfs=cluster.getFileSystem();
    assertNotNull("Failed to get FileSystem",dfs);
    final String pathString=new String("/testfile");
    final Path path=new Path(pathString);
    long fileLen=blockSize * NUM_BLOCKS;
    DFSTestUtil.createFile(dfs,path,fileLen,REPL_FACTOR,1);
    NameNode namenode=cluster.getNameNode();
    NetworkTopology nettop=cluster.getNamesystem().getBlockManager().getDatanodeManager().getNetworkTopology();
    Map<String,String[]> pmap=new HashMap<String,String[]>();
    Writer result=new StringWriter();
    PrintWriter out=new PrintWriter(result,true);
    InetAddress remoteAddress=InetAddress.getLocalHost();
    NamenodeFsck fsck=new NamenodeFsck(conf,namenode,nettop,pmap,out,NUM_REPLICAS,(short)1,remoteAddress);
    final HdfsFileStatus file=namenode.getRpcServer().getFileInfo(pathString);
    assertNotNull(file);
    Result res=new Result(conf);
    fsck.check(pathString,file,res);
    System.out.println(result.toString());
    assertEquals(res.missingReplicas,(NUM_BLOCKS * REPL_FACTOR) - (NUM_BLOCKS * NUM_REPLICAS));
    assertEquals(res.numExpectedReplicas,NUM_BLOCKS * REPL_FACTOR);
  }
  finally {
    if (dfs != null) {
      dfs.close();
    }
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that the # of misreplaced replicas is correct
 * @throws IOException
 */
@Test public void testFsckMisPlacedReplicas() throws IOException {
  final short REPL_FACTOR=2;
  short NUM_DN=2;
  final short NUM_BLOCKS=3;
  final long blockSize=512;
  String[] racks={"/rack1","/rack1"};
  String[] hosts={"host1","host2"};
  Configuration conf=new Configuration();
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,blockSize);
  MiniDFSCluster cluster=null;
  DistributedFileSystem dfs=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DN).hosts(hosts).racks(racks).build();
    assertNotNull("Failed Cluster Creation",cluster);
    cluster.waitClusterUp();
    dfs=cluster.getFileSystem();
    assertNotNull("Failed to get FileSystem",dfs);
    final String pathString=new String("/testfile");
    final Path path=new Path(pathString);
    long fileLen=blockSize * NUM_BLOCKS;
    DFSTestUtil.createFile(dfs,path,fileLen,REPL_FACTOR,1);
    NameNode namenode=cluster.getNameNode();
    NetworkTopology nettop=cluster.getNamesystem().getBlockManager().getDatanodeManager().getNetworkTopology();
    nettop.add(DFSTestUtil.getDatanodeDescriptor("/rack2","/host3"));
    NUM_DN++;
    Map<String,String[]> pmap=new HashMap<String,String[]>();
    Writer result=new StringWriter();
    PrintWriter out=new PrintWriter(result,true);
    InetAddress remoteAddress=InetAddress.getLocalHost();
    NamenodeFsck fsck=new NamenodeFsck(conf,namenode,nettop,pmap,out,NUM_DN,REPL_FACTOR,remoteAddress);
    final HdfsFileStatus file=namenode.getRpcServer().getFileInfo(pathString);
    assertNotNull(file);
    Result res=new Result(conf);
    fsck.check(pathString,file,res);
    assertEquals(res.numMisReplicatedBlocks,NUM_BLOCKS);
  }
  finally {
    if (dfs != null) {
      dfs.close();
    }
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestGenericJournalConf </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that a dummy implementation of JournalManager can
 * be initialized on startup
 */
@Test public void testDummyJournalManager() throws Exception {
  MiniDFSCluster cluster=null;
  Configuration conf=new Configuration();
  conf.set(DFSConfigKeys.DFS_NAMENODE_EDITS_PLUGIN_PREFIX + ".dummy",DummyJournalManager.class.getName());
  conf.set(DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_KEY,DUMMY_URI);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_CHECKED_VOLUMES_MINIMUM_KEY,0);
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(0).build();
    cluster.waitActive();
    assertTrue(DummyJournalManager.shouldPromptCalled);
    assertTrue(DummyJournalManager.formatCalled);
    assertNotNull(DummyJournalManager.conf);
    assertEquals(new URI(DUMMY_URI),DummyJournalManager.uri);
    assertNotNull(DummyJournalManager.nsInfo);
    assertEquals(DummyJournalManager.nsInfo.getClusterID(),cluster.getNameNode().getNamesystem().getClusterId());
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestHDFSConcat </h4><pre class="type-13 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Concatenates 10 files into one
 * Verifies the final size, deletion of the file, number of blocks
 * @throws IOException
 */
@Test public void testConcat() throws IOException, InterruptedException {
  final int numFiles=10;
  long fileLen=blockSize * 3;
  HdfsFileStatus fStatus;
  FSDataInputStream stm;
  String trg=new String("/trg");
  Path trgPath=new Path(trg);
  DFSTestUtil.createFile(dfs,trgPath,fileLen,REPL_FACTOR,1);
  fStatus=nn.getFileInfo(trg);
  long trgLen=fStatus.getLen();
  long trgBlocks=nn.getBlockLocations(trg,0,trgLen).locatedBlockCount();
  Path[] files=new Path[numFiles];
  byte[][] bytes=new byte[numFiles][(int)fileLen];
  LocatedBlocks[] lblocks=new LocatedBlocks[numFiles];
  long[] lens=new long[numFiles];
  int i=0;
  for (i=0; i < files.length; i++) {
    files[i]=new Path("/file" + i);
    Path path=files[i];
    System.out.println("Creating file " + path);
    DFSTestUtil.createFile(dfs,path,fileLen,REPL_FACTOR,1);
    fStatus=nn.getFileInfo(path.toUri().getPath());
    lens[i]=fStatus.getLen();
    assertEquals(trgLen,lens[i]);
    lblocks[i]=nn.getBlockLocations(path.toUri().getPath(),0,lens[i]);
    stm=dfs.open(path);
    stm.readFully(0,bytes[i]);
    stm.close();
  }
  final UserGroupInformation user1=UserGroupInformation.createUserForTesting("theDoctor",new String[]{"tardis"});
  DistributedFileSystem hdfs=(DistributedFileSystem)DFSTestUtil.getFileSystemAs(user1,conf);
  try {
    hdfs.concat(trgPath,files);
    fail("Permission exception expected");
  }
 catch (  IOException ie) {
    System.out.println("Got expected exception for permissions:" + ie.getLocalizedMessage());
  }
  ContentSummary cBefore=dfs.getContentSummary(trgPath.getParent());
  dfs.concat(trgPath,files);
  ContentSummary cAfter=dfs.getContentSummary(trgPath.getParent());
  assertEquals(cBefore.getFileCount(),cAfter.getFileCount() + files.length);
  long totalLen=trgLen;
  long totalBlocks=trgBlocks;
  for (i=0; i < files.length; i++) {
    totalLen+=lens[i];
    totalBlocks+=lblocks[i].locatedBlockCount();
  }
  System.out.println("total len=" + totalLen + "; totalBlocks="+ totalBlocks);
  fStatus=nn.getFileInfo(trg);
  trgLen=fStatus.getLen();
  stm=dfs.open(trgPath);
  byte[] byteFileConcat=new byte[(int)trgLen];
  stm.readFully(0,byteFileConcat);
  stm.close();
  trgBlocks=nn.getBlockLocations(trg,0,trgLen).locatedBlockCount();
  assertEquals(trgBlocks,totalBlocks);
  assertEquals(trgLen,totalLen);
  for (  Path p : files) {
    fStatus=nn.getFileInfo(p.toUri().getPath());
    assertNull("File " + p + " still exists",fStatus);
    DFSTestUtil.createFile(dfs,p,fileLen,REPL_FACTOR,1);
  }
  checkFileContent(byteFileConcat,bytes);
  Path smallFile=new Path("/sfile");
  int sFileLen=10;
  DFSTestUtil.createFile(dfs,smallFile,sFileLen,REPL_FACTOR,1);
  dfs.concat(trgPath,new Path[]{smallFile});
  fStatus=nn.getFileInfo(trg);
  trgLen=fStatus.getLen();
  trgBlocks=nn.getBlockLocations(trg,0,trgLen).locatedBlockCount();
  assertEquals(trgBlocks,totalBlocks + 1);
  assertEquals(trgLen,totalLen + sFileLen);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void startUpCluster() throws IOException {
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(REPL_FACTOR).build();
  assertNotNull("Failed Cluster Creation",cluster);
  cluster.waitClusterUp();
  dfs=cluster.getFileSystem();
  assertNotNull("Failed to get FileSystem",dfs);
  nn=cluster.getNameNodeRpc();
  assertNotNull("Failed to get NameNode",nn);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcatNotCompleteBlock() throws IOException {
  long trgFileLen=blockSize * 3;
  long srcFileLen=blockSize * 3 + 20;
  String name1="/trg", name2="/src";
  Path filePath1=new Path(name1);
  DFSTestUtil.createFile(dfs,filePath1,trgFileLen,REPL_FACTOR,1);
  HdfsFileStatus fStatus=nn.getFileInfo(name1);
  long fileLen=fStatus.getLen();
  assertEquals(fileLen,trgFileLen);
  FSDataInputStream stm=dfs.open(filePath1);
  byte[] byteFile1=new byte[(int)trgFileLen];
  stm.readFully(0,byteFile1);
  stm.close();
  LocatedBlocks lb1=nn.getBlockLocations(name1,0,trgFileLen);
  Path filePath2=new Path(name2);
  DFSTestUtil.createFile(dfs,filePath2,srcFileLen,REPL_FACTOR,1);
  fStatus=nn.getFileInfo(name2);
  fileLen=fStatus.getLen();
  assertEquals(srcFileLen,fileLen);
  stm=dfs.open(filePath2);
  byte[] byteFile2=new byte[(int)srcFileLen];
  stm.readFully(0,byteFile2);
  stm.close();
  LocatedBlocks lb2=nn.getBlockLocations(name2,0,srcFileLen);
  System.out.println("trg len=" + trgFileLen + "; src len="+ srcFileLen);
  dfs.concat(filePath1,new Path[]{filePath2});
  long totalLen=trgFileLen + srcFileLen;
  fStatus=nn.getFileInfo(name1);
  fileLen=fStatus.getLen();
  stm=dfs.open(filePath1);
  byte[] byteFileConcat=new byte[(int)fileLen];
  stm.readFully(0,byteFileConcat);
  stm.close();
  LocatedBlocks lbConcat=nn.getBlockLocations(name1,0,fileLen);
  assertEquals(lbConcat.locatedBlockCount(),lb1.locatedBlockCount() + lb2.locatedBlockCount());
  System.out.println("file1 len=" + fileLen + "; total len="+ totalLen);
  assertEquals(fileLen,totalLen);
  fStatus=nn.getFileInfo(name2);
  assertNull("File " + name2 + "still exists",fStatus);
  checkFileContent(byteFileConcat,new byte[][]{byteFile1,byteFile2});
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestLargeDirectoryDelete </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void largeDelete() throws Throwable {
  mc=new MiniDFSCluster.Builder(CONF).build();
  try {
    mc.waitActive();
    Assert.assertNotNull("No Namenode in cluster",mc.getNameNode());
    createFiles();
    Assert.assertEquals(TOTAL_BLOCKS,getBlockCount());
    runThreads();
  }
  finally {
    mc.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestLeaseManager </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRemoveLeaseWithPrefixPath() throws Exception {
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
  cluster.waitActive();
  LeaseManager lm=NameNodeAdapter.getLeaseManager(cluster.getNamesystem());
  lm.addLease("holder1","/a/b");
  lm.addLease("holder2","/a/c");
  assertNotNull(lm.getLeaseByPath("/a/b"));
  assertNotNull(lm.getLeaseByPath("/a/c"));
  lm.removeLeaseWithPrefixPath("/a");
  assertNull(lm.getLeaseByPath("/a/b"));
  assertNull(lm.getLeaseByPath("/a/c"));
  lm.addLease("holder1","/a/b");
  lm.addLease("holder2","/a/c");
  lm.removeLeaseWithPrefixPath("/a/");
  assertNull(lm.getLeaseByPath("/a/b"));
  assertNull(lm.getLeaseByPath("/a/c"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestNameNodeOptionParsing </h4><pre class="type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testUpgrade(){
  StartupOption opt=null;
  opt=NameNode.parseArguments(new String[]{"-upgrade"});
  assertEquals(opt,StartupOption.UPGRADE);
  assertNull(opt.getClusterId());
  assertTrue(FSImageFormat.renameReservedMap.isEmpty());
  opt=NameNode.parseArguments(new String[]{"-upgrade","-clusterid","mycid"});
  assertEquals(StartupOption.UPGRADE,opt);
  assertEquals("mycid",opt.getClusterId());
  assertTrue(FSImageFormat.renameReservedMap.isEmpty());
  opt=NameNode.parseArguments(new String[]{"-upgrade","-clusterid","mycid","-renameReserved",".snapshot=.my-snapshot,.reserved=.my-reserved"});
  assertEquals(StartupOption.UPGRADE,opt);
  assertEquals("mycid",opt.getClusterId());
  assertEquals(".my-snapshot",FSImageFormat.renameReservedMap.get(".snapshot"));
  assertEquals(".my-reserved",FSImageFormat.renameReservedMap.get(".reserved"));
  FSImageFormat.renameReservedMap.clear();
  opt=NameNode.parseArguments(new String[]{"-upgrade","-renameReserved",".reserved=.my-reserved,.snapshot=.my-snapshot","-clusterid","mycid"});
  assertEquals(StartupOption.UPGRADE,opt);
  assertEquals("mycid",opt.getClusterId());
  assertEquals(".my-snapshot",FSImageFormat.renameReservedMap.get(".snapshot"));
  assertEquals(".my-reserved",FSImageFormat.renameReservedMap.get(".reserved"));
  opt=NameNode.parseArguments(new String[]{"-upgrade","-renameReserved"});
  assertEquals(StartupOption.UPGRADE,opt);
  assertEquals(".snapshot." + HdfsConstants.NAMENODE_LAYOUT_VERSION + ".UPGRADE_RENAMED",FSImageFormat.renameReservedMap.get(".snapshot"));
  assertEquals(".reserved." + HdfsConstants.NAMENODE_LAYOUT_VERSION + ".UPGRADE_RENAMED",FSImageFormat.renameReservedMap.get(".reserved"));
  try {
    opt=NameNode.parseArguments(new String[]{"-upgrade","-renameReserved",".reserved=.my-reserved,.not-reserved=.my-not-reserved"});
  }
 catch (  IllegalArgumentException e) {
    assertExceptionContains("Unknown reserved path",e);
  }
  try {
    opt=NameNode.parseArguments(new String[]{"-upgrade","-renameReserved",".reserved=.my-reserved,.snapshot=.snapshot"});
  }
 catch (  IllegalArgumentException e) {
    assertExceptionContains("Invalid rename path",e);
  }
  try {
    opt=NameNode.parseArguments(new String[]{"-upgrade","-renameReserved",".snapshot=.reserved"});
  }
 catch (  IllegalArgumentException e) {
    assertExceptionContains("Invalid rename path",e);
  }
  opt=NameNode.parseArguments(new String[]{"-upgrade","-cid"});
  assertNull(opt);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestNamenodeRetryCache </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRetryCacheConfig(){
  Configuration conf=new HdfsConfiguration();
  Assert.assertNotNull(FSNamesystem.initRetryCache(conf));
  conf.setBoolean(DFSConfigKeys.DFS_NAMENODE_ENABLE_RETRY_CACHE_KEY,false);
  Assert.assertNull(FSNamesystem.initRetryCache(conf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestSecureNameNode </h4><pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testName() throws IOException, InterruptedException {
  MiniDFSCluster cluster=null;
  try {
    String keyTabDir=System.getProperty("kdc.resource.dir") + "/keytabs";
    String nn1KeytabPath=keyTabDir + "/nn1.keytab";
    String user1KeyTabPath=keyTabDir + "/user1.keytab";
    Configuration conf=new HdfsConfiguration();
    conf.set(CommonConfigurationKeys.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
    conf.set(DFSConfigKeys.DFS_NAMENODE_KERBEROS_PRINCIPAL_KEY,"nn1/localhost@EXAMPLE.COM");
    conf.set(DFSConfigKeys.DFS_NAMENODE_KEYTAB_FILE_KEY,nn1KeytabPath);
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_OF_DATANODES).build();
    final MiniDFSCluster clusterRef=cluster;
    cluster.waitActive();
    FileSystem fsForCurrentUser=cluster.getFileSystem();
    fsForCurrentUser.mkdirs(new Path("/tmp"));
    fsForCurrentUser.setPermission(new Path("/tmp"),new FsPermission((short)511));
    UserGroupInformation ugi=UserGroupInformation.loginUserFromKeytabAndReturnUGI("user1@EXAMPLE.COM",user1KeyTabPath);
    FileSystem fs=ugi.doAs(new PrivilegedExceptionAction<FileSystem>(){
      @Override public FileSystem run() throws Exception {
        return clusterRef.getFileSystem();
      }
    }
);
    try {
      Path p=new Path("/users");
      fs.mkdirs(p);
      fail("user1 must not be allowed to write in /");
    }
 catch (    IOException expected) {
    }
    Path p=new Path("/tmp/alpha");
    fs.mkdirs(p);
    assertNotNull(fs.listStatus(p));
    assertEquals(AuthenticationMethod.KERBEROS,ugi.getAuthenticationMethod());
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestSecureNameNodeWithExternalKdc </h4><pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecureNameNode() throws IOException, InterruptedException {
  MiniDFSCluster cluster=null;
  try {
    String nnPrincipal=System.getProperty("dfs.namenode.kerberos.principal");
    String nnSpnegoPrincipal=System.getProperty("dfs.namenode.kerberos.internal.spnego.principal");
    String nnKeyTab=System.getProperty("dfs.namenode.keytab.file");
    assertNotNull("NameNode principal was not specified",nnPrincipal);
    assertNotNull("NameNode SPNEGO principal was not specified",nnSpnegoPrincipal);
    assertNotNull("NameNode keytab was not specified",nnKeyTab);
    Configuration conf=new HdfsConfiguration();
    conf.set(CommonConfigurationKeys.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
    conf.set(DFSConfigKeys.DFS_NAMENODE_KERBEROS_PRINCIPAL_KEY,nnPrincipal);
    conf.set(DFSConfigKeys.DFS_NAMENODE_KERBEROS_INTERNAL_SPNEGO_PRINCIPAL_KEY,nnSpnegoPrincipal);
    conf.set(DFSConfigKeys.DFS_NAMENODE_KEYTAB_FILE_KEY,nnKeyTab);
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_OF_DATANODES).build();
    final MiniDFSCluster clusterRef=cluster;
    cluster.waitActive();
    FileSystem fsForCurrentUser=cluster.getFileSystem();
    fsForCurrentUser.mkdirs(new Path("/tmp"));
    fsForCurrentUser.setPermission(new Path("/tmp"),new FsPermission((short)511));
    String userPrincipal=System.getProperty("user.principal");
    String userKeyTab=System.getProperty("user.keytab");
    assertNotNull("User principal was not specified",userPrincipal);
    assertNotNull("User keytab was not specified",userKeyTab);
    UserGroupInformation ugi=UserGroupInformation.loginUserFromKeytabAndReturnUGI(userPrincipal,userKeyTab);
    FileSystem fs=ugi.doAs(new PrivilegedExceptionAction<FileSystem>(){
      @Override public FileSystem run() throws Exception {
        return clusterRef.getFileSystem();
      }
    }
);
    try {
      Path p=new Path("/users");
      fs.mkdirs(p);
      fail("User must not be allowed to write in /");
    }
 catch (    IOException expected) {
    }
    Path p=new Path("/tmp/alpha");
    fs.mkdirs(p);
    assertNotNull(fs.listStatus(p));
    assertEquals(AuthenticationMethod.KERBEROS,ugi.getAuthenticationMethod());
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestSnapshotPathINodes </h4><pre class="type-9 type-7 type-1 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link INodeDirectory#getExistingPathINodes(byte[][],int,boolean)} 
 * for snapshot file while adding a new file after snapshot.
 */
@Test(timeout=15000) public void testSnapshotPathINodesWithAddedFile() throws Exception {
  hdfs.allowSnapshot(sub1);
  hdfs.createSnapshot(sub1,"s4");
  final Path file3=new Path(sub1,"file3");
  DFSTestUtil.createFile(hdfs,file3,1024,REPLICATION,seed);
{
    String snapshotPath=sub1.toString() + "/.snapshot/s4/file3";
    String[] names=INode.getPathNames(snapshotPath);
    byte[][] components=INode.getPathComponents(names);
    INodesInPath nodesInPath=INodesInPath.resolve(fsdir.rootDir,components);
    INode[] inodes=nodesInPath.getINodes();
    assertEquals(inodes.length,components.length - 1);
    assertEquals(nodesInPath.getNumNonNull(),components.length - 2);
    s4=getSnapshot(nodesInPath,"s4");
    assertSnapshot(nodesInPath,true,s4,3);
    assertNull(inodes[inodes.length - 1]);
  }
  String[] names=INode.getPathNames(file3.toString());
  byte[][] components=INode.getPathComponents(names);
  INodesInPath nodesInPath=INodesInPath.resolve(fsdir.rootDir,components);
  INode[] inodes=nodesInPath.getINodes();
  assertEquals(inodes.length,components.length);
  assertSnapshot(nodesInPath,false,s4,-1);
  assertEquals(inodes[components.length - 1].getFullPathName(),file3.toString());
  assertEquals(inodes[components.length - 2].getFullPathName(),sub1.toString());
  assertEquals(inodes[components.length - 3].getFullPathName(),dir.toString());
  hdfs.deleteSnapshot(sub1,"s4");
  hdfs.disallowSnapshot(sub1);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link INodeDirectory#getExistingPathINodes(byte[][],int,boolean)} 
 * for snapshot file after deleting the original file.
 */
@Test(timeout=15000) public void testSnapshotPathINodesAfterDeletion() throws Exception {
  hdfs.allowSnapshot(sub1);
  hdfs.createSnapshot(sub1,"s2");
  hdfs.delete(file1,false);
  final Snapshot snapshot;
{
    String snapshotPath=sub1.toString() + "/.snapshot/s2/file1";
    String[] names=INode.getPathNames(snapshotPath);
    byte[][] components=INode.getPathComponents(names);
    INodesInPath nodesInPath=INodesInPath.resolve(fsdir.rootDir,components);
    INode[] inodes=nodesInPath.getINodes();
    assertEquals(inodes.length,components.length - 1);
    snapshot=getSnapshot(nodesInPath,"s2");
    assertSnapshot(nodesInPath,true,snapshot,3);
    final INode inode=inodes[inodes.length - 1];
    assertEquals(file1.getName(),inode.getLocalName());
    assertTrue(inode.asFile().isWithSnapshot());
  }
  String[] names=INode.getPathNames(file1.toString());
  byte[][] components=INode.getPathComponents(names);
  INodesInPath nodesInPath=INodesInPath.resolve(fsdir.rootDir,components);
  INode[] inodes=nodesInPath.getINodes();
  assertEquals(inodes.length,components.length);
  assertEquals(nodesInPath.getNumNonNull(),components.length - 1);
  assertSnapshot(nodesInPath,false,snapshot,-1);
  assertNull(inodes[components.length - 1]);
  assertEquals(inodes[components.length - 2].getFullPathName(),sub1.toString());
  assertEquals(inodes[components.length - 3].getFullPathName(),dir.toString());
  hdfs.deleteSnapshot(sub1,"s2");
  hdfs.disallowSnapshot(sub1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestStartup </h4><pre class="type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * secnn-7
 * secondary node copies fsimage and edits into correct separate directories.
 * @throws IOException
 */
@Test public void testSNNStartup() throws IOException {
  LOG.info("--starting SecondNN startup test");
  config.set(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY,fileAsURI(new File(hdfsDir,"name")).toString());
  config.set(DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_KEY,fileAsURI(new File(hdfsDir,"name")).toString());
  config.set(DFSConfigKeys.DFS_NAMENODE_CHECKPOINT_EDITS_DIR_KEY,fileAsURI(new File(hdfsDir,"chkpt_edits")).toString());
  config.set(DFSConfigKeys.DFS_NAMENODE_CHECKPOINT_DIR_KEY,fileAsURI(new File(hdfsDir,"chkpt")).toString());
  LOG.info("--starting NN ");
  MiniDFSCluster cluster=null;
  SecondaryNameNode sn=null;
  NameNode nn=null;
  try {
    cluster=new MiniDFSCluster.Builder(config).manageDataDfsDirs(false).manageNameDfsDirs(false).build();
    cluster.waitActive();
    nn=cluster.getNameNode();
    assertNotNull(nn);
    LOG.info("--starting SecondNN");
    sn=new SecondaryNameNode(config);
    assertNotNull(sn);
    LOG.info("--doing checkpoint");
    sn.doCheckpoint();
    LOG.info("--done checkpoint");
    FSImage image=nn.getFSImage();
    StorageDirectory sd=image.getStorage().getStorageDir(0);
    assertEquals(sd.getStorageDirType(),NameNodeDirType.IMAGE_AND_EDITS);
    image.getStorage();
    File imf=NNStorage.getStorageFile(sd,NameNodeFile.IMAGE,0);
    image.getStorage();
    File edf=NNStorage.getStorageFile(sd,NameNodeFile.EDITS,0);
    LOG.info("--image file " + imf.getAbsolutePath() + "; len = "+ imf.length());
    LOG.info("--edits file " + edf.getAbsolutePath() + "; len = "+ edf.length());
    FSImage chkpImage=sn.getFSImage();
    verifyDifferentDirs(chkpImage,imf.length(),edf.length());
  }
 catch (  IOException e) {
    fail(StringUtils.stringifyException(e));
    System.err.println("checkpoint failed");
    throw e;
  }
 finally {
    if (sn != null)     sn.shutdown();
    if (cluster != null)     cluster.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test tests hosts include list contains host names.  After namenode
 * restarts, the still alive datanodes should not have any trouble in getting
 * registrant again.
 */
@Test public void testNNRestart() throws IOException, InterruptedException {
  MiniDFSCluster cluster=null;
  FileSystem localFileSys;
  Path hostsFile;
  Path excludeFile;
  int HEARTBEAT_INTERVAL=1;
  localFileSys=FileSystem.getLocal(config);
  Path workingDir=localFileSys.getWorkingDirectory();
  Path dir=new Path(workingDir,"build/test/data/work-dir/restartnn");
  hostsFile=new Path(dir,"hosts");
  excludeFile=new Path(dir,"exclude");
  config.set(DFSConfigKeys.DFS_HOSTS_EXCLUDE,excludeFile.toUri().getPath());
  writeConfigFile(localFileSys,excludeFile,null);
  config.set(DFSConfigKeys.DFS_HOSTS,hostsFile.toUri().getPath());
  ArrayList<String> list=new ArrayList<String>();
  byte b[]={127,0,0,1};
  InetAddress inetAddress=InetAddress.getByAddress(b);
  list.add(inetAddress.getHostName());
  writeConfigFile(localFileSys,hostsFile,list);
  int numDatanodes=1;
  try {
    cluster=new MiniDFSCluster.Builder(config).numDataNodes(numDatanodes).setupHostsFile(true).build();
    cluster.waitActive();
    cluster.restartNameNode();
    NamenodeProtocols nn=cluster.getNameNodeRpc();
    assertNotNull(nn);
    assertTrue(cluster.isDataNodeUp());
    DatanodeInfo[] info=nn.getDatanodeReport(DatanodeReportType.LIVE);
    for (int i=0; i < 5 && info.length != numDatanodes; i++) {
      Thread.sleep(HEARTBEAT_INTERVAL * 1000);
      info=nn.getDatanodeReport(DatanodeReportType.LIVE);
    }
    assertEquals("Number of live nodes should be " + numDatanodes,numDatanodes,info.length);
  }
 catch (  IOException e) {
    fail(StringUtils.stringifyException(e));
    throw e;
  }
 finally {
    cleanupFile(localFileSys,excludeFile.getParent());
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.TestStartupProgressServlet </h4><pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRunningState() throws Exception {
  setStartupProgressForRunningState(startupProgress);
  String respBody=doGetAndReturnResponseBody();
  assertNotNull(respBody);
  Map<String,Object> expected=ImmutableMap.<String,Object>builder().put("percentComplete",0.375f).put("phases",Arrays.asList(ImmutableMap.<String,Object>builder().put("name","LoadingFsImage").put("desc","Loading fsimage").put("status","COMPLETE").put("percentComplete",1.0f).put("steps",Collections.singletonList(ImmutableMap.<String,Object>builder().put("name","Inodes").put("desc","inodes").put("count",100L).put("total",100L).put("percentComplete",1.0f).build())).build(),ImmutableMap.<String,Object>builder().put("name","LoadingEdits").put("desc","Loading edits").put("status","RUNNING").put("percentComplete",0.5f).put("steps",Collections.singletonList(ImmutableMap.<String,Object>builder().put("count",100L).put("file","file").put("size",1000L).put("total",200L).put("percentComplete",0.5f).build())).build(),ImmutableMap.<String,Object>builder().put("name","SavingCheckpoint").put("desc","Saving checkpoint").put("status","PENDING").put("percentComplete",0.0f).put("steps",Collections.emptyList()).build(),ImmutableMap.<String,Object>builder().put("name","SafeMode").put("desc","Safe mode").put("status","PENDING").put("percentComplete",0.0f).put("steps",Collections.emptyList()).build())).build();
  assertEquals(JSON.toString(expected),filterJson(respBody));
}

</code></pre>

<br>
<pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitialState() throws Exception {
  String respBody=doGetAndReturnResponseBody();
  assertNotNull(respBody);
  Map<String,Object> expected=ImmutableMap.<String,Object>builder().put("percentComplete",0.0f).put("phases",Arrays.asList(ImmutableMap.<String,Object>builder().put("name","LoadingFsImage").put("desc","Loading fsimage").put("status","PENDING").put("percentComplete",0.0f).put("steps",Collections.emptyList()).build(),ImmutableMap.<String,Object>builder().put("name","LoadingEdits").put("desc","Loading edits").put("status","PENDING").put("percentComplete",0.0f).put("steps",Collections.emptyList()).build(),ImmutableMap.<String,Object>builder().put("name","SavingCheckpoint").put("desc","Saving checkpoint").put("status","PENDING").put("percentComplete",0.0f).put("steps",Collections.emptyList()).build(),ImmutableMap.<String,Object>builder().put("name","SafeMode").put("desc","Safe mode").put("status","PENDING").put("percentComplete",0.0f).put("steps",Collections.emptyList()).build())).build();
  assertEquals(JSON.toString(expected),filterJson(respBody));
}

</code></pre>

<br>
<pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinalState() throws Exception {
  setStartupProgressForFinalState(startupProgress);
  String respBody=doGetAndReturnResponseBody();
  assertNotNull(respBody);
  Map<String,Object> expected=ImmutableMap.<String,Object>builder().put("percentComplete",1.0f).put("phases",Arrays.asList(ImmutableMap.<String,Object>builder().put("name","LoadingFsImage").put("desc","Loading fsimage").put("status","COMPLETE").put("percentComplete",1.0f).put("steps",Collections.singletonList(ImmutableMap.<String,Object>builder().put("name","Inodes").put("desc","inodes").put("count",100L).put("total",100L).put("percentComplete",1.0f).build())).build(),ImmutableMap.<String,Object>builder().put("name","LoadingEdits").put("desc","Loading edits").put("status","COMPLETE").put("percentComplete",1.0f).put("steps",Collections.singletonList(ImmutableMap.<String,Object>builder().put("count",200L).put("file","file").put("size",1000L).put("total",200L).put("percentComplete",1.0f).build())).build(),ImmutableMap.<String,Object>builder().put("name","SavingCheckpoint").put("desc","Saving checkpoint").put("status","COMPLETE").put("percentComplete",1.0f).put("steps",Collections.singletonList(ImmutableMap.<String,Object>builder().put("name","Inodes").put("desc","inodes").put("count",300L).put("total",300L).put("percentComplete",1.0f).build())).build(),ImmutableMap.<String,Object>builder().put("name","SafeMode").put("desc","Safe mode").put("status","COMPLETE").put("percentComplete",1.0f).put("steps",Collections.singletonList(ImmutableMap.<String,Object>builder().put("name","AwaitingReportedBlocks").put("desc","awaiting reported blocks").put("count",400L).put("total",400L).put("percentComplete",1.0f).build())).build())).build();
  assertEquals(JSON.toString(expected),filterJson(respBody));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.ha.TestDelegationTokensWithHA </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHAUtilClonesDelegationTokens() throws Exception {
  final Token<DelegationTokenIdentifier> token=getDelegationToken(fs,"JobTracker");
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser("test");
  URI haUri=new URI("hdfs://my-ha-uri/");
  token.setService(HAUtil.buildTokenServiceForLogicalUri(haUri,HdfsConstants.HDFS_URI_SCHEME));
  ugi.addToken(token);
  Collection<InetSocketAddress> nnAddrs=new HashSet<InetSocketAddress>();
  nnAddrs.add(new InetSocketAddress("localhost",nn0.getNameNodeAddress().getPort()));
  nnAddrs.add(new InetSocketAddress("localhost",nn1.getNameNodeAddress().getPort()));
  HAUtil.cloneDelegationTokenForLogicalUri(ugi,haUri,nnAddrs);
  Collection<Token<? extends TokenIdentifier>> tokens=ugi.getTokens();
  assertEquals(3,tokens.size());
  LOG.info("Tokens:\n" + Joiner.on("\n").join(tokens));
  DelegationTokenSelector dts=new DelegationTokenSelector();
  for (  InetSocketAddress addr : nnAddrs) {
    Text ipcDtService=SecurityUtil.buildTokenService(addr);
    Token<DelegationTokenIdentifier> token2=dts.selectToken(ipcDtService,ugi.getTokens());
    assertNotNull(token2);
    assertArrayEquals(token.getIdentifier(),token2.getIdentifier());
    assertArrayEquals(token.getPassword(),token2.getPassword());
  }
  SecurityUtilTestHelper.setTokenServiceUseIp(false);
  for (  InetSocketAddress addr : nnAddrs) {
    Text ipcDtService=SecurityUtil.buildTokenService(addr);
    Token<DelegationTokenIdentifier> token2=dts.selectToken(ipcDtService,ugi.getTokens());
    assertNull(token2);
  }
  HAUtil.cloneDelegationTokenForLogicalUri(ugi,haUri,nnAddrs);
  for (  InetSocketAddress addr : nnAddrs) {
    Text ipcDtService=SecurityUtil.buildTokenService(addr);
    Token<DelegationTokenIdentifier> token2=dts.selectToken(ipcDtService,ugi.getTokens());
    assertNotNull(token2);
    assertArrayEquals(token.getIdentifier(),token2.getIdentifier());
    assertArrayEquals(token.getPassword(),token2.getPassword());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.ha.TestEditLogsDuringFailover </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testStartup() throws Exception {
  Configuration conf=new Configuration();
  HAUtil.setAllowStandbyReads(conf,true);
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleHATopology()).numDataNodes(0).build();
  try {
    List<URI> allDirs=Lists.newArrayList();
    allDirs.addAll(cluster.getNameDirs(0));
    allDirs.addAll(cluster.getNameDirs(1));
    allDirs.add(cluster.getSharedEditsDir(0,1));
    assertNoEditFiles(allDirs);
    cluster.transitionToActive(0);
    assertEditFiles(cluster.getNameDirs(0),NNStorage.getInProgressEditsFileName(1));
    assertEditFiles(Collections.singletonList(cluster.getSharedEditsDir(0,1)),NNStorage.getInProgressEditsFileName(1));
    assertNoEditFiles(cluster.getNameDirs(1));
    cluster.getNameNode(0).getRpcServer().mkdirs("/test",FsPermission.createImmutable((short)0755),true);
    cluster.restartNameNode(1);
    assertEditFiles(cluster.getNameDirs(0),NNStorage.getInProgressEditsFileName(1));
    assertEditFiles(Collections.singletonList(cluster.getSharedEditsDir(0,1)),NNStorage.getInProgressEditsFileName(1));
    assertNoEditFiles(cluster.getNameDirs(1));
    assertNull(NameNodeAdapter.getFileInfo(cluster.getNameNode(1),"/test",true));
    cluster.getNameNode(0).getRpcServer().mkdirs("/test2",FsPermission.createImmutable((short)0755),true);
    cluster.restartNameNode(0);
    cluster.transitionToActive(1);
    assertNotNull(NameNodeAdapter.getFileInfo(cluster.getNameNode(1),"/test",true));
    assertNotNull(NameNodeAdapter.getFileInfo(cluster.getNameNode(1),"/test2",true));
  }
  finally {
    cluster.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.ha.TestFailureToReadEdits </h4><pre class="type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the standby NN won't double-replay earlier edits if it encounters
 * a failure to read a later edit.
 */
@Test public void testFailuretoReadEdits() throws Exception {
  assertTrue(fs.mkdirs(new Path(TEST_DIR1)));
  HATestUtil.waitForStandbyToCatchUp(nn0,nn1);
  fs.setOwner(new Path(TEST_DIR1),"foo","bar");
  assertTrue(fs.delete(new Path(TEST_DIR1),true));
  assertTrue(fs.mkdirs(new Path(TEST_DIR2)));
  assertTrue(fs.mkdirs(new Path(TEST_DIR3)));
  LimitedEditLogAnswer answer=causeFailureOnEditLogRead();
  try {
    HATestUtil.waitForStandbyToCatchUp(nn0,nn1);
    fail("Standby fully caught up, but should not have been able to");
  }
 catch (  HATestUtil.CouldNotCatchUpException e) {
  }
  assertNull(NameNodeAdapter.getFileInfo(nn1,TEST_DIR1,false));
  assertTrue(NameNodeAdapter.getFileInfo(nn1,TEST_DIR2,false).isDir());
  assertNull(NameNodeAdapter.getFileInfo(nn1,TEST_DIR3,false));
  answer.setThrowExceptionOnRead(false);
  HATestUtil.waitForStandbyToCatchUp(nn0,nn1);
  assertNull(NameNodeAdapter.getFileInfo(nn1,TEST_DIR1,false));
  assertTrue(NameNodeAdapter.getFileInfo(nn1,TEST_DIR2,false).isDir());
  assertTrue(NameNodeAdapter.getFileInfo(nn1,TEST_DIR3,false).isDir());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.ha.TestInitializeSharedEdits </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testInitializeSharedEditsConfiguresGenericConfKeys() throws IOException {
  Configuration conf=new Configuration();
  conf.set(DFSConfigKeys.DFS_NAMESERVICES,"ns1");
  conf.set(DFSUtil.addKeySuffixes(DFSConfigKeys.DFS_HA_NAMENODES_KEY_PREFIX,"ns1"),"nn1,nn2");
  conf.set(DFSUtil.addKeySuffixes(DFSConfigKeys.DFS_NAMENODE_RPC_ADDRESS_KEY,"ns1","nn1"),"localhost:1234");
  assertNull(conf.get(DFSConfigKeys.DFS_NAMENODE_RPC_ADDRESS_KEY));
  NameNode.initializeSharedEdits(conf);
  assertNotNull(conf.get(DFSConfigKeys.DFS_NAMENODE_RPC_ADDRESS_KEY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.snapshot.TestSnapshot </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test if the OfflineImageViewerPB can correctly parse a fsimage containing
 * snapshots
 */
@Test public void testOfflineImageViewer() throws Exception {
  runTestSnapshot(1);
  File originalFsimage=FSImageTestUtil.findLatestImageFile(FSImageTestUtil.getFSImage(cluster.getNameNode()).getStorage().getStorageDir(0));
  assertNotNull("Didn't generate or can't find fsimage",originalFsimage);
  StringWriter output=new StringWriter();
  PrintWriter o=new PrintWriter(output);
  PBImageXmlWriter v=new PBImageXmlWriter(new Configuration(),o);
  v.visit(new RandomAccessFile(originalFsimage,"r"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.snapshot.TestSnapshotBlocksMap </h4><pre class="type-9 type-2 type-7 type-10 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test deleting a file with snapshots. Need to check the blocksMap to make
 * sure the corresponding record is updated correctly.
 */
@Test(timeout=60000) public void testDeletionWithSnapshots() throws Exception {
  Path file0=new Path(sub1,"file0");
  Path file1=new Path(sub1,"file1");
  Path sub2=new Path(sub1,"sub2");
  Path file2=new Path(sub2,"file2");
  Path file3=new Path(sub1,"file3");
  Path file4=new Path(sub1,"file4");
  Path file5=new Path(sub1,"file5");
  DFSTestUtil.createFile(hdfs,file0,4 * BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,file1,2 * BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,file2,3 * BLOCKSIZE,REPLICATION,seed);
{
    final INodeFile f2=assertBlockCollection(file2.toString(),3,fsdir,blockmanager);
    BlockInfo[] blocks=f2.getBlocks();
    hdfs.delete(sub2,true);
    for (    BlockInfo b : blocks) {
      assertNull(blockmanager.getBlockCollection(b));
    }
  }
  final String[] snapshots={"s0","s1","s2"};
  DFSTestUtil.createFile(hdfs,file3,5 * BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,sub1,snapshots[0]);
  DFSTestUtil.createFile(hdfs,file4,1 * BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,sub1,snapshots[1]);
  DFSTestUtil.createFile(hdfs,file5,7 * BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,sub1,snapshots[2]);
{
    INodeFile f1=assertBlockCollection(file1.toString(),2,fsdir,blockmanager);
    Assert.assertSame(INodeFile.class,f1.getClass());
    hdfs.setReplication(file1,(short)2);
    f1=assertBlockCollection(file1.toString(),2,fsdir,blockmanager);
    assertTrue(f1.isWithSnapshot());
    assertFalse(f1.isUnderConstruction());
  }
  final INodeFile f0=assertBlockCollection(file0.toString(),4,fsdir,blockmanager);
  BlockInfo[] blocks0=f0.getBlocks();
  Path snapshotFile0=SnapshotTestHelper.getSnapshotPath(sub1,"s0",file0.getName());
  assertBlockCollection(snapshotFile0.toString(),4,fsdir,blockmanager);
  hdfs.delete(file0,true);
  for (  BlockInfo b : blocks0) {
    assertNotNull(blockmanager.getBlockCollection(b));
  }
  assertBlockCollection(snapshotFile0.toString(),4,fsdir,blockmanager);
  String s1f0=SnapshotTestHelper.getSnapshotPath(sub1,"s1",file0.getName()).toString();
  assertBlockCollection(s1f0,4,fsdir,blockmanager);
  hdfs.deleteSnapshot(sub1,"s1");
  for (  BlockInfo b : blocks0) {
    assertNotNull(blockmanager.getBlockCollection(b));
  }
  assertBlockCollection(snapshotFile0.toString(),4,fsdir,blockmanager);
  try {
    INodeFile.valueOf(fsdir.getINode(s1f0),s1f0);
    fail("Expect FileNotFoundException when identifying the INode in a deleted Snapshot");
  }
 catch (  IOException e) {
    assertExceptionContains("File does not exist: " + s1f0,e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.snapshot.TestSnapshotDeletion </h4><pre class="type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test deleting the earliest (first) snapshot. In this more complicated 
 * scenario, the snapshots are taken across directories.
 * <pre>
 * The test covers the following scenarios:
 * 1. delete the first diff in the diff list of a directory
 * 2. delete the first diff in the diff list of a file
 * </pre>
 * Also, the recursive cleanTree process should cover both INodeFile and 
 * INodeDirectory.
 */
@Test(timeout=300000) public void testDeleteEarliestSnapshot2() throws Exception {
  Path noChangeDir=new Path(sub,"noChangeDir");
  Path noChangeFile=new Path(noChangeDir,"noChangeFile");
  Path metaChangeFile=new Path(noChangeDir,"metaChangeFile");
  Path metaChangeDir=new Path(noChangeDir,"metaChangeDir");
  Path toDeleteFile=new Path(metaChangeDir,"toDeleteFile");
  DFSTestUtil.createFile(hdfs,noChangeFile,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,metaChangeFile,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,toDeleteFile,BLOCKSIZE,REPLICATION,seed);
  final INodeFile toDeleteFileNode=TestSnapshotBlocksMap.assertBlockCollection(toDeleteFile.toString(),1,fsdir,blockmanager);
  BlockInfo[] blocks=toDeleteFileNode.getBlocks();
  SnapshotTestHelper.createSnapshot(hdfs,dir,"s0");
  checkQuotaUsageComputation(dir,8,3 * BLOCKSIZE * REPLICATION);
  hdfs.delete(toDeleteFile,true);
  checkQuotaUsageComputation(dir,10,3 * BLOCKSIZE * REPLICATION);
  hdfs.setReplication(metaChangeFile,REPLICATION_1);
  hdfs.setOwner(metaChangeDir,"unknown","unknown");
  checkQuotaUsageComputation(dir,11,3 * BLOCKSIZE * REPLICATION);
  hdfs.createSnapshot(dir,"s1");
  checkQuotaUsageComputation(dir,12,3 * BLOCKSIZE * REPLICATION);
  hdfs.deleteSnapshot(dir,"s0");
  checkQuotaUsageComputation(dir,7,2 * BLOCKSIZE * REPLICATION - BLOCKSIZE);
  for (  BlockInfo b : blocks) {
    assertNull(blockmanager.getBlockCollection(b));
  }
  final INodeDirectory dirNode=fsdir.getINode(dir.toString()).asDirectory();
  Snapshot snapshot0=dirNode.getSnapshot(DFSUtil.string2Bytes("s0"));
  assertNull(snapshot0);
  Snapshot snapshot1=dirNode.getSnapshot(DFSUtil.string2Bytes("s1"));
  DirectoryDiffList diffList=dirNode.getDiffs();
  assertEquals(1,diffList.asList().size());
  assertEquals(snapshot1.getId(),diffList.getLast().getSnapshotId());
  diffList=fsdir.getINode(metaChangeDir.toString()).asDirectory().getDiffs();
  assertEquals(0,diffList.asList().size());
  final INodeDirectory noChangeDirNode=(INodeDirectory)fsdir.getINode(noChangeDir.toString());
  assertEquals(INodeDirectory.class,noChangeDirNode.getClass());
  final INodeFile noChangeFileNode=(INodeFile)fsdir.getINode(noChangeFile.toString());
  assertEquals(INodeFile.class,noChangeFileNode.getClass());
  TestSnapshotBlocksMap.assertBlockCollection(noChangeFile.toString(),1,fsdir,blockmanager);
  FileStatus status=hdfs.getFileStatus(metaChangeDir);
  assertEquals("unknown",status.getOwner());
  assertEquals("unknown",status.getGroup());
  status=hdfs.getFileStatus(metaChangeFile);
  assertEquals(REPLICATION_1,status.getReplication());
  TestSnapshotBlocksMap.assertBlockCollection(metaChangeFile.toString(),1,fsdir,blockmanager);
  try {
    status=hdfs.getFileStatus(toDeleteFile);
    fail("should throw FileNotFoundException");
  }
 catch (  FileNotFoundException e) {
    GenericTestUtils.assertExceptionContains("File does not exist: " + toDeleteFile.toString(),e);
  }
  final Path toDeleteFileInSnapshot=SnapshotTestHelper.getSnapshotPath(dir,"s0",toDeleteFile.toString().substring(dir.toString().length()));
  try {
    status=hdfs.getFileStatus(toDeleteFileInSnapshot);
    fail("should throw FileNotFoundException");
  }
 catch (  FileNotFoundException e) {
    GenericTestUtils.assertExceptionContains("File does not exist: " + toDeleteFileInSnapshot.toString(),e);
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test deleting a directory which is a descendant of a snapshottable
 * directory. In the test we need to cover the following cases:
 * <pre>
 * 1. Delete current INodeFile/INodeDirectory without taking any snapshot.
 * 2. Delete current INodeFile/INodeDirectory while snapshots have been taken 
 * on ancestor(s).
 * 3. Delete current INodeFileWithSnapshot.
 * 4. Delete current INodeDirectoryWithSnapshot.
 * </pre>
 */
@Test(timeout=300000) public void testDeleteCurrentFileDirectory() throws Exception {
  Path deleteDir=new Path(subsub,"deleteDir");
  Path deleteFile=new Path(deleteDir,"deleteFile");
  Path noChangeDirParent=new Path(sub,"noChangeDirParent");
  Path noChangeDir=new Path(noChangeDirParent,"noChangeDir");
  Path noChangeFile=new Path(noChangeDir,"noChangeFile");
  DFSTestUtil.createFile(hdfs,deleteFile,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,noChangeFile,BLOCKSIZE,REPLICATION,seed);
  Path metaChangeFile1=new Path(subsub,"metaChangeFile1");
  DFSTestUtil.createFile(hdfs,metaChangeFile1,BLOCKSIZE,REPLICATION,seed);
  Path metaChangeFile2=new Path(noChangeDir,"metaChangeFile2");
  DFSTestUtil.createFile(hdfs,metaChangeFile2,BLOCKSIZE,REPLICATION,seed);
  hdfs.delete(deleteDir,true);
  SnapshotTestHelper.createSnapshot(hdfs,dir,"s0");
  Path tempDir=new Path(dir,"tempdir");
  Path tempFile=new Path(tempDir,"tempfile");
  DFSTestUtil.createFile(hdfs,tempFile,BLOCKSIZE,REPLICATION,seed);
  final INodeFile temp=TestSnapshotBlocksMap.assertBlockCollection(tempFile.toString(),1,fsdir,blockmanager);
  BlockInfo[] blocks=temp.getBlocks();
  hdfs.delete(tempDir,true);
  checkQuotaUsageComputation(dir,9L,BLOCKSIZE * REPLICATION * 3);
  for (  BlockInfo b : blocks) {
    assertNull(blockmanager.getBlockCollection(b));
  }
  Path newFileAfterS0=new Path(subsub,"newFile");
  DFSTestUtil.createFile(hdfs,newFileAfterS0,BLOCKSIZE,REPLICATION,seed);
  hdfs.setReplication(metaChangeFile1,REPLICATION_1);
  hdfs.setReplication(metaChangeFile2,REPLICATION_1);
  SnapshotTestHelper.createSnapshot(hdfs,dir,"s1");
  checkQuotaUsageComputation(dir,14L,BLOCKSIZE * REPLICATION * 4);
  Snapshot snapshot0=fsdir.getINode(dir.toString()).asDirectory().getSnapshot(DFSUtil.string2Bytes("s0"));
  Snapshot snapshot1=fsdir.getINode(dir.toString()).asDirectory().getSnapshot(DFSUtil.string2Bytes("s1"));
  hdfs.delete(noChangeDirParent,true);
  checkQuotaUsageComputation(dir,17L,BLOCKSIZE * REPLICATION * 4);
  Path snapshotNoChangeDir=SnapshotTestHelper.getSnapshotPath(dir,"s1",sub.getName() + "/" + noChangeDirParent.getName()+ "/"+ noChangeDir.getName());
  INodeDirectory snapshotNode=(INodeDirectory)fsdir.getINode(snapshotNoChangeDir.toString());
  assertEquals(INodeDirectory.class,snapshotNode.getClass());
  ReadOnlyList<INode> children=snapshotNode.getChildrenList(Snapshot.CURRENT_STATE_ID);
  assertEquals(2,children.size());
  INode noChangeFileSCopy=children.get(1);
  assertEquals(noChangeFile.getName(),noChangeFileSCopy.getLocalName());
  assertEquals(INodeFile.class,noChangeFileSCopy.getClass());
  TestSnapshotBlocksMap.assertBlockCollection(new Path(snapshotNoChangeDir,noChangeFileSCopy.getLocalName()).toString(),1,fsdir,blockmanager);
  INodeFile metaChangeFile2SCopy=children.get(0).asFile();
  assertEquals(metaChangeFile2.getName(),metaChangeFile2SCopy.getLocalName());
  assertTrue(metaChangeFile2SCopy.isWithSnapshot());
  assertFalse(metaChangeFile2SCopy.isUnderConstruction());
  TestSnapshotBlocksMap.assertBlockCollection(new Path(snapshotNoChangeDir,metaChangeFile2SCopy.getLocalName()).toString(),1,fsdir,blockmanager);
  assertEquals(REPLICATION_1,metaChangeFile2SCopy.getFileReplication(Snapshot.CURRENT_STATE_ID));
  assertEquals(REPLICATION_1,metaChangeFile2SCopy.getFileReplication(snapshot1.getId()));
  assertEquals(REPLICATION,metaChangeFile2SCopy.getFileReplication(snapshot0.getId()));
  Path newFile=new Path(sub,"newFile");
  DFSTestUtil.createFile(hdfs,newFile,BLOCKSIZE,REPLICATION,seed);
  final INodeFile newFileNode=TestSnapshotBlocksMap.assertBlockCollection(newFile.toString(),1,fsdir,blockmanager);
  blocks=newFileNode.getBlocks();
  checkQuotaUsageComputation(dir,18L,BLOCKSIZE * REPLICATION * 5);
  hdfs.delete(sub,true);
  checkQuotaUsageComputation(dir,19L,BLOCKSIZE * REPLICATION * 4);
  for (  BlockInfo b : blocks) {
    assertNull(blockmanager.getBlockCollection(b));
  }
  Path snapshotSub=SnapshotTestHelper.getSnapshotPath(dir,"s1",sub.getName());
  INodeDirectory snapshotNode4Sub=fsdir.getINode(snapshotSub.toString()).asDirectory();
  assertTrue(snapshotNode4Sub.isWithSnapshot());
  assertEquals(1,snapshotNode4Sub.getChildrenList(Snapshot.CURRENT_STATE_ID).size());
  assertEquals(2,snapshotNode4Sub.getChildrenList(snapshot1.getId()).size());
  INode snapshotNode4Subsub=snapshotNode4Sub.getChildrenList(Snapshot.CURRENT_STATE_ID).get(0);
  assertTrue(snapshotNode4Subsub.asDirectory().isWithSnapshot());
  assertTrue(snapshotNode4Sub == snapshotNode4Subsub.getParent());
  INodeDirectory snapshotSubsubDir=(INodeDirectory)snapshotNode4Subsub;
  children=snapshotSubsubDir.getChildrenList(Snapshot.CURRENT_STATE_ID);
  assertEquals(2,children.size());
  assertEquals(children.get(0).getLocalName(),metaChangeFile1.getName());
  assertEquals(children.get(1).getLocalName(),newFileAfterS0.getName());
  children=snapshotSubsubDir.getChildrenList(snapshot0.getId());
  assertEquals(1,children.size());
  INode child=children.get(0);
  assertEquals(child.getLocalName(),metaChangeFile1.getName());
  INodeFile metaChangeFile1SCopy=child.asFile();
  assertTrue(metaChangeFile1SCopy.isWithSnapshot());
  assertFalse(metaChangeFile1SCopy.isUnderConstruction());
  assertEquals(REPLICATION_1,metaChangeFile1SCopy.getFileReplication(Snapshot.CURRENT_STATE_ID));
  assertEquals(REPLICATION_1,metaChangeFile1SCopy.getFileReplication(snapshot1.getId()));
  assertEquals(REPLICATION,metaChangeFile1SCopy.getFileReplication(snapshot0.getId()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.snapshot.TestSnapshottableDirListing </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test listing all the snapshottable directories
 */
@Test(timeout=60000) public void testListSnapshottableDir() throws Exception {
  cluster.getNamesystem().getSnapshotManager().setAllowNestedSnapshots(true);
  SnapshottableDirectoryStatus[] dirs=hdfs.getSnapshottableDirListing();
  assertNull(dirs);
  final Path root=new Path("/");
  hdfs.allowSnapshot(root);
  dirs=hdfs.getSnapshottableDirListing();
  assertEquals(1,dirs.length);
  assertEquals("",dirs[0].getDirStatus().getLocalName());
  assertEquals(root,dirs[0].getFullPath());
  hdfs.disallowSnapshot(root);
  dirs=hdfs.getSnapshottableDirListing();
  assertNull(dirs);
  hdfs.allowSnapshot(dir1);
  dirs=hdfs.getSnapshottableDirListing();
  assertEquals(1,dirs.length);
  assertEquals(dir1.getName(),dirs[0].getDirStatus().getLocalName());
  assertEquals(dir1,dirs[0].getFullPath());
  assertEquals(0,dirs[0].getSnapshotNumber());
  hdfs.allowSnapshot(dir2);
  dirs=hdfs.getSnapshottableDirListing();
  assertEquals(2,dirs.length);
  assertEquals(dir1.getName(),dirs[0].getDirStatus().getLocalName());
  assertEquals(dir1,dirs[0].getFullPath());
  assertEquals(dir2.getName(),dirs[1].getDirStatus().getLocalName());
  assertEquals(dir2,dirs[1].getFullPath());
  assertEquals(0,dirs[1].getSnapshotNumber());
  final Path dir3=new Path("/TestSnapshot3");
  hdfs.mkdirs(dir3);
  hdfs.rename(dir3,dir2,Rename.OVERWRITE);
  dirs=hdfs.getSnapshottableDirListing();
  assertEquals(1,dirs.length);
  assertEquals(dir1,dirs[0].getFullPath());
  hdfs.allowSnapshot(dir2);
  hdfs.createSnapshot(dir2,"s1");
  hdfs.createSnapshot(dir2,"s2");
  dirs=hdfs.getSnapshottableDirListing();
  assertEquals(dir2,dirs[1].getFullPath());
  assertEquals(2,dirs[1].getSnapshotNumber());
  Path sub1=new Path(dir1,"sub1");
  Path file1=new Path(sub1,"file1");
  Path sub2=new Path(dir1,"sub2");
  Path file2=new Path(sub2,"file2");
  DFSTestUtil.createFile(hdfs,file1,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,file2,BLOCKSIZE,REPLICATION,seed);
  hdfs.allowSnapshot(sub1);
  hdfs.allowSnapshot(sub2);
  dirs=hdfs.getSnapshottableDirListing();
  assertEquals(4,dirs.length);
  assertEquals(dir1,dirs[0].getFullPath());
  assertEquals(dir2,dirs[1].getFullPath());
  assertEquals(sub1,dirs[2].getFullPath());
  assertEquals(sub2,dirs[3].getFullPath());
  hdfs.disallowSnapshot(sub1);
  dirs=hdfs.getSnapshottableDirListing();
  assertEquals(3,dirs.length);
  assertEquals(dir1,dirs[0].getFullPath());
  assertEquals(dir2,dirs[1].getFullPath());
  assertEquals(sub2,dirs[2].getFullPath());
  hdfs.delete(dir1,true);
  dirs=hdfs.getSnapshottableDirListing();
  assertEquals(1,dirs.length);
  assertEquals(dir2.getName(),dirs[0].getDirStatus().getLocalName());
  assertEquals(dir2,dirs[0].getFullPath());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.server.namenode.startupprogress.TestStartupProgress </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testThreadSafety() throws Exception {
  int numThreads=100;
  Phase[] phases={LOADING_FSIMAGE,LOADING_FSIMAGE,LOADING_EDITS,LOADING_EDITS};
  Step[] steps=new Step[]{new Step(INODES),new Step(DELEGATION_KEYS),new Step(INODES),new Step(DELEGATION_KEYS)};
  String[] files={"file1","file1","file2","file2"};
  long[] sizes={1000L,1000L,2000L,2000L};
  long[] totals={10000L,20000L,30000L,40000L};
  ExecutorService exec=Executors.newFixedThreadPool(numThreads);
  try {
    for (int i=0; i < numThreads; ++i) {
      final Phase phase=phases[i % phases.length];
      final Step step=steps[i % steps.length];
      final String file=files[i % files.length];
      final long size=sizes[i % sizes.length];
      final long total=totals[i % totals.length];
      exec.submit(new Callable<Void>(){
        @Override public Void call(){
          startupProgress.beginPhase(phase);
          startupProgress.setFile(phase,file);
          startupProgress.setSize(phase,size);
          startupProgress.setTotal(phase,step,total);
          incrementCounter(startupProgress,phase,step,100L);
          startupProgress.endStep(phase,step);
          startupProgress.endPhase(phase);
          return null;
        }
      }
);
    }
  }
  finally {
    exec.shutdown();
    assertTrue(exec.awaitTermination(10000L,TimeUnit.MILLISECONDS));
  }
  StartupProgressView view=startupProgress.createView();
  assertNotNull(view);
  assertEquals("file1",view.getFile(LOADING_FSIMAGE));
  assertEquals(1000L,view.getSize(LOADING_FSIMAGE));
  assertEquals(10000L,view.getTotal(LOADING_FSIMAGE,new Step(INODES)));
  assertEquals(2500L,view.getCount(LOADING_FSIMAGE,new Step(INODES)));
  assertEquals(20000L,view.getTotal(LOADING_FSIMAGE,new Step(DELEGATION_KEYS)));
  assertEquals(2500L,view.getCount(LOADING_FSIMAGE,new Step(DELEGATION_KEYS)));
  assertEquals("file2",view.getFile(LOADING_EDITS));
  assertEquals(2000L,view.getSize(LOADING_EDITS));
  assertEquals(30000L,view.getTotal(LOADING_EDITS,new Step(INODES)));
  assertEquals(2500L,view.getCount(LOADING_EDITS,new Step(INODES)));
  assertEquals(40000L,view.getTotal(LOADING_EDITS,new Step(DELEGATION_KEYS)));
  assertEquals(2500L,view.getCount(LOADING_EDITS,new Step(DELEGATION_KEYS)));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testCounter(){
  startupProgress.beginPhase(LOADING_FSIMAGE);
  Step loadingFsImageInodes=new Step(INODES);
  startupProgress.beginStep(LOADING_FSIMAGE,loadingFsImageInodes);
  incrementCounter(startupProgress,LOADING_FSIMAGE,loadingFsImageInodes,100L);
  startupProgress.endStep(LOADING_FSIMAGE,loadingFsImageInodes);
  Step loadingFsImageDelegationKeys=new Step(DELEGATION_KEYS);
  startupProgress.beginStep(LOADING_FSIMAGE,loadingFsImageDelegationKeys);
  incrementCounter(startupProgress,LOADING_FSIMAGE,loadingFsImageDelegationKeys,200L);
  startupProgress.endStep(LOADING_FSIMAGE,loadingFsImageDelegationKeys);
  startupProgress.endPhase(LOADING_FSIMAGE);
  startupProgress.beginPhase(LOADING_EDITS);
  Step loadingEditsFile=new Step("file",1000L);
  startupProgress.beginStep(LOADING_EDITS,loadingEditsFile);
  incrementCounter(startupProgress,LOADING_EDITS,loadingEditsFile,5000L);
  StartupProgressView view=startupProgress.createView();
  assertNotNull(view);
  assertEquals(100L,view.getCount(LOADING_FSIMAGE,loadingFsImageInodes));
  assertEquals(200L,view.getCount(LOADING_FSIMAGE,loadingFsImageDelegationKeys));
  assertEquals(5000L,view.getCount(LOADING_EDITS,loadingEditsFile));
  assertEquals(0L,view.getCount(SAVING_CHECKPOINT,new Step(INODES)));
  incrementCounter(startupProgress,LOADING_EDITS,loadingEditsFile,1000L);
  startupProgress.endStep(LOADING_EDITS,loadingEditsFile);
  startupProgress.endPhase(LOADING_EDITS);
  assertEquals(5000L,view.getCount(LOADING_EDITS,loadingEditsFile));
  view=startupProgress.createView();
  assertNotNull(view);
  assertEquals(6000L,view.getCount(LOADING_EDITS,loadingEditsFile));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testStepSequence(){
  Step[] expectedSteps=new Step[]{new Step(INODES,"file1"),new Step(DELEGATION_KEYS,"file1"),new Step(INODES,"file2"),new Step(DELEGATION_KEYS,"file2"),new Step(INODES,"file3"),new Step(DELEGATION_KEYS,"file3")};
  List<Step> shuffledSteps=new ArrayList<Step>(Arrays.asList(expectedSteps));
  Collections.shuffle(shuffledSteps);
  startupProgress.beginPhase(SAVING_CHECKPOINT);
  for (  Step step : shuffledSteps) {
    startupProgress.beginStep(SAVING_CHECKPOINT,step);
  }
  List<Step> actualSteps=new ArrayList<Step>(expectedSteps.length);
  StartupProgressView view=startupProgress.createView();
  assertNotNull(view);
  for (  Step step : view.getSteps(SAVING_CHECKPOINT)) {
    actualSteps.add(step);
  }
  assertArrayEquals(expectedSteps,actualSteps.toArray());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testElapsedTime() throws Exception {
  startupProgress.beginPhase(LOADING_FSIMAGE);
  Step loadingFsImageInodes=new Step(INODES);
  startupProgress.beginStep(LOADING_FSIMAGE,loadingFsImageInodes);
  Thread.sleep(50L);
  startupProgress.endStep(LOADING_FSIMAGE,loadingFsImageInodes);
  Step loadingFsImageDelegationKeys=new Step(DELEGATION_KEYS);
  startupProgress.beginStep(LOADING_FSIMAGE,loadingFsImageDelegationKeys);
  Thread.sleep(50L);
  startupProgress.endStep(LOADING_FSIMAGE,loadingFsImageDelegationKeys);
  startupProgress.endPhase(LOADING_FSIMAGE);
  startupProgress.beginPhase(LOADING_EDITS);
  Step loadingEditsFile=new Step("file",1000L);
  startupProgress.beginStep(LOADING_EDITS,loadingEditsFile);
  startupProgress.setTotal(LOADING_EDITS,loadingEditsFile,10000L);
  incrementCounter(startupProgress,LOADING_EDITS,loadingEditsFile,5000L);
  Thread.sleep(50L);
  StartupProgressView view=startupProgress.createView();
  assertNotNull(view);
  assertTrue(view.getElapsedTime() > 0);
  assertTrue(view.getElapsedTime(LOADING_FSIMAGE) > 0);
  assertTrue(view.getElapsedTime(LOADING_FSIMAGE,loadingFsImageInodes) > 0);
  assertTrue(view.getElapsedTime(LOADING_FSIMAGE,loadingFsImageDelegationKeys) > 0);
  assertTrue(view.getElapsedTime(LOADING_EDITS) > 0);
  assertTrue(view.getElapsedTime(LOADING_EDITS,loadingEditsFile) > 0);
  assertTrue(view.getElapsedTime(SAVING_CHECKPOINT) == 0);
  assertTrue(view.getElapsedTime(SAVING_CHECKPOINT,new Step(INODES)) == 0);
  long totalTime=view.getElapsedTime();
  long loadingFsImageTime=view.getElapsedTime(LOADING_FSIMAGE);
  long loadingFsImageInodesTime=view.getElapsedTime(LOADING_FSIMAGE,loadingFsImageInodes);
  long loadingFsImageDelegationKeysTime=view.getElapsedTime(LOADING_FSIMAGE,loadingFsImageInodes);
  long loadingEditsTime=view.getElapsedTime(LOADING_EDITS);
  long loadingEditsFileTime=view.getElapsedTime(LOADING_EDITS,loadingEditsFile);
  Thread.sleep(50L);
  assertTrue(totalTime < view.getElapsedTime());
  assertEquals(loadingFsImageTime,view.getElapsedTime(LOADING_FSIMAGE));
  assertEquals(loadingFsImageInodesTime,view.getElapsedTime(LOADING_FSIMAGE,loadingFsImageInodes));
  assertTrue(loadingEditsTime < view.getElapsedTime(LOADING_EDITS));
  assertTrue(loadingEditsFileTime < view.getElapsedTime(LOADING_EDITS,loadingEditsFile));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testPercentComplete(){
  startupProgress.beginPhase(LOADING_FSIMAGE);
  Step loadingFsImageInodes=new Step(INODES);
  startupProgress.beginStep(LOADING_FSIMAGE,loadingFsImageInodes);
  startupProgress.setTotal(LOADING_FSIMAGE,loadingFsImageInodes,1000L);
  incrementCounter(startupProgress,LOADING_FSIMAGE,loadingFsImageInodes,100L);
  Step loadingFsImageDelegationKeys=new Step(DELEGATION_KEYS);
  startupProgress.beginStep(LOADING_FSIMAGE,loadingFsImageDelegationKeys);
  startupProgress.setTotal(LOADING_FSIMAGE,loadingFsImageDelegationKeys,800L);
  incrementCounter(startupProgress,LOADING_FSIMAGE,loadingFsImageDelegationKeys,200L);
  startupProgress.beginPhase(LOADING_EDITS);
  Step loadingEditsFile=new Step("file",1000L);
  startupProgress.beginStep(LOADING_EDITS,loadingEditsFile);
  startupProgress.setTotal(LOADING_EDITS,loadingEditsFile,10000L);
  incrementCounter(startupProgress,LOADING_EDITS,loadingEditsFile,5000L);
  StartupProgressView view=startupProgress.createView();
  assertNotNull(view);
  assertEquals(0.167f,view.getPercentComplete(),0.001f);
  assertEquals(0.167f,view.getPercentComplete(LOADING_FSIMAGE),0.001f);
  assertEquals(0.10f,view.getPercentComplete(LOADING_FSIMAGE,loadingFsImageInodes),0.001f);
  assertEquals(0.25f,view.getPercentComplete(LOADING_FSIMAGE,loadingFsImageDelegationKeys),0.001f);
  assertEquals(0.5f,view.getPercentComplete(LOADING_EDITS),0.001f);
  assertEquals(0.5f,view.getPercentComplete(LOADING_EDITS,loadingEditsFile),0.001f);
  assertEquals(0.0f,view.getPercentComplete(SAVING_CHECKPOINT),0.001f);
  assertEquals(0.0f,view.getPercentComplete(SAVING_CHECKPOINT,new Step(INODES)),0.001f);
  startupProgress.endStep(LOADING_FSIMAGE,loadingFsImageInodes);
  startupProgress.endStep(LOADING_FSIMAGE,loadingFsImageDelegationKeys);
  startupProgress.endPhase(LOADING_FSIMAGE);
  startupProgress.endStep(LOADING_EDITS,loadingEditsFile);
  startupProgress.endPhase(LOADING_EDITS);
  view=startupProgress.createView();
  assertNotNull(view);
  assertEquals(0.5f,view.getPercentComplete(),0.001f);
  assertEquals(1.0f,view.getPercentComplete(LOADING_FSIMAGE),0.001f);
  assertEquals(1.0f,view.getPercentComplete(LOADING_FSIMAGE,loadingFsImageInodes),0.001f);
  assertEquals(1.0f,view.getPercentComplete(LOADING_FSIMAGE,loadingFsImageDelegationKeys),0.001f);
  assertEquals(1.0f,view.getPercentComplete(LOADING_EDITS),0.001f);
  assertEquals(1.0f,view.getPercentComplete(LOADING_EDITS,loadingEditsFile),0.001f);
  assertEquals(0.0f,view.getPercentComplete(SAVING_CHECKPOINT),0.001f);
  assertEquals(0.0f,view.getPercentComplete(SAVING_CHECKPOINT,new Step(INODES)),0.001f);
}

</code></pre>

<br>
<pre class="type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testInitialState(){
  StartupProgressView view=startupProgress.createView();
  assertNotNull(view);
  assertEquals(0L,view.getElapsedTime());
  assertEquals(0.0f,view.getPercentComplete(),0.001f);
  List<Phase> phases=new ArrayList<Phase>();
  for (  Phase phase : view.getPhases()) {
    phases.add(phase);
    assertEquals(0L,view.getElapsedTime(phase));
    assertNull(view.getFile(phase));
    assertEquals(0.0f,view.getPercentComplete(phase),0.001f);
    assertEquals(Long.MIN_VALUE,view.getSize(phase));
    assertEquals(PENDING,view.getStatus(phase));
    assertEquals(0L,view.getTotal(phase));
    for (    Step step : view.getSteps(phase)) {
      fail(String.format("unexpected step %s in phase %s at initial state",step,phase));
    }
  }
  assertArrayEquals(EnumSet.allOf(Phase.class).toArray(),phases.toArray());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testTotal(){
  startupProgress.beginPhase(LOADING_FSIMAGE);
  Step loadingFsImageInodes=new Step(INODES);
  startupProgress.beginStep(LOADING_FSIMAGE,loadingFsImageInodes);
  startupProgress.setTotal(LOADING_FSIMAGE,loadingFsImageInodes,1000L);
  startupProgress.endStep(LOADING_FSIMAGE,loadingFsImageInodes);
  Step loadingFsImageDelegationKeys=new Step(DELEGATION_KEYS);
  startupProgress.beginStep(LOADING_FSIMAGE,loadingFsImageDelegationKeys);
  startupProgress.setTotal(LOADING_FSIMAGE,loadingFsImageDelegationKeys,800L);
  startupProgress.endStep(LOADING_FSIMAGE,loadingFsImageDelegationKeys);
  startupProgress.endPhase(LOADING_FSIMAGE);
  startupProgress.beginPhase(LOADING_EDITS);
  Step loadingEditsFile=new Step("file",1000L);
  startupProgress.beginStep(LOADING_EDITS,loadingEditsFile);
  startupProgress.setTotal(LOADING_EDITS,loadingEditsFile,10000L);
  startupProgress.endStep(LOADING_EDITS,loadingEditsFile);
  startupProgress.endPhase(LOADING_EDITS);
  StartupProgressView view=startupProgress.createView();
  assertNotNull(view);
  assertEquals(1000L,view.getTotal(LOADING_FSIMAGE,loadingFsImageInodes));
  assertEquals(800L,view.getTotal(LOADING_FSIMAGE,loadingFsImageDelegationKeys));
  assertEquals(10000L,view.getTotal(LOADING_EDITS,loadingEditsFile));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testStatus(){
  startupProgress.beginPhase(LOADING_FSIMAGE);
  startupProgress.endPhase(LOADING_FSIMAGE);
  startupProgress.beginPhase(LOADING_EDITS);
  StartupProgressView view=startupProgress.createView();
  assertNotNull(view);
  assertEquals(COMPLETE,view.getStatus(LOADING_FSIMAGE));
  assertEquals(RUNNING,view.getStatus(LOADING_EDITS));
  assertEquals(PENDING,view.getStatus(SAVING_CHECKPOINT));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.shortcircuit.TestShortCircuitCache </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testShmBasedStaleness() throws Exception {
  BlockReaderTestUtil.enableShortCircuitShmTracing();
  TemporarySocketDirectory sockDir=new TemporarySocketDirectory();
  Configuration conf=createShortCircuitConf("testShmBasedStaleness",sockDir);
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
  cluster.waitActive();
  DistributedFileSystem fs=cluster.getFileSystem();
  final ShortCircuitCache cache=fs.getClient().getClientContext().getShortCircuitCache();
  String TEST_FILE="/test_file";
  final int TEST_FILE_LEN=8193;
  final int SEED=0xFADED;
  DFSTestUtil.createFile(fs,new Path(TEST_FILE),TEST_FILE_LEN,(short)1,SEED);
  FSDataInputStream fis=fs.open(new Path(TEST_FILE));
  int first=fis.read();
  final ExtendedBlock block=DFSTestUtil.getFirstBlock(fs,new Path(TEST_FILE));
  Assert.assertTrue(first != -1);
  cache.accept(new CacheVisitor(){
    @Override public void visit(    int numOutstandingMmaps,    Map<ExtendedBlockId,ShortCircuitReplica> replicas,    Map<ExtendedBlockId,InvalidToken> failedLoads,    Map<Long,ShortCircuitReplica> evictable,    Map<Long,ShortCircuitReplica> evictableMmapped){
      ShortCircuitReplica replica=replicas.get(ExtendedBlockId.fromExtendedBlock(block));
      Assert.assertNotNull(replica);
      Assert.assertTrue(replica.getSlot().isValid());
    }
  }
);
  cluster.getDataNodes().get(0).shutdown();
  cache.accept(new CacheVisitor(){
    @Override public void visit(    int numOutstandingMmaps,    Map<ExtendedBlockId,ShortCircuitReplica> replicas,    Map<ExtendedBlockId,InvalidToken> failedLoads,    Map<Long,ShortCircuitReplica> evictable,    Map<Long,ShortCircuitReplica> evictableMmapped){
      ShortCircuitReplica replica=replicas.get(ExtendedBlockId.fromExtendedBlock(block));
      Assert.assertNotNull(replica);
      Assert.assertFalse(replica.getSlot().isValid());
    }
  }
);
  cluster.shutdown();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testAllocShm() throws Exception {
  BlockReaderTestUtil.enableShortCircuitShmTracing();
  TemporarySocketDirectory sockDir=new TemporarySocketDirectory();
  Configuration conf=createShortCircuitConf("testAllocShm",sockDir);
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
  cluster.waitActive();
  DistributedFileSystem fs=cluster.getFileSystem();
  final ShortCircuitCache cache=fs.getClient().getClientContext().getShortCircuitCache();
  cache.getDfsClientShmManager().visit(new Visitor(){
    @Override public void visit(    HashMap<DatanodeInfo,PerDatanodeVisitorInfo> info) throws IOException {
      Assert.assertEquals(0,info.size());
    }
  }
);
  DomainPeer peer=getDomainPeerToDn(conf);
  MutableBoolean usedPeer=new MutableBoolean(false);
  ExtendedBlockId blockId=new ExtendedBlockId(123,"xyz");
  final DatanodeInfo datanode=new DatanodeInfo(cluster.getDataNodes().get(0).getDatanodeId());
  Slot slot=cache.allocShmSlot(datanode,peer,usedPeer,blockId,"testAllocShm_client");
  Assert.assertNotNull(slot);
  Assert.assertTrue(usedPeer.booleanValue());
  cache.getDfsClientShmManager().visit(new Visitor(){
    @Override public void visit(    HashMap<DatanodeInfo,PerDatanodeVisitorInfo> info) throws IOException {
      Assert.assertEquals(1,info.size());
      PerDatanodeVisitorInfo vinfo=info.get(datanode);
      Assert.assertFalse(vinfo.disabled);
      Assert.assertEquals(0,vinfo.full.size());
      Assert.assertEquals(1,vinfo.notFull.size());
    }
  }
);
  cache.scheduleSlotReleaser(slot);
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      final MutableBoolean done=new MutableBoolean(false);
      try {
        cache.getDfsClientShmManager().visit(new Visitor(){
          @Override public void visit(          HashMap<DatanodeInfo,PerDatanodeVisitorInfo> info) throws IOException {
            done.setValue(info.get(datanode).full.isEmpty() && info.get(datanode).notFull.isEmpty());
          }
        }
);
      }
 catch (      IOException e) {
        LOG.error("error running visitor",e);
      }
      return done.booleanValue();
    }
  }
,10,60000);
  cluster.shutdown();
  sockDir.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.tools.TestGetConf </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test empty configuration
 */
@Test(timeout=10000) public void testEmptyConf() throws Exception {
  HdfsConfiguration conf=new HdfsConfiguration(false);
  getAddressListFromTool(TestType.NAMENODE,conf,false);
  System.out.println(getAddressListFromTool(TestType.BACKUP,conf,false));
  getAddressListFromTool(TestType.SECONDARY,conf,false);
  getAddressListFromTool(TestType.NNRPCADDRESSES,conf,false);
  for (  Command cmd : Command.values()) {
    String arg=cmd.getName();
    CommandHandler handler=Command.getHandler(arg);
    assertNotNull("missing handler: " + cmd,handler);
    if (handler.key != null) {
      String[] args={handler.key};
      runTool(conf,args,false);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.util.TestLightWeightHashSet </h4><pre class="type-7 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetElement(){
  LightWeightHashSet<TestObject> objSet=new LightWeightHashSet<TestObject>();
  TestObject objA=new TestObject("object A");
  TestObject equalToObjA=new TestObject("object A");
  TestObject objB=new TestObject("object B");
  objSet.add(objA);
  objSet.add(objB);
  assertSame(objA,objSet.getElement(objA));
  assertSame(objA,objSet.getElement(equalToObjA));
  assertSame(objB,objSet.getElement(objB));
  assertNull(objSet.getElement(new TestObject("not in set")));
}

</code></pre>

<br>
<pre class="type-9 type-13 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiBasic(){
  LOG.info("Test multi element basic");
  for (  Integer i : list) {
    assertTrue(set.add(i));
  }
  assertEquals(list.size(),set.size());
  for (  Integer i : list) {
    assertTrue(set.contains(i));
  }
  for (  Integer i : list) {
    assertFalse(set.add(i));
  }
  for (  Integer i : list) {
    assertTrue(set.contains(i));
  }
  Iterator<Integer> iter=set.iterator();
  int num=0;
  while (iter.hasNext()) {
    Integer next=iter.next();
    assertNotNull(next);
    assertTrue(list.contains(next));
    num++;
  }
  assertEquals(list.size(),num);
  LOG.info("Test multi element basic - DONE");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.util.TestLightWeightLinkedSet </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyBasic(){
  LOG.info("Test empty basic");
  Iterator<Integer> iter=set.iterator();
  assertFalse(iter.hasNext());
  assertEquals(0,set.size());
  assertTrue(set.isEmpty());
  assertNull(set.pollFirst());
  assertEquals(0,set.pollAll().size());
  assertEquals(0,set.pollN(10).size());
  LOG.info("Test empty - DONE");
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPollOneElement(){
  LOG.info("Test poll one element");
  set.add(list.get(0));
  assertEquals(list.get(0),set.pollFirst());
  assertNull(set.pollFirst());
  LOG.info("Test poll one element - DONE");
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveOne(){
  LOG.info("Test remove one");
  assertTrue(set.add(list.get(0)));
  assertEquals(1,set.size());
  assertTrue(set.remove(list.get(0)));
  assertEquals(0,set.size());
  Iterator<Integer> iter=set.iterator();
  assertFalse(iter.hasNext());
  assertNull(set.pollFirst());
  assertEquals(0,set.pollAll().size());
  assertEquals(0,set.pollN(10).size());
  assertTrue(set.add(list.get(0)));
  assertEquals(1,set.size());
  iter=set.iterator();
  assertTrue(iter.hasNext());
  LOG.info("Test remove one - DONE");
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClear(){
  LOG.info("Test clear");
  set.addAll(list);
  assertEquals(NUM,set.size());
  assertFalse(set.isEmpty());
  Iterator<Integer> bkmrkIt=set.getBookmark();
  for (int i=0; i < set.size() / 2 + 1; i++) {
    bkmrkIt.next();
  }
  assertTrue(bkmrkIt.hasNext());
  set.clear();
  assertEquals(0,set.size());
  assertTrue(set.isEmpty());
  bkmrkIt=set.getBookmark();
  assertFalse(bkmrkIt.hasNext());
  assertEquals(0,set.pollAll().size());
  assertEquals(0,set.pollN(10).size());
  assertNull(set.pollFirst());
  Iterator<Integer> iter=set.iterator();
  assertFalse(iter.hasNext());
  LOG.info("Test clear - DONE");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.web.TestTokenAspect </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetRemoteToken() throws IOException, URISyntaxException {
  Configuration conf=new Configuration();
  DummyFs fs=spy(new DummyFs());
  Token<TokenIdentifier> token=new Token<TokenIdentifier>(new byte[0],new byte[0],DummyFs.TOKEN_KIND,new Text("127.0.0.1:1234"));
  doReturn(token).when(fs).getDelegationToken(anyString());
  doReturn(token).when(fs).getRenewToken();
  fs.initialize(new URI("dummyfs://127.0.0.1:1234"),conf);
  fs.tokenAspect.ensureTokenInitialized();
  verify(fs).setDelegationToken(token);
  assertNotNull(Whitebox.getInternalState(fs.tokenAspect,"dtRenewer"));
  assertNotNull(Whitebox.getInternalState(fs.tokenAspect,"action"));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitWithUGIToken() throws IOException, URISyntaxException {
  Configuration conf=new Configuration();
  DummyFs fs=spy(new DummyFs());
  doReturn(null).when(fs).getDelegationToken(anyString());
  Token<TokenIdentifier> token=new Token<TokenIdentifier>(new byte[0],new byte[0],DummyFs.TOKEN_KIND,new Text("127.0.0.1:1234"));
  fs.ugi.addToken(token);
  fs.ugi.addToken(new Token<TokenIdentifier>(new byte[0],new byte[0],new Text("Other token"),new Text("127.0.0.1:8021")));
  assertEquals("wrong tokens in user",2,fs.ugi.getTokens().size());
  fs.emulateSecurityEnabled=true;
  fs.initialize(new URI("dummyfs://127.0.0.1:1234"),conf);
  fs.tokenAspect.ensureTokenInitialized();
  verify(fs).setDelegationToken(token);
  verify(fs,never()).getDelegationToken(anyString());
  assertNull(Whitebox.getInternalState(fs.tokenAspect,"dtRenewer"));
  assertNull(Whitebox.getInternalState(fs.tokenAspect,"action"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hdfs.web.resources.TestParam </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void userNameMinLength(){
  UserParam userParam=new UserParam("a");
  assertNotNull(userParam.getValue());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testUserNameOkAfterResettingPattern(){
  UserParam.Domain oldDomain=UserParam.getUserPatternDomain();
  String newPattern="^[A-Za-z0-9_][A-Za-z0-9._-]*[$]?$";
  UserParam.setUserPattern(newPattern);
  UserParam userParam=new UserParam("1x");
  assertNotNull(userParam.getValue());
  userParam=new UserParam("123");
  assertNotNull(userParam.getValue());
  UserParam.setUserPatternDomain(oldDomain);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void userNameValidDollarSign(){
  UserParam userParam=new UserParam("a$");
  assertNotNull(userParam.getValue());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void userNameEmpty(){
  UserParam userParam=new UserParam("");
  assertNull(userParam.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.http.TestHttpRequestLog </h4><pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAppenderDefined(){
  HttpRequestLogAppender requestLogAppender=new HttpRequestLogAppender();
  requestLogAppender.setName("testrequestlog");
  Logger.getLogger("http.requests.test").addAppender(requestLogAppender);
  RequestLog requestLog=HttpRequestLog.getRequestLog("test");
  Logger.getLogger("http.requests.test").removeAppender(requestLogAppender);
  assertNotNull("RequestLog should not be null",requestLog);
  assertEquals("Class mismatch",NCSARequestLog.class,requestLog.getClass());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testAppenderUndefined(){
  RequestLog requestLog=HttpRequestLog.getRequestLog("test");
  assertNull("RequestLog should be null",requestLog);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.http.TestHttpServer </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindAddress() throws Exception {
  checkBindAddress("localhost",0,false).stop();
  HttpServer2 myServer=checkBindAddress("localhost",0,false);
  HttpServer2 myServer2=null;
  try {
    int port=myServer.getConnectorAddress(0).getPort();
    myServer2=checkBindAddress("localhost",port,true);
    port=myServer2.getConnectorAddress(0).getPort();
    myServer2.stop();
    assertNull(myServer2.getConnectorAddress(0));
    myServer2.openListeners();
    assertEquals(port,myServer2.getConnectorAddress(0).getPort());
  }
  finally {
    myServer.stop();
    if (myServer2 != null) {
      myServer2.stop();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoCacheHeader() throws Exception {
  URL url=new URL(baseUrl,"/echo?a=b&c=d");
  HttpURLConnection conn=(HttpURLConnection)url.openConnection();
  assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
  assertEquals("no-cache",conn.getHeaderField("Cache-Control"));
  assertEquals("no-cache",conn.getHeaderField("Pragma"));
  assertNotNull(conn.getHeaderField("Expires"));
  assertNotNull(conn.getHeaderField("Date"));
  assertEquals(conn.getHeaderField("Expires"),conn.getHeaderField("Date"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.http.TestHttpServerLifecycle </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the server is alive once started
 * @throws Throwableon failure
 */
@Test public void testWepAppContextAfterServerStop() throws Throwable {
  HttpServer2 server=null;
  String key="test.attribute.key";
  String value="test.attribute.value";
  server=createTestServer();
  assertNotLive(server);
  server.start();
  server.setAttribute(key,value);
  assertAlive(server);
  assertEquals(value,server.getAttribute(key));
  stop(server);
  assertNull("Server context should have cleared",server.getAttribute(key));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.TestMapFile </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Reader.getClosest()} method 
 */
@Test public void testGetClosestOnCurrentApi() throws Exception {
  final String TEST_PREFIX="testGetClosestOnCurrentApi.mapfile";
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=createWriter(TEST_PREFIX,Text.class,Text.class);
    int FIRST_KEY=1;
    for (int i=FIRST_KEY; i < 100; i+=10) {
      Text t=new Text(Integer.toString(i));
      writer.append(t,t);
    }
    writer.close();
    reader=createReader(TEST_PREFIX,Text.class);
    Text key=new Text("55");
    Text value=new Text();
    Text closest=(Text)reader.getClosest(key,value);
    assertEquals(new Text("61"),closest);
    closest=(Text)reader.getClosest(key,value,true);
    assertEquals(new Text("51"),closest);
    final Text explicitKey=new Text("21");
    closest=(Text)reader.getClosest(explicitKey,value);
    assertEquals(new Text("21"),explicitKey);
    key=new Text("00");
    closest=(Text)reader.getClosest(key,value);
    assertEquals(FIRST_KEY,Integer.parseInt(closest.toString()));
    key=new Text("92");
    closest=(Text)reader.getClosest(key,value);
    assertNull("Not null key in testGetClosestWithNewCode",closest);
    closest=(Text)reader.getClosest(key,value,true);
    assertEquals(new Text("91"),closest);
  }
  finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getClosest feature.
 * @throws Exception
 */
@Test @SuppressWarnings("deprecation") public void testGetClosest() throws Exception {
  Path dirName=new Path(TEST_DIR,"testGetClosest.mapfile");
  FileSystem fs=FileSystem.getLocal(conf);
  Path qualifiedDirName=fs.makeQualified(dirName);
  MapFile.Writer.setIndexInterval(conf,3);
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=new MapFile.Writer(conf,fs,qualifiedDirName.toString(),Text.class,Text.class);
    assertEquals(3,writer.getIndexInterval());
    final int FIRST_KEY=10;
    for (int i=FIRST_KEY; i < 100; i+=10) {
      String iStr=Integer.toString(i);
      Text t=new Text("00".substring(iStr.length()) + iStr);
      writer.append(t,t);
    }
    writer.close();
    reader=new MapFile.Reader(qualifiedDirName,conf);
    Text key=new Text("55");
    Text value=new Text();
    Text closest=(Text)reader.getClosest(key,value);
    assertEquals(new Text("60"),closest);
    closest=(Text)reader.getClosest(key,value,true);
    assertEquals(new Text("50"),closest);
    final Text TWENTY=new Text("20");
    closest=(Text)reader.getClosest(TWENTY,value);
    assertEquals(TWENTY,closest);
    closest=(Text)reader.getClosest(TWENTY,value,true);
    assertEquals(TWENTY,closest);
    key=new Text("00");
    closest=(Text)reader.getClosest(key,value);
    assertEquals(FIRST_KEY,Integer.parseInt(closest.toString()));
    closest=(Text)reader.getClosest(key,value,true);
    assertNull(closest);
    key=new Text("99");
    closest=(Text)reader.getClosest(key,value);
    assertNull(closest);
    closest=(Text)reader.getClosest(key,value,true);
    assertEquals(new Text("90"),closest);
  }
  finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<br>
<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Writer} constructor with key, value
 * and validate it with {@code keyClass(), valueClass()} methods 
 */
@Test public void testKeyValueClasses(){
  Class<? extends WritableComparable<?>> keyClass=IntWritable.class;
  Class<?> valueClass=Text.class;
  try {
    createWriter("testKeyValueClasses.mapfile",IntWritable.class,Text.class).close();
    assertNotNull("writer key class null error !!!",MapFile.Writer.keyClass(keyClass));
    assertNotNull("writer value class null error !!!",MapFile.Writer.valueClass(valueClass));
  }
 catch (  IOException ex) {
    fail(ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test all available constructor for {@code MapFile.Writer}
 */
@Test @SuppressWarnings("deprecation") public void testDeprecatedConstructors(){
  String path=new Path(TEST_DIR,"writes.mapfile").toString();
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    FileSystem fs=FileSystem.getLocal(conf);
    writer=new MapFile.Writer(conf,fs,path,IntWritable.class,Text.class,CompressionType.RECORD);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,IntWritable.class,Text.class,CompressionType.RECORD,defaultProgressable);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,IntWritable.class,Text.class,CompressionType.RECORD,defaultCodec,defaultProgressable);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,WritableComparator.get(Text.class),Text.class);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,WritableComparator.get(Text.class),Text.class,SequenceFile.CompressionType.RECORD);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,WritableComparator.get(Text.class),Text.class,CompressionType.RECORD,defaultProgressable);
    assertNotNull(writer);
    writer.close();
    reader=new MapFile.Reader(fs,path,WritableComparator.get(IntWritable.class),conf);
    assertNotNull(reader);
    assertNotNull("reader key is null !!!",reader.getKeyClass());
    assertNotNull("reader value in null",reader.getValueClass());
  }
 catch (  IOException e) {
    fail(e.getMessage());
  }
 finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Reader.next(key, value)} for iteration.
 */
@Test public void testReaderKeyIteration(){
  final String TEST_METHOD_KEY="testReaderKeyIteration.mapfile";
  int SIZE=10;
  int ITERATIONS=5;
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=createWriter(TEST_METHOD_KEY,IntWritable.class,Text.class);
    int start=0;
    for (int i=0; i < SIZE; i++)     writer.append(new IntWritable(i),new Text("Value:" + i));
    writer.close();
    reader=createReader(TEST_METHOD_KEY,IntWritable.class);
    Writable startValue=new Text("Value:" + start);
    int i=0;
    while (i++ < ITERATIONS) {
      IntWritable key=new IntWritable(start);
      Writable value=startValue;
      while (reader.next(key,value)) {
        assertNotNull(key);
        assertNotNull(value);
      }
      reader.reset();
    }
    assertTrue("reader seek error !!!",reader.seek(new IntWritable(SIZE / 2)));
    assertFalse("reader seek error !!!",reader.seek(new IntWritable(SIZE * 2)));
  }
 catch (  IOException ex) {
    fail("reader seek error !!!");
  }
 finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.TestSortedMapWritable </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests if equal and hashCode method still hold the contract.
 */
@Test public void testEqualsAndHashCode(){
  String failureReason;
  SortedMapWritable mapA=new SortedMapWritable();
  SortedMapWritable mapB=new SortedMapWritable();
  failureReason="SortedMapWritable couldn't be initialized. Got null reference";
  assertNotNull(failureReason,mapA);
  assertNotNull(failureReason,mapB);
  assertFalse("equals method returns true when passed null",mapA.equals(null));
  assertTrue("Two empty SortedMapWritables are no longer equal",mapA.equals(mapB));
  Text[] keys={new Text("key1"),new Text("key2")};
  BytesWritable[] values={new BytesWritable("value1".getBytes()),new BytesWritable("value2".getBytes())};
  mapA.put(keys[0],values[0]);
  mapB.put(keys[1],values[1]);
  failureReason="Two SortedMapWritables with different data are now equal";
  assertTrue(failureReason,mapA.hashCode() != mapB.hashCode());
  assertTrue(failureReason,!mapA.equals(mapB));
  assertTrue(failureReason,!mapB.equals(mapA));
  mapA.put(keys[1],values[1]);
  mapB.put(keys[0],values[0]);
  failureReason="Two SortedMapWritables with same entry sets formed in different order are now different";
  assertEquals(failureReason,mapA.hashCode(),mapB.hashCode());
  assertTrue(failureReason,mapA.equals(mapB));
  assertTrue(failureReason,mapB.equals(mapA));
  mapA.put(keys[0],values[1]);
  mapA.put(keys[1],values[0]);
  failureReason="Two SortedMapWritables with different content are now equal";
  assertTrue(failureReason,mapA.hashCode() != mapB.hashCode());
  assertTrue(failureReason,!mapA.equals(mapB));
  assertTrue(failureReason,!mapB.equals(mapA));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.compress.TestCodec </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGzipCodecRead() throws IOException {
  Configuration conf=new Configuration();
  conf.setBoolean(CommonConfigurationKeys.IO_NATIVE_LIB_AVAILABLE_KEY,false);
  assertFalse("ZlibFactory is using native libs against request",ZlibFactory.isNativeZlibLoaded(conf));
  Decompressor zlibDecompressor=ZlibFactory.getZlibDecompressor(conf);
  assertNotNull("zlibDecompressor is null!",zlibDecompressor);
  assertTrue("ZlibFactory returned unexpected inflator",zlibDecompressor instanceof BuiltInZlibInflater);
  CodecPool.returnDecompressor(zlibDecompressor);
  String tmpDir=System.getProperty("test.build.data","/tmp/");
  Path f=new Path(new Path(tmpDir),"testGzipCodecRead.txt.gz");
  BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(new GZIPOutputStream(new FileOutputStream(f.toString()))));
  final String msg="This is the message in the file!";
  bw.write(msg);
  bw.close();
  CompressionCodecFactory ccf=new CompressionCodecFactory(conf);
  CompressionCodec codec=ccf.getCodec(f);
  Decompressor decompressor=CodecPool.getDecompressor(codec);
  FileSystem fs=FileSystem.getLocal(conf);
  InputStream is=fs.open(f);
  is=codec.createInputStream(is,decompressor);
  BufferedReader br=new BufferedReader(new InputStreamReader(is));
  String line=br.readLine();
  assertEquals("Didn't get the same message back!",msg,line);
  br.close();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGzipCompatibility() throws IOException {
  Random r=new Random();
  long seed=r.nextLong();
  r.setSeed(seed);
  LOG.info("seed: " + seed);
  DataOutputBuffer dflbuf=new DataOutputBuffer();
  GZIPOutputStream gzout=new GZIPOutputStream(dflbuf);
  byte[] b=new byte[r.nextInt(128 * 1024 + 1)];
  r.nextBytes(b);
  gzout.write(b);
  gzout.close();
  DataInputBuffer gzbuf=new DataInputBuffer();
  gzbuf.reset(dflbuf.getData(),dflbuf.getLength());
  Configuration conf=new Configuration();
  conf.setBoolean(CommonConfigurationKeys.IO_NATIVE_LIB_AVAILABLE_KEY,false);
  CompressionCodec codec=ReflectionUtils.newInstance(GzipCodec.class,conf);
  Decompressor decom=codec.createDecompressor();
  assertNotNull(decom);
  assertEquals(BuiltInGzipDecompressor.class,decom.getClass());
  InputStream gzin=codec.createInputStream(gzbuf,decom);
  dflbuf.reset();
  IOUtils.copyBytes(gzin,dflbuf,4096);
  final byte[] dflchk=Arrays.copyOf(dflbuf.getData(),dflbuf.getLength());
  assertArrayEquals(b,dflchk);
}

</code></pre>

<br>
<pre class="type-9 type-13 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGzipLongOverflow() throws IOException {
  LOG.info("testGzipLongOverflow");
  Configuration conf=new Configuration();
  conf.setBoolean(CommonConfigurationKeys.IO_NATIVE_LIB_AVAILABLE_KEY,false);
  assertFalse("ZlibFactory is using native libs against request",ZlibFactory.isNativeZlibLoaded(conf));
  Decompressor zlibDecompressor=ZlibFactory.getZlibDecompressor(conf);
  assertNotNull("zlibDecompressor is null!",zlibDecompressor);
  assertTrue("ZlibFactory returned unexpected inflator",zlibDecompressor instanceof BuiltInZlibInflater);
  CodecPool.returnDecompressor(zlibDecompressor);
  String tmpDir=System.getProperty("test.build.data","/tmp/");
  Path f=new Path(new Path(tmpDir),"testGzipLongOverflow.bin.gz");
  BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(new GZIPOutputStream(new FileOutputStream(f.toString()))));
  final int NBUF=1024 * 4 + 1;
  final char[] buf=new char[1024 * 1024];
  for (int i=0; i < buf.length; i++)   buf[i]='\0';
  for (int i=0; i < NBUF; i++) {
    bw.write(buf);
  }
  bw.close();
  CompressionCodecFactory ccf=new CompressionCodecFactory(conf);
  CompressionCodec codec=ccf.getCodec(f);
  Decompressor decompressor=CodecPool.getDecompressor(codec);
  FileSystem fs=FileSystem.getLocal(conf);
  InputStream is=fs.open(f);
  is=codec.createInputStream(is,decompressor);
  BufferedReader br=new BufferedReader(new InputStreamReader(is));
  for (int j=0; j < NBUF; j++) {
    int n=br.read(buf);
    assertEquals("got wrong read length!",n,buf.length);
    for (int i=0; i < buf.length; i++)     assertEquals("got wrong byte!",buf[i],'\0');
  }
  br.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.file.tfile.TestTFileByteArrays </h4><pre class="type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailureGetNonExistentMetaBlock() throws IOException {
  if (skip)   return;
  writer.append("keyX".getBytes(),"valueX".getBytes());
  DataOutputStream outMeta=writer.prepareMetaBlock("testX",Compression.Algorithm.GZ.getName());
  outMeta.write(123);
  outMeta.write("foo".getBytes());
  outMeta.close();
  closeOutput();
  Reader reader=new Reader(fs.open(path),fs.getFileStatus(path).getLen(),conf);
  DataInputStream mb=reader.getMetaBlock("testX");
  Assert.assertNotNull(mb);
  mb.close();
  try {
    DataInputStream mbBad=reader.getMetaBlock("testY");
    Assert.fail("Error on handling non-existent metablocks.");
  }
 catch (  Exception e) {
  }
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.nativeio.TestNativeIO </h4><pre class="type-2 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testOpenWithCreate() throws Exception {
  if (Path.WINDOWS) {
    return;
  }
  LOG.info("Test creating a file with O_CREAT");
  FileDescriptor fd=NativeIO.POSIX.open(new File(TEST_DIR,"testWorkingOpen").getAbsolutePath(),NativeIO.POSIX.O_WRONLY | NativeIO.POSIX.O_CREAT,0700);
  assertNotNull(true);
  assertTrue(fd.valid());
  FileOutputStream fos=new FileOutputStream(fd);
  fos.write("foo".getBytes());
  fos.close();
  assertFalse(fd.valid());
  LOG.info("Test exclusive create");
  try {
    fd=NativeIO.POSIX.open(new File(TEST_DIR,"testWorkingOpen").getAbsolutePath(),NativeIO.POSIX.O_WRONLY | NativeIO.POSIX.O_CREAT | NativeIO.POSIX.O_EXCL,0700);
    fail("Was able to create existing file with O_EXCL");
  }
 catch (  NativeIOException nioe) {
    LOG.info("Got expected exception for failed exclusive create",nioe);
    assertEquals(Errno.EEXIST,nioe.getErrno());
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for races in fstat usage
 * NOTE: this test is likely to fail on RHEL 6.0 which has a non-threadsafe
 * implementation of getpwuid_r.
 */
@Test(timeout=30000) public void testMultiThreadedFstat() throws Exception {
  if (Path.WINDOWS) {
    return;
  }
  final FileOutputStream fos=new FileOutputStream(new File(TEST_DIR,"testfstat"));
  final AtomicReference<Throwable> thrown=new AtomicReference<Throwable>();
  List<Thread> statters=new ArrayList<Thread>();
  for (int i=0; i < 10; i++) {
    Thread statter=new Thread(){
      @Override public void run(){
        long et=Time.now() + 5000;
        while (Time.now() < et) {
          try {
            NativeIO.POSIX.Stat stat=NativeIO.POSIX.getFstat(fos.getFD());
            assertEquals(System.getProperty("user.name"),stat.getOwner());
            assertNotNull(stat.getGroup());
            assertTrue(!stat.getGroup().isEmpty());
            assertEquals("Stat mode field should indicate a regular file",NativeIO.POSIX.Stat.S_IFREG,stat.getMode() & NativeIO.POSIX.Stat.S_IFMT);
          }
 catch (          Throwable t) {
            thrown.set(t);
          }
        }
      }
    }
;
    statters.add(statter);
    statter.start();
  }
  for (  Thread t : statters) {
    t.join();
  }
  fos.close();
  if (thrown.get() != null) {
    throw new RuntimeException(thrown.get());
  }
}

</code></pre>

<br>
<pre class="type-13 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that opens and closes a file 10000 times - this would crash with
 * "Too many open files" if we leaked fds using this access pattern.
 */
@Test(timeout=30000) public void testFDDoesntLeak() throws IOException {
  if (Path.WINDOWS) {
    return;
  }
  for (int i=0; i < 10000; i++) {
    FileDescriptor fd=NativeIO.POSIX.open(new File(TEST_DIR,"testNoFdLeak").getAbsolutePath(),NativeIO.POSIX.O_WRONLY | NativeIO.POSIX.O_CREAT,0700);
    assertNotNull(true);
    assertTrue(fd.valid());
    FileOutputStream fos=new FileOutputStream(fd);
    fos.write("foo".getBytes());
    fos.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testFstat() throws Exception {
  FileOutputStream fos=new FileOutputStream(new File(TEST_DIR,"testfstat"));
  NativeIO.POSIX.Stat stat=NativeIO.POSIX.getFstat(fos.getFD());
  fos.close();
  LOG.info("Stat: " + String.valueOf(stat));
  String owner=stat.getOwner();
  String expectedOwner=System.getProperty("user.name");
  if (Path.WINDOWS) {
    UserGroupInformation ugi=UserGroupInformation.createRemoteUser(expectedOwner);
    final String adminsGroupString="Administrators";
    if (Arrays.asList(ugi.getGroupNames()).contains(adminsGroupString)) {
      expectedOwner=adminsGroupString;
    }
  }
  assertEquals(expectedOwner,owner);
  assertNotNull(stat.getGroup());
  assertTrue(!stat.getGroup().isEmpty());
  assertEquals("Stat mode field should indicate a regular file",NativeIO.POSIX.Stat.S_IFREG,stat.getMode() & NativeIO.POSIX.Stat.S_IFMT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.retry.TestRetryProxy </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetryInterruptible() throws Throwable {
  final UnreliableInterface unreliable=(UnreliableInterface)RetryProxy.create(UnreliableInterface.class,unreliableImpl,retryUpToMaximumTimeWithFixedSleep(10,10,TimeUnit.SECONDS));
  final CountDownLatch latch=new CountDownLatch(1);
  final AtomicReference<Thread> futureThread=new AtomicReference<Thread>();
  ExecutorService exec=Executors.newSingleThreadExecutor();
  Future<Throwable> future=exec.submit(new Callable<Throwable>(){
    @Override public Throwable call() throws Exception {
      futureThread.set(Thread.currentThread());
      latch.countDown();
      try {
        unreliable.alwaysFailsWithFatalException();
      }
 catch (      UndeclaredThrowableException ute) {
        return ute.getCause();
      }
      return null;
    }
  }
);
  latch.await();
  Thread.sleep(1000);
  assertTrue(futureThread.get().isAlive());
  futureThread.get().interrupt();
  Throwable e=future.get(1,TimeUnit.SECONDS);
  assertNotNull(e);
  assertEquals(InterruptedException.class,e.getClass());
  assertEquals("sleep interrupted",e.getMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.serializer.TestSerializationFactory </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetSerializer(){
  assertNotNull("A valid class must be returned for default Writable SerDe",factory.getSerializer(Writable.class));
  assertNull("A null should be returned if there are no serializers found.",factory.getSerializer(TestSerializationFactory.class));
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetDeserializer(){
  assertNotNull("A valid class must be returned for default Writable SerDe",factory.getDeserializer(Writable.class));
  assertNull("A null should be returned if there are no deserializers found",factory.getDeserializer(TestSerializationFactory.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.io.serializer.TestWritableSerialization </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWritableConfigurable() throws Exception {
  conf.set(CONF_TEST_KEY,CONF_TEST_VALUE);
  FooGenericWritable generic=new FooGenericWritable();
  generic.setConf(conf);
  Baz baz=new Baz();
  generic.set(baz);
  Baz result=SerializationTestUtil.testSerialization(conf,baz);
  assertEquals(baz,result);
  assertNotNull(result.getConf());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.ipc.TestIPC </h4><pre class="type-9 type-2 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testStandAloneClient() throws IOException {
  Client client=new Client(LongWritable.class,conf);
  InetSocketAddress address=new InetSocketAddress("127.0.0.1",10);
  try {
    client.call(new LongWritable(RANDOM.nextLong()),address,null,null,0,conf);
    fail("Expected an exception to have been thrown");
  }
 catch (  IOException e) {
    String message=e.getMessage();
    String addressText=address.getHostName() + ":" + address.getPort();
    assertTrue("Did not find " + addressText + " in "+ message,message.contains(addressText));
    Throwable cause=e.getCause();
    assertNotNull("No nested exception in " + e,cause);
    String causeText=cause.getMessage();
    assertTrue("Did not find " + causeText + " in "+ message,message.contains(causeText));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.ipc.TestIdentityProviders </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPluggableIdentityProvider(){
  Configuration conf=new Configuration();
  conf.set(CommonConfigurationKeys.IPC_CALLQUEUE_IDENTITY_PROVIDER_KEY,"org.apache.hadoop.ipc.UserIdentityProvider");
  List<IdentityProvider> providers=conf.getInstances(CommonConfigurationKeys.IPC_CALLQUEUE_IDENTITY_PROVIDER_KEY,IdentityProvider.class);
  assertTrue(providers.size() == 1);
  IdentityProvider ip=providers.get(0);
  assertNotNull(ip);
  assertEquals(ip.getClass(),UserIdentityProvider.class);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.ipc.TestSaslRPC </h4><pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSaslPlainServerBadPassword(){
  SaslException e=null;
  try {
    runNegotiation(new TestPlainCallbacks.Client("user","pass1"),new TestPlainCallbacks.Server("user","pass2"));
  }
 catch (  SaslException se) {
    e=se;
  }
  assertNotNull(e);
  assertEquals("PLAIN auth failed: wrong password",e.getMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.lang.TestXException </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXException() throws Exception {
  XException ex=new XException(TestERROR.TC);
  assertEquals(ex.getError(),TestERROR.TC);
  assertEquals(ex.getMessage(),"TC: {0}");
  assertNull(ex.getCause());
  ex=new XException(TestERROR.TC,"msg");
  assertEquals(ex.getError(),TestERROR.TC);
  assertEquals(ex.getMessage(),"TC: msg");
  assertNull(ex.getCause());
  Exception cause=new Exception();
  ex=new XException(TestERROR.TC,cause);
  assertEquals(ex.getError(),TestERROR.TC);
  assertEquals(ex.getMessage(),"TC: " + cause.toString());
  assertEquals(ex.getCause(),cause);
  XException xcause=ex;
  ex=new XException(xcause);
  assertEquals(ex.getError(),TestERROR.TC);
  assertEquals(ex.getMessage(),xcause.getMessage());
  assertEquals(ex.getCause(),xcause);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.server.TestBaseService </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void baseService() throws Exception {
  BaseService service=new MyService();
  assertNull(service.getInterface());
  assertEquals(service.getPrefix(),"myservice");
  assertEquals(service.getServiceDependencies().length,0);
  Server server=Mockito.mock(Server.class);
  Configuration conf=new Configuration(false);
  conf.set("server.myservice.foo","FOO");
  conf.set("server.myservice1.bar","BAR");
  Mockito.when(server.getConfig()).thenReturn(conf);
  Mockito.when(server.getPrefixedName("myservice.foo")).thenReturn("server.myservice.foo");
  Mockito.when(server.getPrefixedName("myservice.")).thenReturn("server.myservice.");
  service.init(server);
  assertEquals(service.getPrefixedName("foo"),"server.myservice.foo");
  assertEquals(service.getServiceConfig().size(),1);
  assertEquals(service.getServiceConfig().get("foo"),"FOO");
  assertTrue(MyService.INIT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.server.TestServer </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @TestDir public void lifeCycle() throws Exception {
  Configuration conf=new Configuration(false);
  conf.set("server.services",LifeCycleService.class.getName());
  Server server=createServer(conf);
  assertEquals(server.getStatus(),Server.Status.UNDEF);
  server.init();
  assertNotNull(server.get(LifeCycleService.class));
  assertEquals(server.getStatus(),Server.Status.NORMAL);
  server.destroy();
  assertEquals(server.getStatus(),Server.Status.SHUTDOWN);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @TestDir public void serviceLifeCycle() throws Exception {
  TestService.LIFECYCLE.clear();
  Configuration conf=new Configuration(false);
  conf.set("server.services",TestService.class.getName());
  Server server=createServer(conf);
  server.init();
  assertNotNull(server.get(TestService.class));
  server.destroy();
  assertEquals(TestService.LIFECYCLE,Arrays.asList("init","postInit","serverStatusChange","destroy"));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @TestDir public void constructorsGetters() throws Exception {
  Server server=new Server("server",getAbsolutePath("/a"),getAbsolutePath("/b"),getAbsolutePath("/c"),getAbsolutePath("/d"),new Configuration(false));
  assertEquals(server.getHomeDir(),getAbsolutePath("/a"));
  assertEquals(server.getConfigDir(),getAbsolutePath("/b"));
  assertEquals(server.getLogDir(),getAbsolutePath("/c"));
  assertEquals(server.getTempDir(),getAbsolutePath("/d"));
  assertEquals(server.getName(),"server");
  assertEquals(server.getPrefix(),"server");
  assertEquals(server.getPrefixedName("name"),"server.name");
  assertNotNull(server.getConfig());
  server=new Server("server",getAbsolutePath("/a"),getAbsolutePath("/b"),getAbsolutePath("/c"),getAbsolutePath("/d"));
  assertEquals(server.getHomeDir(),getAbsolutePath("/a"));
  assertEquals(server.getConfigDir(),getAbsolutePath("/b"));
  assertEquals(server.getLogDir(),getAbsolutePath("/c"));
  assertEquals(server.getTempDir(),getAbsolutePath("/d"));
  assertEquals(server.getName(),"server");
  assertEquals(server.getPrefix(),"server");
  assertEquals(server.getPrefixedName("name"),"server.name");
  assertNull(server.getConfig());
  server=new Server("server",TestDirHelper.getTestDir().getAbsolutePath(),new Configuration(false));
  assertEquals(server.getHomeDir(),TestDirHelper.getTestDir().getAbsolutePath());
  assertEquals(server.getConfigDir(),TestDirHelper.getTestDir() + "/conf");
  assertEquals(server.getLogDir(),TestDirHelper.getTestDir() + "/log");
  assertEquals(server.getTempDir(),TestDirHelper.getTestDir() + "/temp");
  assertEquals(server.getName(),"server");
  assertEquals(server.getPrefix(),"server");
  assertEquals(server.getPrefixedName("name"),"server.name");
  assertNotNull(server.getConfig());
  server=new Server("server",TestDirHelper.getTestDir().getAbsolutePath());
  assertEquals(server.getHomeDir(),TestDirHelper.getTestDir().getAbsolutePath());
  assertEquals(server.getConfigDir(),TestDirHelper.getTestDir() + "/conf");
  assertEquals(server.getLogDir(),TestDirHelper.getTestDir() + "/log");
  assertEquals(server.getTempDir(),TestDirHelper.getTestDir() + "/temp");
  assertEquals(server.getName(),"server");
  assertEquals(server.getPrefix(),"server");
  assertEquals(server.getPrefixedName("name"),"server.name");
  assertNull(server.getConfig());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.service.hadoop.TestFileSystemAccessService </h4><pre class="type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @TestDir @TestHdfs public void createFileSystem() throws Exception {
  String dir=TestDirHelper.getTestDir().getAbsolutePath();
  String services=StringUtils.join(",",Arrays.asList(InstrumentationService.class.getName(),SchedulerService.class.getName(),FileSystemAccessService.class.getName()));
  Configuration hadoopConf=new Configuration(false);
  hadoopConf.set(CommonConfigurationKeysPublic.FS_DEFAULT_NAME_KEY,TestHdfsHelper.getHdfsConf().get(CommonConfigurationKeysPublic.FS_DEFAULT_NAME_KEY));
  createHadoopConf(hadoopConf);
  Configuration conf=new Configuration(false);
  conf.set("server.services",services);
  conf.set("server.hadoop.filesystem.cache.purge.timeout","0");
  Server server=new Server("server",dir,dir,dir,dir,conf);
  server.init();
  FileSystemAccess hadoop=server.get(FileSystemAccess.class);
  FileSystem fs=hadoop.createFileSystem("u",hadoop.getFileSystemConfiguration());
  Assert.assertNotNull(fs);
  fs.mkdirs(new Path("/tmp/foo"));
  hadoop.releaseFileSystem(fs);
  try {
    fs.mkdirs(new Path("/tmp/foo"));
    Assert.fail();
  }
 catch (  IOException ex) {
  }
catch (  Exception ex) {
    Assert.fail();
  }
  server.destroy();
}

</code></pre>

<br>
<pre class="type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @TestDir @TestHdfs public void fileSystemCache() throws Exception {
  String dir=TestDirHelper.getTestDir().getAbsolutePath();
  String services=StringUtils.join(",",Arrays.asList(InstrumentationService.class.getName(),SchedulerService.class.getName(),FileSystemAccessService.class.getName()));
  Configuration hadoopConf=new Configuration(false);
  hadoopConf.set(CommonConfigurationKeysPublic.FS_DEFAULT_NAME_KEY,TestHdfsHelper.getHdfsConf().get(CommonConfigurationKeysPublic.FS_DEFAULT_NAME_KEY));
  createHadoopConf(hadoopConf);
  Configuration conf=new Configuration(false);
  conf.set("server.services",services);
  conf.set("server.hadoop.filesystem.cache.purge.frequency","1");
  conf.set("server.hadoop.filesystem.cache.purge.timeout","1");
  Server server=new Server("server",dir,dir,dir,dir,conf);
  try {
    server.init();
    FileSystemAccess hadoop=server.get(FileSystemAccess.class);
    FileSystem fs1=hadoop.createFileSystem("u",hadoop.getFileSystemConfiguration());
    Assert.assertNotNull(fs1);
    fs1.mkdirs(new Path("/tmp/foo1"));
    hadoop.releaseFileSystem(fs1);
    fs1.mkdirs(new Path("/tmp/foo2"));
    FileSystem fs2=hadoop.createFileSystem("u",hadoop.getFileSystemConfiguration());
    Assert.assertEquals(fs1,fs2);
    Thread.sleep(4 * 1000);
    fs1.mkdirs(new Path("/tmp/foo2"));
    Thread.sleep(4 * 1000);
    fs2.mkdirs(new Path("/tmp/foo"));
    hadoop.releaseFileSystem(fs2);
    Thread.sleep(4 * 1000);
    try {
      fs2.mkdirs(new Path("/tmp/foo"));
      Assert.fail();
    }
 catch (    IOException ex) {
    }
catch (    Exception ex) {
      Assert.fail();
    }
  }
  finally {
    server.destroy();
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test @TestDir public void simpleSecurity() throws Exception {
  String dir=TestDirHelper.getTestDir().getAbsolutePath();
  String services=StringUtils.join(",",Arrays.asList(InstrumentationService.class.getName(),SchedulerService.class.getName(),FileSystemAccessService.class.getName()));
  Configuration conf=new Configuration(false);
  conf.set("server.services",services);
  Server server=new Server("server",dir,dir,dir,dir,conf);
  server.init();
  Assert.assertNotNull(server.get(FileSystemAccess.class));
  server.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.service.instrumentation.TestInstrumentationService </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test @TestDir @SuppressWarnings("unchecked") public void service() throws Exception {
  String dir=TestDirHelper.getTestDir().getAbsolutePath();
  String services=StringUtils.join(",",Arrays.asList(InstrumentationService.class.getName()));
  Configuration conf=new Configuration(false);
  conf.set("server.services",services);
  Server server=new Server("server",dir,dir,dir,dir,conf);
  server.init();
  Instrumentation instrumentation=server.get(Instrumentation.class);
  assertNotNull(instrumentation);
  instrumentation.incr("g","c",1);
  instrumentation.incr("g","c",2);
  instrumentation.incr("g","c1",2);
  Instrumentation.Cron cron=instrumentation.createCron();
  cron.start();
  sleep(100);
  cron.stop();
  instrumentation.addCron("g","t",cron);
  cron=instrumentation.createCron();
  cron.start();
  sleep(200);
  cron.stop();
  instrumentation.addCron("g","t",cron);
  Instrumentation.Variable<String> var=new Instrumentation.Variable<String>(){
    @Override public String getValue(){
      return "foo";
    }
  }
;
  instrumentation.addVariable("g","v",var);
  Instrumentation.Variable<Long> varToSample=new Instrumentation.Variable<Long>(){
    @Override public Long getValue(){
      return 1L;
    }
  }
;
  instrumentation.addSampler("g","s",10,varToSample);
  Map<String,?> snapshot=instrumentation.getSnapshot();
  assertNotNull(snapshot.get("os-env"));
  assertNotNull(snapshot.get("sys-props"));
  assertNotNull(snapshot.get("jvm"));
  assertNotNull(snapshot.get("counters"));
  assertNotNull(snapshot.get("timers"));
  assertNotNull(snapshot.get("variables"));
  assertNotNull(snapshot.get("samplers"));
  assertNotNull(((Map<String,String>)snapshot.get("os-env")).get("PATH"));
  assertNotNull(((Map<String,String>)snapshot.get("sys-props")).get("java.version"));
  assertNotNull(((Map<String,?>)snapshot.get("jvm")).get("free.memory"));
  assertNotNull(((Map<String,?>)snapshot.get("jvm")).get("max.memory"));
  assertNotNull(((Map<String,?>)snapshot.get("jvm")).get("total.memory"));
  assertNotNull(((Map<String,Map<String,Object>>)snapshot.get("counters")).get("g"));
  assertNotNull(((Map<String,Map<String,Object>>)snapshot.get("timers")).get("g"));
  assertNotNull(((Map<String,Map<String,Object>>)snapshot.get("variables")).get("g"));
  assertNotNull(((Map<String,Map<String,Object>>)snapshot.get("samplers")).get("g"));
  assertNotNull(((Map<String,Map<String,Object>>)snapshot.get("counters")).get("g").get("c"));
  assertNotNull(((Map<String,Map<String,Object>>)snapshot.get("counters")).get("g").get("c1"));
  assertNotNull(((Map<String,Map<String,Object>>)snapshot.get("timers")).get("g").get("t"));
  assertNotNull(((Map<String,Map<String,Object>>)snapshot.get("variables")).get("g").get("v"));
  assertNotNull(((Map<String,Map<String,Object>>)snapshot.get("samplers")).get("g").get("s"));
  StringWriter writer=new StringWriter();
  JSONObject.writeJSONString(snapshot,writer);
  writer.close();
  server.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.service.scheduler.TestSchedulerService </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test @TestDir public void service() throws Exception {
  String dir=TestDirHelper.getTestDir().getAbsolutePath();
  Configuration conf=new Configuration(false);
  conf.set("server.services",StringUtils.join(",",Arrays.asList(InstrumentationService.class.getName(),SchedulerService.class.getName())));
  Server server=new Server("server",dir,dir,dir,dir,conf);
  server.init();
  assertNotNull(server.get(Scheduler.class));
  server.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.service.security.TestGroupsService </h4><pre class="type-7 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @TestDir public void service() throws Exception {
  String dir=TestDirHelper.getTestDir().getAbsolutePath();
  Configuration conf=new Configuration(false);
  conf.set("server.services",StringUtils.join(",",Arrays.asList(GroupsService.class.getName())));
  Server server=new Server("server",dir,dir,dir,dir,conf);
  server.init();
  Groups groups=server.get(Groups.class);
  assertNotNull(groups);
  List<String> g=groups.getGroups(System.getProperty("user.name"));
  assertNotSame(g.size(),0);
  server.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.servlet.TestHostnameFilter </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingHostname() throws Exception {
  ServletRequest request=Mockito.mock(ServletRequest.class);
  Mockito.when(request.getRemoteAddr()).thenReturn(null);
  ServletResponse response=Mockito.mock(ServletResponse.class);
  final AtomicBoolean invoked=new AtomicBoolean();
  FilterChain chain=new FilterChain(){
    @Override public void doFilter(    ServletRequest servletRequest,    ServletResponse servletResponse) throws IOException, ServletException {
      assertTrue(HostnameFilter.get().contains("???"));
      invoked.set(true);
    }
  }
;
  Filter filter=new HostnameFilter();
  filter.init(null);
  assertNull(HostnameFilter.get());
  filter.doFilter(request,response,chain);
  assertTrue(invoked.get());
  assertNull(HostnameFilter.get());
  filter.destroy();
}

</code></pre>

<br>
<pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void hostname() throws Exception {
  ServletRequest request=Mockito.mock(ServletRequest.class);
  Mockito.when(request.getRemoteAddr()).thenReturn("localhost");
  ServletResponse response=Mockito.mock(ServletResponse.class);
  final AtomicBoolean invoked=new AtomicBoolean();
  FilterChain chain=new FilterChain(){
    @Override public void doFilter(    ServletRequest servletRequest,    ServletResponse servletResponse) throws IOException, ServletException {
      assertTrue(HostnameFilter.get().contains("localhost") || HostnameFilter.get().contains("127.0.0.1"));
      invoked.set(true);
    }
  }
;
  Filter filter=new HostnameFilter();
  filter.init(null);
  assertNull(HostnameFilter.get());
  filter.doFilter(request,response,chain);
  assertTrue(invoked.get());
  assertNull(HostnameFilter.get());
  filter.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.servlet.TestMDCFilter </h4><pre class="type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void mdc() throws Exception {
  HttpServletRequest request=Mockito.mock(HttpServletRequest.class);
  Mockito.when(request.getUserPrincipal()).thenReturn(null);
  Mockito.when(request.getMethod()).thenReturn("METHOD");
  Mockito.when(request.getPathInfo()).thenReturn("/pathinfo");
  ServletResponse response=Mockito.mock(ServletResponse.class);
  final AtomicBoolean invoked=new AtomicBoolean();
  FilterChain chain=new FilterChain(){
    @Override public void doFilter(    ServletRequest servletRequest,    ServletResponse servletResponse) throws IOException, ServletException {
      assertEquals(MDC.get("hostname"),null);
      assertEquals(MDC.get("user"),null);
      assertEquals(MDC.get("method"),"METHOD");
      assertEquals(MDC.get("path"),"/pathinfo");
      invoked.set(true);
    }
  }
;
  MDC.clear();
  Filter filter=new MDCFilter();
  filter.init(null);
  filter.doFilter(request,response,chain);
  assertTrue(invoked.get());
  assertNull(MDC.get("hostname"));
  assertNull(MDC.get("user"));
  assertNull(MDC.get("method"));
  assertNull(MDC.get("path"));
  Mockito.when(request.getUserPrincipal()).thenReturn(new Principal(){
    @Override public String getName(){
      return "name";
    }
  }
);
  invoked.set(false);
  chain=new FilterChain(){
    @Override public void doFilter(    ServletRequest servletRequest,    ServletResponse servletResponse) throws IOException, ServletException {
      assertEquals(MDC.get("hostname"),null);
      assertEquals(MDC.get("user"),"name");
      assertEquals(MDC.get("method"),"METHOD");
      assertEquals(MDC.get("path"),"/pathinfo");
      invoked.set(true);
    }
  }
;
  filter.doFilter(request,response,chain);
  assertTrue(invoked.get());
  HostnameFilter.HOSTNAME_TL.set("HOST");
  invoked.set(false);
  chain=new FilterChain(){
    @Override public void doFilter(    ServletRequest servletRequest,    ServletResponse servletResponse) throws IOException, ServletException {
      assertEquals(MDC.get("hostname"),"HOST");
      assertEquals(MDC.get("user"),"name");
      assertEquals(MDC.get("method"),"METHOD");
      assertEquals(MDC.get("path"),"/pathinfo");
      invoked.set(true);
    }
  }
;
  filter.doFilter(request,response,chain);
  assertTrue(invoked.get());
  HostnameFilter.HOSTNAME_TL.remove();
  filter.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.lib.util.TestConfigurationUtils </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void injectDefaults() throws Exception {
  Configuration srcConf=new Configuration(false);
  Configuration targetConf=new Configuration(false);
  srcConf.set("testParameter1","valueFromSource");
  srcConf.set("testParameter2","valueFromSource");
  targetConf.set("testParameter2","originalValueFromTarget");
  targetConf.set("testParameter3","originalValueFromTarget");
  ConfigurationUtils.injectDefaults(srcConf,targetConf);
  assertEquals("valueFromSource",targetConf.get("testParameter1"));
  assertEquals("originalValueFromTarget",targetConf.get("testParameter2"));
  assertEquals("originalValueFromTarget",targetConf.get("testParameter3"));
  assertEquals("valueFromSource",srcConf.get("testParameter1"));
  assertEquals("valueFromSource",srcConf.get("testParameter2"));
  assertNull(srcConf.get("testParameter3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.JobClientUnitTest </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetJobWithUnknownJob() throws Exception {
  TestJobClient client=new TestJobClient(new JobConf());
  Cluster mockCluster=mock(Cluster.class);
  client.setCluster(mockCluster);
  JobID id=new JobID("unknown",0);
  when(mockCluster.getJob(id)).thenReturn(null);
  assertNull(client.getJob(id));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestClientServiceDelegate </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobReportFromHistoryServer() throws Exception {
  MRClientProtocol historyServerProxy=mock(MRClientProtocol.class);
  when(historyServerProxy.getJobReport(getJobReportRequest())).thenReturn(getJobReportResponseFromHistoryServer());
  ResourceMgrDelegate rm=mock(ResourceMgrDelegate.class);
  when(rm.getApplicationReport(TypeConverter.toYarn(oldJobId).getAppId())).thenReturn(null);
  ClientServiceDelegate clientServiceDelegate=getClientServiceDelegate(historyServerProxy,rm);
  JobStatus jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
  Assert.assertEquals("TestJobFilePath",jobStatus.getJobFile());
  Assert.assertEquals("http://TestTrackingUrl",jobStatus.getTrackingUrl());
  Assert.assertEquals(1.0f,jobStatus.getMapProgress(),0.0f);
  Assert.assertEquals(1.0f,jobStatus.getReduceProgress(),0.0f);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetriesOnAMConnectionFailures() throws Exception {
  if (!isAMReachableFromClient) {
    return;
  }
  ResourceMgrDelegate rm=mock(ResourceMgrDelegate.class);
  when(rm.getApplicationReport(TypeConverter.toYarn(oldJobId).getAppId())).thenReturn(getRunningApplicationReport("am1",78));
  final MRClientProtocol amProxy=mock(MRClientProtocol.class);
  when(amProxy.getJobReport(any(GetJobReportRequest.class))).thenThrow(new RuntimeException("11")).thenThrow(new RuntimeException("22")).thenThrow(new RuntimeException("33")).thenThrow(new RuntimeException("44")).thenReturn(getJobReportResponse());
  Configuration conf=new YarnConfiguration();
  conf.set(MRConfig.FRAMEWORK_NAME,MRConfig.YARN_FRAMEWORK_NAME);
  conf.setBoolean(MRJobConfig.JOB_AM_ACCESS_DISABLED,!isAMReachableFromClient);
  ClientServiceDelegate clientServiceDelegate=new ClientServiceDelegate(conf,rm,oldJobId,null){
    @Override MRClientProtocol instantiateAMProxy(    final InetSocketAddress serviceAddr) throws IOException {
      super.instantiateAMProxy(serviceAddr);
      return amProxy;
    }
  }
;
  JobStatus jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
  Assert.assertEquals(conf.getInt(MRJobConfig.MR_CLIENT_MAX_RETRIES,MRJobConfig.DEFAULT_MR_CLIENT_MAX_RETRIES),clientServiceDelegate.getMaxClientRetry());
  verify(amProxy,times(5)).getJobReport(any(GetJobReportRequest.class));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAMAccessDisabled() throws IOException {
  if (isAMReachableFromClient) {
    return;
  }
  MRClientProtocol historyServerProxy=mock(MRClientProtocol.class);
  when(historyServerProxy.getJobReport(getJobReportRequest())).thenReturn(getJobReportResponseFromHistoryServer());
  ResourceMgrDelegate rmDelegate=mock(ResourceMgrDelegate.class);
  try {
    when(rmDelegate.getApplicationReport(jobId.getAppId())).thenReturn(getRunningApplicationReport("am1",78)).thenReturn(getRunningApplicationReport("am1",78)).thenReturn(getRunningApplicationReport("am1",78)).thenReturn(getFinishedApplicationReport());
  }
 catch (  YarnException e) {
    throw new IOException(e);
  }
  ClientServiceDelegate clientServiceDelegate=spy(getClientServiceDelegate(historyServerProxy,rmDelegate));
  JobStatus jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
  Assert.assertEquals("N/A",jobStatus.getJobName());
  verify(clientServiceDelegate,times(0)).instantiateAMProxy(any(InetSocketAddress.class));
  jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
  Assert.assertEquals("N/A",jobStatus.getJobName());
  verify(clientServiceDelegate,times(0)).instantiateAMProxy(any(InetSocketAddress.class));
  jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
  Assert.assertEquals("N/A",jobStatus.getJobName());
  verify(clientServiceDelegate,times(0)).instantiateAMProxy(any(InetSocketAddress.class));
  JobStatus jobStatus1=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus1);
  Assert.assertEquals("TestJobFilePath",jobStatus1.getJobFile());
  Assert.assertEquals("http://TestTrackingUrl",jobStatus1.getTrackingUrl());
  Assert.assertEquals(1.0f,jobStatus1.getMapProgress(),0.0f);
  Assert.assertEquals(1.0f,jobStatus1.getReduceProgress(),0.0f);
  verify(clientServiceDelegate,times(0)).instantiateAMProxy(any(InetSocketAddress.class));
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRMDownRestoreForJobStatusBeforeGetAMReport() throws IOException {
  Configuration conf=new YarnConfiguration();
  conf.setInt(MRJobConfig.MR_CLIENT_MAX_RETRIES,3);
  conf.set(MRConfig.FRAMEWORK_NAME,MRConfig.YARN_FRAMEWORK_NAME);
  conf.setBoolean(MRJobConfig.JOB_AM_ACCESS_DISABLED,!isAMReachableFromClient);
  MRClientProtocol historyServerProxy=mock(MRClientProtocol.class);
  when(historyServerProxy.getJobReport(any(GetJobReportRequest.class))).thenReturn(getJobReportResponse());
  ResourceMgrDelegate rmDelegate=mock(ResourceMgrDelegate.class);
  try {
    when(rmDelegate.getApplicationReport(jobId.getAppId())).thenThrow(new java.lang.reflect.UndeclaredThrowableException(new IOException("Connection refuced1"))).thenThrow(new java.lang.reflect.UndeclaredThrowableException(new IOException("Connection refuced2"))).thenReturn(getFinishedApplicationReport());
    ClientServiceDelegate clientServiceDelegate=new ClientServiceDelegate(conf,rmDelegate,oldJobId,historyServerProxy);
    JobStatus jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
    verify(rmDelegate,times(3)).getApplicationReport(any(ApplicationId.class));
    Assert.assertNotNull(jobStatus);
  }
 catch (  YarnException e) {
    throw new IOException(e);
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUnknownAppInRM() throws Exception {
  MRClientProtocol historyServerProxy=mock(MRClientProtocol.class);
  when(historyServerProxy.getJobReport(getJobReportRequest())).thenReturn(getJobReportResponse());
  ClientServiceDelegate clientServiceDelegate=getClientServiceDelegate(historyServerProxy,getRMDelegate());
  JobStatus jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCountersFromHistoryServer() throws Exception {
  MRClientProtocol historyServerProxy=mock(MRClientProtocol.class);
  when(historyServerProxy.getCounters(getCountersRequest())).thenReturn(getCountersResponseFromHistoryServer());
  ResourceMgrDelegate rm=mock(ResourceMgrDelegate.class);
  when(rm.getApplicationReport(TypeConverter.toYarn(oldJobId).getAppId())).thenReturn(null);
  ClientServiceDelegate clientServiceDelegate=getClientServiceDelegate(historyServerProxy,rm);
  Counters counters=TypeConverter.toYarn(clientServiceDelegate.getJobCounters(oldJobId));
  Assert.assertNotNull(counters);
  Assert.assertEquals(1001,counters.getCounterGroup("dummyCounters").getCounter("dummyCounter").getValue());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRetriesOnConnectionFailure() throws Exception {
  MRClientProtocol historyServerProxy=mock(MRClientProtocol.class);
  when(historyServerProxy.getJobReport(getJobReportRequest())).thenThrow(new RuntimeException("1")).thenThrow(new RuntimeException("2")).thenReturn(getJobReportResponse());
  ResourceMgrDelegate rm=mock(ResourceMgrDelegate.class);
  when(rm.getApplicationReport(TypeConverter.toYarn(oldJobId).getAppId())).thenReturn(null);
  ClientServiceDelegate clientServiceDelegate=getClientServiceDelegate(historyServerProxy,rm);
  JobStatus jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
  verify(historyServerProxy,times(3)).getJobReport(any(GetJobReportRequest.class));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReconnectOnAMRestart() throws IOException {
  if (!isAMReachableFromClient) {
    return;
  }
  MRClientProtocol historyServerProxy=mock(MRClientProtocol.class);
  ResourceMgrDelegate rmDelegate=mock(ResourceMgrDelegate.class);
  try {
    when(rmDelegate.getApplicationReport(jobId.getAppId())).thenReturn(getRunningApplicationReport("am1",78)).thenReturn(getRunningApplicationReport(null,0)).thenReturn(getRunningApplicationReport(null,0)).thenReturn(getRunningApplicationReport("am2",90));
  }
 catch (  YarnException e) {
    throw new IOException(e);
  }
  GetJobReportResponse jobReportResponse1=mock(GetJobReportResponse.class);
  when(jobReportResponse1.getJobReport()).thenReturn(MRBuilderUtils.newJobReport(jobId,"jobName-firstGen","user",JobState.RUNNING,0,0,0,0,0,0,0,"anything",null,false,""));
  MRClientProtocol firstGenAMProxy=mock(MRClientProtocol.class);
  when(firstGenAMProxy.getJobReport(any(GetJobReportRequest.class))).thenReturn(jobReportResponse1).thenThrow(new RuntimeException("AM is down!"));
  GetJobReportResponse jobReportResponse2=mock(GetJobReportResponse.class);
  when(jobReportResponse2.getJobReport()).thenReturn(MRBuilderUtils.newJobReport(jobId,"jobName-secondGen","user",JobState.RUNNING,0,0,0,0,0,0,0,"anything",null,false,""));
  MRClientProtocol secondGenAMProxy=mock(MRClientProtocol.class);
  when(secondGenAMProxy.getJobReport(any(GetJobReportRequest.class))).thenReturn(jobReportResponse2);
  ClientServiceDelegate clientServiceDelegate=spy(getClientServiceDelegate(historyServerProxy,rmDelegate));
  doReturn(firstGenAMProxy).doReturn(secondGenAMProxy).when(clientServiceDelegate).instantiateAMProxy(any(InetSocketAddress.class));
  JobStatus jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
  Assert.assertEquals("jobName-firstGen",jobStatus.getJobName());
  jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
  Assert.assertEquals("jobName-secondGen",jobStatus.getJobName());
  jobStatus=clientServiceDelegate.getJobStatus(oldJobId);
  Assert.assertNotNull(jobStatus);
  Assert.assertEquals("jobName-secondGen",jobStatus.getJobName());
  verify(clientServiceDelegate,times(2)).instantiateAMProxy(any(InetSocketAddress.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestJobClientGetJob </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@SuppressWarnings("deprecation") @Test public void testGetRunningJobFromJobClient() throws Exception {
  JobConf conf=new JobConf();
  conf.set("mapreduce.framework.name","local");
  FileInputFormat.addInputPath(conf,createTempFile("in","hello"));
  Path outputDir=new Path(TEST_ROOT_DIR,getClass().getSimpleName());
  outputDir.getFileSystem(conf).delete(outputDir,true);
  FileOutputFormat.setOutputPath(conf,outputDir);
  JobClient jc=new JobClient(conf);
  RunningJob runningJob=jc.submitJob(conf);
  assertNotNull("Running job",runningJob);
  RunningJob newRunningJob=jc.getJob(runningJob.getID());
  assertNotNull("New running job",newRunningJob);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestJobConf </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getters and setters of JobConf
 */
@SuppressWarnings("deprecation") @Test(timeout=5000) public void testJobConf(){
  JobConf conf=new JobConf();
  Pattern pattern=conf.getJarUnpackPattern();
  assertEquals(Pattern.compile("(?:classes/|lib/).*").toString(),pattern.toString());
  assertFalse(conf.getKeepFailedTaskFiles());
  conf.setKeepFailedTaskFiles(true);
  assertTrue(conf.getKeepFailedTaskFiles());
  assertNull(conf.getKeepTaskFilesPattern());
  conf.setKeepTaskFilesPattern("123454");
  assertEquals("123454",conf.getKeepTaskFilesPattern());
  assertNotNull(conf.getWorkingDirectory());
  conf.setWorkingDirectory(new Path("test"));
  assertTrue(conf.getWorkingDirectory().toString().endsWith("test"));
  assertEquals(1,conf.getNumTasksToExecutePerJvm());
  assertNull(conf.getKeyFieldComparatorOption());
  conf.setKeyFieldComparatorOptions("keySpec");
  assertEquals("keySpec",conf.getKeyFieldComparatorOption());
  assertFalse(conf.getUseNewReducer());
  conf.setUseNewReducer(true);
  assertTrue(conf.getUseNewReducer());
  assertTrue(conf.getMapSpeculativeExecution());
  assertTrue(conf.getReduceSpeculativeExecution());
  assertTrue(conf.getSpeculativeExecution());
  conf.setReduceSpeculativeExecution(false);
  assertTrue(conf.getSpeculativeExecution());
  conf.setMapSpeculativeExecution(false);
  assertFalse(conf.getSpeculativeExecution());
  assertFalse(conf.getMapSpeculativeExecution());
  assertFalse(conf.getReduceSpeculativeExecution());
  conf.setSessionId("ses");
  assertEquals("ses",conf.getSessionId());
  assertEquals(3,conf.getMaxTaskFailuresPerTracker());
  conf.setMaxTaskFailuresPerTracker(2);
  assertEquals(2,conf.getMaxTaskFailuresPerTracker());
  assertEquals(0,conf.getMaxMapTaskFailuresPercent());
  conf.setMaxMapTaskFailuresPercent(50);
  assertEquals(50,conf.getMaxMapTaskFailuresPercent());
  assertEquals(0,conf.getMaxReduceTaskFailuresPercent());
  conf.setMaxReduceTaskFailuresPercent(70);
  assertEquals(70,conf.getMaxReduceTaskFailuresPercent());
  assertEquals(JobPriority.NORMAL.name(),conf.getJobPriority().name());
  conf.setJobPriority(JobPriority.HIGH);
  assertEquals(JobPriority.HIGH.name(),conf.getJobPriority().name());
  assertNull(conf.getJobSubmitHostName());
  conf.setJobSubmitHostName("hostname");
  assertEquals("hostname",conf.getJobSubmitHostName());
  assertNull(conf.getJobSubmitHostAddress());
  conf.setJobSubmitHostAddress("ww");
  assertEquals("ww",conf.getJobSubmitHostAddress());
  assertFalse(conf.getProfileEnabled());
  conf.setProfileEnabled(true);
  assertTrue(conf.getProfileEnabled());
  assertEquals(conf.getProfileTaskRange(true).toString(),"0-2");
  assertEquals(conf.getProfileTaskRange(false).toString(),"0-2");
  conf.setProfileTaskRange(true,"0-3");
  assertEquals(conf.getProfileTaskRange(false).toString(),"0-2");
  assertEquals(conf.getProfileTaskRange(true).toString(),"0-3");
  assertNull(conf.getMapDebugScript());
  conf.setMapDebugScript("mDbgScript");
  assertEquals("mDbgScript",conf.getMapDebugScript());
  assertNull(conf.getReduceDebugScript());
  conf.setReduceDebugScript("rDbgScript");
  assertEquals("rDbgScript",conf.getReduceDebugScript());
  assertNull(conf.getJobLocalDir());
  assertEquals("default",conf.getQueueName());
  conf.setQueueName("qname");
  assertEquals("qname",conf.getQueueName());
  conf.setMemoryForMapTask(100 * 1000);
  assertEquals(100 * 1000,conf.getMemoryForMapTask());
  conf.setMemoryForReduceTask(1000 * 1000);
  assertEquals(1000 * 1000,conf.getMemoryForReduceTask());
  assertEquals(-1,conf.getMaxPhysicalMemoryForTask());
  assertEquals("The variable key is no longer used.",JobConf.deprecatedString("key"));
  assertEquals("mapreduce.map.java.opts should not be set by default",null,conf.get(JobConf.MAPRED_MAP_TASK_JAVA_OPTS));
  assertEquals("mapreduce.reduce.java.opts should not be set by default",null,conf.get(JobConf.MAPRED_REDUCE_TASK_JAVA_OPTS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestLineRecordReader </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStripBOM() throws IOException {
  String UTF8_BOM="\uFEFF";
  URL testFileUrl=getClass().getClassLoader().getResource("testBOM.txt");
  assertNotNull("Cannot find testBOM.txt",testFileUrl);
  File testFile=new File(testFileUrl.getFile());
  Path testFilePath=new Path(testFile.getAbsolutePath());
  long testFileSize=testFile.length();
  Configuration conf=new Configuration();
  conf.setInt(org.apache.hadoop.mapreduce.lib.input.LineRecordReader.MAX_LINE_LENGTH,Integer.MAX_VALUE);
  FileSplit split=new FileSplit(testFilePath,0,testFileSize,(String[])null);
  LineRecordReader reader=new LineRecordReader(conf,split);
  LongWritable key=new LongWritable();
  Text value=new Text();
  int numRecords=0;
  boolean firstLine=true;
  boolean skipBOM=true;
  while (reader.next(key,value)) {
    if (firstLine) {
      firstLine=false;
      if (value.toString().startsWith(UTF8_BOM)) {
        skipBOM=false;
      }
    }
    ++numRecords;
  }
  reader.close();
  assertTrue("BOM is not skipped",skipBOM);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestMRWithDistributedCache </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=1000) public void testDeprecatedFunctions() throws Exception {
  DistributedCache.addLocalArchives(conf,"Test Local Archives 1");
  Assert.assertEquals("Test Local Archives 1",conf.get(DistributedCache.CACHE_LOCALARCHIVES));
  Assert.assertEquals(1,DistributedCache.getLocalCacheArchives(conf).length);
  Assert.assertEquals("Test Local Archives 1",DistributedCache.getLocalCacheArchives(conf)[0].getName());
  DistributedCache.addLocalArchives(conf,"Test Local Archives 2");
  Assert.assertEquals("Test Local Archives 1,Test Local Archives 2",conf.get(DistributedCache.CACHE_LOCALARCHIVES));
  Assert.assertEquals(2,DistributedCache.getLocalCacheArchives(conf).length);
  Assert.assertEquals("Test Local Archives 2",DistributedCache.getLocalCacheArchives(conf)[1].getName());
  DistributedCache.setLocalArchives(conf,"Test Local Archives 3");
  Assert.assertEquals("Test Local Archives 3",conf.get(DistributedCache.CACHE_LOCALARCHIVES));
  Assert.assertEquals(1,DistributedCache.getLocalCacheArchives(conf).length);
  Assert.assertEquals("Test Local Archives 3",DistributedCache.getLocalCacheArchives(conf)[0].getName());
  DistributedCache.addLocalFiles(conf,"Test Local Files 1");
  Assert.assertEquals("Test Local Files 1",conf.get(DistributedCache.CACHE_LOCALFILES));
  Assert.assertEquals(1,DistributedCache.getLocalCacheFiles(conf).length);
  Assert.assertEquals("Test Local Files 1",DistributedCache.getLocalCacheFiles(conf)[0].getName());
  DistributedCache.addLocalFiles(conf,"Test Local Files 2");
  Assert.assertEquals("Test Local Files 1,Test Local Files 2",conf.get(DistributedCache.CACHE_LOCALFILES));
  Assert.assertEquals(2,DistributedCache.getLocalCacheFiles(conf).length);
  Assert.assertEquals("Test Local Files 2",DistributedCache.getLocalCacheFiles(conf)[1].getName());
  DistributedCache.setLocalFiles(conf,"Test Local Files 3");
  Assert.assertEquals("Test Local Files 3",conf.get(DistributedCache.CACHE_LOCALFILES));
  Assert.assertEquals(1,DistributedCache.getLocalCacheFiles(conf).length);
  Assert.assertEquals("Test Local Files 3",DistributedCache.getLocalCacheFiles(conf)[0].getName());
  DistributedCache.setArchiveTimestamps(conf,"1234567890");
  Assert.assertEquals(1234567890,conf.getLong(DistributedCache.CACHE_ARCHIVES_TIMESTAMPS,0));
  Assert.assertEquals(1,DistributedCache.getArchiveTimestamps(conf).length);
  Assert.assertEquals(1234567890,DistributedCache.getArchiveTimestamps(conf)[0]);
  DistributedCache.setFileTimestamps(conf,"1234567890");
  Assert.assertEquals(1234567890,conf.getLong(DistributedCache.CACHE_FILES_TIMESTAMPS,0));
  Assert.assertEquals(1,DistributedCache.getFileTimestamps(conf).length);
  Assert.assertEquals(1234567890,DistributedCache.getFileTimestamps(conf)[0]);
  DistributedCache.createAllSymlink(conf,new File("Test Job Cache Dir"),new File("Test Work Dir"));
  Assert.assertNull(conf.get(DistributedCache.CACHE_SYMLINK));
  Assert.assertTrue(DistributedCache.getSymlink(conf));
  Assert.assertTrue(symlinkFile.createNewFile());
  FileStatus fileStatus=DistributedCache.getFileStatus(conf,symlinkFile.toURI());
  Assert.assertNotNull(fileStatus);
  Assert.assertEquals(fileStatus.getModificationTime(),DistributedCache.getTimestamp(conf,symlinkFile.toURI()));
  Assert.assertTrue(symlinkFile.delete());
  DistributedCache.addCacheArchive(symlinkFile.toURI(),conf);
  Assert.assertEquals(symlinkFile.toURI().toString(),conf.get(DistributedCache.CACHE_ARCHIVES));
  Assert.assertEquals(1,DistributedCache.getCacheArchives(conf).length);
  Assert.assertEquals(symlinkFile.toURI(),DistributedCache.getCacheArchives(conf)[0]);
  DistributedCache.addCacheFile(symlinkFile.toURI(),conf);
  Assert.assertEquals(symlinkFile.toURI().toString(),conf.get(DistributedCache.CACHE_FILES));
  Assert.assertEquals(1,DistributedCache.getCacheFiles(conf).length);
  Assert.assertEquals(symlinkFile.toURI(),DistributedCache.getCacheFiles(conf)[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestNetworkedJob </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test(timeout=5000) public void testGetNullCounters() throws Exception {
  Job mockJob=mock(Job.class);
  RunningJob underTest=new JobClient.NetworkedJob(mockJob);
  when(mockJob.getCounters()).thenReturn(null);
  assertNull(underTest.getCounters());
  verify(mockJob).getCounters();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestOldCombinerGrouping </h4><pre class="type-9 type-11 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCombiner() throws Exception {
  if (!new File(TEST_ROOT_DIR).mkdirs()) {
    throw new RuntimeException("Could not create test dir: " + TEST_ROOT_DIR);
  }
  File in=new File(TEST_ROOT_DIR,"input");
  if (!in.mkdirs()) {
    throw new RuntimeException("Could not create test dir: " + in);
  }
  File out=new File(TEST_ROOT_DIR,"output");
  PrintWriter pw=new PrintWriter(new FileWriter(new File(in,"data.txt")));
  pw.println("A|a,1");
  pw.println("A|b,2");
  pw.println("B|a,3");
  pw.println("B|b,4");
  pw.println("B|c,5");
  pw.close();
  JobConf job=new JobConf();
  job.set("mapreduce.framework.name","local");
  TextInputFormat.setInputPaths(job,new Path(in.getPath()));
  TextOutputFormat.setOutputPath(job,new Path(out.getPath()));
  job.setMapperClass(Map.class);
  job.setReducerClass(Reduce.class);
  job.setInputFormat(TextInputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(LongWritable.class);
  job.setOutputFormat(TextOutputFormat.class);
  job.setOutputValueGroupingComparator(GroupComparator.class);
  job.setCombinerClass(Combiner.class);
  job.setCombinerKeyGroupingComparator(GroupComparator.class);
  job.setInt("min.num.spills.for.combine",0);
  JobClient client=new JobClient(job);
  RunningJob runningJob=client.submitJob(job);
  runningJob.waitForCompletion();
  if (runningJob.isSuccessful()) {
    Counters counters=runningJob.getCounters();
    long combinerInputRecords=counters.getGroup("org.apache.hadoop.mapreduce.TaskCounter").getCounter("COMBINE_INPUT_RECORDS");
    long combinerOutputRecords=counters.getGroup("org.apache.hadoop.mapreduce.TaskCounter").getCounter("COMBINE_OUTPUT_RECORDS");
    Assert.assertTrue(combinerInputRecords > 0);
    Assert.assertTrue(combinerInputRecords > combinerOutputRecords);
    BufferedReader br=new BufferedReader(new FileReader(new File(out,"part-00000")));
    Set<String> output=new HashSet<String>();
    String line=br.readLine();
    Assert.assertNotNull(line);
    output.add(line.substring(0,1) + line.substring(4,5));
    line=br.readLine();
    Assert.assertNotNull(line);
    output.add(line.substring(0,1) + line.substring(4,5));
    line=br.readLine();
    Assert.assertNull(line);
    br.close();
    Set<String> expected=new HashSet<String>();
    expected.add("A2");
    expected.add("B5");
    Assert.assertEquals(expected,output);
  }
 else {
    Assert.fail("Job failed");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestOldMethodsJobID </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test Reporter.NULL
 */
@Test(timeout=5000) public void testReporter(){
  Reporter nullReporter=Reporter.NULL;
  assertNull(nullReporter.getCounter(null));
  assertNull(nullReporter.getCounter("group","name"));
  try {
    assertNull(nullReporter.getInputSplit());
  }
 catch (  UnsupportedOperationException e) {
    assertEquals("NULL reporter has no input",e.getMessage());
  }
  assertEquals(0,nullReporter.getProgress(),0.01);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestQueue </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test QueueManager
 * configuration from file
 * @throws IOException
 */
@Test(timeout=5000) public void testQueue() throws IOException {
  File f=null;
  try {
    f=writeFile();
    QueueManager manager=new QueueManager(f.getCanonicalPath(),true);
    manager.setSchedulerInfo("first","queueInfo");
    manager.setSchedulerInfo("second","queueInfoqueueInfo");
    Queue root=manager.getRoot();
    assertTrue(root.getChildren().size() == 2);
    Iterator<Queue> iterator=root.getChildren().iterator();
    Queue firstSubQueue=iterator.next();
    assertTrue(firstSubQueue.getName().equals("first"));
    assertEquals(firstSubQueue.getAcls().get("mapred.queue.first.acl-submit-job").toString(),"Users [user1, user2] and members of the groups [group1, group2] are allowed");
    Queue secondSubQueue=iterator.next();
    assertTrue(secondSubQueue.getName().equals("second"));
    assertEquals(secondSubQueue.getProperties().getProperty("key"),"value");
    assertEquals(secondSubQueue.getProperties().getProperty("key1"),"value1");
    assertEquals(firstSubQueue.getState().getStateName(),"running");
    assertEquals(secondSubQueue.getState().getStateName(),"stopped");
    Set<String> template=new HashSet<String>();
    template.add("first");
    template.add("second");
    assertEquals(manager.getLeafQueueNames(),template);
    UserGroupInformation mockUGI=mock(UserGroupInformation.class);
    when(mockUGI.getShortUserName()).thenReturn("user1");
    String[] groups={"group1"};
    when(mockUGI.getGroupNames()).thenReturn(groups);
    assertTrue(manager.hasAccess("first",QueueACL.SUBMIT_JOB,mockUGI));
    assertFalse(manager.hasAccess("second",QueueACL.SUBMIT_JOB,mockUGI));
    assertFalse(manager.hasAccess("first",QueueACL.ADMINISTER_JOBS,mockUGI));
    when(mockUGI.getShortUserName()).thenReturn("user3");
    assertTrue(manager.hasAccess("first",QueueACL.ADMINISTER_JOBS,mockUGI));
    QueueAclsInfo[] qai=manager.getQueueAcls(mockUGI);
    assertEquals(qai.length,1);
    manager.refreshQueues(getConfiguration(),null);
    iterator=root.getChildren().iterator();
    Queue firstSubQueue1=iterator.next();
    Queue secondSubQueue1=iterator.next();
    assertTrue(firstSubQueue.equals(firstSubQueue1));
    assertEquals(firstSubQueue1.getState().getStateName(),"running");
    assertEquals(secondSubQueue1.getState().getStateName(),"stopped");
    assertEquals(firstSubQueue1.getSchedulingInfo(),"queueInfo");
    assertEquals(secondSubQueue1.getSchedulingInfo(),"queueInfoqueueInfo");
    assertEquals(firstSubQueue.getJobQueueInfo().getQueueName(),"first");
    assertEquals(firstSubQueue.getJobQueueInfo().getQueueState(),"running");
    assertEquals(firstSubQueue.getJobQueueInfo().getSchedulingInfo(),"queueInfo");
    assertEquals(secondSubQueue.getJobQueueInfo().getChildren().size(),0);
    assertEquals(manager.getSchedulerInfo("first"),"queueInfo");
    Set<String> queueJobQueueInfos=new HashSet<String>();
    for (    JobQueueInfo jobInfo : manager.getJobQueueInfos()) {
      queueJobQueueInfos.add(jobInfo.getQueueName());
    }
    Set<String> rootJobQueueInfos=new HashSet<String>();
    for (    Queue queue : root.getChildren()) {
      rootJobQueueInfos.add(queue.getJobQueueInfo().getQueueName());
    }
    assertEquals(queueJobQueueInfos,rootJobQueueInfos);
    assertEquals(manager.getJobQueueInfoMapping().get("first").getQueueName(),"first");
    Writer writer=new StringWriter();
    Configuration conf=getConfiguration();
    conf.unset(DeprecatedQueueConfigurationParser.MAPRED_QUEUE_NAMES_KEY);
    QueueManager.dumpConfiguration(writer,f.getAbsolutePath(),conf);
    String result=writer.toString();
    assertTrue(result.indexOf("\"name\":\"first\",\"state\":\"running\",\"acl_submit_job\":\"user1,user2 group1,group2\",\"acl_administer_jobs\":\"user3,user4 group3,group4\",\"properties\":[],\"children\":[]") > 0);
    writer=new StringWriter();
    QueueManager.dumpConfiguration(writer,conf);
    result=writer.toString();
    assertEquals("{\"queues\":[{\"name\":\"default\",\"state\":\"running\",\"acl_submit_job\":\"*\",\"acl_administer_jobs\":\"*\",\"properties\":[],\"children\":[]},{\"name\":\"q1\",\"state\":\"running\",\"acl_submit_job\":\" \",\"acl_administer_jobs\":\" \",\"properties\":[],\"children\":[{\"name\":\"q1:q2\",\"state\":\"running\",\"acl_submit_job\":\" \",\"acl_administer_jobs\":\" \",\"properties\":[{\"key\":\"capacity\",\"value\":\"20\"},{\"key\":\"user-limit\",\"value\":\"30\"}],\"children\":[]}]}]}",result);
    QueueAclsInfo qi=new QueueAclsInfo();
    assertNull(qi.getQueueName());
  }
  finally {
    if (f != null) {
      f.delete();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestSkipBadRecords </h4><pre class="type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testSkipBadRecords(){
  Configuration conf=new Configuration();
  assertEquals(2,SkipBadRecords.getAttemptsToStartSkipping(conf));
  assertTrue(SkipBadRecords.getAutoIncrMapperProcCount(conf));
  assertTrue(SkipBadRecords.getAutoIncrReducerProcCount(conf));
  assertEquals(0,SkipBadRecords.getMapperMaxSkipRecords(conf));
  assertEquals(0,SkipBadRecords.getReducerMaxSkipGroups(conf),0);
  assertNull(SkipBadRecords.getSkipOutputPath(conf));
  SkipBadRecords.setAttemptsToStartSkipping(conf,5);
  SkipBadRecords.setAutoIncrMapperProcCount(conf,false);
  SkipBadRecords.setAutoIncrReducerProcCount(conf,false);
  SkipBadRecords.setMapperMaxSkipRecords(conf,6L);
  SkipBadRecords.setReducerMaxSkipGroups(conf,7L);
  JobConf jc=new JobConf();
  SkipBadRecords.setSkipOutputPath(jc,new Path("test"));
  assertEquals(5,SkipBadRecords.getAttemptsToStartSkipping(conf));
  assertFalse(SkipBadRecords.getAutoIncrMapperProcCount(conf));
  assertFalse(SkipBadRecords.getAutoIncrReducerProcCount(conf));
  assertEquals(6L,SkipBadRecords.getMapperMaxSkipRecords(conf));
  assertEquals(7L,SkipBadRecords.getReducerMaxSkipGroups(conf),0);
  assertEquals("test",SkipBadRecords.getSkipOutputPath(jc).toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestTaskAttemptListenerImpl </h4><pre class="type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testGetTask() throws IOException {
  AppContext appCtx=mock(AppContext.class);
  JobTokenSecretManager secret=mock(JobTokenSecretManager.class);
  RMHeartbeatHandler rmHeartbeatHandler=mock(RMHeartbeatHandler.class);
  TaskHeartbeatHandler hbHandler=mock(TaskHeartbeatHandler.class);
  Dispatcher dispatcher=mock(Dispatcher.class);
  EventHandler ea=mock(EventHandler.class);
  when(dispatcher.getEventHandler()).thenReturn(ea);
  when(appCtx.getEventHandler()).thenReturn(ea);
  CheckpointAMPreemptionPolicy policy=new CheckpointAMPreemptionPolicy();
  policy.init(appCtx);
  MockTaskAttemptListenerImpl listener=new MockTaskAttemptListenerImpl(appCtx,secret,rmHeartbeatHandler,hbHandler,policy);
  Configuration conf=new Configuration();
  listener.init(conf);
  listener.start();
  JVMId id=new JVMId("foo",1,true,1);
  WrappedJvmID wid=new WrappedJvmID(id.getJobId(),id.isMap,id.getId());
  JvmContext context=new JvmContext();
  context.jvmId=id;
  JvmTask result=listener.getTask(context);
  assertNotNull(result);
  assertTrue(result.shouldDie);
  TaskAttemptId attemptID=mock(TaskAttemptId.class);
  Task task=mock(Task.class);
  listener.registerPendingTask(task,wid);
  result=listener.getTask(context);
  assertNull(result);
  listener.unregister(attemptID,wid);
  listener.registerPendingTask(task,wid);
  listener.registerLaunchedTask(attemptID,wid);
  verify(hbHandler).register(attemptID);
  result=listener.getTask(context);
  assertNotNull(result);
  assertFalse(result.shouldDie);
  result=listener.getTask(context);
  assertNotNull(result);
  assertTrue(result.shouldDie);
  listener.unregister(attemptID,wid);
  result=listener.getTask(context);
  assertNotNull(result);
  assertTrue(result.shouldDie);
  listener.stop();
  JVMId jvmid=JVMId.forName("jvm_001_002_m_004");
  assertNotNull(jvmid);
  try {
    JVMId.forName("jvm_001_002_m_004_006");
    fail();
  }
 catch (  IllegalArgumentException e) {
    assertEquals(e.getMessage(),"TaskId string : jvm_001_002_m_004_006 is not properly formed");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.TestYARNRunner </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAMStandardEnv() throws Exception {
  final String ADMIN_LIB_PATH="foo";
  final String USER_LIB_PATH="bar";
  final String USER_SHELL="shell";
  JobConf jobConf=new JobConf();
  jobConf.set(MRJobConfig.MR_AM_ADMIN_USER_ENV,"LD_LIBRARY_PATH=" + ADMIN_LIB_PATH);
  jobConf.set(MRJobConfig.MR_AM_ENV,"LD_LIBRARY_PATH=" + USER_LIB_PATH);
  jobConf.set(MRJobConfig.MAPRED_ADMIN_USER_SHELL,USER_SHELL);
  YARNRunner yarnRunner=new YARNRunner(jobConf);
  ApplicationSubmissionContext appSubCtx=buildSubmitContext(yarnRunner,jobConf);
  ContainerLaunchContext clc=appSubCtx.getAMContainerSpec();
  Map<String,String> env=clc.getEnvironment();
  String libPath=env.get(Environment.LD_LIBRARY_PATH.name());
  assertNotNull("LD_LIBRARY_PATH not set",libPath);
  String cps=jobConf.getBoolean(MRConfig.MAPREDUCE_APP_SUBMISSION_CROSS_PLATFORM,MRConfig.DEFAULT_MAPREDUCE_APP_SUBMISSION_CROSS_PLATFORM) ? ApplicationConstants.CLASS_PATH_SEPARATOR : File.pathSeparator;
  assertEquals("Bad AM LD_LIBRARY_PATH setting",MRApps.crossPlatformifyMREnv(conf,Environment.PWD) + cps + ADMIN_LIB_PATH+ cps+ USER_LIB_PATH,libPath);
  String shell=env.get(Environment.SHELL.name());
  assertNotNull("SHELL not set",shell);
  assertEquals("Bad SHELL setting",USER_SHELL,shell);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestGridmixMemoryEmulation </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link TotalHeapUsageEmulatorPlugin}.
 */
@Test public void testTotalHeapUsageEmulatorPlugin() throws Exception {
  Configuration conf=new Configuration();
  ResourceCalculatorPlugin monitor=new DummyResourceCalculatorPlugin();
  long maxHeapUsage=1024 * TotalHeapUsageEmulatorPlugin.ONE_MB;
  conf.setLong(DummyResourceCalculatorPlugin.MAXPMEM_TESTING_PROPERTY,maxHeapUsage);
  monitor.setConf(conf);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.MIN_HEAP_FREE_RATIO,0F);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.HEAP_LOAD_RATIO,1F);
  long targetHeapUsageInMB=200;
  FakeProgressive fakeProgress=new FakeProgressive();
  FakeHeapUsageEmulatorCore fakeCore=new FakeHeapUsageEmulatorCore();
  FakeHeapUsageEmulatorPlugin heapPlugin=new FakeHeapUsageEmulatorPlugin(fakeCore);
  ResourceUsageMetrics invalidUsage=TestResourceUsageEmulators.createMetrics(0);
  heapPlugin.initialize(conf,invalidUsage,null,null);
  int numCallsPre=fakeCore.getNumCalls();
  long heapUsagePre=fakeCore.getHeapUsageInMB();
  heapPlugin.emulate();
  int numCallsPost=fakeCore.getNumCalls();
  long heapUsagePost=fakeCore.getHeapUsageInMB();
  assertEquals("Disabled heap usage emulation plugin works!",numCallsPre,numCallsPost);
  assertEquals("Disabled heap usage emulation plugin works!",heapUsagePre,heapUsagePost);
  float progress=heapPlugin.getProgress();
  assertEquals("Invalid progress of disabled cumulative heap usage emulation " + "plugin!",1.0f,progress,0f);
  Boolean failed=null;
  invalidUsage=TestResourceUsageEmulators.createMetrics(maxHeapUsage + TotalHeapUsageEmulatorPlugin.ONE_MB);
  try {
    heapPlugin.initialize(conf,invalidUsage,monitor,null);
    failed=false;
  }
 catch (  Exception e) {
    failed=true;
  }
  assertNotNull("Fail case failure!",failed);
  assertTrue("Expected failure!",failed);
  ResourceUsageMetrics metrics=TestResourceUsageEmulators.createMetrics(targetHeapUsageInMB * TotalHeapUsageEmulatorPlugin.ONE_MB);
  testEmulationAccuracy(conf,fakeCore,monitor,metrics,heapPlugin,200,10);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.HEAP_EMULATION_PROGRESS_INTERVAL,0.2F);
  testEmulationAccuracy(conf,fakeCore,monitor,metrics,heapPlugin,200,5);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.HEAP_LOAD_RATIO,1F);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.MIN_HEAP_FREE_RATIO,0.5F);
  testEmulationAccuracy(conf,fakeCore,monitor,metrics,heapPlugin,120,2);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.HEAP_LOAD_RATIO,0.5F);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.MIN_HEAP_FREE_RATIO,0F);
  testEmulationAccuracy(conf,fakeCore,monitor,metrics,heapPlugin,200,10);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.MIN_HEAP_FREE_RATIO,0.25F);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.HEAP_LOAD_RATIO,0.5F);
  testEmulationAccuracy(conf,fakeCore,monitor,metrics,heapPlugin,162,6);
  fakeProgress=new FakeProgressive();
  conf.setFloat(TotalHeapUsageEmulatorPlugin.MIN_HEAP_FREE_RATIO,0F);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.HEAP_LOAD_RATIO,1F);
  conf.setFloat(TotalHeapUsageEmulatorPlugin.HEAP_EMULATION_PROGRESS_INTERVAL,0.25F);
  heapPlugin.initialize(conf,metrics,monitor,fakeProgress);
  fakeCore.resetFake();
  long initHeapUsage=fakeCore.getHeapUsageInMB();
  long initNumCallsUsage=fakeCore.getNumCalls();
  testEmulationBoundary(0F,fakeCore,fakeProgress,heapPlugin,initHeapUsage,initNumCallsUsage,"[no-op, 0 progress]");
  testEmulationBoundary(0.24F,fakeCore,fakeProgress,heapPlugin,initHeapUsage,initNumCallsUsage,"[no-op, 24% progress]");
  testEmulationBoundary(0.25F,fakeCore,fakeProgress,heapPlugin,targetHeapUsageInMB / 4,1,"[op, 25% progress]");
  testEmulationBoundary(0.80F,fakeCore,fakeProgress,heapPlugin,(targetHeapUsageInMB * 4) / 5,2,"[op, 80% progress]");
  testEmulationBoundary(1F,fakeCore,fakeProgress,heapPlugin,targetHeapUsageInMB,3,"[op, 100% progress]");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestGridmixSummary </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test {@link DataStatistics}.
 */
@Test public void testDataStatistics() throws Exception {
  DataStatistics stats=new DataStatistics(10,2,true);
  assertEquals("Data size mismatch",10,stats.getDataSize());
  assertEquals("Num files mismatch",2,stats.getNumFiles());
  assertTrue("Compression configuration mismatch",stats.isDataCompressed());
  stats=new DataStatistics(100,5,false);
  assertEquals("Data size mismatch",100,stats.getDataSize());
  assertEquals("Num files mismatch",5,stats.getNumFiles());
  assertFalse("Compression configuration mismatch",stats.isDataCompressed());
  Configuration conf=new Configuration();
  Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp"));
  Path testDir=new Path(rootTempDir,"testDataStatistics");
  FileSystem fs=testDir.getFileSystem(conf);
  fs.delete(testDir,true);
  Path testInputDir=new Path(testDir,"test");
  fs.mkdirs(testInputDir);
  CompressionEmulationUtil.setCompressionEmulationEnabled(conf,true);
  Boolean failed=null;
  try {
    GenerateData.publishDataStatistics(testInputDir,1024L,conf);
    failed=false;
  }
 catch (  RuntimeException e) {
    failed=true;
  }
  assertNotNull("Expected failure!",failed);
  assertTrue("Compression data publishing error",failed);
  CompressionEmulationUtil.setCompressionEmulationEnabled(conf,false);
  stats=GenerateData.publishDataStatistics(testInputDir,1024L,conf);
  assertEquals("Data size mismatch",0,stats.getDataSize());
  assertEquals("Num files mismatch",0,stats.getNumFiles());
  assertFalse("Compression configuration mismatch",stats.isDataCompressed());
  CompressionEmulationUtil.setCompressionEmulationEnabled(conf,false);
  Path inputDataFile=new Path(testInputDir,"test");
  long size=UtilsForTests.createTmpFileDFS(fs,inputDataFile,FsPermission.createImmutable((short)777),"hi hello bye").size();
  stats=GenerateData.publishDataStatistics(testInputDir,-1,conf);
  assertEquals("Data size mismatch",size,stats.getDataSize());
  assertEquals("Num files mismatch",1,stats.getNumFiles());
  assertFalse("Compression configuration mismatch",stats.isDataCompressed());
  CompressionEmulationUtil.setCompressionEmulationEnabled(conf,true);
  failed=null;
  try {
    GenerateData.publishDataStatistics(testInputDir,1234L,conf);
    failed=false;
  }
 catch (  RuntimeException e) {
    failed=true;
  }
  assertNotNull("Expected failure!",failed);
  assertTrue("Compression data publishing error",failed);
  CompressionEmulationUtil.setCompressionEmulationEnabled(conf,false);
  fs.delete(inputDataFile,false);
  inputDataFile=new Path(testInputDir,"test.gz");
  size=UtilsForTests.createTmpFileDFS(fs,inputDataFile,FsPermission.createImmutable((short)777),"hi hello").size();
  stats=GenerateData.publishDataStatistics(testInputDir,1234L,conf);
  assertEquals("Data size mismatch",size,stats.getDataSize());
  assertEquals("Num files mismatch",1,stats.getNumFiles());
  assertFalse("Compression configuration mismatch",stats.isDataCompressed());
  CompressionEmulationUtil.setCompressionEmulationEnabled(conf,true);
  stats=GenerateData.publishDataStatistics(testInputDir,1234L,conf);
  assertEquals("Data size mismatch",size,stats.getDataSize());
  assertEquals("Num files mismatch",1,stats.getNumFiles());
  assertTrue("Compression configuration mismatch",stats.isDataCompressed());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.gridmix.TestHighRamJob </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests high ram job properties configuration.
 */
@SuppressWarnings("deprecation") @Test public void testHighRamFeatureEmulation() throws IOException {
  Configuration gridmixConf=new Configuration();
  gridmixConf.setBoolean(GridmixJob.GRIDMIX_HIGHRAM_EMULATION_ENABLE,false);
  testHighRamConfig(10,20,5,10,MRJobConfig.DEFAULT_MAP_MEMORY_MB,MRJobConfig.DEFAULT_REDUCE_MEMORY_MB,MRJobConfig.DEFAULT_MAP_MEMORY_MB,MRJobConfig.DEFAULT_REDUCE_MEMORY_MB,gridmixConf);
  gridmixConf=new Configuration();
  gridmixConf.setLong(JobConf.UPPER_LIMIT_ON_TASK_VMEM_PROPERTY,20 * 1024 * 1024);
  testHighRamConfig(10,20,5,10,5,10,10,20,gridmixConf);
  gridmixConf=new Configuration();
  gridmixConf.setLong(JTConfig.JT_MAX_MAPMEMORY_MB,100);
  gridmixConf.setLong(JTConfig.JT_MAX_REDUCEMEMORY_MB,300);
  testHighRamConfig(10,45,5,15,50,100,100,300,gridmixConf);
  gridmixConf=new Configuration();
  gridmixConf.setLong(JobConf.UPPER_LIMIT_ON_TASK_VMEM_PROPERTY,70 * 1024 * 1024);
  Boolean failed=null;
  try {
    testHighRamConfig(10,45,5,15,50,100,100,300,gridmixConf);
    failed=false;
  }
 catch (  Exception e) {
    failed=true;
  }
  assertNotNull(failed);
  assertTrue("Exception expected for exceeding map memory limit " + "(deprecation)!",failed);
  gridmixConf=new Configuration();
  gridmixConf.setLong(JobConf.UPPER_LIMIT_ON_TASK_VMEM_PROPERTY,150 * 1024 * 1024);
  failed=null;
  try {
    testHighRamConfig(10,45,5,15,50,100,100,300,gridmixConf);
    failed=false;
  }
 catch (  Exception e) {
    failed=true;
  }
  assertNotNull(failed);
  assertTrue("Exception expected for exceeding reduce memory limit " + "(deprecation)!",failed);
  gridmixConf=new Configuration();
  gridmixConf.setLong(JTConfig.JT_MAX_MAPMEMORY_MB,70);
  failed=null;
  try {
    testHighRamConfig(10,45,5,15,50,100,100,300,gridmixConf);
    failed=false;
  }
 catch (  Exception e) {
    failed=true;
  }
  assertNotNull(failed);
  assertTrue("Exception expected for exceeding map memory limit!",failed);
  gridmixConf=new Configuration();
  gridmixConf.setLong(JTConfig.JT_MAX_REDUCEMEMORY_MB,200);
  failed=null;
  try {
    testHighRamConfig(10,45,5,15,50,100,100,300,gridmixConf);
    failed=false;
  }
 catch (  Exception e) {
    failed=true;
  }
  assertNotNull(failed);
  assertTrue("Exception expected for exceeding reduce memory limit!",failed);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.jobcontrol.TestJobControl </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testGetAssignedJobId() throws Exception {
  JobConf jc=new JobConf();
  Job j=new Job(jc);
  assertNull(j.getAssignedJobID());
  org.apache.hadoop.mapreduce.Job mockjob=mock(org.apache.hadoop.mapreduce.Job.class);
  org.apache.hadoop.mapreduce.JobID jid=new org.apache.hadoop.mapreduce.JobID("test",0);
  when(mockjob.getJobID()).thenReturn(jid);
  j.setJob(mockjob);
  JobID expected=new JobID("test",0);
  assertEquals(expected,j.getAssignedJobID());
  verify(mockjob).getJobID();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.lib.db.TestDBInputFormat </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test configuration for db. should works DBConfiguration.* parameters. 
 */
@Test(timeout=5000) public void testSetInput(){
  JobConf configuration=new JobConf();
  String[] fieldNames={"field1","field2"};
  DBInputFormat.setInput(configuration,NullDBWritable.class,"table","conditions","orderBy",fieldNames);
  assertEquals("org.apache.hadoop.mapred.lib.db.DBInputFormat$NullDBWritable",configuration.getClass(DBConfiguration.INPUT_CLASS_PROPERTY,null).getName());
  assertEquals("table",configuration.get(DBConfiguration.INPUT_TABLE_NAME_PROPERTY,null));
  String[] fields=configuration.getStrings(DBConfiguration.INPUT_FIELD_NAMES_PROPERTY);
  assertEquals("field1",fields[0]);
  assertEquals("field2",fields[1]);
  assertEquals("conditions",configuration.get(DBConfiguration.INPUT_CONDITIONS_PROPERTY,null));
  assertEquals("orderBy",configuration.get(DBConfiguration.INPUT_ORDER_BY_PROPERTY,null));
  configuration=new JobConf();
  DBInputFormat.setInput(configuration,NullDBWritable.class,"query","countQuery");
  assertEquals("query",configuration.get(DBConfiguration.INPUT_QUERY,null));
  assertEquals("countQuery",configuration.get(DBConfiguration.INPUT_COUNT_QUERY,null));
  JobConf jConfiguration=new JobConf();
  DBConfiguration.configureDB(jConfiguration,"driverClass","dbUrl","user","password");
  assertEquals("driverClass",jConfiguration.get(DBConfiguration.DRIVER_CLASS_PROPERTY));
  assertEquals("dbUrl",jConfiguration.get(DBConfiguration.URL_PROPERTY));
  assertEquals("user",jConfiguration.get(DBConfiguration.USERNAME_PROPERTY));
  assertEquals("password",jConfiguration.get(DBConfiguration.PASSWORD_PROPERTY));
  jConfiguration=new JobConf();
  DBConfiguration.configureDB(jConfiguration,"driverClass","dbUrl");
  assertEquals("driverClass",jConfiguration.get(DBConfiguration.DRIVER_CLASS_PROPERTY));
  assertEquals("dbUrl",jConfiguration.get(DBConfiguration.URL_PROPERTY));
  assertNull(jConfiguration.get(DBConfiguration.USERNAME_PROPERTY));
  assertNull(jConfiguration.get(DBConfiguration.PASSWORD_PROPERTY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.pipes.TestPipeApplication </h4><pre class="type-9 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test org.apache.hadoop.mapred.pipes.Application
 * test a internal functions: MessageType.REGISTER_COUNTER,  INCREMENT_COUNTER, STATUS, PROGRESS...
 * @throws Throwable
 */
@Test public void testApplication() throws Throwable {
  JobConf conf=new JobConf();
  RecordReader<FloatWritable,NullWritable> rReader=new Reader();
  File fCommand=getFileCommand("org.apache.hadoop.mapred.pipes.PipeApplicationStub");
  TestTaskReporter reporter=new TestTaskReporter();
  File[] psw=cleanTokenPasswordFile();
  try {
    conf.set(MRJobConfig.TASK_ATTEMPT_ID,taskName);
    conf.set(MRJobConfig.CACHE_LOCALFILES,fCommand.getAbsolutePath());
    Token<AMRMTokenIdentifier> token=new Token<AMRMTokenIdentifier>("user".getBytes(),"password".getBytes(),new Text("kind"),new Text("service"));
    TokenCache.setJobToken(token,conf.getCredentials());
    FakeCollector output=new FakeCollector(new Counters.Counter(),new Progress());
    FileSystem fs=new RawLocalFileSystem();
    fs.setConf(conf);
    Writer<IntWritable,Text> wr=new Writer<IntWritable,Text>(conf,fs.create(new Path(workSpace.getAbsolutePath() + File.separator + "outfile")),IntWritable.class,Text.class,null,null,true);
    output.setWriter(wr);
    conf.set(Submitter.PRESERVE_COMMANDFILE,"true");
    initStdOut(conf);
    Application<WritableComparable<IntWritable>,Writable,IntWritable,Text> application=new Application<WritableComparable<IntWritable>,Writable,IntWritable,Text>(conf,rReader,output,reporter,IntWritable.class,Text.class);
    application.getDownlink().flush();
    application.getDownlink().mapItem(new IntWritable(3),new Text("txt"));
    application.getDownlink().flush();
    application.waitForFinish();
    wr.close();
    String stdOut=readStdOut(conf);
    assertTrue(stdOut.contains("key:3"));
    assertTrue(stdOut.contains("value:txt"));
    assertEquals(1.0,reporter.getProgress(),0.01);
    assertNotNull(reporter.getCounter("group","name"));
    assertEquals(reporter.getStatus(),"PROGRESS");
    stdOut=readFile(new File(workSpace.getAbsolutePath() + File.separator + "outfile"));
    assertEquals(0.55f,rReader.getProgress(),0.001);
    application.getDownlink().close();
    Entry<IntWritable,Text> entry=output.getCollect().entrySet().iterator().next();
    assertEquals(123,entry.getKey().get());
    assertEquals("value",entry.getValue().toString());
    try {
      application.abort(new Throwable());
      fail();
    }
 catch (    IOException e) {
      assertEquals("pipe child exception",e.getMessage());
    }
  }
  finally {
    if (psw != null) {
      for (      File file : psw) {
        file.deleteOnExit();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapred.pipes.TestPipesNonJavaInputFormat </h4><pre class="type-11 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test PipesNonJavaInputFormat
 */
@Test public void testFormat() throws IOException {
  PipesNonJavaInputFormat inputFormat=new PipesNonJavaInputFormat();
  JobConf conf=new JobConf();
  Reporter reporter=mock(Reporter.class);
  RecordReader<FloatWritable,NullWritable> reader=inputFormat.getRecordReader(new FakeSplit(),conf,reporter);
  assertEquals(0.0f,reader.getProgress(),0.001);
  File input1=new File(workSpace + File.separator + "input1");
  if (!input1.getParentFile().exists()) {
    Assert.assertTrue(input1.getParentFile().mkdirs());
  }
  if (!input1.exists()) {
    Assert.assertTrue(input1.createNewFile());
  }
  File input2=new File(workSpace + File.separator + "input2");
  if (!input2.exists()) {
    Assert.assertTrue(input2.createNewFile());
  }
  conf.set(org.apache.hadoop.mapreduce.lib.input.FileInputFormat.INPUT_DIR,StringUtils.escapeString(input1.getAbsolutePath()) + "," + StringUtils.escapeString(input2.getAbsolutePath()));
  InputSplit[] splits=inputFormat.getSplits(conf,2);
  assertEquals(2,splits.length);
  PipesNonJavaInputFormat.PipesDummyRecordReader dummyRecordReader=new PipesNonJavaInputFormat.PipesDummyRecordReader(conf,splits[0]);
  assertNull(dummyRecordReader.createKey());
  assertNull(dummyRecordReader.createValue());
  assertEquals(0,dummyRecordReader.getPos());
  assertEquals(0.0,dummyRecordReader.getProgress(),0.001);
  assertTrue(dummyRecordReader.next(new FloatWritable(2.0f),NullWritable.get()));
  assertEquals(2.0,dummyRecordReader.getProgress(),0.001);
  dummyRecordReader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestJob </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testJobToString() throws IOException, InterruptedException {
  Cluster cluster=mock(Cluster.class);
  ClientProtocol client=mock(ClientProtocol.class);
  when(cluster.getClient()).thenReturn(client);
  JobID jobid=new JobID("1014873536921",6);
  JobStatus status=new JobStatus(jobid,0.0f,0.0f,0.0f,0.0f,State.FAILED,JobPriority.NORMAL,"root","TestJobToString","job file","tracking url");
  when(client.getJobStatus(jobid)).thenReturn(status);
  when(client.getTaskReports(jobid,TaskType.MAP)).thenReturn(new TaskReport[0]);
  when(client.getTaskReports(jobid,TaskType.REDUCE)).thenReturn(new TaskReport[0]);
  when(client.getTaskCompletionEvents(jobid,0,10)).thenReturn(new TaskCompletionEvent[0]);
  Job job=Job.getInstance(cluster,status,new JobConf());
  Assert.assertNotNull(job.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestLocalRunner </h4><pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the GC counter actually increments when we know that we've
 * spent some time in the GC during the mapper.
 */
@Test public void testGcCounter() throws Exception {
  Path inputPath=getInputPath();
  Path outputPath=getOutputPath();
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.getLocal(conf);
  if (fs.exists(outputPath)) {
    fs.delete(outputPath,true);
  }
  if (fs.exists(inputPath)) {
    fs.delete(inputPath,true);
  }
  createInputFile(inputPath,0,20);
  Job job=Job.getInstance();
  job.setMapperClass(GCMapper.class);
  job.setNumReduceTasks(0);
  job.getConfiguration().set(MRJobConfig.IO_SORT_MB,"25");
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean ret=job.waitForCompletion(true);
  assertTrue("job failed",ret);
  Counter gcCounter=job.getCounters().findCounter(TaskCounter.GC_TIME_MILLIS);
  assertNotNull(gcCounter);
  assertTrue("No time spent in gc",gcCounter.getValue() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestNewCombinerGrouping </h4><pre class="type-9 type-11 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCombiner() throws Exception {
  if (!new File(TEST_ROOT_DIR).mkdirs()) {
    throw new RuntimeException("Could not create test dir: " + TEST_ROOT_DIR);
  }
  File in=new File(TEST_ROOT_DIR,"input");
  if (!in.mkdirs()) {
    throw new RuntimeException("Could not create test dir: " + in);
  }
  File out=new File(TEST_ROOT_DIR,"output");
  PrintWriter pw=new PrintWriter(new FileWriter(new File(in,"data.txt")));
  pw.println("A|a,1");
  pw.println("A|b,2");
  pw.println("B|a,3");
  pw.println("B|b,4");
  pw.println("B|c,5");
  pw.close();
  JobConf conf=new JobConf();
  conf.set("mapreduce.framework.name","local");
  Job job=new Job(conf);
  TextInputFormat.setInputPaths(job,new Path(in.getPath()));
  TextOutputFormat.setOutputPath(job,new Path(out.getPath()));
  job.setMapperClass(Map.class);
  job.setReducerClass(Reduce.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(LongWritable.class);
  job.setOutputFormatClass(TextOutputFormat.class);
  job.setGroupingComparatorClass(GroupComparator.class);
  job.setCombinerKeyGroupingComparatorClass(GroupComparator.class);
  job.setCombinerClass(Combiner.class);
  job.getConfiguration().setInt("min.num.spills.for.combine",0);
  job.submit();
  job.waitForCompletion(false);
  if (job.isSuccessful()) {
    Counters counters=job.getCounters();
    long combinerInputRecords=counters.findCounter("org.apache.hadoop.mapreduce.TaskCounter","COMBINE_INPUT_RECORDS").getValue();
    long combinerOutputRecords=counters.findCounter("org.apache.hadoop.mapreduce.TaskCounter","COMBINE_OUTPUT_RECORDS").getValue();
    Assert.assertTrue(combinerInputRecords > 0);
    Assert.assertTrue(combinerInputRecords > combinerOutputRecords);
    BufferedReader br=new BufferedReader(new FileReader(new File(out,"part-r-00000")));
    Set<String> output=new HashSet<String>();
    String line=br.readLine();
    Assert.assertNotNull(line);
    output.add(line.substring(0,1) + line.substring(4,5));
    line=br.readLine();
    Assert.assertNotNull(line);
    output.add(line.substring(0,1) + line.substring(4,5));
    line=br.readLine();
    Assert.assertNull(line);
    br.close();
    Set<String> expected=new HashSet<String>();
    expected.add("A2");
    expected.add("B5");
    Assert.assertEquals(expected,output);
  }
 else {
    Assert.fail("Job failed");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestShufflePlugin </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPluginAbility(){
  try {
    JobConf jobConf=new JobConf();
    jobConf.setClass(MRConfig.SHUFFLE_CONSUMER_PLUGIN,TestShufflePlugin.TestShuffleConsumerPlugin.class,ShuffleConsumerPlugin.class);
    ShuffleConsumerPlugin shuffleConsumerPlugin=null;
    Class<? extends ShuffleConsumerPlugin> clazz=jobConf.getClass(MRConfig.SHUFFLE_CONSUMER_PLUGIN,Shuffle.class,ShuffleConsumerPlugin.class);
    assertNotNull("Unable to get " + MRConfig.SHUFFLE_CONSUMER_PLUGIN,clazz);
    shuffleConsumerPlugin=ReflectionUtils.newInstance(clazz,jobConf);
    assertNotNull("Unable to load " + MRConfig.SHUFFLE_CONSUMER_PLUGIN,shuffleConsumerPlugin);
  }
 catch (  Exception e) {
    assertTrue("Threw exception:" + e,false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.TestTypeConverter </h4><pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromYarnApplicationReport(){
  ApplicationId mockAppId=mock(ApplicationId.class);
  when(mockAppId.getClusterTimestamp()).thenReturn(12345L);
  when(mockAppId.getId()).thenReturn(6789);
  ApplicationReport mockReport=mock(ApplicationReport.class);
  when(mockReport.getTrackingUrl()).thenReturn("dummy-tracking-url");
  when(mockReport.getApplicationId()).thenReturn(mockAppId);
  when(mockReport.getYarnApplicationState()).thenReturn(YarnApplicationState.KILLED);
  when(mockReport.getUser()).thenReturn("dummy-user");
  when(mockReport.getQueue()).thenReturn("dummy-queue");
  String jobFile="dummy-path/job.xml";
  try {
    JobStatus status=TypeConverter.fromYarn(mockReport,jobFile);
  }
 catch (  NullPointerException npe) {
    Assert.fail("Type converstion from YARN fails for jobs without " + "ApplicationUsageReport");
  }
  ApplicationResourceUsageReport appUsageRpt=Records.newRecord(ApplicationResourceUsageReport.class);
  Resource r=Records.newRecord(Resource.class);
  r.setMemory(2048);
  appUsageRpt.setNeededResources(r);
  appUsageRpt.setNumReservedContainers(1);
  appUsageRpt.setNumUsedContainers(3);
  appUsageRpt.setReservedResources(r);
  appUsageRpt.setUsedResources(r);
  when(mockReport.getApplicationResourceUsageReport()).thenReturn(appUsageRpt);
  JobStatus status=TypeConverter.fromYarn(mockReport,jobFile);
  Assert.assertNotNull("fromYarn returned null status",status);
  Assert.assertEquals("jobFile set incorrectly","dummy-path/job.xml",status.getJobFile());
  Assert.assertEquals("queue set incorrectly","dummy-queue",status.getQueue());
  Assert.assertEquals("trackingUrl set incorrectly","dummy-tracking-url",status.getTrackingUrl());
  Assert.assertEquals("user set incorrectly","dummy-user",status.getUsername());
  Assert.assertEquals("schedulingInfo set incorrectly","dummy-tracking-url",status.getSchedulingInfo());
  Assert.assertEquals("jobId set incorrectly",6789,status.getJobID().getId());
  Assert.assertEquals("state set incorrectly",JobStatus.State.KILLED,status.getState());
  Assert.assertEquals("needed mem info set incorrectly",2048,status.getNeededMem());
  Assert.assertEquals("num rsvd slots info set incorrectly",1,status.getNumReservedSlots());
  Assert.assertEquals("num used slots info set incorrectly",3,status.getNumUsedSlots());
  Assert.assertEquals("rsvd mem info set incorrectly",2048,status.getReservedMem());
  Assert.assertEquals("used mem info set incorrectly",2048,status.getUsedMem());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.filecache.TestClientDistributedCacheManager </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineTimestamps() throws IOException {
  Job job=Job.getInstance(conf);
  job.addCacheFile(firstCacheFile.toUri());
  job.addCacheFile(secondCacheFile.toUri());
  Configuration jobConf=job.getConfiguration();
  Map<URI,FileStatus> statCache=new HashMap<URI,FileStatus>();
  ClientDistributedCacheManager.determineTimestamps(jobConf,statCache);
  FileStatus firstStatus=statCache.get(firstCacheFile.toUri());
  FileStatus secondStatus=statCache.get(secondCacheFile.toUri());
  Assert.assertNotNull(firstStatus);
  Assert.assertNotNull(secondStatus);
  Assert.assertEquals(2,statCache.size());
  String expected=firstStatus.getModificationTime() + "," + secondStatus.getModificationTime();
  Assert.assertEquals(expected,jobConf.get(MRJobConfig.CACHE_FILE_TIMESTAMPS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.input.TestCombineSequenceFileInputFormat </h4><pre class="type-9 type-13 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testFormat() throws IOException, InterruptedException {
  Job job=Job.getInstance(conf);
  Random random=new Random();
  long seed=random.nextLong();
  random.setSeed(seed);
  localFs.delete(workDir,true);
  FileInputFormat.setInputPaths(job,workDir);
  final int length=10000;
  final int numFiles=10;
  createFiles(length,numFiles,random,job);
  TaskAttemptContext context=MapReduceTestUtil.createDummyMapTaskAttemptContext(job.getConfiguration());
  InputFormat<IntWritable,BytesWritable> format=new CombineSequenceFileInputFormat<IntWritable,BytesWritable>();
  for (int i=0; i < 3; i++) {
    int numSplits=random.nextInt(length / (SequenceFile.SYNC_INTERVAL / 20)) + 1;
    LOG.info("splitting: requesting = " + numSplits);
    List<InputSplit> splits=format.getSplits(job);
    LOG.info("splitting: got =        " + splits.size());
    assertEquals("We got more than one splits!",1,splits.size());
    InputSplit split=splits.get(0);
    assertEquals("It should be CombineFileSplit",CombineFileSplit.class,split.getClass());
    BitSet bits=new BitSet(length);
    RecordReader<IntWritable,BytesWritable> reader=format.createRecordReader(split,context);
    MapContext<IntWritable,BytesWritable,IntWritable,BytesWritable> mcontext=new MapContextImpl<IntWritable,BytesWritable,IntWritable,BytesWritable>(job.getConfiguration(),context.getTaskAttemptID(),reader,null,null,MapReduceTestUtil.createDummyReporter(),split);
    reader.initialize(split,mcontext);
    assertEquals("reader class is CombineFileRecordReader.",CombineFileRecordReader.class,reader.getClass());
    try {
      while (reader.nextKeyValue()) {
        IntWritable key=reader.getCurrentKey();
        BytesWritable value=reader.getCurrentValue();
        assertNotNull("Value should not be null.",value);
        final int k=key.get();
        LOG.debug("read " + k);
        assertFalse("Key in multiple partitions.",bits.get(k));
        bits.set(k);
      }
    }
  finally {
      reader.close();
    }
    assertEquals("Some keys in no partition.",length,bits.cardinality());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.input.TestCombineTextInputFormat </h4><pre class="type-9 type-13 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testFormat() throws Exception {
  Job job=Job.getInstance(new Configuration(defaultConf));
  Random random=new Random();
  long seed=random.nextLong();
  LOG.info("seed = " + seed);
  random.setSeed(seed);
  localFs.delete(workDir,true);
  FileInputFormat.setInputPaths(job,workDir);
  final int length=10000;
  final int numFiles=10;
  createFiles(length,numFiles,random);
  CombineTextInputFormat format=new CombineTextInputFormat();
  for (int i=0; i < 3; i++) {
    int numSplits=random.nextInt(length / 20) + 1;
    LOG.info("splitting: requesting = " + numSplits);
    List<InputSplit> splits=format.getSplits(job);
    LOG.info("splitting: got =        " + splits.size());
    assertEquals("We got more than one splits!",1,splits.size());
    InputSplit split=splits.get(0);
    assertEquals("It should be CombineFileSplit",CombineFileSplit.class,split.getClass());
    BitSet bits=new BitSet(length);
    LOG.debug("split= " + split);
    TaskAttemptContext context=MapReduceTestUtil.createDummyMapTaskAttemptContext(job.getConfiguration());
    RecordReader<LongWritable,Text> reader=format.createRecordReader(split,context);
    assertEquals("reader class is CombineFileRecordReader.",CombineFileRecordReader.class,reader.getClass());
    MapContext<LongWritable,Text,LongWritable,Text> mcontext=new MapContextImpl<LongWritable,Text,LongWritable,Text>(job.getConfiguration(),context.getTaskAttemptID(),reader,null,null,MapReduceTestUtil.createDummyReporter(),split);
    reader.initialize(split,mcontext);
    try {
      int count=0;
      while (reader.nextKeyValue()) {
        LongWritable key=reader.getCurrentKey();
        assertNotNull("Key should not be null.",key);
        Text value=reader.getCurrentValue();
        final int v=Integer.parseInt(value.toString());
        LOG.debug("read " + v);
        assertFalse("Key in multiple partitions.",bits.get(v));
        bits.set(v);
        count++;
      }
      LOG.debug("split=" + split + " count="+ count);
    }
  finally {
      reader.close();
    }
    assertEquals("Some keys in no partition.",length,bits.cardinality());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.input.TestLineRecordReader </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStripBOM() throws IOException {
  String UTF8_BOM="\uFEFF";
  URL testFileUrl=getClass().getClassLoader().getResource("testBOM.txt");
  assertNotNull("Cannot find testBOM.txt",testFileUrl);
  File testFile=new File(testFileUrl.getFile());
  Path testFilePath=new Path(testFile.getAbsolutePath());
  long testFileSize=testFile.length();
  Configuration conf=new Configuration();
  conf.setInt(org.apache.hadoop.mapreduce.lib.input.LineRecordReader.MAX_LINE_LENGTH,Integer.MAX_VALUE);
  TaskAttemptContext context=new TaskAttemptContextImpl(conf,new TaskAttemptID());
  FileSplit split=new FileSplit(testFilePath,0,testFileSize,(String[])null);
  LineRecordReader reader=new LineRecordReader();
  reader.initialize(split,context);
  int numRecords=0;
  boolean firstLine=true;
  boolean skipBOM=true;
  while (reader.nextKeyValue()) {
    if (firstLine) {
      firstLine=false;
      if (reader.getCurrentValue().toString().startsWith(UTF8_BOM)) {
        skipBOM=false;
      }
    }
    ++numRecords;
  }
  reader.close();
  assertTrue("BOM is not skipped",skipBOM);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.lib.jobcontrol.TestMapReduceJobControl </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testControlledJob() throws Exception {
  LOG.info("Starting testControlledJob");
  Configuration conf=createJobConf();
  cleanupData(conf);
  Job job1=MapReduceTestUtil.createCopyJob(conf,outdir_1,indir);
  JobControl theControl=createDependencies(conf,job1);
  while (cjob1.getJobState() != ControlledJob.State.RUNNING) {
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
      break;
    }
  }
  Assert.assertNotNull(cjob1.getMapredJobId());
  waitTillAllFinished(theControl);
  assertEquals("Some jobs failed",0,theControl.getFailedJobList().size());
  theControl.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.security.TestTokenCache </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@SuppressWarnings("deprecation") @Test public void testGetTokensForNamenodes() throws IOException, URISyntaxException {
  Path TEST_ROOT_DIR=new Path(System.getProperty("test.build.data","test/build/data"));
  String binaryTokenFile=FileSystem.getLocal(conf).makeQualified(new Path(TEST_ROOT_DIR,"tokenFile")).toUri().getPath();
  MockFileSystem fs1=createFileSystemForServiceName("service1");
  Credentials creds=new Credentials();
  Token<?> token1=fs1.getDelegationToken(renewer);
  creds.addToken(token1.getService(),token1);
  conf.set(MRJobConfig.MAPREDUCE_JOB_CREDENTIALS_BINARY,binaryTokenFile);
  creds.writeTokenStorageFile(new Path(binaryTokenFile),conf);
  TokenCache.obtainTokensForNamenodesInternal(fs1,creds,conf);
  String fs_addr=fs1.getCanonicalServiceName();
  Token<?> nnt=TokenCache.getDelegationToken(creds,fs_addr);
  assertNotNull("Token for nn is null",nnt);
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testCleanUpTokenReferral() throws Exception {
  Configuration conf=new Configuration();
  conf.set(MRJobConfig.MAPREDUCE_JOB_CREDENTIALS_BINARY,"foo");
  TokenCache.cleanUpTokenReferral(conf);
  assertNull(conf.get(MRJobConfig.MAPREDUCE_JOB_CREDENTIALS_BINARY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.util.TestMRAsyncDiskService </h4><pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test creates some directories and then removes them through 
 * MRAsyncDiskService. 
 */
@Test public void testMRAsyncDiskService() throws Throwable {
  FileSystem localFileSystem=FileSystem.getLocal(new Configuration());
  String[] vols=new String[]{TEST_ROOT_DIR + "/0",TEST_ROOT_DIR + "/1"};
  MRAsyncDiskService service=new MRAsyncDiskService(localFileSystem,vols);
  String a="a";
  String b="b";
  String c="b/c";
  String d="d";
  File fa=new File(vols[0],a);
  File fb=new File(vols[1],b);
  File fc=new File(vols[1],c);
  File fd=new File(vols[1],d);
  fa.mkdirs();
  fb.mkdirs();
  fc.mkdirs();
  fd.mkdirs();
  assertTrue(fa.exists());
  assertTrue(fb.exists());
  assertTrue(fc.exists());
  assertTrue(fd.exists());
  service.moveAndDeleteRelativePath(vols[0],a);
  assertFalse(fa.exists());
  service.moveAndDeleteRelativePath(vols[1],b);
  assertFalse(fb.exists());
  assertFalse(fc.exists());
  assertFalse(service.moveAndDeleteRelativePath(vols[1],"not_exists"));
  IOException ee=null;
  try {
    service.moveAndDeleteAbsolutePath(TEST_ROOT_DIR + "/2");
  }
 catch (  IOException e) {
    ee=e;
  }
  assertNotNull("asyncDiskService should not be able to delete files " + "outside all volumes",ee);
  assertTrue(service.moveAndDeleteAbsolutePath(vols[1] + Path.SEPARATOR_CHAR + d));
  makeSureCleanedUp(vols,service);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.TestRMNMInfo </h4><pre class="type-9 type-13 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRMNMInfo() throws Exception {
  if (!(new File(MiniMRYarnCluster.APPJAR)).exists()) {
    LOG.info("MRAppJar " + MiniMRYarnCluster.APPJAR + " not found. Not running test.");
    return;
  }
  RMContext rmc=mrCluster.getResourceManager().getRMContext();
  ResourceScheduler rms=mrCluster.getResourceManager().getResourceScheduler();
  RMNMInfo rmInfo=new RMNMInfo(rmc,rms);
  String liveNMs=rmInfo.getLiveNodeManagers();
  ObjectMapper mapper=new ObjectMapper();
  JsonNode jn=mapper.readTree(liveNMs);
  Assert.assertEquals("Unexpected number of live nodes:",NUMNODEMANAGERS,jn.size());
  Iterator<JsonNode> it=jn.iterator();
  while (it.hasNext()) {
    JsonNode n=it.next();
    Assert.assertNotNull(n.get("HostName"));
    Assert.assertNotNull(n.get("Rack"));
    Assert.assertTrue("Node " + n.get("NodeId") + " should be RUNNING",n.get("State").asText().contains("RUNNING"));
    Assert.assertNotNull(n.get("NodeHTTPAddress"));
    Assert.assertNotNull(n.get("LastHealthUpdate"));
    Assert.assertNotNull(n.get("HealthReport"));
    Assert.assertNotNull(n.get("NodeManagerVersion"));
    Assert.assertNotNull(n.get("NumContainers"));
    Assert.assertEquals(n.get("NodeId") + ": Unexpected number of used containers",0,n.get("NumContainers").asInt());
    Assert.assertEquals(n.get("NodeId") + ": Unexpected amount of used memory",0,n.get("UsedMemoryMB").asInt());
    Assert.assertNotNull(n.get("AvailableMemoryMB"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRMNMInfoMissmatch() throws Exception {
  RMContext rmc=mock(RMContext.class);
  ResourceScheduler rms=mock(ResourceScheduler.class);
  ConcurrentMap<NodeId,RMNode> map=new ConcurrentHashMap<NodeId,RMNode>();
  RMNode node=MockNodes.newNodeInfo(1,MockNodes.newResource(4 * 1024));
  map.put(node.getNodeID(),node);
  when(rmc.getRMNodes()).thenReturn(map);
  RMNMInfo rmInfo=new RMNMInfo(rmc,rms);
  String liveNMs=rmInfo.getLiveNodeManagers();
  ObjectMapper mapper=new ObjectMapper();
  JsonNode jn=mapper.readTree(liveNMs);
  Assert.assertEquals("Unexpected number of live nodes:",1,jn.size());
  Iterator<JsonNode> it=jn.iterator();
  while (it.hasNext()) {
    JsonNode n=it.next();
    Assert.assertNotNull(n.get("HostName"));
    Assert.assertNotNull(n.get("Rack"));
    Assert.assertTrue("Node " + n.get("NodeId") + " should be RUNNING",n.get("State").asText().contains("RUNNING"));
    Assert.assertNotNull(n.get("NodeHTTPAddress"));
    Assert.assertNotNull(n.get("LastHealthUpdate"));
    Assert.assertNotNull(n.get("HealthReport"));
    Assert.assertNotNull(n.get("NodeManagerVersion"));
    Assert.assertNull(n.get("NumContainers"));
    Assert.assertNull(n.get("UsedMemoryMB"));
    Assert.assertNull(n.get("AvailableMemoryMB"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.TestJobEndNotifier </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotificationOnLastRetryUnregistrationFailure() throws Exception {
  HttpServer2 server=startHttpServer();
  MRApp app=spy(new MRAppWithCustomContainerAllocator(2,2,false,this.getClass().getName(),true,2,false));
  app.isLastAMRetry=true;
  doNothing().when(app).sysexit();
  JobConf conf=new JobConf();
  conf.set(JobContext.MR_JOB_END_NOTIFICATION_URL,JobEndServlet.baseUrl + "jobend?jobid=$jobId&status=$jobStatus");
  JobImpl job=(JobImpl)app.submit(conf);
  app.waitForState(job,JobState.RUNNING);
  app.getContext().getEventHandler().handle(new JobEvent(app.getJobId(),JobEventType.JOB_AM_REBOOT));
  app.waitForInternalState(job,JobStateInternal.REBOOT);
  app.waitForServiceToStop(10000);
  Assert.assertFalse(app.isLastAMRetry());
  Assert.assertEquals(0,JobEndServlet.calledTimes);
  Assert.assertNull(JobEndServlet.requestUri);
  Assert.assertNull(JobEndServlet.foundJobState);
  server.stop();
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbsentNotificationOnNotLastRetryUnregistrationFailure() throws Exception {
  HttpServer2 server=startHttpServer();
  MRApp app=spy(new MRAppWithCustomContainerAllocator(2,2,false,this.getClass().getName(),true,1,false));
  doNothing().when(app).sysexit();
  JobConf conf=new JobConf();
  conf.set(JobContext.MR_JOB_END_NOTIFICATION_URL,JobEndServlet.baseUrl + "jobend?jobid=$jobId&status=$jobStatus");
  JobImpl job=(JobImpl)app.submit(conf);
  app.waitForState(job,JobState.RUNNING);
  app.getContext().getEventHandler().handle(new JobEvent(app.getJobId(),JobEventType.JOB_AM_REBOOT));
  app.waitForInternalState(job,JobStateInternal.REBOOT);
  app.shutDownJob();
  app.waitForState(job,JobState.RUNNING);
  Assert.assertFalse(app.isLastAMRetry());
  Assert.assertEquals(0,JobEndServlet.calledTimes);
  Assert.assertNull(JobEndServlet.requestUri);
  Assert.assertNull(JobEndServlet.foundJobState);
  server.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.TestMRAppMaster </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMRAppMasterCredentials() throws Exception {
  Logger rootLogger=LogManager.getRootLogger();
  rootLogger.setLevel(Level.DEBUG);
  Credentials credentials=new Credentials();
  byte[] identifier="MyIdentifier".getBytes();
  byte[] password="MyPassword".getBytes();
  Text kind=new Text("MyTokenKind");
  Text service=new Text("host:port");
  Token<? extends TokenIdentifier> myToken=new Token<TokenIdentifier>(identifier,password,kind,service);
  Text tokenAlias=new Text("myToken");
  credentials.addToken(tokenAlias,myToken);
  Text appTokenService=new Text("localhost:0");
  Token<AMRMTokenIdentifier> appToken=new Token<AMRMTokenIdentifier>(identifier,password,AMRMTokenIdentifier.KIND_NAME,appTokenService);
  credentials.addToken(appTokenService,appToken);
  Text keyAlias=new Text("mySecretKeyAlias");
  credentials.addSecretKey(keyAlias,"mySecretKey".getBytes());
  Token<? extends TokenIdentifier> storedToken=credentials.getToken(tokenAlias);
  JobConf conf=new JobConf();
  Path tokenFilePath=new Path(testDir.getAbsolutePath(),"tokens-file");
  Map<String,String> newEnv=new HashMap<String,String>();
  newEnv.put(UserGroupInformation.HADOOP_TOKEN_FILE_LOCATION,tokenFilePath.toUri().getPath());
  setNewEnvironmentHack(newEnv);
  credentials.writeTokenStorageFile(tokenFilePath,conf);
  ApplicationId appId=ApplicationId.newInstance(12345,56);
  ApplicationAttemptId applicationAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(applicationAttemptId,546);
  String userName=UserGroupInformation.getCurrentUser().getShortUserName();
  File stagingDir=new File(MRApps.getStagingAreaDir(conf,userName).toString());
  stagingDir.mkdirs();
  UserGroupInformation.setLoginUser(null);
  MRAppMasterTest appMaster=new MRAppMasterTest(applicationAttemptId,containerId,"host",-1,-1,System.currentTimeMillis(),false,true);
  MRAppMaster.initAndStartAppMaster(appMaster,conf,userName);
  Credentials appMasterCreds=appMaster.getCredentials();
  Assert.assertNotNull(appMasterCreds);
  Assert.assertEquals(1,appMasterCreds.numberOfSecretKeys());
  Assert.assertEquals(1,appMasterCreds.numberOfTokens());
  Token<? extends TokenIdentifier> usedToken=appMasterCreds.getToken(tokenAlias);
  Assert.assertNotNull(usedToken);
  Assert.assertEquals(storedToken,usedToken);
  byte[] usedKey=appMasterCreds.getSecretKey(keyAlias);
  Assert.assertNotNull(usedKey);
  Assert.assertEquals("mySecretKey",new String(usedKey));
  Credentials confCredentials=conf.getCredentials();
  Assert.assertEquals(1,confCredentials.numberOfSecretKeys());
  Assert.assertEquals(1,confCredentials.numberOfTokens());
  Assert.assertEquals(storedToken,confCredentials.getToken(tokenAlias));
  Assert.assertEquals("mySecretKey",new String(confCredentials.getSecretKey(keyAlias)));
  Credentials ugiCredentials=appMaster.getUgi().getCredentials();
  Assert.assertEquals(1,ugiCredentials.numberOfSecretKeys());
  Assert.assertEquals(2,ugiCredentials.numberOfTokens());
  Assert.assertEquals(storedToken,ugiCredentials.getToken(tokenAlias));
  Assert.assertEquals(appToken,ugiCredentials.getToken(appTokenService));
  Assert.assertEquals("mySecretKey",new String(ugiCredentials.getSecretKey(keyAlias)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.TestMRClientService </h4><pre class="type-9 type-7 type-1 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  MRAppWithClientService app=new MRAppWithClientService(1,0,false);
  Configuration conf=new Configuration();
  Job job=app.submit(conf);
  app.waitForState(job,JobState.RUNNING);
  Assert.assertEquals("Num tasks not correct",1,job.getTasks().size());
  Iterator<Task> it=job.getTasks().values().iterator();
  Task task=it.next();
  app.waitForState(task,TaskState.RUNNING);
  TaskAttempt attempt=task.getAttempts().values().iterator().next();
  app.waitForState(attempt,TaskAttemptState.RUNNING);
  String diagnostic1="Diagnostic1";
  String diagnostic2="Diagnostic2";
  app.getContext().getEventHandler().handle(new TaskAttemptDiagnosticsUpdateEvent(attempt.getID(),diagnostic1));
  TaskAttemptStatus taskAttemptStatus=new TaskAttemptStatus();
  taskAttemptStatus.id=attempt.getID();
  taskAttemptStatus.progress=0.5f;
  taskAttemptStatus.stateString="RUNNING";
  taskAttemptStatus.taskState=TaskAttemptState.RUNNING;
  taskAttemptStatus.phase=Phase.MAP;
  app.getContext().getEventHandler().handle(new TaskAttemptStatusUpdateEvent(attempt.getID(),taskAttemptStatus));
  YarnRPC rpc=YarnRPC.create(conf);
  MRClientProtocol proxy=(MRClientProtocol)rpc.getProxy(MRClientProtocol.class,app.clientService.getBindAddress(),conf);
  GetCountersRequest gcRequest=recordFactory.newRecordInstance(GetCountersRequest.class);
  gcRequest.setJobId(job.getID());
  Assert.assertNotNull("Counters is null",proxy.getCounters(gcRequest).getCounters());
  GetJobReportRequest gjrRequest=recordFactory.newRecordInstance(GetJobReportRequest.class);
  gjrRequest.setJobId(job.getID());
  JobReport jr=proxy.getJobReport(gjrRequest).getJobReport();
  verifyJobReport(jr);
  GetTaskAttemptCompletionEventsRequest gtaceRequest=recordFactory.newRecordInstance(GetTaskAttemptCompletionEventsRequest.class);
  gtaceRequest.setJobId(job.getID());
  gtaceRequest.setFromEventId(0);
  gtaceRequest.setMaxEvents(10);
  Assert.assertNotNull("TaskCompletionEvents is null",proxy.getTaskAttemptCompletionEvents(gtaceRequest).getCompletionEventList());
  GetDiagnosticsRequest gdRequest=recordFactory.newRecordInstance(GetDiagnosticsRequest.class);
  gdRequest.setTaskAttemptId(attempt.getID());
  Assert.assertNotNull("Diagnostics is null",proxy.getDiagnostics(gdRequest).getDiagnosticsList());
  GetTaskAttemptReportRequest gtarRequest=recordFactory.newRecordInstance(GetTaskAttemptReportRequest.class);
  gtarRequest.setTaskAttemptId(attempt.getID());
  TaskAttemptReport tar=proxy.getTaskAttemptReport(gtarRequest).getTaskAttemptReport();
  verifyTaskAttemptReport(tar);
  GetTaskReportRequest gtrRequest=recordFactory.newRecordInstance(GetTaskReportRequest.class);
  gtrRequest.setTaskId(task.getID());
  Assert.assertNotNull("TaskReport is null",proxy.getTaskReport(gtrRequest).getTaskReport());
  GetTaskReportsRequest gtreportsRequest=recordFactory.newRecordInstance(GetTaskReportsRequest.class);
  gtreportsRequest.setJobId(job.getID());
  gtreportsRequest.setTaskType(TaskType.MAP);
  Assert.assertNotNull("TaskReports for map is null",proxy.getTaskReports(gtreportsRequest).getTaskReportList());
  gtreportsRequest=recordFactory.newRecordInstance(GetTaskReportsRequest.class);
  gtreportsRequest.setJobId(job.getID());
  gtreportsRequest.setTaskType(TaskType.REDUCE);
  Assert.assertNotNull("TaskReports for reduce is null",proxy.getTaskReports(gtreportsRequest).getTaskReportList());
  List<String> diag=proxy.getDiagnostics(gdRequest).getDiagnosticsList();
  Assert.assertEquals("Num diagnostics not correct",1,diag.size());
  Assert.assertEquals("Diag 1 not correct",diagnostic1,diag.get(0).toString());
  TaskReport taskReport=proxy.getTaskReport(gtrRequest).getTaskReport();
  Assert.assertEquals("Num diagnostics not correct",1,taskReport.getDiagnosticsCount());
  app.getContext().getEventHandler().handle(new TaskAttemptEvent(task.getAttempts().values().iterator().next().getID(),TaskAttemptEventType.TA_DONE));
  app.waitForState(job,JobState.SUCCEEDED);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.commit.TestCommitterEventHandler </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasic() throws Exception {
  AppContext mockContext=mock(AppContext.class);
  OutputCommitter mockCommitter=mock(OutputCommitter.class);
  Clock mockClock=mock(Clock.class);
  CommitterEventHandler handler=new CommitterEventHandler(mockContext,mockCommitter,new TestingRMHeartbeatHandler());
  YarnConfiguration conf=new YarnConfiguration();
  conf.set(MRJobConfig.MR_AM_STAGING_DIR,stagingDir);
  JobContext mockJobContext=mock(JobContext.class);
  ApplicationAttemptId attemptid=ConverterUtils.toApplicationAttemptId("appattempt_1234567890000_0001_0");
  JobId jobId=TypeConverter.toYarn(TypeConverter.fromYarn(attemptid.getApplicationId()));
  WaitForItHandler waitForItHandler=new WaitForItHandler();
  when(mockContext.getApplicationID()).thenReturn(attemptid.getApplicationId());
  when(mockContext.getApplicationAttemptId()).thenReturn(attemptid);
  when(mockContext.getEventHandler()).thenReturn(waitForItHandler);
  when(mockContext.getClock()).thenReturn(mockClock);
  handler.init(conf);
  handler.start();
  try {
    handler.handle(new CommitterJobCommitEvent(jobId,mockJobContext));
    String user=UserGroupInformation.getCurrentUser().getShortUserName();
    Path startCommitFile=MRApps.getStartJobCommitFile(conf,user,jobId);
    Path endCommitSuccessFile=MRApps.getEndJobCommitSuccessFile(conf,user,jobId);
    Path endCommitFailureFile=MRApps.getEndJobCommitFailureFile(conf,user,jobId);
    Event e=waitForItHandler.getAndClearEvent();
    assertNotNull(e);
    assertTrue(e instanceof JobCommitCompletedEvent);
    FileSystem fs=FileSystem.get(conf);
    assertTrue(startCommitFile.toString(),fs.exists(startCommitFile));
    assertTrue(endCommitSuccessFile.toString(),fs.exists(endCommitSuccessFile));
    assertFalse(endCommitFailureFile.toString(),fs.exists(endCommitFailureFile));
    verify(mockCommitter).commitJob(any(JobContext.class));
  }
  finally {
    handler.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailure() throws Exception {
  AppContext mockContext=mock(AppContext.class);
  OutputCommitter mockCommitter=mock(OutputCommitter.class);
  Clock mockClock=mock(Clock.class);
  CommitterEventHandler handler=new CommitterEventHandler(mockContext,mockCommitter,new TestingRMHeartbeatHandler());
  YarnConfiguration conf=new YarnConfiguration();
  conf.set(MRJobConfig.MR_AM_STAGING_DIR,stagingDir);
  JobContext mockJobContext=mock(JobContext.class);
  ApplicationAttemptId attemptid=ConverterUtils.toApplicationAttemptId("appattempt_1234567890000_0001_0");
  JobId jobId=TypeConverter.toYarn(TypeConverter.fromYarn(attemptid.getApplicationId()));
  WaitForItHandler waitForItHandler=new WaitForItHandler();
  when(mockContext.getApplicationID()).thenReturn(attemptid.getApplicationId());
  when(mockContext.getApplicationAttemptId()).thenReturn(attemptid);
  when(mockContext.getEventHandler()).thenReturn(waitForItHandler);
  when(mockContext.getClock()).thenReturn(mockClock);
  doThrow(new YarnRuntimeException("Intentional Failure")).when(mockCommitter).commitJob(any(JobContext.class));
  handler.init(conf);
  handler.start();
  try {
    handler.handle(new CommitterJobCommitEvent(jobId,mockJobContext));
    String user=UserGroupInformation.getCurrentUser().getShortUserName();
    Path startCommitFile=MRApps.getStartJobCommitFile(conf,user,jobId);
    Path endCommitSuccessFile=MRApps.getEndJobCommitSuccessFile(conf,user,jobId);
    Path endCommitFailureFile=MRApps.getEndJobCommitFailureFile(conf,user,jobId);
    Event e=waitForItHandler.getAndClearEvent();
    assertNotNull(e);
    assertTrue(e instanceof JobCommitFailedEvent);
    FileSystem fs=FileSystem.get(conf);
    assertTrue(fs.exists(startCommitFile));
    assertFalse(fs.exists(endCommitSuccessFile));
    assertTrue(fs.exists(endCommitFailureFile));
    verify(mockCommitter).commitJob(any(JobContext.class));
  }
  finally {
    handler.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.job.impl.TestJobImpl </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReportDiagnostics() throws Exception {
  JobID jobID=JobID.forName("job_1234567890000_0001");
  JobId jobId=TypeConverter.toYarn(jobID);
  final String diagMsg="some diagnostic message";
  final JobDiagnosticsUpdateEvent diagUpdateEvent=new JobDiagnosticsUpdateEvent(jobId,diagMsg);
  MRAppMetrics mrAppMetrics=MRAppMetrics.create();
  AppContext mockContext=mock(AppContext.class);
  when(mockContext.hasSuccessfullyUnregistered()).thenReturn(true);
  JobImpl job=new JobImpl(jobId,Records.newRecord(ApplicationAttemptId.class),new Configuration(),mock(EventHandler.class),null,mock(JobTokenSecretManager.class),null,new SystemClock(),null,mrAppMetrics,null,true,null,0,null,mockContext,null,null);
  job.handle(diagUpdateEvent);
  String diagnostics=job.getReport().getDiagnostics();
  Assert.assertNotNull(diagnostics);
  Assert.assertTrue(diagnostics.contains(diagMsg));
  job=new JobImpl(jobId,Records.newRecord(ApplicationAttemptId.class),new Configuration(),mock(EventHandler.class),null,mock(JobTokenSecretManager.class),null,new SystemClock(),null,mrAppMetrics,null,true,null,0,null,mockContext,null,null);
  job.handle(new JobEvent(jobId,JobEventType.JOB_KILL));
  job.handle(diagUpdateEvent);
  diagnostics=job.getReport().getDiagnostics();
  Assert.assertNotNull(diagnostics);
  Assert.assertTrue(diagnostics.contains(diagMsg));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.job.impl.TestShuffleProvider </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShuffleProviders() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(1,1);
  JobId jobId=MRBuilderUtils.newJobId(appId,1);
  TaskId taskId=MRBuilderUtils.newTaskId(jobId,1,TaskType.MAP);
  Path jobFile=mock(Path.class);
  EventHandler eventHandler=mock(EventHandler.class);
  TaskAttemptListener taListener=mock(TaskAttemptListener.class);
  when(taListener.getAddress()).thenReturn(new InetSocketAddress("localhost",0));
  JobConf jobConf=new JobConf();
  jobConf.setClass("fs.file.impl",StubbedFS.class,FileSystem.class);
  jobConf.setBoolean("fs.file.impl.disable.cache",true);
  jobConf.set(JobConf.MAPRED_MAP_TASK_ENV,"");
  jobConf.set(YarnConfiguration.NM_AUX_SERVICES,TestShuffleHandler1.MAPREDUCE_TEST_SHUFFLE_SERVICEID + "," + TestShuffleHandler2.MAPREDUCE_TEST_SHUFFLE_SERVICEID);
  String serviceName=TestShuffleHandler1.MAPREDUCE_TEST_SHUFFLE_SERVICEID;
  String serviceStr=String.format(YarnConfiguration.NM_AUX_SERVICE_FMT,serviceName);
  jobConf.set(serviceStr,TestShuffleHandler1.class.getName());
  serviceName=TestShuffleHandler2.MAPREDUCE_TEST_SHUFFLE_SERVICEID;
  serviceStr=String.format(YarnConfiguration.NM_AUX_SERVICE_FMT,serviceName);
  jobConf.set(serviceStr,TestShuffleHandler2.class.getName());
  jobConf.set(MRJobConfig.MAPREDUCE_JOB_SHUFFLE_PROVIDER_SERVICES,TestShuffleHandler1.MAPREDUCE_TEST_SHUFFLE_SERVICEID + "," + TestShuffleHandler2.MAPREDUCE_TEST_SHUFFLE_SERVICEID);
  Credentials credentials=new Credentials();
  Token<JobTokenIdentifier> jobToken=new Token<JobTokenIdentifier>(("tokenid").getBytes(),("tokenpw").getBytes(),new Text("tokenkind"),new Text("tokenservice"));
  TaskAttemptImpl taImpl=new MapTaskAttemptImpl(taskId,1,eventHandler,jobFile,1,mock(TaskSplitMetaInfo.class),jobConf,taListener,jobToken,credentials,new SystemClock(),null);
  jobConf.set(MRJobConfig.APPLICATION_ATTEMPT_ID,taImpl.getID().toString());
  ContainerLaunchContext launchCtx=TaskAttemptImpl.createContainerLaunchContext(null,jobConf,jobToken,taImpl.createRemoteTask(),TypeConverter.fromYarn(jobId),mock(WrappedJvmID.class),taListener,credentials);
  Map<String,ByteBuffer> serviceDataMap=launchCtx.getServiceData();
  Assert.assertNotNull("TestShuffleHandler1 is missing",serviceDataMap.get(TestShuffleHandler1.MAPREDUCE_TEST_SHUFFLE_SERVICEID));
  Assert.assertNotNull("TestShuffleHandler2 is missing",serviceDataMap.get(TestShuffleHandler2.MAPREDUCE_TEST_SHUFFLE_SERVICEID));
  Assert.assertTrue("mismatch number of services in map",serviceDataMap.size() == 3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.job.impl.TestTaskAttemptContainerRequest </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAttemptContainerRequest() throws Exception {
  final Text SECRET_KEY_ALIAS=new Text("secretkeyalias");
  final byte[] SECRET_KEY=("secretkey").getBytes();
  Map<ApplicationAccessType,String> acls=new HashMap<ApplicationAccessType,String>(1);
  acls.put(ApplicationAccessType.VIEW_APP,"otheruser");
  ApplicationId appId=ApplicationId.newInstance(1,1);
  JobId jobId=MRBuilderUtils.newJobId(appId,1);
  TaskId taskId=MRBuilderUtils.newTaskId(jobId,1,TaskType.MAP);
  Path jobFile=mock(Path.class);
  EventHandler eventHandler=mock(EventHandler.class);
  TaskAttemptListener taListener=mock(TaskAttemptListener.class);
  when(taListener.getAddress()).thenReturn(new InetSocketAddress("localhost",0));
  JobConf jobConf=new JobConf();
  jobConf.setClass("fs.file.impl",StubbedFS.class,FileSystem.class);
  jobConf.setBoolean("fs.file.impl.disable.cache",true);
  jobConf.set(JobConf.MAPRED_MAP_TASK_ENV,"");
  jobConf.set(CommonConfigurationKeysPublic.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  UserGroupInformation.setConfiguration(jobConf);
  Credentials credentials=new Credentials();
  credentials.addSecretKey(SECRET_KEY_ALIAS,SECRET_KEY);
  Token<JobTokenIdentifier> jobToken=new Token<JobTokenIdentifier>(("tokenid").getBytes(),("tokenpw").getBytes(),new Text("tokenkind"),new Text("tokenservice"));
  TaskAttemptImpl taImpl=new MapTaskAttemptImpl(taskId,1,eventHandler,jobFile,1,mock(TaskSplitMetaInfo.class),jobConf,taListener,jobToken,credentials,new SystemClock(),null);
  jobConf.set(MRJobConfig.APPLICATION_ATTEMPT_ID,taImpl.getID().toString());
  ContainerLaunchContext launchCtx=TaskAttemptImpl.createContainerLaunchContext(acls,jobConf,jobToken,taImpl.createRemoteTask(),TypeConverter.fromYarn(jobId),mock(WrappedJvmID.class),taListener,credentials);
  Assert.assertEquals("ACLs mismatch",acls,launchCtx.getApplicationACLs());
  Credentials launchCredentials=new Credentials();
  DataInputByteBuffer dibb=new DataInputByteBuffer();
  dibb.reset(launchCtx.getTokens());
  launchCredentials.readTokenStorageStream(dibb);
  for (  Token<? extends TokenIdentifier> token : credentials.getAllTokens()) {
    Token<? extends TokenIdentifier> launchToken=launchCredentials.getToken(token.getService());
    Assert.assertNotNull("Token " + token.getService() + " is missing",launchToken);
    Assert.assertEquals("Token " + token.getService() + " mismatch",token,launchToken);
  }
  Assert.assertNotNull("Secret key missing",launchCredentials.getSecretKey(SECRET_KEY_ALIAS));
  Assert.assertTrue("Secret key mismatch",Arrays.equals(SECRET_KEY,launchCredentials.getSecretKey(SECRET_KEY_ALIAS)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.launcher.TestContainerLauncher </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testPoolLimits() throws InterruptedException {
  ApplicationId appId=ApplicationId.newInstance(12345,67);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,3);
  JobId jobId=MRBuilderUtils.newJobId(appId,8);
  TaskId taskId=MRBuilderUtils.newTaskId(jobId,9,TaskType.MAP);
  TaskAttemptId taskAttemptId=MRBuilderUtils.newTaskAttemptId(taskId,0);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,10);
  AppContext context=mock(AppContext.class);
  CustomContainerLauncher containerLauncher=new CustomContainerLauncher(context);
  Configuration conf=new Configuration();
  conf.setInt(MRJobConfig.MR_AM_CONTAINERLAUNCHER_THREAD_COUNT_LIMIT,12);
  containerLauncher.init(conf);
  containerLauncher.start();
  ThreadPoolExecutor threadPool=containerLauncher.getThreadPool();
  containerLauncher.expectedCorePoolSize=ContainerLauncherImpl.INITIAL_POOL_SIZE;
  for (int i=0; i < 10; i++) {
    containerLauncher.handle(new ContainerLauncherEvent(taskAttemptId,containerId,"host" + i + ":1234",null,ContainerLauncher.EventType.CONTAINER_REMOTE_LAUNCH));
  }
  waitForEvents(containerLauncher,10);
  Assert.assertEquals(10,threadPool.getPoolSize());
  Assert.assertNull(containerLauncher.foundErrors);
  containerLauncher.expectedCorePoolSize=12;
  for (int i=1; i <= 4; i++) {
    containerLauncher.handle(new ContainerLauncherEvent(taskAttemptId,containerId,"host1" + i + ":1234",null,ContainerLauncher.EventType.CONTAINER_REMOTE_LAUNCH));
  }
  waitForEvents(containerLauncher,12);
  Assert.assertEquals(12,threadPool.getPoolSize());
  Assert.assertNull(containerLauncher.foundErrors);
  containerLauncher.finishEventHandling=true;
  waitForEvents(containerLauncher,14);
  Assert.assertEquals(12,threadPool.getPoolSize());
  Assert.assertNull(containerLauncher.foundErrors);
  containerLauncher.stop();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testPoolSize() throws InterruptedException {
  ApplicationId appId=ApplicationId.newInstance(12345,67);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,3);
  JobId jobId=MRBuilderUtils.newJobId(appId,8);
  TaskId taskId=MRBuilderUtils.newTaskId(jobId,9,TaskType.MAP);
  AppContext context=mock(AppContext.class);
  CustomContainerLauncher containerLauncher=new CustomContainerLauncher(context);
  containerLauncher.init(new Configuration());
  containerLauncher.start();
  ThreadPoolExecutor threadPool=containerLauncher.getThreadPool();
  Assert.assertEquals(0,threadPool.getPoolSize());
  Assert.assertEquals(ContainerLauncherImpl.INITIAL_POOL_SIZE,threadPool.getCorePoolSize());
  Assert.assertNull(containerLauncher.foundErrors);
  containerLauncher.expectedCorePoolSize=ContainerLauncherImpl.INITIAL_POOL_SIZE;
  for (int i=0; i < 10; i++) {
    ContainerId containerId=ContainerId.newInstance(appAttemptId,i);
    TaskAttemptId taskAttemptId=MRBuilderUtils.newTaskAttemptId(taskId,i);
    containerLauncher.handle(new ContainerLauncherEvent(taskAttemptId,containerId,"host" + i + ":1234",null,ContainerLauncher.EventType.CONTAINER_REMOTE_LAUNCH));
  }
  waitForEvents(containerLauncher,10);
  Assert.assertEquals(10,threadPool.getPoolSize());
  Assert.assertNull(containerLauncher.foundErrors);
  containerLauncher.finishEventHandling=true;
  int timeOut=0;
  while (containerLauncher.numEventsProcessed.get() < 10 && timeOut++ < 200) {
    LOG.info("Waiting for number of events processed to become " + 10 + ". It is now "+ containerLauncher.numEventsProcessed.get()+ ". Timeout is "+ timeOut);
    Thread.sleep(1000);
  }
  Assert.assertEquals(10,containerLauncher.numEventsProcessed.get());
  containerLauncher.finishEventHandling=false;
  for (int i=0; i < 10; i++) {
    ContainerId containerId=ContainerId.newInstance(appAttemptId,i + 10);
    TaskAttemptId taskAttemptId=MRBuilderUtils.newTaskAttemptId(taskId,i + 10);
    containerLauncher.handle(new ContainerLauncherEvent(taskAttemptId,containerId,"host" + i + ":1234",null,ContainerLauncher.EventType.CONTAINER_REMOTE_LAUNCH));
  }
  waitForEvents(containerLauncher,20);
  Assert.assertEquals(10,threadPool.getPoolSize());
  Assert.assertNull(containerLauncher.foundErrors);
  containerLauncher.expectedCorePoolSize=11 + ContainerLauncherImpl.INITIAL_POOL_SIZE;
  containerLauncher.finishEventHandling=false;
  ContainerId containerId=ContainerId.newInstance(appAttemptId,21);
  TaskAttemptId taskAttemptId=MRBuilderUtils.newTaskAttemptId(taskId,21);
  containerLauncher.handle(new ContainerLauncherEvent(taskAttemptId,containerId,"host11:1234",null,ContainerLauncher.EventType.CONTAINER_REMOTE_LAUNCH));
  waitForEvents(containerLauncher,21);
  Assert.assertEquals(11,threadPool.getPoolSize());
  Assert.assertNull(containerLauncher.foundErrors);
  containerLauncher.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.app.webapp.TestAppController </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test method 'singleTaskCounter'. Should set SingleCounterPage class for rendering
 */
@Test public void testGetSingleTaskCounter() throws IOException {
  appController.singleTaskCounter();
  assertEquals(SingleCounterPage.class,appController.getClazz());
  assertNotNull(appController.getProperty().get(AppController.COUNTER_GROUP));
  assertNotNull(appController.getProperty().get(AppController.COUNTER_NAME));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.hs.TestJobHistoryEntities </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test of some methods of CompletedJob
 * @throws Exception
 */
@Test(timeout=30000) public void testGetTaskAttemptCompletionEvent() throws Exception {
  HistoryFileInfo info=mock(HistoryFileInfo.class);
  when(info.getConfFile()).thenReturn(fullConfPath);
  completedJob=new CompletedJob(conf,jobId,fulleHistoryPath,loadTasks,"user",info,jobAclsManager);
  TaskCompletionEvent[] events=completedJob.getMapAttemptCompletionEvents(0,1000);
  assertEquals(10,completedJob.getMapAttemptCompletionEvents(0,10).length);
  int currentEventId=0;
  for (  TaskCompletionEvent taskAttemptCompletionEvent : events) {
    int eventId=taskAttemptCompletionEvent.getEventId();
    assertTrue(eventId >= currentEventId);
    currentEventId=eventId;
  }
  assertNull(completedJob.loadConfFile());
  assertEquals("Sleep job",completedJob.getName());
  assertEquals("default",completedJob.getQueueName());
  assertEquals(1.0,completedJob.getProgress(),0.001);
  assertEquals(12,completedJob.getTaskAttemptCompletionEvents(0,1000).length);
  assertEquals(10,completedJob.getTaskAttemptCompletionEvents(0,10).length);
  assertEquals(7,completedJob.getTaskAttemptCompletionEvents(5,10).length);
  assertEquals(1,completedJob.getDiagnostics().size());
  assertEquals("",completedJob.getDiagnostics().get(0));
  assertEquals(0,completedJob.getJobACLs().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.hs.TestJobHistoryParsing </h4><pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testDiagnosticsForKilledJob() throws Exception {
  LOG.info("STARTING testDiagnosticsForKilledJob");
  try {
    final Configuration conf=new Configuration();
    conf.setClass(NET_TOPOLOGY_NODE_SWITCH_MAPPING_IMPL_KEY,MyResolver.class,DNSToSwitchMapping.class);
    RackResolver.init(conf);
    MRApp app=new MRAppWithHistoryWithJobKilled(2,1,true,this.getClass().getName(),true);
    app.submit(conf);
    Job job=app.getContext().getAllJobs().values().iterator().next();
    JobId jobId=job.getID();
    app.waitForState(job,JobState.KILLED);
    app.waitForState(Service.STATE.STOPPED);
    JobHistory jobHistory=new JobHistory();
    jobHistory.init(conf);
    HistoryFileInfo fileInfo=jobHistory.getJobFileInfo(jobId);
    JobHistoryParser parser;
    JobInfo jobInfo;
synchronized (fileInfo) {
      Path historyFilePath=fileInfo.getHistoryFile();
      FSDataInputStream in=null;
      FileContext fc=null;
      try {
        fc=FileContext.getFileContext(conf);
        in=fc.open(fc.makeQualified(historyFilePath));
      }
 catch (      IOException ioe) {
        LOG.info("Can not open history file: " + historyFilePath,ioe);
        throw (new Exception("Can not open History File"));
      }
      parser=new JobHistoryParser(in);
      jobInfo=parser.parse();
    }
    Exception parseException=parser.getParseException();
    assertNull("Caught an expected exception " + parseException,parseException);
    final List<String> originalDiagnostics=job.getDiagnostics();
    final String historyError=jobInfo.getErrorInfo();
    assertTrue("No original diagnostics for a failed job",originalDiagnostics != null && !originalDiagnostics.isEmpty());
    assertNotNull("No history error info for a failed job ",historyError);
    for (    String diagString : originalDiagnostics) {
      assertTrue(historyError.contains(diagString));
    }
    assertTrue("No killed message in diagnostics",historyError.contains(JobImpl.JOB_KILLED_DIAG));
  }
  finally {
    LOG.info("FINISHED testDiagnosticsForKilledJob");
  }
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test PartialJob
 */
@Test(timeout=1000) public void testPartialJob() throws Exception {
  JobId jobId=new JobIdPBImpl();
  jobId.setId(0);
  JobIndexInfo jii=new JobIndexInfo(0L,System.currentTimeMillis(),"user","jobName",jobId,3,2,"JobStatus");
  PartialJob test=new PartialJob(jii,jobId);
  Assert.assertEquals(1.0f,test.getProgress(),0.001f);
  assertNull(test.getAllCounters());
  assertNull(test.getTasks());
  assertNull(test.getTasks(TaskType.MAP));
  assertNull(test.getTask(new TaskIdPBImpl()));
  assertNull(test.getTaskAttemptCompletionEvents(0,100));
  assertNull(test.getMapAttemptCompletionEvents(0,100));
  assertTrue(test.checkAccess(UserGroupInformation.getCurrentUser(),null));
  assertNull(test.getAMInfos());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testCountersForFailedTask() throws Exception {
  LOG.info("STARTING testCountersForFailedTask");
  try {
    Configuration conf=new Configuration();
    conf.setClass(NET_TOPOLOGY_NODE_SWITCH_MAPPING_IMPL_KEY,MyResolver.class,DNSToSwitchMapping.class);
    RackResolver.init(conf);
    MRApp app=new MRAppWithHistoryWithFailedTask(2,1,true,this.getClass().getName(),true);
    app.submit(conf);
    Job job=app.getContext().getAllJobs().values().iterator().next();
    JobId jobId=job.getID();
    app.waitForState(job,JobState.FAILED);
    app.waitForState(Service.STATE.STOPPED);
    JobHistory jobHistory=new JobHistory();
    jobHistory.init(conf);
    HistoryFileInfo fileInfo=jobHistory.getJobFileInfo(jobId);
    JobHistoryParser parser;
    JobInfo jobInfo;
synchronized (fileInfo) {
      Path historyFilePath=fileInfo.getHistoryFile();
      FSDataInputStream in=null;
      FileContext fc=null;
      try {
        fc=FileContext.getFileContext(conf);
        in=fc.open(fc.makeQualified(historyFilePath));
      }
 catch (      IOException ioe) {
        LOG.info("Can not open history file: " + historyFilePath,ioe);
        throw (new Exception("Can not open History File"));
      }
      parser=new JobHistoryParser(in);
      jobInfo=parser.parse();
    }
    Exception parseException=parser.getParseException();
    Assert.assertNull("Caught an expected exception " + parseException,parseException);
    for (    Map.Entry<TaskID,TaskInfo> entry : jobInfo.getAllTasks().entrySet()) {
      TaskId yarnTaskID=TypeConverter.toYarn(entry.getKey());
      CompletedTask ct=new CompletedTask(yarnTaskID,entry.getValue());
      Assert.assertNotNull("completed task report has null counters",ct.getReport().getCounters());
    }
    final List<String> originalDiagnostics=job.getDiagnostics();
    final String historyError=jobInfo.getErrorInfo();
    assertTrue("No original diagnostics for a failed job",originalDiagnostics != null && !originalDiagnostics.isEmpty());
    assertNotNull("No history error info for a failed job ",historyError);
    for (    String diagString : originalDiagnostics) {
      assertTrue(historyError.contains(diagString));
    }
  }
  finally {
    LOG.info("FINISHED testCountersForFailedTask");
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=50000) public void testScanningOldDirs() throws Exception {
  LOG.info("STARTING testScanningOldDirs");
  try {
    Configuration conf=new Configuration();
    conf.setClass(NET_TOPOLOGY_NODE_SWITCH_MAPPING_IMPL_KEY,MyResolver.class,DNSToSwitchMapping.class);
    RackResolver.init(conf);
    MRApp app=new MRAppWithHistory(1,1,true,this.getClass().getName(),true);
    app.submit(conf);
    Job job=app.getContext().getAllJobs().values().iterator().next();
    JobId jobId=job.getID();
    LOG.info("JOBID is " + TypeConverter.fromYarn(jobId).toString());
    app.waitForState(job,JobState.SUCCEEDED);
    app.waitForState(Service.STATE.STOPPED);
    HistoryFileManagerForTest hfm=new HistoryFileManagerForTest();
    hfm.init(conf);
    HistoryFileInfo fileInfo=hfm.getFileInfo(jobId);
    Assert.assertNotNull("Unable to locate job history",fileInfo);
    hfm.deleteJobFromJobListCache(fileInfo);
    final int msecPerSleep=10;
    int msecToSleep=10 * 1000;
    while (fileInfo.isMovePending() && msecToSleep > 0) {
      Assert.assertTrue(!fileInfo.didMoveFail());
      msecToSleep-=msecPerSleep;
      Thread.sleep(msecPerSleep);
    }
    Assert.assertTrue("Timeout waiting for history move",msecToSleep > 0);
    fileInfo=hfm.getFileInfo(jobId);
    hfm.stop();
    Assert.assertNotNull("Unable to locate old job history",fileInfo);
    Assert.assertTrue("HistoryFileManager not shutdown properly",hfm.moveToDoneExecutor.isTerminated());
  }
  finally {
    LOG.info("FINISHED testScanningOldDirs");
  }
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test clean old history files. Files should be deleted after 1 week by
 * default.
 */
@Test(timeout=15000) public void testDeleteFileInfo() throws Exception {
  LOG.info("STARTING testDeleteFileInfo");
  try {
    Configuration conf=new Configuration();
    conf.setClass(NET_TOPOLOGY_NODE_SWITCH_MAPPING_IMPL_KEY,MyResolver.class,DNSToSwitchMapping.class);
    RackResolver.init(conf);
    MRApp app=new MRAppWithHistory(1,1,true,this.getClass().getName(),true);
    app.submit(conf);
    Job job=app.getContext().getAllJobs().values().iterator().next();
    JobId jobId=job.getID();
    app.waitForState(job,JobState.SUCCEEDED);
    app.waitForState(Service.STATE.STOPPED);
    HistoryFileManager hfm=new HistoryFileManager();
    hfm.init(conf);
    HistoryFileInfo fileInfo=hfm.getFileInfo(jobId);
    hfm.initExisting();
    while (fileInfo.isMovePending()) {
      Thread.sleep(300);
    }
    Assert.assertNotNull(hfm.jobListCache.values());
    hfm.clean();
    Assert.assertFalse(fileInfo.isDeleted());
    hfm.setMaxHistoryAge(-1);
    hfm.clean();
    hfm.stop();
    Assert.assertTrue("Thread pool shutdown",hfm.moveToDoneExecutor.isTerminated());
    Assert.assertTrue("file should be deleted ",fileInfo.isDeleted());
  }
  finally {
    LOG.info("FINISHED testDeleteFileInfo");
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test some methods of JobHistory
 */
@Test(timeout=20000) public void testJobHistoryMethods() throws Exception {
  LOG.info("STARTING testJobHistoryMethods");
  try {
    Configuration configuration=new Configuration();
    configuration.setClass(NET_TOPOLOGY_NODE_SWITCH_MAPPING_IMPL_KEY,MyResolver.class,DNSToSwitchMapping.class);
    RackResolver.init(configuration);
    MRApp app=new MRAppWithHistory(1,1,true,this.getClass().getName(),true);
    app.submit(configuration);
    Job job=app.getContext().getAllJobs().values().iterator().next();
    JobId jobId=job.getID();
    LOG.info("JOBID is " + TypeConverter.fromYarn(jobId).toString());
    app.waitForState(job,JobState.SUCCEEDED);
    JobHistory jobHistory=new JobHistory();
    jobHistory.init(configuration);
    Assert.assertEquals(1,jobHistory.getAllJobs().size());
    Assert.assertEquals(1,jobHistory.getAllJobs(app.getAppID()).size());
    JobsInfo jobsinfo=jobHistory.getPartialJobs(0L,10L,null,"default",0L,System.currentTimeMillis() + 1,0L,System.currentTimeMillis() + 1,JobState.SUCCEEDED);
    Assert.assertEquals(1,jobsinfo.getJobs().size());
    Assert.assertNotNull(jobHistory.getApplicationAttemptId());
    Assert.assertEquals("application_0_0000",jobHistory.getApplicationID().toString());
    Assert.assertEquals("Job History Server",jobHistory.getApplicationName());
    Assert.assertNull(jobHistory.getEventHandler());
    Assert.assertNull(jobHistory.getClock());
    Assert.assertNull(jobHistory.getClusterInfo());
  }
  finally {
    LOG.info("FINISHED testJobHistoryMethods");
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testHistoryParsingForFailedAttempts() throws Exception {
  LOG.info("STARTING testHistoryParsingForFailedAttempts");
  try {
    Configuration conf=new Configuration();
    conf.setClass(NET_TOPOLOGY_NODE_SWITCH_MAPPING_IMPL_KEY,MyResolver.class,DNSToSwitchMapping.class);
    RackResolver.init(conf);
    MRApp app=new MRAppWithHistoryWithFailedAttempt(2,1,true,this.getClass().getName(),true);
    app.submit(conf);
    Job job=app.getContext().getAllJobs().values().iterator().next();
    JobId jobId=job.getID();
    app.waitForState(job,JobState.SUCCEEDED);
    app.waitForState(Service.STATE.STOPPED);
    JobHistory jobHistory=new JobHistory();
    jobHistory.init(conf);
    HistoryFileInfo fileInfo=jobHistory.getJobFileInfo(jobId);
    JobHistoryParser parser;
    JobInfo jobInfo;
synchronized (fileInfo) {
      Path historyFilePath=fileInfo.getHistoryFile();
      FSDataInputStream in=null;
      FileContext fc=null;
      try {
        fc=FileContext.getFileContext(conf);
        in=fc.open(fc.makeQualified(historyFilePath));
      }
 catch (      IOException ioe) {
        LOG.info("Can not open history file: " + historyFilePath,ioe);
        throw (new Exception("Can not open History File"));
      }
      parser=new JobHistoryParser(in);
      jobInfo=parser.parse();
    }
    Exception parseException=parser.getParseException();
    Assert.assertNull("Caught an expected exception " + parseException,parseException);
    int noOffailedAttempts=0;
    Map<TaskID,TaskInfo> allTasks=jobInfo.getAllTasks();
    for (    Task task : job.getTasks().values()) {
      TaskInfo taskInfo=allTasks.get(TypeConverter.fromYarn(task.getID()));
      for (      TaskAttempt taskAttempt : task.getAttempts().values()) {
        TaskAttemptInfo taskAttemptInfo=taskInfo.getAllTaskAttempts().get(TypeConverter.fromYarn((taskAttempt.getID())));
        Assert.assertEquals("rack-name is incorrect",taskAttemptInfo.getRackname(),RACK_NAME);
        if (taskAttemptInfo.getTaskStatus().equals("FAILED")) {
          noOffailedAttempts++;
        }
      }
    }
    Assert.assertEquals("No of Failed tasks doesn't match.",2,noOffailedAttempts);
  }
  finally {
    LOG.info("FINISHED testHistoryParsingForFailedAttempts");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.hs.TestJobHistoryServer </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=50000) public void testReports() throws Exception {
  Configuration config=new Configuration();
  config.setClass(CommonConfigurationKeysPublic.NET_TOPOLOGY_NODE_SWITCH_MAPPING_IMPL_KEY,MyResolver.class,DNSToSwitchMapping.class);
  RackResolver.init(config);
  MRApp app=new MRAppWithHistory(1,1,true,this.getClass().getName(),true);
  app.submit(config);
  Job job=app.getContext().getAllJobs().values().iterator().next();
  app.waitForState(job,JobState.SUCCEEDED);
  historyServer=new JobHistoryServer();
  historyServer.init(config);
  historyServer.start();
  JobHistory jobHistory=null;
  for (  Service service : historyServer.getServices()) {
    if (service instanceof JobHistory) {
      jobHistory=(JobHistory)service;
    }
  }
  ;
  Map<JobId,Job> jobs=jobHistory.getAllJobs();
  assertEquals(1,jobs.size());
  assertEquals("job_0_0000",jobs.keySet().iterator().next().toString());
  Task task=job.getTasks().values().iterator().next();
  TaskAttempt attempt=task.getAttempts().values().iterator().next();
  HistoryClientService historyService=historyServer.getClientService();
  MRClientProtocol protocol=historyService.getClientHandler();
  GetTaskAttemptReportRequest gtarRequest=recordFactory.newRecordInstance(GetTaskAttemptReportRequest.class);
  TaskAttemptId taId=attempt.getID();
  taId.setTaskId(task.getID());
  taId.getTaskId().setJobId(job.getID());
  gtarRequest.setTaskAttemptId(taId);
  GetTaskAttemptReportResponse response=protocol.getTaskAttemptReport(gtarRequest);
  assertEquals("container_0_0000_01_000000",response.getTaskAttemptReport().getContainerId().toString());
  assertTrue(response.getTaskAttemptReport().getDiagnosticInfo().isEmpty());
  assertNotNull(response.getTaskAttemptReport().getCounters().getCounter(TaskCounter.PHYSICAL_MEMORY_BYTES));
  assertEquals(taId.toString(),response.getTaskAttemptReport().getTaskAttemptId().toString());
  GetTaskReportRequest request=recordFactory.newRecordInstance(GetTaskReportRequest.class);
  TaskId taskId=task.getID();
  taskId.setJobId(job.getID());
  request.setTaskId(taskId);
  GetTaskReportResponse reportResponse=protocol.getTaskReport(request);
  assertEquals("",reportResponse.getTaskReport().getDiagnosticsList().iterator().next());
  assertEquals(1.0f,reportResponse.getTaskReport().getProgress(),0.01);
  assertEquals(taskId.toString(),reportResponse.getTaskReport().getTaskId().toString());
  assertEquals(TaskState.SUCCEEDED,reportResponse.getTaskReport().getTaskState());
  GetTaskAttemptCompletionEventsRequest taskAttemptRequest=recordFactory.newRecordInstance(GetTaskAttemptCompletionEventsRequest.class);
  taskAttemptRequest.setJobId(job.getID());
  GetTaskAttemptCompletionEventsResponse taskAttemptCompletionEventsResponse=protocol.getTaskAttemptCompletionEvents(taskAttemptRequest);
  assertEquals(0,taskAttemptCompletionEventsResponse.getCompletionEventCount());
  GetDiagnosticsRequest diagnosticRequest=recordFactory.newRecordInstance(GetDiagnosticsRequest.class);
  diagnosticRequest.setTaskAttemptId(taId);
  GetDiagnosticsResponse diagnosticResponse=protocol.getDiagnostics(diagnosticRequest);
  assertEquals(1,diagnosticResponse.getDiagnosticsCount());
  assertEquals("",diagnosticResponse.getDiagnostics(0));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=50000) public void testStartStopServer() throws Exception {
  historyServer=new JobHistoryServer();
  Configuration config=new Configuration();
  historyServer.init(config);
  assertEquals(STATE.INITED,historyServer.getServiceState());
  assertEquals(6,historyServer.getServices().size());
  HistoryClientService historyService=historyServer.getClientService();
  assertNotNull(historyServer.getClientService());
  assertEquals(STATE.INITED,historyService.getServiceState());
  historyServer.start();
  assertEquals(STATE.STARTED,historyServer.getServiceState());
  assertEquals(STATE.STARTED,historyService.getServiceState());
  historyServer.stop();
  assertEquals(STATE.STOPPED,historyServer.getServiceState());
  assertNotNull(historyService.getClientHandler().getConnectAddress());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.hs.server.TestHSAdminServer </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefreshSuperUserGroups() throws Exception {
  UserGroupInformation ugi=mock(UserGroupInformation.class);
  UserGroupInformation superUser=mock(UserGroupInformation.class);
  when(ugi.getRealUser()).thenReturn(superUser);
  when(superUser.getShortUserName()).thenReturn("superuser");
  when(superUser.getUserName()).thenReturn("superuser");
  when(ugi.getGroupNames()).thenReturn(new String[]{"group3"});
  when(ugi.getUserName()).thenReturn("regularUser");
  conf.set("hadoop.proxyuser.superuser.groups","group1,group2");
  conf.set("hadoop.proxyuser.superuser.hosts","127.0.0.1");
  String[] args=new String[1];
  args[0]="-refreshSuperUserGroupsConfiguration";
  hsAdminClient.run(args);
  Throwable th=null;
  try {
    ProxyUsers.authorize(ugi,"127.0.0.1");
  }
 catch (  Exception e) {
    th=e;
  }
  assertTrue(th instanceof AuthorizationException);
  conf.set("hadoop.proxyuser.superuser.groups","group1,group2,group3");
  th=null;
  try {
    ProxyUsers.authorize(ugi,"127.0.0.1");
  }
 catch (  Exception e) {
    th=e;
  }
  assertTrue(th instanceof AuthorizationException);
  hsAdminClient.run(args);
  th=null;
  try {
    ProxyUsers.authorize(ugi,"127.0.0.1");
  }
 catch (  Exception e) {
    th=e;
  }
  assertNull("Unexpected exception thrown: " + th,th);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.jobhistory.TestFileNameIndexUtils </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobHistoryFileNameBackwardsCompatible() throws IOException {
  JobID oldJobId=JobID.forName(JOB_ID);
  JobId jobId=TypeConverter.toYarn(oldJobId);
  long submitTime=Long.parseLong(SUBMIT_TIME);
  long finishTime=Long.parseLong(FINISH_TIME);
  int numMaps=Integer.parseInt(NUM_MAPS);
  int numReduces=Integer.parseInt(NUM_REDUCES);
  String jobHistoryFile=String.format(OLD_JOB_HISTORY_FILE_FORMATTER,JOB_ID,SUBMIT_TIME,USER_NAME,JOB_NAME,FINISH_TIME,NUM_MAPS,NUM_REDUCES,JOB_STATUS);
  JobIndexInfo info=FileNameIndexUtils.getIndexInfo(jobHistoryFile);
  Assert.assertEquals("Job id incorrect after decoding old history file",jobId,info.getJobId());
  Assert.assertEquals("Submit time incorrect after decoding old history file",submitTime,info.getSubmitTime());
  Assert.assertEquals("User incorrect after decoding old history file",USER_NAME,info.getUser());
  Assert.assertEquals("Job name incorrect after decoding old history file",JOB_NAME,info.getJobName());
  Assert.assertEquals("Finish time incorrect after decoding old history file",finishTime,info.getFinishTime());
  Assert.assertEquals("Num maps incorrect after decoding old history file",numMaps,info.getNumMaps());
  Assert.assertEquals("Num reduces incorrect after decoding old history file",numReduces,info.getNumReduces());
  Assert.assertEquals("Job status incorrect after decoding old history file",JOB_STATUS,info.getJobStatus());
  Assert.assertNull("Queue name incorrect after decoding old history file",info.getQueueName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mapreduce.v2.util.TestMRApps </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=120000) public void testGetJobFileWithUser(){
  Configuration conf=new Configuration();
  conf.set(MRJobConfig.MR_AM_STAGING_DIR,"/my/path/to/staging");
  String jobFile=MRApps.getJobFile(conf,"dummy-user",new JobID("dummy-job",12345));
  assertNotNull("getJobFile results in null.",jobFile);
  assertEquals("jobFile with specified user is not as expected.","/my/path/to/staging/dummy-user/.staging/job_dummy-job_12345/job.xml",jobFile);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLogSystemProperties() throws Exception {
  Configuration conf=new Configuration();
  conf.set(MRJobConfig.MAPREDUCE_JVM_SYSTEM_PROPERTIES_TO_LOG," ");
  String value=MRApps.getSystemPropertiesToLog(conf);
  assertNull(value);
  String classpath="java.class.path";
  String os="os.name";
  String version="java.version";
  conf.set(MRJobConfig.MAPREDUCE_JVM_SYSTEM_PROPERTIES_TO_LOG,classpath + ", " + os);
  value=MRApps.getSystemPropertiesToLog(conf);
  assertNotNull(value);
  assertTrue(value.contains(classpath));
  assertTrue(value.contains(os));
  assertFalse(value.contains(version));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test(timeout=30000) public void testSetupDistributedCache() throws Exception {
  Configuration conf=new Configuration();
  conf.setClass("fs.mockfs.impl",MockFileSystem.class,FileSystem.class);
  URI mockUri=URI.create("mockfs://mock/");
  FileSystem mockFs=((FilterFileSystem)FileSystem.get(mockUri,conf)).getRawFileSystem();
  URI archive=new URI("mockfs://mock/tmp/something.zip");
  Path archivePath=new Path(archive);
  URI file=new URI("mockfs://mock/tmp/something.txt#something");
  Path filePath=new Path(file);
  when(mockFs.resolvePath(archivePath)).thenReturn(archivePath);
  when(mockFs.resolvePath(filePath)).thenReturn(filePath);
  DistributedCache.addCacheArchive(archive,conf);
  conf.set(MRJobConfig.CACHE_ARCHIVES_TIMESTAMPS,"10");
  conf.set(MRJobConfig.CACHE_ARCHIVES_SIZES,"10");
  conf.set(MRJobConfig.CACHE_ARCHIVES_VISIBILITIES,"true");
  DistributedCache.addCacheFile(file,conf);
  conf.set(MRJobConfig.CACHE_FILE_TIMESTAMPS,"11");
  conf.set(MRJobConfig.CACHE_FILES_SIZES,"11");
  conf.set(MRJobConfig.CACHE_FILE_VISIBILITIES,"true");
  Map<String,LocalResource> localResources=new HashMap<String,LocalResource>();
  MRApps.setupDistributedCache(conf,localResources);
  assertEquals(2,localResources.size());
  LocalResource lr=localResources.get("something.zip");
  assertNotNull(lr);
  assertEquals(10l,lr.getSize());
  assertEquals(10l,lr.getTimestamp());
  assertEquals(LocalResourceType.ARCHIVE,lr.getType());
  lr=localResources.get("something");
  assertNotNull(lr);
  assertEquals(11l,lr.getSize());
  assertEquals(11l,lr.getTimestamp());
  assertEquals(LocalResourceType.FILE,lr.getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.impl.TestMetricsCollectorImpl </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void recordBuilderShouldNoOpIfFiltered(){
  SubsetConfiguration fc=new ConfigBuilder().add("p.exclude","foo").subset("p");
  MetricsCollectorImpl mb=new MetricsCollectorImpl();
  mb.setRecordFilter(newGlobFilter(fc));
  MetricsRecordBuilderImpl rb=mb.addRecord("foo");
  rb.tag(info("foo",""),"value").addGauge(info("g0",""),1);
  assertEquals("no tags",0,rb.tags().size());
  assertEquals("no metrics",0,rb.metrics().size());
  assertNull("null record",rb.getRecord());
  assertEquals("no records",0,mb.getRecords().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.impl.TestMetricsSystemImpl </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUnregisterSource(){
  MetricsSystem ms=new MetricsSystemImpl();
  TestSource ts1=new TestSource("ts1");
  TestSource ts2=new TestSource("ts2");
  ms.register("ts1","",ts1);
  ms.register("ts2","",ts2);
  MetricsSource s1=ms.getSource("ts1");
  assertNotNull(s1);
  ms.unregisterSource("ts1");
  s1=ms.getSource("ts1");
  assertNull(s1);
  MetricsSource s2=ms.getSource("ts2");
  assertNotNull(s2);
  ms.shutdown();
}

</code></pre>

<br>
<pre class="type-7 type-19 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterDups(){
  MetricsSystem ms=new MetricsSystemImpl();
  TestSource ts1=new TestSource("ts1");
  TestSource ts2=new TestSource("ts2");
  ms.register("ts1","",ts1);
  MetricsSource s1=ms.getSource("ts1");
  assertNotNull(s1);
  ms.register("ts1","",ts2);
  MetricsSource s2=ms.getSource("ts1");
  assertNotNull(s2);
  assertNotSame(s1,s2);
  ms.shutdown();
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testStartStopStart(){
  DefaultMetricsSystem.shutdown();
  MetricsSystemImpl ms=new MetricsSystemImpl("test");
  TestSource ts=new TestSource("ts");
  ms.start();
  ms.register("ts","",ts);
  MetricsSourceAdapter sa=ms.getSourceAdapter("ts");
  assertNotNull(sa);
  assertNotNull(sa.getMBeanName());
  ms.stop();
  ms.shutdown();
  ms.start();
  sa=ms.getSourceAdapter("ts");
  assertNotNull(sa);
  assertNotNull(sa.getMBeanName());
  ms.stop();
  ms.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.util.TestMetricsCache </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void testGet(){
  MetricsCache cache=new MetricsCache();
  assertNull("empty",cache.get("r",Arrays.asList(makeTag("t","t"))));
  MetricsRecord mr=makeRecord("r",Arrays.asList(makeTag("t","t")),Arrays.asList(makeMetric("m",1)));
  cache.update(mr);
  MetricsCache.Record cr=cache.get("r",mr.tags());
  LOG.debug("tags=" + mr.tags() + " cr="+ cr);
  assertNotNull("Got record",cr);
  assertEquals("contains 1 metric",1,cr.metrics().size());
  checkMetricValue("new metric value",cr,"m",1);
}

</code></pre>

<br>
<pre class="type-13 type-11 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testOverflow(){
  MetricsCache cache=new MetricsCache();
  MetricsCache.Record cr;
  Collection<MetricsTag> t0=Arrays.asList(makeTag("t0","0"));
  for (int i=0; i < MetricsCache.MAX_RECS_PER_NAME_DEFAULT + 1; ++i) {
    cr=cache.update(makeRecord("r",Arrays.asList(makeTag("t" + i,"" + i)),Arrays.asList(makeMetric("m",i))));
    checkMetricValue("new metric value",cr,"m",i);
    if (i < MetricsCache.MAX_RECS_PER_NAME_DEFAULT) {
      assertNotNull("t0 is still there",cache.get("r",t0));
    }
  }
  assertNull("t0 is gone",cache.get("r",t0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.metrics2.util.TestSampleQuantiles </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that counts and quantile estimates are correctly reset after a call
 * to {@link SampleQuantiles#clear()}.
 */
@Test public void testClear() throws IOException {
  for (int i=0; i < 1000; i++) {
    estimator.insert(i);
  }
  estimator.clear();
  assertEquals(estimator.getCount(),0);
  assertEquals(estimator.getSampleCount(),0);
  assertNull(estimator.snapshot());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that the counts of the number of items in the window and sample are
 * incremented correctly as items are added.
 */
@Test public void testCount() throws IOException {
  assertEquals(estimator.getCount(),0);
  assertEquals(estimator.getSampleCount(),0);
  assertNull(estimator.snapshot());
  estimator.insert(1337);
  assertEquals(estimator.getCount(),1);
  estimator.snapshot();
  assertEquals(estimator.getSampleCount(),1);
  assertEquals("50.00 %ile +/- 5.00%: 1337\n" + "75.00 %ile +/- 2.50%: 1337\n" + "90.00 %ile +/- 1.00%: 1337\n"+ "95.00 %ile +/- 0.50%: 1337\n"+ "99.00 %ile +/- 0.10%: 1337",estimator.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestDNS </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
/** 
 * Test that our local IP address is not null
 * @throws Exception if something went wrong
 */
@Test public void testLocalHostHasAnAddress() throws Exception {
  assertNotNull(getLocalIPAddr());
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that repeated calls to getting the local host are fairly fast, and
 * hence that caching is being used
 * @throws Exception if hostname lookups fail
 */
@Test public void testGetLocalHostIsFast() throws Exception {
  String hostname1=DNS.getDefaultHost(DEFAULT);
  assertNotNull(hostname1);
  String hostname2=DNS.getDefaultHost(DEFAULT);
  long t1=Time.now();
  String hostname3=DNS.getDefaultHost(DEFAULT);
  long t2=Time.now();
  assertEquals(hostname3,hostname2);
  assertEquals(hostname2,hostname1);
  long interval=t2 - t1;
  assertTrue("Took too long to determine local host - caching is not working",interval < 20000);
}

</code></pre>

<br>
<pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
/** 
 * Test that asking for the default hostname works
 * @throws Exception if hostname lookups fail
 */
@Test public void testGetLocalHost() throws Exception {
  String hostname=DNS.getDefaultHost(DEFAULT);
  assertNotNull(hostname);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
/** 
 * Test that the name "localhost" resolves to something.
 * If this fails, your machine's network is in a mess, go edit /etc/hosts
 */
@Test public void testLocalhostResolves() throws Exception {
  InetAddress localhost=InetAddress.getByName("localhost");
  assertNotNull("localhost is null",localhost);
  LOG.info("Localhost IPAddr is " + localhost.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestNetUtils </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testGetHostNameOfIP(){
  assertNull(NetUtils.getHostNameOfIP(null));
  assertNull(NetUtils.getHostNameOfIP(""));
  assertNull(NetUtils.getHostNameOfIP("crazytown"));
  assertNull(NetUtils.getHostNameOfIP("127.0.0.1:"));
  assertNull(NetUtils.getHostNameOfIP("127.0.0.1:-1"));
  assertNull(NetUtils.getHostNameOfIP("127.0.0.1:A"));
  assertNotNull(NetUtils.getHostNameOfIP("127.0.0.1"));
  assertNotNull(NetUtils.getHostNameOfIP("127.0.0.1:1"));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
/** 
 * Test for {
 * @throws UnknownHostException @link NetUtils#getLocalInetAddress(String)
 * @throws SocketException 
 */
@Test public void testGetLocalInetAddress() throws Exception {
  assertNotNull(NetUtils.getLocalInetAddress("127.0.0.1"));
  assertNull(NetUtils.getLocalInetAddress("invalid-address-for-test"));
  assertNull(NetUtils.getLocalInetAddress(null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestNetworkTopology </h4><pre class="type-9 type-13 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=180000) public void testInvalidNetworkTopologiesNotCachedInHdfs() throws Exception {
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=null;
  try {
    String racks[]={"/a/b","/c"};
    String hosts[]={"foo1.example.com","foo2.example.com"};
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).racks(racks).hosts(hosts).build();
    cluster.waitActive();
    NamenodeProtocols nn=cluster.getNameNodeRpc();
    Assert.assertNotNull(nn);
    DatanodeInfo[] info;
    while (true) {
      info=nn.getDatanodeReport(DatanodeReportType.LIVE);
      Assert.assertFalse(info.length == 2);
      if (info.length == 1) {
        break;
      }
      Thread.sleep(1000);
    }
    int validIdx=info[0].getHostName().equals(hosts[0]) ? 0 : 1;
    int invalidIdx=validIdx == 1 ? 0 : 1;
    StaticMapping.addNodeToRack(hosts[invalidIdx],racks[validIdx]);
    LOG.info("datanode " + validIdx + " came up with network location "+ info[0].getNetworkLocation());
    cluster.restartDataNode(invalidIdx);
    Thread.sleep(5000);
    while (true) {
      info=nn.getDatanodeReport(DatanodeReportType.LIVE);
      if (info.length == 2) {
        break;
      }
      if (info.length == 0) {
        LOG.info("got no valid DNs");
      }
 else       if (info.length == 1) {
        LOG.info("got one valid DN: " + info[0].getHostName() + " (at "+ info[0].getNetworkLocation()+ ")");
      }
      Thread.sleep(1000);
    }
    Assert.assertEquals(info[0].getNetworkLocation(),info[1].getNetworkLocation());
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestScriptBasedMapping </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testNoArgsMeansNoResult(){
  Configuration conf=new Configuration();
  conf.setInt(ScriptBasedMapping.SCRIPT_ARG_COUNT_KEY,ScriptBasedMapping.MIN_ALLOWABLE_ARGS - 1);
  conf.set(ScriptBasedMapping.SCRIPT_FILENAME_KEY,"any-filename");
  conf.set(ScriptBasedMapping.SCRIPT_FILENAME_KEY,"any-filename");
  ScriptBasedMapping mapping=createMapping(conf);
  List<String> names=new ArrayList<String>();
  names.add("some.machine.name");
  names.add("other.machine.name");
  List<String> result=mapping.resolve(names);
  assertNull("Expected an empty list",result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestScriptBasedMappingWithDependency </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testNoArgsMeansNoResult(){
  Configuration conf=new Configuration();
  conf.setInt(ScriptBasedMapping.SCRIPT_ARG_COUNT_KEY,ScriptBasedMapping.MIN_ALLOWABLE_ARGS - 1);
  conf.set(ScriptBasedMapping.SCRIPT_FILENAME_KEY,"any-filename-1");
  conf.set(ScriptBasedMappingWithDependency.DEPENDENCY_SCRIPT_FILENAME_KEY,"any-filename-2");
  conf.setInt(ScriptBasedMapping.SCRIPT_ARG_COUNT_KEY,10);
  ScriptBasedMappingWithDependency mapping=createMapping(conf);
  List<String> names=new ArrayList<String>();
  names.add("some.machine.name");
  names.add("other.machine.name");
  List<String> result=mapping.resolve(names);
  assertNull("Expected an empty list for resolve",result);
  result=mapping.getDependency("some.machine.name");
  assertNull("Expected an empty list for getDependency",result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.TestStaticMapping </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that a configuration string builds a topology
 */
@Test public void testReadNodesFromConfig() throws Throwable {
  StaticMapping mapping=newInstance();
  Configuration conf=new Configuration();
  conf.set(StaticMapping.KEY_HADOOP_CONFIGURED_NODE_MAPPING,"n1=/r1,n2=/r2");
  mapping.setConf(conf);
  assertSingleSwitch(mapping);
  List<String> l1=new ArrayList<String>(3);
  l1.add("n1");
  l1.add("unknown");
  l1.add("n2");
  List<String> resolved=mapping.resolve(l1);
  assertEquals(3,resolved.size());
  assertEquals("/r1",resolved.get(0));
  assertEquals(NetworkTopology.DEFAULT_RACK,resolved.get(1));
  assertEquals("/r2",resolved.get(2));
  Map<String,String> switchMap=mapping.getSwitchMap();
  String topology=mapping.dumpTopology();
  LOG.info(topology);
  assertEquals(topology,2,switchMap.size());
  assertEquals(topology,"/r1",switchMap.get("n1"));
  assertNull(topology,switchMap.get("unknown"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.net.unix.TestDomainSocket </h4><pre class="type-9 type-13 type-11 type-2 type-7 type-10 type-1 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test file descriptor passing.
 * @throws IOException
 */
@Test(timeout=180000) public void testFdPassing() throws Exception {
  final String TEST_PATH=new File(sockDir.getDir(),"test_sock").getAbsolutePath();
  final byte clientMsg1[]=new byte[]{0x11,0x22,0x33,0x44,0x55,0x66};
  final byte serverMsg1[]=new byte[]{0x31,0x30,0x32,0x34,0x31,0x33,0x44,0x1,0x1,0x1,0x1,0x1};
  final ArrayBlockingQueue<Throwable> threadResults=new ArrayBlockingQueue<Throwable>(2);
  final DomainSocket serv=DomainSocket.bindAndListen(TEST_PATH);
  final PassedFile passedFiles[]=new PassedFile[]{new PassedFile(1),new PassedFile(2)};
  final FileDescriptor passedFds[]=new FileDescriptor[passedFiles.length];
  for (int i=0; i < passedFiles.length; i++) {
    passedFds[i]=passedFiles[i].getInputStream().getFD();
  }
  Thread serverThread=new Thread(){
    public void run(){
      DomainSocket conn=null;
      try {
        conn=serv.accept();
        byte in1[]=new byte[clientMsg1.length];
        InputStream connInputStream=conn.getInputStream();
        IOUtils.readFully(connInputStream,in1,0,in1.length);
        Assert.assertTrue(Arrays.equals(clientMsg1,in1));
        DomainSocket domainConn=(DomainSocket)conn;
        domainConn.sendFileDescriptors(passedFds,serverMsg1,0,serverMsg1.length);
        conn.close();
      }
 catch (      Throwable e) {
        threadResults.add(e);
        Assert.fail(e.getMessage());
      }
      threadResults.add(new Success());
    }
  }
;
  serverThread.start();
  Thread clientThread=new Thread(){
    public void run(){
      try {
        DomainSocket client=DomainSocket.connect(TEST_PATH);
        OutputStream clientOutputStream=client.getOutputStream();
        InputStream clientInputStream=client.getInputStream();
        clientOutputStream.write(clientMsg1);
        DomainSocket domainConn=(DomainSocket)client;
        byte in1[]=new byte[serverMsg1.length];
        FileInputStream recvFis[]=new FileInputStream[passedFds.length];
        int r=domainConn.recvFileInputStreams(recvFis,in1,0,in1.length - 1);
        Assert.assertTrue(r > 0);
        IOUtils.readFully(clientInputStream,in1,r,in1.length - r);
        Assert.assertTrue(Arrays.equals(serverMsg1,in1));
        for (int i=0; i < passedFds.length; i++) {
          Assert.assertNotNull(recvFis[i]);
          passedFiles[i].checkInputStream(recvFis[i]);
        }
        for (        FileInputStream fis : recvFis) {
          fis.close();
        }
        client.close();
      }
 catch (      Throwable e) {
        threadResults.add(e);
      }
      threadResults.add(new Success());
    }
  }
;
  clientThread.start();
  for (int i=0; i < 2; i++) {
    Throwable t=threadResults.take();
    if (!(t instanceof Success)) {
      Assert.fail(t.getMessage() + ExceptionUtils.getStackTrace(t));
    }
  }
  serverThread.join(120000);
  clientThread.join(120000);
  serv.close();
  for (  PassedFile pf : passedFiles) {
    pf.cleanup();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.oncrpc.TestRpcCallCache </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testAddRemoveEntries() throws UnknownHostException {
  RpcCallCache cache=new RpcCallCache("test",100);
  InetAddress clientIp=InetAddress.getByName("1.1.1.1");
  int xid=100;
  CacheEntry e=cache.checkOrAddToCache(clientIp,xid);
  assertNull(e);
  e=cache.checkOrAddToCache(clientIp,xid);
  validateInprogressCacheEntry(e);
  RpcResponse response=mock(RpcResponse.class);
  cache.callCompleted(clientIp,xid,response);
  e=cache.checkOrAddToCache(clientIp,xid);
  validateCompletedCacheEntry(e,response);
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheEntry(){
  CacheEntry c=new CacheEntry();
  validateInprogressCacheEntry(c);
  assertTrue(c.isInProgress());
  assertFalse(c.isCompleted());
  assertNull(c.getResponse());
  RpcResponse response=mock(RpcResponse.class);
  c.setResponse(response);
  validateCompletedCacheEntry(c,response);
}

</code></pre>

<br>
<pre class="type-9 type-13 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheFunctionality() throws UnknownHostException {
  RpcCallCache cache=new RpcCallCache("Test",10);
  int size=0;
  for (int clientId=0; clientId < 20; clientId++) {
    InetAddress clientIp=InetAddress.getByName("1.1.1." + clientId);
    System.out.println("Adding " + clientIp);
    cache.checkOrAddToCache(clientIp,0);
    size=Math.min(++size,10);
    System.out.println("Cache size " + cache.size());
    assertEquals(size,cache.size());
    int startEntry=Math.max(clientId - 10 + 1,0);
    Iterator<Entry<ClientRequest,CacheEntry>> iterator=cache.iterator();
    for (int i=0; i < size; i++) {
      ClientRequest key=iterator.next().getKey();
      System.out.println("Entry " + key.getClientId());
      assertEquals(InetAddress.getByName("1.1.1." + (startEntry + i)),key.getClientId());
    }
    for (int i=0; i < size; i++) {
      CacheEntry e=cache.checkOrAddToCache(InetAddress.getByName("1.1.1." + (startEntry + i)),0);
      assertNotNull(e);
      assertTrue(e.isInProgress());
      assertFalse(e.isCompleted());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.TestProxyUserFromEnv </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test HADOOP_PROXY_USER for impersonation 
 */
@Test public void testProxyUserFromEnvironment() throws IOException {
  String proxyUser="foo.bar";
  System.setProperty(UserGroupInformation.HADOOP_PROXY_USER,proxyUser);
  UserGroupInformation ugi=UserGroupInformation.getLoginUser();
  assertEquals(proxyUser,ugi.getUserName());
  UserGroupInformation realUgi=ugi.getRealUser();
  assertNotNull(realUgi);
  Process pp=Runtime.getRuntime().exec("whoami");
  BufferedReader br=new BufferedReader(new InputStreamReader(pp.getInputStream()));
  String realUser=br.readLine().trim();
  int backslashIndex=realUser.indexOf('\\');
  if (backslashIndex != -1) {
    realUser=realUser.substring(backslashIndex + 1);
  }
  assertEquals(realUser,realUgi.getUserName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.TestUGIWithExternalKdc </h4><pre class="type-9 type-2 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLogin() throws IOException {
  String userPrincipal=System.getProperty("user.principal");
  String userKeyTab=System.getProperty("user.keytab");
  Assert.assertNotNull("User principal was not specified",userPrincipal);
  Assert.assertNotNull("User keytab was not specified",userKeyTab);
  Configuration conf=new Configuration();
  conf.set(CommonConfigurationKeys.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  UserGroupInformation.setConfiguration(conf);
  UserGroupInformation ugi=UserGroupInformation.loginUserFromKeytabAndReturnUGI(userPrincipal,userKeyTab);
  Assert.assertEquals(AuthenticationMethod.KERBEROS,ugi.getAuthenticationMethod());
  try {
    UserGroupInformation.loginUserFromKeytabAndReturnUGI("bogus@EXAMPLE.COM",userKeyTab);
    Assert.fail("Login should have failed");
  }
 catch (  Exception ex) {
    ex.printStackTrace();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.TestUserGroupInformation </h4><pre class="type-9 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testGetUGIFromSubject() throws Exception {
  KerberosPrincipal p=new KerberosPrincipal("guest");
  Subject subject=new Subject();
  subject.getPrincipals().add(p);
  UserGroupInformation ugi=UserGroupInformation.getUGIFromSubject(subject);
  assertNotNull(ugi);
  assertEquals("guest@DEFAULT.REALM",ugi.getUserName());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
/** 
 * Test for the case that UserGroupInformation.getCurrentUser()
 * is called when the AccessControlContext has a Subject associated
 * with it, but that Subject was not created by Hadoop (ie it has no
 * associated User principal)
 */
@Test(timeout=30000) public void testUGIUnderNonHadoopContext() throws Exception {
  Subject nonHadoopSubject=new Subject();
  Subject.doAs(nonHadoopSubject,new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws IOException {
      UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
      assertNotNull(ugi);
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks a race condition between getting and adding tokens for
 * the current user.  Calling UserGroupInformation.getCurrentUser() returns
 * a new object each time, so simply making these methods synchronized was not
 * enough to prevent race conditions and causing a
 * ConcurrentModificationException.  These methods are synchronized on the
 * Subject, which is the same object between UserGroupInformation instances.
 * This test tries to cause a CME, by exposing the race condition.  Previously
 * this test would fail every time; now it does not.
 */
@Test public void testTokenRaceCondition() throws Exception {
  UserGroupInformation userGroupInfo=UserGroupInformation.createUserForTesting(USER_NAME,GROUP_NAMES);
  userGroupInfo.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      assertNotEquals(UserGroupInformation.getLoginUser(),UserGroupInformation.getCurrentUser());
      GetTokenThread thread=new GetTokenThread();
      try {
        thread.start();
        for (int i=0; i < 100; i++) {
          @SuppressWarnings("unchecked") Token<? extends TokenIdentifier> t=mock(Token.class);
          when(t.getService()).thenReturn(new Text("t" + i));
          UserGroupInformation.getCurrentUser().addToken(t);
          assertNull("ConcurrentModificationException encountered",thread.cme);
        }
      }
 catch (      ConcurrentModificationException cme) {
        cme.printStackTrace();
        fail("ConcurrentModificationException encountered");
      }
 finally {
        thread.runThread=false;
        thread.join(5 * 1000);
      }
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.authentication.server.TestAuthenticationFilter </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInit() throws Exception {
  AuthenticationFilter filter=new AuthenticationFilter();
  try {
    FilterConfig config=Mockito.mock(FilterConfig.class);
    Mockito.when(config.getInitParameter(AuthenticationFilter.AUTH_TYPE)).thenReturn("simple");
    Mockito.when(config.getInitParameter(AuthenticationFilter.AUTH_TOKEN_VALIDITY)).thenReturn((new Long(TOKEN_VALIDITY_SEC)).toString());
    Mockito.when(config.getInitParameterNames()).thenReturn(new Vector<String>(Arrays.asList(AuthenticationFilter.AUTH_TYPE,AuthenticationFilter.AUTH_TOKEN_VALIDITY)).elements());
    ServletContext context=Mockito.mock(ServletContext.class);
    Mockito.when(context.getAttribute(AuthenticationFilter.SIGNATURE_PROVIDER_ATTRIBUTE)).thenReturn(null);
    Mockito.when(config.getServletContext()).thenReturn(context);
    filter.init(config);
    Assert.assertEquals(PseudoAuthenticationHandler.class,filter.getAuthenticationHandler().getClass());
    Assert.assertTrue(filter.isRandomSecret());
    Assert.assertFalse(filter.isCustomSignerSecretProvider());
    Assert.assertNull(filter.getCookieDomain());
    Assert.assertNull(filter.getCookiePath());
    Assert.assertEquals(TOKEN_VALIDITY_SEC,filter.getValidity());
  }
  finally {
    filter.destroy();
  }
  filter=new AuthenticationFilter();
  try {
    FilterConfig config=Mockito.mock(FilterConfig.class);
    Mockito.when(config.getInitParameter(AuthenticationFilter.AUTH_TYPE)).thenReturn("simple");
    Mockito.when(config.getInitParameter(AuthenticationFilter.SIGNATURE_SECRET)).thenReturn("secret");
    Mockito.when(config.getInitParameterNames()).thenReturn(new Vector<String>(Arrays.asList(AuthenticationFilter.AUTH_TYPE,AuthenticationFilter.SIGNATURE_SECRET)).elements());
    ServletContext context=Mockito.mock(ServletContext.class);
    Mockito.when(context.getAttribute(AuthenticationFilter.SIGNATURE_PROVIDER_ATTRIBUTE)).thenReturn(null);
    Mockito.when(config.getServletContext()).thenReturn(context);
    filter.init(config);
    Assert.assertFalse(filter.isRandomSecret());
    Assert.assertFalse(filter.isCustomSignerSecretProvider());
  }
  finally {
    filter.destroy();
  }
  filter=new AuthenticationFilter();
  try {
    FilterConfig config=Mockito.mock(FilterConfig.class);
    Mockito.when(config.getInitParameter(AuthenticationFilter.AUTH_TYPE)).thenReturn("simple");
    Mockito.when(config.getInitParameter(AuthenticationFilter.SIGNATURE_SECRET)).thenReturn("secret");
    Mockito.when(config.getInitParameterNames()).thenReturn(new Vector<String>(Arrays.asList(AuthenticationFilter.AUTH_TYPE,AuthenticationFilter.SIGNATURE_SECRET)).elements());
    ServletContext context=Mockito.mock(ServletContext.class);
    Mockito.when(context.getAttribute(AuthenticationFilter.SIGNATURE_PROVIDER_ATTRIBUTE)).thenReturn(new SignerSecretProvider(){
      @Override public void init(      Properties config,      long tokenValidity){
      }
      @Override public byte[] getCurrentSecret(){
        return null;
      }
      @Override public byte[][] getAllSecrets(){
        return null;
      }
    }
);
    Mockito.when(config.getServletContext()).thenReturn(context);
    filter.init(config);
    Assert.assertFalse(filter.isRandomSecret());
    Assert.assertTrue(filter.isCustomSignerSecretProvider());
  }
  finally {
    filter.destroy();
  }
  filter=new AuthenticationFilter();
  try {
    FilterConfig config=Mockito.mock(FilterConfig.class);
    Mockito.when(config.getInitParameter(AuthenticationFilter.AUTH_TYPE)).thenReturn("simple");
    Mockito.when(config.getInitParameter(AuthenticationFilter.COOKIE_DOMAIN)).thenReturn(".foo.com");
    Mockito.when(config.getInitParameter(AuthenticationFilter.COOKIE_PATH)).thenReturn("/bar");
    Mockito.when(config.getInitParameterNames()).thenReturn(new Vector<String>(Arrays.asList(AuthenticationFilter.AUTH_TYPE,AuthenticationFilter.COOKIE_DOMAIN,AuthenticationFilter.COOKIE_PATH)).elements());
    ServletContext context=Mockito.mock(ServletContext.class);
    Mockito.when(context.getAttribute(AuthenticationFilter.SIGNATURE_PROVIDER_ATTRIBUTE)).thenReturn(null);
    Mockito.when(config.getServletContext()).thenReturn(context);
    filter.init(config);
    Assert.assertEquals(".foo.com",filter.getCookieDomain());
    Assert.assertEquals("/bar",filter.getCookiePath());
  }
  finally {
    filter.destroy();
  }
  DummyAuthenticationHandler.reset();
  filter=new AuthenticationFilter();
  try {
    FilterConfig config=Mockito.mock(FilterConfig.class);
    Mockito.when(config.getInitParameter("management.operation.return")).thenReturn("true");
    Mockito.when(config.getInitParameter(AuthenticationFilter.AUTH_TYPE)).thenReturn(DummyAuthenticationHandler.class.getName());
    Mockito.when(config.getInitParameterNames()).thenReturn(new Vector<String>(Arrays.asList(AuthenticationFilter.AUTH_TYPE,"management.operation.return")).elements());
    ServletContext context=Mockito.mock(ServletContext.class);
    Mockito.when(context.getAttribute(AuthenticationFilter.SIGNATURE_PROVIDER_ATTRIBUTE)).thenReturn(null);
    Mockito.when(config.getServletContext()).thenReturn(context);
    filter.init(config);
    Assert.assertTrue(DummyAuthenticationHandler.init);
  }
  finally {
    filter.destroy();
    Assert.assertTrue(DummyAuthenticationHandler.destroy);
  }
  filter=new AuthenticationFilter();
  try {
    FilterConfig config=Mockito.mock(FilterConfig.class);
    Mockito.when(config.getInitParameter(AuthenticationFilter.AUTH_TYPE)).thenReturn("kerberos");
    Mockito.when(config.getInitParameterNames()).thenReturn(new Vector<String>(Arrays.asList(AuthenticationFilter.AUTH_TYPE)).elements());
    filter.init(config);
  }
 catch (  ServletException ex) {
  }
 finally {
    Assert.assertEquals(KerberosAuthenticationHandler.class,filter.getAuthenticationHandler().getClass());
    filter.destroy();
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoFilterAuthenticationFailure() throws Exception {
  AuthenticationFilter filter=new AuthenticationFilter();
  try {
    FilterConfig config=Mockito.mock(FilterConfig.class);
    Mockito.when(config.getInitParameter("management.operation.return")).thenReturn("true");
    Mockito.when(config.getInitParameter(AuthenticationFilter.AUTH_TYPE)).thenReturn(DummyAuthenticationHandler.class.getName());
    Mockito.when(config.getInitParameterNames()).thenReturn(new Vector<String>(Arrays.asList(AuthenticationFilter.AUTH_TYPE,"management.operation.return")).elements());
    ServletContext context=Mockito.mock(ServletContext.class);
    Mockito.when(context.getAttribute(AuthenticationFilter.SIGNATURE_PROVIDER_ATTRIBUTE)).thenReturn(null);
    Mockito.when(config.getServletContext()).thenReturn(context);
    filter.init(config);
    HttpServletRequest request=Mockito.mock(HttpServletRequest.class);
    Mockito.when(request.getRequestURL()).thenReturn(new StringBuffer("http://foo:8080/bar"));
    Mockito.when(request.getCookies()).thenReturn(new Cookie[]{});
    Mockito.when(request.getHeader("WWW-Authenticate")).thenReturn("dummyauth");
    HttpServletResponse response=Mockito.mock(HttpServletResponse.class);
    FilterChain chain=Mockito.mock(FilterChain.class);
    final HashMap<String,String> cookieMap=new HashMap<String,String>();
    Mockito.doAnswer(new Answer(){
      @Override public Object answer(      InvocationOnMock invocation) throws Throwable {
        Object[] args=invocation.getArguments();
        parseCookieMap((String)args[1],cookieMap);
        return null;
      }
    }
).when(response).addHeader(Mockito.eq("Set-Cookie"),Mockito.anyString());
    Mockito.doAnswer(new Answer(){
      @Override public Object answer(      InvocationOnMock invocation) throws Throwable {
        Assert.fail("shouldn't get here");
        return null;
      }
    }
).when(chain).doFilter(Mockito.<ServletRequest>anyObject(),Mockito.<ServletResponse>anyObject());
    filter.doFilter(request,response,chain);
    Mockito.verify(response).sendError(HttpServletResponse.SC_FORBIDDEN,"AUTH FAILED");
    Mockito.verify(response,Mockito.never()).setHeader(Mockito.eq("WWW-Authenticate"),Mockito.anyString());
    String value=cookieMap.get(AuthenticatedURL.AUTH_COOKIE);
    Assert.assertNotNull("cookie missing",value);
    Assert.assertEquals("",value);
  }
  finally {
    filter.destroy();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.authentication.server.TestAuthenticationToken </h4><pre class="type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAnonymous(){
  Assert.assertNotNull(AuthenticationToken.ANONYMOUS);
  Assert.assertEquals(null,AuthenticationToken.ANONYMOUS.getUserName());
  Assert.assertEquals(null,AuthenticationToken.ANONYMOUS.getName());
  Assert.assertEquals(null,AuthenticationToken.ANONYMOUS.getType());
  Assert.assertEquals(-1,AuthenticationToken.ANONYMOUS.getExpires());
  Assert.assertFalse(AuthenticationToken.ANONYMOUS.isExpired());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.authentication.util.TestKerberosUtil </h4><pre class="type-9 type-11 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPrincipalNamesFromKeytabWithPattern() throws IOException {
  createKeyTab(testKeytab,testPrincipals);
  Pattern httpPattern=Pattern.compile("HTTP/.*");
  String[] httpPrincipals=KerberosUtil.getPrincipalNames(testKeytab,httpPattern);
  Assert.assertNotNull("principals cannot be null",httpPrincipals);
  int expectedSize=0;
  List<String> httpPrincipalList=Arrays.asList(httpPrincipals);
  for (  String principal : testPrincipals) {
    if (httpPattern.matcher(principal).matches()) {
      Assert.assertTrue("missing principal " + principal,httpPrincipalList.contains(principal));
      expectedSize++;
    }
  }
  Assert.assertEquals(expectedSize,httpPrincipals.length);
}

</code></pre>

<br>
<pre class="type-9 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPrincipalNamesFromKeytab() throws IOException {
  createKeyTab(testKeytab,testPrincipals);
  String[] principals=KerberosUtil.getPrincipalNames(testKeytab);
  Assert.assertNotNull("principals cannot be null",principals);
  int expectedSize=0;
  List<String> principalList=Arrays.asList(principals);
  for (  String principal : testPrincipals) {
    Assert.assertTrue("missing principal " + principal,principalList.contains(principal));
    expectedSize++;
  }
  Assert.assertEquals(expectedSize,principals.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.authentication.util.TestRandomSignerSecretProvider </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAndRollSecrets() throws Exception {
  long rolloverFrequency=15 * 1000;
  long seed=System.currentTimeMillis();
  Random rand=new Random(seed);
  byte[] secret1=Long.toString(rand.nextLong()).getBytes();
  byte[] secret2=Long.toString(rand.nextLong()).getBytes();
  byte[] secret3=Long.toString(rand.nextLong()).getBytes();
  RandomSignerSecretProvider secretProvider=new RandomSignerSecretProvider(seed);
  try {
    secretProvider.init(null,rolloverFrequency);
    byte[] currentSecret=secretProvider.getCurrentSecret();
    byte[][] allSecrets=secretProvider.getAllSecrets();
    Assert.assertArrayEquals(secret1,currentSecret);
    Assert.assertEquals(2,allSecrets.length);
    Assert.assertArrayEquals(secret1,allSecrets[0]);
    Assert.assertNull(allSecrets[1]);
    Thread.sleep(rolloverFrequency + 2000);
    currentSecret=secretProvider.getCurrentSecret();
    allSecrets=secretProvider.getAllSecrets();
    Assert.assertArrayEquals(secret2,currentSecret);
    Assert.assertEquals(2,allSecrets.length);
    Assert.assertArrayEquals(secret2,allSecrets[0]);
    Assert.assertArrayEquals(secret1,allSecrets[1]);
    Thread.sleep(rolloverFrequency + 2000);
    currentSecret=secretProvider.getCurrentSecret();
    allSecrets=secretProvider.getAllSecrets();
    Assert.assertArrayEquals(secret3,currentSecret);
    Assert.assertEquals(2,allSecrets.length);
    Assert.assertArrayEquals(secret3,allSecrets[0]);
    Assert.assertArrayEquals(secret2,allSecrets[1]);
    Thread.sleep(rolloverFrequency + 2000);
  }
  finally {
    secretProvider.destroy();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.authentication.util.TestRolloverSignerSecretProvider </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAndRollSecrets() throws Exception {
  long rolloverFrequency=15 * 1000;
  byte[] secret1="doctor".getBytes();
  byte[] secret2="who".getBytes();
  byte[] secret3="tardis".getBytes();
  TRolloverSignerSecretProvider secretProvider=new TRolloverSignerSecretProvider(new byte[][]{secret1,secret2,secret3});
  try {
    secretProvider.init(null,rolloverFrequency);
    byte[] currentSecret=secretProvider.getCurrentSecret();
    byte[][] allSecrets=secretProvider.getAllSecrets();
    Assert.assertArrayEquals(secret1,currentSecret);
    Assert.assertEquals(2,allSecrets.length);
    Assert.assertArrayEquals(secret1,allSecrets[0]);
    Assert.assertNull(allSecrets[1]);
    Thread.sleep(rolloverFrequency + 2000);
    currentSecret=secretProvider.getCurrentSecret();
    allSecrets=secretProvider.getAllSecrets();
    Assert.assertArrayEquals(secret2,currentSecret);
    Assert.assertEquals(2,allSecrets.length);
    Assert.assertArrayEquals(secret2,allSecrets[0]);
    Assert.assertArrayEquals(secret1,allSecrets[1]);
    Thread.sleep(rolloverFrequency + 2000);
    currentSecret=secretProvider.getCurrentSecret();
    allSecrets=secretProvider.getAllSecrets();
    Assert.assertArrayEquals(secret3,currentSecret);
    Assert.assertEquals(2,allSecrets.length);
    Assert.assertArrayEquals(secret3,allSecrets[0]);
    Assert.assertArrayEquals(secret2,allSecrets[1]);
    Thread.sleep(rolloverFrequency + 2000);
  }
  finally {
    secretProvider.destroy();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.authorize.TestAccessControlList </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests adding/removing wild card as the user/group.
 */
@Test public void testAddRemoveWildCard(){
  AccessControlList acl=new AccessControlList("drwho tardis");
  Throwable th=null;
  try {
    acl.addUser(" * ");
  }
 catch (  Throwable t) {
    th=t;
  }
  assertNotNull(th);
  assertTrue(th instanceof IllegalArgumentException);
  th=null;
  try {
    acl.addGroup(" * ");
  }
 catch (  Throwable t) {
    th=t;
  }
  assertNotNull(th);
  assertTrue(th instanceof IllegalArgumentException);
  th=null;
  try {
    acl.removeUser(" * ");
  }
 catch (  Throwable t) {
    th=t;
  }
  assertNotNull(th);
  assertTrue(th instanceof IllegalArgumentException);
  th=null;
  try {
    acl.removeGroup(" * ");
  }
 catch (  Throwable t) {
    th=t;
  }
  assertNotNull(th);
  assertTrue(th instanceof IllegalArgumentException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.ssl.TestSSLFactory </h4><pre class="type-7 type-1 type-14 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalStateException.class) public void clientMode() throws Exception {
  Configuration conf=createConfiguration(false,true);
  SSLFactory sslFactory=new SSLFactory(SSLFactory.Mode.CLIENT,conf);
  try {
    sslFactory.init();
    Assert.assertNotNull(sslFactory.createSSLSocketFactory());
    Assert.assertNotNull(sslFactory.getHostnameVerifier());
    sslFactory.createSSLServerSocketFactory();
  }
  finally {
    sslFactory.destroy();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.token.delegation.TestDelegationToken </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetUserWithOwnerEqualsReal(){
  Text owner=new Text("owner");
  TestDelegationTokenIdentifier ident=new TestDelegationTokenIdentifier(owner,null,owner);
  UserGroupInformation ugi=ident.getUser();
  assertNull(ugi.getRealUser());
  assertEquals("owner",ugi.getUserName());
  assertEquals(AuthenticationMethod.TOKEN,ugi.getAuthenticationMethod());
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetUserNullOwner(){
  TestDelegationTokenIdentifier ident=new TestDelegationTokenIdentifier(null,null,null);
  UserGroupInformation ugi=ident.getUser();
  assertNull(ugi);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetUserWithOwnerAndReal(){
  Text owner=new Text("owner");
  Text realUser=new Text("realUser");
  TestDelegationTokenIdentifier ident=new TestDelegationTokenIdentifier(owner,null,realUser);
  UserGroupInformation ugi=ident.getUser();
  assertNotNull(ugi.getRealUser());
  assertNull(ugi.getRealUser().getRealUser());
  assertEquals("owner",ugi.getUserName());
  assertEquals("realUser",ugi.getRealUser().getUserName());
  assertEquals(AuthenticationMethod.PROXY,ugi.getAuthenticationMethod());
  assertEquals(AuthenticationMethod.TOKEN,ugi.getRealUser().getAuthenticationMethod());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetUserWithOwner(){
  TestDelegationTokenIdentifier ident=new TestDelegationTokenIdentifier(new Text("owner"),null,null);
  UserGroupInformation ugi=ident.getUser();
  assertNull(ugi.getRealUser());
  assertEquals("owner",ugi.getUserName());
  assertEquals(AuthenticationMethod.TOKEN,ugi.getAuthenticationMethod());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.token.delegation.web.TestDelegationTokenManager </h4><pre class="type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDTManager() throws Exception {
  DelegationTokenManager tm=new DelegationTokenManager(new Text("foo"),DAY_IN_SECS,DAY_IN_SECS,DAY_IN_SECS,DAY_IN_SECS);
  tm.init();
  Token<DelegationTokenIdentifier> token=tm.createToken(UserGroupInformation.getCurrentUser(),"foo");
  Assert.assertNotNull(token);
  tm.verifyToken(token);
  Assert.assertTrue(tm.renewToken(token,"foo") > System.currentTimeMillis());
  tm.cancelToken(token,"foo");
  try {
    tm.verifyToken(token);
    Assert.fail();
  }
 catch (  IOException ex) {
  }
catch (  Exception ex) {
    Assert.fail();
  }
  tm.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.security.token.delegation.web.TestWebDelegationToken </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExternalDelegationTokenSecretManager() throws Exception {
  DummyDelegationTokenSecretManager secretMgr=new DummyDelegationTokenSecretManager();
  final Server jetty=createJettyServer();
  Context context=new Context();
  context.setContextPath("/foo");
  jetty.setHandler(context);
  context.addFilter(new FilterHolder(AFilter.class),"/*",0);
  context.addServlet(new ServletHolder(PingServlet.class),"/bar");
  try {
    secretMgr.startThreads();
    context.setAttribute(DelegationTokenAuthenticationFilter.DELEGATION_TOKEN_SECRET_MANAGER_ATTR,secretMgr);
    jetty.start();
    URL authURL=new URL(getJettyURL() + "/foo/bar?authenticated=foo");
    DelegationTokenAuthenticatedURL.Token token=new DelegationTokenAuthenticatedURL.Token();
    DelegationTokenAuthenticatedURL aUrl=new DelegationTokenAuthenticatedURL();
    aUrl.getDelegationToken(authURL,token,FOO_USER);
    Assert.assertNotNull(token.getDelegationToken());
    Assert.assertEquals(new Text("fooKind"),token.getDelegationToken().getKind());
  }
  finally {
    jetty.stop();
    secretMgr.stopThreads();
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelegationTokenAuthenticatorCalls() throws Exception {
  final Server jetty=createJettyServer();
  Context context=new Context();
  context.setContextPath("/foo");
  jetty.setHandler(context);
  context.addFilter(new FilterHolder(AFilter.class),"/*",0);
  context.addServlet(new ServletHolder(PingServlet.class),"/bar");
  try {
    jetty.start();
    URL nonAuthURL=new URL(getJettyURL() + "/foo/bar");
    URL authURL=new URL(getJettyURL() + "/foo/bar?authenticated=foo");
    URL authURL2=new URL(getJettyURL() + "/foo/bar?authenticated=bar");
    DelegationTokenAuthenticatedURL.Token token=new DelegationTokenAuthenticatedURL.Token();
    DelegationTokenAuthenticatedURL aUrl=new DelegationTokenAuthenticatedURL();
    try {
      aUrl.getDelegationToken(nonAuthURL,token,FOO_USER);
      Assert.fail();
    }
 catch (    Exception ex) {
      Assert.assertTrue(ex.getMessage().contains("401"));
    }
    aUrl.getDelegationToken(authURL,token,FOO_USER);
    Assert.assertNotNull(token.getDelegationToken());
    Assert.assertEquals(new Text("token-kind"),token.getDelegationToken().getKind());
    aUrl.renewDelegationToken(authURL,token);
    try {
      aUrl.renewDelegationToken(nonAuthURL,token);
      Assert.fail();
    }
 catch (    Exception ex) {
      Assert.assertTrue(ex.getMessage().contains("401"));
    }
    aUrl.getDelegationToken(authURL,token,FOO_USER);
    try {
      aUrl.renewDelegationToken(authURL2,token);
      Assert.fail();
    }
 catch (    Exception ex) {
      Assert.assertTrue(ex.getMessage().contains("403"));
    }
    aUrl.getDelegationToken(authURL,token,FOO_USER);
    aUrl.cancelDelegationToken(authURL,token);
    aUrl.getDelegationToken(authURL,token,FOO_USER);
    aUrl.cancelDelegationToken(nonAuthURL,token);
    aUrl.getDelegationToken(authURL,token,FOO_USER);
    try {
      aUrl.renewDelegationToken(nonAuthURL,token);
    }
 catch (    Exception ex) {
      Assert.assertTrue(ex.getMessage().contains("401"));
    }
  }
  finally {
    jetty.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRawHttpCalls() throws Exception {
  final Server jetty=createJettyServer();
  Context context=new Context();
  context.setContextPath("/foo");
  jetty.setHandler(context);
  context.addFilter(new FilterHolder(AFilter.class),"/*",0);
  context.addServlet(new ServletHolder(PingServlet.class),"/bar");
  try {
    jetty.start();
    URL nonAuthURL=new URL(getJettyURL() + "/foo/bar");
    URL authURL=new URL(getJettyURL() + "/foo/bar?authenticated=foo");
    HttpURLConnection conn=(HttpURLConnection)nonAuthURL.openConnection();
    Assert.assertEquals(HttpURLConnection.HTTP_UNAUTHORIZED,conn.getResponseCode());
    conn=(HttpURLConnection)authURL.openConnection();
    Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
    URL url=new URL(nonAuthURL.toExternalForm() + "?op=GETDELEGATIONTOKEN");
    conn=(HttpURLConnection)url.openConnection();
    Assert.assertEquals(HttpURLConnection.HTTP_UNAUTHORIZED,conn.getResponseCode());
    url=new URL(authURL.toExternalForm() + "&op=GETDELEGATIONTOKEN&renewer=foo");
    conn=(HttpURLConnection)url.openConnection();
    Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
    ObjectMapper mapper=new ObjectMapper();
    Map map=mapper.readValue(conn.getInputStream(),Map.class);
    String dt=(String)((Map)map.get("Token")).get("urlString");
    Assert.assertNotNull(dt);
    url=new URL(nonAuthURL.toExternalForm() + "?delegation=" + dt);
    conn=(HttpURLConnection)url.openConnection();
    Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
    url=new URL(authURL.toExternalForm() + "&delegation=" + dt);
    conn=(HttpURLConnection)url.openConnection();
    Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
    url=new URL(nonAuthURL.toExternalForm() + "?op=RENEWDELEGATIONTOKEN&token=" + dt);
    conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod("PUT");
    Assert.assertEquals(HttpURLConnection.HTTP_UNAUTHORIZED,conn.getResponseCode());
    url=new URL(authURL.toExternalForm() + "&op=RENEWDELEGATIONTOKEN&token=" + dt);
    conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod("PUT");
    Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
    url=new URL(getJettyURL() + "/foo/bar?authenticated=bar&op=RENEWDELEGATIONTOKEN&token=" + dt);
    conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod("PUT");
    Assert.assertEquals(HttpURLConnection.HTTP_FORBIDDEN,conn.getResponseCode());
    url=new URL(nonAuthURL.toExternalForm() + "?op=CANCELDELEGATIONTOKEN&token=" + dt);
    conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod("PUT");
    Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
    url=new URL(nonAuthURL.toExternalForm() + "?op=CANCELDELEGATIONTOKEN&token=" + dt);
    conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod("PUT");
    Assert.assertEquals(HttpURLConnection.HTTP_NOT_FOUND,conn.getResponseCode());
    url=new URL(authURL.toExternalForm() + "&op=GETDELEGATIONTOKEN&renewer=foo");
    conn=(HttpURLConnection)url.openConnection();
    Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
    mapper=new ObjectMapper();
    map=mapper.readValue(conn.getInputStream(),Map.class);
    dt=(String)((Map)map.get("Token")).get("urlString");
    Assert.assertNotNull(dt);
    url=new URL(authURL.toExternalForm() + "&op=CANCELDELEGATIONTOKEN&token=" + dt);
    conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod("PUT");
    Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
  }
  finally {
    jetty.stop();
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosDelegationTokenAuthenticator() throws Exception {
  org.apache.hadoop.conf.Configuration conf=new org.apache.hadoop.conf.Configuration();
  conf.set("hadoop.security.authentication","kerberos");
  UserGroupInformation.setConfiguration(conf);
  File testDir=new File("target/" + UUID.randomUUID().toString());
  Assert.assertTrue(testDir.mkdirs());
  MiniKdc kdc=new MiniKdc(MiniKdc.createConf(),testDir);
  final Server jetty=createJettyServer();
  Context context=new Context();
  context.setContextPath("/foo");
  jetty.setHandler(context);
  context.addFilter(new FilterHolder(KDTAFilter.class),"/*",0);
  context.addServlet(new ServletHolder(UserServlet.class),"/bar");
  try {
    kdc.start();
    File keytabFile=new File(testDir,"test.keytab");
    kdc.createPrincipal(keytabFile,"client","HTTP/localhost");
    KDTAFilter.keytabFile=keytabFile.getAbsolutePath();
    jetty.start();
    final DelegationTokenAuthenticatedURL.Token token=new DelegationTokenAuthenticatedURL.Token();
    final DelegationTokenAuthenticatedURL aUrl=new DelegationTokenAuthenticatedURL();
    final URL url=new URL(getJettyURL() + "/foo/bar");
    try {
      aUrl.getDelegationToken(url,token,FOO_USER);
      Assert.fail();
    }
 catch (    AuthenticationException ex) {
      Assert.assertTrue(ex.getMessage().contains("GSSException"));
    }
    doAsKerberosUser("client",keytabFile.getAbsolutePath(),new Callable<Void>(){
      @Override public Void call() throws Exception {
        aUrl.getDelegationToken(url,token,"client");
        Assert.assertNotNull(token.getDelegationToken());
        aUrl.renewDelegationToken(url,token);
        Assert.assertNotNull(token.getDelegationToken());
        aUrl.getDelegationToken(url,token,FOO_USER);
        Assert.assertNotNull(token.getDelegationToken());
        try {
          aUrl.renewDelegationToken(url,token);
          Assert.fail();
        }
 catch (        Exception ex) {
          Assert.assertTrue(ex.getMessage().contains("403"));
        }
        aUrl.getDelegationToken(url,token,FOO_USER);
        aUrl.cancelDelegationToken(url,token);
        Assert.assertNull(token.getDelegationToken());
        return null;
      }
    }
);
  }
  finally {
    jetty.stop();
    kdc.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFallbackToPseudoDelegationTokenAuthenticator() throws Exception {
  final Server jetty=createJettyServer();
  Context context=new Context();
  context.setContextPath("/foo");
  jetty.setHandler(context);
  context.addFilter(new FilterHolder(PseudoDTAFilter.class),"/*",0);
  context.addServlet(new ServletHolder(UserServlet.class),"/bar");
  try {
    jetty.start();
    final URL url=new URL(getJettyURL() + "/foo/bar");
    UserGroupInformation ugi=UserGroupInformation.createRemoteUser(FOO_USER);
    ugi.doAs(new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        DelegationTokenAuthenticatedURL.Token token=new DelegationTokenAuthenticatedURL.Token();
        DelegationTokenAuthenticatedURL aUrl=new DelegationTokenAuthenticatedURL();
        HttpURLConnection conn=aUrl.openConnection(url,token);
        Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
        List<String> ret=IOUtils.readLines(conn.getInputStream());
        Assert.assertEquals(1,ret.size());
        Assert.assertEquals(FOO_USER,ret.get(0));
        aUrl.getDelegationToken(url,token,FOO_USER);
        Assert.assertNotNull(token.getDelegationToken());
        Assert.assertEquals(new Text("token-kind"),token.getDelegationToken().getKind());
        return null;
      }
    }
);
  }
  finally {
    jetty.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.service.TestServiceLifecycle </h4><pre class="type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Show that if the service failed during an init
 * operation, stop was called.
 */
@Test public void testStopFailingInitAndStop() throws Throwable {
  BreakableService svc=new BreakableService(true,false,true);
  svc.registerServiceListener(new LoggingStateChangeListener());
  try {
    svc.init(new Configuration());
    fail("Expected a failure, got " + svc);
  }
 catch (  BreakableService.BrokenLifecycleEvent e) {
    assertEquals(Service.STATE.INITED,e.state);
  }
  assertServiceStateStopped(svc);
  assertEquals(Service.STATE.INITED,svc.getFailureState());
  Throwable failureCause=svc.getFailureCause();
  assertNotNull("Null failure cause in " + svc,failureCause);
  BreakableService.BrokenLifecycleEvent cause=(BreakableService.BrokenLifecycleEvent)failureCause;
  assertNotNull("null state in " + cause + " raised by "+ svc,cause.state);
  assertEquals(Service.STATE.INITED,cause.state);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.streaming.TestClassWithNoPackage </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGoodClassOrNull() throws Exception {
  String NAME="ClassWithNoPackage";
  ClassLoader cl=TestClassWithNoPackage.class.getClassLoader();
  String JAR=JarFinder.getJar(cl.loadClass(NAME));
  Configuration conf=new Configuration();
  conf.setClassLoader(new URLClassLoader(new URL[]{new URL("file",null,JAR)},null));
  String defaultPackage=this.getClass().getPackage().getName();
  Class c=StreamUtil.goodClassOrNull(conf,NAME,defaultPackage);
  assertNotNull("Class " + NAME + " not found!",c);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.test.TestHFSTestCase </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test @TestDir public void testDirAnnotation() throws Exception {
  assertNotNull(TestDirHelper.getTestDir());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.test.TestHTestCase </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test @TestDir public void testDirAnnotation() throws Exception {
  assertNotNull(TestDirHelper.getTestDir());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.TestCopyListing </h4><pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailOnCloseError() throws IOException {
  File inFile=File.createTempFile("TestCopyListingIn",null);
  inFile.deleteOnExit();
  File outFile=File.createTempFile("TestCopyListingOut",null);
  outFile.deleteOnExit();
  List<Path> srcs=new ArrayList<Path>();
  srcs.add(new Path(inFile.toURI()));
  Exception expectedEx=new IOException("boom");
  SequenceFile.Writer writer=mock(SequenceFile.Writer.class);
  doThrow(expectedEx).when(writer).close();
  SimpleCopyListing listing=new SimpleCopyListing(getConf(),CREDENTIALS);
  DistCpOptions options=new DistCpOptions(srcs,new Path(outFile.toURI()));
  Exception actualEx=null;
  try {
    listing.doBuildListing(writer,options);
  }
 catch (  Exception e) {
    actualEx=e;
  }
  Assert.assertNotNull("close writer didn't fail",actualEx);
  Assert.assertEquals(expectedEx,actualEx);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.TestOptionsParser </h4><pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLogPath(){
  DistCpOptions options=OptionsParser.parse(new String[]{"hdfs://localhost:8020/source/first","hdfs://localhost:8020/target/"});
  Assert.assertNull(options.getLogPath());
  options=OptionsParser.parse(new String[]{"-log","hdfs://localhost:8020/logs","hdfs://localhost:8020/source/first","hdfs://localhost:8020/target/"});
  Assert.assertEquals(options.getLogPath(),new Path("hdfs://localhost:8020/logs"));
}

</code></pre>

<br>
<pre class="type-2 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseWorkPath(){
  DistCpOptions options=OptionsParser.parse(new String[]{"hdfs://localhost:8020/source/first","hdfs://localhost:8020/target/"});
  Assert.assertNull(options.getAtomicWorkPath());
  options=OptionsParser.parse(new String[]{"-atomic","hdfs://localhost:8020/source/first","hdfs://localhost:8020/target/"});
  Assert.assertNull(options.getAtomicWorkPath());
  options=OptionsParser.parse(new String[]{"-atomic","-tmp","hdfs://localhost:8020/work","hdfs://localhost:8020/source/first","hdfs://localhost:8020/target/"});
  Assert.assertEquals(options.getAtomicWorkPath(),new Path("hdfs://localhost:8020/work"));
  try {
    OptionsParser.parse(new String[]{"-tmp","hdfs://localhost:8020/work","hdfs://localhost:8020/source/first","hdfs://localhost:8020/target/"});
    Assert.fail("work path was allowed without -atomic switch");
  }
 catch (  IllegalArgumentException ignore) {
  }
}

</code></pre>

<br>
<pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseSSLConf(){
  DistCpOptions options=OptionsParser.parse(new String[]{"hdfs://localhost:8020/source/first","hdfs://localhost:8020/target/"});
  Assert.assertNull(options.getSslConfigurationFile());
  options=OptionsParser.parse(new String[]{"-mapredSslConf","/tmp/ssl-client.xml","hdfs://localhost:8020/source/first","hdfs://localhost:8020/target/"});
  Assert.assertEquals(options.getSslConfigurationFile(),"/tmp/ssl-client.xml");
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptionsSwitchAddToConf(){
  Configuration conf=new Configuration();
  Assert.assertNull(conf.get(DistCpOptionSwitch.ATOMIC_COMMIT.getConfigLabel()));
  DistCpOptionSwitch.addToConf(conf,DistCpOptionSwitch.ATOMIC_COMMIT);
  Assert.assertTrue(conf.getBoolean(DistCpOptionSwitch.ATOMIC_COMMIT.getConfigLabel(),false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.tools.mapred.TestRetriableFileCopyCommand </h4><pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testFailOnCloseError() throws Exception {
  Mapper.Context context=mock(Mapper.Context.class);
  doReturn(new Configuration()).when(context).getConfiguration();
  Exception expectedEx=new IOException("boom");
  OutputStream out=mock(OutputStream.class);
  doThrow(expectedEx).when(out).close();
  File f=File.createTempFile(this.getClass().getSimpleName(),null);
  f.deleteOnExit();
  FileStatus stat=new FileStatus(1L,false,1,1024,0,new Path(f.toURI()));
  Exception actualEx=null;
  try {
    new RetriableFileCopyCommand("testFailOnCloseError",FileAction.OVERWRITE).copyBytes(stat,0,out,512,context);
  }
 catch (  Exception e) {
    actualEx=e;
  }
  assertNotNull("close didn't fail",actualEx);
  assertEquals(expectedEx,actualEx);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestApplicationClassLoader </h4><pre class="type-9 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResource() throws IOException {
  URL testJar=makeTestJar().toURI().toURL();
  ClassLoader currentClassLoader=getClass().getClassLoader();
  ClassLoader appClassloader=new ApplicationClassLoader(new URL[]{testJar},currentClassLoader,null);
  assertNull("Resource should be null for current classloader",currentClassLoader.getResourceAsStream("resource.txt"));
  InputStream in=appClassloader.getResourceAsStream("resource.txt");
  assertNotNull("Resource should not be null for app classloader",in);
  assertEquals("hello",IOUtils.toString(in));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestAsyncDiskService </h4><pre class="type-11 type-2 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test creates some ExampleTasks and runs them. 
 */
@Test public void testAsyncDiskService() throws Throwable {
  String[] vols=new String[]{"/0","/1"};
  AsyncDiskService service=new AsyncDiskService(vols);
  int total=100;
  for (int i=0; i < total; i++) {
    service.execute(vols[i % 2],new ExampleTask());
  }
  Exception e=null;
  try {
    service.execute("no_such_volume",new ExampleTask());
  }
 catch (  RuntimeException ex) {
    e=ex;
  }
  assertNotNull("Executing a task on a non-existing volume should throw an " + "Exception.",e);
  service.shutdown();
  if (!service.awaitTermination(5000)) {
    fail("AsyncDiskService didn't shutdown in 5 seconds.");
  }
  assertEquals(total,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestClassUtil </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=1000) public void testFindContainingJar(){
  String containingJar=ClassUtil.findContainingJar(Logger.class);
  Assert.assertNotNull("Containing jar not found for Logger",containingJar);
  File jarFile=new File(containingJar);
  Assert.assertTrue("Containing jar does not exist on file system",jarFile.exists());
  Assert.assertTrue("Incorrect jar file" + containingJar,jarFile.getName().matches("log4j.+[.]jar"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestIdentityHashStore </h4><pre class="type-13 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testDuplicateInserts(){
  IdentityHashStore<Key,Integer> store=new IdentityHashStore<Key,Integer>(4);
  store.visitAll(new Visitor<Key,Integer>(){
    @Override public void accept(    Key k,    Integer v){
      Assert.fail("found key " + k + " in empty IdentityHashStore.");
    }
  }
);
  Assert.assertTrue(store.isEmpty());
  Key key1=new Key("key1");
  Integer value1=new Integer(100);
  Integer value2=new Integer(200);
  Integer value3=new Integer(300);
  store.put(key1,value1);
  Key equalToKey1=new Key("key1");
  Assert.assertNull(store.get(equalToKey1));
  Assert.assertTrue(!store.isEmpty());
  Assert.assertEquals(value1,store.get(key1));
  store.put(key1,value2);
  store.put(key1,value3);
  final List<Integer> allValues=new LinkedList<Integer>();
  store.visitAll(new Visitor<Key,Integer>(){
    @Override public void accept(    Key k,    Integer v){
      allValues.add(v);
    }
  }
);
  Assert.assertEquals(3,allValues.size());
  for (int i=0; i < 3; i++) {
    Integer value=store.remove(key1);
    Assert.assertTrue(allValues.remove(value));
  }
  Assert.assertNull(store.remove(key1));
  Assert.assertTrue(store.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestJarFinder </h4><pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testExistingManifest() throws Exception {
  File dir=new File(System.getProperty("test.build.dir","target/test-dir"),TestJarFinder.class.getName() + "-testExistingManifest");
  delete(dir);
  dir.mkdirs();
  File metaInfDir=new File(dir,"META-INF");
  metaInfDir.mkdirs();
  File manifestFile=new File(metaInfDir,"MANIFEST.MF");
  Manifest manifest=new Manifest();
  OutputStream os=new FileOutputStream(manifestFile);
  manifest.write(os);
  os.close();
  File propsFile=new File(dir,"props.properties");
  Writer writer=new FileWriter(propsFile);
  new Properties().store(writer,"");
  writer.close();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream zos=new JarOutputStream(baos);
  JarFinder.jarDir(dir,"",zos);
  JarInputStream jis=new JarInputStream(new ByteArrayInputStream(baos.toByteArray()));
  Assert.assertNotNull(jis.getManifest());
  jis.close();
}

</code></pre>

<br>
<pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testNoManifest() throws Exception {
  File dir=new File(System.getProperty("test.build.dir","target/test-dir"),TestJarFinder.class.getName() + "-testNoManifest");
  delete(dir);
  dir.mkdirs();
  File propsFile=new File(dir,"props.properties");
  Writer writer=new FileWriter(propsFile);
  new Properties().store(writer,"");
  writer.close();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream zos=new JarOutputStream(baos);
  JarFinder.jarDir(dir,"",zos);
  JarInputStream jis=new JarInputStream(new ByteArrayInputStream(baos.toByteArray()));
  Assert.assertNotNull(jis.getManifest());
  jis.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestShutdownHookManager </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shutdownHookManager(){
  ShutdownHookManager mgr=ShutdownHookManager.get();
  Assert.assertNotNull(mgr);
  Assert.assertEquals(0,mgr.getShutdownHooksInOrder().size());
  Runnable hook1=new Runnable(){
    @Override public void run(){
    }
  }
;
  Runnable hook2=new Runnable(){
    @Override public void run(){
    }
  }
;
  mgr.addShutdownHook(hook1,0);
  Assert.assertTrue(mgr.hasShutdownHook(hook1));
  Assert.assertEquals(1,mgr.getShutdownHooksInOrder().size());
  Assert.assertEquals(hook1,mgr.getShutdownHooksInOrder().get(0));
  mgr.removeShutdownHook(hook1);
  Assert.assertFalse(mgr.hasShutdownHook(hook1));
  mgr.addShutdownHook(hook1,0);
  Assert.assertTrue(mgr.hasShutdownHook(hook1));
  Assert.assertEquals(1,mgr.getShutdownHooksInOrder().size());
  Assert.assertTrue(mgr.hasShutdownHook(hook1));
  Assert.assertEquals(1,mgr.getShutdownHooksInOrder().size());
  mgr.addShutdownHook(hook2,1);
  Assert.assertTrue(mgr.hasShutdownHook(hook1));
  Assert.assertTrue(mgr.hasShutdownHook(hook2));
  Assert.assertEquals(2,mgr.getShutdownHooksInOrder().size());
  Assert.assertEquals(hook2,mgr.getShutdownHooksInOrder().get(0));
  Assert.assertEquals(hook1,mgr.getShutdownHooksInOrder().get(1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.TestZKUtil </h4><pre class="type-2 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfIndirection() throws IOException {
  assertNull(ZKUtil.resolveConfIndirection(null));
  assertEquals("x",ZKUtil.resolveConfIndirection("x"));
  TEST_FILE.getParentFile().mkdirs();
  Files.write("hello world",TEST_FILE,Charsets.UTF_8);
  assertEquals("hello world",ZKUtil.resolveConfIndirection("@" + TEST_FILE.getAbsolutePath()));
  try {
    ZKUtil.resolveConfIndirection("@" + BOGUS_FILE);
    fail("Did not throw for non-existent file reference");
  }
 catch (  FileNotFoundException fnfe) {
    assertTrue(fnfe.getMessage().startsWith(BOGUS_FILE));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.bloom.TestBloomFilters </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testDynamicBloomFilter(){
  int hashId=Hash.JENKINS_HASH;
  Filter filter=new DynamicBloomFilter(bitSize,hashFunctionNumber,Hash.JENKINS_HASH,3);
  BloomFilterCommonTester.of(hashId,numInsertions).withFilterInstance(filter).withTestCases(ImmutableSet.of(BloomFilterTestStrategy.KEY_TEST_STRATEGY,BloomFilterTestStrategy.ADD_KEYS_STRATEGY,BloomFilterTestStrategy.EXCEPTIONS_CHECK_STRATEGY,BloomFilterTestStrategy.WRITE_READ_STRATEGY,BloomFilterTestStrategy.ODD_EVEN_ABSENT_STRATEGY)).test();
  assertNotNull("testDynamicBloomFilter error ",filter.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.util.hash.TestHash </h4><pre class="type-9 type-13 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHash(){
  int iterations=30;
  assertTrue("testHash jenkins error !!!",Hash.JENKINS_HASH == Hash.parseHashType("jenkins"));
  assertTrue("testHash murmur error !!!",Hash.MURMUR_HASH == Hash.parseHashType("murmur"));
  assertTrue("testHash undefined",Hash.INVALID_HASH == Hash.parseHashType("undefined"));
  Configuration cfg=new Configuration();
  cfg.set("hadoop.util.hash.type","murmur");
  assertTrue("testHash",MurmurHash.getInstance() == Hash.getInstance(cfg));
  cfg=new Configuration();
  cfg.set("hadoop.util.hash.type","jenkins");
  assertTrue("testHash jenkins configuration error !!!",JenkinsHash.getInstance() == Hash.getInstance(cfg));
  cfg=new Configuration();
  assertTrue("testHash undefine configuration error !!!",MurmurHash.getInstance() == Hash.getInstance(cfg));
  assertTrue("testHash error jenkin getInstance !!!",JenkinsHash.getInstance() == Hash.getInstance(Hash.JENKINS_HASH));
  assertTrue("testHash error murmur getInstance !!!",MurmurHash.getInstance() == Hash.getInstance(Hash.MURMUR_HASH));
  assertNull("testHash error invalid getInstance !!!",Hash.getInstance(Hash.INVALID_HASH));
  int murmurHash=Hash.getInstance(Hash.MURMUR_HASH).hash(LINE.getBytes());
  for (int i=0; i < iterations; i++) {
    assertTrue("multiple evaluation murmur hash error !!!",murmurHash == Hash.getInstance(Hash.MURMUR_HASH).hash(LINE.getBytes()));
  }
  murmurHash=Hash.getInstance(Hash.MURMUR_HASH).hash(LINE.getBytes(),67);
  for (int i=0; i < iterations; i++) {
    assertTrue("multiple evaluation murmur hash error !!!",murmurHash == Hash.getInstance(Hash.MURMUR_HASH).hash(LINE.getBytes(),67));
  }
  int jenkinsHash=Hash.getInstance(Hash.JENKINS_HASH).hash(LINE.getBytes());
  for (int i=0; i < iterations; i++) {
    assertTrue("multiple evaluation jenkins hash error !!!",jenkinsHash == Hash.getInstance(Hash.JENKINS_HASH).hash(LINE.getBytes()));
  }
  jenkinsHash=Hash.getInstance(Hash.JENKINS_HASH).hash(LINE.getBytes(),67);
  for (int i=0; i < iterations; i++) {
    assertTrue("multiple evaluation jenkins hash error !!!",jenkinsHash == Hash.getInstance(Hash.JENKINS_HASH).hash(LINE.getBytes(),67));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.TestResourceTrackerPBClientImpl </h4><pre class="type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the method registerNodeManager. Method should return a not null
 * result.
 */
@Test public void testResourceTrackerPBClientImpl() throws Exception {
  RegisterNodeManagerRequest request=recordFactory.newRecordInstance(RegisterNodeManagerRequest.class);
  assertNotNull(client.registerNodeManager(request));
  ResourceTrackerTestImpl.exception=true;
  try {
    client.registerNodeManager(request);
    fail("there  should be YarnException");
  }
 catch (  YarnException e) {
    assertTrue(e.getMessage().startsWith("testMessage"));
  }
 finally {
    ResourceTrackerTestImpl.exception=false;
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the method nodeHeartbeat. Method should return a not null result.
 */
@Test public void testNodeHeartbeat() throws Exception {
  NodeHeartbeatRequest request=recordFactory.newRecordInstance(NodeHeartbeatRequest.class);
  assertNotNull(client.nodeHeartbeat(request));
  ResourceTrackerTestImpl.exception=true;
  try {
    client.nodeHeartbeat(request);
    fail("there  should be YarnException");
  }
 catch (  YarnException e) {
    assertTrue(e.getMessage().startsWith("testMessage"));
  }
 finally {
    ResourceTrackerTestImpl.exception=false;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.api.TestApplicatonReport </h4><pre class="type-9 type-7 type-19 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationReport(){
  long timestamp=System.currentTimeMillis();
  ApplicationReport appReport1=createApplicationReport(1,1,timestamp);
  ApplicationReport appReport2=createApplicationReport(1,1,timestamp);
  ApplicationReport appReport3=createApplicationReport(1,1,timestamp);
  Assert.assertEquals(appReport1,appReport2);
  Assert.assertEquals(appReport2,appReport3);
  appReport1.setApplicationId(null);
  Assert.assertNull(appReport1.getApplicationId());
  Assert.assertNotSame(appReport1,appReport2);
  appReport2.setCurrentApplicationAttemptId(null);
  Assert.assertNull(appReport2.getCurrentApplicationAttemptId());
  Assert.assertNotSame(appReport2,appReport3);
  Assert.assertNull(appReport1.getAMRMToken());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.api.TestContainerResourceDecrease </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testResourceDecreaseContextWithNull(){
  ContainerResourceDecrease ctx=ContainerResourceDecrease.newInstance(null,null);
  ContainerResourceDecreaseProto proto=((ContainerResourceDecreasePBImpl)ctx).getProto();
  ctx=new ContainerResourceDecreasePBImpl(proto);
  Assert.assertNull(ctx.getCapability());
  Assert.assertNull(ctx.getContainerId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.api.TestContainerResourceIncrease </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testResourceIncreaseContextWithNull(){
  ContainerResourceIncrease ctx=ContainerResourceIncrease.newInstance(null,null,null);
  ContainerResourceIncreaseProto proto=((ContainerResourceIncreasePBImpl)ctx).getProto();
  ctx=new ContainerResourceIncreasePBImpl(proto);
  Assert.assertNull(ctx.getContainerToken());
  Assert.assertNull(ctx.getCapability());
  Assert.assertNull(ctx.getContainerId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.api.TestContainerResourceIncreaseRequest </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testResourceChangeContextWithNullField(){
  ContainerResourceIncreaseRequest context=ContainerResourceIncreaseRequest.newInstance(null,null);
  ContainerResourceIncreaseRequestProto proto=((ContainerResourceIncreaseRequestPBImpl)context).getProto();
  ContainerResourceIncreaseRequest contextRecover=new ContainerResourceIncreaseRequestPBImpl(proto);
  Assert.assertNull(contextRecover.getContainerId());
  Assert.assertNull(contextRecover.getCapability());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.api.records.impl.pb.TestSerializedExceptionPBImpl </h4><pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBeforeInit() throws Exception {
  SerializedExceptionProto defaultProto=SerializedExceptionProto.newBuilder().build();
  SerializedExceptionPBImpl pb1=new SerializedExceptionPBImpl();
  Assert.assertNull(pb1.getCause());
  SerializedExceptionPBImpl pb2=new SerializedExceptionPBImpl();
  Assert.assertEquals(defaultProto,pb2.getProto());
  SerializedExceptionPBImpl pb3=new SerializedExceptionPBImpl();
  Assert.assertEquals(defaultProto.getTrace(),pb3.getRemoteTrace());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.applications.distributedshell.TestDistributedShell </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=90000) public void testDSShell() throws Exception {
  String[] args={"--jar",APPMASTER_JAR,"--num_containers","2","--shell_command",Shell.WINDOWS ? "dir" : "ls","--master_memory","512","--master_vcores","2","--container_memory","128","--container_vcores","1"};
  LOG.info("Initializing DS Client");
  final Client client=new Client(new Configuration(yarnCluster.getConfig()));
  boolean initSuccess=client.init(args);
  Assert.assertTrue(initSuccess);
  LOG.info("Running DS Client");
  final AtomicBoolean result=new AtomicBoolean(false);
  Thread t=new Thread(){
    public void run(){
      try {
        result.set(client.run());
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
;
  t.start();
  YarnClient yarnClient=YarnClient.createYarnClient();
  yarnClient.init(new Configuration(yarnCluster.getConfig()));
  yarnClient.start();
  String hostName=NetUtils.getHostname();
  boolean verified=false;
  String errorMessage="";
  while (!verified) {
    List<ApplicationReport> apps=yarnClient.getApplications();
    if (apps.size() == 0) {
      Thread.sleep(10);
      continue;
    }
    ApplicationReport appReport=apps.get(0);
    if (appReport.getHost().equals("N/A")) {
      Thread.sleep(10);
      continue;
    }
    errorMessage="Expected host name to start with '" + hostName + "', was '"+ appReport.getHost()+ "'. Expected rpc port to be '-1', was '"+ appReport.getRpcPort()+ "'.";
    if (checkHostname(appReport.getHost()) && appReport.getRpcPort() == -1) {
      verified=true;
    }
    if (appReport.getYarnApplicationState() == YarnApplicationState.FINISHED) {
      break;
    }
  }
  Assert.assertTrue(errorMessage,verified);
  t.join();
  LOG.info("Client run completed. Result=" + result);
  Assert.assertTrue(result.get());
  TimelineEntities entitiesAttempts=yarnCluster.getApplicationHistoryServer().getTimelineStore().getEntities(ApplicationMaster.DSEntity.DS_APP_ATTEMPT.toString(),null,null,null,null,null,null,null,null);
  Assert.assertNotNull(entitiesAttempts);
  Assert.assertEquals(1,entitiesAttempts.getEntities().size());
  Assert.assertEquals(2,entitiesAttempts.getEntities().get(0).getEvents().size());
  Assert.assertEquals(entitiesAttempts.getEntities().get(0).getEntityType().toString(),ApplicationMaster.DSEntity.DS_APP_ATTEMPT.toString());
  TimelineEntities entities=yarnCluster.getApplicationHistoryServer().getTimelineStore().getEntities(ApplicationMaster.DSEntity.DS_CONTAINER.toString(),null,null,null,null,null,null,null,null);
  Assert.assertNotNull(entities);
  Assert.assertEquals(2,entities.getEntities().size());
  Assert.assertEquals(entities.getEntities().get(0).getEntityType().toString(),ApplicationMaster.DSEntity.DS_CONTAINER.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.TestResourceManagerAdministrationProtocolPBClientImpl </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test method refreshAdminAcls. This method is present and it works.
 */
@Test public void testRefreshAdminAcls() throws Exception {
  RefreshAdminAclsRequest request=recordFactory.newRecordInstance(RefreshAdminAclsRequest.class);
  RefreshAdminAclsResponse response=client.refreshAdminAcls(request);
  assertNotNull(response);
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test method refreshSuperUserGroupsConfiguration. This method present and it works.
 */
@Test public void testRefreshSuperUserGroupsConfiguration() throws Exception {
  RefreshSuperUserGroupsConfigurationRequest request=recordFactory.newRecordInstance(RefreshSuperUserGroupsConfigurationRequest.class);
  RefreshSuperUserGroupsConfigurationResponse response=client.refreshSuperUserGroupsConfiguration(request);
  assertNotNull(response);
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testUpdateNodeResource() throws Exception {
  UpdateNodeResourceRequest request=recordFactory.newRecordInstance(UpdateNodeResourceRequest.class);
  UpdateNodeResourceResponse response=client.updateNodeResource(request);
  assertNotNull(response);
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test method refreshUserToGroupsMappings. This method is present and it works.
 */
@Test public void testRefreshUserToGroupsMappings() throws Exception {
  RefreshUserToGroupsMappingsRequest request=recordFactory.newRecordInstance(RefreshUserToGroupsMappingsRequest.class);
  RefreshUserToGroupsMappingsResponse response=client.refreshUserToGroupsMappings(request);
  assertNotNull(response);
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test method refreshQueues. This method is present and it works.
 */
@Test public void testRefreshQueues() throws Exception {
  RefreshQueuesRequest request=recordFactory.newRecordInstance(RefreshQueuesRequest.class);
  RefreshQueuesResponse response=client.refreshQueues(request);
  assertNotNull(response);
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRefreshServiceAcls() throws Exception {
  RefreshServiceAclsRequest request=recordFactory.newRecordInstance(RefreshServiceAclsRequest.class);
  RefreshServiceAclsResponse response=client.refreshServiceAcls(request);
  assertNotNull(response);
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Test method refreshNodes. This method is present and it works.
 */
@Test public void testRefreshNodes() throws Exception {
  resourceManager.getClientRMService();
  RefreshNodesRequest request=recordFactory.newRecordInstance(RefreshNodesRequest.class);
  RefreshNodesResponse response=client.refreshNodes(request);
  assertNotNull(response);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.TestYarnApiClasses </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test CancelDelegationTokenRequestPBImpl.
 * Test a transformation to prototype and back
 */
@Test public void testCancelDelegationTokenRequestPBImpl(){
  Token token=getDelegationToken();
  CancelDelegationTokenRequestPBImpl original=new CancelDelegationTokenRequestPBImpl();
  original.setDelegationToken(token);
  CancelDelegationTokenRequestProto protoType=original.getProto();
  CancelDelegationTokenRequestPBImpl copy=new CancelDelegationTokenRequestPBImpl(protoType);
  assertNotNull(copy.getDelegationToken());
  assertEquals(token,copy.getDelegationToken());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test RenewDelegationTokenRequestPBImpl.
 * Test a transformation to prototype and back
 */
@Test public void testRenewDelegationTokenRequestPBImpl(){
  Token token=getDelegationToken();
  RenewDelegationTokenRequestPBImpl original=new RenewDelegationTokenRequestPBImpl();
  original.setDelegationToken(token);
  RenewDelegationTokenRequestProto protoType=original.getProto();
  RenewDelegationTokenRequestPBImpl copy=new RenewDelegationTokenRequestPBImpl(protoType);
  assertNotNull(copy.getDelegationToken());
  assertEquals(token,copy.getDelegationToken());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.api.impl.TestAHSClient </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testGetApplicationAttempts() throws YarnException, IOException {
  Configuration conf=new Configuration();
  final AHSClient client=new MockAHSClient();
  client.init(conf);
  client.start();
  ApplicationId applicationId=ApplicationId.newInstance(1234,5);
  List<ApplicationAttemptReport> reports=client.getApplicationAttempts(applicationId);
  Assert.assertNotNull(reports);
  Assert.assertEquals(reports.get(0).getApplicationAttemptId(),ApplicationAttemptId.newInstance(applicationId,1));
  Assert.assertEquals(reports.get(1).getApplicationAttemptId(),ApplicationAttemptId.newInstance(applicationId,2));
  client.stop();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testGetApplicationAttempt() throws YarnException, IOException {
  Configuration conf=new Configuration();
  final AHSClient client=new MockAHSClient();
  client.init(conf);
  client.start();
  List<ApplicationReport> expectedReports=((MockAHSClient)client).getReports();
  ApplicationId applicationId=ApplicationId.newInstance(1234,5);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(applicationId,1);
  ApplicationAttemptReport report=client.getApplicationAttemptReport(appAttemptId);
  Assert.assertNotNull(report);
  Assert.assertEquals(report.getApplicationAttemptId().toString(),expectedReports.get(0).getCurrentApplicationAttemptId().toString());
  client.stop();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testGetContainerReport() throws YarnException, IOException {
  Configuration conf=new Configuration();
  final AHSClient client=new MockAHSClient();
  client.init(conf);
  client.start();
  List<ApplicationReport> expectedReports=((MockAHSClient)client).getReports();
  ApplicationId applicationId=ApplicationId.newInstance(1234,5);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(applicationId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  ContainerReport report=client.getContainerReport(containerId);
  Assert.assertNotNull(report);
  Assert.assertEquals(report.getContainerId().toString(),(ContainerId.newInstance(expectedReports.get(0).getCurrentApplicationAttemptId(),1)).toString());
  client.stop();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testGetContainers() throws YarnException, IOException {
  Configuration conf=new Configuration();
  final AHSClient client=new MockAHSClient();
  client.init(conf);
  client.start();
  ApplicationId applicationId=ApplicationId.newInstance(1234,5);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(applicationId,1);
  List<ContainerReport> reports=client.getContainers(appAttemptId);
  Assert.assertNotNull(reports);
  Assert.assertEquals(reports.get(0).getContainerId(),(ContainerId.newInstance(appAttemptId,1)));
  Assert.assertEquals(reports.get(1).getContainerId(),(ContainerId.newInstance(appAttemptId,2)));
  client.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.api.impl.TestAMRMClient </h4><pre class="type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testAMRMClientOnAMRMTokenRollOver() throws YarnException, IOException {
  AMRMClient<ContainerRequest> amClient=null;
  try {
    AMRMTokenSecretManager amrmTokenSecretManager=yarnCluster.getResourceManager().getRMContext().getAMRMTokenSecretManager();
    amClient=AMRMClient.<ContainerRequest>createAMRMClient();
    amClient.init(conf);
    amClient.start();
    Long startTime=System.currentTimeMillis();
    amClient.registerApplicationMaster("Host",10000,"");
    org.apache.hadoop.security.token.Token<AMRMTokenIdentifier> amrmToken_1=getAMRMToken();
    Assert.assertNotNull(amrmToken_1);
    Assert.assertEquals(amrmToken_1.decodeIdentifier().getKeyId(),amrmTokenSecretManager.getMasterKey().getMasterKey().getKeyId());
    while (System.currentTimeMillis() - startTime < rolling_interval_sec * 1000) {
      amClient.allocate(0.1f);
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
    }
    amClient.allocate(0.1f);
    org.apache.hadoop.security.token.Token<AMRMTokenIdentifier> amrmToken_2=getAMRMToken();
    Assert.assertNotNull(amrmToken_2);
    Assert.assertEquals(amrmToken_2.decodeIdentifier().getKeyId(),amrmTokenSecretManager.getMasterKey().getMasterKey().getKeyId());
    Assert.assertNotEquals(amrmToken_1,amrmToken_2);
    amClient.allocate(0.1f);
    while (true) {
      if (amrmToken_2.decodeIdentifier().getKeyId() != amrmTokenSecretManager.getCurrnetMasterKeyData().getMasterKey().getKeyId()) {
        if (amrmTokenSecretManager.getNextMasterKeyData() == null) {
          break;
        }
 else         if (amrmToken_2.decodeIdentifier().getKeyId() != amrmTokenSecretManager.getNextMasterKeyData().getMasterKey().getKeyId()) {
          break;
        }
      }
      amClient.allocate(0.1f);
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e) {
      }
    }
    try {
      UserGroupInformation testUser=UserGroupInformation.createRemoteUser("testUser");
      SecurityUtil.setTokenService(amrmToken_2,yarnCluster.getResourceManager().getApplicationMasterService().getBindAddress());
      testUser.addToken(amrmToken_2);
      testUser.doAs(new PrivilegedAction<ApplicationMasterProtocol>(){
        @Override public ApplicationMasterProtocol run(){
          return (ApplicationMasterProtocol)YarnRPC.create(conf).getProxy(ApplicationMasterProtocol.class,yarnCluster.getResourceManager().getApplicationMasterService().getBindAddress(),conf);
        }
      }
).allocate(Records.newRecord(AllocateRequest.class));
      Assert.fail("The old Token should not work");
    }
 catch (    Exception ex) {
      Assert.assertTrue(ex instanceof InvalidToken);
      Assert.assertTrue(ex.getMessage().contains("Invalid AMRMToken from " + amrmToken_2.decodeIdentifier().getApplicationAttemptId()));
    }
    amClient.unregisterApplicationMaster(FinalApplicationStatus.SUCCEEDED,null,null);
  }
  finally {
    if (amClient != null && amClient.getServiceState() == STATE.STARTED) {
      amClient.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.api.impl.TestNMClient </h4><pre class="type-11 type-8 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws YarnException, IOException {
  conf=new YarnConfiguration();
  yarnCluster=new MiniYARNCluster(TestAMRMClient.class.getName(),nodeCount,1,1);
  yarnCluster.init(conf);
  yarnCluster.start();
  assertNotNull(yarnCluster);
  assertEquals(STATE.STARTED,yarnCluster.getServiceState());
  yarnClient=(YarnClientImpl)YarnClient.createYarnClient();
  yarnClient.init(conf);
  yarnClient.start();
  assertNotNull(yarnClient);
  assertEquals(STATE.STARTED,yarnClient.getServiceState());
  nodeReports=yarnClient.getNodeReports(NodeState.RUNNING);
  ApplicationSubmissionContext appContext=yarnClient.createApplication().getApplicationSubmissionContext();
  ApplicationId appId=appContext.getApplicationId();
  appContext.setApplicationName("Test");
  Priority pri=Priority.newInstance(0);
  appContext.setPriority(pri);
  appContext.setQueue("default");
  ContainerLaunchContext amContainer=Records.newRecord(ContainerLaunchContext.class);
  appContext.setAMContainerSpec(amContainer);
  appContext.setUnmanagedAM(true);
  SubmitApplicationRequest appRequest=Records.newRecord(SubmitApplicationRequest.class);
  appRequest.setApplicationSubmissionContext(appContext);
  yarnClient.submitApplication(appContext);
  int iterationsLeft=30;
  RMAppAttempt appAttempt=null;
  while (iterationsLeft > 0) {
    ApplicationReport appReport=yarnClient.getApplicationReport(appId);
    if (appReport.getYarnApplicationState() == YarnApplicationState.ACCEPTED) {
      attemptId=appReport.getCurrentApplicationAttemptId();
      appAttempt=yarnCluster.getResourceManager().getRMContext().getRMApps().get(attemptId.getApplicationId()).getCurrentAppAttempt();
      while (true) {
        if (appAttempt.getAppAttemptState() == RMAppAttemptState.LAUNCHED) {
          break;
        }
      }
      break;
    }
    sleep(1000);
    --iterationsLeft;
  }
  if (iterationsLeft == 0) {
    fail("Application hasn't bee started");
  }
  UserGroupInformation.setLoginUser(UserGroupInformation.createRemoteUser(UserGroupInformation.getCurrentUser().getUserName()));
  UserGroupInformation.getCurrentUser().addToken(appAttempt.getAMRMToken());
  nmTokenCache=new NMTokenCache();
  rmClient=(AMRMClientImpl<ContainerRequest>)AMRMClient.<ContainerRequest>createAMRMClient();
  rmClient.setNMTokenCache(nmTokenCache);
  rmClient.init(conf);
  rmClient.start();
  assertNotNull(rmClient);
  assertEquals(STATE.STARTED,rmClient.getServiceState());
  nmClient=(NMClientImpl)NMClient.createNMClient();
  nmClient.setNMTokenCache(rmClient.getNMTokenCache());
  nmClient.init(conf);
  nmClient.start();
  assertNotNull(nmClient);
  assertEquals(STATE.STARTED,nmClient.getServiceState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.client.api.impl.TestYarnClient </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testGetApplicationAttempts() throws YarnException, IOException {
  Configuration conf=new Configuration();
  final YarnClient client=new MockYarnClient();
  client.init(conf);
  client.start();
  ApplicationId applicationId=ApplicationId.newInstance(1234,5);
  List<ApplicationAttemptReport> reports=client.getApplicationAttempts(applicationId);
  Assert.assertNotNull(reports);
  Assert.assertEquals(reports.get(0).getApplicationAttemptId(),ApplicationAttemptId.newInstance(applicationId,1));
  Assert.assertEquals(reports.get(1).getApplicationAttemptId(),ApplicationAttemptId.newInstance(applicationId,2));
  client.stop();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testGetContainers() throws YarnException, IOException {
  Configuration conf=new Configuration();
  final YarnClient client=new MockYarnClient();
  client.init(conf);
  client.start();
  ApplicationId applicationId=ApplicationId.newInstance(1234,5);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(applicationId,1);
  List<ContainerReport> reports=client.getContainers(appAttemptId);
  Assert.assertNotNull(reports);
  Assert.assertEquals(reports.get(0).getContainerId(),(ContainerId.newInstance(appAttemptId,1)));
  Assert.assertEquals(reports.get(1).getContainerId(),(ContainerId.newInstance(appAttemptId,2)));
  client.stop();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testAMMRTokens() throws Exception {
  MiniYARNCluster cluster=new MiniYARNCluster("testMRAMTokens",1,1,1);
  YarnClient rmClient=null;
  try {
    cluster.init(new YarnConfiguration());
    cluster.start();
    final Configuration yarnConf=cluster.getConfig();
    rmClient=YarnClient.createYarnClient();
    rmClient.init(yarnConf);
    rmClient.start();
    ApplicationId appId=createApp(rmClient,false);
    waitTillAccepted(rmClient,appId);
    Assert.assertNull(rmClient.getAMRMToken(appId));
    appId=createApp(rmClient,true);
    waitTillAccepted(rmClient,appId);
    long start=System.currentTimeMillis();
    while (rmClient.getAMRMToken(appId) == null) {
      if (System.currentTimeMillis() - start > 20 * 1000) {
        Assert.fail("AMRM token is null");
      }
      Thread.sleep(100);
    }
    Assert.assertNotNull(rmClient.getAMRMToken(appId));
    UserGroupInformation other=UserGroupInformation.createUserForTesting("foo",new String[]{});
    appId=other.doAs(new PrivilegedExceptionAction<ApplicationId>(){
      @Override public ApplicationId run() throws Exception {
        YarnClient rmClient=YarnClient.createYarnClient();
        rmClient.init(yarnConf);
        rmClient.start();
        ApplicationId appId=createApp(rmClient,true);
        waitTillAccepted(rmClient,appId);
        long start=System.currentTimeMillis();
        while (rmClient.getAMRMToken(appId) == null) {
          if (System.currentTimeMillis() - start > 20 * 1000) {
            Assert.fail("AMRM token is null");
          }
          Thread.sleep(100);
        }
        Assert.assertNotNull(rmClient.getAMRMToken(appId));
        return appId;
      }
    }
);
    Assert.assertNull(rmClient.getAMRMToken(appId));
  }
  finally {
    if (rmClient != null) {
      rmClient.stop();
    }
    cluster.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testGetApplicationAttempt() throws YarnException, IOException {
  Configuration conf=new Configuration();
  final YarnClient client=new MockYarnClient();
  client.init(conf);
  client.start();
  List<ApplicationReport> expectedReports=((MockYarnClient)client).getReports();
  ApplicationId applicationId=ApplicationId.newInstance(1234,5);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(applicationId,1);
  ApplicationAttemptReport report=client.getApplicationAttemptReport(appAttemptId);
  Assert.assertNotNull(report);
  Assert.assertEquals(report.getApplicationAttemptId().toString(),expectedReports.get(0).getCurrentApplicationAttemptId().toString());
  client.stop();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testGetContainerReport() throws YarnException, IOException {
  Configuration conf=new Configuration();
  final YarnClient client=new MockYarnClient();
  client.init(conf);
  client.start();
  List<ApplicationReport> expectedReports=((MockYarnClient)client).getReports();
  ApplicationId applicationId=ApplicationId.newInstance(1234,5);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(applicationId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  ContainerReport report=client.getContainerReport(containerId);
  Assert.assertNotNull(report);
  Assert.assertEquals(report.getContainerId().toString(),(ContainerId.newInstance(expectedReports.get(0).getCurrentApplicationAttemptId(),1)).toString());
  client.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.conf.TestHAUtil </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRMId() throws Exception {
  conf.set(YarnConfiguration.RM_HA_ID,RM1_NODE_ID);
  assertEquals("Does not honor " + YarnConfiguration.RM_HA_ID,RM1_NODE_ID,HAUtil.getRMHAId(conf));
  conf.clear();
  assertNull("Return null when " + YarnConfiguration.RM_HA_ID + " is not set",HAUtil.getRMHAId(conf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.api.protocolrecords.TestRegisterNodeManagerResponse </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoundTrip() throws Exception {
  RegisterNodeManagerResponse resp=recordFactory.newRecordInstance(RegisterNodeManagerResponse.class);
  byte b[]={0,1,2,3,4,5};
  MasterKey containerTokenMK=recordFactory.newRecordInstance(MasterKey.class);
  containerTokenMK.setKeyId(54321);
  containerTokenMK.setBytes(ByteBuffer.wrap(b));
  resp.setContainerTokenMasterKey(containerTokenMK);
  MasterKey nmTokenMK=recordFactory.newRecordInstance(MasterKey.class);
  nmTokenMK.setKeyId(12345);
  nmTokenMK.setBytes(ByteBuffer.wrap(b));
  resp.setNMTokenMasterKey(nmTokenMK);
  resp.setNodeAction(NodeAction.NORMAL);
  assertEquals(NodeAction.NORMAL,resp.getNodeAction());
  assertNotNull(resp.getContainerTokenMasterKey());
  assertEquals(54321,resp.getContainerTokenMasterKey().getKeyId());
  assertArrayEquals(b,resp.getContainerTokenMasterKey().getBytes().array());
  RegisterNodeManagerResponse respCopy=serDe(resp);
  assertEquals(NodeAction.NORMAL,respCopy.getNodeAction());
  assertNotNull(respCopy.getContainerTokenMasterKey());
  assertEquals(54321,respCopy.getContainerTokenMasterKey().getKeyId());
  assertArrayEquals(b,respCopy.getContainerTokenMasterKey().getBytes().array());
  assertNotNull(resp.getNMTokenMasterKey());
  assertEquals(12345,resp.getNMTokenMasterKey().getKeyId());
  assertArrayEquals(b,resp.getNMTokenMasterKey().getBytes().array());
  respCopy=serDe(resp);
  assertEquals(NodeAction.NORMAL,respCopy.getNodeAction());
  assertNotNull(respCopy.getNMTokenMasterKey());
  assertEquals(12345,respCopy.getNMTokenMasterKey().getKeyId());
  assertArrayEquals(b,respCopy.getNMTokenMasterKey().getBytes().array());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestApplicationHistoryClientService </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplications() throws IOException, YarnException {
  ApplicationId appId=null;
  appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  ApplicationId appId1=ApplicationId.newInstance(0,2);
  writeApplicationStartData(appId1);
  writeApplicationFinishData(appId1);
  GetApplicationsRequest request=GetApplicationsRequest.newInstance();
  GetApplicationsResponse response=historyServer.getClientService().getClientHandler().getApplications(request);
  List<ApplicationReport> appReport=response.getApplicationList();
  Assert.assertNotNull(appReport);
  Assert.assertEquals(appId,appReport.get(0).getApplicationId());
  Assert.assertEquals(appId1,appReport.get(1).getApplicationId());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainers() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  ContainerId containerId1=ContainerId.newInstance(appAttemptId,2);
  writeContainerStartData(containerId);
  writeContainerFinishData(containerId);
  writeContainerStartData(containerId1);
  writeContainerFinishData(containerId1);
  writeApplicationFinishData(appId);
  GetContainersRequest request=GetContainersRequest.newInstance(appAttemptId);
  GetContainersResponse response=historyServer.getClientService().getClientHandler().getContainers(request);
  List<ContainerReport> containers=response.getContainerList();
  Assert.assertNotNull(containers);
  Assert.assertEquals(containerId,containers.get(1).getContainerId());
  Assert.assertEquals(containerId1,containers.get(0).getContainerId());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationAttemptReport() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  writeApplicationAttemptStartData(appAttemptId);
  writeApplicationAttemptFinishData(appAttemptId);
  GetApplicationAttemptReportRequest request=GetApplicationAttemptReportRequest.newInstance(appAttemptId);
  GetApplicationAttemptReportResponse response=historyServer.getClientService().getClientHandler().getApplicationAttemptReport(request);
  ApplicationAttemptReport attemptReport=response.getApplicationAttemptReport();
  Assert.assertNotNull(attemptReport);
  Assert.assertEquals("appattempt_0_0001_000001",attemptReport.getApplicationAttemptId().toString());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationAttempts() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ApplicationAttemptId appAttemptId1=ApplicationAttemptId.newInstance(appId,2);
  writeApplicationAttemptStartData(appAttemptId);
  writeApplicationAttemptFinishData(appAttemptId);
  writeApplicationAttemptStartData(appAttemptId1);
  writeApplicationAttemptFinishData(appAttemptId1);
  GetApplicationAttemptsRequest request=GetApplicationAttemptsRequest.newInstance(appId);
  GetApplicationAttemptsResponse response=historyServer.getClientService().getClientHandler().getApplicationAttempts(request);
  List<ApplicationAttemptReport> attemptReports=response.getApplicationAttemptList();
  Assert.assertNotNull(attemptReports);
  Assert.assertEquals(appAttemptId,attemptReports.get(0).getApplicationAttemptId());
  Assert.assertEquals(appAttemptId1,attemptReports.get(1).getApplicationAttemptId());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationReport() throws IOException, YarnException {
  ApplicationId appId=null;
  appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  GetApplicationReportRequest request=GetApplicationReportRequest.newInstance(appId);
  GetApplicationReportResponse response=historyServer.getClientService().getClientHandler().getApplicationReport(request);
  ApplicationReport appReport=response.getApplicationReport();
  Assert.assertNotNull(appReport);
  Assert.assertEquals("application_0_0001",appReport.getApplicationId().toString());
  Assert.assertEquals("test type",appReport.getApplicationType().toString());
  Assert.assertEquals("test queue",appReport.getQueue().toString());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerReport() throws IOException, YarnException {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  writeContainerStartData(containerId);
  writeContainerFinishData(containerId);
  writeApplicationFinishData(appId);
  GetContainerReportRequest request=GetContainerReportRequest.newInstance(containerId);
  GetContainerReportResponse response=historyServer.getClientService().getClientHandler().getContainerReport(request);
  ContainerReport container=response.getContainerReport();
  Assert.assertNotNull(container);
  Assert.assertEquals(containerId,container.getContainerId());
  Assert.assertEquals(expectedLogUrl,container.getLogUrl());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestApplicationHistoryManagerImpl </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationReport() throws IOException, YarnException {
  ApplicationId appId=null;
  appId=ApplicationId.newInstance(0,1);
  writeApplicationStartData(appId);
  writeApplicationFinishData(appId);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  writeApplicationAttemptStartData(appAttemptId);
  writeApplicationAttemptFinishData(appAttemptId);
  ApplicationReport appReport=applicationHistoryManagerImpl.getApplication(appId);
  Assert.assertNotNull(appReport);
  Assert.assertEquals(appId,appReport.getApplicationId());
  Assert.assertEquals(appAttemptId,appReport.getCurrentApplicationAttemptId());
  Assert.assertEquals(appAttemptId.toString(),appReport.getHost());
  Assert.assertEquals("test type",appReport.getApplicationType().toString());
  Assert.assertEquals("test queue",appReport.getQueue().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestApplicationHistoryServer </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=50000) public void testStartStopServer() throws Exception {
  historyServer=new ApplicationHistoryServer();
  Configuration config=new YarnConfiguration();
  historyServer.init(config);
  assertEquals(STATE.INITED,historyServer.getServiceState());
  assertEquals(4,historyServer.getServices().size());
  ApplicationHistoryClientService historyService=historyServer.getClientService();
  assertNotNull(historyServer.getClientService());
  assertEquals(STATE.INITED,historyService.getServiceState());
  historyServer.start();
  assertEquals(STATE.STARTED,historyServer.getServiceState());
  assertEquals(STATE.STARTED,historyService.getServiceState());
  historyServer.stop();
  assertEquals(STATE.STOPPED,historyServer.getServiceState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.applicationhistoryservice.TestMemoryApplicationHistoryStore </h4><pre class="type-9 type-13 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationAttemptHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numAppAttempts=5;
  writeApplicationStartData(appId);
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    writeApplicationAttemptStartData(appAttemptId);
    writeApplicationAttemptFinishData(appAttemptId);
  }
  Assert.assertEquals(numAppAttempts,store.getApplicationAttempts(appId).size());
  for (int i=1; i <= numAppAttempts; ++i) {
    appAttemptId=ApplicationAttemptId.newInstance(appId,i);
    ApplicationAttemptHistoryData data=store.getApplicationAttempt(appAttemptId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appAttemptId.toString(),data.getHost());
    Assert.assertEquals(appAttemptId.toString(),data.getDiagnosticsInfo());
  }
  writeApplicationFinishData(appId);
  appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  try {
    writeApplicationAttemptStartData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationAttemptFinishData(appAttemptId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteApplicationHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  int numApps=5;
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    writeApplicationStartData(appId);
    writeApplicationFinishData(appId);
  }
  Assert.assertEquals(numApps,store.getAllApplications().size());
  for (int i=1; i <= numApps; ++i) {
    appId=ApplicationId.newInstance(0,i);
    ApplicationHistoryData data=store.getApplication(appId);
    Assert.assertNotNull(data);
    Assert.assertEquals(appId.toString(),data.getApplicationName());
    Assert.assertEquals(appId.toString(),data.getDiagnosticsInfo());
  }
  appId=ApplicationId.newInstance(0,1);
  try {
    writeApplicationStartData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeApplicationFinishData(appId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteContainerHistory() throws Exception {
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is stored before the start information"));
  }
  writeApplicationAttemptStartData(appAttemptId);
  int numContainers=5;
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    writeContainerStartData(containerId);
    writeContainerFinishData(containerId);
  }
  Assert.assertEquals(numContainers,store.getContainers(appAttemptId).size());
  for (int i=1; i <= numContainers; ++i) {
    containerId=ContainerId.newInstance(appAttemptId,i);
    ContainerHistoryData data=store.getContainer(containerId);
    Assert.assertNotNull(data);
    Assert.assertEquals(Priority.newInstance(containerId.getId()),data.getPriority());
    Assert.assertEquals(containerId.toString(),data.getDiagnosticsInfo());
  }
  ContainerHistoryData masterContainer=store.getAMContainer(appAttemptId);
  Assert.assertNotNull(masterContainer);
  Assert.assertEquals(ContainerId.newInstance(appAttemptId,1),masterContainer.getContainerId());
  writeApplicationAttemptFinishData(appAttemptId);
  containerId=ContainerId.newInstance(appAttemptId,1);
  try {
    writeContainerStartData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
  try {
    writeContainerFinishData(containerId);
    Assert.fail();
  }
 catch (  IOException e) {
    Assert.assertTrue(e.getMessage().contains("is already stored"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.TestLinuxContainerExecutor </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerKill() throws Exception {
  if (!shouldRun()) {
    return;
  }
  final ContainerId sleepId=getNextContainerId();
  Thread t=new Thread(){
    public void run(){
      try {
        runAndBlock(sleepId,"sleep","100");
      }
 catch (      IOException e) {
        LOG.warn("Caught exception while running sleep",e);
      }
    }
  }
;
  t.setDaemon(true);
  t.start();
  assertTrue(t.isAlive());
  String pid=null;
  int count=10;
  while ((pid=exec.getProcessId(sleepId)) == null && count > 0) {
    LOG.info("Sleeping for 200 ms before checking for pid ");
    Thread.sleep(200);
    count--;
  }
  assertNotNull(pid);
  LOG.info("Going to killing the process.");
  exec.signalContainer(appSubmitter,pid,Signal.TERM);
  LOG.info("sleeping for 100ms to let the sleep be killed");
  Thread.sleep(100);
  assertFalse(t.isAlive());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.TestNodeStatusUpdater </h4><pre class="type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=150000) public void testNMConnectionToRM() throws Exception {
  final long delta=50000;
  final long connectionWaitMs=5000;
  final long connectionRetryIntervalMs=1000;
  final long rmStartIntervalMS=2 * 1000;
  conf.setLong(YarnConfiguration.RESOURCEMANAGER_CONNECT_MAX_WAIT_MS,connectionWaitMs);
  conf.setLong(YarnConfiguration.RESOURCEMANAGER_CONNECT_RETRY_INTERVAL_MS,connectionRetryIntervalMs);
  NodeManagerWithCustomNodeStatusUpdater nmWithUpdater;
  nm=nmWithUpdater=new NodeManagerWithCustomNodeStatusUpdater(){
    @Override protected NodeStatusUpdater createUpdater(    Context context,    Dispatcher dispatcher,    NodeHealthCheckerService healthChecker){
      NodeStatusUpdater nodeStatusUpdater=new MyNodeStatusUpdater4(context,dispatcher,healthChecker,metrics,rmStartIntervalMS,true);
      return nodeStatusUpdater;
    }
  }
;
  nm.init(conf);
  long waitStartTime=System.currentTimeMillis();
  try {
    nm.start();
    Assert.fail("NM should have failed to start due to RM connect failure");
  }
 catch (  Exception e) {
    long t=System.currentTimeMillis();
    long duration=t - waitStartTime;
    boolean waitTimeValid=(duration >= connectionWaitMs) && (duration < (connectionWaitMs + delta));
    if (!waitTimeValid) {
      throw new Exception("NM should have tried re-connecting to RM during " + "period of at least " + connectionWaitMs + " ms, but "+ "stopped retrying within "+ (connectionWaitMs + delta)+ " ms: "+ e,e);
    }
  }
  nm=nmWithUpdater=new NodeManagerWithCustomNodeStatusUpdater(){
    @Override protected NodeStatusUpdater createUpdater(    Context context,    Dispatcher dispatcher,    NodeHealthCheckerService healthChecker){
      NodeStatusUpdater nodeStatusUpdater=new MyNodeStatusUpdater4(context,dispatcher,healthChecker,metrics,rmStartIntervalMS,false);
      return nodeStatusUpdater;
    }
  }
;
  nm.init(conf);
  NodeStatusUpdater updater=nmWithUpdater.getUpdater();
  Assert.assertNotNull("Updater not yet created ",updater);
  waitStartTime=System.currentTimeMillis();
  try {
    nm.start();
  }
 catch (  Exception ex) {
    LOG.error("NM should have started successfully " + "after connecting to RM.",ex);
    throw ex;
  }
  long duration=System.currentTimeMillis() - waitStartTime;
  MyNodeStatusUpdater4 myUpdater=(MyNodeStatusUpdater4)updater;
  Assert.assertTrue("NM started before updater triggered",myUpdater.isTriggered());
  Assert.assertTrue("NM should have connected to RM after " + "the start interval of " + rmStartIntervalMS + ": actual "+ duration+ " "+ myUpdater,(duration >= rmStartIntervalMS));
  Assert.assertTrue("NM should have connected to RM less than " + (rmStartIntervalMS + delta) + " milliseconds of RM starting up: actual "+ duration+ " "+ myUpdater,(duration < (rmStartIntervalMS + delta)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.api.protocolrecords.impl.pb.TestPBRecordImpl </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testLocalizerHeartbeatResponseSerDe() throws Exception {
  LocalizerHeartbeatResponse rsrcS=createLocalizerHeartbeatResponse();
  assertTrue(rsrcS instanceof LocalizerHeartbeatResponsePBImpl);
  LocalizerHeartbeatResponsePBImpl rsrcPb=(LocalizerHeartbeatResponsePBImpl)rsrcS;
  DataOutputBuffer out=new DataOutputBuffer();
  rsrcPb.getProto().writeDelimitedTo(out);
  DataInputBuffer in=new DataInputBuffer();
  in.reset(out.getData(),0,out.getLength());
  LocalizerHeartbeatResponseProto rsrcPbD=LocalizerHeartbeatResponseProto.parseDelimitedFrom(in);
  assertNotNull(rsrcPbD);
  LocalizerHeartbeatResponse rsrcD=new LocalizerHeartbeatResponsePBImpl(rsrcPbD);
  assertEquals(rsrcS,rsrcD);
  assertEquals(createResource(),rsrcS.getResourceSpecs().get(0).getResource());
  assertEquals(createResource(),rsrcD.getResourceSpecs().get(0).getResource());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testLocalizerStatusSerDe() throws Exception {
  LocalizerStatus rsrcS=createLocalizerStatus();
  assertTrue(rsrcS instanceof LocalizerStatusPBImpl);
  LocalizerStatusPBImpl rsrcPb=(LocalizerStatusPBImpl)rsrcS;
  DataOutputBuffer out=new DataOutputBuffer();
  rsrcPb.getProto().writeDelimitedTo(out);
  DataInputBuffer in=new DataInputBuffer();
  in.reset(out.getData(),0,out.getLength());
  LocalizerStatusProto rsrcPbD=LocalizerStatusProto.parseDelimitedFrom(in);
  assertNotNull(rsrcPbD);
  LocalizerStatus rsrcD=new LocalizerStatusPBImpl(rsrcPbD);
  assertEquals(rsrcS,rsrcD);
  assertEquals("localizer0",rsrcS.getLocalizerId());
  assertEquals("localizer0",rsrcD.getLocalizerId());
  assertEquals(createLocalResourceStatus(),rsrcS.getResourceStatus(0));
  assertEquals(createLocalResourceStatus(),rsrcD.getResourceStatus(0));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testLocalResourceStatusSerDe() throws Exception {
  LocalResourceStatus rsrcS=createLocalResourceStatus();
  assertTrue(rsrcS instanceof LocalResourceStatusPBImpl);
  LocalResourceStatusPBImpl rsrcPb=(LocalResourceStatusPBImpl)rsrcS;
  DataOutputBuffer out=new DataOutputBuffer();
  rsrcPb.getProto().writeDelimitedTo(out);
  DataInputBuffer in=new DataInputBuffer();
  in.reset(out.getData(),0,out.getLength());
  LocalResourceStatusProto rsrcPbD=LocalResourceStatusProto.parseDelimitedFrom(in);
  assertNotNull(rsrcPbD);
  LocalResourceStatus rsrcD=new LocalResourceStatusPBImpl(rsrcPbD);
  assertEquals(rsrcS,rsrcD);
  assertEquals(createResource(),rsrcS.getResource());
  assertEquals(createResource(),rsrcD.getResource());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.TestAuxServices </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuxEventDispatch(){
  Configuration conf=new Configuration();
  conf.setStrings(YarnConfiguration.NM_AUX_SERVICES,new String[]{"Asrv","Bsrv"});
  conf.setClass(String.format(YarnConfiguration.NM_AUX_SERVICE_FMT,"Asrv"),ServiceA.class,Service.class);
  conf.setClass(String.format(YarnConfiguration.NM_AUX_SERVICE_FMT,"Bsrv"),ServiceB.class,Service.class);
  conf.setInt("A.expected.init",1);
  conf.setInt("B.expected.stop",1);
  final AuxServices aux=new AuxServices();
  aux.init(conf);
  aux.start();
  ApplicationId appId1=ApplicationId.newInstance(0,65);
  ByteBuffer buf=ByteBuffer.allocate(6);
  buf.putChar('A');
  buf.putInt(65);
  buf.flip();
  AuxServicesEvent event=new AuxServicesEvent(AuxServicesEventType.APPLICATION_INIT,"user0",appId1,"Asrv",buf);
  aux.handle(event);
  ApplicationId appId2=ApplicationId.newInstance(0,66);
  event=new AuxServicesEvent(AuxServicesEventType.APPLICATION_STOP,"user0",appId2,"Bsrv",null);
  aux.handle(event);
  Collection<AuxiliaryService> servs=aux.getServices();
  for (  AuxiliaryService serv : servs) {
    ArrayList<Integer> appIds=((LightService)serv).getAppIdsStopped();
    assertEquals("app not properly stopped",1,appIds.size());
    assertTrue("wrong app stopped",appIds.contains((Integer)66));
  }
  for (  AuxiliaryService serv : servs) {
    assertNull(((LightService)serv).containerId);
    assertNull(((LightService)serv).resource);
  }
  ApplicationAttemptId attemptId=ApplicationAttemptId.newInstance(appId1,1);
  ContainerTokenIdentifier cti=new ContainerTokenIdentifier(ContainerId.newInstance(attemptId,1),"","",Resource.newInstance(1,1),0,0,0,Priority.newInstance(0),0);
  Container container=new ContainerImpl(null,null,null,null,null,null,cti);
  ContainerId containerId=container.getContainerId();
  Resource resource=container.getResource();
  event=new AuxServicesEvent(AuxServicesEventType.CONTAINER_INIT,container);
  aux.handle(event);
  for (  AuxiliaryService serv : servs) {
    assertEquals(containerId,((LightService)serv).containerId);
    assertEquals(resource,((LightService)serv).resource);
    ((LightService)serv).containerId=null;
    ((LightService)serv).resource=null;
  }
  event=new AuxServicesEvent(AuxServicesEventType.CONTAINER_STOP,container);
  aux.handle(event);
  for (  AuxiliaryService serv : servs) {
    assertEquals(containerId,((LightService)serv).containerId);
    assertEquals(resource,((LightService)serv).resource);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.TestContainerManagerRecovery </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testApplicationRecovery() throws Exception {
  YarnConfiguration conf=new YarnConfiguration();
  conf.setBoolean(YarnConfiguration.NM_RECOVERY_ENABLED,true);
  conf.set(YarnConfiguration.NM_ADDRESS,"localhost:1234");
  conf.setBoolean(YarnConfiguration.YARN_ACL_ENABLE,true);
  conf.set(YarnConfiguration.YARN_ADMIN_ACL,"yarn_admin_user");
  NMStateStoreService stateStore=new NMMemoryStateStoreService();
  stateStore.init(conf);
  stateStore.start();
  Context context=new NMContext(new NMContainerTokenSecretManager(conf),new NMTokenSecretManagerInNM(),null,new ApplicationACLsManager(conf),stateStore);
  ContainerManagerImpl cm=createContainerManager(context);
  cm.init(conf);
  cm.start();
  MasterKey masterKey=new MasterKeyPBImpl();
  masterKey.setKeyId(123);
  masterKey.setBytes(ByteBuffer.wrap(new byte[]{new Integer(123).byteValue()}));
  context.getContainerTokenSecretManager().setMasterKey(masterKey);
  context.getNMTokenSecretManager().setMasterKey(masterKey);
  String appUser="app_user1";
  String modUser="modify_user1";
  String viewUser="view_user1";
  String enemyUser="enemy_user";
  ApplicationId appId=ApplicationId.newInstance(0,1);
  ApplicationAttemptId attemptId=ApplicationAttemptId.newInstance(appId,1);
  ContainerId cid=ContainerId.newInstance(attemptId,1);
  Map<String,LocalResource> localResources=Collections.emptyMap();
  Map<String,String> containerEnv=Collections.emptyMap();
  List<String> containerCmds=Collections.emptyList();
  Map<String,ByteBuffer> serviceData=Collections.emptyMap();
  Credentials containerCreds=new Credentials();
  DataOutputBuffer dob=new DataOutputBuffer();
  containerCreds.writeTokenStorageToStream(dob);
  ByteBuffer containerTokens=ByteBuffer.wrap(dob.getData(),0,dob.getLength());
  Map<ApplicationAccessType,String> acls=new HashMap<ApplicationAccessType,String>();
  acls.put(ApplicationAccessType.MODIFY_APP,modUser);
  acls.put(ApplicationAccessType.VIEW_APP,viewUser);
  ContainerLaunchContext clc=ContainerLaunchContext.newInstance(localResources,containerEnv,containerCmds,serviceData,containerTokens,acls);
  StartContainersResponse startResponse=startContainer(context,cm,cid,clc);
  assertTrue(startResponse.getFailedRequests().isEmpty());
  assertEquals(1,context.getApplications().size());
  Application app=context.getApplications().get(appId);
  assertNotNull(app);
  waitForAppState(app,ApplicationState.INITING);
  assertTrue(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(modUser),ApplicationAccessType.MODIFY_APP,appUser,appId));
  assertFalse(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(viewUser),ApplicationAccessType.MODIFY_APP,appUser,appId));
  assertTrue(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(viewUser),ApplicationAccessType.VIEW_APP,appUser,appId));
  assertFalse(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(enemyUser),ApplicationAccessType.VIEW_APP,appUser,appId));
  cm.stop();
  context=new NMContext(new NMContainerTokenSecretManager(conf),new NMTokenSecretManagerInNM(),null,new ApplicationACLsManager(conf),stateStore);
  cm=createContainerManager(context);
  cm.init(conf);
  cm.start();
  assertEquals(1,context.getApplications().size());
  app=context.getApplications().get(appId);
  assertNotNull(app);
  waitForAppState(app,ApplicationState.INITING);
  assertTrue(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(modUser),ApplicationAccessType.MODIFY_APP,appUser,appId));
  assertFalse(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(viewUser),ApplicationAccessType.MODIFY_APP,appUser,appId));
  assertTrue(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(viewUser),ApplicationAccessType.VIEW_APP,appUser,appId));
  assertFalse(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(enemyUser),ApplicationAccessType.VIEW_APP,appUser,appId));
  List<ApplicationId> finishedApps=new ArrayList<ApplicationId>();
  finishedApps.add(appId);
  cm.handle(new CMgrCompletedAppsEvent(finishedApps,CMgrCompletedAppsEvent.Reason.BY_RESOURCEMANAGER));
  waitForAppState(app,ApplicationState.APPLICATION_RESOURCES_CLEANINGUP);
  cm.stop();
  context=new NMContext(new NMContainerTokenSecretManager(conf),new NMTokenSecretManagerInNM(),null,new ApplicationACLsManager(conf),stateStore);
  cm=createContainerManager(context);
  cm.init(conf);
  cm.start();
  assertEquals(1,context.getApplications().size());
  app=context.getApplications().get(appId);
  assertNotNull(app);
  waitForAppState(app,ApplicationState.APPLICATION_RESOURCES_CLEANINGUP);
  assertTrue(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(modUser),ApplicationAccessType.MODIFY_APP,appUser,appId));
  assertFalse(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(viewUser),ApplicationAccessType.MODIFY_APP,appUser,appId));
  assertTrue(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(viewUser),ApplicationAccessType.VIEW_APP,appUser,appId));
  assertFalse(context.getApplicationACLsManager().checkAccess(UserGroupInformation.createRemoteUser(enemyUser),ApplicationAccessType.VIEW_APP,appUser,appId));
  app.handle(new ApplicationEvent(app.getAppId(),ApplicationEventType.APPLICATION_RESOURCES_CLEANEDUP));
  assertEquals(app.getApplicationState(),ApplicationState.FINISHED);
  app.handle(new ApplicationEvent(app.getAppId(),ApplicationEventType.APPLICATION_LOG_HANDLING_FINISHED));
  cm.stop();
  context=new NMContext(new NMContainerTokenSecretManager(conf),new NMTokenSecretManagerInNM(),null,new ApplicationACLsManager(conf),stateStore);
  cm=createContainerManager(context);
  cm.init(conf);
  cm.start();
  assertTrue(context.getApplications().isEmpty());
  cm.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.container.TestContainer </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testInitWhileDone() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(6,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.localizeResources();
    wc.launchContainer();
    reset(wc.localizerBus);
    wc.containerSuccessful();
    wc.containerResourcesCleanup();
    assertEquals(ContainerState.DONE,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    wc.initContainer();
    assertEquals(ContainerState.DONE,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceLocalizedOnLocalizationFailed() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(16,314159265358979L,4344,"yak");
    wc.initContainer();
    int failCount=wc.getLocalResourceCount() / 2;
    if (failCount == 0) {
      failCount=1;
    }
    wc.failLocalizeResources(failCount);
    assertEquals(ContainerState.LOCALIZATION_FAILED,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    wc.localizeResourcesFromInvalidState(failCount);
    assertEquals(ContainerState.LOCALIZATION_FAILED,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
    Assert.assertTrue(wc.getDiagnostics().contains(FAKE_LOCALIZATION_ERROR));
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKillOnLocalizedWhenContainerLaunched() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(17,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.localizeResources();
    assertEquals(ContainerState.LOCALIZED,wc.c.getContainerState());
    ContainerLaunch launcher=wc.launcher.running.get(wc.c.getContainerId());
    launcher.call();
    wc.drainDispatcherEvents();
    assertEquals(ContainerState.EXITED_WITH_FAILURE,wc.c.getContainerState());
    wc.killContainer();
    assertEquals(ContainerState.EXITED_WITH_FAILURE,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKillOnLocalizedWhenContainerNotLaunched() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(17,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.localizeResources();
    assertEquals(ContainerState.LOCALIZED,wc.c.getContainerState());
    ContainerLaunch launcher=wc.launcher.running.get(wc.c.getContainerId());
    wc.killContainer();
    assertEquals(ContainerState.KILLING,wc.c.getContainerState());
    launcher.call();
    wc.drainDispatcherEvents();
    assertEquals(ContainerState.CONTAINER_CLEANEDUP_AFTER_KILL,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
    wc.c.handle(new ContainerEvent(wc.c.getContainerId(),ContainerEventType.CONTAINER_RESOURCES_CLEANEDUP));
    assertEquals(0,metrics.getRunningContainers());
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testCleanupOnKillRequest() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(12,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.localizeResources();
    wc.launchContainer();
    reset(wc.localizerBus);
    wc.killContainer();
    assertEquals(ContainerState.KILLING,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    wc.containerKilledOnRequest();
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceFailedOnLocalizationFailed() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(16,314159265358979L,4344,"yak");
    wc.initContainer();
    Iterator<String> lRsrcKeys=wc.localResources.keySet().iterator();
    String key1=lRsrcKeys.next();
    String key2=lRsrcKeys.next();
    wc.failLocalizeSpecificResource(key1);
    assertEquals(ContainerState.LOCALIZATION_FAILED,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    wc.failLocalizeSpecificResource(key2);
    assertEquals(ContainerState.LOCALIZATION_FAILED,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testCleanupOnSuccess() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(11,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.localizeResources();
    wc.launchContainer();
    reset(wc.localizerBus);
    wc.containerSuccessful();
    assertEquals(ContainerState.EXITED_WITH_SUCCESS,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKillOnLocalizationFailed() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(15,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.failLocalizeResources(wc.getLocalResourceCount());
    assertEquals(ContainerState.LOCALIZATION_FAILED,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    wc.killContainer();
    assertEquals(ContainerState.LOCALIZATION_FAILED,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLaunchAfterKillRequest() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(14,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.localizeResources();
    wc.killContainer();
    assertEquals(ContainerState.KILLING,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    wc.launchContainer();
    assertEquals(ContainerState.KILLING,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    wc.containerKilledOnRequest();
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceFailedOnKilling() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(16,314159265358979L,4344,"yak");
    wc.initContainer();
    Iterator<String> lRsrcKeys=wc.localResources.keySet().iterator();
    String key1=lRsrcKeys.next();
    wc.killContainer();
    assertEquals(ContainerState.KILLING,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    wc.failLocalizeSpecificResource(key1);
    assertEquals(ContainerState.KILLING,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testCleanupOnFailure() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(10,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.localizeResources();
    wc.launchContainer();
    reset(wc.localizerBus);
    wc.containerFailed(ExitCode.FORCE_KILLED.getExitCode());
    assertEquals(ContainerState.EXITED_WITH_FAILURE,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testExternalKill() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(13,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.localizeResources();
    wc.launchContainer();
    reset(wc.localizerBus);
    wc.containerKilledOnRequest();
    assertEquals(ContainerState.EXITED_WITH_FAILURE,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testLocalizationFailureAtDone() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(6,314159265358979L,4344,"yak");
    wc.initContainer();
    wc.localizeResources();
    wc.launchContainer();
    reset(wc.localizerBus);
    wc.containerSuccessful();
    wc.containerResourcesCleanup();
    assertEquals(ContainerState.DONE,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    wc.resourceFailedContainer();
    assertEquals(ContainerState.DONE,wc.c.getContainerState());
    assertNull(wc.c.getLocalizedResources());
    verifyCleanupCall(wc);
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify container launch when all resources already cached.
 */
@Test public void testLocalizationLaunch() throws Exception {
  WrappedContainer wc=null;
  try {
    wc=new WrappedContainer(8,314159265358979L,4344,"yak");
    assertEquals(ContainerState.NEW,wc.c.getContainerState());
    wc.initContainer();
    Map<Path,List<String>> localPaths=wc.localizeResources();
    assertEquals(ContainerState.LOCALIZED,wc.c.getContainerState());
    assertNotNull(wc.c.getLocalizedResources());
    for (    Entry<Path,List<String>> loc : wc.c.getLocalizedResources().entrySet()) {
      assertEquals(localPaths.remove(loc.getKey()),loc.getValue());
    }
    assertTrue(localPaths.isEmpty());
    final WrappedContainer wcf=wc;
    ArgumentMatcher<ContainersLauncherEvent> matchesContainerLaunch=new ArgumentMatcher<ContainersLauncherEvent>(){
      @Override public boolean matches(      Object o){
        ContainersLauncherEvent launchEvent=(ContainersLauncherEvent)o;
        return wcf.c == launchEvent.getContainer();
      }
    }
;
    verify(wc.launcherBus).handle(argThat(matchesContainerLaunch));
  }
  finally {
    if (wc != null) {
      wc.finished();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.TestContainerLaunch </h4><pre class="type-9 type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=20000) public void testInvalidSymlinkDiagnostics() throws IOException {
  File shellFile=null;
  File tempFile=null;
  String symLink=Shell.WINDOWS ? "test.cmd" : "test";
  File symLinkFile=null;
  try {
    shellFile=Shell.appendScriptExtension(tmpDir,"hello");
    tempFile=Shell.appendScriptExtension(tmpDir,"temp");
    String timeoutCommand=Shell.WINDOWS ? "@echo \"hello\"" : "echo \"hello\"";
    PrintWriter writer=new PrintWriter(new FileOutputStream(shellFile));
    FileUtil.setExecutable(shellFile,true);
    writer.println(timeoutCommand);
    writer.close();
    Map<Path,List<String>> resources=new HashMap<Path,List<String>>();
    Path invalidPath=new Path(shellFile.getAbsolutePath() + "randomPath");
    resources.put(invalidPath,Arrays.asList(symLink));
    FileOutputStream fos=new FileOutputStream(tempFile);
    Map<String,String> env=new HashMap<String,String>();
    List<String> commands=new ArrayList<String>();
    if (Shell.WINDOWS) {
      commands.add("cmd");
      commands.add("/c");
      commands.add("\"" + symLink + "\"");
    }
 else {
      commands.add("/bin/sh ./\\\"" + symLink + "\\\"");
    }
    ContainerLaunch.writeLaunchEnv(fos,env,resources,commands);
    fos.flush();
    fos.close();
    FileUtil.setExecutable(tempFile,true);
    Shell.ShellCommandExecutor shexc=new Shell.ShellCommandExecutor(new String[]{tempFile.getAbsolutePath()},tmpDir);
    String diagnostics=null;
    try {
      shexc.execute();
      Assert.fail("Should catch exception");
    }
 catch (    ExitCodeException e) {
      diagnostics=e.getMessage();
    }
    Assert.assertNotNull(diagnostics);
    Assert.assertTrue(shexc.getExitCode() != 0);
    symLinkFile=new File(tmpDir,symLink);
  }
  finally {
    if (shellFile != null && shellFile.exists()) {
      shellFile.delete();
    }
    if (tempFile != null && tempFile.exists()) {
      tempFile.delete();
    }
    if (symLinkFile != null && symLinkFile.exists()) {
      symLinkFile.delete();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.TestLocalCacheDirectoryManager </h4><pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testMinimumPerDirectoryFileLimit(){
  YarnConfiguration conf=new YarnConfiguration();
  conf.set(YarnConfiguration.NM_LOCAL_CACHE_MAX_FILES_PER_DIRECTORY,"1");
  Exception e=null;
  ResourceLocalizationService service=new ResourceLocalizationService(null,null,null,null,null);
  try {
    service.init(conf);
  }
 catch (  Exception e1) {
    e=e1;
  }
  Assert.assertNotNull(e);
  Assert.assertEquals(YarnRuntimeException.class,e.getClass());
  Assert.assertEquals(e.getMessage(),YarnConfiguration.NM_LOCAL_CACHE_MAX_FILES_PER_DIRECTORY + " parameter is configured with a value less than 37.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.TestLocalResourcesTrackerImpl </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testStateStoreSuccessfulLocalization() throws Exception {
  final String user="someuser";
  final ApplicationId appId=ApplicationId.newInstance(1,1);
  final Path localDir=new Path("/tmp");
  Configuration conf=new YarnConfiguration();
  DrainDispatcher dispatcher=null;
  dispatcher=createDispatcher(conf);
  EventHandler<LocalizerEvent> localizerEventHandler=mock(EventHandler.class);
  EventHandler<LocalizerEvent> containerEventHandler=mock(EventHandler.class);
  dispatcher.register(LocalizerEventType.class,localizerEventHandler);
  dispatcher.register(ContainerEventType.class,containerEventHandler);
  DeletionService mockDelService=mock(DeletionService.class);
  NMStateStoreService stateStore=mock(NMStateStoreService.class);
  try {
    LocalResourcesTracker tracker=new LocalResourcesTrackerImpl(user,appId,dispatcher,false,conf,stateStore);
    ContainerId cId1=BuilderUtils.newContainerId(1,1,1,1);
    LocalResourceRequest lr1=createLocalResourceRequest(user,1,1,LocalResourceVisibility.APPLICATION);
    LocalizerContext lc1=new LocalizerContext(user,cId1,null);
    ResourceEvent reqEvent1=new ResourceRequestEvent(lr1,LocalResourceVisibility.APPLICATION,lc1);
    tracker.handle(reqEvent1);
    dispatcher.await();
    Path hierarchicalPath1=tracker.getPathForLocalization(lr1,localDir);
    ArgumentCaptor<LocalResourceProto> localResourceCaptor=ArgumentCaptor.forClass(LocalResourceProto.class);
    ArgumentCaptor<Path> pathCaptor=ArgumentCaptor.forClass(Path.class);
    verify(stateStore).startResourceLocalization(eq(user),eq(appId),localResourceCaptor.capture(),pathCaptor.capture());
    LocalResourceProto lrProto=localResourceCaptor.getValue();
    Path localizedPath1=pathCaptor.getValue();
    Assert.assertEquals(lr1,new LocalResourceRequest(new LocalResourcePBImpl(lrProto)));
    Assert.assertEquals(hierarchicalPath1,localizedPath1.getParent());
    ResourceLocalizedEvent rle1=new ResourceLocalizedEvent(lr1,pathCaptor.getValue(),120);
    tracker.handle(rle1);
    dispatcher.await();
    ArgumentCaptor<LocalizedResourceProto> localizedProtoCaptor=ArgumentCaptor.forClass(LocalizedResourceProto.class);
    verify(stateStore).finishResourceLocalization(eq(user),eq(appId),localizedProtoCaptor.capture());
    LocalizedResourceProto localizedProto=localizedProtoCaptor.getValue();
    Assert.assertEquals(lr1,new LocalResourceRequest(new LocalResourcePBImpl(localizedProto.getResource())));
    Assert.assertEquals(localizedPath1.toString(),localizedProto.getLocalPath());
    LocalizedResource localizedRsrc1=tracker.getLocalizedResource(lr1);
    Assert.assertNotNull(localizedRsrc1);
    tracker.handle(new ResourceReleaseEvent(lr1,cId1));
    dispatcher.await();
    boolean removeResult=tracker.remove(localizedRsrc1,mockDelService);
    Assert.assertTrue(removeResult);
    verify(stateStore).removeLocalizedResource(eq(user),eq(appId),eq(localizedPath1));
  }
  finally {
    if (dispatcher != null) {
      dispatcher.stop();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testRecoveredResourceWithDirCacheMgr() throws Exception {
  final String user="someuser";
  final ApplicationId appId=ApplicationId.newInstance(1,1);
  final Path localDirRoot=new Path("/tmp/localdir");
  Configuration conf=new YarnConfiguration();
  DrainDispatcher dispatcher=null;
  dispatcher=createDispatcher(conf);
  EventHandler<LocalizerEvent> localizerEventHandler=mock(EventHandler.class);
  EventHandler<LocalizerEvent> containerEventHandler=mock(EventHandler.class);
  dispatcher.register(LocalizerEventType.class,localizerEventHandler);
  dispatcher.register(ContainerEventType.class,containerEventHandler);
  NMStateStoreService stateStore=mock(NMStateStoreService.class);
  try {
    LocalResourcesTrackerImpl tracker=new LocalResourcesTrackerImpl(user,appId,dispatcher,true,conf,stateStore);
    LocalResourceRequest lr1=createLocalResourceRequest(user,1,1,LocalResourceVisibility.PUBLIC);
    Assert.assertNull(tracker.getLocalizedResource(lr1));
    final long localizedId1=52;
    Path hierarchicalPath1=new Path(localDirRoot + "/4/2",Long.toString(localizedId1));
    Path localizedPath1=new Path(hierarchicalPath1,"resource.jar");
    tracker.handle(new ResourceRecoveredEvent(lr1,localizedPath1,120));
    dispatcher.await();
    Assert.assertNotNull(tracker.getLocalizedResource(lr1));
    LocalCacheDirectoryManager dirMgrRoot=tracker.getDirectoryManager(localDirRoot);
    Assert.assertEquals(0,dirMgrRoot.getDirectory("").getCount());
    Assert.assertEquals(1,dirMgrRoot.getDirectory("4/2").getCount());
    LocalResourceRequest lr2=createLocalResourceRequest(user,2,2,LocalResourceVisibility.PUBLIC);
    Assert.assertNull(tracker.getLocalizedResource(lr2));
    final long localizedId2=localizedId1 + 1;
    Path hierarchicalPath2=new Path(localDirRoot + "/4/2",Long.toString(localizedId2));
    Path localizedPath2=new Path(hierarchicalPath2,"resource.jar");
    tracker.handle(new ResourceRecoveredEvent(lr2,localizedPath2,120));
    dispatcher.await();
    Assert.assertNotNull(tracker.getLocalizedResource(lr2));
    Assert.assertEquals(0,dirMgrRoot.getDirectory("").getCount());
    Assert.assertEquals(2,dirMgrRoot.getDirectory("4/2").getCount());
    LocalResourceRequest lr3=createLocalResourceRequest(user,3,3,LocalResourceVisibility.PUBLIC);
    Assert.assertNull(tracker.getLocalizedResource(lr3));
    final long localizedId3=128;
    Path hierarchicalPath3=new Path(localDirRoot + "/4/3",Long.toString(localizedId3));
    Path localizedPath3=new Path(hierarchicalPath3,"resource.jar");
    tracker.handle(new ResourceRecoveredEvent(lr3,localizedPath3,120));
    dispatcher.await();
    Assert.assertNotNull(tracker.getLocalizedResource(lr3));
    Assert.assertEquals(0,dirMgrRoot.getDirectory("").getCount());
    Assert.assertEquals(2,dirMgrRoot.getDirectory("4/2").getCount());
    Assert.assertEquals(1,dirMgrRoot.getDirectory("4/3").getCount());
    LocalResourceRequest lr4=createLocalResourceRequest(user,4,4,LocalResourceVisibility.PUBLIC);
    Assert.assertNull(tracker.getLocalizedResource(lr4));
    final long localizedId4=256;
    Path hierarchicalPath4=new Path(localDirRoot + "/4",Long.toString(localizedId4));
    Path localizedPath4=new Path(hierarchicalPath4,"resource.jar");
    tracker.handle(new ResourceRecoveredEvent(lr4,localizedPath4,120));
    dispatcher.await();
    Assert.assertNotNull(tracker.getLocalizedResource(lr4));
    Assert.assertEquals(0,dirMgrRoot.getDirectory("").getCount());
    Assert.assertEquals(1,dirMgrRoot.getDirectory("4").getCount());
    Assert.assertEquals(2,dirMgrRoot.getDirectory("4/2").getCount());
    Assert.assertEquals(1,dirMgrRoot.getDirectory("4/3").getCount());
  }
  finally {
    if (dispatcher != null) {
      dispatcher.stop();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testRecoveredResource() throws Exception {
  final String user="someuser";
  final ApplicationId appId=ApplicationId.newInstance(1,1);
  final Path localDir=new Path("/tmp/localdir");
  Configuration conf=new YarnConfiguration();
  DrainDispatcher dispatcher=null;
  dispatcher=createDispatcher(conf);
  EventHandler<LocalizerEvent> localizerEventHandler=mock(EventHandler.class);
  EventHandler<LocalizerEvent> containerEventHandler=mock(EventHandler.class);
  dispatcher.register(LocalizerEventType.class,localizerEventHandler);
  dispatcher.register(ContainerEventType.class,containerEventHandler);
  NMStateStoreService stateStore=mock(NMStateStoreService.class);
  try {
    LocalResourcesTracker tracker=new LocalResourcesTrackerImpl(user,appId,dispatcher,false,conf,stateStore);
    ContainerId cId1=BuilderUtils.newContainerId(1,1,1,1);
    LocalResourceRequest lr1=createLocalResourceRequest(user,1,1,LocalResourceVisibility.APPLICATION);
    Assert.assertNull(tracker.getLocalizedResource(lr1));
    final long localizedId1=52;
    Path hierarchicalPath1=new Path(localDir,Long.toString(localizedId1));
    Path localizedPath1=new Path(hierarchicalPath1,"resource.jar");
    tracker.handle(new ResourceRecoveredEvent(lr1,localizedPath1,120));
    dispatcher.await();
    Assert.assertNotNull(tracker.getLocalizedResource(lr1));
    LocalResourceRequest lr2=createLocalResourceRequest(user,2,2,LocalResourceVisibility.APPLICATION);
    LocalizerContext lc2=new LocalizerContext(user,cId1,null);
    ResourceEvent reqEvent2=new ResourceRequestEvent(lr2,LocalResourceVisibility.APPLICATION,lc2);
    tracker.handle(reqEvent2);
    dispatcher.await();
    Path hierarchicalPath2=tracker.getPathForLocalization(lr2,localDir);
    long localizedId2=Long.parseLong(hierarchicalPath2.getName());
    Assert.assertEquals(localizedId1 + 1,localizedId2);
  }
  finally {
    if (dispatcher != null) {
      dispatcher.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.containermanager.localizer.TestResourceLocalizationService </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testRecovery() throws Exception {
  final String user1="user1";
  final String user2="user2";
  final ApplicationId appId1=ApplicationId.newInstance(1,1);
  final ApplicationId appId2=ApplicationId.newInstance(1,2);
  List<Path> localDirs=new ArrayList<Path>();
  String[] sDirs=new String[4];
  for (int i=0; i < 4; ++i) {
    localDirs.add(lfs.makeQualified(new Path(basedir,i + "")));
    sDirs[i]=localDirs.get(i).toString();
  }
  conf.setStrings(YarnConfiguration.NM_LOCAL_DIRS,sDirs);
  conf.setBoolean(YarnConfiguration.NM_RECOVERY_ENABLED,true);
  NMMemoryStateStoreService stateStore=new NMMemoryStateStoreService();
  stateStore.init(conf);
  stateStore.start();
  DrainDispatcher dispatcher=new DrainDispatcher();
  dispatcher.init(conf);
  dispatcher.start();
  EventHandler<ApplicationEvent> applicationBus=mock(EventHandler.class);
  dispatcher.register(ApplicationEventType.class,applicationBus);
  EventHandler<ContainerEvent> containerBus=mock(EventHandler.class);
  dispatcher.register(ContainerEventType.class,containerBus);
  EventHandler<LocalizerEvent> localizerBus=mock(EventHandler.class);
  dispatcher.register(LocalizerEventType.class,localizerBus);
  LocalDirsHandlerService dirsHandler=new LocalDirsHandlerService();
  dirsHandler.init(conf);
  ResourceLocalizationService spyService=createSpyService(dispatcher,dirsHandler,stateStore);
  try {
    spyService.init(conf);
    spyService.start();
    final Application app1=mock(Application.class);
    when(app1.getUser()).thenReturn(user1);
    when(app1.getAppId()).thenReturn(appId1);
    final Application app2=mock(Application.class);
    when(app2.getUser()).thenReturn(user2);
    when(app2.getAppId()).thenReturn(appId2);
    spyService.handle(new ApplicationLocalizationEvent(LocalizationEventType.INIT_APPLICATION_RESOURCES,app1));
    spyService.handle(new ApplicationLocalizationEvent(LocalizationEventType.INIT_APPLICATION_RESOURCES,app2));
    dispatcher.await();
    LocalResourcesTracker appTracker1=spyService.getLocalResourcesTracker(LocalResourceVisibility.APPLICATION,user1,appId1);
    LocalResourcesTracker privTracker1=spyService.getLocalResourcesTracker(LocalResourceVisibility.PRIVATE,user1,null);
    LocalResourcesTracker appTracker2=spyService.getLocalResourcesTracker(LocalResourceVisibility.APPLICATION,user2,appId2);
    LocalResourcesTracker pubTracker=spyService.getLocalResourcesTracker(LocalResourceVisibility.PUBLIC,null,null);
    final Container c1=getMockContainer(appId1,1,user1);
    final Container c2=getMockContainer(appId2,2,user2);
    Random r=new Random();
    long seed=r.nextLong();
    System.out.println("SEED: " + seed);
    r.setSeed(seed);
    final LocalResource privResource1=getPrivateMockedResource(r);
    final LocalResourceRequest privReq1=new LocalResourceRequest(privResource1);
    final LocalResource privResource2=getPrivateMockedResource(r);
    final LocalResourceRequest privReq2=new LocalResourceRequest(privResource2);
    final LocalResource pubResource1=getPublicMockedResource(r);
    final LocalResourceRequest pubReq1=new LocalResourceRequest(pubResource1);
    final LocalResource pubResource2=getPublicMockedResource(r);
    final LocalResourceRequest pubReq2=new LocalResourceRequest(pubResource2);
    final LocalResource appResource1=getAppMockedResource(r);
    final LocalResourceRequest appReq1=new LocalResourceRequest(appResource1);
    final LocalResource appResource2=getAppMockedResource(r);
    final LocalResourceRequest appReq2=new LocalResourceRequest(appResource2);
    final LocalResource appResource3=getAppMockedResource(r);
    final LocalResourceRequest appReq3=new LocalResourceRequest(appResource3);
    Map<LocalResourceVisibility,Collection<LocalResourceRequest>> req1=new HashMap<LocalResourceVisibility,Collection<LocalResourceRequest>>();
    req1.put(LocalResourceVisibility.PRIVATE,Arrays.asList(new LocalResourceRequest[]{privReq1,privReq2}));
    req1.put(LocalResourceVisibility.PUBLIC,Collections.singletonList(pubReq1));
    req1.put(LocalResourceVisibility.APPLICATION,Collections.singletonList(appReq1));
    Map<LocalResourceVisibility,Collection<LocalResourceRequest>> req2=new HashMap<LocalResourceVisibility,Collection<LocalResourceRequest>>();
    req2.put(LocalResourceVisibility.APPLICATION,Arrays.asList(new LocalResourceRequest[]{appReq2,appReq3}));
    req2.put(LocalResourceVisibility.PUBLIC,Collections.singletonList(pubReq2));
    spyService.handle(new ContainerLocalizationRequestEvent(c1,req1));
    spyService.handle(new ContainerLocalizationRequestEvent(c2,req2));
    dispatcher.await();
    privTracker1.getPathForLocalization(privReq1,dirsHandler.getLocalPathForWrite(ContainerLocalizer.USERCACHE + user1));
    privTracker1.getPathForLocalization(privReq2,dirsHandler.getLocalPathForWrite(ContainerLocalizer.USERCACHE + user1));
    LocalizedResource privLr1=privTracker1.getLocalizedResource(privReq1);
    LocalizedResource privLr2=privTracker1.getLocalizedResource(privReq2);
    appTracker1.getPathForLocalization(appReq1,dirsHandler.getLocalPathForWrite(ContainerLocalizer.APPCACHE + appId1));
    LocalizedResource appLr1=appTracker1.getLocalizedResource(appReq1);
    appTracker2.getPathForLocalization(appReq2,dirsHandler.getLocalPathForWrite(ContainerLocalizer.APPCACHE + appId2));
    LocalizedResource appLr2=appTracker2.getLocalizedResource(appReq2);
    appTracker2.getPathForLocalization(appReq3,dirsHandler.getLocalPathForWrite(ContainerLocalizer.APPCACHE + appId2));
    LocalizedResource appLr3=appTracker2.getLocalizedResource(appReq3);
    pubTracker.getPathForLocalization(pubReq1,dirsHandler.getLocalPathForWrite(ContainerLocalizer.FILECACHE));
    LocalizedResource pubLr1=pubTracker.getLocalizedResource(pubReq1);
    pubTracker.getPathForLocalization(pubReq2,dirsHandler.getLocalPathForWrite(ContainerLocalizer.FILECACHE));
    LocalizedResource pubLr2=pubTracker.getLocalizedResource(pubReq2);
    assertNotNull("Localization not started",privLr1.getLocalPath());
    privTracker1.handle(new ResourceLocalizedEvent(privReq1,privLr1.getLocalPath(),privLr1.getSize() + 5));
    assertNotNull("Localization not started",privLr2.getLocalPath());
    privTracker1.handle(new ResourceLocalizedEvent(privReq2,privLr2.getLocalPath(),privLr2.getSize() + 10));
    assertNotNull("Localization not started",appLr1.getLocalPath());
    appTracker1.handle(new ResourceLocalizedEvent(appReq1,appLr1.getLocalPath(),appLr1.getSize()));
    assertNotNull("Localization not started",appLr3.getLocalPath());
    appTracker2.handle(new ResourceLocalizedEvent(appReq3,appLr3.getLocalPath(),appLr3.getSize() + 7));
    assertNotNull("Localization not started",pubLr1.getLocalPath());
    pubTracker.handle(new ResourceLocalizedEvent(pubReq1,pubLr1.getLocalPath(),pubLr1.getSize() + 1000));
    assertNotNull("Localization not started",pubLr2.getLocalPath());
    pubTracker.handle(new ResourceLocalizedEvent(pubReq2,pubLr2.getLocalPath(),pubLr2.getSize() + 99999));
    dispatcher.await();
    assertEquals(ResourceState.LOCALIZED,privLr1.getState());
    assertEquals(ResourceState.LOCALIZED,privLr2.getState());
    assertEquals(ResourceState.LOCALIZED,appLr1.getState());
    assertEquals(ResourceState.DOWNLOADING,appLr2.getState());
    assertEquals(ResourceState.LOCALIZED,appLr3.getState());
    assertEquals(ResourceState.LOCALIZED,pubLr1.getState());
    assertEquals(ResourceState.LOCALIZED,pubLr2.getState());
    spyService=createSpyService(dispatcher,dirsHandler,stateStore);
    spyService.init(conf);
    spyService.recoverLocalizedResources(stateStore.loadLocalizationState());
    dispatcher.await();
    appTracker1=spyService.getLocalResourcesTracker(LocalResourceVisibility.APPLICATION,user1,appId1);
    privTracker1=spyService.getLocalResourcesTracker(LocalResourceVisibility.PRIVATE,user1,null);
    appTracker2=spyService.getLocalResourcesTracker(LocalResourceVisibility.APPLICATION,user2,appId2);
    pubTracker=spyService.getLocalResourcesTracker(LocalResourceVisibility.PUBLIC,null,null);
    LocalizedResource recoveredRsrc=privTracker1.getLocalizedResource(privReq1);
    assertEquals(privReq1,recoveredRsrc.getRequest());
    assertEquals(privLr1.getLocalPath(),recoveredRsrc.getLocalPath());
    assertEquals(privLr1.getSize(),recoveredRsrc.getSize());
    assertEquals(ResourceState.LOCALIZED,recoveredRsrc.getState());
    recoveredRsrc=privTracker1.getLocalizedResource(privReq2);
    assertEquals(privReq2,recoveredRsrc.getRequest());
    assertEquals(privLr2.getLocalPath(),recoveredRsrc.getLocalPath());
    assertEquals(privLr2.getSize(),recoveredRsrc.getSize());
    assertEquals(ResourceState.LOCALIZED,recoveredRsrc.getState());
    recoveredRsrc=appTracker1.getLocalizedResource(appReq1);
    assertEquals(appReq1,recoveredRsrc.getRequest());
    assertEquals(appLr1.getLocalPath(),recoveredRsrc.getLocalPath());
    assertEquals(appLr1.getSize(),recoveredRsrc.getSize());
    assertEquals(ResourceState.LOCALIZED,recoveredRsrc.getState());
    recoveredRsrc=appTracker2.getLocalizedResource(appReq2);
    assertNull("in-progress resource should not be present",recoveredRsrc);
    recoveredRsrc=appTracker2.getLocalizedResource(appReq3);
    assertEquals(appReq3,recoveredRsrc.getRequest());
    assertEquals(appLr3.getLocalPath(),recoveredRsrc.getLocalPath());
    assertEquals(appLr3.getSize(),recoveredRsrc.getSize());
    assertEquals(ResourceState.LOCALIZED,recoveredRsrc.getState());
  }
  finally {
    dispatcher.stop();
    stateStore.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test @SuppressWarnings("unchecked") public void testPublicResourceAddResourceExceptions() throws Exception {
  List<Path> localDirs=new ArrayList<Path>();
  String[] sDirs=new String[4];
  for (int i=0; i < 4; ++i) {
    localDirs.add(lfs.makeQualified(new Path(basedir,i + "")));
    sDirs[i]=localDirs.get(i).toString();
  }
  conf.setStrings(YarnConfiguration.NM_LOCAL_DIRS,sDirs);
  conf.setBoolean(Dispatcher.DISPATCHER_EXIT_ON_ERROR_KEY,true);
  DrainDispatcher dispatcher=new DrainDispatcher();
  EventHandler<ApplicationEvent> applicationBus=mock(EventHandler.class);
  dispatcher.register(ApplicationEventType.class,applicationBus);
  EventHandler<ContainerEvent> containerBus=mock(EventHandler.class);
  dispatcher.register(ContainerEventType.class,containerBus);
  ContainerExecutor exec=mock(ContainerExecutor.class);
  DeletionService delService=mock(DeletionService.class);
  LocalDirsHandlerService dirsHandler=new LocalDirsHandlerService();
  LocalDirsHandlerService dirsHandlerSpy=spy(dirsHandler);
  dirsHandlerSpy.init(conf);
  dispatcher.init(conf);
  dispatcher.start();
  try {
    ResourceLocalizationService rawService=new ResourceLocalizationService(dispatcher,exec,delService,dirsHandlerSpy,new NMNullStateStoreService());
    ResourceLocalizationService spyService=spy(rawService);
    doReturn(mockServer).when(spyService).createServer();
    doReturn(lfs).when(spyService).getLocalFileContext(isA(Configuration.class));
    spyService.init(conf);
    spyService.start();
    final String user="user0";
    final Application app=mock(Application.class);
    final ApplicationId appId=BuilderUtils.newApplicationId(314159265358979L,3);
    when(app.getUser()).thenReturn(user);
    when(app.getAppId()).thenReturn(appId);
    spyService.handle(new ApplicationLocalizationEvent(LocalizationEventType.INIT_APPLICATION_RESOURCES,app));
    dispatcher.await();
    Random r=new Random();
    r.setSeed(r.nextLong());
    final LocalResource pubResource=getPublicMockedResource(r);
    final LocalResourceRequest pubReq=new LocalResourceRequest(pubResource);
    Map<LocalResourceVisibility,Collection<LocalResourceRequest>> req=new HashMap<LocalResourceVisibility,Collection<LocalResourceRequest>>();
    req.put(LocalResourceVisibility.PUBLIC,Collections.singletonList(pubReq));
    final Container c=getMockContainer(appId,42,user);
    Mockito.doThrow(new IOException()).when(dirsHandlerSpy).getLocalPathForWrite(isA(String.class),Mockito.anyLong(),Mockito.anyBoolean());
    spyService.handle(new ContainerLocalizationRequestEvent(c,req));
    dispatcher.await();
    LocalResourcesTracker tracker=spyService.getLocalResourcesTracker(LocalResourceVisibility.PUBLIC,user,appId);
    Assert.assertNull(tracker.getLocalizedResource(pubReq));
    Mockito.doCallRealMethod().when(dirsHandlerSpy).getLocalPathForWrite(isA(String.class),Mockito.anyLong(),Mockito.anyBoolean());
    PublicLocalizer publicLocalizer=spyService.getPublicLocalizer();
    publicLocalizer.threadPool.shutdown();
    spyService.handle(new ContainerLocalizationRequestEvent(c,req));
    dispatcher.await();
    tracker=spyService.getLocalResourcesTracker(LocalResourceVisibility.PUBLIC,user,appId);
    Assert.assertNull(tracker.getLocalizedResource(pubReq));
  }
  finally {
    dispatcher.await();
    dispatcher.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.recovery.TestNMLeveldbStateStoreService </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNMTokenStorage() throws IOException {
  RecoveredNMTokensState state=stateStore.loadNMTokensState();
  assertNull(state.getCurrentMasterKey());
  assertNull(state.getPreviousMasterKey());
  assertTrue(state.getApplicationMasterKeys().isEmpty());
  NMTokenSecretManagerForTest secretMgr=new NMTokenSecretManagerForTest();
  MasterKey currentKey=secretMgr.generateKey();
  stateStore.storeNMTokenCurrentMasterKey(currentKey);
  restartStateStore();
  state=stateStore.loadNMTokensState();
  assertEquals(currentKey,state.getCurrentMasterKey());
  assertNull(state.getPreviousMasterKey());
  assertTrue(state.getApplicationMasterKeys().isEmpty());
  MasterKey prevKey=secretMgr.generateKey();
  stateStore.storeNMTokenPreviousMasterKey(prevKey);
  restartStateStore();
  state=stateStore.loadNMTokensState();
  assertEquals(currentKey,state.getCurrentMasterKey());
  assertEquals(prevKey,state.getPreviousMasterKey());
  assertTrue(state.getApplicationMasterKeys().isEmpty());
  ApplicationAttemptId attempt1=ApplicationAttemptId.newInstance(ApplicationId.newInstance(1,1),1);
  MasterKey attemptKey1=secretMgr.generateKey();
  stateStore.storeNMTokenApplicationMasterKey(attempt1,attemptKey1);
  ApplicationAttemptId attempt2=ApplicationAttemptId.newInstance(ApplicationId.newInstance(2,3),4);
  MasterKey attemptKey2=secretMgr.generateKey();
  stateStore.storeNMTokenApplicationMasterKey(attempt2,attemptKey2);
  restartStateStore();
  state=stateStore.loadNMTokensState();
  assertEquals(currentKey,state.getCurrentMasterKey());
  assertEquals(prevKey,state.getPreviousMasterKey());
  Map<ApplicationAttemptId,MasterKey> loadedAppKeys=state.getApplicationMasterKeys();
  assertEquals(2,loadedAppKeys.size());
  assertEquals(attemptKey1,loadedAppKeys.get(attempt1));
  assertEquals(attemptKey2,loadedAppKeys.get(attempt2));
  ApplicationAttemptId attempt3=ApplicationAttemptId.newInstance(ApplicationId.newInstance(5,6),7);
  MasterKey attemptKey3=secretMgr.generateKey();
  stateStore.storeNMTokenApplicationMasterKey(attempt3,attemptKey3);
  stateStore.removeNMTokenApplicationMasterKey(attempt1);
  attemptKey2=prevKey;
  stateStore.storeNMTokenApplicationMasterKey(attempt2,attemptKey2);
  prevKey=currentKey;
  stateStore.storeNMTokenPreviousMasterKey(prevKey);
  currentKey=secretMgr.generateKey();
  stateStore.storeNMTokenCurrentMasterKey(currentKey);
  restartStateStore();
  state=stateStore.loadNMTokensState();
  assertEquals(currentKey,state.getCurrentMasterKey());
  assertEquals(prevKey,state.getPreviousMasterKey());
  loadedAppKeys=state.getApplicationMasterKeys();
  assertEquals(2,loadedAppKeys.size());
  assertNull(loadedAppKeys.get(attempt1));
  assertEquals(attemptKey2,loadedAppKeys.get(attempt2));
  assertEquals(attemptKey3,loadedAppKeys.get(attempt3));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStartResourceLocalization() throws IOException {
  String user="somebody";
  ApplicationId appId=ApplicationId.newInstance(1,1);
  Path appRsrcPath=new Path("hdfs://some/app/resource");
  LocalResourcePBImpl rsrcPb=(LocalResourcePBImpl)LocalResource.newInstance(ConverterUtils.getYarnUrlFromPath(appRsrcPath),LocalResourceType.ARCHIVE,LocalResourceVisibility.APPLICATION,123L,456L);
  LocalResourceProto appRsrcProto=rsrcPb.getProto();
  Path appRsrcLocalPath=new Path("/some/local/dir/for/apprsrc");
  stateStore.startResourceLocalization(user,appId,appRsrcProto,appRsrcLocalPath);
  restartStateStore();
  RecoveredLocalizationState state=stateStore.loadLocalizationState();
  LocalResourceTrackerState pubts=state.getPublicTrackerState();
  assertTrue(pubts.getLocalizedResources().isEmpty());
  assertTrue(pubts.getInProgressResources().isEmpty());
  Map<String,RecoveredUserResources> userResources=state.getUserResources();
  assertEquals(1,userResources.size());
  RecoveredUserResources rur=userResources.get(user);
  LocalResourceTrackerState privts=rur.getPrivateTrackerState();
  assertNotNull(privts);
  assertTrue(privts.getLocalizedResources().isEmpty());
  assertTrue(privts.getInProgressResources().isEmpty());
  assertEquals(1,rur.getAppTrackerStates().size());
  LocalResourceTrackerState appts=rur.getAppTrackerStates().get(appId);
  assertNotNull(appts);
  assertTrue(appts.getLocalizedResources().isEmpty());
  assertEquals(1,appts.getInProgressResources().size());
  assertEquals(appRsrcLocalPath,appts.getInProgressResources().get(appRsrcProto));
  Path pubRsrcPath1=new Path("hdfs://some/public/resource1");
  rsrcPb=(LocalResourcePBImpl)LocalResource.newInstance(ConverterUtils.getYarnUrlFromPath(pubRsrcPath1),LocalResourceType.FILE,LocalResourceVisibility.PUBLIC,789L,135L);
  LocalResourceProto pubRsrcProto1=rsrcPb.getProto();
  Path pubRsrcLocalPath1=new Path("/some/local/dir/for/pubrsrc1");
  stateStore.startResourceLocalization(null,null,pubRsrcProto1,pubRsrcLocalPath1);
  Path pubRsrcPath2=new Path("hdfs://some/public/resource2");
  rsrcPb=(LocalResourcePBImpl)LocalResource.newInstance(ConverterUtils.getYarnUrlFromPath(pubRsrcPath2),LocalResourceType.FILE,LocalResourceVisibility.PUBLIC,789L,135L);
  LocalResourceProto pubRsrcProto2=rsrcPb.getProto();
  Path pubRsrcLocalPath2=new Path("/some/local/dir/for/pubrsrc2");
  stateStore.startResourceLocalization(null,null,pubRsrcProto2,pubRsrcLocalPath2);
  Path privRsrcPath=new Path("hdfs://some/private/resource");
  rsrcPb=(LocalResourcePBImpl)LocalResource.newInstance(ConverterUtils.getYarnUrlFromPath(privRsrcPath),LocalResourceType.PATTERN,LocalResourceVisibility.PRIVATE,789L,680L,"*pattern*");
  LocalResourceProto privRsrcProto=rsrcPb.getProto();
  Path privRsrcLocalPath=new Path("/some/local/dir/for/privrsrc");
  stateStore.startResourceLocalization(user,null,privRsrcProto,privRsrcLocalPath);
  restartStateStore();
  state=stateStore.loadLocalizationState();
  pubts=state.getPublicTrackerState();
  assertTrue(pubts.getLocalizedResources().isEmpty());
  assertEquals(2,pubts.getInProgressResources().size());
  assertEquals(pubRsrcLocalPath1,pubts.getInProgressResources().get(pubRsrcProto1));
  assertEquals(pubRsrcLocalPath2,pubts.getInProgressResources().get(pubRsrcProto2));
  userResources=state.getUserResources();
  assertEquals(1,userResources.size());
  rur=userResources.get(user);
  privts=rur.getPrivateTrackerState();
  assertNotNull(privts);
  assertTrue(privts.getLocalizedResources().isEmpty());
  assertEquals(1,privts.getInProgressResources().size());
  assertEquals(privRsrcLocalPath,privts.getInProgressResources().get(privRsrcProto));
  assertEquals(1,rur.getAppTrackerStates().size());
  appts=rur.getAppTrackerStates().get(appId);
  assertNotNull(appts);
  assertTrue(appts.getLocalizedResources().isEmpty());
  assertEquals(1,appts.getInProgressResources().size());
  assertEquals(appRsrcLocalPath,appts.getInProgressResources().get(appRsrcProto));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFinishResourceLocalization() throws IOException {
  String user="somebody";
  ApplicationId appId=ApplicationId.newInstance(1,1);
  Path appRsrcPath=new Path("hdfs://some/app/resource");
  LocalResourcePBImpl rsrcPb=(LocalResourcePBImpl)LocalResource.newInstance(ConverterUtils.getYarnUrlFromPath(appRsrcPath),LocalResourceType.ARCHIVE,LocalResourceVisibility.APPLICATION,123L,456L);
  LocalResourceProto appRsrcProto=rsrcPb.getProto();
  Path appRsrcLocalPath=new Path("/some/local/dir/for/apprsrc");
  stateStore.startResourceLocalization(user,appId,appRsrcProto,appRsrcLocalPath);
  LocalizedResourceProto appLocalizedProto=LocalizedResourceProto.newBuilder().setResource(appRsrcProto).setLocalPath(appRsrcLocalPath.toString()).setSize(1234567L).build();
  stateStore.finishResourceLocalization(user,appId,appLocalizedProto);
  restartStateStore();
  RecoveredLocalizationState state=stateStore.loadLocalizationState();
  LocalResourceTrackerState pubts=state.getPublicTrackerState();
  assertTrue(pubts.getLocalizedResources().isEmpty());
  assertTrue(pubts.getInProgressResources().isEmpty());
  Map<String,RecoveredUserResources> userResources=state.getUserResources();
  assertEquals(1,userResources.size());
  RecoveredUserResources rur=userResources.get(user);
  LocalResourceTrackerState privts=rur.getPrivateTrackerState();
  assertNotNull(privts);
  assertTrue(privts.getLocalizedResources().isEmpty());
  assertTrue(privts.getInProgressResources().isEmpty());
  assertEquals(1,rur.getAppTrackerStates().size());
  LocalResourceTrackerState appts=rur.getAppTrackerStates().get(appId);
  assertNotNull(appts);
  assertTrue(appts.getInProgressResources().isEmpty());
  assertEquals(1,appts.getLocalizedResources().size());
  assertEquals(appLocalizedProto,appts.getLocalizedResources().iterator().next());
  Path pubRsrcPath1=new Path("hdfs://some/public/resource1");
  rsrcPb=(LocalResourcePBImpl)LocalResource.newInstance(ConverterUtils.getYarnUrlFromPath(pubRsrcPath1),LocalResourceType.FILE,LocalResourceVisibility.PUBLIC,789L,135L);
  LocalResourceProto pubRsrcProto1=rsrcPb.getProto();
  Path pubRsrcLocalPath1=new Path("/some/local/dir/for/pubrsrc1");
  stateStore.startResourceLocalization(null,null,pubRsrcProto1,pubRsrcLocalPath1);
  Path pubRsrcPath2=new Path("hdfs://some/public/resource2");
  rsrcPb=(LocalResourcePBImpl)LocalResource.newInstance(ConverterUtils.getYarnUrlFromPath(pubRsrcPath2),LocalResourceType.FILE,LocalResourceVisibility.PUBLIC,789L,135L);
  LocalResourceProto pubRsrcProto2=rsrcPb.getProto();
  Path pubRsrcLocalPath2=new Path("/some/local/dir/for/pubrsrc2");
  stateStore.startResourceLocalization(null,null,pubRsrcProto2,pubRsrcLocalPath2);
  Path privRsrcPath=new Path("hdfs://some/private/resource");
  rsrcPb=(LocalResourcePBImpl)LocalResource.newInstance(ConverterUtils.getYarnUrlFromPath(privRsrcPath),LocalResourceType.PATTERN,LocalResourceVisibility.PRIVATE,789L,680L,"*pattern*");
  LocalResourceProto privRsrcProto=rsrcPb.getProto();
  Path privRsrcLocalPath=new Path("/some/local/dir/for/privrsrc");
  stateStore.startResourceLocalization(user,null,privRsrcProto,privRsrcLocalPath);
  LocalizedResourceProto pubLocalizedProto1=LocalizedResourceProto.newBuilder().setResource(pubRsrcProto1).setLocalPath(pubRsrcLocalPath1.toString()).setSize(pubRsrcProto1.getSize()).build();
  stateStore.finishResourceLocalization(null,null,pubLocalizedProto1);
  LocalizedResourceProto privLocalizedProto=LocalizedResourceProto.newBuilder().setResource(privRsrcProto).setLocalPath(privRsrcLocalPath.toString()).setSize(privRsrcProto.getSize()).build();
  stateStore.finishResourceLocalization(user,null,privLocalizedProto);
  restartStateStore();
  state=stateStore.loadLocalizationState();
  pubts=state.getPublicTrackerState();
  assertEquals(1,pubts.getLocalizedResources().size());
  assertEquals(pubLocalizedProto1,pubts.getLocalizedResources().iterator().next());
  assertEquals(1,pubts.getInProgressResources().size());
  assertEquals(pubRsrcLocalPath2,pubts.getInProgressResources().get(pubRsrcProto2));
  userResources=state.getUserResources();
  assertEquals(1,userResources.size());
  rur=userResources.get(user);
  privts=rur.getPrivateTrackerState();
  assertNotNull(privts);
  assertEquals(1,privts.getLocalizedResources().size());
  assertEquals(privLocalizedProto,privts.getLocalizedResources().iterator().next());
  assertTrue(privts.getInProgressResources().isEmpty());
  assertEquals(1,rur.getAppTrackerStates().size());
  appts=rur.getAppTrackerStates().get(appId);
  assertNotNull(appts);
  assertTrue(appts.getInProgressResources().isEmpty());
  assertEquals(1,appts.getLocalizedResources().size());
  assertEquals(appLocalizedProto,appts.getLocalizedResources().iterator().next());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerTokenStorage() throws IOException {
  RecoveredContainerTokensState state=stateStore.loadContainerTokensState();
  assertNull(state.getCurrentMasterKey());
  assertNull(state.getPreviousMasterKey());
  assertTrue(state.getActiveTokens().isEmpty());
  ContainerTokenKeyGeneratorForTest keygen=new ContainerTokenKeyGeneratorForTest(new YarnConfiguration());
  MasterKey currentKey=keygen.generateKey();
  stateStore.storeContainerTokenCurrentMasterKey(currentKey);
  restartStateStore();
  state=stateStore.loadContainerTokensState();
  assertEquals(currentKey,state.getCurrentMasterKey());
  assertNull(state.getPreviousMasterKey());
  assertTrue(state.getActiveTokens().isEmpty());
  MasterKey prevKey=keygen.generateKey();
  stateStore.storeContainerTokenPreviousMasterKey(prevKey);
  restartStateStore();
  state=stateStore.loadContainerTokensState();
  assertEquals(currentKey,state.getCurrentMasterKey());
  assertEquals(prevKey,state.getPreviousMasterKey());
  assertTrue(state.getActiveTokens().isEmpty());
  ContainerId cid1=BuilderUtils.newContainerId(1,1,1,1);
  Long expTime1=1234567890L;
  ContainerId cid2=BuilderUtils.newContainerId(2,2,2,2);
  Long expTime2=9876543210L;
  stateStore.storeContainerToken(cid1,expTime1);
  stateStore.storeContainerToken(cid2,expTime2);
  restartStateStore();
  state=stateStore.loadContainerTokensState();
  assertEquals(currentKey,state.getCurrentMasterKey());
  assertEquals(prevKey,state.getPreviousMasterKey());
  Map<ContainerId,Long> loadedActiveTokens=state.getActiveTokens();
  assertEquals(2,loadedActiveTokens.size());
  assertEquals(expTime1,loadedActiveTokens.get(cid1));
  assertEquals(expTime2,loadedActiveTokens.get(cid2));
  ContainerId cid3=BuilderUtils.newContainerId(3,3,3,3);
  Long expTime3=135798642L;
  stateStore.storeContainerToken(cid3,expTime3);
  stateStore.removeContainerToken(cid1);
  expTime2+=246897531L;
  stateStore.storeContainerToken(cid2,expTime2);
  prevKey=currentKey;
  stateStore.storeContainerTokenPreviousMasterKey(prevKey);
  currentKey=keygen.generateKey();
  stateStore.storeContainerTokenCurrentMasterKey(currentKey);
  restartStateStore();
  state=stateStore.loadContainerTokensState();
  assertEquals(currentKey,state.getCurrentMasterKey());
  assertEquals(prevKey,state.getPreviousMasterKey());
  loadedActiveTokens=state.getActiveTokens();
  assertEquals(2,loadedActiveTokens.size());
  assertNull(loadedActiveTokens.get(cid1));
  assertEquals(expTime2,loadedActiveTokens.get(cid2));
  assertEquals(expTime3,loadedActiveTokens.get(cid3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.security.TestNMContainerTokenSecretManager </h4><pre class="type-9 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecovery() throws IOException {
  YarnConfiguration conf=new YarnConfiguration();
  conf.setBoolean(YarnConfiguration.NM_RECOVERY_ENABLED,true);
  final NodeId nodeId=NodeId.newInstance("somehost",1234);
  final ContainerId cid1=BuilderUtils.newContainerId(1,1,1,1);
  final ContainerId cid2=BuilderUtils.newContainerId(2,2,2,2);
  ContainerTokenKeyGeneratorForTest keygen=new ContainerTokenKeyGeneratorForTest(conf);
  NMMemoryStateStoreService stateStore=new NMMemoryStateStoreService();
  stateStore.init(conf);
  stateStore.start();
  NMContainerTokenSecretManager secretMgr=new NMContainerTokenSecretManager(conf,stateStore);
  secretMgr.setNodeId(nodeId);
  MasterKey currentKey=keygen.generateKey();
  secretMgr.setMasterKey(currentKey);
  ContainerTokenIdentifier tokenId1=createContainerTokenId(cid1,nodeId,"user1",secretMgr);
  ContainerTokenIdentifier tokenId2=createContainerTokenId(cid2,nodeId,"user2",secretMgr);
  assertNotNull(secretMgr.retrievePassword(tokenId1));
  assertNotNull(secretMgr.retrievePassword(tokenId2));
  secretMgr=new NMContainerTokenSecretManager(conf,stateStore);
  secretMgr.setNodeId(nodeId);
  secretMgr.recover();
  assertEquals(currentKey,secretMgr.getCurrentKey());
  assertTrue(secretMgr.isValidStartContainerRequest(tokenId1));
  assertTrue(secretMgr.isValidStartContainerRequest(tokenId2));
  assertNotNull(secretMgr.retrievePassword(tokenId1));
  assertNotNull(secretMgr.retrievePassword(tokenId2));
  secretMgr.startContainerSuccessful(tokenId2);
  currentKey=keygen.generateKey();
  secretMgr.setMasterKey(currentKey);
  secretMgr=new NMContainerTokenSecretManager(conf,stateStore);
  secretMgr.setNodeId(nodeId);
  secretMgr.recover();
  assertEquals(currentKey,secretMgr.getCurrentKey());
  assertTrue(secretMgr.isValidStartContainerRequest(tokenId1));
  assertFalse(secretMgr.isValidStartContainerRequest(tokenId2));
  assertNotNull(secretMgr.retrievePassword(tokenId1));
  assertNotNull(secretMgr.retrievePassword(tokenId2));
  currentKey=keygen.generateKey();
  secretMgr.setMasterKey(currentKey);
  secretMgr=new NMContainerTokenSecretManager(conf,stateStore);
  secretMgr.setNodeId(nodeId);
  secretMgr.recover();
  assertEquals(currentKey,secretMgr.getCurrentKey());
  assertTrue(secretMgr.isValidStartContainerRequest(tokenId1));
  assertFalse(secretMgr.isValidStartContainerRequest(tokenId2));
  try {
    secretMgr.retrievePassword(tokenId1);
    fail("token should not be valid");
  }
 catch (  InvalidToken e) {
  }
  try {
    secretMgr.retrievePassword(tokenId2);
    fail("token should not be valid");
  }
 catch (  InvalidToken e) {
  }
  stateStore.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.security.TestNMTokenSecretManagerInNM </h4><pre class="type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecovery() throws IOException {
  YarnConfiguration conf=new YarnConfiguration();
  conf.setBoolean(YarnConfiguration.NM_RECOVERY_ENABLED,true);
  final NodeId nodeId=NodeId.newInstance("somehost",1234);
  final ApplicationAttemptId attempt1=ApplicationAttemptId.newInstance(ApplicationId.newInstance(1,1),1);
  final ApplicationAttemptId attempt2=ApplicationAttemptId.newInstance(ApplicationId.newInstance(2,2),2);
  NMTokenKeyGeneratorForTest keygen=new NMTokenKeyGeneratorForTest();
  NMMemoryStateStoreService stateStore=new NMMemoryStateStoreService();
  stateStore.init(conf);
  stateStore.start();
  NMTokenSecretManagerInNM secretMgr=new NMTokenSecretManagerInNM(stateStore);
  secretMgr.setNodeId(nodeId);
  MasterKey currentKey=keygen.generateKey();
  secretMgr.setMasterKey(currentKey);
  NMTokenIdentifier attemptToken1=getNMTokenId(secretMgr.createNMToken(attempt1,nodeId,"user1"));
  NMTokenIdentifier attemptToken2=getNMTokenId(secretMgr.createNMToken(attempt2,nodeId,"user2"));
  secretMgr.appAttemptStartContainer(attemptToken1);
  secretMgr.appAttemptStartContainer(attemptToken2);
  assertTrue(secretMgr.isAppAttemptNMTokenKeyPresent(attempt1));
  assertTrue(secretMgr.isAppAttemptNMTokenKeyPresent(attempt2));
  assertNotNull(secretMgr.retrievePassword(attemptToken1));
  assertNotNull(secretMgr.retrievePassword(attemptToken2));
  secretMgr=new NMTokenSecretManagerInNM(stateStore);
  secretMgr.recover();
  secretMgr.setNodeId(nodeId);
  assertEquals(currentKey,secretMgr.getCurrentKey());
  assertTrue(secretMgr.isAppAttemptNMTokenKeyPresent(attempt1));
  assertTrue(secretMgr.isAppAttemptNMTokenKeyPresent(attempt2));
  assertNotNull(secretMgr.retrievePassword(attemptToken1));
  assertNotNull(secretMgr.retrievePassword(attemptToken2));
  currentKey=keygen.generateKey();
  secretMgr.setMasterKey(currentKey);
  secretMgr.appFinished(attempt1.getApplicationId());
  secretMgr=new NMTokenSecretManagerInNM(stateStore);
  secretMgr.recover();
  secretMgr.setNodeId(nodeId);
  assertEquals(currentKey,secretMgr.getCurrentKey());
  assertFalse(secretMgr.isAppAttemptNMTokenKeyPresent(attempt1));
  assertTrue(secretMgr.isAppAttemptNMTokenKeyPresent(attempt2));
  assertNotNull(secretMgr.retrievePassword(attemptToken1));
  assertNotNull(secretMgr.retrievePassword(attemptToken2));
  currentKey=keygen.generateKey();
  secretMgr.setMasterKey(currentKey);
  secretMgr=new NMTokenSecretManagerInNM(stateStore);
  secretMgr.recover();
  secretMgr.setNodeId(nodeId);
  assertEquals(currentKey,secretMgr.getCurrentKey());
  assertFalse(secretMgr.isAppAttemptNMTokenKeyPresent(attempt1));
  assertTrue(secretMgr.isAppAttemptNMTokenKeyPresent(attempt2));
  try {
    secretMgr.retrievePassword(attemptToken1);
    fail("attempt token should not still be valid");
  }
 catch (  InvalidToken e) {
  }
  assertNotNull(secretMgr.retrievePassword(attemptToken2));
  secretMgr.appFinished(attempt2.getApplicationId());
  secretMgr=new NMTokenSecretManagerInNM(stateStore);
  secretMgr.recover();
  secretMgr.setNodeId(nodeId);
  assertEquals(currentKey,secretMgr.getCurrentKey());
  assertFalse(secretMgr.isAppAttemptNMTokenKeyPresent(attempt1));
  assertFalse(secretMgr.isAppAttemptNMTokenKeyPresent(attempt2));
  try {
    secretMgr.retrievePassword(attemptToken1);
    fail("attempt token should not still be valid");
  }
 catch (  InvalidToken e) {
  }
  try {
    secretMgr.retrievePassword(attemptToken2);
    fail("attempt token should not still be valid");
  }
 catch (  InvalidToken e) {
  }
  stateStore.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.webapp.TestContainerLogsPage </h4><pre class="type-9 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testContainerLogDirs() throws IOException, YarnException {
  File absLogDir=new File("target",TestNMWebServer.class.getSimpleName() + "LogDir").getAbsoluteFile();
  String logdirwithFile=absLogDir.toURI().toString();
  Configuration conf=new Configuration();
  conf.set(YarnConfiguration.NM_LOG_DIRS,logdirwithFile);
  NodeHealthCheckerService healthChecker=new NodeHealthCheckerService();
  healthChecker.init(conf);
  LocalDirsHandlerService dirsHandler=healthChecker.getDiskHandler();
  NMContext nmContext=new NodeManager.NMContext(null,null,dirsHandler,new ApplicationACLsManager(conf),new NMNullStateStoreService());
  RecordFactory recordFactory=RecordFactoryProvider.getRecordFactory(conf);
  String user="nobody";
  long clusterTimeStamp=1234;
  ApplicationId appId=BuilderUtils.newApplicationId(recordFactory,clusterTimeStamp,1);
  Application app=mock(Application.class);
  when(app.getUser()).thenReturn(user);
  when(app.getAppId()).thenReturn(appId);
  ApplicationAttemptId appAttemptId=BuilderUtils.newApplicationAttemptId(appId,1);
  ContainerId container1=BuilderUtils.newContainerId(recordFactory,appId,appAttemptId,0);
  nmContext.getApplications().put(appId,app);
  MockContainer container=new MockContainer(appAttemptId,new AsyncDispatcher(),conf,user,appId,1);
  container.setState(ContainerState.RUNNING);
  nmContext.getContainers().put(container1,container);
  List<File> files=null;
  files=ContainerLogsUtils.getContainerLogDirs(container1,user,nmContext);
  Assert.assertTrue(!(files.get(0).toString().contains("file:")));
  nmContext.getContainers().remove(container1);
  Assert.assertNull(nmContext.getContainers().get(container1));
  files=ContainerLogsUtils.getContainerLogDirs(container1,user,nmContext);
  Assert.assertTrue(!(files.get(0).toString().contains("file:")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.nodemanager.webapp.TestNMWebServices </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerLogs() throws IOException {
  WebResource r=resource();
  final ContainerId containerId=BuilderUtils.newContainerId(0,0,0,0);
  final String containerIdStr=BuilderUtils.newContainerId(0,0,0,0).toString();
  final ApplicationAttemptId appAttemptId=containerId.getApplicationAttemptId();
  final ApplicationId appId=appAttemptId.getApplicationId();
  final String appIdStr=appId.toString();
  final String filename="logfile1";
  final String logMessage="log message\n";
  nmContext.getApplications().put(appId,new ApplicationImpl(null,"user",appId,null,nmContext));
  MockContainer container=new MockContainer(appAttemptId,new AsyncDispatcher(),new Configuration(),"user",appId,1);
  container.setState(ContainerState.RUNNING);
  nmContext.getContainers().put(containerId,container);
  Path path=dirsHandler.getLogPathForWrite(ContainerLaunch.getRelativeContainerLogDir(appIdStr,containerIdStr) + "/" + filename,false);
  File logFile=new File(path.toUri().getPath());
  logFile.deleteOnExit();
  assertTrue("Failed to create log dir",logFile.getParentFile().mkdirs());
  PrintWriter pw=new PrintWriter(logFile);
  pw.print(logMessage);
  pw.close();
  ClientResponse response=r.path("ws").path("v1").path("node").path("containerlogs").path(containerIdStr).path(filename).accept(MediaType.TEXT_PLAIN).get(ClientResponse.class);
  String responseText=response.getEntity(String.class);
  assertEquals(logMessage,responseText);
  response=r.path("ws").path("v1").path("node").path("containerlogs").path(containerIdStr).path("uhhh").accept(MediaType.TEXT_PLAIN).get(ClientResponse.class);
  Assert.assertEquals(Status.NOT_FOUND.getStatusCode(),response.getStatus());
  responseText=response.getEntity(String.class);
  assertTrue(responseText.contains("Cannot find this log on the local disk."));
  nmContext.getContainers().remove(containerId);
  Assert.assertNull(nmContext.getContainers().get(containerId));
  response=r.path("ws").path("v1").path("node").path("containerlogs").path(containerIdStr).path(filename).accept(MediaType.TEXT_PLAIN).get(ClientResponse.class);
  responseText=response.getEntity(String.class);
  assertEquals(logMessage,responseText);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestAMAuthorization </h4><pre class="type-9 type-11 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthorizedAccess() throws Exception {
  MyContainerManager containerManager=new MyContainerManager();
  rm=new MockRMWithAMS(conf,containerManager);
  rm.start();
  MockNM nm1=rm.registerNode("localhost:1234",5120);
  Map<ApplicationAccessType,String> acls=new HashMap<ApplicationAccessType,String>(2);
  acls.put(ApplicationAccessType.VIEW_APP,"*");
  RMApp app=rm.submitApp(1024,"appname","appuser",acls);
  nm1.nodeHeartbeat(true);
  int waitCount=0;
  while (containerManager.containerTokens == null && waitCount++ < 20) {
    LOG.info("Waiting for AM Launch to happen..");
    Thread.sleep(1000);
  }
  Assert.assertNotNull(containerManager.containerTokens);
  RMAppAttempt attempt=app.getCurrentAppAttempt();
  ApplicationAttemptId applicationAttemptId=attempt.getAppAttemptId();
  waitForLaunchedState(attempt);
  final Configuration conf=rm.getConfig();
  final YarnRPC rpc=YarnRPC.create(conf);
  UserGroupInformation currentUser=UserGroupInformation.createRemoteUser(applicationAttemptId.toString());
  Credentials credentials=containerManager.getContainerCredentials();
  final InetSocketAddress rmBindAddress=rm.getApplicationMasterService().getBindAddress();
  Token<? extends TokenIdentifier> amRMToken=MockRMWithAMS.setupAndReturnAMRMToken(rmBindAddress,credentials.getAllTokens());
  currentUser.addToken(amRMToken);
  ApplicationMasterProtocol client=currentUser.doAs(new PrivilegedAction<ApplicationMasterProtocol>(){
    @Override public ApplicationMasterProtocol run(){
      return (ApplicationMasterProtocol)rpc.getProxy(ApplicationMasterProtocol.class,rm.getApplicationMasterService().getBindAddress(),conf);
    }
  }
);
  RegisterApplicationMasterRequest request=Records.newRecord(RegisterApplicationMasterRequest.class);
  RegisterApplicationMasterResponse response=client.registerApplicationMaster(request);
  Assert.assertNotNull(response.getClientToAMTokenMasterKey());
  if (UserGroupInformation.isSecurityEnabled()) {
    Assert.assertTrue(response.getClientToAMTokenMasterKey().array().length > 0);
  }
  Assert.assertEquals("Register response has bad ACLs","*",response.getApplicationACLs().get(ApplicationAccessType.VIEW_APP));
}

</code></pre>

<br>
<pre class="type-11 type-2 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnauthorizedAccess() throws Exception {
  MyContainerManager containerManager=new MyContainerManager();
  rm=new MockRMWithAMS(conf,containerManager);
  rm.start();
  MockNM nm1=rm.registerNode("localhost:1234",5120);
  RMApp app=rm.submitApp(1024);
  nm1.nodeHeartbeat(true);
  int waitCount=0;
  while (containerManager.containerTokens == null && waitCount++ < 40) {
    LOG.info("Waiting for AM Launch to happen..");
    Thread.sleep(1000);
  }
  Assert.assertNotNull(containerManager.containerTokens);
  RMAppAttempt attempt=app.getCurrentAppAttempt();
  ApplicationAttemptId applicationAttemptId=attempt.getAppAttemptId();
  waitForLaunchedState(attempt);
  final Configuration conf=rm.getConfig();
  final YarnRPC rpc=YarnRPC.create(conf);
  final InetSocketAddress serviceAddr=conf.getSocketAddr(YarnConfiguration.RM_SCHEDULER_ADDRESS,YarnConfiguration.DEFAULT_RM_SCHEDULER_ADDRESS,YarnConfiguration.DEFAULT_RM_SCHEDULER_PORT);
  UserGroupInformation currentUser=UserGroupInformation.createRemoteUser(applicationAttemptId.toString());
  ApplicationMasterProtocol client=currentUser.doAs(new PrivilegedAction<ApplicationMasterProtocol>(){
    @Override public ApplicationMasterProtocol run(){
      return (ApplicationMasterProtocol)rpc.getProxy(ApplicationMasterProtocol.class,serviceAddr,conf);
    }
  }
);
  RegisterApplicationMasterRequest request=Records.newRecord(RegisterApplicationMasterRequest.class);
  try {
    client.registerApplicationMaster(request);
    Assert.fail("Should fail with authorization error");
  }
 catch (  Exception e) {
    if (isCause(AccessControlException.class,e)) {
      String expectedMessage="";
      if (UserGroupInformation.isSecurityEnabled()) {
        expectedMessage="Client cannot authenticate via:[TOKEN]";
      }
 else {
        expectedMessage="SIMPLE authentication is not enabled.  Available:[TOKEN]";
      }
      Assert.assertTrue(e.getCause().getMessage().contains(expectedMessage));
    }
 else {
      throw e;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestAppManager </h4><pre class="type-9 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testRMAppSubmitDuplicateApplicationId() throws Exception {
  ApplicationId appId=MockApps.newAppID(0);
  asContext.setApplicationId(appId);
  RMApp appOrig=rmContext.getRMApps().get(appId);
  Assert.assertTrue("app name matches but shouldn't","testApp1" != appOrig.getName());
  try {
    appMonitor.submitApplication(asContext,"test");
    Assert.fail("Exception is expected when applicationId is duplicate.");
  }
 catch (  YarnException e) {
    Assert.assertTrue("The thrown exception is not the expectd one.",e.getMessage().contains("Cannot add a duplicate!"));
  }
  RMApp app=rmContext.getRMApps().get(appId);
  Assert.assertNotNull("app is null",app);
  Assert.assertEquals("app id doesn't match",appId,app.getApplicationId());
  Assert.assertEquals("app state doesn't match",RMAppState.FINISHED,app.getState());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRMAppSubmit() throws Exception {
  appMonitor.submitApplication(asContext,"test");
  RMApp app=rmContext.getRMApps().get(appId);
  Assert.assertNotNull("app is null",app);
  Assert.assertEquals("app id doesn't match",appId,app.getApplicationId());
  Assert.assertEquals("app state doesn't match",RMAppState.NEW,app.getState());
  int timeoutSecs=0;
  while ((getAppEventType() == RMAppEventType.KILL) && timeoutSecs++ < 20) {
    Thread.sleep(1000);
  }
  Assert.assertEquals("app event type sent is wrong",RMAppEventType.START,getAppEventType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestApplicationMasterService </h4><pre class="type-9 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=1200000) public void testFinishApplicationMasterBeforeRegistering() throws Exception {
  MockRM rm=new MockRM(conf);
  try {
    rm.start();
    MockNM nm1=rm.registerNode("127.0.0.1:1234",6 * GB);
    RMApp app1=rm.submitApp(2048);
    MockAM am1=MockRM.launchAM(app1,rm,nm1);
    FinishApplicationMasterRequest req=FinishApplicationMasterRequest.newInstance(FinalApplicationStatus.FAILED,"","");
    Throwable cause=null;
    try {
      am1.unregisterAppAttempt(req,false);
    }
 catch (    Exception e) {
      cause=e.getCause();
    }
    Assert.assertNotNull(cause);
    Assert.assertTrue(cause instanceof ApplicationMasterNotRegisteredException);
    Assert.assertNotNull(cause.getMessage());
    Assert.assertTrue(cause.getMessage().contains("Application Master is trying to unregister before registering for:"));
    am1.registerAppAttempt();
    am1.unregisterAppAttempt(req,false);
  }
  finally {
    if (rm != null) {
      rm.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestClientRMService </h4><pre class="type-9 type-2 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) @SuppressWarnings("rawtypes") public void testAppSubmit() throws Exception {
  YarnScheduler yarnScheduler=mockYarnScheduler();
  RMContext rmContext=mock(RMContext.class);
  mockRMContext(yarnScheduler,rmContext);
  RMStateStore stateStore=mock(RMStateStore.class);
  when(rmContext.getStateStore()).thenReturn(stateStore);
  RMAppManager appManager=new RMAppManager(rmContext,yarnScheduler,null,mock(ApplicationACLsManager.class),new Configuration());
  when(rmContext.getDispatcher().getEventHandler()).thenReturn(new EventHandler<Event>(){
    public void handle(    Event event){
    }
  }
);
  ApplicationId appId1=getApplicationId(100);
  ApplicationACLsManager mockAclsManager=mock(ApplicationACLsManager.class);
  when(mockAclsManager.checkAccess(UserGroupInformation.getCurrentUser(),ApplicationAccessType.VIEW_APP,null,appId1)).thenReturn(true);
  QueueACLsManager mockQueueACLsManager=mock(QueueACLsManager.class);
  when(mockQueueACLsManager.checkAccess(any(UserGroupInformation.class),any(QueueACL.class),anyString())).thenReturn(true);
  ClientRMService rmService=new ClientRMService(rmContext,yarnScheduler,appManager,mockAclsManager,mockQueueACLsManager,null);
  SubmitApplicationRequest submitRequest1=mockSubmitAppRequest(appId1,null,null);
  try {
    rmService.submitApplication(submitRequest1);
  }
 catch (  YarnException e) {
    Assert.fail("Exception is not expected.");
  }
  RMApp app1=rmContext.getRMApps().get(appId1);
  Assert.assertNotNull("app doesn't exist",app1);
  Assert.assertEquals("app name doesn't match",YarnConfiguration.DEFAULT_APPLICATION_NAME,app1.getName());
  Assert.assertEquals("app queue doesn't match",YarnConfiguration.DEFAULT_QUEUE_NAME,app1.getQueue());
  String name=MockApps.newAppName();
  String queue=MockApps.newQueue();
  ApplicationId appId2=getApplicationId(101);
  SubmitApplicationRequest submitRequest2=mockSubmitAppRequest(appId2,name,queue);
  submitRequest2.getApplicationSubmissionContext().setApplicationType("matchType");
  try {
    rmService.submitApplication(submitRequest2);
  }
 catch (  YarnException e) {
    Assert.fail("Exception is not expected.");
  }
  RMApp app2=rmContext.getRMApps().get(appId2);
  Assert.assertNotNull("app doesn't exist",app2);
  Assert.assertEquals("app name doesn't match",name,app2.getName());
  Assert.assertEquals("app queue doesn't match",queue,app2.getQueue());
  try {
    rmService.submitApplication(submitRequest2);
  }
 catch (  YarnException e) {
    Assert.fail("Exception is not expected.");
  }
  GetApplicationsRequest getAllAppsRequest=GetApplicationsRequest.newInstance(new HashSet<String>());
  GetApplicationsResponse getAllApplicationsResponse=rmService.getApplications(getAllAppsRequest);
  Assert.assertEquals(5,getAllApplicationsResponse.getApplicationList().size());
  Set<String> appTypes=new HashSet<String>();
  appTypes.add("matchType");
  getAllAppsRequest=GetApplicationsRequest.newInstance(appTypes);
  getAllApplicationsResponse=rmService.getApplications(getAllAppsRequest);
  Assert.assertEquals(1,getAllApplicationsResponse.getApplicationList().size());
  Assert.assertEquals(appId2,getAllApplicationsResponse.getApplicationList().get(0).getApplicationId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestRMNodeTransitions </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdd(){
  RMNodeImpl node=getNewNode();
  ClusterMetrics cm=ClusterMetrics.getMetrics();
  int initialActive=cm.getNumActiveNMs();
  int initialLost=cm.getNumLostNMs();
  int initialUnhealthy=cm.getUnhealthyNMs();
  int initialDecommissioned=cm.getNumDecommisionedNMs();
  int initialRebooted=cm.getNumRebootedNMs();
  node.handle(new RMNodeStartedEvent(node.getNodeID(),null,null));
  Assert.assertEquals("Active Nodes",initialActive + 1,cm.getNumActiveNMs());
  Assert.assertEquals("Lost Nodes",initialLost,cm.getNumLostNMs());
  Assert.assertEquals("Unhealthy Nodes",initialUnhealthy,cm.getUnhealthyNMs());
  Assert.assertEquals("Decommissioned Nodes",initialDecommissioned,cm.getNumDecommisionedNMs());
  Assert.assertEquals("Rebooted Nodes",initialRebooted,cm.getNumRebootedNMs());
  Assert.assertEquals(NodeState.RUNNING,node.getState());
  Assert.assertNotNull(nodesListManagerEvent);
  Assert.assertEquals(NodesListManagerEventType.NODE_USABLE,nodesListManagerEvent.getType());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReconnect(){
  RMNodeImpl node=getRunningNode();
  ClusterMetrics cm=ClusterMetrics.getMetrics();
  int initialActive=cm.getNumActiveNMs();
  int initialLost=cm.getNumLostNMs();
  int initialUnhealthy=cm.getUnhealthyNMs();
  int initialDecommissioned=cm.getNumDecommisionedNMs();
  int initialRebooted=cm.getNumRebootedNMs();
  node.handle(new RMNodeReconnectEvent(node.getNodeID(),node,null));
  Assert.assertEquals("Active Nodes",initialActive,cm.getNumActiveNMs());
  Assert.assertEquals("Lost Nodes",initialLost,cm.getNumLostNMs());
  Assert.assertEquals("Unhealthy Nodes",initialUnhealthy,cm.getUnhealthyNMs());
  Assert.assertEquals("Decommissioned Nodes",initialDecommissioned,cm.getNumDecommisionedNMs());
  Assert.assertEquals("Rebooted Nodes",initialRebooted,cm.getNumRebootedNMs());
  Assert.assertEquals(NodeState.RUNNING,node.getState());
  Assert.assertNotNull(nodesListManagerEvent);
  Assert.assertEquals(NodesListManagerEventType.NODE_USABLE,nodesListManagerEvent.getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestRMRestart </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testRMRestartAppRunningAMFailed() throws Exception {
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,YarnConfiguration.DEFAULT_RM_AM_MAX_ATTEMPTS);
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  RMState rmState=memStore.getState();
  Map<ApplicationId,ApplicationState> rmAppState=rmState.getApplicationState();
  MockRM rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("127.0.0.1:1234",15120,rm1.getResourceTrackerService());
  nm1.registerNode();
  RMApp app0=rm1.submitApp(200);
  MockAM am0=launchAM(app0,rm1,nm1);
  nm1.nodeHeartbeat(am0.getApplicationAttemptId(),1,ContainerState.COMPLETE);
  am0.waitForState(RMAppAttemptState.FAILED);
  ApplicationState appState=rmAppState.get(app0.getApplicationId());
  Assert.assertEquals(RMAppAttemptState.FAILED,appState.getAttempt(am0.getApplicationAttemptId()).getState());
  Assert.assertNull(rmAppState.get(app0.getApplicationId()).getState());
  rm1.waitForState(app0.getApplicationId(),RMAppState.ACCEPTED);
  MockRM rm2=new MockRM(conf,memStore);
  rm2.start();
  rm2.waitForState(am0.getApplicationAttemptId(),RMAppAttemptState.FAILED);
  rm1.stop();
  rm2.stop();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test(timeout=180000) public void testRMRestart() throws Exception {
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,YarnConfiguration.DEFAULT_RM_AM_MAX_ATTEMPTS);
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  RMState rmState=memStore.getState();
  Map<ApplicationId,ApplicationState> rmAppState=rmState.getApplicationState();
  MockRM rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("127.0.0.1:1234",15120,rm1.getResourceTrackerService());
  MockNM nm2=new MockNM("127.0.0.2:5678",15120,rm1.getResourceTrackerService());
  nm1.registerNode();
  nm2.registerNode();
  RMApp app0=rm1.submitApp(200);
  RMAppAttempt attempt0=app0.getCurrentAppAttempt();
  Assert.assertEquals(1,rmAppState.size());
  nm1.nodeHeartbeat(true);
  MockAM am0=rm1.sendAMLaunched(attempt0.getAppAttemptId());
  am0.registerAppAttempt();
  finishApplicationMaster(app0,rm1,nm1,am0);
  RMApp app1=rm1.submitApp(200);
  ApplicationState appState=rmAppState.get(app1.getApplicationId());
  Assert.assertNotNull(appState);
  Assert.assertEquals(0,appState.getAttemptCount());
  Assert.assertEquals(appState.getApplicationSubmissionContext().getApplicationId(),app1.getApplicationSubmissionContext().getApplicationId());
  nm1.nodeHeartbeat(true);
  RMAppAttempt attempt1=app1.getCurrentAppAttempt();
  ApplicationAttemptId attemptId1=attempt1.getAppAttemptId();
  rm1.waitForState(attemptId1,RMAppAttemptState.ALLOCATED);
  Assert.assertEquals(1,appState.getAttemptCount());
  ApplicationAttemptState attemptState=appState.getAttempt(attemptId1);
  Assert.assertNotNull(attemptState);
  Assert.assertEquals(BuilderUtils.newContainerId(attemptId1,1),attemptState.getMasterContainer().getId());
  MockAM am1=rm1.sendAMLaunched(attempt1.getAppAttemptId());
  am1.registerAppAttempt();
  am1.allocate("127.0.0.1",1000,1,new ArrayList<ContainerId>());
  nm1.nodeHeartbeat(true);
  List<Container> conts=am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>()).getAllocatedContainers();
  while (conts.size() == 0) {
    nm1.nodeHeartbeat(true);
    conts.addAll(am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>()).getAllocatedContainers());
    Thread.sleep(500);
  }
  RMApp app2=rm1.submitApp(200);
  appState=rmAppState.get(app2.getApplicationId());
  Assert.assertNotNull(appState);
  Assert.assertEquals(0,appState.getAttemptCount());
  Assert.assertEquals(appState.getApplicationSubmissionContext().getApplicationId(),app2.getApplicationSubmissionContext().getApplicationId());
  RMApp appUnmanaged=rm1.submitApp(200,"someApp","someUser",null,true,null,conf.getInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,YarnConfiguration.DEFAULT_RM_AM_MAX_ATTEMPTS),null);
  ApplicationAttemptId unmanagedAttemptId=appUnmanaged.getCurrentAppAttempt().getAppAttemptId();
  ApplicationId unmanagedAppId=appUnmanaged.getApplicationId();
  appState=rmAppState.get(unmanagedAppId);
  Assert.assertNotNull(appState);
  rm1.waitForState(unmanagedAttemptId,RMAppAttemptState.LAUNCHED);
  rm1.waitForState(unmanagedAppId,RMAppState.ACCEPTED);
  Assert.assertEquals(1,appState.getAttemptCount());
  Assert.assertEquals(appState.getApplicationSubmissionContext().getApplicationId(),appUnmanaged.getApplicationSubmissionContext().getApplicationId());
  MockRM rm2=new MockRM(conf,memStore);
  rm2.start();
  nm1.setResourceTrackerService(rm2.getResourceTrackerService());
  nm2.setResourceTrackerService(rm2.getResourceTrackerService());
  Assert.assertEquals(4,rm2.getRMContext().getRMApps().size());
  rm2.waitForState(app0.getApplicationId(),RMAppState.FINISHED);
  rm2.waitForState(am0.getApplicationAttemptId(),RMAppAttemptState.FINISHED);
  RMApp loadedApp1=rm2.getRMContext().getRMApps().get(app1.getApplicationId());
  Assert.assertNotNull(loadedApp1);
  Assert.assertEquals(1,loadedApp1.getAppAttempts().size());
  Assert.assertEquals(app1.getApplicationSubmissionContext().getApplicationId(),loadedApp1.getApplicationSubmissionContext().getApplicationId());
  RMApp loadedApp2=rm2.getRMContext().getRMApps().get(app2.getApplicationId());
  Assert.assertNotNull(loadedApp2);
  Assert.assertEquals(app2.getApplicationSubmissionContext().getApplicationId(),loadedApp2.getApplicationSubmissionContext().getApplicationId());
  rm2.waitForState(loadedApp1.getApplicationId(),RMAppState.ACCEPTED);
  rm2.waitForState(loadedApp2.getApplicationId(),RMAppState.ACCEPTED);
  Assert.assertEquals(1,loadedApp1.getAppAttempts().size());
  Assert.assertEquals(1,loadedApp2.getAppAttempts().size());
  am1.setAMRMProtocol(rm2.getApplicationMasterService(),rm2.getRMContext());
  AllocateResponse allocResponse=am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>());
  Assert.assertEquals(AMCommand.AM_SHUTDOWN,allocResponse.getAMCommand());
  NodeHeartbeatResponse hbResponse=nm1.nodeHeartbeat(true);
  Assert.assertEquals(NodeAction.RESYNC,hbResponse.getNodeAction());
  hbResponse=nm2.nodeHeartbeat(true);
  Assert.assertEquals(NodeAction.RESYNC,hbResponse.getNodeAction());
  nm1=new MockNM("127.0.0.1:1234",15120,rm2.getResourceTrackerService());
  nm2=new MockNM("127.0.0.2:5678",15120,rm2.getResourceTrackerService());
  NMContainerStatus status=TestRMRestart.createNMContainerStatus(loadedApp1.getCurrentAppAttempt().getAppAttemptId(),1,ContainerState.COMPLETE);
  nm1.registerNode(Arrays.asList(status),null);
  nm2.registerNode();
  rm2.waitForState(loadedApp1.getApplicationId(),RMAppState.ACCEPTED);
  int timeoutSecs=0;
  while (loadedApp1.getAppAttempts().size() != 2 && timeoutSecs++ < 40) {
    ;
    Thread.sleep(200);
  }
  hbResponse=nm1.nodeHeartbeat(true);
  Assert.assertTrue(NodeAction.RESYNC != hbResponse.getNodeAction());
  hbResponse=nm2.nodeHeartbeat(true);
  Assert.assertTrue(NodeAction.RESYNC != hbResponse.getNodeAction());
  attempt1=loadedApp1.getCurrentAppAttempt();
  attemptId1=attempt1.getAppAttemptId();
  rm2.waitForState(attemptId1,RMAppAttemptState.ALLOCATED);
  appState=rmAppState.get(loadedApp1.getApplicationId());
  attemptState=appState.getAttempt(attemptId1);
  Assert.assertNotNull(attemptState);
  Assert.assertEquals(BuilderUtils.newContainerId(attemptId1,1),attemptState.getMasterContainer().getId());
  MockNM am1Node=nm1;
  if (attemptState.getMasterContainer().getNodeId().toString().contains("127.0.0.2")) {
    am1Node=nm2;
  }
  RMAppAttempt attempt2=loadedApp2.getCurrentAppAttempt();
  ApplicationAttemptId attemptId2=attempt2.getAppAttemptId();
  rm2.waitForState(attemptId2,RMAppAttemptState.ALLOCATED);
  appState=rmAppState.get(loadedApp2.getApplicationId());
  attemptState=appState.getAttempt(attemptId2);
  Assert.assertNotNull(attemptState);
  Assert.assertEquals(BuilderUtils.newContainerId(attemptId2,1),attemptState.getMasterContainer().getId());
  MockNM am2Node=nm1;
  if (attemptState.getMasterContainer().getNodeId().toString().contains("127.0.0.2")) {
    am2Node=nm2;
  }
  am1=rm2.sendAMLaunched(attempt1.getAppAttemptId());
  am1.registerAppAttempt();
  MockAM am2=rm2.sendAMLaunched(attempt2.getAppAttemptId());
  am2.registerAppAttempt();
  am1.allocate("127.0.0.1",1000,3,new ArrayList<ContainerId>());
  am2.allocate("127.0.0.2",1000,1,new ArrayList<ContainerId>());
  nm1.nodeHeartbeat(true);
  nm2.nodeHeartbeat(true);
  conts=am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>()).getAllocatedContainers();
  while (conts.size() == 0) {
    nm1.nodeHeartbeat(true);
    nm2.nodeHeartbeat(true);
    conts.addAll(am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>()).getAllocatedContainers());
    Thread.sleep(500);
  }
  finishApplicationMaster(loadedApp1,rm2,am1Node,am1);
  finishApplicationMaster(loadedApp2,rm2,am2Node,am2);
  rm2.stop();
  rm1.stop();
  Assert.assertEquals(4,rmAppState.size());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testRMStateStoreDispatcherDrainedOnRMStop() throws Exception {
  MemoryRMStateStore memStore=new MemoryRMStateStore(){
    volatile boolean wait=true;
    @Override public void serviceStop() throws Exception {
      wait=false;
      super.serviceStop();
    }
    @Override protected void handleStoreEvent(    RMStateStoreEvent event){
      while (wait)       ;
      super.handleStoreEvent(event);
    }
  }
;
  memStore.init(conf);
  final MockRM rm1=new MockRM(conf,memStore);
  rm1.start();
  final ArrayList<RMApp> appList=new ArrayList<RMApp>();
  final int NUM_APPS=5;
  for (int i=0; i < NUM_APPS; i++) {
    RMApp app=rm1.submitApp(200,"name","user",new HashMap<ApplicationAccessType,String>(),false,"default",-1,null,"MAPREDUCE",false);
    appList.add(app);
    rm1.waitForState(app.getApplicationId(),RMAppState.NEW_SAVING);
  }
  Map<ApplicationId,ApplicationState> rmAppState=memStore.getState().getApplicationState();
  Assert.assertTrue(rmAppState.size() == 0);
  rm1.stop();
  for (  RMApp app : appList) {
    ApplicationState appState=rmAppState.get(app.getApplicationId());
    Assert.assertNotNull(appState);
    Assert.assertEquals(0,appState.getAttemptCount());
    Assert.assertEquals(appState.getApplicationSubmissionContext().getApplicationId(),app.getApplicationSubmissionContext().getApplicationId());
  }
  Assert.assertTrue(rmAppState.size() == NUM_APPS);
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testDelegationTokenRestoredInDelegationTokenRenewer() throws Exception {
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,2);
  conf.set(CommonConfigurationKeysPublic.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  UserGroupInformation.setConfiguration(conf);
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  RMState rmState=memStore.getState();
  Map<ApplicationId,ApplicationState> rmAppState=rmState.getApplicationState();
  MockRM rm1=new TestSecurityMockRM(conf,memStore);
  rm1.start();
  HashSet<Token<RMDelegationTokenIdentifier>> tokenSet=new HashSet<Token<RMDelegationTokenIdentifier>>();
  Credentials ts=new Credentials();
  Text userText1=new Text("user1");
  RMDelegationTokenIdentifier dtId1=new RMDelegationTokenIdentifier(userText1,new Text("renewer1"),userText1);
  Token<RMDelegationTokenIdentifier> token1=new Token<RMDelegationTokenIdentifier>(dtId1,rm1.getRMContext().getRMDelegationTokenSecretManager());
  SecurityUtil.setTokenService(token1,rmAddr);
  ts.addToken(userText1,token1);
  tokenSet.add(token1);
  Text userText2=new Text("user2");
  RMDelegationTokenIdentifier dtId2=new RMDelegationTokenIdentifier(userText2,new Text("renewer2"),userText2);
  Token<RMDelegationTokenIdentifier> token2=new Token<RMDelegationTokenIdentifier>(dtId2,rm1.getRMContext().getRMDelegationTokenSecretManager());
  SecurityUtil.setTokenService(token2,rmAddr);
  ts.addToken(userText2,token2);
  tokenSet.add(token2);
  RMApp app=rm1.submitApp(200,"name","user",new HashMap<ApplicationAccessType,String>(),false,"default",1,ts);
  ApplicationState appState=rmAppState.get(app.getApplicationId());
  Assert.assertNotNull(appState);
  Assert.assertEquals(tokenSet,rm1.getRMContext().getDelegationTokenRenewer().getDelegationTokens());
  DataOutputBuffer dob=new DataOutputBuffer();
  ts.writeTokenStorageToStream(dob);
  ByteBuffer securityTokens=ByteBuffer.wrap(dob.getData(),0,dob.getLength());
  securityTokens.rewind();
  Assert.assertEquals(securityTokens,appState.getApplicationSubmissionContext().getAMContainerSpec().getTokens());
  MockRM rm2=new TestSecurityMockRM(conf,memStore);
  rm2.start();
  waitForTokensToBeRenewed(rm2);
  Assert.assertEquals(tokenSet,rm2.getRMContext().getDelegationTokenRenewer().getDelegationTokens());
  rm1.stop();
  rm2.stop();
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testFinishedAppRemovalAfterRMRestart() throws Exception {
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  conf.setInt(YarnConfiguration.RM_MAX_COMPLETED_APPLICATIONS,1);
  memStore.init(conf);
  RMState rmState=memStore.getState();
  MockRM rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("127.0.0.1:1234",15120,rm1.getResourceTrackerService());
  nm1.registerNode();
  RMApp app0=rm1.submitApp(200);
  MockAM am0=launchAM(app0,rm1,nm1);
  finishApplicationMaster(app0,rm1,nm1,am0);
  MockRM rm2=new MockRM(conf,memStore);
  rm2.start();
  nm1.setResourceTrackerService(rm2.getResourceTrackerService());
  nm1=rm2.registerNode("127.0.0.1:1234",15120);
  Map<ApplicationId,ApplicationState> rmAppState=rmState.getApplicationState();
  Assert.assertEquals(RMAppState.FINISHED,rmAppState.get(app0.getApplicationId()).getState());
  rm2.waitForState(app0.getApplicationId(),RMAppState.FINISHED);
  RMApp app1=rm2.submitApp(200);
  MockAM am1=launchAM(app1,rm2,nm1);
  finishApplicationMaster(app1,rm2,nm1,am1);
  Assert.assertNull(rm2.getRMContext().getRMApps().get(app0.getApplicationId()));
  Assert.assertNull(rmAppState.get(app0.getApplicationId()));
  rm1.stop();
  rm2.stop();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testRMRestartOnMaxAppAttempts() throws Exception {
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,YarnConfiguration.DEFAULT_RM_AM_MAX_ATTEMPTS);
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  RMState rmState=memStore.getState();
  Map<ApplicationId,ApplicationState> rmAppState=rmState.getApplicationState();
  MockRM rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("127.0.0.1:1234",15120,rm1.getResourceTrackerService());
  nm1.registerNode();
  RMApp app1=rm1.submitApp(200,"name","user",new HashMap<ApplicationAccessType,String>(),false,"default",1,null);
  RMApp app2=rm1.submitApp(200,"name","user",new HashMap<ApplicationAccessType,String>(),false,"default",-1,null);
  ApplicationState appState=rmAppState.get(app1.getApplicationId());
  Assert.assertNotNull(appState);
  Assert.assertEquals(0,appState.getAttemptCount());
  Assert.assertEquals(appState.getApplicationSubmissionContext().getApplicationId(),app1.getApplicationSubmissionContext().getApplicationId());
  nm1.nodeHeartbeat(true);
  RMAppAttempt attempt=app1.getCurrentAppAttempt();
  ApplicationAttemptId attemptId1=attempt.getAppAttemptId();
  rm1.waitForState(attemptId1,RMAppAttemptState.ALLOCATED);
  Assert.assertEquals(1,appState.getAttemptCount());
  ApplicationAttemptState attemptState=appState.getAttempt(attemptId1);
  Assert.assertNotNull(attemptState);
  Assert.assertEquals(BuilderUtils.newContainerId(attemptId1,1),attemptState.getMasterContainer().getId());
  conf.setInt(YarnConfiguration.RM_AM_EXPIRY_INTERVAL_MS,3000);
  MockRM rm2=new MockRM(conf,memStore);
  rm2.start();
  Assert.assertEquals(2,rm2.getRMContext().getRMApps().get(app2.getApplicationId()).getMaxAppAttempts());
  Assert.assertEquals(2,rm2.getRMContext().getRMApps().size());
  rm2.waitForState(app1.getApplicationId(),RMAppState.FAILED);
  rm2.waitForState(app2.getApplicationId(),RMAppState.ACCEPTED);
  Assert.assertEquals(RMAppState.FAILED,rmAppState.get(app1.getApplicationId()).getState());
  Assert.assertNull(rmAppState.get(app2.getApplicationId()).getState());
  rm1.stop();
  rm2.stop();
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testAppAttemptTokensRestoredOnRMRestart() throws Exception {
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,2);
  conf.set(CommonConfigurationKeysPublic.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  UserGroupInformation.setConfiguration(conf);
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  RMState rmState=memStore.getState();
  Map<ApplicationId,ApplicationState> rmAppState=rmState.getApplicationState();
  MockRM rm1=new TestSecurityMockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("0.0.0.0:4321",15120,rm1.getResourceTrackerService());
  nm1.registerNode();
  RMApp app1=rm1.submitApp(200,"name","user",new HashMap<ApplicationAccessType,String>(),"default");
  ApplicationState appState=rmAppState.get(app1.getApplicationId());
  Assert.assertNotNull(appState);
  nm1.nodeHeartbeat(true);
  RMAppAttempt attempt1=app1.getCurrentAppAttempt();
  ApplicationAttemptId attemptId1=attempt1.getAppAttemptId();
  rm1.waitForState(attemptId1,RMAppAttemptState.ALLOCATED);
  ApplicationAttemptState attemptState=appState.getAttempt(attemptId1);
  Assert.assertNotNull(attemptState);
  Assert.assertEquals(BuilderUtils.newContainerId(attemptId1,1),attemptState.getMasterContainer().getId());
  byte[] clientTokenMasterKey=attempt1.getClientTokenMasterKey().getEncoded();
  Credentials savedCredentials=attemptState.getAppAttemptCredentials();
  Assert.assertArrayEquals("client token master key not saved",clientTokenMasterKey,savedCredentials.getSecretKey(RMStateStore.AM_CLIENT_TOKEN_MASTER_KEY_NAME));
  MockRM rm2=new TestSecurityMockRM(conf,memStore);
  rm2.start();
  RMApp loadedApp1=rm2.getRMContext().getRMApps().get(app1.getApplicationId());
  RMAppAttempt loadedAttempt1=loadedApp1.getRMAppAttempt(attemptId1);
  Assert.assertNotNull(loadedAttempt1);
  Assert.assertEquals("client token master key not restored",attempt1.getClientTokenMasterKey(),loadedAttempt1.getClientTokenMasterKey());
  Assert.assertArrayEquals(clientTokenMasterKey,rm2.getClientToAMTokenSecretManager().getMasterKey(attemptId1).getEncoded());
  Token<AMRMTokenIdentifier> amrmToken=loadedAttempt1.getAMRMToken();
  Assert.assertArrayEquals(amrmToken.getPassword(),rm2.getRMContext().getAMRMTokenSecretManager().retrievePassword(amrmToken.decodeIdentifier()));
  rm1.stop();
  rm2.stop();
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testRMRestartWaitForPreviousSucceededAttempt() throws Exception {
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,2);
  MemoryRMStateStore memStore=new MemoryRMStateStore(){
    int count=0;
    @Override public void updateApplicationStateInternal(    ApplicationId appId,    ApplicationStateData appStateData) throws Exception {
      if (count == 0) {
        LOG.info(appId + " final state is not saved.");
        count++;
      }
 else {
        super.updateApplicationStateInternal(appId,appStateData);
      }
    }
  }
;
  memStore.init(conf);
  RMState rmState=memStore.getState();
  Map<ApplicationId,ApplicationState> rmAppState=rmState.getApplicationState();
  MockRM rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=rm1.registerNode("127.0.0.1:1234",15120);
  RMApp app0=rm1.submitApp(200);
  MockAM am0=MockRM.launchAndRegisterAM(app0,rm1,nm1);
  FinishApplicationMasterRequest req=FinishApplicationMasterRequest.newInstance(FinalApplicationStatus.SUCCEEDED,"","");
  am0.unregisterAppAttempt(req,true);
  am0.waitForState(RMAppAttemptState.FINISHING);
  Assert.assertNull(rmAppState.get(app0.getApplicationId()).getState());
  MockRM rm2=new MockRM(conf,memStore);
  nm1.setResourceTrackerService(rm2.getResourceTrackerService());
  rm2.start();
  rm2.waitForState(app0.getCurrentAppAttempt().getAppAttemptId(),RMAppAttemptState.FINISHED);
  rm2.waitForState(app0.getApplicationId(),RMAppState.FINISHED);
  Assert.assertEquals(RMAppState.FINISHED,rmAppState.get(app0.getApplicationId()).getState());
}

</code></pre>

<br>
<pre class="type-9 type-2 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60000) public void testRMDelegationTokenRestoredOnRMRestart() throws Exception {
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,2);
  conf.set(CommonConfigurationKeysPublic.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  conf.set(YarnConfiguration.RM_ADDRESS,"localhost:8032");
  UserGroupInformation.setConfiguration(conf);
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  RMState rmState=memStore.getState();
  Map<ApplicationId,ApplicationState> rmAppState=rmState.getApplicationState();
  Map<RMDelegationTokenIdentifier,Long> rmDTState=rmState.getRMDTSecretManagerState().getTokenState();
  Set<DelegationKey> rmDTMasterKeyState=rmState.getRMDTSecretManagerState().getMasterKeyState();
  MockRM rm1=new TestSecurityMockRM(conf,memStore);
  rm1.start();
  Credentials ts=new Credentials();
  GetDelegationTokenRequest request1=GetDelegationTokenRequest.newInstance("renewer1");
  UserGroupInformation.getCurrentUser().setAuthenticationMethod(AuthMethod.KERBEROS);
  GetDelegationTokenResponse response1=rm1.getClientRMService().getDelegationToken(request1);
  org.apache.hadoop.yarn.api.records.Token delegationToken1=response1.getRMDelegationToken();
  Token<RMDelegationTokenIdentifier> token1=ConverterUtils.convertFromYarn(delegationToken1,rmAddr);
  RMDelegationTokenIdentifier dtId1=token1.decodeIdentifier();
  HashSet<RMDelegationTokenIdentifier> tokenIdentSet=new HashSet<RMDelegationTokenIdentifier>();
  ts.addToken(token1.getService(),token1);
  tokenIdentSet.add(dtId1);
  RMApp app=rm1.submitApp(200,"name","user",new HashMap<ApplicationAccessType,String>(),false,"default",1,ts);
  ApplicationState appState=rmAppState.get(app.getApplicationId());
  Assert.assertNotNull(appState);
  Set<DelegationKey> allKeysRM1=rm1.getRMContext().getRMDelegationTokenSecretManager().getAllMasterKeys();
  Assert.assertEquals(allKeysRM1,rmDTMasterKeyState);
  Map<RMDelegationTokenIdentifier,Long> allTokensRM1=rm1.getRMContext().getRMDelegationTokenSecretManager().getAllTokens();
  Assert.assertEquals(tokenIdentSet,allTokensRM1.keySet());
  Assert.assertEquals(allTokensRM1,rmDTState);
  Assert.assertEquals(rm1.getRMContext().getRMDelegationTokenSecretManager().getLatestDTSequenceNumber(),rmState.getRMDTSecretManagerState().getDTSequenceNumber());
  GetDelegationTokenRequest request2=GetDelegationTokenRequest.newInstance("renewer2");
  GetDelegationTokenResponse response2=rm1.getClientRMService().getDelegationToken(request2);
  org.apache.hadoop.yarn.api.records.Token delegationToken2=response2.getRMDelegationToken();
  Token<RMDelegationTokenIdentifier> token2=ConverterUtils.convertFromYarn(delegationToken2,rmAddr);
  RMDelegationTokenIdentifier dtId2=token2.decodeIdentifier();
  try {
    rm1.getRMContext().getRMDelegationTokenSecretManager().cancelToken(token2,UserGroupInformation.getCurrentUser().getUserName());
  }
 catch (  Exception e) {
    Assert.fail();
  }
  Assert.assertEquals(rm1.getRMContext().getRMDelegationTokenSecretManager().getLatestDTSequenceNumber(),dtId2.getSequenceNumber());
  Assert.assertFalse(rmDTState.containsKey(dtId2));
  MockRM rm2=new TestSecurityMockRM(conf,memStore);
  rm2.start();
  Map<RMDelegationTokenIdentifier,Long> allTokensRM2=rm2.getRMContext().getRMDelegationTokenSecretManager().getAllTokens();
  Assert.assertEquals(allTokensRM2.keySet(),allTokensRM1.keySet());
  Assert.assertTrue(rm2.getRMContext().getRMDelegationTokenSecretManager().getAllMasterKeys().containsAll(allKeysRM1));
  Assert.assertEquals(rm1.getRMContext().getRMDelegationTokenSecretManager().getLatestDTSequenceNumber(),rm2.getRMContext().getRMDelegationTokenSecretManager().getLatestDTSequenceNumber());
  Long renewDateBeforeRenew=allTokensRM2.get(dtId1);
  try {
    Thread.sleep(1);
    rm2.getRMContext().getRMDelegationTokenSecretManager().renewToken(token1,"renewer1");
  }
 catch (  Exception e) {
    Assert.fail();
  }
  allTokensRM2=rm2.getRMContext().getRMDelegationTokenSecretManager().getAllTokens();
  Long renewDateAfterRenew=allTokensRM2.get(dtId1);
  Assert.assertTrue(renewDateAfterRenew > renewDateBeforeRenew);
  Assert.assertTrue(rmDTState.containsValue(renewDateAfterRenew));
  Assert.assertFalse(rmDTState.containsValue(renewDateBeforeRenew));
  try {
    rm2.getRMContext().getRMDelegationTokenSecretManager().cancelToken(token1,UserGroupInformation.getCurrentUser().getUserName());
  }
 catch (  Exception e) {
    Assert.fail();
  }
  allTokensRM2=rm2.getRMContext().getRMDelegationTokenSecretManager().getAllTokens();
  Assert.assertFalse(allTokensRM2.containsKey(dtId1));
  Assert.assertFalse(rmDTState.containsKey(dtId1));
  rm1.stop();
  rm2.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestResourceManager </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testNodeHealthReportIsNotNull() throws Exception {
  String host1="host1";
  final int memory=4 * 1024;
  org.apache.hadoop.yarn.server.resourcemanager.NodeManager nm1=registerNode(host1,1234,2345,NetworkTopology.DEFAULT_RACK,Resources.createResource(memory,1));
  nm1.heartbeat();
  nm1.heartbeat();
  Collection<RMNode> values=resourceManager.getRMContext().getRMNodes().values();
  for (  RMNode ni : values) {
    assertNotNull(ni.getHealthReport());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.TestWorkPreservingRMRestart </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=20000) public void testContainersNotRecoveredForCompletedApps() throws Exception {
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("127.0.0.1:1234",8192,rm1.getResourceTrackerService());
  nm1.registerNode();
  RMApp app1=rm1.submitApp(200);
  MockAM am1=MockRM.launchAndRegisterAM(app1,rm1,nm1);
  MockRM.finishAMAndVerifyAppState(app1,rm1,nm1,am1);
  rm2=new MockRM(conf,memStore);
  rm2.start();
  nm1.setResourceTrackerService(rm2.getResourceTrackerService());
  NMContainerStatus runningContainer=TestRMRestart.createNMContainerStatus(am1.getApplicationAttemptId(),2,ContainerState.RUNNING);
  NMContainerStatus completedContainer=TestRMRestart.createNMContainerStatus(am1.getApplicationAttemptId(),3,ContainerState.COMPLETE);
  nm1.registerNode(Arrays.asList(runningContainer,completedContainer),null);
  RMApp recoveredApp1=rm2.getRMContext().getRMApps().get(app1.getApplicationId());
  assertEquals(RMAppState.FINISHED,recoveredApp1.getState());
  Thread.sleep(3000);
  AbstractYarnScheduler scheduler=(AbstractYarnScheduler)rm2.getResourceScheduler();
  assertNull(scheduler.getRMContainer(runningContainer.getContainerId()));
  assertNull(scheduler.getRMContainer(completedContainer.getContainerId()));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test(timeout=20000) public void testRecoverSchedulerAppAndAttemptSynchronously() throws Exception {
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("127.0.0.1:1234",15120,rm1.getResourceTrackerService());
  nm1.registerNode();
  RMApp app0=rm1.submitApp(200);
  MockAM am0=MockRM.launchAndRegisterAM(app0,rm1,nm1);
  rm2=new MockRM(conf,memStore);
  rm2.start();
  nm1.setResourceTrackerService(rm2.getResourceTrackerService());
  Assert.assertNotNull(rm2.getResourceScheduler().getSchedulerAppInfo(am0.getApplicationAttemptId()));
  ((AbstractYarnScheduler)rm2.getResourceScheduler()).getTransferredContainers(am0.getApplicationAttemptId());
  List<NMContainerStatus> containers=createNMContainerStatusForApp(am0);
  nm1.registerNode(containers,null);
  waitForNumContainersToRecover(2,rm2,am0.getApplicationAttemptId());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test(timeout=20000) public void testAMfailedBetweenRMRestart() throws Exception {
  MemoryRMStateStore memStore=new MemoryRMStateStore();
  memStore.init(conf);
  rm1=new MockRM(conf,memStore);
  rm1.start();
  MockNM nm1=new MockNM("127.0.0.1:1234",8192,rm1.getResourceTrackerService());
  nm1.registerNode();
  RMApp app1=rm1.submitApp(200);
  MockAM am1=MockRM.launchAndRegisterAM(app1,rm1,nm1);
  rm2=new MockRM(conf,memStore);
  rm2.start();
  nm1.setResourceTrackerService(rm2.getResourceTrackerService());
  NMContainerStatus amContainer=TestRMRestart.createNMContainerStatus(am1.getApplicationAttemptId(),1,ContainerState.COMPLETE);
  NMContainerStatus runningContainer=TestRMRestart.createNMContainerStatus(am1.getApplicationAttemptId(),2,ContainerState.RUNNING);
  NMContainerStatus completedContainer=TestRMRestart.createNMContainerStatus(am1.getApplicationAttemptId(),3,ContainerState.COMPLETE);
  nm1.registerNode(Arrays.asList(amContainer,runningContainer,completedContainer),null);
  rm2.waitForState(am1.getApplicationAttemptId(),RMAppAttemptState.FAILED);
  Thread.sleep(3000);
  AbstractYarnScheduler scheduler=(AbstractYarnScheduler)rm2.getResourceScheduler();
  assertNull(scheduler.getRMContainer(runningContainer.getContainerId()));
  assertNull(scheduler.getRMContainer(completedContainer.getContainerId()));
  rm2.waitForNewAMToLaunchAndRegister(app1.getApplicationId(),2,nm1);
  MockNM nm2=new MockNM("127.1.1.1:4321",8192,rm2.getResourceTrackerService());
  NMContainerStatus previousAttemptContainer=TestRMRestart.createNMContainerStatus(am1.getApplicationAttemptId(),4,ContainerState.RUNNING);
  nm2.registerNode(Arrays.asList(previousAttemptContainer),null);
  Thread.sleep(3000);
  assertNull(scheduler.getRMContainer(previousAttemptContainer.getContainerId()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.ahs.TestRMApplicationHistoryWriter </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteContainer() throws Exception {
  RMContainer container=createRMContainer(ContainerId.newInstance(ApplicationAttemptId.newInstance(ApplicationId.newInstance(0,1),1),1));
  writer.containerStarted(container);
  ContainerHistoryData containerHD=null;
  for (int i=0; i < MAX_RETRIES; ++i) {
    containerHD=store.getContainer(ContainerId.newInstance(ApplicationAttemptId.newInstance(ApplicationId.newInstance(0,1),1),1));
    if (containerHD != null) {
      break;
    }
 else {
      Thread.sleep(100);
    }
  }
  Assert.assertNotNull(containerHD);
  Assert.assertEquals(NodeId.newInstance("test host",-100),containerHD.getAssignedNode());
  Assert.assertEquals(Resource.newInstance(-1,-1),containerHD.getAllocatedResource());
  Assert.assertEquals(Priority.UNDEFINED,containerHD.getPriority());
  Assert.assertEquals(0L,container.getCreationTime());
  writer.containerFinished(container);
  for (int i=0; i < MAX_RETRIES; ++i) {
    containerHD=store.getContainer(ContainerId.newInstance(ApplicationAttemptId.newInstance(ApplicationId.newInstance(0,1),1),1));
    if (containerHD.getContainerState() != null) {
      break;
    }
 else {
      Thread.sleep(100);
    }
  }
  Assert.assertEquals("test diagnostics info",containerHD.getDiagnosticsInfo());
  Assert.assertEquals(-1,containerHD.getContainerExitStatus());
  Assert.assertEquals(ContainerState.COMPLETE,containerHD.getContainerState());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteApplicationAttempt() throws Exception {
  RMAppAttempt appAttempt=createRMAppAttempt(ApplicationAttemptId.newInstance(ApplicationId.newInstance(0,1),1));
  writer.applicationAttemptStarted(appAttempt);
  ApplicationAttemptHistoryData appAttemptHD=null;
  for (int i=0; i < MAX_RETRIES; ++i) {
    appAttemptHD=store.getApplicationAttempt(ApplicationAttemptId.newInstance(ApplicationId.newInstance(0,1),1));
    if (appAttemptHD != null) {
      break;
    }
 else {
      Thread.sleep(100);
    }
  }
  Assert.assertNotNull(appAttemptHD);
  Assert.assertEquals("test host",appAttemptHD.getHost());
  Assert.assertEquals(-100,appAttemptHD.getRPCPort());
  Assert.assertEquals(ContainerId.newInstance(ApplicationAttemptId.newInstance(ApplicationId.newInstance(0,1),1),1),appAttemptHD.getMasterContainerId());
  writer.applicationAttemptFinished(appAttempt,RMAppAttemptState.FINISHED);
  for (int i=0; i < MAX_RETRIES; ++i) {
    appAttemptHD=store.getApplicationAttempt(ApplicationAttemptId.newInstance(ApplicationId.newInstance(0,1),1));
    if (appAttemptHD.getYarnApplicationAttemptState() != null) {
      break;
    }
 else {
      Thread.sleep(100);
    }
  }
  Assert.assertEquals("test diagnostics info",appAttemptHD.getDiagnosticsInfo());
  Assert.assertEquals("test url",appAttemptHD.getTrackingURL());
  Assert.assertEquals(FinalApplicationStatus.UNDEFINED,appAttemptHD.getFinalApplicationStatus());
  Assert.assertEquals(YarnApplicationAttemptState.FINISHED,appAttemptHD.getYarnApplicationAttemptState());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteApplication() throws Exception {
  RMApp app=createRMApp(ApplicationId.newInstance(0,1));
  writer.applicationStarted(app);
  ApplicationHistoryData appHD=null;
  for (int i=0; i < MAX_RETRIES; ++i) {
    appHD=store.getApplication(ApplicationId.newInstance(0,1));
    if (appHD != null) {
      break;
    }
 else {
      Thread.sleep(100);
    }
  }
  Assert.assertNotNull(appHD);
  Assert.assertEquals("test app",appHD.getApplicationName());
  Assert.assertEquals("test app type",appHD.getApplicationType());
  Assert.assertEquals("test user",appHD.getUser());
  Assert.assertEquals("test queue",appHD.getQueue());
  Assert.assertEquals(0L,appHD.getSubmitTime());
  Assert.assertEquals(1L,appHD.getStartTime());
  writer.applicationFinished(app,RMAppState.FINISHED);
  for (int i=0; i < MAX_RETRIES; ++i) {
    appHD=store.getApplication(ApplicationId.newInstance(0,1));
    if (appHD.getYarnApplicationState() != null) {
      break;
    }
 else {
      Thread.sleep(100);
    }
  }
  Assert.assertEquals(2L,appHD.getFinishTime());
  Assert.assertEquals("test diagnostics info",appHD.getDiagnosticsInfo());
  Assert.assertEquals(FinalApplicationStatus.UNDEFINED,appHD.getFinalApplicationStatus());
  Assert.assertEquals(YarnApplicationState.FINISHED,appHD.getYarnApplicationState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.applicationsmanager.TestAMRestart </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testAMRestartWithExistingContainers() throws Exception {
  YarnConfiguration conf=new YarnConfiguration();
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,2);
  MockRM rm1=new MockRM(conf);
  rm1.start();
  RMApp app1=rm1.submitApp(200,"name","user",new HashMap<ApplicationAccessType,String>(),false,"default",-1,null,"MAPREDUCE",false,true);
  MockNM nm1=new MockNM("127.0.0.1:1234",10240,rm1.getResourceTrackerService());
  nm1.registerNode();
  MockNM nm2=new MockNM("127.0.0.1:2351",4089,rm1.getResourceTrackerService());
  nm2.registerNode();
  MockAM am1=MockRM.launchAndRegisterAM(app1,rm1,nm1);
  int NUM_CONTAINERS=3;
  am1.allocate("127.0.0.1",1024,NUM_CONTAINERS,new ArrayList<ContainerId>());
  nm1.nodeHeartbeat(true);
  List<Container> containers=am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>()).getAllocatedContainers();
  while (containers.size() != NUM_CONTAINERS) {
    nm1.nodeHeartbeat(true);
    containers.addAll(am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>()).getAllocatedContainers());
    Thread.sleep(200);
  }
  nm1.nodeHeartbeat(am1.getApplicationAttemptId(),2,ContainerState.RUNNING);
  ContainerId containerId2=ContainerId.newInstance(am1.getApplicationAttemptId(),2);
  rm1.waitForState(nm1,containerId2,RMContainerState.RUNNING);
  nm1.nodeHeartbeat(am1.getApplicationAttemptId(),3,ContainerState.RUNNING);
  ContainerId containerId3=ContainerId.newInstance(am1.getApplicationAttemptId(),3);
  rm1.waitForState(nm1,containerId3,RMContainerState.RUNNING);
  ContainerId containerId4=ContainerId.newInstance(am1.getApplicationAttemptId(),4);
  rm1.waitForState(nm1,containerId4,RMContainerState.ACQUIRED);
  am1.allocate("127.0.0.1",1024,1,new ArrayList<ContainerId>());
  nm1.nodeHeartbeat(true);
  ContainerId containerId5=ContainerId.newInstance(am1.getApplicationAttemptId(),5);
  rm1.waitForContainerAllocated(nm1,containerId5);
  rm1.waitForState(nm1,containerId5,RMContainerState.ALLOCATED);
  am1.allocate("127.0.0.1",6000,1,new ArrayList<ContainerId>());
  ContainerId containerId6=ContainerId.newInstance(am1.getApplicationAttemptId(),6);
  nm1.nodeHeartbeat(true);
  SchedulerApplicationAttempt schedulerAttempt=((AbstractYarnScheduler)rm1.getResourceScheduler()).getCurrentAttemptForContainer(containerId6);
  while (schedulerAttempt.getReservedContainers().isEmpty()) {
    System.out.println("Waiting for container " + containerId6 + " to be reserved.");
    nm1.nodeHeartbeat(true);
    Thread.sleep(200);
  }
  Assert.assertEquals(containerId6,schedulerAttempt.getReservedContainers().get(0).getContainerId());
  nm1.nodeHeartbeat(am1.getApplicationAttemptId(),1,ContainerState.COMPLETE);
  am1.waitForState(RMAppAttemptState.FAILED);
  Thread.sleep(3000);
  rm1.waitForState(nm1,containerId2,RMContainerState.RUNNING);
  Assert.assertNull(rm1.getResourceScheduler().getRMContainer(containerId4));
  Assert.assertNull(rm1.getResourceScheduler().getRMContainer(containerId5));
  rm1.waitForState(app1.getApplicationId(),RMAppState.ACCEPTED);
  ApplicationAttemptId newAttemptId=app1.getCurrentAppAttempt().getAppAttemptId();
  Assert.assertFalse(newAttemptId.equals(am1.getApplicationAttemptId()));
  RMAppAttempt attempt2=app1.getCurrentAppAttempt();
  nm1.nodeHeartbeat(true);
  MockAM am2=rm1.sendAMLaunched(attempt2.getAppAttemptId());
  RegisterApplicationMasterResponse registerResponse=am2.registerAppAttempt();
  Assert.assertEquals(2,registerResponse.getContainersFromPreviousAttempts().size());
  boolean containerId2Exists=false, containerId3Exists=false;
  for (  Container container : registerResponse.getContainersFromPreviousAttempts()) {
    if (container.getId().equals(containerId2)) {
      containerId2Exists=true;
    }
    if (container.getId().equals(containerId3)) {
      containerId3Exists=true;
    }
  }
  Assert.assertTrue(containerId2Exists && containerId3Exists);
  rm1.waitForState(app1.getApplicationId(),RMAppState.RUNNING);
  nm1.nodeHeartbeat(am1.getApplicationAttemptId(),3,ContainerState.COMPLETE);
  RMAppAttempt newAttempt=app1.getRMAppAttempt(am2.getApplicationAttemptId());
  waitForContainersToFinish(4,newAttempt);
  boolean container3Exists=false, container4Exists=false, container5Exists=false, container6Exists=false;
  for (  ContainerStatus status : newAttempt.getJustFinishedContainers()) {
    if (status.getContainerId().equals(containerId3)) {
      container3Exists=true;
    }
    if (status.getContainerId().equals(containerId4)) {
      container4Exists=true;
    }
    if (status.getContainerId().equals(containerId5)) {
      container5Exists=true;
    }
    if (status.getContainerId().equals(containerId6)) {
      container6Exists=true;
    }
  }
  Assert.assertTrue(container3Exists && container4Exists && container5Exists&& container6Exists);
  rm1.waitForState(nm1,containerId2,RMContainerState.RUNNING);
  SchedulerApplicationAttempt schedulerNewAttempt=((AbstractYarnScheduler)rm1.getResourceScheduler()).getCurrentAttemptForContainer(containerId2);
  MockRM.finishAMAndVerifyAppState(app1,rm1,nm1,am2);
  Assert.assertFalse(schedulerNewAttempt.getLiveContainers().contains(containerId2));
  System.out.println("New attempt's just finished containers: " + newAttempt.getJustFinishedContainers());
  waitForContainersToFinish(5,newAttempt);
  rm1.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.monitor.capacity.TestProportionalCapacityPreemptionPolicy </h4><pre class="type-11 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPolicyInitializeAfterSchedulerInitialized(){
  Configuration conf=new Configuration();
  conf.set(YarnConfiguration.RM_SCHEDULER_MONITOR_POLICIES,ProportionalCapacityPreemptionPolicy.class.getCanonicalName());
  conf.setBoolean(YarnConfiguration.RM_SCHEDULER_ENABLE_MONITORS,true);
  @SuppressWarnings("resource") MockRM rm=new MockRM(conf);
  rm.init(conf);
  for (  Service service : rm.getRMActiveService().getServices()) {
    if (service instanceof SchedulingMonitor) {
      ProportionalCapacityPreemptionPolicy policy=(ProportionalCapacityPreemptionPolicy)((SchedulingMonitor)service).getSchedulingEditPolicy();
      assertNotNull(policy.getResourceCalculator());
      return;
    }
  }
  fail("Failed to find SchedulingMonitor service, please check what happened");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.rmapp.TestRMAppTransitions </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAppReport(){
  RMApp app=createNewTestApp(null);
  assertAppState(RMAppState.NEW,app);
  ApplicationReport report=app.createAndGetApplicationReport(null,true);
  Assert.assertNotNull(report.getApplicationResourceUsageReport());
  Assert.assertEquals(report.getApplicationResourceUsageReport(),RMServerUtils.DUMMY_APPLICATION_RESOURCE_USAGE_REPORT);
  report=app.createAndGetApplicationReport("clientuser",true);
  Assert.assertNotNull(report.getApplicationResourceUsageReport());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.rmapp.attempt.TestRMAppAttemptTransitions </h4><pre class="type-7 type-15 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetClientToken() throws Exception {
  assumeTrue(isSecurityEnabled);
  Container amContainer=allocateApplicationAttempt();
  Token<ClientToAMTokenIdentifier> token=applicationAttempt.createClientToken(null);
  Assert.assertNull(token);
  token=applicationAttempt.createClientToken("clientuser");
  Assert.assertNull(token);
  launchApplicationAttempt(amContainer);
  token=applicationAttempt.createClientToken(null);
  Assert.assertNull(token);
  token=applicationAttempt.createClientToken("clientuser");
  Assert.assertNotNull(token);
  applicationAttempt.handle(new RMAppAttemptEvent(applicationAttempt.getAppAttemptId(),RMAppAttemptEventType.KILL));
  assertEquals(YarnApplicationAttemptState.LAUNCHED,applicationAttempt.createApplicationAttemptState());
  sendAttemptUpdateSavedEvent(applicationAttempt);
  token=applicationAttempt.createClientToken(null);
  Assert.assertNull(token);
  token=applicationAttempt.createClientToken("clientuser");
  Assert.assertNull(token);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.rmcontainer.TestRMContainerImpl </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testExistenceOfResourceRequestInRMContainer() throws Exception {
  Configuration conf=new Configuration();
  MockRM rm1=new MockRM(conf);
  rm1.start();
  MockNM nm1=rm1.registerNode("unknownhost:1234",8000);
  RMApp app1=rm1.submitApp(1024);
  MockAM am1=MockRM.launchAndRegisterAM(app1,rm1,nm1);
  ResourceScheduler scheduler=rm1.getResourceScheduler();
  am1.allocate("127.0.0.1",1024,1,new ArrayList<ContainerId>());
  ContainerId containerId2=ContainerId.newInstance(am1.getApplicationAttemptId(),2);
  rm1.waitForState(nm1,containerId2,RMContainerState.ALLOCATED);
  Assert.assertNotNull(scheduler.getRMContainer(containerId2).getResourceRequests());
  am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>()).getAllocatedContainers();
  rm1.waitForState(nm1,containerId2,RMContainerState.ACQUIRED);
  Assert.assertNull(scheduler.getRMContainer(containerId2).getResourceRequests());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.TestQueueMetrics </h4><pre class="type-9 type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testMetricsCache(){
  MetricsSystem ms=new MetricsSystemImpl("cache");
  ms.start();
  try {
    String p1="root1";
    String leafQueueName="root1.leaf";
    QueueMetrics p1Metrics=QueueMetrics.forQueue(ms,p1,null,true,conf);
    Queue parentQueue1=make(stub(Queue.class).returning(p1Metrics).from.getMetrics());
    QueueMetrics metrics=QueueMetrics.forQueue(ms,leafQueueName,parentQueue1,true,conf);
    Assert.assertNotNull("QueueMetrics for A shoudn't be null",metrics);
    QueueMetrics alterMetrics=QueueMetrics.forQueue(ms,leafQueueName,parentQueue1,true,conf);
    Assert.assertNotNull("QueueMetrics for alterMetrics shoudn't be null",alterMetrics);
  }
  finally {
    ms.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testQueueAppMetricsForMultipleFailures(){
  String queueName="single";
  String user="alice";
  QueueMetrics metrics=QueueMetrics.forQueue(ms,queueName,null,false,new Configuration());
  MetricsSource queueSource=queueSource(ms,queueName);
  AppSchedulingInfo app=mockApp(user);
  metrics.submitApp(user);
  MetricsSource userSource=userSource(ms,queueName,user);
  checkApps(queueSource,1,0,0,0,0,0,true);
  metrics.submitAppAttempt(user);
  checkApps(queueSource,1,1,0,0,0,0,true);
  metrics.runAppAttempt(app.getApplicationId(),user);
  checkApps(queueSource,1,0,1,0,0,0,true);
  metrics.finishAppAttempt(app.getApplicationId(),app.isPending(),app.getUser());
  checkApps(queueSource,1,0,0,0,0,0,true);
  metrics.submitAppAttempt(user);
  checkApps(queueSource,1,1,0,0,0,0,true);
  metrics.runAppAttempt(app.getApplicationId(),user);
  checkApps(queueSource,1,0,1,0,0,0,true);
  metrics.finishAppAttempt(app.getApplicationId(),app.isPending(),app.getUser());
  checkApps(queueSource,1,0,0,0,0,0,true);
  metrics.submitAppAttempt(user);
  checkApps(queueSource,1,1,0,0,0,0,true);
  metrics.runAppAttempt(app.getApplicationId(),user);
  checkApps(queueSource,1,0,1,0,0,0,true);
  metrics.finishAppAttempt(app.getApplicationId(),app.isPending(),app.getUser());
  checkApps(queueSource,1,0,0,0,0,0,true);
  metrics.finishApp(user,RMAppState.FAILED);
  checkApps(queueSource,1,0,0,0,1,0,true);
  assertNull(userSource);
}

</code></pre>

<br>
<pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testDefaultSingleQueueMetrics(){
  String queueName="single";
  String user="alice";
  QueueMetrics metrics=QueueMetrics.forQueue(ms,queueName,null,false,conf);
  MetricsSource queueSource=queueSource(ms,queueName);
  AppSchedulingInfo app=mockApp(user);
  metrics.submitApp(user);
  MetricsSource userSource=userSource(ms,queueName,user);
  checkApps(queueSource,1,0,0,0,0,0,true);
  metrics.submitAppAttempt(user);
  checkApps(queueSource,1,1,0,0,0,0,true);
  metrics.setAvailableResourcesToQueue(Resources.createResource(100 * GB,100));
  metrics.incrPendingResources(user,5,Resources.createResource(3 * GB,3));
  checkResources(queueSource,0,0,0,0,0,100 * GB,100,15 * GB,15,5,0,0,0);
  metrics.runAppAttempt(app.getApplicationId(),user);
  checkApps(queueSource,1,0,1,0,0,0,true);
  metrics.allocateResources(user,3,Resources.createResource(2 * GB,2),true);
  checkResources(queueSource,6 * GB,6,3,3,0,100 * GB,100,9 * GB,9,2,0,0,0);
  metrics.releaseResources(user,1,Resources.createResource(2 * GB,2));
  checkResources(queueSource,4 * GB,4,2,3,1,100 * GB,100,9 * GB,9,2,0,0,0);
  metrics.finishAppAttempt(app.getApplicationId(),app.isPending(),app.getUser());
  checkApps(queueSource,1,0,0,0,0,0,true);
  metrics.finishApp(user,RMAppState.FINISHED);
  checkApps(queueSource,1,0,0,1,0,0,true);
  assertNull(userSource);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.TestCapacityScheduler </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testRecoverRequestAfterPreemption() throws Exception {
  Configuration conf=new Configuration();
  conf.setClass(YarnConfiguration.RM_SCHEDULER,CapacityScheduler.class,ResourceScheduler.class);
  MockRM rm1=new MockRM(conf);
  rm1.start();
  MockNM nm1=rm1.registerNode("127.0.0.1:1234",8000);
  RMApp app1=rm1.submitApp(1024);
  MockAM am1=MockRM.launchAndRegisterAM(app1,rm1,nm1);
  CapacityScheduler cs=(CapacityScheduler)rm1.getResourceScheduler();
  am1.allocate("127.0.0.1",1024,1,new ArrayList<ContainerId>());
  ContainerId containerId1=ContainerId.newInstance(am1.getApplicationAttemptId(),2);
  rm1.waitForState(nm1,containerId1,RMContainerState.ALLOCATED);
  RMContainer rmContainer=cs.getRMContainer(containerId1);
  List<ResourceRequest> requests=rmContainer.getResourceRequests();
  FiCaSchedulerApp app=cs.getApplicationAttempt(am1.getApplicationAttemptId());
  FiCaSchedulerNode node=cs.getNode(rmContainer.getAllocatedNode());
  for (  ResourceRequest request : requests) {
    if (request.getResourceName().equals(node.getRackName()) || request.getResourceName().equals(ResourceRequest.ANY)) {
      continue;
    }
    Assert.assertNull(app.getResourceRequest(request.getPriority(),request.getResourceName()));
  }
  cs.killContainer(rmContainer);
  Assert.assertEquals(3,requests.size());
  for (  ResourceRequest request : requests) {
    Assert.assertEquals(1,app.getResourceRequest(request.getPriority(),request.getResourceName()).getNumContainers());
  }
  ContainerId containerId2=ContainerId.newInstance(am1.getApplicationAttemptId(),3);
  rm1.waitForState(nm1,containerId2,RMContainerState.ALLOCATED);
  List<Container> containers=am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>()).getAllocatedContainers();
  Assert.assertTrue(containers.size() == 1);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCapacitySchedulerInfo() throws Exception {
  QueueInfo queueInfo=resourceManager.getResourceScheduler().getQueueInfo("a",true,true);
  Assert.assertEquals(queueInfo.getQueueName(),"a");
  Assert.assertEquals(queueInfo.getChildQueues().size(),2);
  List<QueueUserACLInfo> userACLInfo=resourceManager.getResourceScheduler().getQueueUserAclInfo();
  Assert.assertNotNull(userACLInfo);
  for (  QueueUserACLInfo queueUserACLInfo : userACLInfo) {
    Assert.assertEquals(getQueueCount(userACLInfo,queueUserACLInfo.getQueueName()),1);
  }
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAppsInQueue() throws Exception {
  Application application_0=new Application("user_0","a1",resourceManager);
  application_0.submit();
  Application application_1=new Application("user_0","a2",resourceManager);
  application_1.submit();
  Application application_2=new Application("user_0","b2",resourceManager);
  application_2.submit();
  ResourceScheduler scheduler=resourceManager.getResourceScheduler();
  List<ApplicationAttemptId> appsInA1=scheduler.getAppsInQueue("a1");
  assertEquals(1,appsInA1.size());
  List<ApplicationAttemptId> appsInA=scheduler.getAppsInQueue("a");
  assertTrue(appsInA.contains(application_0.getApplicationAttemptId()));
  assertTrue(appsInA.contains(application_1.getApplicationAttemptId()));
  assertEquals(2,appsInA.size());
  List<ApplicationAttemptId> appsInRoot=scheduler.getAppsInQueue("root");
  assertTrue(appsInRoot.contains(application_0.getApplicationAttemptId()));
  assertTrue(appsInRoot.contains(application_1.getApplicationAttemptId()));
  assertTrue(appsInRoot.contains(application_2.getApplicationAttemptId()));
  assertEquals(3,appsInRoot.size());
  Assert.assertNull(scheduler.getAppsInQueue("nonexistentqueue"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.TestContainerAllocation </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerTokenGeneratedOnPullRequest() throws Exception {
  MockRM rm1=new MockRM(conf);
  rm1.start();
  MockNM nm1=rm1.registerNode("127.0.0.1:1234",8000);
  RMApp app1=rm1.submitApp(200);
  MockAM am1=MockRM.launchAndRegisterAM(app1,rm1,nm1);
  am1.allocate("127.0.0.1",1024,1,new ArrayList<ContainerId>());
  ContainerId containerId2=ContainerId.newInstance(am1.getApplicationAttemptId(),2);
  rm1.waitForState(nm1,containerId2,RMContainerState.ALLOCATED);
  RMContainer container=rm1.getResourceScheduler().getRMContainer(containerId2);
  Assert.assertEquals(containerId2,container.getContainerId());
  Assert.assertNull(container.getContainer().getContainerToken());
  List<Container> containers=am1.allocate(new ArrayList<ResourceRequest>(),new ArrayList<ContainerId>()).getAllocatedContainers();
  Assert.assertEquals(containerId2,containers.get(0).getId());
  Assert.assertNotNull(containers.get(0).getContainerToken());
  rm1.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.TestFairScheduler </h4><pre class="type-9 type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testRecoverRequestAfterPreemption() throws Exception {
  conf.setLong(FairSchedulerConfiguration.WAIT_TIME_BEFORE_KILL,10);
  MockClock clock=new MockClock();
  scheduler.setClock(clock);
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  Priority priority=Priority.newInstance(20);
  String host="127.0.0.1";
  int GB=1024;
  RMNode node=MockNodes.newNodeInfo(1,Resources.createResource(16 * 1024,4),0,host);
  NodeAddedSchedulerEvent nodeEvent=new NodeAddedSchedulerEvent(node);
  scheduler.handle(nodeEvent);
  List<ResourceRequest> ask=new ArrayList<ResourceRequest>();
  ResourceRequest nodeLocalRequest=createResourceRequest(GB,1,host,priority.getPriority(),1,true);
  ResourceRequest rackLocalRequest=createResourceRequest(GB,1,node.getRackName(),priority.getPriority(),1,true);
  ResourceRequest offRackRequest=createResourceRequest(GB,1,ResourceRequest.ANY,priority.getPriority(),1,true);
  ask.add(nodeLocalRequest);
  ask.add(rackLocalRequest);
  ask.add(offRackRequest);
  ApplicationAttemptId appAttemptId=createSchedulingRequest("queueA","user1",ask);
  scheduler.update();
  NodeUpdateSchedulerEvent nodeUpdate=new NodeUpdateSchedulerEvent(node);
  scheduler.handle(nodeUpdate);
  assertEquals(1,scheduler.getSchedulerApp(appAttemptId).getLiveContainers().size());
  FSAppAttempt app=scheduler.getSchedulerApp(appAttemptId);
  Assert.assertNull(app.getResourceRequest(priority,host));
  ContainerId containerId1=ContainerId.newInstance(appAttemptId,1);
  RMContainer rmContainer=app.getRMContainer(containerId1);
  scheduler.warnOrKillContainer(rmContainer);
  clock.tick(5);
  scheduler.warnOrKillContainer(rmContainer);
  List<ResourceRequest> requests=rmContainer.getResourceRequests();
  Assert.assertEquals(3,requests.size());
  for (  ResourceRequest request : requests) {
    Assert.assertEquals(1,app.getResourceRequest(priority,request.getResourceName()).getNumContainers());
  }
  scheduler.update();
  scheduler.handle(nodeUpdate);
  List<Container> containers=scheduler.allocate(appAttemptId,Collections.<ResourceRequest>emptyList(),Collections.<ContainerId>emptyList(),null,null).getContainers();
  Assert.assertTrue(containers.size() == 1);
}

</code></pre>

<br>
<pre class="type-11 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects are null
"></span><br>
@Test public void testDefaultRuleInitializesProperlyWhenPolicyNotConfigured() throws IOException {
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  conf.setBoolean(FairSchedulerConfiguration.ALLOW_UNDECLARED_POOLS,false);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("</allocations>");
  out.close();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  List<QueuePlacementRule> rules=scheduler.allocConf.placementPolicy.getRules();
  for (  QueuePlacementRule rule : rules) {
    if (rule instanceof Default) {
      Default defaultRule=(Default)rule;
      assertNotNull(defaultRule.defaultQueueName);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testAclSubmitApplication() throws Exception {
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<queue name=\"root\">");
  out.println("  <aclSubmitApps> </aclSubmitApps>");
  out.println("  <aclAdministerApps> </aclAdministerApps>");
  out.println("  <queue name=\"queue1\">");
  out.println("    <aclSubmitApps>norealuserhasthisname</aclSubmitApps>");
  out.println("    <aclAdministerApps>norealuserhasthisname</aclAdministerApps>");
  out.println("  </queue>");
  out.println("</queue>");
  out.println("</allocations>");
  out.close();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  ApplicationAttemptId attId1=createSchedulingRequest(1024,"queue1","norealuserhasthisname",1);
  ApplicationAttemptId attId2=createSchedulingRequest(1024,"queue1","norealuserhasthisname2",1);
  FSAppAttempt app1=scheduler.getSchedulerApp(attId1);
  assertNotNull("The application was not allowed",app1);
  FSAppAttempt app2=scheduler.getSchedulerApp(attId2);
  assertNull("The application was allowed",app2);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testAssignToNonLeafQueueReturnsNull() throws Exception {
  conf.set(FairSchedulerConfiguration.USER_AS_DEFAULT_QUEUE,"true");
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  scheduler.getQueueManager().getLeafQueue("root.child1.granchild",true);
  scheduler.getQueueManager().getLeafQueue("root.child2",true);
  RMApp rmApp1=new MockRMApp(0,0,RMAppState.NEW);
  RMApp rmApp2=new MockRMApp(1,1,RMAppState.NEW);
  assertNull(scheduler.assignToQueue(rmApp1,"root.child1","tintin"));
  assertNotNull(scheduler.assignToQueue(rmApp2,"root.child2","snowy"));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHierarchicalQueueAllocationFileParsing() throws IOException, SAXException, AllocationConfigurationException, ParserConfigurationException {
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<queue name=\"queueA\">");
  out.println("<minResources>2048mb,0vcores</minResources>");
  out.println("</queue>");
  out.println("<queue name=\"queueB\">");
  out.println("<minResources>2048mb,0vcores</minResources>");
  out.println("<queue name=\"queueC\">");
  out.println("<minResources>2048mb,0vcores</minResources>");
  out.println("</queue>");
  out.println("<queue name=\"queueD\">");
  out.println("<minResources>2048mb,0vcores</minResources>");
  out.println("</queue>");
  out.println("</queue>");
  out.println("</allocations>");
  out.close();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  QueueManager queueManager=scheduler.getQueueManager();
  Collection<FSLeafQueue> leafQueues=queueManager.getLeafQueues();
  Assert.assertEquals(4,leafQueues.size());
  Assert.assertNotNull(queueManager.getLeafQueue("queueA",false));
  Assert.assertNotNull(queueManager.getLeafQueue("queueB.queueC",false));
  Assert.assertNotNull(queueManager.getLeafQueue("queueB.queueD",false));
  Assert.assertNotNull(queueManager.getLeafQueue("default",false));
  Assert.assertEquals(4,leafQueues.size());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHierarchicalQueuesSimilarParents() throws IOException {
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  QueueManager queueManager=scheduler.getQueueManager();
  FSLeafQueue leafQueue=queueManager.getLeafQueue("parent.child",true);
  Assert.assertEquals(2,queueManager.getLeafQueues().size());
  Assert.assertNotNull(leafQueue);
  Assert.assertEquals("root.parent.child",leafQueue.getName());
  FSLeafQueue leafQueue2=queueManager.getLeafQueue("parent",true);
  Assert.assertNull(leafQueue2);
  Assert.assertEquals(2,queueManager.getLeafQueues().size());
  FSLeafQueue leafQueue3=queueManager.getLeafQueue("parent.child.grandchild",true);
  Assert.assertNull(leafQueue3);
  Assert.assertEquals(2,queueManager.getLeafQueues().size());
  FSLeafQueue leafQueue4=queueManager.getLeafQueue("parent.sister",true);
  Assert.assertNotNull(leafQueue4);
  Assert.assertEquals("root.parent.sister",leafQueue4.getName());
  Assert.assertEquals(3,queueManager.getLeafQueues().size());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigureRootQueue() throws Exception {
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<defaultQueueSchedulingPolicy>fair</defaultQueueSchedulingPolicy>");
  out.println("<queue name=\"root\">");
  out.println("  <schedulingPolicy>drf</schedulingPolicy>");
  out.println("  <queue name=\"child1\">");
  out.println("    <minResources>1024mb,1vcores</minResources>");
  out.println("  </queue>");
  out.println("  <queue name=\"child2\">");
  out.println("    <minResources>1024mb,4vcores</minResources>");
  out.println("  </queue>");
  out.println("</queue>");
  out.println("</allocations>");
  out.close();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  QueueManager queueManager=scheduler.getQueueManager();
  FSQueue root=queueManager.getRootQueue();
  assertTrue(root.getPolicy() instanceof DominantResourceFairnessPolicy);
  assertNotNull(queueManager.getLeafQueue("child1",false));
  assertNotNull(queueManager.getLeafQueue("child2",false));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyQueueName() throws Exception {
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  assertEquals(1,scheduler.getQueueManager().getLeafQueues().size());
  ApplicationAttemptId appAttemptId=createAppAttemptId(1,1);
  AppAddedSchedulerEvent appAddedEvent=new AppAddedSchedulerEvent(appAttemptId.getApplicationId(),"","user1");
  scheduler.handle(appAddedEvent);
  assertEquals(1,scheduler.getQueueManager().getLeafQueues().size());
  assertNull(scheduler.getSchedulerApp(appAttemptId));
  assertEquals(0,resourceManager.getRMContext().getRMApps().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.TestQueueManager </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testReloadTurnsLeafQueueIntoParent() throws Exception {
  updateConfiguredLeafQueues(queueManager,"queue1");
  updateConfiguredLeafQueues(queueManager,"queue1.queue2");
  assertNull(queueManager.getLeafQueue("queue1",false));
  assertNotNull(queueManager.getLeafQueue("queue1.queue2",false));
  updateConfiguredLeafQueues(queueManager,"queue1");
  assertNull(queueManager.getLeafQueue("queue1.queue2",false));
  assertNotNull(queueManager.getLeafQueue("queue1",false));
  notEmptyQueues.add(queueManager.getLeafQueue("queue1",false));
  updateConfiguredLeafQueues(queueManager,"queue1.queue2");
  assertNull(queueManager.getLeafQueue("queue1.queue2",false));
  assertNotNull(queueManager.getLeafQueue("queue1",false));
  notEmptyQueues.clear();
  updateConfiguredLeafQueues(queueManager,"queue1.queue2");
  notEmptyQueues.add(queueManager.getQueue("root.queue1"));
  updateConfiguredLeafQueues(queueManager,"queue1");
  assertNotNull(queueManager.getLeafQueue("queue1.queue2",false));
  assertNull(queueManager.getLeafQueue("queue1",false));
  updateConfiguredLeafQueues(queueManager,"default.queue3");
  assertNull(queueManager.getLeafQueue("default.queue3",false));
  assertNotNull(queueManager.getLeafQueue("default",false));
}

</code></pre>

<br>
<pre class="type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReloadTurnsLeafToParentWithNoLeaf(){
  AllocationConfiguration allocConf=new AllocationConfiguration(conf);
  allocConf.configuredQueues.get(FSQueueType.LEAF).add("root.queue1");
  queueManager.updateAllocationConfiguration(allocConf);
  assertNotNull(queueManager.getLeafQueue("root.queue1",false));
  notEmptyQueues.add(queueManager.getLeafQueue("root.queue1",false));
  allocConf=new AllocationConfiguration(conf);
  allocConf.configuredQueues.get(FSQueueType.PARENT).add("root.queue1");
  queueManager.updateAllocationConfiguration(allocConf);
  assertNotNull(queueManager.getLeafQueue("root.queue1",false));
  assertNull(queueManager.getParentQueue("root.queue1",false));
  notEmptyQueues.clear();
  queueManager.updateAllocationConfiguration(allocConf);
  assertNull(queueManager.getLeafQueue("root.queue1",false));
  assertNotNull(queueManager.getParentQueue("root.queue1",false));
  assertTrue(queueManager.getParentQueue("root.queue1",false).getChildQueues().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.TestQueuePlacementPolicy </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testNestedUserQueueParsing() throws Exception {
  StringBuffer sb=new StringBuffer();
  sb.append("<queuePlacementPolicy>");
  sb.append("  <rule name='specified' />");
  sb.append("  <rule name='nestedUserQueue'>");
  sb.append("       <rule name='primaryGroup'/>");
  sb.append("  </rule>");
  sb.append("  <rule name='default' />");
  sb.append("</queuePlacementPolicy>");
  Throwable th=null;
  try {
    parse(sb.toString());
  }
 catch (  Exception e) {
    th=e;
  }
  assertNull(th);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.scheduler.fifo.TestFifoScheduler </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAppsInQueue() throws Exception {
  Application application_0=new Application("user_0",resourceManager);
  application_0.submit();
  Application application_1=new Application("user_0",resourceManager);
  application_1.submit();
  ResourceScheduler scheduler=resourceManager.getResourceScheduler();
  List<ApplicationAttemptId> appsInDefault=scheduler.getAppsInQueue("default");
  assertTrue(appsInDefault.contains(application_0.getApplicationAttemptId()));
  assertTrue(appsInDefault.contains(application_1.getApplicationAttemptId()));
  assertEquals(2,appsInDefault.size());
  Assert.assertNull(scheduler.getAppsInQueue("someotherqueue"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.security.TestAMRMTokens </h4><pre class="type-9 type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate master-key-roll-over and that tokens are usable even after
 * master-key-roll-over.
 * @throws Exception
 */
@Test public void testMasterKeyRollOver() throws Exception {
  conf.setLong(YarnConfiguration.RM_AMRM_TOKEN_MASTER_KEY_ROLLING_INTERVAL_SECS,rolling_interval_sec);
  conf.setLong(YarnConfiguration.RM_AM_EXPIRY_INTERVAL_MS,am_expire_ms);
  MyContainerManager containerManager=new MyContainerManager();
  final MockRMWithAMS rm=new MockRMWithAMS(conf,containerManager);
  rm.start();
  Long startTime=System.currentTimeMillis();
  final Configuration conf=rm.getConfig();
  final YarnRPC rpc=YarnRPC.create(conf);
  ApplicationMasterProtocol rmClient=null;
  AMRMTokenSecretManager appTokenSecretManager=rm.getRMContext().getAMRMTokenSecretManager();
  MasterKeyData oldKey=appTokenSecretManager.getMasterKey();
  Assert.assertNotNull(oldKey);
  try {
    MockNM nm1=rm.registerNode("localhost:1234",5120);
    RMApp app=rm.submitApp(1024);
    nm1.nodeHeartbeat(true);
    int waitCount=0;
    while (containerManager.containerTokens == null && waitCount++ < maxWaitAttempts) {
      LOG.info("Waiting for AM Launch to happen..");
      Thread.sleep(1000);
    }
    Assert.assertNotNull(containerManager.containerTokens);
    RMAppAttempt attempt=app.getCurrentAppAttempt();
    ApplicationAttemptId applicationAttemptId=attempt.getAppAttemptId();
    UserGroupInformation currentUser=UserGroupInformation.createRemoteUser(applicationAttemptId.toString());
    Credentials credentials=containerManager.getContainerCredentials();
    final InetSocketAddress rmBindAddress=rm.getApplicationMasterService().getBindAddress();
    Token<? extends TokenIdentifier> amRMToken=MockRMWithAMS.setupAndReturnAMRMToken(rmBindAddress,credentials.getAllTokens());
    currentUser.addToken(amRMToken);
    rmClient=createRMClient(rm,conf,rpc,currentUser);
    RegisterApplicationMasterRequest request=Records.newRecord(RegisterApplicationMasterRequest.class);
    rmClient.registerApplicationMaster(request);
    AllocateRequest allocateRequest=Records.newRecord(AllocateRequest.class);
    Assert.assertTrue(rmClient.allocate(allocateRequest).getAMCommand() == null);
    while (System.currentTimeMillis() - startTime < rolling_interval_sec * 1000) {
      rmClient.allocate(allocateRequest);
      Thread.sleep(500);
    }
    MasterKeyData newKey=appTokenSecretManager.getMasterKey();
    Assert.assertNotNull(newKey);
    Assert.assertFalse("Master key should have changed!",oldKey.equals(newKey));
    rpc.stopProxy(rmClient,conf);
    rmClient=createRMClient(rm,conf,rpc,currentUser);
    Assert.assertTrue(rmClient.allocate(allocateRequest).getAMCommand() == null);
    waitCount=0;
    while (waitCount++ <= maxWaitAttempts) {
      if (appTokenSecretManager.getCurrnetMasterKeyData() != oldKey) {
        break;
      }
      try {
        rmClient.allocate(allocateRequest);
      }
 catch (      Exception ex) {
        break;
      }
      Thread.sleep(200);
    }
    Assert.assertTrue(appTokenSecretManager.getCurrnetMasterKeyData().equals(newKey));
    Assert.assertTrue(appTokenSecretManager.getMasterKey().equals(newKey));
    Assert.assertTrue(appTokenSecretManager.getNextMasterKeyData() == null);
    Token<AMRMTokenIdentifier> newToken=appTokenSecretManager.createAndGetAMRMToken(applicationAttemptId);
    SecurityUtil.setTokenService(newToken,rmBindAddress);
    currentUser.addToken(newToken);
    rpc.stopProxy(rmClient,conf);
    rmClient=createRMClient(rm,conf,rpc,currentUser);
    allocateRequest=Records.newRecord(AllocateRequest.class);
    Assert.assertTrue(rmClient.allocate(allocateRequest).getAMCommand() == null);
    rpc.stopProxy(rmClient,conf);
    try {
      currentUser.addToken(amRMToken);
      rmClient=createRMClient(rm,conf,rpc,currentUser);
      allocateRequest=Records.newRecord(AllocateRequest.class);
      Assert.assertTrue(rmClient.allocate(allocateRequest).getAMCommand() == null);
      Assert.fail("The old Token should not work");
    }
 catch (    Exception ex) {
    }
  }
  finally {
    rm.stop();
    if (rmClient != null) {
      rpc.stopProxy(rmClient,conf);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=20000) public void testAMRMMasterKeysUpdate() throws Exception {
  MockRM rm=new MockRM(conf){
    @Override protected void doSecureLogin() throws IOException {
    }
  }
;
  rm.start();
  MockNM nm=rm.registerNode("127.0.0.1:1234",8000);
  RMApp app=rm.submitApp(200);
  MockAM am=MockRM.launchAndRegisterAM(app,rm,nm);
  AllocateResponse response=am.allocate(Records.newRecord(AllocateRequest.class));
  Assert.assertNull(response.getAMRMToken());
  rm.getRMContext().getAMRMTokenSecretManager().rollMasterKey();
  response=am.allocate(Records.newRecord(AllocateRequest.class));
  Assert.assertNotNull(response.getAMRMToken());
  Token<AMRMTokenIdentifier> amrmToken=ConverterUtils.convertFromYarn(response.getAMRMToken(),new Text(response.getAMRMToken().getService()));
  Assert.assertEquals(amrmToken.decodeIdentifier().getKeyId(),rm.getRMContext().getAMRMTokenSecretManager().getMasterKey().getMasterKey().getKeyId());
  response=am.allocate(Records.newRecord(AllocateRequest.class));
  Assert.assertNull(response.getAMRMToken());
  rm.getRMContext().getAMRMTokenSecretManager().activateNextMasterKey();
  response=am.allocate(Records.newRecord(AllocateRequest.class));
  Assert.assertNull(response.getAMRMToken());
  rm.stop();
}

</code></pre>

<br>
<pre class="type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate that application tokens are unusable after the
 * application-finishes.
 * @throws Exception
 */
@SuppressWarnings("unchecked") @Test public void testTokenExpiry() throws Exception {
  MyContainerManager containerManager=new MyContainerManager();
  final MockRMWithAMS rm=new MockRMWithAMS(conf,containerManager);
  rm.start();
  final Configuration conf=rm.getConfig();
  final YarnRPC rpc=YarnRPC.create(conf);
  ApplicationMasterProtocol rmClient=null;
  try {
    MockNM nm1=rm.registerNode("localhost:1234",5120);
    RMApp app=rm.submitApp(1024);
    nm1.nodeHeartbeat(true);
    int waitCount=0;
    while (containerManager.containerTokens == null && waitCount++ < 20) {
      LOG.info("Waiting for AM Launch to happen..");
      Thread.sleep(1000);
    }
    Assert.assertNotNull(containerManager.containerTokens);
    RMAppAttempt attempt=app.getCurrentAppAttempt();
    ApplicationAttemptId applicationAttemptId=attempt.getAppAttemptId();
    UserGroupInformation currentUser=UserGroupInformation.createRemoteUser(applicationAttemptId.toString());
    Credentials credentials=containerManager.getContainerCredentials();
    final InetSocketAddress rmBindAddress=rm.getApplicationMasterService().getBindAddress();
    Token<? extends TokenIdentifier> amRMToken=MockRMWithAMS.setupAndReturnAMRMToken(rmBindAddress,credentials.getAllTokens());
    currentUser.addToken(amRMToken);
    rmClient=createRMClient(rm,conf,rpc,currentUser);
    RegisterApplicationMasterRequest request=Records.newRecord(RegisterApplicationMasterRequest.class);
    rmClient.registerApplicationMaster(request);
    FinishApplicationMasterRequest finishAMRequest=Records.newRecord(FinishApplicationMasterRequest.class);
    finishAMRequest.setFinalApplicationStatus(FinalApplicationStatus.SUCCEEDED);
    finishAMRequest.setDiagnostics("diagnostics");
    finishAMRequest.setTrackingUrl("url");
    rmClient.finishApplicationMaster(finishAMRequest);
    ContainerStatus containerStatus=BuilderUtils.newContainerStatus(attempt.getMasterContainer().getId(),ContainerState.COMPLETE,"AM Container Finished",0);
    rm.getRMContext().getDispatcher().getEventHandler().handle(new RMAppAttemptContainerFinishedEvent(applicationAttemptId,containerStatus));
    int count=0;
    while (attempt.getState() != RMAppAttemptState.FINISHED && count < maxWaitAttempts) {
      Thread.sleep(100);
      count++;
    }
    Assert.assertTrue(attempt.getState() == RMAppAttemptState.FINISHED);
    rpc.stopProxy(rmClient,conf);
    rmClient=createRMClient(rm,conf,rpc,currentUser);
    AllocateRequest allocateRequest=Records.newRecord(AllocateRequest.class);
    try {
      rmClient.allocate(allocateRequest);
      Assert.fail("You got to be kidding me! " + "Using App tokens after app-finish should fail!");
    }
 catch (    Throwable t) {
      LOG.info("Exception found is ",t);
      Assert.assertTrue(t.getCause().getMessage().contains(applicationAttemptId.toString() + " not found in AMRMTokenSecretManager."));
    }
  }
  finally {
    rm.stop();
    if (rmClient != null) {
      rpc.stopProxy(rmClient,conf);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.resourcemanager.security.TestClientToAMTokens </h4><pre class="type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientToAMTokens() throws Exception {
  final Configuration conf=new Configuration();
  conf.set(CommonConfigurationKeysPublic.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
  UserGroupInformation.setConfiguration(conf);
  ContainerManagementProtocol containerManager=mock(ContainerManagementProtocol.class);
  StartContainersResponse mockResponse=mock(StartContainersResponse.class);
  when(containerManager.startContainers((StartContainersRequest)any())).thenReturn(mockResponse);
  final DrainDispatcher dispatcher=new DrainDispatcher();
  MockRM rm=new MockRMWithCustomAMLauncher(conf,containerManager){
    protected ClientRMService createClientRMService(){
      return new ClientRMService(this.rmContext,scheduler,this.rmAppManager,this.applicationACLsManager,this.queueACLsManager,getRMContext().getRMDelegationTokenSecretManager());
    }
    @Override protected Dispatcher createDispatcher(){
      return dispatcher;
    }
    @Override protected void doSecureLogin() throws IOException {
    }
  }
;
  rm.start();
  RMApp app=rm.submitApp(1024);
  MockNM nm1=rm.registerNode("localhost:1234",3072);
  nm1.nodeHeartbeat(true);
  dispatcher.await();
  nm1.nodeHeartbeat(true);
  dispatcher.await();
  ApplicationAttemptId appAttempt=app.getCurrentAppAttempt().getAppAttemptId();
  final MockAM mockAM=new MockAM(rm.getRMContext(),rm.getApplicationMasterService(),app.getCurrentAppAttempt().getAppAttemptId());
  UserGroupInformation appUgi=UserGroupInformation.createRemoteUser(appAttempt.toString());
  RegisterApplicationMasterResponse response=appUgi.doAs(new PrivilegedAction<RegisterApplicationMasterResponse>(){
    @Override public RegisterApplicationMasterResponse run(){
      RegisterApplicationMasterResponse response=null;
      try {
        response=mockAM.registerAppAttempt();
      }
 catch (      Exception e) {
        Assert.fail("Exception was not expected");
      }
      return response;
    }
  }
);
  GetApplicationReportRequest request=Records.newRecord(GetApplicationReportRequest.class);
  request.setApplicationId(app.getApplicationId());
  GetApplicationReportResponse reportResponse=rm.getClientRMService().getApplicationReport(request);
  ApplicationReport appReport=reportResponse.getApplicationReport();
  org.apache.hadoop.yarn.api.records.Token originalClientToAMToken=appReport.getClientToAMToken();
  Assert.assertNotNull(response.getClientToAMTokenMasterKey());
  Assert.assertTrue(response.getClientToAMTokenMasterKey().array().length > 0);
  ApplicationAttemptId appAttemptId=app.getAppAttempts().keySet().iterator().next();
  Assert.assertNotNull(appAttemptId);
  final CustomAM am=new CustomAM(appAttemptId,response.getClientToAMTokenMasterKey().array());
  am.init(conf);
  am.start();
  SecurityUtil.setSecurityInfoProviders(new CustomSecurityInfo());
  try {
    CustomProtocol client=(CustomProtocol)RPC.getProxy(CustomProtocol.class,1L,am.address,conf);
    client.ping();
    fail("Access by unauthenticated user should fail!!");
  }
 catch (  Exception e) {
    Assert.assertFalse(am.pinged);
  }
  Token<ClientToAMTokenIdentifier> token=ConverterUtils.convertFromYarn(originalClientToAMToken,am.address);
  verifyTokenWithTamperedID(conf,am,token);
  verifyTokenWithTamperedUserName(conf,am,token);
  verifyValidToken(conf,am,token);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.timeline.TestLeveldbTimelineStore </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRootDirPermission() throws IOException {
  FileSystem fs=FileSystem.getLocal(new YarnConfiguration());
  FileStatus file=fs.getFileStatus(new Path(fsPath.getAbsolutePath(),LeveldbTimelineStore.FILENAME));
  assertNotNull(file);
  assertEquals(LeveldbTimelineStore.LEVELDB_DIR_UMASK,file.getPermission());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.timeline.webapp.TestCrossOriginFilterInitializer </h4><pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFilterParameters(){
  Configuration conf=new Configuration();
  conf.set(CrossOriginFilterInitializer.PREFIX + "rootparam","rootvalue");
  conf.set(CrossOriginFilterInitializer.PREFIX + "nested.param","nestedvalue");
  conf.set("outofscopeparam","outofscopevalue");
  Map<String,String> filterParameters=CrossOriginFilterInitializer.getFilterParameters(conf);
  String rootvalue=filterParameters.get(CrossOriginFilterInitializer.PREFIX + "rootparam");
  String nestedvalue=filterParameters.get(CrossOriginFilterInitializer.PREFIX + "nested.param");
  String outofscopeparam=filterParameters.get("outofscopeparam");
  Assert.assertEquals("Could not find filter parameter","rootvalue",rootvalue);
  Assert.assertEquals("Could not find filter parameter","nestedvalue",nestedvalue);
  Assert.assertNull("Found unexpected value in filter parameters",outofscopeparam);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.timeline.webapp.TestTimelineWebServices </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEvents() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").path("type_1").path("events").queryParam("entityId","id_1").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineEvents events=response.getEntity(TimelineEvents.class);
  Assert.assertNotNull(events);
  Assert.assertEquals(1,events.getAllEvents().size());
  TimelineEvents.EventsOfOneEntity partEvents=events.getAllEvents().get(0);
  Assert.assertEquals(2,partEvents.getEvents().size());
  TimelineEvent event1=partEvents.getEvents().get(0);
  Assert.assertEquals(456l,event1.getTimestamp());
  Assert.assertEquals("end_event",event1.getEventType());
  Assert.assertEquals(1,event1.getEventInfo().size());
  TimelineEvent event2=partEvents.getEvents().get(1);
  Assert.assertEquals(123l,event2.getTimestamp());
  Assert.assertEquals("start_event",event2.getEventType());
  Assert.assertEquals(0,event2.getEventInfo().size());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPostEntitiesWithYarnACLsEnabled() throws Exception {
  AdminACLsManager oldAdminACLsManager=timelineACLsManager.setAdminACLsManager(adminACLsManager);
  try {
    TimelineEntities entities=new TimelineEntities();
    TimelineEntity entity=new TimelineEntity();
    entity.setEntityId("test id 2");
    entity.setEntityType("test type 2");
    entity.setStartTime(System.currentTimeMillis());
    entities.addEntity(entity);
    WebResource r=resource();
    ClientResponse response=r.path("ws").path("v1").path("timeline").queryParam("user.name","tester").accept(MediaType.APPLICATION_JSON).type(MediaType.APPLICATION_JSON).post(ClientResponse.class,entities);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    TimelinePutResponse putResponse=response.getEntity(TimelinePutResponse.class);
    Assert.assertNotNull(putResponse);
    Assert.assertEquals(0,putResponse.getErrors().size());
    response=r.path("ws").path("v1").path("timeline").queryParam("user.name","other").accept(MediaType.APPLICATION_JSON).type(MediaType.APPLICATION_JSON).post(ClientResponse.class,entities);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    putResponse=response.getEntity(TimelinePutResponse.class);
    Assert.assertNotNull(putResponse);
    Assert.assertEquals(1,putResponse.getErrors().size());
    Assert.assertEquals(TimelinePutResponse.TimelinePutError.ACCESS_DENIED,putResponse.getErrors().get(0).getErrorCode());
  }
  finally {
    timelineACLsManager.setAdminACLsManager(oldAdminACLsManager);
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEntityFields1() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").path("type_1").path("id_1").queryParam("fields","events,otherinfo").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineEntity entity=response.getEntity(TimelineEntity.class);
  Assert.assertNotNull(entity);
  Assert.assertEquals("id_1",entity.getEntityId());
  Assert.assertEquals("type_1",entity.getEntityType());
  Assert.assertEquals(123l,entity.getStartTime().longValue());
  Assert.assertEquals(2,entity.getEvents().size());
  Assert.assertEquals(0,entity.getPrimaryFilters().size());
  Assert.assertEquals(4,entity.getOtherInfo().size());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEntityWithYarnACLsEnabled() throws Exception {
  AdminACLsManager oldAdminACLsManager=timelineACLsManager.setAdminACLsManager(adminACLsManager);
  try {
    TimelineEntities entities=new TimelineEntities();
    TimelineEntity entity=new TimelineEntity();
    entity.setEntityId("test id 3");
    entity.setEntityType("test type 3");
    entity.setStartTime(System.currentTimeMillis());
    entities.addEntity(entity);
    WebResource r=resource();
    ClientResponse response=r.path("ws").path("v1").path("timeline").queryParam("user.name","tester").accept(MediaType.APPLICATION_JSON).type(MediaType.APPLICATION_JSON).post(ClientResponse.class,entities);
    response=r.path("ws").path("v1").path("timeline").path("test type 3").path("test id 3").queryParam("user.name","tester").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    entity=response.getEntity(TimelineEntity.class);
    Assert.assertNull(entity.getPrimaryFilters().get(TimelineStore.SystemFilter.ENTITY_OWNER.toString()));
    response=r.path("ws").path("v1").path("timeline").path("test type 3").path("test id 3").queryParam("fields","relatedentities").queryParam("user.name","tester").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    entity=response.getEntity(TimelineEntity.class);
    Assert.assertNull(entity.getPrimaryFilters().get(TimelineStore.SystemFilter.ENTITY_OWNER.toString()));
    response=r.path("ws").path("v1").path("timeline").path("test type 3").path("test id 3").queryParam("fields","primaryfilters").queryParam("user.name","tester").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    entity=response.getEntity(TimelineEntity.class);
    Assert.assertNull(entity.getPrimaryFilters().get(TimelineStore.SystemFilter.ENTITY_OWNER.toString()));
    response=r.path("ws").path("v1").path("timeline").path("test type 3").path("test id 3").queryParam("user.name","other").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
    assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
    assertEquals(ClientResponse.Status.NOT_FOUND,response.getClientResponseStatus());
  }
  finally {
    timelineACLsManager.setAdminACLsManager(oldAdminACLsManager);
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEntityFields2() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").path("type_1").path("id_1").queryParam("fields","lasteventonly," + "primaryfilters,relatedentities").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineEntity entity=response.getEntity(TimelineEntity.class);
  Assert.assertNotNull(entity);
  Assert.assertEquals("id_1",entity.getEntityId());
  Assert.assertEquals("type_1",entity.getEntityType());
  Assert.assertEquals(123l,entity.getStartTime().longValue());
  Assert.assertEquals(1,entity.getEvents().size());
  Assert.assertEquals(4,entity.getPrimaryFilters().size());
  Assert.assertEquals(0,entity.getOtherInfo().size());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbout() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineWebServices.AboutInfo about=response.getEntity(TimelineWebServices.AboutInfo.class);
  Assert.assertNotNull(about);
  Assert.assertEquals("Timeline API",about.getAbout());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPostEntities() throws Exception {
  TimelineEntities entities=new TimelineEntities();
  TimelineEntity entity=new TimelineEntity();
  entity.setEntityId("test id 1");
  entity.setEntityType("test type 1");
  entity.setStartTime(System.currentTimeMillis());
  entities.addEntity(entity);
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").accept(MediaType.APPLICATION_JSON).type(MediaType.APPLICATION_JSON).post(ClientResponse.class,entities);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  assertEquals(ClientResponse.Status.FORBIDDEN,response.getClientResponseStatus());
  response=r.path("ws").path("v1").path("timeline").queryParam("user.name","tester").accept(MediaType.APPLICATION_JSON).type(MediaType.APPLICATION_JSON).post(ClientResponse.class,entities);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelinePutResponse putResposne=response.getEntity(TimelinePutResponse.class);
  Assert.assertNotNull(putResposne);
  Assert.assertEquals(0,putResposne.getErrors().size());
  response=r.path("ws").path("v1").path("timeline").path("test type 1").path("test id 1").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  entity=response.getEntity(TimelineEntity.class);
  Assert.assertNotNull(entity);
  Assert.assertEquals("test id 1",entity.getEntityId());
  Assert.assertEquals("test type 1",entity.getEntityType());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEntity() throws Exception {
  WebResource r=resource();
  ClientResponse response=r.path("ws").path("v1").path("timeline").path("type_1").path("id_1").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  TimelineEntity entity=response.getEntity(TimelineEntity.class);
  Assert.assertNotNull(entity);
  Assert.assertEquals("id_1",entity.getEntityId());
  Assert.assertEquals("type_1",entity.getEntityType());
  Assert.assertEquals(123l,entity.getStartTime().longValue());
  Assert.assertEquals(2,entity.getEvents().size());
  Assert.assertEquals(4,entity.getPrimaryFilters().size());
  Assert.assertEquals(4,entity.getOtherInfo().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.timeline.webapp.TestTimelineWebServicesWithSSL </h4><pre class="type-7 type-10 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPutEntities() throws Exception {
  TestTimelineClient client=new TestTimelineClient();
  try {
    client.init(conf);
    client.start();
    TimelineEntity expectedEntity=new TimelineEntity();
    expectedEntity.setEntityType("test entity type");
    expectedEntity.setEntityId("test entity id");
    TimelineEvent event=new TimelineEvent();
    event.setEventType("test event type");
    event.setTimestamp(0L);
    expectedEntity.addEvent(event);
    TimelinePutResponse response=client.putEntities(expectedEntity);
    Assert.assertEquals(0,response.getErrors().size());
    Assert.assertTrue(client.resp.toString().contains("https"));
    TimelineEntity actualEntity=store.getEntity(expectedEntity.getEntityId(),expectedEntity.getEntityType(),EnumSet.allOf(Field.class));
    Assert.assertNotNull(actualEntity);
    Assert.assertEquals(expectedEntity.getEntityId(),actualEntity.getEntityId());
    Assert.assertEquals(expectedEntity.getEntityType(),actualEntity.getEntityType());
  }
  finally {
    client.stop();
    client.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.utils.TestLeveldbIterator </h4><pre class="type-9 type-2 type-7 type-10 type-1 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExceptionHandling() throws Exception {
  InvocationHandler rtExcHandler=new InvocationHandler(){
    @Override public Object invoke(    Object proxy,    Method method,    Object[] args) throws Throwable {
      throw new RuntimeException("forced runtime error");
    }
  }
;
  DBIterator dbiter=(DBIterator)Proxy.newProxyInstance(DBIterator.class.getClassLoader(),new Class[]{DBIterator.class},rtExcHandler);
  LeveldbIterator iter=new LeveldbIterator(dbiter);
  for (  CallInfo ci : RTEXC_METHODS) {
    Method method=iter.getClass().getMethod(ci.methodName,ci.argTypes);
    assertNotNull("unable to locate method " + ci.methodName,method);
    try {
      method.invoke(iter,ci.args);
      fail("operation should have thrown");
    }
 catch (    InvocationTargetException ite) {
      Throwable exc=ite.getTargetException();
      assertTrue("Method " + ci.methodName + " threw non-DBException: "+ exc,exc instanceof DBException);
      assertFalse("Method " + ci.methodName + " double-wrapped DBException",exc.getCause() instanceof DBException);
    }
  }
  try {
    iter.close();
    fail("operation shoul have thrown");
  }
 catch (  IOException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.webproxy.TestProxyUriUtils </h4><pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testGetProxyUriFromPluginsReturnsValidUriWhenAble() throws URISyntaxException {
  ApplicationId id=BuilderUtils.newApplicationId(6384623l,5);
  List<TrackingUriPlugin> list=Lists.newArrayListWithExpectedSize(2);
  list.add(new TrackingUriPlugin(){
    public URI getTrackingUri(    ApplicationId id) throws URISyntaxException {
      return null;
    }
  }
);
  list.add(new TrackingUriPlugin(){
    public URI getTrackingUri(    ApplicationId id) throws URISyntaxException {
      return new URI("http://history.server.net/");
    }
  }
);
  URI result=ProxyUriUtils.getUriFromTrackingPlugins(id,list);
  assertNotNull(result);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testGetProxyUriFromPluginsReturnsNullIfNoPlugins() throws URISyntaxException {
  ApplicationId id=BuilderUtils.newApplicationId(6384623l,5);
  List<TrackingUriPlugin> list=Lists.newArrayListWithExpectedSize(0);
  assertNull(ProxyUriUtils.getUriFromTrackingPlugins(id,list));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.webproxy.TestWebAppProxyServlet </h4><pre class="type-9 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test main method of WebAppProxyServer
 */
@Test(timeout=5000) public void testWebAppProxyServerMainMethod() throws Exception {
  WebAppProxyServer mainServer=null;
  Configuration conf=new YarnConfiguration();
  conf.set(YarnConfiguration.PROXY_ADDRESS,"localhost:9099");
  try {
    mainServer=WebAppProxyServer.startServer(conf);
    int counter=20;
    URL wrongUrl=new URL("http://localhost:9099/proxy/app");
    HttpURLConnection proxyConn=null;
    while (counter > 0) {
      counter--;
      try {
        proxyConn=(HttpURLConnection)wrongUrl.openConnection();
        proxyConn.connect();
        proxyConn.getResponseCode();
        counter=0;
      }
 catch (      Exception e) {
        Thread.sleep(100);
      }
    }
    assertNotNull(proxyConn);
    assertEquals(HttpURLConnection.HTTP_INTERNAL_ERROR,proxyConn.getResponseCode());
  }
  finally {
    if (mainServer != null) {
      mainServer.stop();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.server.webproxy.amfilter.TestAmFilterInitializer </h4><pre class="type-1 type-6 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitFilter(){
  MockFilterContainer con=new MockFilterContainer();
  Configuration conf=new Configuration(false);
  conf.set(YarnConfiguration.PROXY_ADDRESS,"host1:1000");
  AmFilterInitializer afi=new MockAmFilterInitializer();
  assertNull(con.givenParameters);
  afi.initFilter(con,conf);
  assertEquals(2,con.givenParameters.size());
  assertEquals("host1",con.givenParameters.get(AmIpFilter.PROXY_HOSTS));
  assertEquals("http://host1:1000/foo",con.givenParameters.get(AmIpFilter.PROXY_URI_BASES));
  con=new MockFilterContainer();
  conf=new Configuration(false);
  conf.set(YarnConfiguration.RM_WEBAPP_ADDRESS,"host2:2000");
  afi=new MockAmFilterInitializer();
  assertNull(con.givenParameters);
  afi.initFilter(con,conf);
  assertEquals(2,con.givenParameters.size());
  assertEquals("host2",con.givenParameters.get(AmIpFilter.PROXY_HOSTS));
  assertEquals("http://host2:2000/foo",con.givenParameters.get(AmIpFilter.PROXY_URI_BASES));
  con=new MockFilterContainer();
  conf=new Configuration(false);
  conf.setBoolean(YarnConfiguration.RM_HA_ENABLED,true);
  conf.set(YarnConfiguration.RM_HA_IDS,"rm1,rm2,rm3");
  conf.set(YarnConfiguration.RM_WEBAPP_ADDRESS + ".rm1","host2:2000");
  conf.set(YarnConfiguration.RM_WEBAPP_ADDRESS + ".rm2","host3:3000");
  conf.set(YarnConfiguration.RM_WEBAPP_ADDRESS + ".rm3","host4:4000");
  afi=new MockAmFilterInitializer();
  assertNull(con.givenParameters);
  afi.initFilter(con,conf);
  assertEquals(2,con.givenParameters.size());
  String[] proxyHosts=con.givenParameters.get(AmIpFilter.PROXY_HOSTS).split(AmIpFilter.PROXY_HOSTS_DELIMITER);
  assertEquals(3,proxyHosts.length);
  Arrays.sort(proxyHosts);
  assertEquals("host2",proxyHosts[0]);
  assertEquals("host3",proxyHosts[1]);
  assertEquals("host4",proxyHosts[2]);
  String[] proxyBases=con.givenParameters.get(AmIpFilter.PROXY_URI_BASES).split(AmIpFilter.PROXY_URI_BASES_DELIMITER);
  assertEquals(3,proxyBases.length);
  Arrays.sort(proxyBases);
  assertEquals("http://host2:2000/foo",proxyBases[0]);
  assertEquals("http://host3:3000/foo",proxyBases[1]);
  assertEquals("http://host4:4000/foo",proxyBases[2]);
  con=new MockFilterContainer();
  conf=new Configuration(false);
  conf.set(YarnConfiguration.YARN_HTTP_POLICY_KEY,HttpConfig.Policy.HTTPS_ONLY.toString());
  conf.setBoolean(YarnConfiguration.RM_HA_ENABLED,true);
  conf.set(YarnConfiguration.RM_HA_IDS,"rm1,rm2");
  conf.set(YarnConfiguration.RM_WEBAPP_HTTPS_ADDRESS + ".rm1","host5:5000");
  conf.set(YarnConfiguration.RM_WEBAPP_HTTPS_ADDRESS + ".rm2","host6:6000");
  afi=new MockAmFilterInitializer();
  assertNull(con.givenParameters);
  afi.initFilter(con,conf);
  assertEquals(2,con.givenParameters.size());
  proxyHosts=con.givenParameters.get(AmIpFilter.PROXY_HOSTS).split(AmIpFilter.PROXY_HOSTS_DELIMITER);
  assertEquals(2,proxyHosts.length);
  Arrays.sort(proxyHosts);
  assertEquals("host5",proxyHosts[0]);
  assertEquals("host6",proxyHosts[1]);
  proxyBases=con.givenParameters.get(AmIpFilter.PROXY_URI_BASES).split(AmIpFilter.PROXY_URI_BASES_DELIMITER);
  assertEquals(2,proxyBases.length);
  Arrays.sort(proxyBases);
  assertEquals("https://host5:5000/foo",proxyBases[0]);
  assertEquals("https://host6:6000/foo",proxyBases[1]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.sls.appmaster.TestAMSimulator </h4><pre class="type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAMSimulator() throws Exception {
  MockAMSimulator app=new MockAMSimulator();
  List<ContainerSimulator> containers=new ArrayList<ContainerSimulator>();
  app.init(1,1000,containers,rm,null,0,1000000l,"user1","default",false,"app1");
  app.firstStep();
  Assert.assertEquals(1,rm.getRMContext().getRMApps().size());
  Assert.assertNotNull(rm.getRMContext().getRMApps().get(app.appId));
  app.lastStep();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.util.TestConverterUtils </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testContainerIdNull() throws URISyntaxException {
  assertNull(ConverterUtils.toString((ContainerId)null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.util.TestResourceCalculatorProcessTree </h4><pre class="type-1 type-21 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateInstance(){
  ResourceCalculatorProcessTree tree;
  tree=ResourceCalculatorProcessTree.getResourceCalculatorProcessTree("1",EmptyProcessTree.class,new Configuration());
  assertNotNull(tree);
  assertThat(tree,instanceOf(EmptyProcessTree.class));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-21 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreatedInstanceConfigured(){
  ResourceCalculatorProcessTree tree;
  Configuration conf=new Configuration();
  tree=ResourceCalculatorProcessTree.getResourceCalculatorProcessTree("1",EmptyProcessTree.class,conf);
  assertNotNull(tree);
  assertThat(tree.getConf(),sameInstance(conf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.util.TestYarnVersionInfo </h4><pre class="type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the yarn version info routines.
 * @throws IOException
 */
@Test public void versionInfoGenerated() throws IOException {
  assertTrue("getVersion returned Unknown",!YarnVersionInfo.getVersion().equals("Unknown"));
  assertTrue("getUser returned Unknown",!YarnVersionInfo.getUser().equals("Unknown"));
  assertTrue("getSrcChecksum returned Unknown",!YarnVersionInfo.getSrcChecksum().equals("Unknown"));
  assertNotNull("getUrl returned null",YarnVersionInfo.getUrl());
  assertNotNull("getRevision returned null",YarnVersionInfo.getRevision());
  assertNotNull("getBranch returned null",YarnVersionInfo.getBranch());
  assertTrue("getBuildVersion check doesn't contain: source checksum",YarnVersionInfo.getBuildVersion().contains("source checksum"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.yarn.webapp.hamlet.TestParseSelector </h4><pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingId(){
  String[] res=parseSelector(".class");
  assertNull(res[S_ID]);
  assertEquals("class",res[S_CLASS]);
}

</code></pre>

<br>
<pre class="type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingClass(){
  String[] res=parseSelector("#id");
  assertEquals("id",res[S_ID]);
  assertNull(res[S_CLASS]);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
