<h3 style="margin:0px">Class: org.apache.hadoop.io.TestMapFile (21 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-2 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Writer} constructor with IOException
 */
@Test public void testPathExplosionWriterCreation(){
  Path path=new Path(TEST_DIR,"testPathExplosionWriterCreation.mapfile");
  String TEST_ERROR_MESSAGE="Mkdirs failed to create directory " + path.getName();
  MapFile.Writer writer=null;
  try {
    FileSystem fsSpy=spy(FileSystem.get(conf));
    Path pathSpy=spy(path);
    when(fsSpy.mkdirs(path)).thenThrow(new IOException(TEST_ERROR_MESSAGE));
    when(pathSpy.getFileSystem(conf)).thenReturn(fsSpy);
    writer=new MapFile.Writer(conf,pathSpy,MapFile.Writer.keyClass(IntWritable.class),MapFile.Writer.valueClass(IntWritable.class));
    fail("fail in testPathExplosionWriterCreation !!!");
  }
 catch (  IOException ex) {
    assertEquals("testPathExplosionWriterCreation ex message error !!!",ex.getMessage(),TEST_ERROR_MESSAGE);
  }
catch (  Exception e) {
    fail("fail in testPathExplosionWriterCreation. Other ex !!!");
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<pre class="type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test throwing {@code IOException} in {@code MapFile.Writer} constructor    
 */
@Test public void testWriteWithFailDirCreation(){
  String ERROR_MESSAGE="Mkdirs failed to create directory";
  Path dirName=new Path(TEST_DIR,"fail.mapfile");
  MapFile.Writer writer=null;
  try {
    FileSystem fs=FileSystem.getLocal(conf);
    FileSystem spyFs=spy(fs);
    Path pathSpy=spy(dirName);
    when(pathSpy.getFileSystem(conf)).thenReturn(spyFs);
    when(spyFs.mkdirs(dirName)).thenReturn(false);
    writer=new MapFile.Writer(conf,pathSpy,MapFile.Writer.keyClass(IntWritable.class),MapFile.Writer.valueClass(Text.class));
    fail("testWriteWithFailDirCreation error !!!");
  }
 catch (  IOException ex) {
    assertTrue("testWriteWithFailDirCreation ex error !!!",ex.getMessage().startsWith(ERROR_MESSAGE));
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * test {@code MapFile.Reader.midKey() } method 
 */
@Test public void testMidKeyOnCurrentApi() throws Exception {
  final String TEST_PREFIX="testMidKeyOnCurrentApi.mapfile";
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=createWriter(TEST_PREFIX,IntWritable.class,IntWritable.class);
    int SIZE=10;
    for (int i=0; i < SIZE; i++)     writer.append(new IntWritable(i),new IntWritable(i));
    writer.close();
    reader=createReader(TEST_PREFIX,IntWritable.class);
    assertEquals(new IntWritable((SIZE - 1) / 2),reader.midKey());
  }
  finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * test {@code MapFile.Writer.append() } with wrong key class
 */
@Test public void testReaderWithWrongValueClass(){
  final String TEST_METHOD_KEY="testReaderWithWrongValueClass.mapfile";
  MapFile.Writer writer=null;
  try {
    writer=createWriter(TEST_METHOD_KEY,IntWritable.class,Text.class);
    writer.append(new IntWritable(0),new IntWritable(0));
    fail("no excepted exception in testReaderWithWrongKeyClass !!!");
  }
 catch (  IOException ex) {
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Reader.getClosest()} method 
 */
@Test public void testGetClosestOnCurrentApi() throws Exception {
  final String TEST_PREFIX="testGetClosestOnCurrentApi.mapfile";
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=createWriter(TEST_PREFIX,Text.class,Text.class);
    int FIRST_KEY=1;
    for (int i=FIRST_KEY; i < 100; i+=10) {
      Text t=new Text(Integer.toString(i));
      writer.append(t,t);
    }
    writer.close();
    reader=createReader(TEST_PREFIX,Text.class);
    Text key=new Text("55");
    Text value=new Text();
    Text closest=(Text)reader.getClosest(key,value);
    assertEquals(new Text("61"),closest);
    closest=(Text)reader.getClosest(key,value,true);
    assertEquals(new Text("51"),closest);
    final Text explicitKey=new Text("21");
    closest=(Text)reader.getClosest(explicitKey,value);
    assertEquals(new Text("21"),explicitKey);
    key=new Text("00");
    closest=(Text)reader.getClosest(key,value);
    assertEquals(FIRST_KEY,Integer.parseInt(closest.toString()));
    key=new Text("92");
    closest=(Text)reader.getClosest(key,value);
    assertNull("Not null key in testGetClosestWithNewCode",closest);
    closest=(Text)reader.getClosest(key,value,true);
    assertEquals(new Text("91"),closest);
  }
  finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<pre class="type-11 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  LocalFileSystem fs=FileSystem.getLocal(conf);
  if (fs.exists(TEST_DIR) && !fs.delete(TEST_DIR,true)) {
    Assert.fail("Can't clean up test root dir");
  }
  fs.mkdirs(TEST_DIR);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMainMethodMapFile(){
  String path=new Path(TEST_DIR,"mainMethodMapFile.mapfile").toString();
  String inFile="mainMethodMapFile.mapfile";
  String outFile="mainMethodMapFile.mapfile";
  String[] args={path,outFile};
  MapFile.Writer writer=null;
  try {
    writer=createWriter(inFile,IntWritable.class,Text.class);
    writer.append(new IntWritable(1),new Text("test_text1"));
    writer.append(new IntWritable(2),new Text("test_text2"));
    writer.close();
    MapFile.main(args);
  }
 catch (  Exception ex) {
    fail("testMainMethodMapFile error !!!");
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<pre class="type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Reader.finalKey()} method
 */
@Test public void testOnFinalKey(){
  final String TEST_METHOD_KEY="testOnFinalKey.mapfile";
  int SIZE=10;
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=createWriter(TEST_METHOD_KEY,IntWritable.class,IntWritable.class);
    for (int i=0; i < SIZE; i++)     writer.append(new IntWritable(i),new IntWritable(i));
    writer.close();
    reader=createReader(TEST_METHOD_KEY,IntWritable.class);
    IntWritable expectedKey=new IntWritable(0);
    reader.finalKey(expectedKey);
    assertEquals("testOnFinalKey not same !!!",expectedKey,new IntWritable(9));
  }
 catch (  IOException ex) {
    fail("testOnFinalKey error !!!");
  }
 finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<pre class="type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.rename()} 
 * method with throwing {@code IOException}  
 */
@Test public void testRenameWithException(){
  final String ERROR_MESSAGE="Can't rename file";
  final String NEW_FILE_NAME="test-new.mapfile";
  final String OLD_FILE_NAME="test-old.mapfile";
  MapFile.Writer writer=null;
  try {
    FileSystem fs=FileSystem.getLocal(conf);
    FileSystem spyFs=spy(fs);
    writer=createWriter(OLD_FILE_NAME,IntWritable.class,IntWritable.class);
    writer.close();
    Path oldDir=new Path(TEST_DIR,OLD_FILE_NAME);
    Path newDir=new Path(TEST_DIR,NEW_FILE_NAME);
    when(spyFs.rename(oldDir,newDir)).thenThrow(new IOException(ERROR_MESSAGE));
    MapFile.rename(spyFs,oldDir.toString(),newDir.toString());
    fail("testRenameWithException no exception error !!!");
  }
 catch (  IOException ex) {
    assertEquals("testRenameWithException invalid IOExceptionMessage !!!",ex.getMessage(),ERROR_MESSAGE);
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * test  {@code MapFile.Writer.rename()} method 
 */
@Test public void testRename(){
  final String NEW_FILE_NAME="test-new.mapfile";
  final String OLD_FILE_NAME="test-old.mapfile";
  MapFile.Writer writer=null;
  try {
    FileSystem fs=FileSystem.getLocal(conf);
    writer=createWriter(OLD_FILE_NAME,IntWritable.class,IntWritable.class);
    writer.close();
    MapFile.rename(fs,new Path(TEST_DIR,OLD_FILE_NAME).toString(),new Path(TEST_DIR,NEW_FILE_NAME).toString());
    MapFile.delete(fs,new Path(TEST_DIR,NEW_FILE_NAME).toString());
  }
 catch (  IOException ex) {
    fail("testRename error " + ex);
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * test {@code MapFile.Reader.getClosest() } with wrong class key
 */
@Test public void testReaderGetClosest() throws Exception {
  final String TEST_METHOD_KEY="testReaderWithWrongKeyClass.mapfile";
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=createWriter(TEST_METHOD_KEY,IntWritable.class,Text.class);
    for (int i=0; i < 10; i++)     writer.append(new IntWritable(i),new Text("value" + i));
    writer.close();
    reader=createReader(TEST_METHOD_KEY,Text.class);
    reader.getClosest(new Text("2"),new Text(""));
    fail("no excepted exception in testReaderWithWrongKeyClass !!!");
  }
 catch (  IOException ex) {
  }
 finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @SuppressWarnings("deprecation") public void testMidKey() throws Exception {
  Path dirName=new Path(TEST_DIR,"testMidKey.mapfile");
  FileSystem fs=FileSystem.getLocal(conf);
  Path qualifiedDirName=fs.makeQualified(dirName);
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=new MapFile.Writer(conf,fs,qualifiedDirName.toString(),IntWritable.class,IntWritable.class);
    writer.append(new IntWritable(1),new IntWritable(1));
    writer.close();
    reader=new MapFile.Reader(qualifiedDirName,conf);
    assertEquals(new IntWritable(1),reader.midKey());
  }
  finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<pre class="type-9 type-7 type-1 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getClosest feature.
 * @throws Exception
 */
@Test @SuppressWarnings("deprecation") public void testGetClosest() throws Exception {
  Path dirName=new Path(TEST_DIR,"testGetClosest.mapfile");
  FileSystem fs=FileSystem.getLocal(conf);
  Path qualifiedDirName=fs.makeQualified(dirName);
  MapFile.Writer.setIndexInterval(conf,3);
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=new MapFile.Writer(conf,fs,qualifiedDirName.toString(),Text.class,Text.class);
    assertEquals(3,writer.getIndexInterval());
    final int FIRST_KEY=10;
    for (int i=FIRST_KEY; i < 100; i+=10) {
      String iStr=Integer.toString(i);
      Text t=new Text("00".substring(iStr.length()) + iStr);
      writer.append(t,t);
    }
    writer.close();
    reader=new MapFile.Reader(qualifiedDirName,conf);
    Text key=new Text("55");
    Text value=new Text();
    Text closest=(Text)reader.getClosest(key,value);
    assertEquals(new Text("60"),closest);
    closest=(Text)reader.getClosest(key,value,true);
    assertEquals(new Text("50"),closest);
    final Text TWENTY=new Text("20");
    closest=(Text)reader.getClosest(TWENTY,value);
    assertEquals(TWENTY,closest);
    closest=(Text)reader.getClosest(TWENTY,value,true);
    assertEquals(TWENTY,closest);
    key=new Text("00");
    closest=(Text)reader.getClosest(key,value);
    assertEquals(FIRST_KEY,Integer.parseInt(closest.toString()));
    closest=(Text)reader.getClosest(key,value,true);
    assertNull(closest);
    key=new Text("99");
    closest=(Text)reader.getClosest(key,value);
    assertNull(closest);
    closest=(Text)reader.getClosest(key,value,true);
    assertEquals(new Text("90"),closest);
  }
  finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Writer} constructor with key, value
 * and validate it with {@code keyClass(), valueClass()} methods 
 */
@Test public void testKeyValueClasses(){
  Class<? extends WritableComparable<?>> keyClass=IntWritable.class;
  Class<?> valueClass=Text.class;
  try {
    createWriter("testKeyValueClasses.mapfile",IntWritable.class,Text.class).close();
    assertNotNull("writer key class null error !!!",MapFile.Writer.keyClass(keyClass));
    assertNotNull("writer value class null error !!!",MapFile.Writer.valueClass(valueClass));
  }
 catch (  IOException ex) {
    fail(ex.getMessage());
  }
}

</code></pre>

<pre class="type-9 type-2 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test all available constructor for {@code MapFile.Writer}
 */
@Test @SuppressWarnings("deprecation") public void testDeprecatedConstructors(){
  String path=new Path(TEST_DIR,"writes.mapfile").toString();
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    FileSystem fs=FileSystem.getLocal(conf);
    writer=new MapFile.Writer(conf,fs,path,IntWritable.class,Text.class,CompressionType.RECORD);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,IntWritable.class,Text.class,CompressionType.RECORD,defaultProgressable);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,IntWritable.class,Text.class,CompressionType.RECORD,defaultCodec,defaultProgressable);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,WritableComparator.get(Text.class),Text.class);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,WritableComparator.get(Text.class),Text.class,SequenceFile.CompressionType.RECORD);
    assertNotNull(writer);
    writer.close();
    writer=new MapFile.Writer(conf,fs,path,WritableComparator.get(Text.class),Text.class,CompressionType.RECORD,defaultProgressable);
    assertNotNull(writer);
    writer.close();
    reader=new MapFile.Reader(fs,path,WritableComparator.get(IntWritable.class),conf);
    assertNotNull(reader);
    assertNotNull("reader key is null !!!",reader.getKeyClass());
    assertNotNull("reader value in null",reader.getValueClass());
  }
 catch (  IOException e) {
    fail(e.getMessage());
  }
 finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * test {@code MapFile.Writer} constructor 
 * with IllegalArgumentException  
 */
@Test public void testKeyLessWriterCreation(){
  MapFile.Writer writer=null;
  try {
    writer=new MapFile.Writer(conf,TEST_DIR);
    fail("fail in testKeyLessWriterCreation !!!");
  }
 catch (  IllegalArgumentException ex) {
  }
catch (  Exception e) {
    fail("fail in testKeyLessWriterCreation. Other ex !!!");
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<pre class="type-9 type-13 type-2 type-7 type-10 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Reader.next(key, value)} for iteration.
 */
@Test public void testReaderKeyIteration(){
  final String TEST_METHOD_KEY="testReaderKeyIteration.mapfile";
  int SIZE=10;
  int ITERATIONS=5;
  MapFile.Writer writer=null;
  MapFile.Reader reader=null;
  try {
    writer=createWriter(TEST_METHOD_KEY,IntWritable.class,Text.class);
    int start=0;
    for (int i=0; i < SIZE; i++)     writer.append(new IntWritable(i),new Text("Value:" + i));
    writer.close();
    reader=createReader(TEST_METHOD_KEY,IntWritable.class);
    Writable startValue=new Text("Value:" + start);
    int i=0;
    while (i++ < ITERATIONS) {
      IntWritable key=new IntWritable(start);
      Writable value=startValue;
      while (reader.next(key,value)) {
        assertNotNull(key);
        assertNotNull(value);
      }
      reader.reset();
    }
    assertTrue("reader seek error !!!",reader.seek(new IntWritable(SIZE / 2)));
    assertFalse("reader seek error !!!",reader.seek(new IntWritable(SIZE * 2)));
  }
 catch (  IOException ex) {
    fail("reader seek error !!!");
  }
 finally {
    IOUtils.cleanup(null,writer,reader);
  }
}

</code></pre>

<pre class="type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @SuppressWarnings("deprecation") public void testMidKeyEmpty() throws Exception {
  Path dirName=new Path(TEST_DIR,"testMidKeyEmpty.mapfile");
  FileSystem fs=FileSystem.getLocal(conf);
  Path qualifiedDirName=fs.makeQualified(dirName);
  MapFile.Writer writer=new MapFile.Writer(conf,fs,qualifiedDirName.toString(),IntWritable.class,IntWritable.class);
  writer.close();
  MapFile.Reader reader=new MapFile.Reader(qualifiedDirName,conf);
  try {
    assertEquals(null,reader.midKey());
  }
  finally {
    reader.close();
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * test {@code MapFile.Writer.append} method with desc order  
 */
@Test public void testDescOrderWithThrowExceptionWriterAppend(){
  MapFile.Writer writer=null;
  try {
    writer=createWriter(".mapfile",IntWritable.class,Text.class);
    writer.append(new IntWritable(2),new Text("value: " + 1));
    writer.append(new IntWritable(2),new Text("value: " + 2));
    writer.append(new IntWritable(2),new Text("value: " + 4));
    writer.append(new IntWritable(1),new Text("value: " + 3));
    fail("testDescOrderWithThrowExceptionWriterAppend not expected exception error !!!");
  }
 catch (  IOException ex) {
  }
catch (  Exception e) {
    fail("testDescOrderWithThrowExceptionWriterAppend other ex throw !!!");
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<pre class="type-9 type-11 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test {@code MapFile.Writer.testFix} method
 */
@Test public void testFix(){
  final String INDEX_LESS_MAP_FILE="testFix.mapfile";
  int PAIR_SIZE=20;
  MapFile.Writer writer=null;
  try {
    FileSystem fs=FileSystem.getLocal(conf);
    Path dir=new Path(TEST_DIR,INDEX_LESS_MAP_FILE);
    writer=createWriter(INDEX_LESS_MAP_FILE,IntWritable.class,Text.class);
    for (int i=0; i < PAIR_SIZE; i++)     writer.append(new IntWritable(0),new Text("value"));
    writer.close();
    File indexFile=new File(".","." + INDEX_LESS_MAP_FILE + "/index");
    boolean isDeleted=false;
    if (indexFile.exists())     isDeleted=indexFile.delete();
    if (isDeleted)     assertTrue("testFix error !!!",MapFile.fix(fs,dir,IntWritable.class,Text.class,true,conf) == PAIR_SIZE);
  }
 catch (  Exception ex) {
    fail("testFix error !!!");
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<pre class="type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRenameWithFalse(){
  final String ERROR_MESSAGE="Could not rename";
  final String NEW_FILE_NAME="test-new.mapfile";
  final String OLD_FILE_NAME="test-old.mapfile";
  MapFile.Writer writer=null;
  try {
    FileSystem fs=FileSystem.getLocal(conf);
    FileSystem spyFs=spy(fs);
    writer=createWriter(OLD_FILE_NAME,IntWritable.class,IntWritable.class);
    writer.close();
    Path oldDir=new Path(TEST_DIR,OLD_FILE_NAME);
    Path newDir=new Path(TEST_DIR,NEW_FILE_NAME);
    when(spyFs.rename(oldDir,newDir)).thenReturn(false);
    MapFile.rename(spyFs,oldDir.toString(),newDir.toString());
    fail("testRenameWithException no exception error !!!");
  }
 catch (  IOException ex) {
    assertTrue("testRenameWithFalse invalid IOExceptionMessage error !!!",ex.getMessage().startsWith(ERROR_MESSAGE));
  }
 finally {
    IOUtils.cleanup(null,writer);
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
