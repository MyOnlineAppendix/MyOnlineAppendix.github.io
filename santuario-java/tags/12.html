<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.xml.security.test.dom.utils.resolver.ResolverDirectHTTPTest </h4><pre class="type-12 type-10 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBug40783() throws Exception {
  Document doc=XMLUtils.createDocumentBuilder(false).newDocument();
  Attr uri=doc.createAttribute("id");
  uri.setNodeValue("urn:ddd:uuu");
  doc.createElement("test").setAttributeNode(uri);
  try {
    ResourceResolver resolver=ResourceResolver.getInstance(uri,null,true);
    fail("No exception thrown, but resolver found: " + resolver);
  }
 catch (  ResourceResolverException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.IVSplittingOutputStreamTest </h4><pre class="type-12 type-4 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteBytesArrayIVLength2() throws Exception {
  int ivSize=16;
  KeyGenerator keyGenerator=KeyGenerator.getInstance("AES");
  keyGenerator.init(128);
  SecretKey secretKey=keyGenerator.generateKey();
  Cipher cipher=Cipher.getInstance("AES/CBC/ISO10126Padding");
  ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  IVSplittingOutputStream ivSplittingOutputStream=new IVSplittingOutputStream(byteArrayOutputStream,cipher,secretKey,ivSize);
  ReplaceableOuputStream replaceableOuputStream=new ReplaceableOuputStream(ivSplittingOutputStream);
  ivSplittingOutputStream.setParentOutputStream(replaceableOuputStream);
  byte[] testBytes=testString.getBytes();
  replaceableOuputStream.write(testBytes,0,testBytes.length - ivSize);
  replaceableOuputStream.write(testBytes,testBytes.length - ivSize,ivSize);
  replaceableOuputStream.close();
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()),testString.substring(0,ivSize));
  Assert.assertEquals(new String(byteArrayOutputStream.toByteArray()),testString.substring(ivSize));
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()) + new String(byteArrayOutputStream.toByteArray()),testString);
  Assert.assertTrue(ivSplittingOutputStream.isIVComplete());
}

</code></pre>

<br>
<pre class="type-12 type-4 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteBytesArrayIVLength() throws Exception {
  int ivSize=16;
  KeyGenerator keyGenerator=KeyGenerator.getInstance("AES");
  keyGenerator.init(128);
  SecretKey secretKey=keyGenerator.generateKey();
  Cipher cipher=Cipher.getInstance("AES/CBC/ISO10126Padding");
  ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  IVSplittingOutputStream ivSplittingOutputStream=new IVSplittingOutputStream(byteArrayOutputStream,cipher,secretKey,ivSize);
  ReplaceableOuputStream replaceableOuputStream=new ReplaceableOuputStream(ivSplittingOutputStream);
  ivSplittingOutputStream.setParentOutputStream(replaceableOuputStream);
  byte[] testBytes=testString.getBytes();
  for (int i=0; i < testBytes.length - ivSize; i+=ivSize) {
    replaceableOuputStream.write(testBytes,i,ivSize);
  }
  replaceableOuputStream.write(testBytes,testBytes.length - testBytes.length % ivSize,testBytes.length % ivSize);
  replaceableOuputStream.close();
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()),testString.substring(0,ivSize));
  Assert.assertEquals(new String(byteArrayOutputStream.toByteArray()),testString.substring(ivSize));
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()) + new String(byteArrayOutputStream.toByteArray()),testString);
  Assert.assertTrue(ivSplittingOutputStream.isIVComplete());
}

</code></pre>

<br>
<pre class="type-12 type-4 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteBytesArray() throws Exception {
  int ivSize=16;
  KeyGenerator keyGenerator=KeyGenerator.getInstance("AES");
  keyGenerator.init(128);
  SecretKey secretKey=keyGenerator.generateKey();
  Cipher cipher=Cipher.getInstance("AES/CBC/ISO10126Padding");
  ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  IVSplittingOutputStream ivSplittingOutputStream=new IVSplittingOutputStream(byteArrayOutputStream,cipher,secretKey,ivSize);
  ReplaceableOuputStream replaceableOuputStream=new ReplaceableOuputStream(ivSplittingOutputStream);
  ivSplittingOutputStream.setParentOutputStream(replaceableOuputStream);
  replaceableOuputStream.write(testString.getBytes());
  replaceableOuputStream.close();
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()),testString.substring(0,ivSize));
  Assert.assertEquals(new String(byteArrayOutputStream.toByteArray()),testString.substring(ivSize));
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()) + new String(byteArrayOutputStream.toByteArray()),testString);
  Assert.assertTrue(ivSplittingOutputStream.isIVComplete());
}

</code></pre>

<br>
<pre class="type-12 type-4 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteBytes() throws Exception {
  int ivSize=16;
  KeyGenerator keyGenerator=KeyGenerator.getInstance("AES");
  keyGenerator.init(128);
  SecretKey secretKey=keyGenerator.generateKey();
  Cipher cipher=Cipher.getInstance("AES/CBC/ISO10126Padding");
  ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  IVSplittingOutputStream ivSplittingOutputStream=new IVSplittingOutputStream(byteArrayOutputStream,cipher,secretKey,ivSize);
  ReplaceableOuputStream replaceableOuputStream=new ReplaceableOuputStream(ivSplittingOutputStream);
  ivSplittingOutputStream.setParentOutputStream(replaceableOuputStream);
  byte[] testBytes=testString.getBytes();
  for (int i=0; i < testBytes.length; i++) {
    replaceableOuputStream.write(testBytes[i]);
  }
  replaceableOuputStream.close();
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()),testString.substring(0,ivSize));
  Assert.assertEquals(new String(byteArrayOutputStream.toByteArray()),testString.substring(ivSize));
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()) + new String(byteArrayOutputStream.toByteArray()),testString);
  Assert.assertTrue(ivSplittingOutputStream.isIVComplete());
}

</code></pre>

<br>
<pre class="type-12 type-4 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteBytesArrayWithOffset() throws Exception {
  int ivSize=16;
  KeyGenerator keyGenerator=KeyGenerator.getInstance("AES");
  keyGenerator.init(128);
  SecretKey secretKey=keyGenerator.generateKey();
  Cipher cipher=Cipher.getInstance("AES/CBC/ISO10126Padding");
  ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  IVSplittingOutputStream ivSplittingOutputStream=new IVSplittingOutputStream(byteArrayOutputStream,cipher,secretKey,ivSize);
  ReplaceableOuputStream replaceableOuputStream=new ReplaceableOuputStream(ivSplittingOutputStream);
  ivSplittingOutputStream.setParentOutputStream(replaceableOuputStream);
  byte[] testBytes=testString.getBytes();
  for (int i=0; i < testBytes.length - 4; i+=4) {
    replaceableOuputStream.write(testBytes,i,4);
  }
  replaceableOuputStream.write(testBytes,testBytes.length - testBytes.length % 4,testBytes.length % 4);
  replaceableOuputStream.close();
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()),testString.substring(0,ivSize));
  Assert.assertEquals(new String(byteArrayOutputStream.toByteArray()),testString.substring(ivSize));
  Assert.assertEquals(new String(ivSplittingOutputStream.getIv()) + new String(byteArrayOutputStream.toByteArray()),testString);
  Assert.assertTrue(ivSplittingOutputStream.isIVComplete());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.InputProcessorChainTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddProcessorBeforeAndAfter1(){
  InputProcessorChainImpl inputProcessorChain=new InputProcessorChainImpl(new InboundSecurityContextImpl());
  AbstractInputProcessor inputProcessor1=new AbstractInputProcessor(){
  }
;
  inputProcessorChain.addProcessor(inputProcessor1);
  AbstractInputProcessor inputProcessor2=new AbstractInputProcessor(){
  }
;
  inputProcessorChain.addProcessor(inputProcessor2);
  AbstractInputProcessor inputProcessor3=new AbstractInputProcessor(){
  }
;
  inputProcessorChain.addProcessor(inputProcessor3);
  AbstractInputProcessor inputProcessor4=new AbstractInputProcessor(){
  }
;
  inputProcessorChain.addProcessor(inputProcessor4);
  AbstractInputProcessor inputProcessor5=new AbstractInputProcessor(){
  }
;
  inputProcessor5.addBeforeProcessor("");
  inputProcessor5.addAfterProcessor(inputProcessor3.getClass().getName());
  inputProcessorChain.addProcessor(inputProcessor5);
  AbstractInputProcessor inputProcessor6=new AbstractInputProcessor(){
  }
;
  inputProcessor6.addBeforeProcessor(inputProcessor5.getClass().getName());
  inputProcessor6.addAfterProcessor("");
  inputProcessorChain.addProcessor(inputProcessor6);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(0),inputProcessor4);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(1),inputProcessor5);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(2),inputProcessor6);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(3),inputProcessor3);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(4),inputProcessor2);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(5),inputProcessor1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddProcessorBefore1(){
  InputProcessorChainImpl inputProcessorChain=new InputProcessorChainImpl(new InboundSecurityContextImpl());
  AbstractInputProcessor inputProcessor1=new AbstractInputProcessor(){
  }
;
  inputProcessorChain.addProcessor(inputProcessor1);
  AbstractInputProcessor inputProcessor2=new AbstractInputProcessor(){
  }
;
  inputProcessor2.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);
  inputProcessorChain.addProcessor(inputProcessor2);
  AbstractInputProcessor inputProcessor3=new AbstractInputProcessor(){
  }
;
  inputProcessor3.setPhase(XMLSecurityConstants.Phase.POSTPROCESSING);
  inputProcessorChain.addProcessor(inputProcessor3);
  AbstractInputProcessor inputProcessor4=new AbstractInputProcessor(){
  }
;
  inputProcessor4.setPhase(XMLSecurityConstants.Phase.POSTPROCESSING);
  inputProcessor4.addBeforeProcessor(inputProcessor3.getClass().getName());
  inputProcessorChain.addProcessor(inputProcessor4);
  AbstractInputProcessor inputProcessor5=new AbstractInputProcessor(){
  }
;
  inputProcessor5.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);
  inputProcessor5.addBeforeProcessor(inputProcessor2.getClass().getName());
  inputProcessorChain.addProcessor(inputProcessor5);
  AbstractInputProcessor inputProcessor6=new AbstractInputProcessor(){
  }
;
  inputProcessor6.addBeforeProcessor(inputProcessor1.getClass().getName());
  inputProcessorChain.addProcessor(inputProcessor6);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(0),inputProcessor3);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(1),inputProcessor4);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(2),inputProcessor1);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(3),inputProcessor6);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(4),inputProcessor2);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(5),inputProcessor5);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddProcessorAfter1(){
  InputProcessorChainImpl inputProcessorChain=new InputProcessorChainImpl(new InboundSecurityContextImpl());
  AbstractInputProcessor inputProcessor1=new AbstractInputProcessor(){
  }
;
  inputProcessorChain.addProcessor(inputProcessor1);
  AbstractInputProcessor inputProcessor2=new AbstractInputProcessor(){
  }
;
  inputProcessor2.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);
  inputProcessorChain.addProcessor(inputProcessor2);
  AbstractInputProcessor inputProcessor3=new AbstractInputProcessor(){
  }
;
  inputProcessor3.setPhase(XMLSecurityConstants.Phase.POSTPROCESSING);
  inputProcessorChain.addProcessor(inputProcessor3);
  AbstractInputProcessor inputProcessor4=new AbstractInputProcessor(){
  }
;
  inputProcessor4.setPhase(XMLSecurityConstants.Phase.POSTPROCESSING);
  inputProcessor4.addAfterProcessor(inputProcessor3.getClass().getName());
  inputProcessorChain.addProcessor(inputProcessor4);
  AbstractInputProcessor inputProcessor5=new AbstractInputProcessor(){
  }
;
  inputProcessor5.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);
  inputProcessor5.addAfterProcessor(inputProcessor2.getClass().getName());
  inputProcessorChain.addProcessor(inputProcessor5);
  AbstractInputProcessor inputProcessor6=new AbstractInputProcessor(){
  }
;
  inputProcessor6.addAfterProcessor(inputProcessor1.getClass().getName());
  inputProcessorChain.addProcessor(inputProcessor6);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(0),inputProcessor4);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(1),inputProcessor3);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(2),inputProcessor6);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(3),inputProcessor1);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(4),inputProcessor5);
  Assert.assertEquals(inputProcessorChain.getProcessors().get(5),inputProcessor2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.OutputProcessorChainTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddProcessorBefore1(){
  OutputProcessorChainImpl outputProcessorChain=new OutputProcessorChainImpl(new OutboundSecurityContextImpl());
  AbstractOutputProcessor outputProcessor1=new AbstractOutputProcessor(){
  }
;
  outputProcessorChain.addProcessor(outputProcessor1);
  AbstractOutputProcessor outputProcessor2=new AbstractOutputProcessor(){
  }
;
  outputProcessor2.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);
  outputProcessorChain.addProcessor(outputProcessor2);
  AbstractOutputProcessor outputProcessor3=new AbstractOutputProcessor(){
  }
;
  outputProcessor3.setPhase(XMLSecurityConstants.Phase.POSTPROCESSING);
  outputProcessorChain.addProcessor(outputProcessor3);
  AbstractOutputProcessor outputProcessor4=new AbstractOutputProcessor(){
  }
;
  outputProcessor4.setPhase(XMLSecurityConstants.Phase.POSTPROCESSING);
  outputProcessor4.addBeforeProcessor(outputProcessor3.getClass().getName());
  outputProcessorChain.addProcessor(outputProcessor4);
  AbstractOutputProcessor outputProcessor5=new AbstractOutputProcessor(){
  }
;
  outputProcessor5.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);
  outputProcessor5.addBeforeProcessor(outputProcessor2.getClass().getName());
  outputProcessorChain.addProcessor(outputProcessor5);
  AbstractOutputProcessor outputProcessor6=new AbstractOutputProcessor(){
  }
;
  outputProcessor6.addBeforeProcessor(outputProcessor1.getClass().getName());
  outputProcessorChain.addProcessor(outputProcessor6);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(0),outputProcessor5);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(1),outputProcessor2);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(2),outputProcessor6);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(3),outputProcessor1);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(4),outputProcessor4);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(5),outputProcessor3);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddProcessorBeforeAndAfter1(){
  OutputProcessorChainImpl outputProcessorChain=new OutputProcessorChainImpl(new OutboundSecurityContextImpl());
  AbstractOutputProcessor outputProcessor1=new AbstractOutputProcessor(){
  }
;
  outputProcessorChain.addProcessor(outputProcessor1);
  AbstractOutputProcessor outputProcessor2=new AbstractOutputProcessor(){
  }
;
  outputProcessorChain.addProcessor(outputProcessor2);
  AbstractOutputProcessor outputProcessor3=new AbstractOutputProcessor(){
  }
;
  outputProcessorChain.addProcessor(outputProcessor3);
  AbstractOutputProcessor outputProcessor4=new AbstractOutputProcessor(){
  }
;
  outputProcessorChain.addProcessor(outputProcessor4);
  AbstractOutputProcessor outputProcessor5=new AbstractOutputProcessor(){
  }
;
  outputProcessor5.addBeforeProcessor("");
  outputProcessor5.addAfterProcessor(outputProcessor3.getClass().getName());
  outputProcessorChain.addProcessor(outputProcessor5);
  AbstractOutputProcessor outputProcessor6=new AbstractOutputProcessor(){
  }
;
  outputProcessor6.addBeforeProcessor(outputProcessor5.getClass().getName());
  outputProcessor6.addAfterProcessor("");
  outputProcessorChain.addProcessor(outputProcessor6);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(0),outputProcessor1);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(1),outputProcessor2);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(2),outputProcessor3);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(3),outputProcessor6);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(4),outputProcessor5);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(5),outputProcessor4);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddProcessorAfter1(){
  OutputProcessorChainImpl outputProcessorChain=new OutputProcessorChainImpl(new OutboundSecurityContextImpl());
  AbstractOutputProcessor outputProcessor1=new AbstractOutputProcessor(){
  }
;
  outputProcessorChain.addProcessor(outputProcessor1);
  AbstractOutputProcessor outputProcessor2=new AbstractOutputProcessor(){
  }
;
  outputProcessor2.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);
  outputProcessorChain.addProcessor(outputProcessor2);
  AbstractOutputProcessor outputProcessor3=new AbstractOutputProcessor(){
  }
;
  outputProcessor3.setPhase(XMLSecurityConstants.Phase.POSTPROCESSING);
  outputProcessorChain.addProcessor(outputProcessor3);
  AbstractOutputProcessor outputProcessor4=new AbstractOutputProcessor(){
  }
;
  outputProcessor4.setPhase(XMLSecurityConstants.Phase.POSTPROCESSING);
  outputProcessor4.addAfterProcessor(outputProcessor3.getClass().getName());
  outputProcessorChain.addProcessor(outputProcessor4);
  AbstractOutputProcessor outputProcessor5=new AbstractOutputProcessor(){
  }
;
  outputProcessor5.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);
  outputProcessor5.addAfterProcessor(outputProcessor2.getClass().getName());
  outputProcessorChain.addProcessor(outputProcessor5);
  AbstractOutputProcessor outputProcessor6=new AbstractOutputProcessor(){
  }
;
  outputProcessor6.addAfterProcessor(outputProcessor1.getClass().getName());
  outputProcessorChain.addProcessor(outputProcessor6);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(0),outputProcessor2);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(1),outputProcessor5);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(2),outputProcessor1);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(3),outputProcessor6);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(4),outputProcessor3);
  Assert.assertEquals(outputProcessorChain.getProcessors().get(5),outputProcessor4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.TrimmerOutputStreamTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWriteRandomByteSizes() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  TrimmerOutputStream trimmerOutputStream=new TrimmerOutputStream(baos,32,3,4);
  StringBuilder stringBuffer=new StringBuilder("<a>");
  for (int i=0; i < 100; i++) {
    stringBuffer.append(testString);
  }
  stringBuffer.append("</a>");
  byte[] testStringBytes=stringBuffer.toString().getBytes();
  int written=0;
  int count=0;
  do {
    count++;
    trimmerOutputStream.write(testStringBytes,written,count);
    written+=count;
  }
 while ((written + count + 1) < testStringBytes.length);
  trimmerOutputStream.write(testStringBytes,written,testStringBytes.length - written);
  trimmerOutputStream.close();
  Assert.assertEquals(baos.size(),testStringBytes.length - 7);
  Assert.assertEquals(baos.toString(),stringBuffer.toString().substring(3,stringBuffer.length() - 4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.XMLSecurityEventReaderTest </h4><pre class="type-12 type-8 type-14 type-4 type-13 type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndex() throws Exception {
  XMLInputFactory xmlInputFactory=XMLInputFactory.newInstance();
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/c14n/inExcl/plain-soap-1.1.xml"));
  Deque<XMLSecEvent> xmlSecEventDeque=new ArrayDeque<XMLSecEvent>();
  do {
    xmlSecEventDeque.push(XMLSecEventFactory.allocate(xmlStreamReader,null));
    xmlStreamReader.next();
  }
 while (xmlStreamReader.hasNext());
  xmlSecEventDeque.push(XMLSecEventFactory.allocate(xmlStreamReader,null));
  int skip=100;
  XMLSecurityEventReader xmlSecurityEventReader=new XMLSecurityEventReader(xmlSecEventDeque,skip);
  XMLEventReader xmlEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/c14n/inExcl/plain-soap-1.1.xml"));
  int currentIndex=0;
  while (xmlEventReader.hasNext()) {
    XMLEvent stdXmlEvent=xmlEventReader.nextEvent();
    if (currentIndex++ < skip) {
      continue;
    }
    XMLEvent secXmlEvent=xmlSecurityEventReader.nextEvent();
    Assert.assertEquals(stdXmlEvent.getEventType(),secXmlEvent.getEventType());
    XMLEvent stdPeekedXMLEvent=xmlEventReader.peek();
    XMLEvent secPeekedXMLEvent=xmlSecurityEventReader.peek();
    if (stdPeekedXMLEvent == null) {
      Assert.assertNull(secPeekedXMLEvent);
    }
 else {
      Assert.assertEquals(stdPeekedXMLEvent.getEventType(),secPeekedXMLEvent.getEventType());
    }
  }
  Assert.assertFalse(xmlEventReader.hasNext());
  Assert.assertFalse(xmlSecurityEventReader.hasNext());
}

</code></pre>

<br>
<pre class="type-12 type-8 type-14 type-4 type-13 type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConformness() throws Exception {
  XMLInputFactory xmlInputFactory=XMLInputFactory.newInstance();
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/c14n/inExcl/plain-soap-1.1.xml"));
  Deque<XMLSecEvent> xmlSecEventDeque=new ArrayDeque<XMLSecEvent>();
  do {
    xmlSecEventDeque.push(XMLSecEventFactory.allocate(xmlStreamReader,null));
    xmlStreamReader.next();
  }
 while (xmlStreamReader.hasNext());
  xmlSecEventDeque.push(XMLSecEventFactory.allocate(xmlStreamReader,null));
  XMLSecurityEventReader xmlSecurityEventReader=new XMLSecurityEventReader(xmlSecEventDeque,0);
  XMLEventReader xmlEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/c14n/inExcl/plain-soap-1.1.xml"));
  while (xmlEventReader.hasNext()) {
    Assert.assertEquals(xmlEventReader.hasNext(),xmlSecurityEventReader.hasNext());
    XMLEvent stdXmlEvent=xmlEventReader.nextEvent();
    XMLEvent secXmlEvent=xmlSecurityEventReader.nextEvent();
    Assert.assertEquals(stdXmlEvent.getEventType(),secXmlEvent.getEventType());
    XMLEvent stdPeekedXMLEvent=xmlEventReader.peek();
    XMLEvent secPeekedXMLEvent=xmlSecurityEventReader.peek();
    if (stdPeekedXMLEvent == null) {
      Assert.assertNull(secPeekedXMLEvent);
    }
 else {
      Assert.assertEquals(stdPeekedXMLEvent.getEventType(),secPeekedXMLEvent.getEventType());
    }
  }
  Assert.assertFalse(xmlEventReader.hasNext());
  Assert.assertFalse(xmlSecurityEventReader.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.XMLSecurityStreamReaderTest </h4><pre class="type-12 type-8 type-14 type-4 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCorrectness() throws Exception {
  XMLSecurityProperties securityProperties=new XMLSecurityProperties();
  InboundSecurityContextImpl securityContext=new InboundSecurityContextImpl();
  DocumentContextImpl documentContext=new DocumentContextImpl();
  documentContext.setEncoding("UTF-8");
  InputProcessorChainImpl inputProcessorChain=new InputProcessorChainImpl(securityContext,documentContext);
  inputProcessorChain.addProcessor(new EventReaderProcessor());
  XMLSecurityStreamReader xmlSecurityStreamReader=new XMLSecurityStreamReader(inputProcessorChain,securityProperties);
  XMLInputFactory xmlInputFactory=XMLInputFactory.newInstance();
  xmlInputFactory.setProperty(XMLInputFactory.IS_COALESCING,true);
  xmlInputFactory.setProperty(XMLInputFactory.IS_NAMESPACE_AWARE,true);
  XMLStreamReader stdXmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/c14n/inExcl/plain-soap-1.1.xml"));
  int stdXMLEventType=stdXmlStreamReader.getEventType();
  int secXMLEventType=xmlSecurityStreamReader.getEventType();
  do {
switch (stdXMLEventType) {
case XMLStreamConstants.START_ELEMENT:
      Assert.assertTrue(xmlSecurityStreamReader.isStartElement());
    Assert.assertFalse(xmlSecurityStreamReader.isEndElement());
  Assert.assertEquals(stdXmlStreamReader.getLocalName(),xmlSecurityStreamReader.getLocalName());
Assert.assertEquals(stdXmlStreamReader.getName(),xmlSecurityStreamReader.getName());
Assert.assertEquals(stdXmlStreamReader.getNamespaceURI(),xmlSecurityStreamReader.getNamespaceURI());
if (stdXmlStreamReader.getPrefix() == null) {
Assert.assertEquals("",xmlSecurityStreamReader.getPrefix());
}
 else {
Assert.assertEquals(stdXmlStreamReader.getPrefix(),xmlSecurityStreamReader.getPrefix());
}
Assert.assertEquals(stdXmlStreamReader.hasName(),xmlSecurityStreamReader.hasName());
Assert.assertEquals(stdXmlStreamReader.hasText(),xmlSecurityStreamReader.hasText());
Assert.assertEquals(stdXmlStreamReader.getAttributeCount(),xmlSecurityStreamReader.getAttributeCount());
Assert.assertEquals(stdXmlStreamReader.getNamespaceCount(),xmlSecurityStreamReader.getNamespaceCount());
for (int i=0; i < stdXmlStreamReader.getAttributeCount(); i++) {
Assert.assertEquals(stdXmlStreamReader.getAttributeLocalName(i),xmlSecurityStreamReader.getAttributeLocalName(i));
Assert.assertEquals(stdXmlStreamReader.getAttributeName(i),xmlSecurityStreamReader.getAttributeName(i));
if (stdXmlStreamReader.getAttributeNamespace(i) == null) {
Assert.assertEquals("",xmlSecurityStreamReader.getAttributeNamespace(i));
}
 else {
Assert.assertEquals(stdXmlStreamReader.getAttributeNamespace(i),xmlSecurityStreamReader.getAttributeNamespace(i));
}
if (stdXmlStreamReader.getAttributePrefix(i) == null) {
Assert.assertEquals("",xmlSecurityStreamReader.getAttributePrefix(i));
}
 else {
Assert.assertEquals(stdXmlStreamReader.getAttributePrefix(i),xmlSecurityStreamReader.getAttributePrefix(i));
}
Assert.assertEquals(stdXmlStreamReader.getAttributeType(i),xmlSecurityStreamReader.getAttributeType(i));
Assert.assertEquals(stdXmlStreamReader.getAttributeValue(i),xmlSecurityStreamReader.getAttributeValue(i));
}
for (int i=0; i < stdXmlStreamReader.getNamespaceCount(); i++) {
if (stdXmlStreamReader.getNamespacePrefix(i) == null) {
Assert.assertEquals("",xmlSecurityStreamReader.getNamespacePrefix(i));
}
 else {
Assert.assertEquals(stdXmlStreamReader.getNamespacePrefix(i),xmlSecurityStreamReader.getNamespacePrefix(i));
}
Assert.assertEquals(stdXmlStreamReader.getNamespaceURI(i),xmlSecurityStreamReader.getNamespaceURI(i));
}
break;
case XMLStreamConstants.END_ELEMENT:
Assert.assertFalse(xmlSecurityStreamReader.isStartElement());
Assert.assertTrue(xmlSecurityStreamReader.isEndElement());
Assert.assertEquals(stdXmlStreamReader.getLocalName(),xmlSecurityStreamReader.getLocalName());
Assert.assertEquals(stdXmlStreamReader.getName(),xmlSecurityStreamReader.getName());
Assert.assertEquals(stdXmlStreamReader.getNamespaceURI(),xmlSecurityStreamReader.getNamespaceURI());
if (stdXmlStreamReader.getPrefix() == null) {
Assert.assertEquals("",xmlSecurityStreamReader.getPrefix());
}
 else {
Assert.assertEquals(stdXmlStreamReader.getPrefix(),xmlSecurityStreamReader.getPrefix());
}
Assert.assertEquals(stdXmlStreamReader.hasName(),xmlSecurityStreamReader.hasName());
Assert.assertEquals(stdXmlStreamReader.hasText(),xmlSecurityStreamReader.hasText());
break;
case XMLStreamConstants.PROCESSING_INSTRUCTION:
Assert.assertEquals(stdXmlStreamReader.isCharacters(),xmlSecurityStreamReader.isCharacters());
Assert.assertEquals(stdXmlStreamReader.getPITarget(),xmlSecurityStreamReader.getPITarget());
Assert.assertEquals(stdXmlStreamReader.getPIData(),xmlSecurityStreamReader.getPIData());
break;
case XMLStreamConstants.CHARACTERS:
Assert.assertEquals(stdXmlStreamReader.isCharacters(),xmlSecurityStreamReader.isCharacters());
Assert.assertEquals(stdXmlStreamReader.isWhiteSpace(),xmlSecurityStreamReader.isWhiteSpace());
Assert.assertEquals(stdXmlStreamReader.getText(),xmlSecurityStreamReader.getText());
Assert.assertEquals(new String(stdXmlStreamReader.getTextCharacters(),stdXmlStreamReader.getTextStart(),stdXmlStreamReader.getTextLength()),new String(xmlSecurityStreamReader.getTextCharacters(),xmlSecurityStreamReader.getTextStart(),xmlSecurityStreamReader.getTextLength()));
Assert.assertEquals(stdXmlStreamReader.getTextLength(),xmlSecurityStreamReader.getTextLength());
break;
case XMLStreamConstants.COMMENT:
Assert.assertEquals(stdXmlStreamReader.isCharacters(),xmlSecurityStreamReader.isCharacters());
Assert.assertEquals(stdXmlStreamReader.isWhiteSpace(),xmlSecurityStreamReader.isWhiteSpace());
Assert.assertEquals(stdXmlStreamReader.getText(),xmlSecurityStreamReader.getText());
Assert.assertEquals(new String(stdXmlStreamReader.getTextCharacters(),stdXmlStreamReader.getTextStart(),stdXmlStreamReader.getTextLength()),new String(xmlSecurityStreamReader.getTextCharacters(),xmlSecurityStreamReader.getTextStart(),xmlSecurityStreamReader.getTextLength()));
Assert.assertEquals(stdXmlStreamReader.getTextLength(),xmlSecurityStreamReader.getTextLength());
break;
case XMLStreamConstants.SPACE:
Assert.assertEquals(stdXmlStreamReader.isWhiteSpace(),xmlSecurityStreamReader.isWhiteSpace());
Assert.assertEquals(stdXmlStreamReader.getText(),xmlSecurityStreamReader.getText());
Assert.assertEquals(new String(stdXmlStreamReader.getTextCharacters(),stdXmlStreamReader.getTextStart(),stdXmlStreamReader.getTextLength()),new String(xmlSecurityStreamReader.getTextCharacters(),xmlSecurityStreamReader.getTextStart(),xmlSecurityStreamReader.getTextLength()));
Assert.assertEquals(stdXmlStreamReader.getTextLength(),xmlSecurityStreamReader.getTextLength());
break;
case XMLStreamConstants.START_DOCUMENT:
Assert.assertEquals(stdXmlStreamReader.getCharacterEncodingScheme(),xmlSecurityStreamReader.getCharacterEncodingScheme());
Assert.assertEquals(stdXmlStreamReader.getEncoding(),xmlSecurityStreamReader.getEncoding());
break;
case XMLStreamConstants.END_DOCUMENT:
break;
case XMLStreamConstants.ENTITY_REFERENCE:
Assert.assertEquals(stdXmlStreamReader.isCharacters(),xmlSecurityStreamReader.isCharacters());
Assert.assertEquals(stdXmlStreamReader.getText(),xmlSecurityStreamReader.getText());
break;
case XMLStreamConstants.ATTRIBUTE:
break;
case XMLStreamConstants.DTD:
Assert.assertEquals(stdXmlStreamReader.isCharacters(),xmlSecurityStreamReader.isCharacters());
break;
case XMLStreamConstants.CDATA:
Assert.assertEquals(stdXmlStreamReader.isCharacters(),xmlSecurityStreamReader.isCharacters());
break;
case XMLStreamConstants.NAMESPACE:
break;
case XMLStreamConstants.NOTATION_DECLARATION:
break;
case XMLStreamConstants.ENTITY_DECLARATION:
Assert.assertEquals(stdXmlStreamReader.isCharacters(),xmlSecurityStreamReader.isCharacters());
break;
}
if (stdXMLEventType == XMLStreamConstants.SPACE && secXMLEventType == XMLStreamConstants.CHARACTERS) {
secXMLEventType=XMLStreamConstants.SPACE;
}
Assert.assertEquals(stdXMLEventType,secXMLEventType);
if (stdXmlStreamReader.hasNext()) {
Assert.assertTrue(xmlSecurityStreamReader.hasNext());
stdXMLEventType=stdXmlStreamReader.next();
secXMLEventType=xmlSecurityStreamReader.next();
}
 else {
Assert.assertFalse(xmlSecurityStreamReader.hasNext());
break;
}
}
 while (true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.XMLSecurityStreamWriterTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIdentityTransformResult() throws Exception {
  StringWriter securityStringWriter=new StringWriter();
  OutboundSecurityContextImpl securityContext=new OutboundSecurityContextImpl();
  OutputProcessorChainImpl outputProcessorChain=new OutputProcessorChainImpl(securityContext);
  outputProcessorChain.addProcessor(new EventWriterProcessor(securityStringWriter));
  XMLSecurityStreamWriter xmlSecurityStreamWriter=new XMLSecurityStreamWriter(outputProcessorChain);
  StringWriter stdStringWriter=new StringWriter();
  XMLStreamWriter stdXmlStreamWriter=XMLOutputFactory.newInstance().createXMLStreamWriter(stdStringWriter);
  NamespaceContext namespaceContext=new NamespaceContext(){
    @Override public String getNamespaceURI(    String prefix){
      if ("t3".equals(prefix)) {
        return "test3ns";
      }
      return null;
    }
    @Override public String getPrefix(    String namespaceURI){
      if ("test2ns".equals(namespaceURI)) {
        return "t2";
      }
 else       if ("test3ns".equals(namespaceURI)) {
        return "t3";
      }
      return null;
    }
    @Override public Iterator<?> getPrefixes(    String namespaceURI){
      List<String> ns=new ArrayList<String>();
      ns.add(getPrefix(namespaceURI));
      return ns.iterator();
    }
  }
;
  xmlSecurityStreamWriter.setNamespaceContext(namespaceContext);
  stdXmlStreamWriter.setNamespaceContext(namespaceContext);
  xmlSecurityStreamWriter.writeStartDocument("UTF-8","1.0");
  stdXmlStreamWriter.writeStartDocument("UTF-8","1.0");
  xmlSecurityStreamWriter.writeDTD("<!DOCTYPE foobar [\n\t<!ENTITY x0 \"hello\">\n]>");
  stdXmlStreamWriter.writeDTD("<!DOCTYPE foobar [\n\t<!ENTITY x0 \"hello\">\n]>");
  xmlSecurityStreamWriter.writeStartElement("test1");
  stdXmlStreamWriter.writeStartElement("test1");
  xmlSecurityStreamWriter.writeDefaultNamespace("defaultns");
  stdXmlStreamWriter.writeDefaultNamespace("defaultns");
  xmlSecurityStreamWriter.writeNamespace("t2new","test2ns");
  stdXmlStreamWriter.writeNamespace("t2new","test2ns");
  xmlSecurityStreamWriter.writeStartElement("test2ns","test2");
  stdXmlStreamWriter.writeStartElement("test2ns","test2");
  xmlSecurityStreamWriter.writeNamespace("t2","test2ns");
  stdXmlStreamWriter.writeNamespace("t2","test2ns");
  xmlSecurityStreamWriter.writeStartElement("t3","test3","test3ns");
  stdXmlStreamWriter.writeStartElement("t3","test3","test3ns");
  xmlSecurityStreamWriter.writeNamespace("t3","test3ns");
  stdXmlStreamWriter.writeNamespace("t3","test3ns");
  xmlSecurityStreamWriter.writeNamespace("t4","test4ns");
  stdXmlStreamWriter.writeNamespace("t4","test4ns");
  xmlSecurityStreamWriter.writeStartElement("test4ns","test4");
  stdXmlStreamWriter.writeStartElement("test4ns","test4");
  xmlSecurityStreamWriter.writeAttribute("attr1","attr1val");
  stdXmlStreamWriter.writeAttribute("attr1","attr1val");
  xmlSecurityStreamWriter.writeAttribute("t2","test2ns","attr2","attr2val");
  stdXmlStreamWriter.writeAttribute("t2","test2ns","attr2","attr2val");
  xmlSecurityStreamWriter.writeAttribute("test3ns","attr3","attr3val");
  stdXmlStreamWriter.writeAttribute("test3ns","attr3","attr3val");
  xmlSecurityStreamWriter.writeEmptyElement("test1");
  stdXmlStreamWriter.writeEmptyElement("test1");
  xmlSecurityStreamWriter.setPrefix("t2new","test2ns");
  stdXmlStreamWriter.setPrefix("t2new","test2ns");
  xmlSecurityStreamWriter.writeEmptyElement("test2ns","test2");
  stdXmlStreamWriter.writeEmptyElement("test2ns","test2");
  xmlSecurityStreamWriter.writeEmptyElement("t2","test2ns","test2");
  stdXmlStreamWriter.writeEmptyElement("t2","test2ns","test2");
  xmlSecurityStreamWriter.writeEmptyElement("test2ns","test2");
  stdXmlStreamWriter.writeEmptyElement("test2ns","test2");
  xmlSecurityStreamWriter.writeEmptyElement("t3","test3","test3ns");
  stdXmlStreamWriter.writeEmptyElement("t3","test3","test3ns");
  xmlSecurityStreamWriter.writeCharacters("\n");
  stdXmlStreamWriter.writeCharacters("\n");
  xmlSecurityStreamWriter.writeCData("Hi");
  stdXmlStreamWriter.writeCData("Hi");
  xmlSecurityStreamWriter.writeComment("this is a comment");
  stdXmlStreamWriter.writeComment("this is a comment");
  xmlSecurityStreamWriter.writeCharacters("abcdcba".toCharArray(),3,1);
  stdXmlStreamWriter.writeCharacters("abcdcba".toCharArray(),3,1);
  xmlSecurityStreamWriter.writeEntityRef("x0");
  stdXmlStreamWriter.writeEntityRef("x0");
  xmlSecurityStreamWriter.writeEndElement();
  stdXmlStreamWriter.writeEndElement();
  xmlSecurityStreamWriter.writeProcessingInstruction("PI");
  stdXmlStreamWriter.writeProcessingInstruction("PI");
  xmlSecurityStreamWriter.writeProcessingInstruction("PI","there");
  stdXmlStreamWriter.writeProcessingInstruction("PI","there");
  Assert.assertEquals(xmlSecurityStreamWriter.getPrefix("test4ns"),stdXmlStreamWriter.getPrefix("test4ns"));
  stdXmlStreamWriter.close();
  xmlSecurityStreamWriter.close();
  XMLAssert.assertXMLEqual(stdStringWriter.toString(),securityStringWriter.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.c14n.Canonicalizer20010315Test </h4><pre class="type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDefault_ns_redefinition() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  Canonicalizer20010315_WithCommentsTransformer c=new Canonicalizer20010315_WithCommentsTransformer();
  c.setOutputStream(baos);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/c14n/in/default_ns_redefinition_input.xml"));
  XMLSecEvent xmlSecEvent=null;
  while (xmlSecEventReader.hasNext()) {
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    if (xmlSecEvent.isStartElement() && xmlSecEvent.asStartElement().getName().equals(new QName("http://www.w3.org/2000/09/xmldsig#","Object"))) {
      break;
    }
  }
  while (xmlSecEventReader.hasNext()) {
    c.transform(xmlSecEvent);
    if (xmlSecEvent.isEndElement() && xmlSecEvent.asEndElement().getName().equals(new QName("http://www.w3.org/2000/09/xmldsig#","Object"))) {
      break;
    }
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
  }
  byte[] reference=getBytesFromResource(this.getClass().getClassLoader().getResource("org/apache/xml/security/c14n/in/default_ns_redefinition_c14n.xml"),true);
  boolean equals=java.security.MessageDigest.isEqual(reference,baos.toByteArray());
  if (!equals) {
    System.out.println("Expected:\n" + new String(reference,"UTF-8"));
    System.out.println("");
    System.out.println("Got:\n" + new String(baos.toByteArray(),"UTF-8"));
  }
  assertTrue(equals);
}

</code></pre>

<br>
<pre class="type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void test222() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  Canonicalizer20010315_WithCommentsTransformer c=new Canonicalizer20010315_WithCommentsTransformer();
  c.setOutputStream(baos);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/c14n/inExcl/example2_2_2.xml"));
  XMLSecEvent xmlSecEvent=null;
  while (xmlSecEventReader.hasNext()) {
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    if (xmlSecEvent.isStartElement() && xmlSecEvent.asStartElement().getName().equals(new QName("http://example.net","elem2"))) {
      break;
    }
  }
  while (xmlSecEventReader.hasNext()) {
    c.transform(xmlSecEvent);
    if (xmlSecEvent.isEndElement() && xmlSecEvent.asEndElement().getName().equals(new QName("http://example.net","elem2"))) {
      break;
    }
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
  }
  byte[] reference=getBytesFromResource(this.getClass().getClassLoader().getResource("org/apache/xml/security/c14n/inExcl/example2_2_2_c14nized.xml"));
  boolean equals=java.security.MessageDigest.isEqual(reference,baos.toByteArray());
  if (!equals) {
    System.out.println("Expected:\n" + new String(reference,"UTF-8"));
    System.out.println("");
    System.out.println("Got:\n" + new String(baos.toByteArray(),"UTF-8"));
  }
  assertTrue(equals);
}

</code></pre>

<br>
<pre class="type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void test221() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  Canonicalizer20010315_WithCommentsTransformer c=new Canonicalizer20010315_WithCommentsTransformer();
  c.setOutputStream(baos);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/c14n/inExcl/example2_2_1.xml"));
  XMLSecEvent xmlSecEvent=null;
  while (xmlSecEventReader.hasNext()) {
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    if (xmlSecEvent.isStartElement() && xmlSecEvent.asStartElement().getName().equals(new QName("http://example.net","elem2"))) {
      break;
    }
  }
  while (xmlSecEventReader.hasNext()) {
    c.transform(xmlSecEvent);
    if (xmlSecEvent.isEndElement() && xmlSecEvent.asEndElement().getName().equals(new QName("http://example.net","elem2"))) {
      break;
    }
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
  }
  byte[] reference=getBytesFromResource(this.getClass().getClassLoader().getResource("org/apache/xml/security/c14n/inExcl/example2_2_1_c14nized.xml"));
  boolean equals=java.security.MessageDigest.isEqual(reference,baos.toByteArray());
  if (!equals) {
    System.out.println("Expected:\n" + new String(reference,"UTF-8"));
    System.out.println("");
    System.out.println("Got:\n" + new String(baos.toByteArray(),"UTF-8"));
  }
  assertTrue(equals);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.encryption.DecryptionTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecryptElementValidationInDecryptOnlyMode() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  SecretKey secretKey=generateSecretKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  properties.addAction(XMLSecurityConstants.ENCRYPT);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedElementSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSubjectName() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  KeyInfo encryptedKeyKeyInfo=new KeyInfo(document);
  encryptedKeyKeyInfo=new KeyInfo(document);
  encryptedKeyKeyInfo.getElement().setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:dsig","http://www.w3.org/2000/09/xmldsig#");
  X509Data x509Data=new X509Data(document);
  x509Data.addSubjectName(cert);
  encryptedKeyKeyInfo.add(x509Data);
  encryptUsingDOM(XMLCipher.AES_128,key,XMLCipher.RSA_OAEP,cert.getPublicKey(),encryptedKeyKeyInfo,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(priv);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAes256ElementCipher() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] bits256={(byte)0x00,(byte)0x01,(byte)0x02,(byte)0x03,(byte)0x04,(byte)0x05,(byte)0x06,(byte)0x07,(byte)0x08,(byte)0x09,(byte)0x0A,(byte)0x0B,(byte)0x0C,(byte)0x0D,(byte)0x0E,(byte)0x0F,(byte)0x10,(byte)0x11,(byte)0x12,(byte)0x13,(byte)0x14,(byte)0x15,(byte)0x16,(byte)0x17,(byte)0x18,(byte)0x19,(byte)0x1A,(byte)0x1B,(byte)0x1C,(byte)0x1D,(byte)0x1E,(byte)0x1F};
  SecretKey secretKey=new SecretKeySpec(bits256,"AES");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes256-cbc",secretKey,"",null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedElementSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#aes256-cbc","");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecryptElementValidation() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  SecretKey secretKey=generateSecretKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedElementSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecryptMultipleElements() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  SecretKey secretKey=generateSecretKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  localNames.add("ShippingAddress");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  nodeList=document.getElementsByTagNameNS("urn:example:po","ShippingAddress");
  Assert.assertEquals(nodeList.getLength(),1);
  checkMultipleEncryptedElementSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAes128ElementCipher() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] bits128={(byte)0x10,(byte)0x11,(byte)0x12,(byte)0x13,(byte)0x14,(byte)0x15,(byte)0x16,(byte)0x17,(byte)0x18,(byte)0x19,(byte)0x1A,(byte)0x1B,(byte)0x1C,(byte)0x1D,(byte)0x1E,(byte)0x1F};
  SecretKey secretKey=new SecretKeySpec(bits128,"AES");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes128-cbc",secretKey,"",null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedElementSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#aes128-cbc","");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPhysicalRepresentation() throws Exception {
  final String DATA1="<?xml version=\"1.0\" encoding=\"UTF-8\"?><ns:root xmlns:ns=\"ns.com\"><ns:elem xmlns:ns2=\"ns2.com\">11</ns:elem></ns:root>";
  DocumentBuilder db=XMLUtils.createDocumentBuilder(false);
  Document document=db.parse(new ByteArrayInputStream(DATA1.getBytes("UTF8")));
  byte[] bits192="abcdefghijklmnopqrstuvwx".getBytes();
  DESedeKeySpec keySpec=new DESedeKeySpec(bits192);
  SecretKeyFactory keyFactory=SecretKeyFactory.getInstance("DESede");
  SecretKey secretKey=keyFactory.generateSecret(keySpec);
  List<String> localNames=new ArrayList<String>();
  localNames.add("elem");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,"",null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("ns.com","elem");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("ns.com","elem");
  Assert.assertEquals(nodeList.getLength(),1);
  Element decrElem=(Element)document.getDocumentElement().getFirstChild();
  assertEquals("ns:elem",decrElem.getNodeName());
  assertEquals("ns.com",decrElem.getNamespaceURI());
  assertEquals(1,decrElem.getAttributes().getLength());
  Attr attr=(Attr)decrElem.getAttributes().item(0);
  assertEquals("xmlns:ns2",attr.getName());
  assertEquals("ns2.com",attr.getValue());
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc","");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test encryption using a generated AES 128 bit key that is
 * encrypted using a AES 192 bit key.  Then reverse using the KEK
 */
@Test public void testAES128ElementAES192KWCipherUsingKEKInbound() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] bits192="abcdefghijklmnopqrstuvwx".getBytes();
  SecretKey kek=new SecretKeySpec(bits192,"AES");
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey secretKey=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes128-cbc",secretKey,"http://www.w3.org/2001/04/xmlenc#kw-aes192",kek,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(kek);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedContentSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_EncryptedKey,"http://www.w3.org/2001/04/xmlenc#aes128-cbc");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#aes128-cbc","http://www.w3.org/2001/04/xmlenc#kw-aes192");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoKeyInfo() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM(XMLCipher.AES_128,key,XMLCipher.RSA_OAEP,cert.getPublicKey(),false,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(priv);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecryptContentValidationInDecryptOnlyMode() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  SecretKey secretKey=generateSecretKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,null,null,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  properties.addAction(XMLSecurityConstants.ENCRYPT);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedContentSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null);
}

</code></pre>

<br>
<pre class="type-12 type-4 type-13 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifiedEncryptedKeyCipherValue() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyPairGenerator rsaKeygen=KeyPairGenerator.getInstance("RSA");
  KeyPair kp=rsaKeygen.generateKeyPair();
  PrivateKey priv=kp.getPrivate();
  PublicKey pub=kp.getPublic();
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey secretKey=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes256-cbc",secretKey,"http://www.w3.org/2001/04/xmlenc#rsa-1_5",pub,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  NodeList cipherValues=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_CipherValue.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_CipherValue.getLocalPart());
  Element cipherValueElement=(Element)cipherValues.item(0);
  Assert.assertEquals(cipherValueElement.getParentNode().getParentNode().getLocalName(),XMLSecurityConstants.TAG_xenc_EncryptedKey.getLocalPart());
  String cipherValue=cipherValueElement.getTextContent();
  StringBuilder stringBuilder=new StringBuilder(cipherValue);
  int index=stringBuilder.length() / 2;
  char ch=stringBuilder.charAt(index);
  if (ch != 'A') {
    ch='A';
  }
 else {
    ch='B';
  }
  stringBuilder.setCharAt(index,ch);
  cipherValueElement.setTextContent(stringBuilder.toString());
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(priv);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  try {
    document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  }
 catch (  XMLStreamException e) {
    Assert.assertFalse(e.getMessage().contains("Unwrapping failed"));
  }
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSKI() throws Exception {
  if ("IBM Corporation".equals(System.getProperty("java.vendor"))) {
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  KeyStore keyStore=KeyStore.getInstance("JCEKS");
  keyStore.load(this.getClass().getClassLoader().getResource("test.jceks").openStream(),"secret".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("rsakey","secret".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("rsakey");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  KeyInfo encryptedKeyKeyInfo=new KeyInfo(document);
  encryptedKeyKeyInfo=new KeyInfo(document);
  encryptedKeyKeyInfo.getElement().setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:dsig","http://www.w3.org/2000/09/xmldsig#");
  X509Data x509Data=new X509Data(document);
  x509Data.addSKI(cert);
  encryptedKeyKeyInfo.add(x509Data);
  encryptUsingDOM(XMLCipher.AES_128,key,XMLCipher.RSA_OAEP,cert.getPublicKey(),encryptedKeyKeyInfo,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(priv);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test encryption using a generated AES 192 bit key that is
 * encrypted using a 3DES key.  Then reverse by decrypting EncryptedKey.
 */
@Test public void testAES192Element3DESKWCipherInbound() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] bits192="abcdefghijklmnopqrstuvwx".getBytes();
  DESedeKeySpec keySpec=new DESedeKeySpec(bits192);
  SecretKeyFactory keyFactory=SecretKeyFactory.getInstance("DESede");
  Key kek=keyFactory.generateSecret(keySpec);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey secretKey=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes192-cbc",secretKey,"http://www.w3.org/2001/04/xmlenc#kw-tripledes",kek,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(kek);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedContentSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_EncryptedKey,"http://www.w3.org/2001/04/xmlenc#aes192-cbc");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#aes192-cbc","http://www.w3.org/2001/04/xmlenc#kw-tripledes");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecryptContentValidation() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  SecretKey secretKey=generateSecretKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,null,null,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedContentSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testKeyValue() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM(XMLCipher.AES_128,key,XMLCipher.RSA_OAEP,cert.getPublicKey(),true,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(priv);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTripleDesDocumentCipher() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] passPhrase="24 Bytes per DESede key!".getBytes();
  DESedeKeySpec keySpec=new DESedeKeySpec(passPhrase);
  SecretKeyFactory keyFactory=SecretKeyFactory.getInstance("DESede");
  SecretKey secretKey=keyFactory.generateSecret(keySpec);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PurchaseOrder");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,"",null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc","");
}

</code></pre>

<br>
<pre class="type-12 type-4 type-13 type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecryptWholeDocumentInDecryptOnlyMode() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  SecretKey secretKey=generateSecretKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PurchaseOrder");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PurchaseOrder");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  properties.addAction(XMLSecurityConstants.ENCRYPT);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","PurchaseOrder");
  Assert.assertEquals(nodeList.getLength(),1);
  EncryptedElementSecurityEvent encryptedElementEvent=(EncryptedElementSecurityEvent)securityEventListener.getSecurityEvent(SecurityEventConstants.EncryptedElement);
  assertNotNull(encryptedElementEvent);
  assertEquals(encryptedElementEvent.getElementPath().size(),1);
  assertEquals("{urn:example:po}PurchaseOrder",encryptedElementEvent.getElementPath().get(0).toString());
  assertTrue(encryptedElementEvent.isEncrypted());
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test encryption using a generated AES 256 bit key that is
 * encrypted using an RSA key.  Reverse using KEK
 */
@Test public void testAES256ElementRSAKWCipherUsingKEKInbound() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyPairGenerator rsaKeygen=KeyPairGenerator.getInstance("RSA");
  KeyPair kp=rsaKeygen.generateKeyPair();
  PrivateKey priv=kp.getPrivate();
  PublicKey pub=kp.getPublic();
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey secretKey=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes256-cbc",secretKey,"http://www.w3.org/2001/04/xmlenc#rsa-1_5",pub,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(priv);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(1,nodeList.getLength());
  checkEncryptedContentSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_EncryptedKey,"http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#aes256-cbc","http://www.w3.org/2001/04/xmlenc#rsa-1_5");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTripleDesElementCipher() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] passPhrase="24 Bytes per DESede key!".getBytes();
  DESedeKeySpec keySpec=new DESedeKeySpec(passPhrase);
  SecretKeyFactory keyFactory=SecretKeyFactory.getInstance("DESede");
  SecretKey secretKey=keyFactory.generateSecret(keySpec);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,"",null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedElementSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc","");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES256ElementRSAKWCipherUsingKEKInboundIncludeEKKeyInfo() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyPairGenerator rsaKeygen=KeyPairGenerator.getInstance("RSA");
  KeyPair kp=rsaKeygen.generateKeyPair();
  PrivateKey priv=kp.getPrivate();
  PublicKey pub=kp.getPublic();
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey secretKey=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes256-cbc",secretKey,"http://www.w3.org/2001/04/xmlenc#rsa-1_5",pub,true,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(priv);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(1,nodeList.getLength());
  checkEncryptedContentSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_EncryptedKey,"http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#aes256-cbc","http://www.w3.org/2001/04/xmlenc#rsa-1_5");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testX509Certificate() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  KeyInfo encryptedKeyKeyInfo=new KeyInfo(document);
  encryptedKeyKeyInfo=new KeyInfo(document);
  encryptedKeyKeyInfo.getElement().setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:dsig","http://www.w3.org/2000/09/xmldsig#");
  X509Data x509Data=new X509Data(document);
  x509Data.addCertificate(cert);
  encryptedKeyKeyInfo.add(x509Data);
  encryptUsingDOM(XMLCipher.AES_128,key,XMLCipher.RSA_OAEP,cert.getPublicKey(),encryptedKeyKeyInfo,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(priv);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAes192ElementCipher() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] bits192={(byte)0x08,(byte)0x09,(byte)0x0A,(byte)0x0B,(byte)0x0C,(byte)0x0D,(byte)0x0E,(byte)0x0F,(byte)0x10,(byte)0x11,(byte)0x12,(byte)0x13,(byte)0x14,(byte)0x15,(byte)0x16,(byte)0x17,(byte)0x18,(byte)0x19,(byte)0x1A,(byte)0x1B,(byte)0x1C,(byte)0x1D,(byte)0x1E,(byte)0x1F};
  SecretKey secretKey=new SecretKeySpec(bits192,"AES");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes192-cbc",secretKey,"",null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedElementSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#aes192-cbc","");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIssuerSerial() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  KeyInfo encryptedKeyKeyInfo=new KeyInfo(document);
  encryptedKeyKeyInfo=new KeyInfo(document);
  encryptedKeyKeyInfo.getElement().setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:dsig","http://www.w3.org/2000/09/xmldsig#");
  X509Data x509Data=new X509Data(document);
  x509Data.addIssuerSerial(cert.getIssuerX500Principal().getName(),cert.getSerialNumber());
  encryptedKeyKeyInfo.add(x509Data);
  encryptUsingDOM(XMLCipher.AES_128,key,XMLCipher.RSA_OAEP,cert.getPublicKey(),encryptedKeyKeyInfo,document,localNames,true);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(priv);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStrongDecryption() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey secretKey=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes256-cbc",secretKey,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  checkEncryptedElementSecurityEvents(securityEventListener);
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#aes256-cbc",null);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPhysicalRepresentation2() throws Exception {
  final String DATA1="<?xml version=\"1.0\" encoding=\"UTF-8\"?><ns:root xmlns=\"defns.com\" xmlns:ns=\"ns.com\"><elem xmlns=\"\">11</elem></ns:root>";
  DocumentBuilder db=XMLUtils.createDocumentBuilder(false);
  Document document=db.parse(new ByteArrayInputStream(DATA1.getBytes("UTF8")));
  byte[] bits192="abcdefghijklmnopqrstuvwx".getBytes();
  DESedeKeySpec keySpec=new DESedeKeySpec(bits192);
  SecretKeyFactory keyFactory=SecretKeyFactory.getInstance("DESede");
  SecretKey secretKey=keyFactory.generateSecret(keySpec);
  List<String> localNames=new ArrayList<String>();
  localNames.add("elem");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,"",null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("","elem");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("","elem");
  Assert.assertEquals(nodeList.getLength(),1);
  Element decrElem=(Element)document.getDocumentElement().getFirstChild();
  assertEquals("elem",decrElem.getNodeName());
  assertNull(decrElem.getNamespaceURI());
  assertEquals(1,decrElem.getAttributes().getLength());
  Attr attr=(Attr)decrElem.getAttributes().item(0);
  assertEquals("xmlns",attr.getName());
  assertEquals("",attr.getValue());
  checkEncryptionToken(securityEventListener,null,secretKey,SecurityTokenConstants.KeyIdentifier_NoKeyInfo,"");
  checkEncryptionMethod(securityEventListener,"http://www.w3.org/2001/04/xmlenc#tripledes-cbc","");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.encryption.EncryptionCreationTest </h4><pre class="type-12 type-13 type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPhysicalRepresentation2() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  byte[] bits192="abcdefghijklmnopqrstuvwx".getBytes();
  DESedeKeySpec keySpec=new DESedeKeySpec(bits192);
  SecretKeyFactory keyFactory=SecretKeyFactory.getInstance("DESede");
  SecretKey key=keyFactory.generateSecret(keySpec);
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart securePart=new SecurePart(new QName("","elem"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  final String DATA2="<ns:root xmlns=\"defns.com\" xmlns:ns=\"ns.com\"><elem xmlns=\"\">11</elem></ns:root>";
  InputStream sourceDocument=new ByteArrayInputStream(DATA2.getBytes("UTF8"));
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("","elem");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",key,null,document);
  Element decrElem=(Element)doc.getDocumentElement().getFirstChild();
  assertEquals("elem",decrElem.getNodeName());
  assertNull(decrElem.getNamespaceURI());
  assertEquals(1,decrElem.getAttributes().getLength());
  Attr attr=(Attr)decrElem.getAttributes().item(0);
  assertEquals("xmlns",attr.getName());
  assertEquals("",attr.getValue());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTripleDesElementCipher() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  byte[] passPhrase="24 Bytes per DESede key!".getBytes();
  DESedeKeySpec keySpec=new DESedeKeySpec(passPhrase);
  SecretKeyFactory keyFactory=SecretKeyFactory.getInstance("DESede");
  SecretKey key=keyFactory.generateSecret(keySpec);
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAes128ElementCipher() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  byte[] bits128={(byte)0x10,(byte)0x11,(byte)0x12,(byte)0x13,(byte)0x14,(byte)0x15,(byte)0x16,(byte)0x17,(byte)0x18,(byte)0x19,(byte)0x1A,(byte)0x1B,(byte)0x1C,(byte)0x1D,(byte)0x1E,(byte)0x1F};
  SecretKey key=new SecretKeySpec(bits128,"AES");
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes128-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes128-cbc",key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPhysicalRepresentation1() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  byte[] bits192="abcdefghijklmnopqrstuvwx".getBytes();
  DESedeKeySpec keySpec=new DESedeKeySpec(bits192);
  SecretKeyFactory keyFactory=SecretKeyFactory.getInstance("DESede");
  SecretKey key=keyFactory.generateSecret(keySpec);
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart securePart=new SecurePart(new QName("ns.com","elem"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  final String DATA1="<ns:root xmlns:ns=\"ns.com\"><ns:elem xmlns:ns2=\"ns2.com\">11</ns:elem></ns:root>";
  InputStream sourceDocument=new ByteArrayInputStream(DATA1.getBytes("UTF8"));
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("ns.com","elem");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",key,null,document);
  Element decrElem=(Element)doc.getDocumentElement().getFirstChild();
  assertEquals("ns:elem",decrElem.getNodeName());
  assertEquals("ns.com",decrElem.getNamespaceURI());
  assertEquals(1,decrElem.getAttributes().getLength());
  Attr attr=(Attr)decrElem.getAttributes().item(0);
  assertEquals("xmlns:ns2",attr.getName());
  assertEquals("ns2.com",attr.getValue());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAes192ElementCipher() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  byte[] bits192={(byte)0x08,(byte)0x09,(byte)0x0A,(byte)0x0B,(byte)0x0C,(byte)0x0D,(byte)0x0E,(byte)0x0F,(byte)0x10,(byte)0x11,(byte)0x12,(byte)0x13,(byte)0x14,(byte)0x15,(byte)0x16,(byte)0x17,(byte)0x18,(byte)0x19,(byte)0x1A,(byte)0x1B,(byte)0x1C,(byte)0x1D,(byte)0x1E,(byte)0x1F};
  SecretKey key=new SecretKeySpec(bits192,"AES");
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes192-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes192-cbc",key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptedKeyNoKeyInfo() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setEncryptionUseThisCertificate(cert);
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-1_5");
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  properties.setEncryptionKeyIdentifier(SecurityTokenConstants.KeyIdentifier_NoKeyInfo);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,priv,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTransportKey() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  byte[] bits192="abcdefghijklmnopqrstuvwx".getBytes();
  SecretKey transportKey=new SecretKeySpec(bits192,"AES");
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#kw-aes192");
  properties.setEncryptionTransportKey(transportKey);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes128-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,transportKey,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES128ElementAES192KWCipherUsingKEKOutbound() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  byte[] bits192="abcdefghijklmnopqrstuvwx".getBytes();
  SecretKey transportKey=new SecretKeySpec(bits192,"AES");
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#kw-aes192");
  properties.setEncryptionTransportKey(transportKey);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes128-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,transportKey,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptedKeyMultipleElements() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyPairGenerator rsaKeygen=KeyPairGenerator.getInstance("RSA");
  KeyPair kp=rsaKeygen.generateKeyPair();
  PrivateKey priv=kp.getPrivate();
  PublicKey pub=kp.getPublic();
  properties.setEncryptionTransportKey(pub);
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-1_5");
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  properties.setEncryptionKeyIdentifier(SecurityTokenConstants.KeyIdentifier_KeyValue);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(securePart);
  securePart=new SecurePart(new QName("urn:example:po","ShippingAddress"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),2);
  decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,priv,document);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStrongEncryption() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),1);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes256-cbc",key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptedKeySKI() throws Exception {
  if ("IBM Corporation".equals(System.getProperty("java.vendor"))) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("JCEKS");
  keyStore.load(this.getClass().getClassLoader().getResource("test.jceks").openStream(),"secret".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("rsakey","secret".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("rsakey");
  properties.setEncryptionUseThisCertificate(cert);
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-1_5");
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  properties.setEncryptionKeyIdentifier(SecurityTokenConstants.KeyIdentifier_SkiKeyIdentifier);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,priv,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptedKeyKeyValueReference() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyPairGenerator rsaKeygen=KeyPairGenerator.getInstance("RSA");
  KeyPair kp=rsaKeygen.generateKeyPair();
  PrivateKey priv=kp.getPrivate();
  PublicKey pub=kp.getPublic();
  properties.setEncryptionTransportKey(pub);
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-1_5");
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  properties.setEncryptionKeyIdentifier(SecurityTokenConstants.KeyIdentifier_KeyValue);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,priv,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptedKeyIssuerSerialReference() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setEncryptionUseThisCertificate(cert);
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-1_5");
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  properties.setEncryptionKeyIdentifier(SecurityTokenConstants.KeyIdentifier_IssuerSerial);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,priv,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptRootElementInRequest() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  SecretKey key=generateDESSecretKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart securePart=new SecurePart((QName)null,SecurePart.Modifier.Content);
  securePart.setSecureEntireRequest(true);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptionMultipleElements() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  SecretKey key=generateDESSecretKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(securePart);
  securePart=new SecurePart(new QName("urn:example:po","ShippingAddress"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),1);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),2);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTripleDesDocumentCipher() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  byte[] passPhrase="24 Bytes per DESede key!".getBytes();
  DESedeKeySpec keySpec=new DESedeKeySpec(passPhrase);
  SecretKeyFactory keyFactory=SecretKeyFactory.getInstance("DESede");
  SecretKey key=keyFactory.generateSecret(keySpec);
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PurchaseOrder"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptionContentCreation() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  SecretKey key=generateDESSecretKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),1);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptedKeyX509CertificateReference() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setEncryptionUseThisCertificate(cert);
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-1_5");
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  properties.setEncryptionKeyIdentifier(SecurityTokenConstants.KeyIdentifier_X509KeyIdentifier);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,priv,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAes256ElementCipher() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  byte[] bits256={(byte)0x00,(byte)0x01,(byte)0x02,(byte)0x03,(byte)0x04,(byte)0x05,(byte)0x06,(byte)0x07,(byte)0x08,(byte)0x09,(byte)0x0A,(byte)0x0B,(byte)0x0C,(byte)0x0D,(byte)0x0E,(byte)0x0F,(byte)0x10,(byte)0x11,(byte)0x12,(byte)0x13,(byte)0x14,(byte)0x15,(byte)0x16,(byte)0x17,(byte)0x18,(byte)0x19,(byte)0x1A,(byte)0x1B,(byte)0x1C,(byte)0x1D,(byte)0x1E,(byte)0x1F};
  SecretKey key=new SecretKeySpec(bits256,"AES");
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#aes256-cbc",key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptionElementCreation() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  SecretKey key=generateDESSecretKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES192Element3DESKWCipher() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  SecretKey transportKey=generateDESSecretKey();
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#kw-tripledes");
  properties.setEncryptionTransportKey(transportKey);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes192-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,transportKey,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptedKeyX509SubjectName() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  PrivateKey priv=(PrivateKey)keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setEncryptionUseThisCertificate(cert);
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-1_5");
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  properties.setEncryptionKeyIdentifier(SecurityTokenConstants.KeyIdentifier_X509SubjectName);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,priv,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES256ElementRSAKWCipherUsingKEKOutbound() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyPairGenerator rsaKeygen=KeyPairGenerator.getInstance("RSA");
  KeyPair kp=rsaKeygen.generateKeyPair();
  PrivateKey priv=kp.getPrivate();
  PublicKey pub=kp.getPublic();
  properties.setEncryptionTransportKey(pub);
  properties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-1_5");
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#aes256-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",null,priv,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.encryption.KeyWrapEncryptionCreationTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTripleDESKW() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  keygen=KeyGenerator.getInstance("DESede");
  SecretKey keyWrappingKey=keygen.generateKey();
  String wrappingAlgorithm="http://www.w3.org/2001/04/xmlenc#kw-tripledes";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,keyWrappingKey);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCamellia128KW() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmldsig-more#camellia128-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(128);
  SecretKey keyWrappingKey=keygen.generateKey();
  String wrappingAlgorithm="http://www.w3.org/2001/04/xmldsig-more#kw-camellia128";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,keyWrappingKey);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES256KW() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#aes256-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey keyWrappingKey=keygen.generateKey();
  String wrappingAlgorithm="http://www.w3.org/2001/04/xmlenc#kw-aes256";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,keyWrappingKey);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES192KW() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey keyWrappingKey=keygen.generateKey();
  String wrappingAlgorithm="http://www.w3.org/2001/04/xmlenc#kw-aes192";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,keyWrappingKey);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRSAOAEP11KW() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  Key keyWrappingKey=rsaKeyPair.getPublic();
  String wrappingAlgorithm="http://www.w3.org/2009/xmlenc11#rsa-oaep";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,rsaKeyPair.getPrivate());
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRSAv15KW() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  Key keyWrappingKey=rsaKeyPair.getPublic();
  String wrappingAlgorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,rsaKeyPair.getPrivate());
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES128KW() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey keyWrappingKey=keygen.generateKey();
  String wrappingAlgorithm="http://www.w3.org/2001/04/xmlenc#kw-aes128";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,keyWrappingKey);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRSAOAEPKW() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  Key keyWrappingKey=rsaKeyPair.getPublic();
  String wrappingAlgorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,rsaKeyPair.getPrivate());
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCamellia256KW() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmldsig-more#camellia256-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(256);
  SecretKey keyWrappingKey=keygen.generateKey();
  String wrappingAlgorithm="http://www.w3.org/2001/04/xmldsig-more#kw-camellia256";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,keyWrappingKey);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSEED128KW() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("SEED");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2007/05/xmldsig-more#seed128-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  keygen=KeyGenerator.getInstance("SEED");
  keygen.init(128);
  SecretKey keyWrappingKey=keygen.generateKey();
  String wrappingAlgorithm="http://www.w3.org/2007/05/xmldsig-more#kw-seed128";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,keyWrappingKey);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCamellia192KW() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmldsig-more#camellia192-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(192);
  SecretKey keyWrappingKey=keygen.generateKey();
  String wrappingAlgorithm="http://www.w3.org/2001/04/xmldsig-more#kw-camellia192";
  properties.setEncryptionKeyTransportAlgorithm(wrappingAlgorithm);
  properties.setEncryptionTransportKey(keyWrappingKey);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(document,keyWrappingKey);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.encryption.KeyWrapEncryptionVerificationTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRSAv15KW() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.RSA_v1dot5);
  Key keyWrappingKey=rsaKeyPair.getPublic();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.TRIPLEDES;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(rsaKeyPair.getPrivate());
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES128KW() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.AES_128_KeyWrap);
  keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey keyWrappingKey=keygen.generateKey();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.AES_128;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(keyWrappingKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCamellia256KW() throws Exception {
  if (!bcInstalled) {
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.CAMELLIA_256_KeyWrap);
  keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(256);
  SecretKey keyWrappingKey=keygen.generateKey();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.CAMELLIA_256;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(keyWrappingKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES256KW() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.AES_256_KeyWrap);
  keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey keyWrappingKey=keygen.generateKey();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.AES_256;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(keyWrappingKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRSAOAEP11KW() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.RSA_OAEP_11);
  Key keyWrappingKey=rsaKeyPair.getPublic();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.TRIPLEDES;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(rsaKeyPair.getPrivate());
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCamellia128KW() throws Exception {
  if (!bcInstalled) {
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.CAMELLIA_128_KeyWrap);
  keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(128);
  SecretKey keyWrappingKey=keygen.generateKey();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.CAMELLIA_128;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(keyWrappingKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCamellia192KW() throws Exception {
  if (!bcInstalled) {
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.CAMELLIA_192_KeyWrap);
  keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(192);
  SecretKey keyWrappingKey=keygen.generateKey();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.CAMELLIA_192;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(keyWrappingKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRSAOAEPKW() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.RSA_OAEP);
  Key keyWrappingKey=rsaKeyPair.getPublic();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.TRIPLEDES;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(rsaKeyPair.getPrivate());
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTripleDESKW() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.TRIPLEDES_KeyWrap);
  keygen=KeyGenerator.getInstance("DESede");
  SecretKey keyWrappingKey=keygen.generateKey();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.TRIPLEDES;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(keyWrappingKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES192KW() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.AES_192_KeyWrap);
  keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey keyWrappingKey=keygen.generateKey();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.AES_192;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(keyWrappingKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSEED128KW() throws Exception {
  if (!bcInstalled) {
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("SEED");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  XMLCipher cipher=XMLCipher.getInstance(XMLCipher.SEED_128_KeyWrap);
  keygen=KeyGenerator.getInstance("SEED");
  keygen.init(128);
  SecretKey keyWrappingKey=keygen.generateKey();
  cipher.init(XMLCipher.WRAP_MODE,keyWrappingKey);
  EncryptedKey encryptedKey=cipher.encryptKey(document,key);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String encryptionAlgorithm=XMLCipher.SEED_128;
  encrypt(encryptedKey,encryptionAlgorithm,document,localNames,key);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(keyWrappingKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.encryption.SymmetricEncryptionCreationTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCAMELLIA_128() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmldsig-more#camellia128-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCAMELLIA_192() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmldsig-more#camellia192-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES128_GCM() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2009/xmlenc11#aes128-gcm";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES128() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTRIPLE_DES() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES192() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES256_GCM() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES192_GCM() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2009/xmlenc11#aes192-gcm";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES256() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmlenc#aes256-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSEED_128() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("SEED");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2007/05/xmldsig-more#seed128-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCAMELLIA_256() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  properties.setEncryptionKey(key);
  String algorithm="http://www.w3.org/2001/04/xmldsig-more#camellia256-cbc";
  properties.setEncryptionSymAlgorithm(algorithm);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","PaymentInfo");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_xenc_EncryptedData.getNamespaceURI(),XMLSecurityConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Document doc=decryptUsingDOM(algorithm,key,null,document);
  nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.encryption.SymmetricEncryptionVerificationTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCAMELLIA_128() throws Exception {
  if (!bcInstalled) {
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2001/04/xmldsig-more#camellia128-cbc";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES128() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES192() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES256() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2001/04/xmlenc#aes256-cbc";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES192_GCM() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2009/xmlenc11#aes192-gcm";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES256_GCM() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSEED_128() throws Exception {
  if (!bcInstalled) {
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("SEED");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2007/05/xmldsig-more#seed128-cbc";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCAMELLIA_256() throws Exception {
  if (!bcInstalled) {
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(256);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2001/04/xmldsig-more#camellia256-cbc";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAES128_GCM() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("AES");
  keygen.init(128);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2009/xmlenc11#aes128-gcm";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTRIPLE_DES() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("DESede");
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCAMELLIA_192() throws Exception {
  if (!bcInstalled) {
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyGenerator keygen=KeyGenerator.getInstance("Camellia");
  keygen.init(192);
  SecretKey key=keygen.generateKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  String algorithm="http://www.w3.org/2001/04/xmldsig-more#camellia192-cbc";
  encryptUsingDOM(algorithm,key,null,null,document,localNames,false);
  NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),0);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
  nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.SignatureCreationReferenceURIResolverTest </h4><pre class="type-12 type-4 type-13 type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignatureCreationWithSameDocumentXPointerIdApostropheReference() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),true,SecurePart.Modifier.Element);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS("http://www.w3.org/2000/09/xmldsig#","Reference");
  Assert.assertEquals(1,nodeList.getLength());
  String uri=((Element)nodeList.item(0)).getAttribute("URI");
  Assert.assertNotNull(uri);
  Assert.assertTrue(uri.startsWith("#xpointer"));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.SignatureCreationTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDifferentDigestMethodForReference() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},"http://www.w3.org/2001/04/xmlenc#sha256");
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_CanonicalizationMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_CanonicalizationMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(XMLSecurityConstants.NS_C14N_EXCL,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_Transform.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_Transform.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  element=(Element)nodeList.item(0);
  Assert.assertEquals(XMLSecurityConstants.NS_C14N_EXCL,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_SignatureMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_SignatureMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  element=(Element)nodeList.item(0);
  Assert.assertEquals(XMLSecurityConstants.NS_XMLDSIG_RSASHA1,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  element=(Element)nodeList.item(0);
  Assert.assertEquals("http://www.w3.org/2001/04/xmlenc#sha256",element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-8 type-14 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSignRootElementInRequest() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecurePart securePart=new SecurePart(null,SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2000/09/xmldsig#enveloped-signature","http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},"http://www.w3.org/2000/09/xmldsig#sha1");
  securePart.setSecureEntireRequest(true);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  Node childNode=document.getDocumentElement().getFirstChild();
  while (childNode != null) {
    if (childNode.getNodeType() == Node.ELEMENT_NODE) {
      Element element=(Element)childNode;
      Assert.assertEquals(element.getLocalName(),"Signature");
      break;
    }
    childNode=childNode.getNextSibling();
  }
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-8 type-4 type-13 type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleSignatures() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  sourceDocument=new ByteArrayInputStream(baos.toByteArray());
  outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  baos=new ByteArrayOutputStream();
  xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  XPathFactory xpf=XPathFactory.newInstance();
  XPath xpath=xpf.newXPath();
  xpath.setNamespaceContext(new DSNamespaceContext());
  String expression="//dsig:Signature";
  NodeList sigElements=(NodeList)xpath.evaluate(expression,document,XPathConstants.NODESET);
  Assert.assertTrue(sigElements.getLength() == 2);
  for (  SecurePart secPart : properties.getSignatureSecureParts()) {
    if (secPart.getName() == null) {
      continue;
    }
    expression="//*[local-name()='" + secPart.getName().getLocalPart() + "']";
    Element signedElement=(Element)xpath.evaluate(expression,document,XPathConstants.NODE);
    Assert.assertNotNull(signedElement);
    signedElement.setIdAttributeNS(null,"Id",true);
  }
  for (int i=0; i < sigElements.getLength(); i++) {
    XMLSignature signature=new XMLSignature((Element)sigElements.item(i),"");
    Assert.assertTrue(signature.checkSignatureValue(cert));
  }
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDifferentC14nMethodForReference() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},"http://www.w3.org/2000/09/xmldsig#sha1");
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_CanonicalizationMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_CanonicalizationMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(XMLSecurityConstants.NS_C14N_EXCL,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_Transform.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_Transform.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  element=(Element)nodeList.item(0);
  Assert.assertEquals("http://www.w3.org/TR/2001/REC-xml-c14n-20010315",element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_SignatureMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_SignatureMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  element=(Element)nodeList.item(0);
  Assert.assertEquals(XMLSecurityConstants.NS_XMLDSIG_RSASHA1,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  element=(Element)nodeList.item(0);
  Assert.assertEquals(XMLSecurityConstants.NS_XMLDSIG_SHA1,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-8 type-14 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEnvelopedSignatureCreation() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PurchaseOrder"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2000/09/xmldsig#enveloped-signature","http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},"http://www.w3.org/2000/09/xmldsig#sha1");
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  Node childNode=document.getDocumentElement().getFirstChild();
  while (childNode != null) {
    if (childNode.getNodeType() == Node.ELEMENT_NODE) {
      Element element=(Element)childNode;
      Assert.assertEquals(element.getLocalName(),"Signature");
      break;
    }
    childNode=childNode.getNextSibling();
  }
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-8 type-14 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSignatureCreation() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  Node childNode=document.getDocumentElement().getFirstChild();
  while (childNode != null) {
    if (childNode.getNodeType() == Node.ELEMENT_NODE) {
      Element element=(Element)childNode;
      Assert.assertEquals(element.getLocalName(),"Signature");
      break;
    }
    childNode=childNode.getNextSibling();
  }
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExcC14nInclusivePrefixes() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  properties.setSignatureCanonicalizationAlgorithm(XMLSecurityConstants.NS_C14N_EXCL);
  properties.setAddExcC14NInclusivePrefixes(true);
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_c14nExcl_InclusiveNamespaces.getNamespaceURI(),XMLSecurityConstants.TAG_c14nExcl_InclusiveNamespaces.getLocalPart());
  Assert.assertEquals(2,nodeList.getLength());
  Assert.assertEquals("",((Element)nodeList.item(0)).getAttribute(XMLSecurityConstants.ATT_NULL_PrefixList.getLocalPart()));
  Assert.assertEquals("",((Element)nodeList.item(1)).getAttribute(XMLSecurityConstants.ATT_NULL_PrefixList.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.SignatureDigestCreationTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSHA3_224() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2007/05/xmldsig-more#sha3-224";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSHA3_256() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2007/05/xmldsig-more#sha3-256";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSHA512() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2001/04/xmlenc#sha512";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWhirlpool() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2007/05/xmldsig-more#whirlpool";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSHA3_512() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2007/05/xmldsig-more#sha3-512";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSHA384() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2001/04/xmldsig-more#sha384";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSHA3_384() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2007/05/xmldsig-more#sha3-384";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSHA1() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2000/09/xmldsig#sha1";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSHA224() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2001/04/xmldsig-more#sha224";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRIPEMD160() throws Exception {
  if (!bcInstalled) {
    return;
  }
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2001/04/xmlenc#ripemd160";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSHA256() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  String digestAlgorithm="http://www.w3.org/2001/04/xmlenc#sha256";
  SecurePart securePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},digestAlgorithm);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_DigestMethod.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_DigestMethod.getLocalPart());
  Assert.assertEquals(1,nodeList.getLength());
  Element element=(Element)nodeList.item(0);
  Assert.assertEquals(digestAlgorithm,element.getAttribute(XMLSecurityConstants.ATT_NULL_Algorithm.getLocalPart()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.SignatureEncryptionTest </h4><pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptionSignature() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecretKey encryptionKey=generateDESSecretKey();
  properties.setEncryptionKey(encryptionKey);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart signatureSecurePart=new SecurePart(new QName("urn:example:po","PurchaseOrder"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2000/09/xmldsig#enveloped-signature","http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},"http://www.w3.org/2000/09/xmldsig#sha1");
  properties.addSignaturePart(signatureSecurePart);
  SecurePart encryptionSecurePart=new SecurePart(new QName("urn:example:po","PurchaseOrder"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(encryptionSecurePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",encryptionKey,null,document);
  NodeList nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  TestSecurityEventListener testSecurityEventListener=verifyUsingStAX(baos.toByteArray(),encryptionKey,cert.getPublicKey());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.SignedElement).size());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.ContentEncrypted).size());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEnvelopedSignatureEncryptionContent() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecretKey encryptionKey=generateDESSecretKey();
  properties.setEncryptionKey(encryptionKey);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart signatureSecurePart=new SecurePart(new QName("urn:example:po","PurchaseOrder"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2000/09/xmldsig#enveloped-signature","http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},"http://www.w3.org/2000/09/xmldsig#sha1");
  properties.addSignaturePart(signatureSecurePart);
  SecurePart encryptionSecurePart=new SecurePart(new QName("urn:example:po","PurchaseOrder"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(encryptionSecurePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",encryptionKey,null,document);
  NodeList nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
  TestSecurityEventListener testSecurityEventListener=verifyUsingStAX(baos.toByteArray(),encryptionKey,cert.getPublicKey());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.SignedElement).size());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.ContentEncrypted).size());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEnvelopedSignatureEncryptionElement() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecretKey encryptionKey=generateDESSecretKey();
  properties.setEncryptionKey(encryptionKey);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart signatureSecurePart=new SecurePart(new QName("urn:example:po","PurchaseOrder"),SecurePart.Modifier.Content,new String[]{"http://www.w3.org/2000/09/xmldsig#enveloped-signature","http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},"http://www.w3.org/2000/09/xmldsig#sha1");
  properties.addSignaturePart(signatureSecurePart);
  SecurePart encryptionSecurePart=new SecurePart(new QName("urn:example:po","PurchaseOrder"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(encryptionSecurePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",encryptionKey,null,document);
  NodeList nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
  TestSecurityEventListener testSecurityEventListener=verifyUsingStAX(baos.toByteArray(),encryptionKey,cert.getPublicKey());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.SignedElement).size());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.EncryptedElement).size());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSignatureEncryption() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecretKey encryptionKey=generateDESSecretKey();
  properties.setEncryptionKey(encryptionKey);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart signatureSecurePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addSignaturePart(signatureSecurePart);
  SecurePart encryptionSecurePart=new SecurePart(new QName("urn:example:po","PurchaseOrder"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(encryptionSecurePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",encryptionKey,null,document);
  NodeList nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
  TestSecurityEventListener testSecurityEventListener=verifyUsingStAX(baos.toByteArray(),encryptionKey,cert.getPublicKey());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.SignedElement).size());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.ContentEncrypted).size());
}

</code></pre>

<br>
<pre class="type-12 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSignatureEncryptionSameElement() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecretKey encryptionKey=generateDESSecretKey();
  properties.setEncryptionKey(encryptionKey);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart signatureSecurePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addSignaturePart(signatureSecurePart);
  SecurePart encryptionSecurePart=new SecurePart(new QName("urn:example:po","PaymentInfo"),SecurePart.Modifier.Element);
  properties.addEncryptionPart(encryptionSecurePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=XMLUtils.createDocumentBuilder(false).parse(new ByteArrayInputStream(baos.toByteArray()));
  Document doc=decryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",encryptionKey,null,document);
  NodeList nodeList=doc.getElementsByTagNameNS("urn:example:po","CreditCard");
  Assert.assertEquals(nodeList.getLength(),1);
  verifyUsingDOM(document,cert,properties.getSignatureSecureParts());
  TestSecurityEventListener testSecurityEventListener=verifyUsingStAX(baos.toByteArray(),encryptionKey,cert.getPublicKey());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.SignedElement).size());
  Assert.assertEquals(1,testSecurityEventListener.getSecurityEvents(SecurityEventConstants.EncryptedElement).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.SignatureVerificationReferenceURIResolverTest </h4><pre class="type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testSignatureVerificationWithSameDocumentXPointerIdDoubleQuoteReference() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  XPathFactory xpf=XPathFactory.newInstance();
  XPath xpath=xpf.newXPath();
  xpath.setNamespaceContext(new DSNamespaceContext());
  String expression="//*[local-name()='ShippingAddress']";
  Element elementToSign=(Element)xpath.evaluate(expression,document,XPathConstants.NODE);
  Assert.assertNotNull(elementToSign);
  String id=UUID.randomUUID().toString();
  elementToSign.setAttributeNS(null,"Id",id);
  elementToSign.setIdAttributeNS(null,"Id",true);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  ReferenceInfo referenceInfo=new ReferenceInfo("#xpointer(id(\"" + id + "\"))",new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},"http://www.w3.org/2000/09/xmldsig#sha1",false);
  List<ReferenceInfo> referenceInfos=new ArrayList<ReferenceInfo>();
  referenceInfos.add(referenceInfo);
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#rsa-sha1",document,localNames,key,referenceInfos);
  sig.addKeyInfo(cert);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setSignatureVerificationKey(cert.getPublicKey());
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader);
  StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
}

</code></pre>

<br>
<pre class="type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testSignatureVerificationWithSameDocumentXPointerIdApostropheReference() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  XPathFactory xpf=XPathFactory.newInstance();
  XPath xpath=xpf.newXPath();
  xpath.setNamespaceContext(new DSNamespaceContext());
  String expression="//*[local-name()='ShippingAddress']";
  Element elementToSign=(Element)xpath.evaluate(expression,document,XPathConstants.NODE);
  Assert.assertNotNull(elementToSign);
  String id=UUID.randomUUID().toString();
  elementToSign.setAttributeNS(null,"Id",id);
  elementToSign.setIdAttributeNS(null,"Id",true);
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  ReferenceInfo referenceInfo=new ReferenceInfo("#xpointer(id('" + id + "'))",new String[]{"http://www.w3.org/2001/10/xml-exc-c14n#"},"http://www.w3.org/2000/09/xmldsig#sha1",false);
  List<ReferenceInfo> referenceInfos=new ArrayList<ReferenceInfo>();
  referenceInfos.add(referenceInfo);
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#rsa-sha1",document,localNames,key,referenceInfos);
  sig.addKeyInfo(cert);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setSignatureVerificationKey(cert.getPublicKey());
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader);
  StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
