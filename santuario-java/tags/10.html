<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.xml.security.test.dom.utils.DocumentBuilderPoolingTest </h4><pre class="type-8 type-10 type-4 type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testPooling() throws Exception {
  int nThreads=8;
  ExecutorService exec=Executors.newFixedThreadPool(nThreads);
  Future<?>[] results=new Future[nThreads];
  for (int i=0; i < nThreads - 1; i++) {
    results[i]=exec.submit(new Runnable(){
      @Override public void run(){
        try {
          while (true) {
            DocumentBuilder documentBuilders[]=new DocumentBuilder[10];
            for (int j=0; j < documentBuilders.length; j++) {
              documentBuilders[j]=XMLUtils.createDocumentBuilder(false);
              assertNotNull(documentBuilders[j]);
            }
            for (int j=0; j < documentBuilders.length; j++) {
              assertTrue(XMLUtils.repoolDocumentBuilder(documentBuilders[j]));
            }
          }
        }
 catch (        Exception e) {
          throw new RuntimeException(e);
        }
      }
    }
);
  }
  results[nThreads - 1]=exec.submit(new Runnable(){
    @Override public void run(){
      try {
        final Field poolField=XMLUtils.class.getDeclaredField("pools");
        poolField.setAccessible(true);
        final WeakObjectPool[] weakObjectPools=(WeakObjectPool[])poolField.get(null);
        final Field availableField=WeakObjectPool.class.getDeclaredField("available");
        availableField.setAccessible(true);
        while (true) {
          final BlockingDeque blockingDeque=(BlockingDeque)availableField.get(weakObjectPools[1]);
          Iterator iterator=blockingDeque.iterator();
          while (iterator.hasNext()) {
            ((WeakReference)iterator.next()).clear();
          }
          Thread.sleep(200);
        }
      }
 catch (      InterruptedException e) {
        return;
      }
catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  exec.shutdown();
  exec.awaitTermination(5,TimeUnit.SECONDS);
  for (  Future<?> f : results) {
    if (!f.isDone()) {
      f.cancel(false);
    }
    try {
      assertNull(f.get(1000,TimeUnit.MILLISECONDS));
    }
 catch (    CancellationException ce) {
    }
catch (    TimeoutException e) {
      fail(f + "didn't cancel after timeout?");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.dom.utils.resolver.ResolverDirectHTTPTest </h4><pre class="type-10 type-5 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testProxyAuthWithWrongPassword() throws Exception {
  Document doc=XMLUtils.createDocumentBuilder(false).newDocument();
  Attr uri=doc.createAttribute("URI");
  uri.setNodeValue(url);
  ResolverDirectHTTP resolverDirectHTTP=new ResolverDirectHTTP();
  resolverDirectHTTP.engineSetProperty("http.proxy.host",proxyHost);
  resolverDirectHTTP.engineSetProperty("http.proxy.port",proxyPort);
  resolverDirectHTTP.engineSetProperty("http.proxy.username",proxyUsername);
  resolverDirectHTTP.engineSetProperty("http.proxy.password","wrongPassword");
  ResourceResolverContext context=new ResourceResolverContext(uri,url,true);
  try {
    resolverDirectHTTP.engineResolveURI(context);
    Assert.fail("Expected ResourceResolverException");
  }
 catch (  ResourceResolverException e) {
    Assert.assertEquals("Server returned HTTP response code: 407 for URL: " + url,e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-10 type-5 type-11 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testServerAuthWithWrongPassword() throws Exception {
  Document doc=XMLUtils.createDocumentBuilder(false).newDocument();
  Attr uri=doc.createAttribute("URI");
  uri.setNodeValue(url);
  ResolverDirectHTTP resolverDirectHTTP=new ResolverDirectHTTP();
  resolverDirectHTTP.engineSetProperty("http.basic.username",serverUsername);
  resolverDirectHTTP.engineSetProperty("http.basic.password","wrongPassword");
  ResourceResolverContext context=new ResourceResolverContext(uri,url,true);
  try {
    resolverDirectHTTP.engineResolveURI(context);
    Assert.fail("Expected ResourceResolverException");
  }
 catch (  ResourceResolverException e) {
    Assert.assertEquals("Server returned HTTP response code: 401 for URL: " + url,e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBug40783() throws Exception {
  Document doc=XMLUtils.createDocumentBuilder(false).newDocument();
  Attr uri=doc.createAttribute("id");
  uri.setNodeValue("urn:ddd:uuu");
  doc.createElement("test").setAttributeNode(uri);
  try {
    ResourceResolver resolver=ResourceResolver.getInstance(uri,null,true);
    fail("No exception thrown, but resolver found: " + resolver);
  }
 catch (  ResourceResolverException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.UncategorizedTest </h4><pre class="type-10 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateActions() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  XMLSec.getOutboundXMLSec(properties);
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  try {
    XMLSec.getOutboundXMLSec(properties);
    Assert.fail();
  }
 catch (  XMLSecurityConfigurationException ex) {
    Assert.assertTrue(ex.getMessage().contains("Duplicate Actions are not allowed"));
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigurationLoadFromUrl() throws Exception {
  URL url=this.getClass().getClassLoader().getResource("org/apache/xml/security/c14n/in/31_input.xml");
  try {
    Init.init(url.toURI(),this.getClass());
    Assert.fail();
  }
 catch (  XMLSecurityException e) {
    Assert.assertTrue(e.getMessage().contains("Cannot find the declaration of element 'doc'."));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.c14n.Canonicalizer11Test </h4><pre class="type-10 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Note: This specification supports the recent XML plenary decision to
 * deprecate relative namespace URIs as follows: implementations of XML
 * canonicalization MUST report an operation failure on documents containing
 * relative namespace URIs. XML canonicalization MUST NOT be implemented
 * with an XML parser that converts relative URIs to absolute URIs.
 * <p/>
 * Implementations MUST report an operation failure on documents containing
 * relative namespace URIs.
 */
@Test public void testRelativeNSbehaviour() throws Exception {
  URL fileIn=this.getClass().getClassLoader().getResource("org/apache/xml/security/c14n/in/relative-ns-behaviour.xml");
  try {
    c14nAndCompare(fileIn,fileIn,true);
    fail();
  }
 catch (  XMLStreamException cex) {
    assertTrue(cex != null);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.c14n.Canonicalizer20010315Test </h4><pre class="type-10 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Note: This specification supports the recent XML plenary decision to
 * deprecate relative namespace URIs as follows: implementations of XML
 * canonicalization MUST report an operation failure on documents containing
 * relative namespace URIs. XML canonicalization MUST NOT be implemented
 * with an XML parser that converts relative URIs to absolute URIs.
 * <p/>
 * Implementations MUST report an operation failure on documents containing
 * relative namespace URIs.
 */
@Test public void testRelativeNSbehaviour() throws Exception {
  URL fileIn=this.getClass().getClassLoader().getResource("org/apache/xml/security/c14n/in/relative-ns-behaviour.xml");
  try {
    c14nAndCompare(fileIn,fileIn,true);
    fail();
  }
 catch (  XMLStreamException cex) {
    assertTrue(cex != null);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.encryption.DecryptionTest </h4><pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaximumAllowedXMLStructureDepth() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  for (int i=0; i < 7; i++) {
    NodeList nodeList=document.getElementsByTagNameNS("urn:example:po","CreditCard");
    Element creditCardElement=(Element)nodeList.item(nodeList.getLength() - 1);
    creditCardElement.appendChild(document.getDocumentElement().cloneNode(true));
  }
  SecretKey secretKey=generateSecretKey();
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  encryptUsingDOM("http://www.w3.org/2001/04/xmlenc#tripledes-cbc",secretKey,null,null,document,localNames,false);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setDecryptionKey(secretKey);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  try {
    document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Exception expected");
  }
 catch (  XMLStreamException e) {
    assertTrue(e.getCause() instanceof XMLSecurityException);
    assertEquals("Maximum depth (100) of the XML structure reached. You can raise the maximum via the " + "\"MaximumAllowedXMLStructureDepth\" property in the configuration.",e.getCause().getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.encryption.EncryptionCreationTest </h4><pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExceptionOnElementToEncryptNotFound() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.ENCRYPT);
  properties.setActions(actions);
  SecretKey key=generateDESSecretKey();
  properties.setEncryptionKey(key);
  properties.setEncryptionSymAlgorithm("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  SecurePart securePart=new SecurePart(new QName("urn:example:po","NotExistingElement"),SecurePart.Modifier.Content);
  properties.addEncryptionPart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  try {
    XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
    xmlStreamWriter.close();
    Assert.fail("Exception expected");
  }
 catch (  XMLStreamException e) {
    Assert.assertTrue(e.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("Part to encrypt not found: {urn:example:po}NotExistingElement",e.getCause().getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.BaltimoreTest </h4><pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_twenty_three_enveloping_hmac_sha1_40() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmldsig-twenty-three/signature-enveloping-hmac-sha1-40.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] hmacKey="secret".getBytes("ASCII");
  SecretKey key=new SecretKeySpec(hmacKey,"http://www.w3.org/2000/09/xmldsig#hmac-sha1");
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setSignatureVerificationKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a short HMAC length");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("INVALID signature -- core validation failed.",ex.getCause().getMessage());
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_fifteen_enveloping_hmac_sha1_40() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmldsig-fifteen/signature-enveloping-hmac-sha1-40.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] hmacKey="secret".getBytes("ASCII");
  SecretKey key=new SecretKeySpec(hmacKey,"http://www.w3.org/2000/09/xmldsig#hmac-sha1");
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setSignatureVerificationKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a short HMAC length");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("INVALID signature -- core validation failed.",ex.getCause().getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.IAIKTest </h4><pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_signatureAlgorithms_signatures_hMACShortSignature() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("at/iaik/ixsil/signatureAlgorithms/signatures/hMACShortSignature.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] hmacKey="secret".getBytes("ASCII");
  SecretKey key=new SecretKeySpec(hmacKey,"http://www.w3.org/2000/09/xmldsig#hmac-sha1");
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setSignatureVerificationKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a short HMAC length");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("INVALID signature -- core validation failed.",ex.getCause().getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.PhaosTest </h4><pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_signature_rsa_enveloped_bad_digest_val() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("com/phaos/phaos-xmldsig-three/signature-rsa-enveloped-bad-digest-val.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a bad digest");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("INVALID signature -- core validation failed.",ex.getCause().getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.SignatureCreationTest </h4><pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExceptionOnElementToSignNotFound() throws Exception {
  XMLSecurityProperties properties=new XMLSecurityProperties();
  List<XMLSecurityConstants.Action> actions=new ArrayList<XMLSecurityConstants.Action>();
  actions.add(XMLSecurityConstants.SIGNATURE);
  properties.setActions(actions);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  properties.setSignatureKey(key);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  properties.setSignatureCerts(new X509Certificate[]{cert});
  SecurePart securePart=new SecurePart(new QName("urn:example:po","NotExistingElement"),SecurePart.Modifier.Content);
  properties.addSignaturePart(securePart);
  OutboundXMLSec outboundXMLSec=XMLSec.getOutboundXMLSec(properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=outboundXMLSec.processOutMessage(baos,"UTF-8");
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
  try {
    XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
    xmlStreamWriter.close();
    Assert.fail("Exception expected");
  }
 catch (  XMLStreamException e) {
    Assert.assertTrue(e.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("Part to sign not found: {urn:example:po}NotExistingElement",e.getCause().getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.SignatureEncryptionTest </h4><pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnsecuredDocument() throws Exception {
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  SecretKey encryptionKey=generateDESSecretKey();
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  try {
    verifyUsingStAX(sourceDocument,encryptionKey,cert.getPublicKey());
    Assert.fail("Exception expected");
  }
 catch (  XMLStreamException e) {
    Assert.assertEquals("Unsecured message. Neither a Signature nor a EncryptedData element found.",e.getCause().getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.SignatureVerificationTest </h4><pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaximumAllowedReferencesPerManifest() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("Item");
  localNames.add("PaymentInfo");
  localNames.add("ShippingAddress");
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#rsa-sha1",document,localNames,key);
  sig.addKeyInfo(cert);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  int oldval=0;
  try {
    oldval=TestUtils.changeValueOfMaximumAllowedReferencesPerManifest(2);
    document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Exception expected");
  }
 catch (  XMLStreamException e) {
    assertTrue(e.getCause() instanceof XMLSecurityException);
    assertEquals("4 references are contained in the Manifest, maximum 2 are allowed. You can raise the maximum " + "via the \"MaximumAllowedReferencesPerManifest\" property in the configuration.",e.getCause().getMessage());
  }
 finally {
    TestUtils.changeValueOfMaximumAllowedReferencesPerManifest(oldval);
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisallowMD5Algorithm() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  XMLSignature sig=signUsingDOM("http://www.w3.org/2001/04/xmldsig-more#rsa-md5",document,localNames,key);
  sig.addKeyInfo(cert);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  try {
    document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Exception expected");
  }
 catch (  XMLStreamException e) {
    assertTrue(e.getCause() instanceof XMLSecurityException);
    assertEquals("The use of MD5 algorithm is strongly discouraged. Nonetheless can it be enabled via the " + "\"AllowMD5Algorithm\" property in the configuration.",e.getCause().getMessage());
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHMACSignatureVerificationWrongKey() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  byte[] hmacKey="secret".getBytes("ASCII");
  SecretKey key=new SecretKeySpec(hmacKey,"http://www.w3.org/2000/09/xmldsig#hmac-sha1");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#hmac-sha1",document,localNames,key);
  KeyInfo keyInfo=sig.getKeyInfo();
  KeyName keyName=new KeyName(document,"SecretKey");
  keyInfo.add(keyName);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  byte[] badKey="secret2".getBytes("ASCII");
  key=new SecretKeySpec(badKey,"http://www.w3.org/2000/09/xmldsig#hmac-sha1");
  properties.setSignatureVerificationKey(key);
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a bad key");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("INVALID signature -- core validation failed.",ex.getCause().getMessage());
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialSignedDocumentTampered_ContentFirst() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#rsa-sha1",document,localNames,key);
  sig.addKeyInfo(cert);
  Element paymentInfoElement=(Element)document.getElementsByTagNameNS("urn:example:po","BillingAddress").item(0);
  paymentInfoElement.setTextContent("Dig PLC, 1 First Ave, Dublin 1, US");
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a modified document");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getMessage().contains("Invalid digest of reference"));
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaximumAllowedTransformsPerReference() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#rsa-sha1",document,localNames,key);
  sig.addKeyInfo(cert);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  int oldval=0;
  try {
    oldval=TestUtils.changeValueOfMaximumAllowedTransformsPerReference(0);
    document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Exception expected");
  }
 catch (  XMLStreamException e) {
    assertTrue(e.getCause() instanceof XMLSecurityException);
    assertEquals("1 transforms are contained in the Reference, maximum 0 are allowed. You can raise the maximum " + "via the \"MaximumAllowedTransformsPerReference\" property in the configuration.",e.getCause().getMessage());
  }
 finally {
    TestUtils.changeValueOfMaximumAllowedTransformsPerReference(oldval);
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnvelopedSignatureTampered_SignatureFirst() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  ReferenceInfo referenceInfo=new ReferenceInfo("",new String[]{"http://www.w3.org/2000/09/xmldsig#enveloped-signature","http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},"http://www.w3.org/2000/09/xmldsig#sha1",false);
  List<ReferenceInfo> referenceInfos=new ArrayList<ReferenceInfo>();
  referenceInfos.add(referenceInfo);
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#rsa-sha1",document,localNames,key,referenceInfos);
  sig.addKeyInfo(cert);
  Element paymentInfoElement=(Element)document.getElementsByTagNameNS("urn:example:po","BillingAddress").item(0);
  paymentInfoElement.setTextContent("Dig PLC, 1 First Ave, Dublin 1, US");
  Element sigElement=(Element)document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_Signature.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_Signature.getLocalPart()).item(0);
  document.getDocumentElement().insertBefore(sigElement,XMLUtils.getNextElement(document.getDocumentElement().getFirstChild()));
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a modified document");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getMessage().contains("Invalid digest of reference"));
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaximumAllowedXMLStructureDepth() throws Exception {
  String jsv=System.getProperty("java.specification.version");
  if (Double.parseDouble(jsv) > 1.7) {
    System.out.println("testMaximumAllowedXMLStructureDepth skipped");
    return;
  }
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#rsa-sha1",document,localNames,key);
  sig.addKeyInfo(cert);
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  int oldval=0;
  try {
    oldval=TestUtils.changeValueOfMaximumAllowedXMLStructureDepth(5);
    document=StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Exception expected");
  }
 catch (  XMLStreamException e) {
    assertTrue(e.getCause() instanceof XMLSecurityException);
    assertEquals("Maximum depth (5) of the XML structure reached. You can raise the maximum via the " + "\"MaximumAllowedXMLStructureDepth\" property in the configuration.",e.getCause().getMessage());
  }
 finally {
    TestUtils.changeValueOfMaximumAllowedXMLStructureDepth(oldval);
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialSignedDocumentTampered_SignatureFirst() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  localNames.add("PaymentInfo");
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#rsa-sha1",document,localNames,key);
  sig.addKeyInfo(cert);
  Element paymentInfoElement=(Element)document.getElementsByTagNameNS("urn:example:po","BillingAddress").item(0);
  paymentInfoElement.setTextContent("Dig PLC, 1 First Ave, Dublin 1, US");
  Element sigElement=(Element)document.getElementsByTagNameNS(XMLSecurityConstants.TAG_dsig_Signature.getNamespaceURI(),XMLSecurityConstants.TAG_dsig_Signature.getLocalPart()).item(0);
  document.getDocumentElement().insertBefore(sigElement,XMLUtils.getNextElement(document.getDocumentElement().getFirstChild()));
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a modified document");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getMessage().contains("Invalid digest of reference"));
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnvelopedSignatureTampered_ContentFirst() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("transmitter.jks").openStream(),"default".toCharArray());
  Key key=keyStore.getKey("transmitter","default".toCharArray());
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("transmitter");
  List<String> localNames=new ArrayList<String>();
  ReferenceInfo referenceInfo=new ReferenceInfo("",new String[]{"http://www.w3.org/2000/09/xmldsig#enveloped-signature","http://www.w3.org/TR/2001/REC-xml-c14n-20010315"},"http://www.w3.org/2000/09/xmldsig#sha1",false);
  List<ReferenceInfo> referenceInfos=new ArrayList<ReferenceInfo>();
  referenceInfos.add(referenceInfo);
  XMLSignature sig=signUsingDOM("http://www.w3.org/2000/09/xmldsig#rsa-sha1",document,localNames,key,referenceInfos);
  sig.addKeyInfo(cert);
  Element paymentInfoElement=(Element)document.getElementsByTagNameNS("urn:example:po","BillingAddress").item(0);
  paymentInfoElement.setTextContent("Dig PLC, 1 First Ave, Dublin 1, US");
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  TestSecurityEventListener securityEventListener=new TestSecurityEventListener();
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader,null,securityEventListener);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a modified document");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getMessage().contains("Invalid digest of reference"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.signature.UnknownAlgoSignatureTest </h4><pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadTransformAlgo() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/temp/signature/signature-bad-transform-algo.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("org/apache/xml/security/samples/input/keystore.jks").openStream(),null);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("test");
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setSignatureVerificationKey(cert.getPublicKey());
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a bad transform algorithm");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("INVALID signature -- core validation failed.",ex.getCause().getMessage());
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadC14nAlgo() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/temp/signature/signature-bad-c14n-algo.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("org/apache/xml/security/samples/input/keystore.jks").openStream(),null);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("test");
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setSignatureVerificationKey(cert.getPublicKey());
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a bad c14n algorithm");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("Unknown transformation. No handler installed for URI http://www.apache.org/bad-c14n-algo",ex.getCause().getMessage());
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadSigAlgo() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("org/apache/xml/security/temp/signature/signature-bad-sig-algo.xml");
  DocumentBuilder builder=XMLUtils.createDocumentBuilder(false);
  Document document=builder.parse(sourceDocument);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResource("org/apache/xml/security/samples/input/keystore.jks").openStream(),null);
  X509Certificate cert=(X509Certificate)keyStore.getCertificate("test");
  javax.xml.transform.Transformer transformer=transformerFactory.newTransformer();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  transformer.transform(new DOMSource(document),new StreamResult(baos));
  final XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));
  XMLSecurityProperties properties=new XMLSecurityProperties();
  properties.setSignatureVerificationKey(cert.getPublicKey());
  InboundXMLSec inboundXMLSec=XMLSec.getInboundWSSec(properties);
  XMLStreamReader securityStreamReader=inboundXMLSec.processInMessage(xmlStreamReader);
  try {
    StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false),securityStreamReader);
    fail("Failure expected on a bad signature algorithm");
  }
 catch (  XMLStreamException ex) {
    Assert.assertTrue(ex.getCause() instanceof XMLSecurityException);
    Assert.assertEquals("The algorithm URI \"http://www.apache.org/bad-sig-algo\" could not be mapped to a JCE algorithm",ex.getCause().getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.transformer.TransformBase64DecodeTest </h4><pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputStreamToInputStreamAPI() throws Exception {
  TransformBase64Decode transformBase64Decode=new TransformBase64Decode();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.InputStream;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      Assert.fail("unexpected call to transform(XMLSecEvent");
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      try {
        XMLSecurityUtils.copy(inputStream,byteArrayOutputStream);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformBase64Decode.setTransformer(transformer);
  transformBase64Decode.transform(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/base64.xml"));
  transformBase64Decode.doFinal();
  Assert.assertEquals(615,byteArrayOutputStream.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputStreamToXMLSecEventAPI() throws Exception {
  TransformBase64Decode transformBase64Decode=new TransformBase64Decode();
  final List<XMLSecEvent> xmlSecEvents=new ArrayList<XMLSecEvent>();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.XMLSecEvent;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      xmlSecEvents.add(xmlSecEvent);
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      Assert.fail("unexpected call to transform(InputStream");
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformBase64Decode.setTransformer(transformer);
  transformBase64Decode.transform(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/base64.xml"));
  transformBase64Decode.doFinal();
  Assert.assertEquals(44,xmlSecEvents.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXMLSecEventToXMLSecEventAPI() throws Exception {
  TransformBase64Decode transformBase64Decode=new TransformBase64Decode();
  final List<XMLSecEvent> xmlSecEvents=new ArrayList<XMLSecEvent>();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.XMLSecEvent;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      xmlSecEvents.add(xmlSecEvent);
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      Assert.fail("unexpected call to transform(InputStream");
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformBase64Decode.setTransformer(transformer);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml"));
  XMLSecEvent xmlSecEvent=null;
  while (xmlSecEventReader.hasNext()) {
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    if (xmlSecEvent.isStartElement() && xmlSecEvent.asStartElement().getName().equals(new QName("urn:example:po","PaymentInfo"))) {
      break;
    }
  }
  while (xmlSecEventReader.hasNext()) {
    transformBase64Decode.transform(xmlSecEvent);
    if (xmlSecEvent.isEndElement() && xmlSecEvent.asEndElement().getName().equals(new QName("urn:example:po","PaymentInfo"))) {
      break;
    }
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
  }
  transformBase64Decode.doFinal();
  Assert.assertEquals(16,xmlSecEvents.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXMLSecEventToInputStreamAPI() throws Exception {
  TransformBase64Decode transformBase64Decode=new TransformBase64Decode();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.InputStream;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      Assert.fail("unexpected call to transform(XMLSecEvent");
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      try {
        XMLSecurityUtils.copy(inputStream,byteArrayOutputStream);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformBase64Decode.setTransformer(transformer);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml"));
  XMLSecEvent xmlSecEvent=null;
  while (xmlSecEventReader.hasNext()) {
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    if (xmlSecEvent.isStartElement() && xmlSecEvent.asStartElement().getName().equals(new QName("urn:example:po","PaymentInfo"))) {
      break;
    }
  }
  while (xmlSecEventReader.hasNext()) {
    transformBase64Decode.transform(xmlSecEvent);
    if (xmlSecEvent.isEndElement() && xmlSecEvent.asEndElement().getName().equals(new QName("urn:example:po","PaymentInfo"))) {
      break;
    }
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
  }
  transformBase64Decode.doFinal();
  Assert.assertEquals(153,byteArrayOutputStream.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.transformer.TransformCanonicalizerTest </h4><pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputStreamToXMLSecEventAPI() throws Exception {
  Canonicalizer20010315_OmitCommentsTransformer canonicalizerTransformer=new Canonicalizer20010315_OmitCommentsTransformer();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.XMLSecEvent;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      Assert.fail("unexpected call to transform(XMLSecEvent");
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      try {
        XMLSecurityUtils.copy(inputStream,byteArrayOutputStream);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  canonicalizerTransformer.setTransformer(transformer);
  canonicalizerTransformer.transform(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml"));
  canonicalizerTransformer.doFinal();
  Assert.assertEquals(554,byteArrayOutputStream.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputStreamToInputStreamAPI() throws Exception {
  Canonicalizer20010315_OmitCommentsTransformer canonicalizerTransformer=new Canonicalizer20010315_OmitCommentsTransformer();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.InputStream;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      Assert.fail("unexpected call to transform(XMLSecEvent");
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      try {
        XMLSecurityUtils.copy(inputStream,byteArrayOutputStream);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  canonicalizerTransformer.setTransformer(transformer);
  canonicalizerTransformer.transform(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml"));
  canonicalizerTransformer.doFinal();
  Assert.assertEquals(554,byteArrayOutputStream.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXMLSecEventToXMLSecEventAPI() throws Exception {
  Canonicalizer20010315_OmitCommentsTransformer canonicalizerTransformer=new Canonicalizer20010315_OmitCommentsTransformer();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.XMLSecEvent;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      Assert.fail("unexpected call to transform(XMLSecEvent");
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      try {
        XMLSecurityUtils.copy(inputStream,byteArrayOutputStream);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  canonicalizerTransformer.setTransformer(transformer);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml"));
  while (xmlSecEventReader.hasNext()) {
    XMLSecEvent xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    canonicalizerTransformer.transform(xmlSecEvent);
  }
  canonicalizerTransformer.doFinal();
  Assert.assertEquals(554,byteArrayOutputStream.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXMLSecEventToInputStreamAPI() throws Exception {
  Canonicalizer20010315_OmitCommentsTransformer canonicalizerTransformer=new Canonicalizer20010315_OmitCommentsTransformer();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.InputStream;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      Assert.fail("unexpected call to transform(XMLSecEvent");
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      try {
        XMLSecurityUtils.copy(inputStream,byteArrayOutputStream);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  canonicalizerTransformer.setTransformer(transformer);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml"));
  while (xmlSecEventReader.hasNext()) {
    XMLSecEvent xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    canonicalizerTransformer.transform(xmlSecEvent);
  }
  canonicalizerTransformer.doFinal();
  Assert.assertEquals(554,byteArrayOutputStream.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.transformer.TransformEnvelopedSignatureTest </h4><pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXMLSecEventToInputStreamAPI() throws Exception {
  TransformEnvelopedSignature transformEnvelopedSignature=new TransformEnvelopedSignature();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.InputStream;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      Assert.fail("unexpected call to transform(XMLSecEvent");
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      try {
        XMLSecurityUtils.copy(inputStream,byteArrayOutputStream);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformEnvelopedSignature.setTransformer(transformer);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("com/phaos/phaos-xmldsig-three/signature-rsa-enveloped.xml"));
  while (xmlSecEventReader.hasNext()) {
    XMLSecEvent xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    transformEnvelopedSignature.transform(xmlSecEvent);
  }
  transformEnvelopedSignature.doFinal();
  Assert.assertEquals(207,byteArrayOutputStream.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXMLSecEventToXMLSecEventAPI() throws Exception {
  TransformEnvelopedSignature transformEnvelopedSignature=new TransformEnvelopedSignature();
  final List<XMLSecEvent> xmlSecEvents=new ArrayList<XMLSecEvent>();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.XMLSecEvent;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      xmlSecEvents.add(xmlSecEvent);
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      Assert.fail("unexpected call to transform(InputStream");
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformEnvelopedSignature.setTransformer(transformer);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("com/phaos/phaos-xmldsig-three/signature-rsa-enveloped.xml"));
  while (xmlSecEventReader.hasNext()) {
    XMLSecEvent xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    transformEnvelopedSignature.transform(xmlSecEvent);
  }
  transformEnvelopedSignature.doFinal();
  Assert.assertEquals(19,xmlSecEvents.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.xml.security.test.stax.transformer.TransformIdentityTest </h4><pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputStreamToXMLSecEventAPI() throws Exception {
  TransformIdentity transformIdentity=new TransformIdentity();
  final List<XMLSecEvent> xmlSecEvents=new ArrayList<XMLSecEvent>();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.XMLSecEvent;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      xmlSecEvents.add(xmlSecEvent);
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      Assert.fail("unexpected call to transform(InputStream");
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformIdentity.setTransformer(transformer);
  transformIdentity.transform(new UnixInputStream(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml")));
  transformIdentity.doFinal();
  Assert.assertEquals(25,xmlSecEvents.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXMLSecEventToXMLSecEventAPI() throws Exception {
  TransformIdentity transformIdentity=new TransformIdentity();
  final List<XMLSecEvent> xmlSecEvents=new ArrayList<XMLSecEvent>();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.XMLSecEvent;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      xmlSecEvents.add(xmlSecEvent);
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      Assert.fail("unexpected call to transform(InputStream");
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformIdentity.setTransformer(transformer);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml"));
  XMLSecEvent xmlSecEvent=null;
  while (xmlSecEventReader.hasNext()) {
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    if (xmlSecEvent.isStartElement() && xmlSecEvent.asStartElement().getName().equals(new QName("urn:example:po","PaymentInfo"))) {
      break;
    }
  }
  while (xmlSecEventReader.hasNext()) {
    transformIdentity.transform(xmlSecEvent);
    if (xmlSecEvent.isEndElement() && xmlSecEvent.asEndElement().getName().equals(new QName("urn:example:po","PaymentInfo"))) {
      break;
    }
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
  }
  transformIdentity.doFinal();
  Assert.assertEquals(3,xmlSecEvents.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputStreamToInputStreamAPI() throws Exception {
  TransformIdentity transformIdentity=new TransformIdentity();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.InputStream;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      Assert.fail("unexpected call to transform(XMLSecEvent");
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      try {
        XMLSecurityUtils.copy(inputStream,byteArrayOutputStream);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformIdentity.setTransformer(transformer);
  transformIdentity.transform(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/base64.xml"));
  transformIdentity.doFinal();
  Assert.assertEquals(831,byteArrayOutputStream.size());
}

</code></pre>

<br>
<pre class="type-10 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testXMLSecEventToInputStreamAPI() throws Exception {
  TransformIdentity transformIdentity=new TransformIdentity();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  Transformer transformer=new Transformer(){
    @Override public void setOutputStream(    OutputStream outputStream) throws XMLSecurityException {
    }
    @Override public void setTransformer(    Transformer transformer) throws XMLSecurityException {
    }
    @Override public void setProperties(    Map<String,Object> properties) throws XMLSecurityException {
    }
    @Override public XMLSecurityConstants.TransformMethod getPreferredTransformMethod(    XMLSecurityConstants.TransformMethod forInput){
      return XMLSecurityConstants.TransformMethod.InputStream;
    }
    @Override public void transform(    XMLSecEvent xmlSecEvent) throws XMLStreamException {
      Assert.fail("unexpected call to transform(XMLSecEvent");
    }
    @Override public void transform(    InputStream inputStream) throws XMLStreamException {
      try {
        XMLSecurityUtils.copy(inputStream,byteArrayOutputStream);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
    @Override public void doFinal() throws XMLStreamException {
    }
  }
;
  transformIdentity.setTransformer(transformer);
  XMLEventReader xmlSecEventReader=xmlInputFactory.createXMLEventReader(this.getClass().getClassLoader().getResourceAsStream("ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml"));
  XMLSecEvent xmlSecEvent=null;
  while (xmlSecEventReader.hasNext()) {
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
    if (xmlSecEvent.isStartElement() && xmlSecEvent.asStartElement().getName().equals(new QName("urn:example:po","PaymentInfo"))) {
      break;
    }
  }
  while (xmlSecEventReader.hasNext()) {
    transformIdentity.transform(xmlSecEvent);
    if (xmlSecEvent.isEndElement() && xmlSecEvent.asEndElement().getName().equals(new QName("urn:example:po","PaymentInfo"))) {
      break;
    }
    xmlSecEvent=(XMLSecEvent)xmlSecEventReader.nextEvent();
  }
  transformIdentity.doFinal();
  Assert.assertEquals(255,byteArrayOutputStream.size());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
