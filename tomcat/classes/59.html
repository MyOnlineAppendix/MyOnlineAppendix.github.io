<h3 style="margin:0px">Class: org.apache.catalina.filters.TestCorsFilter (82 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(38)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(35)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(31)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(18)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(11)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(7)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckNotCORSRequestTypeEmptyOrigin() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.INVALID_CORS,requestType);
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckPreFlightRequestType() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Content-Type");
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.PRE_FLIGHT,requestType);
}

</code></pre>

<pre class="type-13 type-3 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoFilterPreflightWithoutCredentialsAndSpecificOrigin() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Content-Type");
  request.setMethod("OPTIONS");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getFilterConfigSpecificOriginAndSupportsCredentialsDisabled());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertNull(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_CREDENTIALS));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.PRE_FLIGHT.name().toLowerCase(Locale.ENGLISH)));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_HEADERS).equals("Content-Type"));
}

</code></pre>

<pre class="type-13 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoFilterNullOriginAllowedByConfiguration() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setMethod("POST");
  request.setContentType("text/plain");
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"null");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getFilterConfigSpecificOriginNullAllowed());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.SIMPLE,requestType);
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
}

</code></pre>

<pre class="type-13 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoFilterNoOrigin() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setMethod("POST");
  request.setContentType("text/plain");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.NOT_CORS,requestType);
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertFalse(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckPreFlightRequestTypeEmptyHeaders() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"");
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.PRE_FLIGHT,requestType);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckForPortVariance() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://tomcat.apache.org:8080");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ServletException.class) public void testInitInvalidFilterConfig() throws ServletException {
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getFilterConfigInvalidMaxPreflightAge());
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckPreFlightRequestTypeUnsupportedRequestMethod() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"TRACE");
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testDecorateCORSPropertiesValidRequestNullRequestType(){
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  CorsFilter.decorateCORSProperties(request,null);
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckInvalidCRLF2() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://www.w3.org\r\n");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.INVALID_CORS,requestType);
}

</code></pre>

<pre class="type-13 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContentTypeWithParameter() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setMethod("POST");
  request.setContentType("text/plain;charset=UTF-8");
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"null");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.SIMPLE,requestType);
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
}

</code></pre>

<pre class="type-13 type-3 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckPreFlightRequestTypeAnyOriginNoWithCredentials() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Origin");
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getFilterConfigAnyOriginAndSupportsCredentialsDisabled());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals("*"));
  Assert.assertNull(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_CREDENTIALS));
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testInitDefaultFilterConfig() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setMethod("GET");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(new FilterConfig(){
    @Override public ServletContext getServletContext(){
      return null;
    }
    @Override public Enumeration<String> getInitParameterNames(){
      return null;
    }
    @Override public String getInitParameter(    String name){
      return null;
    }
    @Override public String getFilterName(){
      return null;
    }
  }
);
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals("https://www.apache.org"));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.SIMPLE.name().toLowerCase(Locale.ENGLISH)));
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithStringParserNull() throws ServletException {
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getNullFilterConfig());
  Assert.assertTrue(corsFilter.getAllowedHttpHeaders().size() == 6);
  Assert.assertTrue(corsFilter.getAllowedHttpMethods().size() == 4);
  Assert.assertTrue(corsFilter.getAllowedOrigins().size() == 0);
  Assert.assertTrue(corsFilter.isAnyOriginAllowed());
  Assert.assertTrue(corsFilter.getExposedHeaders().size() == 0);
  Assert.assertTrue(corsFilter.isSupportsCredentials());
  Assert.assertTrue(corsFilter.getPreflightMaxAge() == 1800);
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ServletException.class) public void testDoFilterRequestNullResponse() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.doFilter(request,null,filterChain);
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testInValidOriginCRLF(){
  Assert.assertFalse(CorsFilter.isValidOrigin("http://www.w3.org\r\n"));
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckInvalidOriginNotAllowedSubdomain() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://commons.apache.org");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testDecorateCORSPropertiesNullRequestNullCORSRequestType(){
  CorsFilter.decorateCORSProperties(null,null);
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoFilterSimpleAnyOriginAndSupportsCredentials() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setMethod("GET");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getFilterConfigAnyOriginAndSupportsCredentials());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_CREDENTIALS).equals("true"));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.SIMPLE.name().toLowerCase(Locale.ENGLISH)));
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoFilterSameHostWithOrigin02() throws IOException, ServletException {
  doTestDoFilterSameHostWithOrigin01("http://localhost:8080","https","localhost",8080,true);
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoFilterSimplePOST() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setContentType("text/plain");
  request.setMethod("POST");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals("https://www.apache.org"));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.SIMPLE.name().toLowerCase(Locale.ENGLISH)));
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoFilterSameHostWithOrigin06() throws IOException, ServletException {
  doTestDoFilterSameHostWithOrigin01("https://localhost","https","localhost",443,false);
}

</code></pre>

<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testJoinSingleElement(){
  Set<String> elements=new LinkedHashSet<>();
  String separator=",";
  elements.add("world");
  String join=CorsFilter.join(elements,separator);
  Assert.assertTrue("world".equals(join));
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckInvalidOrigin() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"www.example.com");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckNullRequestMethod() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://tomcat.apache.org");
  request.setMethod(null);
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.INVALID_CORS,requestType);
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoFilterSimpleWithExposedHeaders() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setMethod("POST");
  request.setContentType("text/plain");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getFilterConfigWithExposedHeaders());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals("https://www.apache.org"));
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_EXPOSE_HEADERS).equals(TesterFilterConfigs.EXPOSED_HEADERS));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.SIMPLE.name().toLowerCase(Locale.ENGLISH)));
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testInValidOriginEncodedCRLF1(){
  Assert.assertFalse(CorsFilter.isValidOrigin("http://www.w3.org%0d%0a"));
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckSimpleRequestType() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.SIMPLE,requestType);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoFilterSameHostWithOrigin03() throws IOException, ServletException {
  doTestDoFilterSameHostWithOrigin01("http://localhost:8080","http","localhost",8081,true);
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckForSchemeVariance() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"https://tomcat.apache.org");
  request.setMethod("POST");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.INVALID_CORS,requestType);
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckInvalidCRLF3() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://www.w3.org%0d%0a");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.INVALID_CORS,requestType);
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckPreFlightRequestTypeEmptyACRM() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"");
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.INVALID_CORS,requestType);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoFilterSameHostWithOrigin07() throws IOException, ServletException {
  doTestDoFilterSameHostWithOrigin01("http://localhost","http","localhost",80,false);
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotSimple() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Content-Type");
  request.setMethod("OPTIONS");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.handleSimpleCORS(request,response,filterChain);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckNullOriginNotAllowed() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"null");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testJoinOneNullElement(){
  Set<String> elements=new LinkedHashSet<>();
  String separator=",";
  elements.add(null);
  elements.add("peace");
  String join=CorsFilter.join(elements,separator);
  Assert.assertTrue(",peace".equals(join));
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithFilterConfig() throws ServletException {
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  Assert.assertTrue(corsFilter.getAllowedHttpHeaders().size() == 6);
  Assert.assertTrue(corsFilter.getAllowedHttpMethods().size() == 4);
  Assert.assertTrue(corsFilter.getAllowedOrigins().size() == 0);
  Assert.assertTrue(corsFilter.isAnyOriginAllowed());
  Assert.assertTrue(corsFilter.getExposedHeaders().size() == 0);
  Assert.assertTrue(corsFilter.isSupportsCredentials());
  Assert.assertTrue(corsFilter.getPreflightMaxAge() == 1800);
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testDecorateCORSPropertiesCORSRequestTypeNotCORS(){
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  CorsFilter.decorateCORSProperties(request,CorsFilter.CORSRequestType.NOT_CORS);
  Assert.assertFalse(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckPreFlightRequestTypeInvalidRequestMethod() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"POLITE");
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoFilterSimpleGET() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setMethod("GET");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals("https://www.apache.org"));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.SIMPLE.name().toLowerCase(Locale.ENGLISH)));
}

</code></pre>

<pre class="type-13 type-3 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoFilterPreflightNegativeMaxAge() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Content-Type");
  request.setMethod("OPTIONS");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfigNegativeMaxAge());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertNull(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_MAX_AGE));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.PRE_FLIGHT.name().toLowerCase(Locale.ENGLISH)));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_HEADERS).equals("Content-Type"));
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoFilterPreflightWithCredentials() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Content-Type");
  request.setMethod("OPTIONS");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSecureFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_CREDENTIALS).equals("true"));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.PRE_FLIGHT.name().toLowerCase(Locale.ENGLISH)));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_HEADERS).equals("Content-Type"));
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckPreFlightRequestTypeNoHeaders() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.PRE_FLIGHT,requestType);
}

</code></pre>

<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testJoinAllEmptyElements(){
  Set<String> elements=new LinkedHashSet<>();
  String separator=",";
  elements.add("");
  elements.add("");
  String join=CorsFilter.join(elements,separator);
  Assert.assertTrue("".equals(join));
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testDecorateCORSPropertiesCORSRequestTypeInvalidCORS(){
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  CorsFilter.decorateCORSProperties(request,CorsFilter.CORSRequestType.INVALID_CORS);
  Assert.assertNull(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST));
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testValidOrigin(){
  Assert.assertTrue(CorsFilter.isValidOrigin("http://www.w3.org"));
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ServletException.class) public void testDoFilterNullRequestNullResponse() throws IOException, ServletException {
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.doFilter(null,null,filterChain);
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testInValidOriginEncodedCRLF2(){
  Assert.assertFalse(CorsFilter.isValidOrigin("http://www.w3.org%0D%0A"));
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoFilterSameHostWithOrigin04() throws IOException, ServletException {
  doTestDoFilterSameHostWithOrigin01("http://localhost:8080","http","foo.dev.local",8080,true);
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckInvalidCRLF4() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://www.w3.org%0D%0A");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.INVALID_CORS,requestType);
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoFilterSimpleSpecificHeader() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setMethod("POST");
  request.setContentType("text/plain");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.SIMPLE.name().toLowerCase(Locale.ENGLISH)));
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoFilterSimpleHEAD() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setMethod("HEAD");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals("https://www.apache.org"));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.SIMPLE.name().toLowerCase(Locale.ENGLISH)));
}

</code></pre>

<pre class="type-13 type-3 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoFilterSimpleAnyOriginAndSupportsCredentialsDisabled() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setMethod("GET");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getFilterConfigAnyOriginAndSupportsCredentialsDisabled());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals(TesterFilterConfigs.ANY_ORIGIN));
  Assert.assertNull(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_CREDENTIALS));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.SIMPLE.name().toLowerCase(Locale.ENGLISH)));
}

</code></pre>

<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testJoinAllNullElements(){
  Set<String> elements=new LinkedHashSet<>();
  String separator=",";
  elements.add(null);
  elements.add(null);
  String join=CorsFilter.join(elements,separator);
  Assert.assertTrue("".equals(join));
}

</code></pre>

<pre class="type-13 type-3 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecorateRequestDisabled() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setMethod("GET");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getFilterConfigDecorateRequestDisabled());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals("https://www.apache.org"));
  Assert.assertNull(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST));
  Assert.assertNull(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN));
  Assert.assertNull(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_HEADERS));
  Assert.assertNull(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE));
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoFilterInvalidCORSOriginNotAllowed() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"www.google.com");
  request.setMethod("POST");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckPreFlightRequestTypeUnsupportedRequestHeaders() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"X-ANSWER");
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSecureFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testJoin(){
  Set<String> elements=new LinkedHashSet<>();
  String separator=",";
  elements.add("world");
  elements.add("peace");
  String join=CorsFilter.join(elements,separator);
  Assert.assertTrue("world,peace".equals(join));
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckInvalidRequestMethod() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://tomcat.apache.org");
  request.setMethod("PUT");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckPreFlightRequestTypeNoACRM() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.ACTUAL,requestType);
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckSimpleRequestTypeAnyOrigin() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://www.w3.org");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.SIMPLE,requestType);
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoFilterPreflightAnyOrigin() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Content-Type");
  request.setMethod("OPTIONS");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.PRE_FLIGHT.name().toLowerCase(Locale.ENGLISH)));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_HEADERS).equals("Content-Type"));
}

</code></pre>

<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testJoinPipeSeparator(){
  Set<String> elements=new LinkedHashSet<>();
  String separator="|";
  elements.add("world");
  elements.add("peace");
  String join=CorsFilter.join(elements,separator);
  Assert.assertTrue("world|peace".equals(join));
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testDecorateCORSPropertiesNullRequestValidCORSRequestType(){
  CorsFilter.decorateCORSProperties(null,CorsFilter.CORSRequestType.SIMPLE);
}

</code></pre>

<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testJoinElementsNull(){
  Set<String> elements=null;
  String separator=",";
  String join=CorsFilter.join(elements,separator);
  Assert.assertNull(join);
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckInvalidCRLF1() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://www.w3.org\r\n");
  request.setMethod("GET");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.INVALID_CORS,requestType);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoFilterPreflightInvalidOrigin() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"http://www.example.com");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Content-Type");
  request.setMethod("OPTIONS");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(response.getStatus(),HttpServletResponse.SC_FORBIDDEN);
}

</code></pre>

<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testJoinSepNull(){
  Set<String> elements=new LinkedHashSet<>();
  String separator=null;
  elements.add("world");
  elements.add("peace");
  String join=CorsFilter.join(elements,separator);
  Assert.assertTrue("world,peace".equals(join));
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testInValidOriginEncodedCRLF3(){
  Assert.assertFalse(CorsFilter.isValidOrigin("http://www.w3.org%0%0d%0ad%0%0d%0aa"));
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDoFilterPreflight() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_HEADERS,"Content-Type");
  request.setMethod("OPTIONS");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSpecificOriginFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(response.getHeader(CorsFilter.RESPONSE_HEADER_ACCESS_CONTROL_ALLOW_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_ORIGIN).equals(TesterFilterConfigs.HTTPS_WWW_APACHE_ORG));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_TYPE).equals(CorsFilter.CORSRequestType.PRE_FLIGHT.name().toLowerCase(Locale.ENGLISH)));
  Assert.assertTrue(request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_REQUEST_HEADERS).equals("Content-Type"));
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckActualRequestTypeMethodPOSTNotSimpleHeaders() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setMethod("POST");
  request.setContentType("application/json");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.ACTUAL,requestType);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoFilterSameHostWithOrigin01() throws IOException, ServletException {
  doTestDoFilterSameHostWithOrigin01("http://localhost:8080","http","localhost",8080,false);
}

</code></pre>

<pre class="type-13 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoFilterNullOriginAllowedByDefault() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setMethod("POST");
  request.setContentType("text/plain");
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"null");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.SIMPLE,requestType);
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertTrue(((Boolean)request.getAttribute(CorsFilter.HTTP_REQUEST_ATTRIBUTE_IS_CORS_REQUEST)).booleanValue());
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ServletException.class) public void testWithFilterConfigInvalidPreflightAge() throws ServletException {
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getFilterConfigInvalidMaxPreflightAge());
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ServletException.class) public void testDoFilterNullRequestResponse() throws IOException, ServletException {
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.doFilter(null,response,filterChain);
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotPreflight() throws IOException, ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTPS_WWW_APACHE_ORG);
  request.setMethod("GET");
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  corsFilter.handlePreflightCORS(request,response,filterChain);
}

</code></pre>

<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testCheckRequestTypeNull(){
  HttpServletRequest request=null;
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.checkRequestType(request);
}

</code></pre>

<pre class="type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWithStringParserEmpty() throws ServletException {
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getEmptyFilterConfig());
  Assert.assertTrue(corsFilter.getAllowedHttpHeaders().size() == 0);
  Assert.assertTrue(corsFilter.getAllowedHttpMethods().size() == 0);
  Assert.assertTrue(corsFilter.getAllowedOrigins().size() == 0);
  Assert.assertTrue(corsFilter.getExposedHeaders().size() == 0);
  Assert.assertFalse(corsFilter.isSupportsCredentials());
  Assert.assertTrue(corsFilter.getPreflightMaxAge() == 0);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckPreFlightRequestTypeOriginNotAllowed() throws ServletException, IOException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  TesterHttpServletResponse response=new TesterHttpServletResponse();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,"www.ebay.com");
  request.setHeader(CorsFilter.REQUEST_HEADER_ACCESS_CONTROL_REQUEST_METHOD,"PUT");
  request.setMethod("OPTIONS");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getSecureFilterConfig());
  corsFilter.doFilter(request,response,filterChain);
  Assert.assertEquals(HttpServletResponse.SC_FORBIDDEN,response.getStatus());
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoFilterSameHostWithOrigin05() throws IOException, ServletException {
  doTestDoFilterSameHostWithOrigin01("https://localhost:8443","https","localhost",8443,false);
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckActualRequestType() throws ServletException {
  TesterHttpServletRequest request=new TesterHttpServletRequest();
  request.setHeader(CorsFilter.REQUEST_HEADER_ORIGIN,TesterFilterConfigs.HTTP_TOMCAT_APACHE_ORG);
  request.setMethod("PUT");
  CorsFilter corsFilter=new CorsFilter();
  corsFilter.init(TesterFilterConfigs.getDefaultFilterConfig());
  CorsFilter.CORSRequestType requestType=corsFilter.checkRequestType(request);
  Assert.assertEquals(CorsFilter.CORSRequestType.ACTUAL,requestType);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
