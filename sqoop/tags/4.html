<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: com.cloudera.sqoop.TestAllTables </h4><pre class="type-2 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp(){
  super.setUp();
  if (useHsqldbTestServer()) {
    try {
      this.getTestServer().dropExistingSchema();
    }
 catch (    SQLException sqlE) {
      fail(sqlE.toString());
    }
  }
  this.tableNames=new ArrayList<String>();
  this.expectedStrings=new ArrayList<String>();
  this.expectedStrings.add("A winner");
  this.expectedStrings.add("is you!");
  this.expectedStrings.add(null);
  int i=0;
  for (  String expectedStr : this.expectedStrings) {
    String wrappedStr=null;
    if (expectedStr != null) {
      wrappedStr="'" + expectedStr + "'";
    }
    String[] types={"INT NOT NULL PRIMARY KEY","VARCHAR(32)"};
    String[] vals={Integer.toString(i++),wrappedStr};
    this.createTableWithColTypes(types,vals);
    this.tableNames.add(this.getTableName());
    this.removeTableDir();
    incrementTableNum();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: com.cloudera.sqoop.manager.OracleExportTest </h4><pre class="type-1 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown(){
  super.tearDown();
  if (null != this.conn) {
    try {
      this.conn.close();
    }
 catch (    SQLException sqlE) {
      LOG.error("Got SQLException closing conn: " + sqlE.toString());
    }
  }
  if (null != manager) {
    try {
      manager.close();
      manager=null;
    }
 catch (    SQLException sqlE) {
      LOG.error("Got SQLException: " + sqlE.toString());
      fail("Got SQLException: " + sqlE.toString());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: com.cloudera.sqoop.manager.TestSqlManager </h4><pre class="type-9 type-4 type-3 type-10 type-7 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadTable(){
  ResultSet results=null;
  try {
    results=manager.readTable(HsqldbTestServer.getTableName(),HsqldbTestServer.getFieldNames());
    assertNotNull("ResultSet from readTable() is null!",results);
    ResultSetMetaData metaData=results.getMetaData();
    assertNotNull("ResultSetMetadata is null in readTable()",metaData);
    assertEquals("Number of returned columns was unexpected!",metaData.getColumnCount(),HsqldbTestServer.getFieldNames().length);
    int sumCol1=0, sumCol2=0, rowCount=0;
    while (results.next()) {
      rowCount++;
      sumCol1+=results.getInt(1);
      sumCol2+=results.getInt(2);
    }
    assertEquals("Expected 4 rows back",EXPECTED_NUM_ROWS,rowCount);
    assertEquals("Expected left sum of 16",EXPECTED_COL1_SUM,sumCol1);
    assertEquals("Expected right sum of 20",EXPECTED_COL2_SUM,sumCol2);
  }
 catch (  SQLException sqlException) {
    fail("SQL Exception: " + sqlException.toString());
  }
 finally {
    if (null != results) {
      try {
        results.close();
      }
 catch (      SQLException sqlE) {
        fail("SQL Exception in ResultSet.close(): " + sqlE.toString());
      }
    }
    manager.release();
  }
}

</code></pre>

<br>
<pre class="type-4 type-3 type-10 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadMissingTable(){
  ResultSet results=null;
  try {
    String[] colNames={"*"};
    results=manager.readTable(MISSING_TABLE,colNames);
    assertNull("Expected null resultset from readTable(MISSING_TABLE)",results);
  }
 catch (  SQLException sqlException) {
  }
 finally {
    if (null != results) {
      try {
        results.close();
      }
 catch (      SQLException sqlE) {
        fail("SQL Exception in ResultSet.close(): " + sqlE.toString());
      }
    }
    manager.release();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: com.cloudera.sqoop.testutil.BaseSqoopTestCase </h4><pre class="type-2 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp(){
  setOnPhysicalCluster(!CommonArgs.LOCAL_FS.equals(System.getProperty(CommonArgs.FS_DEFAULT_NAME)));
  incrementTableNum();
  if (!isLog4jConfigured) {
    BasicConfigurator.configure();
    isLog4jConfigured=true;
    LOG.info("Configured log4j with console appender.");
  }
  if (useHsqldbTestServer()) {
    testServer=new HsqldbTestServer();
    try {
      testServer.resetServer();
    }
 catch (    SQLException sqlE) {
      LOG.error("Got SQLException: " + StringUtils.stringifyException(sqlE));
      fail("Got SQLException: " + StringUtils.stringifyException(sqlE));
    }
catch (    ClassNotFoundException cnfe) {
      LOG.error("Could not find class for db driver: " + StringUtils.stringifyException(cnfe));
      fail("Could not find class for db driver: " + StringUtils.stringifyException(cnfe));
    }
    manager=testServer.getManager();
  }
 else {
    Configuration conf=getConf();
    conf.set("oraoop.disabled","true");
    SqoopOptions opts=getSqoopOptions(conf);
    opts.setConnectString(getConnectString());
    opts.setTableName(getTableName());
    ConnFactory f=new ConnFactory(conf);
    try {
      this.manager=f.getManager(new JobData(opts,new ImportTool()));
    }
 catch (    IOException ioe) {
      fail("IOException instantiating manager: " + StringUtils.stringifyException(ioe));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: com.cloudera.sqoop.testutil.ExportJobTestCase </h4><pre class="type-2 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp(){
  super.setUp();
  if (useHsqldbTestServer()) {
    try {
      this.getTestServer().dropExistingSchema();
    }
 catch (    SQLException sqlE) {
      fail(sqlE.toString());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sqoop.TestAutoResetMapper </h4><pre class="type-2 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp(){
  super.setUp();
  if (useHsqldbTestServer()) {
    try {
      this.getTestServer().dropExistingSchema();
    }
 catch (    SQLException sqlE) {
      fail(sqlE.toString());
    }
  }
  this.tableNames=new ArrayList<String>();
  int numTables=types.length;
  this.expectedStrings=new String[numTables][];
  int numRows=2;
  for (int i=0; i < numTables; ++i) {
    expectedStrings[i]=new String[numRows];
    List<String> vals=new ArrayList<String>();
    for (int j=0; j < numRows; ++j) {
      String num=Integer.toString(j + 1);
      String str="Table " + Integer.toString(i + 1) + " Row "+ num;
      vals.add(num);
      vals.add("'" + str + "'");
      expectedStrings[i][j]=num + "," + str;
    }
    this.createTableWithColTypes(types[i],vals.toArray(new String[vals.size()]));
    this.tableNames.add(this.getTableName());
    this.removeTableDir();
    incrementTableNum();
  }
  ;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sqoop.manager.oracle.OracleConnectionFactoryTest </h4><pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExecuteOraOopSessionInitializationStatements(){
  OraOopLogFactory.OraOopLog2 oraoopLog=Exposer.LOG;
  oraoopLog.setCacheLogEntries(true);
  oraoopLog.clearCache();
  checkExecuteOraOopSessionInitializationStatements(null);
  checkLogContainsText(oraoopLog,"Initializing Oracle session with SQL : alter session disable " + "parallel query");
  checkLogContainsText(oraoopLog,"Initializing Oracle session with SQL : alter session set " + "\"_serial_direct_read\"=true");
  oraoopLog.clearCache();
  checkExecuteOraOopSessionInitializationStatements("");
  checkLogContainsText(oraoopLog,"No Oracle 'session initialization' statements were found to execute");
  checkExecuteOraOopSessionInitializationStatements(";");
  oraoopLog.clearCache();
  checkExecuteOraOopSessionInitializationStatements("loremipsum");
  checkLogContainsText(oraoopLog,"loremipsum");
  checkLogContainsText(oraoopLog,"ORA-00900: invalid SQL statement");
  Connection conn=getConnection();
  try {
    dropTable(conn,OracleUtils.SYSTEMTEST_TABLE_NAME);
    checkExecuteOraOopSessionInitializationStatements("create table " + OracleUtils.SYSTEMTEST_TABLE_NAME + " (col1 varchar2(1))");
    if (!doesTableExist(conn,OracleUtils.SYSTEMTEST_TABLE_NAME)) {
      Assert.fail("The session-initialization statement to create the table " + OracleUtils.SYSTEMTEST_TABLE_NAME + " did not work.");
    }
    dropTable(conn,OracleUtils.SYSTEMTEST_TABLE_NAME);
    checkExecuteOraOopSessionInitializationStatements("create table " + OracleUtils.SYSTEMTEST_TABLE_NAME + " (col1 number);insert into "+ OracleUtils.SYSTEMTEST_TABLE_NAME+ " values (1) ; --update "+ OracleUtils.SYSTEMTEST_TABLE_NAME+ " set col1 = col1 + 1; update "+ OracleUtils.SYSTEMTEST_TABLE_NAME+ " set col1 = col1 + 1; commit ;;");
    ResultSet resultSet=conn.createStatement().executeQuery("select col1 from " + OracleUtils.SYSTEMTEST_TABLE_NAME);
    resultSet.next();
    int actualValue=resultSet.getInt("col1");
    if (actualValue != 2) {
      Assert.fail("The table " + OracleUtils.SYSTEMTEST_TABLE_NAME + " does not contain the data we expected.");
    }
    dropTable(conn,OracleUtils.SYSTEMTEST_TABLE_NAME);
  }
 catch (  Exception ex) {
    Assert.fail(ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetSessionClientInfo(){
  Connection conn=getConnection();
  org.apache.hadoop.conf.Configuration conf=new Configuration();
  String moduleName=OraOopConstants.ORACLE_SESSION_MODULE_NAME;
  String actionName=(new SimpleDateFormat("yyyyMMddHHmmsszzz")).format(new Date());
  conf.set(OraOopConstants.ORACLE_SESSION_ACTION_NAME,actionName);
  try {
    PreparedStatement statement=conn.prepareStatement("select process, module, action " + "from v$session " + "where module = ? and action = ?");
    statement.setString(1,moduleName);
    statement.setString(2,actionName);
    ResultSet resultSet=statement.executeQuery();
    if (resultSet.next()) {
      Assert.fail("There should be no Oracle sessions with an action name of " + actionName);
    }
    OracleConnectionFactory.setSessionClientInfo(conn,conf);
    int sessionFoundCount=0;
    resultSet=statement.executeQuery();
    while (resultSet.next()) {
      sessionFoundCount++;
    }
    if (sessionFoundCount < 1) {
      Assert.fail("Unable to locate an Oracle session with the expected module " + "and action.");
    }
    if (sessionFoundCount > 1) {
      Assert.fail("Multiple sessions were found with the expected module and " + "action - we only expected to find one.");
    }
  }
 catch (  SQLException ex) {
    Assert.fail(ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-3 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateOracleJdbcConnectionOk(){
  try {
    Connection conn=getConnection();
    assertEquals("The connection to the Oracle database does not appear to be valid.",true,conn.isValid(15));
    ResultSet resultSet=conn.createStatement().executeQuery("select instance_name from v$instance");
    if (!resultSet.next() || resultSet.getString(1).isEmpty()) {
      Assert.fail("Got blank instance name from v$instance");
    }
  }
 catch (  SQLException ex) {
    Assert.fail(ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 type-8 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseOraOopSessionInitializationStatements(){
  List<String> statements=null;
  try {
    statements=OracleConnectionFactory.parseOraOopSessionInitializationStatements(null);
    Assert.fail("An IllegalArgumentException should have been thrown.");
  }
 catch (  IllegalArgumentException ex) {
  }
  org.apache.hadoop.conf.Configuration conf=new Configuration();
  statements=OracleConnectionFactory.parseOraOopSessionInitializationStatements(conf);
  Assert.assertTrue(statements.size() > 0);
  conf.set(OraOopConstants.ORAOOP_SESSION_INITIALIZATION_STATEMENTS,"");
  statements=OracleConnectionFactory.parseOraOopSessionInitializationStatements(conf);
  Assert.assertEquals(0,statements.size());
  conf.set(OraOopConstants.ORAOOP_SESSION_INITIALIZATION_STATEMENTS,";");
  statements=OracleConnectionFactory.parseOraOopSessionInitializationStatements(conf);
  Assert.assertEquals(0,statements.size());
  conf.set(OraOopConstants.ORAOOP_SESSION_INITIALIZATION_STATEMENTS,";--;\t--");
  statements=OracleConnectionFactory.parseOraOopSessionInitializationStatements(conf);
  Assert.assertEquals(0,statements.size());
  conf.set(OraOopConstants.ORAOOP_SESSION_INITIALIZATION_STATEMENTS,"\ta");
  statements=OracleConnectionFactory.parseOraOopSessionInitializationStatements(conf);
  Assert.assertEquals(1,statements.size());
  if (!statements.get(0).equalsIgnoreCase("a")) {
    Assert.fail("Expected a session initialization statement of \"a\"");
  }
  conf.set(OraOopConstants.ORAOOP_SESSION_INITIALIZATION_STATEMENTS,"a;b;--c;d;");
  statements=OracleConnectionFactory.parseOraOopSessionInitializationStatements(conf);
  Assert.assertEquals(3,statements.size());
  if (!statements.get(0).equalsIgnoreCase("a")) {
    Assert.fail("Expected a session initialization statement of \"a\"");
  }
  if (!statements.get(1).equalsIgnoreCase("b")) {
    Assert.fail("Expected a session initialization statement of \"b\"");
  }
  if (!statements.get(2).equalsIgnoreCase("d")) {
    Assert.fail("Expected a session initialization statement of \"d\"");
  }
  conf.set(OraOopConstants.ORAOOP_SESSION_INITIALIZATION_STATEMENTS,"set a={expr1};b={expr2}/{expr3};");
  conf.set("expr1","1");
  conf.set("expr2","2");
  conf.set("expr3","3");
  statements=OracleConnectionFactory.parseOraOopSessionInitializationStatements(conf);
  Assert.assertEquals(2,statements.size());
  String actual=statements.get(0);
  String expected="set a=1";
  if (!actual.equalsIgnoreCase(expected)) {
    Assert.fail(String.format("Expected a session initialization statement of \"%s\", but got \"%s\".",expected,actual));
  }
  actual=statements.get(1);
  expected="b=2/3";
  if (!actual.equalsIgnoreCase(expected)) {
    Assert.fail(String.format("Expected a session initialization statement of \"%s\", but got \"%s\".",expected,actual));
  }
  conf.set(OraOopConstants.ORAOOP_SESSION_INITIALIZATION_STATEMENTS,"set c={expr3|66};d={expr4|15}/{expr5|90};");
  conf.set("expr3","20");
  statements=OracleConnectionFactory.parseOraOopSessionInitializationStatements(conf);
  Assert.assertEquals(2,statements.size());
  actual=statements.get(0);
  expected="set c=20";
  if (!actual.equalsIgnoreCase(expected)) {
    Assert.fail(String.format("Expected a session initialization statement of \"%s\", but got \"%s\".",expected,actual));
  }
  actual=statements.get(1);
  expected="d=15/90";
  if (!actual.equalsIgnoreCase(expected)) {
    Assert.fail(String.format("Expected a session initialization statement of \"%s\", but got \"%s\".",expected,actual));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sqoop.manager.oracle.SystemImportTest </h4><pre class="type-12 type-9 type-4 type-8 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Generates pseudo-random test data across all supported data types in an
 * Oracle database. Imports the data into Hadoop and compares with the data in
 * Oracle.
 * @throws Exception
 */
@Test public void importTest() throws Exception {
  setSqoopTargetDirectory(getSqoopTargetDirectory() + OracleUtils.SYSTEMTEST_TABLE_NAME);
  int numRows=OracleUtils.SYSTEMTEST_NUM_ROWS;
  Connection conn=getTestEnvConnection();
  OraOopOracleQueries.setConnectionTimeZone(conn,"GMT");
  try {
    Statement s=conn.createStatement();
    try {
      s.executeUpdate("CREATE TABLE " + OracleUtils.SYSTEMTEST_TABLE_NAME + " (id NUMBER(10) PRIMARY KEY, bd BINARY_DOUBLE, bf BINARY_FLOAT, "+ "b BLOB, c CHAR(12), cl CLOB, d DATE, "+ "f FLOAT(126), l LONG, nc NCHAR(30), ncl NCLOB, n NUMBER(9,2), "+ "nvc NVARCHAR2(30), r ROWID, u URITYPE, iym INTERVAL YEAR(2) TO "+ "MONTH, ids INTERVAL DAY(2) TO SECOND(6), "+ "t TIMESTAMP(6), tz TIMESTAMP(6) WITH TIME ZONE, "+ "tltz TIMESTAMP(6) WITH LOCAL TIME ZONE, rawcol RAW(21))");
      BinaryDoubleGenerator bdg=new BinaryDoubleGenerator();
      BinaryFloatGenerator bfg=new BinaryFloatGenerator();
      BlobGenerator bg=new BlobGenerator(conn,2 * 1024,8 * 1024);
      CharGenerator cg=new CharGenerator(12,12);
      CharGenerator clobg=new CharGenerator(2 * 1024,8 * 1024);
      TimestampGenerator dateg=new TimestampGenerator(0);
      FloatGenerator fg=new FloatGenerator(126);
      CharGenerator lg=new CharGenerator(2 * 1024,8 * 1024);
      NCharGenerator ncg=new NCharGenerator(30,30);
      NCharGenerator nclobg=new NCharGenerator(2 * 1024,8 * 1024);
      BigDecimalGenerator ng=new BigDecimalGenerator(9,2);
      NCharGenerator nvcg=new NCharGenerator(1,30);
      RowIdGenerator rg=new RowIdGenerator();
      URIGenerator ug=new URIGenerator();
      IntervalYearMonthGenerator iymg=new IntervalYearMonthGenerator(2);
      IntervalDaySecondGenerator idsg=new IntervalDaySecondGenerator(2,6);
      TimestampGenerator tg=new TimestampGenerator(6);
      TimestampGenerator tzg=new TimestampGenerator(6);
      TimestampGenerator tltzg=new TimestampGenerator(6);
      BytesGenerator rawg=new BytesGenerator(21,21);
      PreparedStatement ps=conn.prepareStatement("INSERT INTO " + OracleUtils.SYSTEMTEST_TABLE_NAME + " ( id, bd, bf, b, c, cl, d, f, nc, ncl, n, nvc, r, u, iym, "+ "ids, t, tz, tltz, rawcol ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ?, "+ "?, ?, ?, ?, ?, sys.UriFactory.getUri(?), ?, ?, ?, ?, ?, ? )");
      try {
        for (int i=0; i < numRows; i++) {
          ps.setInt(1,i);
          methSetBinaryDouble.invoke(ps,2,bdg.next());
          methSetBinaryFloat.invoke(ps,3,bfg.next());
          ps.setBlob(4,bg.next());
          ps.setString(5,cg.next());
          ps.setString(6,clobg.next());
          ps.setTimestamp(7,dateg.next());
          ps.setBigDecimal(8,fg.next());
          ps.setString(9,ncg.next());
          ps.setString(10,nclobg.next());
          ps.setBigDecimal(11,ng.next());
          ps.setString(12,nvcg.next());
          ps.setRowId(13,rg.next());
          ps.setString(14,ug.next());
          ps.setString(15,iymg.next());
          ps.setString(16,idsg.next());
          ps.setTimestamp(17,tg.next());
          ps.setTimestamp(18,tzg.next());
          ps.setTimestamp(19,tltzg.next());
          ps.setBytes(20,rawg.next());
          ps.executeUpdate();
        }
      }
  finally {
        ps.close();
        conn.commit();
      }
      ps=conn.prepareStatement("UPDATE " + OracleUtils.SYSTEMTEST_TABLE_NAME + " SET l = ? WHERE id = ?");
      try {
        for (int i=0; i < numRows; i++) {
          ps.setString(1,lg.next());
          ps.setInt(2,i);
          ps.executeUpdate();
        }
      }
  finally {
        ps.close();
        conn.commit();
      }
      try {
        int retCode=runImport(OracleUtils.SYSTEMTEST_TABLE_NAME,getSqoopConf(),true);
        assertEquals("Return code should be 0",0,retCode);
        String sqoopGenJarPath="file://" + getSqoopGenLibDirectory() + "/"+ getSqoopGenClassName()+ ".jar";
        URLClassLoader loader=new URLClassLoader(new URL[]{new URL(sqoopGenJarPath)},getClass().getClassLoader());
        Thread.currentThread().setContextClassLoader(loader);
        Configuration hadoopConf=getSqoopConf();
        FileSystem hdfs=FileSystem.get(hadoopConf);
        Path path=new Path(getSqoopTargetDirectory());
        FileStatus[] statuses=hdfs.listStatus(path);
        int hadoopRecordCount=0;
        for (        FileStatus status : statuses) {
          if (status.getPath().getName().startsWith("part-m-")) {
            SequenceFile.Reader reader=new SequenceFile.Reader(hdfs,status.getPath(),hadoopConf);
            LongWritable key=new LongWritable();
            @SuppressWarnings("unchecked") SqoopRecord value=((Class<SqoopRecord>)reader.getValueClass()).getConstructor().newInstance();
            ps=conn.prepareStatement("SELECT bd, bf, b, c, cl, d, f, l, nc, " + "ncl, nvc, r, u, iym, ids, t, tz, tltz, rawcol FROM " + OracleUtils.SYSTEMTEST_TABLE_NAME + " WHERE id = ?");
            while (reader.next(key,value)) {
              Map<String,Object> fields=value.getFieldMap();
              BigDecimal id=(BigDecimal)fields.get("ID");
              ps.setBigDecimal(1,id);
              ResultSet rs=ps.executeQuery();
              assertTrue("Did not find row with id " + id + " in oracle",rs.next());
              assertEquals("BinaryDouble did not match for row " + id,fields.get("BD"),rs.getDouble(1));
              assertEquals("BinaryFloat did not match for row " + id,fields.get("BF"),rs.getFloat(2));
              assertEquals("Long did not match for row " + id,fields.get("L"),rs.getString(8));
              BlobRef hadoopBlob=(BlobRef)fields.get("B");
              Blob oraBlob=rs.getBlob(3);
              assertTrue("Blob did not match for row " + id,Arrays.equals(hadoopBlob.getData(),oraBlob.getBytes(1L,(int)oraBlob.length())));
              assertEquals("Char did not match for row " + id,fields.get("C"),rs.getString(4));
              ClobRef hadoopClob=(ClobRef)fields.get("CL");
              Clob oraClob=rs.getClob(5);
              assertEquals("Clob did not match for row " + id,hadoopClob.getData(),oraClob.getSubString(1,(int)oraClob.length()));
              assertEquals("Date did not match for row " + id,fields.get("D"),rs.getString(6));
              BigDecimal hadoopFloat=(BigDecimal)fields.get("F");
              BigDecimal oraFloat=rs.getBigDecimal(7);
              assertEquals("Float did not match for row " + id,hadoopFloat,oraFloat);
              assertEquals("NChar did not match for row " + id,fields.get("NC"),rs.getString(9));
              assertEquals("NClob did not match for row " + id,fields.get("NCL"),rs.getString(10));
              assertEquals("NVarChar did not match for row " + id,fields.get("NVC"),rs.getString(11));
              assertEquals("RowId did not match for row " + id,fields.get("R"),new String(rs.getRowId(12).getBytes()));
              Struct url=(Struct)rs.getObject(13);
              String urlString=(String)url.getAttributes()[0];
              if (url.getSQLTypeName().equals("SYS.HTTPURITYPE")) {
                urlString="http://" + urlString;
              }
 else               if (url.getSQLTypeName().equals("SYS.DBURITYPE")) {
                urlString="/ORADB" + urlString;
              }
              assertEquals("UriType did not match for row " + id,fields.get("U"),urlString);
              assertEquals("Interval Year to Month did not match for row " + id,fields.get("IYM"),rs.getString(14));
              String ids=(String)fields.get("IDS");
              int lastNonZero=ids.length() - 1;
              while (ids.charAt(lastNonZero) == '0') {
                lastNonZero--;
              }
              ids=ids.substring(0,lastNonZero + 1);
              assertEquals("Interval Day to Second did not match for row " + id,ids,rs.getString(15));
              assertEquals("Timestamp did not match for row " + id,fields.get("T"),rs.getString(16));
              assertEquals("Timestamp with Time Zone did not match for row " + id,fields.get("TZ"),rs.getString(17));
              assertEquals("Timestamp with Local Time Zone did not match for row " + id,fields.get("TLTZ"),rs.getString(18));
              BytesWritable rawCol=(BytesWritable)fields.get("RAWCOL");
              byte[] rawColData=Arrays.copyOf(rawCol.getBytes(),rawCol.getLength());
              assertTrue("RAW did not match for row " + id,Arrays.equals(rawColData,rs.getBytes(19)));
              assertFalse("Found multiple rows with id " + id + " in oracle",rs.next());
              hadoopRecordCount++;
            }
            reader.close();
          }
        }
        ResultSet rs=s.executeQuery("SELECT COUNT(*) FROM " + OracleUtils.SYSTEMTEST_TABLE_NAME);
        rs.next();
        int oracleRecordCount=rs.getInt(1);
        assertEquals("Number of records in Hadoop does not match number of " + "records in oracle",hadoopRecordCount,oracleRecordCount);
        rs.close();
      }
  finally {
        cleanupFolders();
      }
    }
  finally {
      s.executeUpdate("DROP TABLE " + OracleUtils.SYSTEMTEST_TABLE_NAME);
      s.close();
    }
  }
  finally {
    closeTestEnvConnection();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sqoop.manager.oracle.TestOraOopDataDrivenDBInputFormat </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@SuppressWarnings("unchecked") @Test public void testgroupTableDataChunksIntoSplits(){
  List<OraOopOracleDataChunk> dataChunks=new ArrayList<OraOopOracleDataChunk>();
  int startBlockNumber=1;
  for (int idx=0; idx < 241; idx++) {
    OraOopOracleDataChunk dataChunk=new OraOopOracleDataChunkExtent("23480",666,1,startBlockNumber,startBlockNumber + 8);
    startBlockNumber+=8;
    dataChunks.add(dataChunk);
  }
  @SuppressWarnings("rawtypes") Exposer e=new Exposer();
  boolean logIsBeingCached=Exposer.LOG.getCacheLogEntries();
  Exposer.LOG.setCacheLogEntries(true);
  List<InputSplit> splits=e.groupTableDataChunksIntoSplits(dataChunks,32,OraOopOracleBlockToSplitAllocationMethod.SEQUENTIAL);
  Exposer.LOG.setCacheLogEntries(logIsBeingCached);
  int highestNumberOfDataChunksAllocatedToASplit=0;
  int lowestNumberOfDataChunksAllocatedToASplit=Integer.MAX_VALUE;
  for (  InputSplit split : splits) {
    int dataChunksAllocatedToThisSplit=((OraOopDBInputSplit)split).getNumberOfDataChunks();
    highestNumberOfDataChunksAllocatedToASplit=Math.max(highestNumberOfDataChunksAllocatedToASplit,dataChunksAllocatedToThisSplit);
    lowestNumberOfDataChunksAllocatedToASplit=Math.min(lowestNumberOfDataChunksAllocatedToASplit,dataChunksAllocatedToThisSplit);
  }
  if (lowestNumberOfDataChunksAllocatedToASplit == 0) {
    Assert.fail("There is a split that has not had any " + "data-chunks allocated to it.");
  }
  double minExpectedWorkloadRatio=0.75;
  double actualWorkloadRatio=(double)lowestNumberOfDataChunksAllocatedToASplit / highestNumberOfDataChunksAllocatedToASplit;
  if (actualWorkloadRatio < minExpectedWorkloadRatio) {
    Assert.fail(String.format("There is too much difference in the amount of work assigned " + "to the 'smallest' split and the 'largest' split. " + "The split with the least work should have at least %s "+ "of the workload of the 'largest' split, but it actually "+ "only has %s of the workload of the 'largest' split.",minExpectedWorkloadRatio,actualWorkloadRatio));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sqoop.manager.oracle.TestOraOopUtilities </h4><pre class="type-9 type-4 type-3 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testgetOraOopOracleBlockToSplitAllocationMethod(){
  try {
    OraOopUtilities.getOraOopOracleBlockToSplitAllocationMethod(null,OraOopConstants.OraOopOracleBlockToSplitAllocationMethod.RANDOM);
    Assert.fail("An IllegalArgumentException should be been thrown.");
  }
 catch (  IllegalArgumentException ex) {
  }
  OraOopConstants.OraOopOracleBlockToSplitAllocationMethod allocationMethod;
  org.apache.hadoop.conf.Configuration conf=new Configuration();
  allocationMethod=OraOopUtilities.getOraOopOracleBlockToSplitAllocationMethod(conf,OraOopConstants.OraOopOracleBlockToSplitAllocationMethod.RANDOM);
  Assert.assertEquals(OraOopConstants.OraOopOracleBlockToSplitAllocationMethod.RANDOM,allocationMethod);
  allocationMethod=OraOopUtilities.getOraOopOracleBlockToSplitAllocationMethod(conf,OraOopConstants.OraOopOracleBlockToSplitAllocationMethod.SEQUENTIAL);
  Assert.assertEquals(OraOopConstants.OraOopOracleBlockToSplitAllocationMethod.SEQUENTIAL,allocationMethod);
  OraOopUtilities.LOG.setCacheLogEntries(true);
  OraOopUtilities.LOG.clearCache();
  conf.set(OraOopConstants.ORAOOP_ORACLE_BLOCK_TO_SPLIT_ALLOCATION_METHOD,"loremipsum");
  allocationMethod=OraOopUtilities.getOraOopOracleBlockToSplitAllocationMethod(conf,OraOopConstants.OraOopOracleBlockToSplitAllocationMethod.SEQUENTIAL);
  String logText=OraOopUtilities.LOG.getLogEntries();
  OraOopUtilities.LOG.setCacheLogEntries(false);
  if (!logText.toLowerCase().contains("loremipsum")) {
    Assert.fail("The LOG should inform the user they've selected an invalid " + "allocation method - and what that was.");
  }
  if (!logText.contains("ROUNDROBIN or SEQUENTIAL or RANDOM")) {
    Assert.fail("The LOG should inform the user what the valid choices are.");
  }
  conf.set(OraOopConstants.ORAOOP_ORACLE_BLOCK_TO_SPLIT_ALLOCATION_METHOD,"sequential");
  allocationMethod=OraOopUtilities.getOraOopOracleBlockToSplitAllocationMethod(conf,OraOopConstants.OraOopOracleBlockToSplitAllocationMethod.SEQUENTIAL);
  Assert.assertEquals(OraOopConstants.OraOopOracleBlockToSplitAllocationMethod.SEQUENTIAL,allocationMethod);
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testgetOraOopTableImportWhereClauseLocation(){
  try {
    OraOopUtilities.getOraOopTableImportWhereClauseLocation(null,OraOopConstants.OraOopTableImportWhereClauseLocation.SPLIT);
    Assert.fail("An IllegalArgumentException should be been thrown.");
  }
 catch (  IllegalArgumentException ex) {
  }
  OraOopConstants.OraOopTableImportWhereClauseLocation location;
  org.apache.hadoop.conf.Configuration conf=new Configuration();
  location=OraOopUtilities.getOraOopTableImportWhereClauseLocation(conf,OraOopConstants.OraOopTableImportWhereClauseLocation.SPLIT);
  Assert.assertEquals(OraOopConstants.OraOopTableImportWhereClauseLocation.SPLIT,location);
  OraOopUtilities.LOG.setCacheLogEntries(true);
  OraOopUtilities.LOG.clearCache();
  conf.set(OraOopConstants.ORAOOP_TABLE_IMPORT_WHERE_CLAUSE_LOCATION,"loremipsum");
  location=OraOopUtilities.getOraOopTableImportWhereClauseLocation(conf,OraOopConstants.OraOopTableImportWhereClauseLocation.SPLIT);
  String logText=OraOopUtilities.LOG.getLogEntries();
  OraOopUtilities.LOG.setCacheLogEntries(false);
  if (!logText.toLowerCase().contains("loremipsum")) {
    Assert.fail("The LOG should inform the user they've selected an invalid " + "where-clause-location - and what that was.");
  }
  if (!logText.contains("SUBSPLIT or SPLIT")) {
    Assert.fail("The LOG should inform the user what the valid choices are.");
  }
  conf.set(OraOopConstants.ORAOOP_TABLE_IMPORT_WHERE_CLAUSE_LOCATION,"split");
  location=OraOopUtilities.getOraOopTableImportWhereClauseLocation(conf,OraOopConstants.OraOopTableImportWhereClauseLocation.SUBSPLIT);
  Assert.assertEquals(OraOopConstants.OraOopTableImportWhereClauseLocation.SPLIT,location);
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testgetFullExceptionMessage(){
  try {
    try {
      try {
        throw new IOException("lorem ipsum!");
      }
 catch (      IOException ex) {
        throw new SQLException("dolor sit amet",ex);
      }
    }
 catch (    SQLException ex) {
      throw new RuntimeException("consectetur adipisicing elit",ex);
    }
  }
 catch (  Exception ex) {
    String msg=OraOopUtilities.getFullExceptionMessage(ex);
    if (!msg.contains("IOException") || !msg.contains("lorem ipsum!")) {
      Assert.fail("Inner exception text has not been included in the message");
    }
    if (!msg.contains("SQLException") || !msg.contains("dolor sit amet")) {
      Assert.fail("Inner exception text has not been included in the message");
    }
    if (!msg.contains("RuntimeException") || !msg.contains("consectetur adipisicing elit")) {
      Assert.fail("Outer exception text has not been included in the message");
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testStackContainsClass(){
  if (OraOopUtilities.stackContainsClass("lorem.ipsum.dolor")) {
    Assert.fail("There's no way the stack actually contains this!");
  }
  String expected="org.apache.sqoop.manager.oracle.TestOraOopUtilities";
  if (!OraOopUtilities.stackContainsClass(expected)) {
    Assert.fail("The stack should contain the class:" + expected);
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 type-10 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetOraOopOracleDataChunkMethod(){
  try {
    OraOopUtilities.getOraOopOracleDataChunkMethod(null);
    Assert.fail("An IllegalArgumentException should be been thrown.");
  }
 catch (  IllegalArgumentException ex) {
  }
  OraOopConstants.OraOopOracleDataChunkMethod dataChunkMethod;
  Configuration conf=new Configuration();
  dataChunkMethod=OraOopUtilities.getOraOopOracleDataChunkMethod(conf);
  Assert.assertEquals(OraOopConstants.OraOopOracleDataChunkMethod.ROWID,dataChunkMethod);
  OraOopUtilities.LOG.setCacheLogEntries(true);
  OraOopUtilities.LOG.clearCache();
  conf.set(OraOopConstants.ORAOOP_ORACLE_DATA_CHUNK_METHOD,"loremipsum");
  dataChunkMethod=OraOopUtilities.getOraOopOracleDataChunkMethod(conf);
  String logText=OraOopUtilities.LOG.getLogEntries();
  OraOopUtilities.LOG.setCacheLogEntries(false);
  if (!logText.toLowerCase().contains("loremipsum")) {
    Assert.fail("The LOG should inform the user they've selected an invalid " + "data chunk method - and what that was.");
  }
  Assert.assertEquals("Should have used the default value",OraOopConstants.ORAOOP_ORACLE_DATA_CHUNK_METHOD_DEFAULT,dataChunkMethod);
  conf.set(OraOopConstants.ORAOOP_ORACLE_DATA_CHUNK_METHOD,"partition");
  dataChunkMethod=OraOopUtilities.getOraOopOracleDataChunkMethod(conf);
  Assert.assertEquals(OraOopConstants.OraOopOracleDataChunkMethod.PARTITION,dataChunkMethod);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sqoop.manager.sqlserver.ManagerCompatExport </h4><pre class="type-2 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp(){
  super.setUp();
  String warehouseDir=getWarehouseDir();
  Path tablePath=new Path(warehouseDir);
  try {
    String testfile=System.getProperty("test.data.dir") + "/" + System.getProperty("ms.datatype.test.data.file.export");
    String delim=System.getProperty("ms.datatype.test.data.file.delim",",");
    tdfs=new MSSQLTestDataFileParser(testfile);
    tdfs.setDelim(delim);
    tdfs.parse();
  }
 catch (  Exception e) {
    LOG.error(StringUtils.stringifyException(e));
    System.out.println("Error with test data file;");
    System.out.println("check stack trace for cause.\nTests cannont continue.");
    System.exit(0);
  }
  try {
    FileSystem fs=FileSystem.get(new Configuration());
    fs.delete(tablePath,true);
    System.out.println("Warehouse dir deleted");
  }
 catch (  IOException e) {
    LOG.error("Setup fail with IOException: " + StringUtils.stringifyException(e));
  }
  if (useHsqldbTestServer()) {
    try {
      this.getTestServer().dropExistingSchema();
    }
 catch (    SQLException sqlE) {
      LOG.error("Setup fail with SQLException: " + StringUtils.stringifyException(sqlE));
      fail(sqlE.toString());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sqoop.manager.sqlserver.SQLServerManagerManualTest </h4><pre class="type-9 type-4 type-3 type-10 type-7 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadTable(){
  ResultSet results=null;
  try {
    results=manager.readTable(getTableName(),MSSQLTestUtils.getColumns());
    assertNotNull("ResultSet from readTable() is null!",results);
    ResultSetMetaData metaData=results.getMetaData();
    assertNotNull("ResultSetMetadata is null in readTable()",metaData);
    assertEquals("Number of returned columns was unexpected!",metaData.getColumnCount(),16);
    int sumCol1=0, sumCol2=0, rowCount=0;
    while (results.next()) {
      rowCount++;
      sumCol1+=results.getInt(1);
      sumCol2+=results.getInt(2);
    }
    assertEquals("Expected 4 rows back",EXPECTED_NUM_ROWS,rowCount);
    assertEquals("Expected left sum of 10",EXPECTED_COL1_SUM,sumCol1);
    assertEquals("Expected right sum of 14",EXPECTED_COL2_SUM,sumCol2);
  }
 catch (  SQLException sqlException) {
    LOG.error(StringUtils.stringifyException(sqlException));
    fail("SQL Exception: " + sqlException.toString());
  }
 finally {
    if (null != results) {
      try {
        results.close();
      }
 catch (      SQLException sqlE) {
        LOG.error(StringUtils.stringifyException(sqlE));
        fail("SQL Exception in ResultSet.close(): " + sqlE.toString());
      }
    }
    manager.release();
  }
}

</code></pre>

<br>
<pre class="type-4 type-10 type-7 type-11 type-15 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingTableColNames(){
  String[] colNames=manager.getColumnNames(MISSING_TABLE);
  if (colNames == null) {
    assertNull("No column names should be returned for missing table",colNames);
  }
  int numItems=colNames.length;
  assertEquals(0,numItems);
}

</code></pre>

<br>
<pre class="type-4 type-3 type-10 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadMissingTable(){
  ResultSet results=null;
  try {
    String[] colNames={"*"};
    results=manager.readTable(MISSING_TABLE,colNames);
    assertNull("Expected null resultset from readTable(MISSING_TABLE)",results);
  }
 catch (  SQLException sqlException) {
  }
 finally {
    if (null != results) {
      try {
        results.close();
      }
 catch (      SQLException sqlE) {
        fail("SQL Exception in ResultSet.close(): " + sqlE.toString());
      }
    }
    manager.release();
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
