<h3 style="margin:0px">Class: org.apache.giraph.TestBspBasic (13 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(11)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(10)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Invokes logging operations"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >Logger&nbsp;(1)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether two objects/variables are the same"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >IdentityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(1)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
/** 
 * Test whether vertices with NullWritable for vertex value type, edge value
 * type and message value type can be instantiated.
 */
@Test public void testInstantiateNullVertex() throws IOException {
  GiraphConfiguration nullConf=new GiraphConfiguration();
  nullConf.setComputationClass(NullComputation.class);
  ImmutableClassesGiraphConfiguration<NullWritable,NullWritable,NullWritable> immutableClassesGiraphConfiguration=new ImmutableClassesGiraphConfiguration<NullWritable,NullWritable,NullWritable>(nullConf);
  NullWritable vertexValue=immutableClassesGiraphConfiguration.createVertexValue();
  NullWritable edgeValue=immutableClassesGiraphConfiguration.createEdgeValue();
  Writable messageValue=immutableClassesGiraphConfiguration.createOutgoingMessageValueFactory().newInstance();
  assertSame(vertexValue.getClass(),NullWritable.class);
  assertSame(vertexValue,edgeValue);
  assertSame(edgeValue,messageValue);
}

</code></pre>

<pre class="type-3 type-4 type-5 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run a sample BSP job locally and test shortest paths.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testBspShortestPaths() throws IOException, InterruptedException, ClassNotFoundException {
  Path outputPath=getTempPath(getCallingMethodName());
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimpleShortestPathsComputation.class);
  conf.setVertexInputFormatClass(SimplePageRankVertexInputFormat.class);
  conf.setVertexOutputFormatClass(JsonLongDoubleFloatDoubleVertexOutputFormat.class);
  SimpleShortestPathsComputation.SOURCE_ID.set(conf,0);
  GiraphJob job=prepareJob(getCallingMethodName(),conf,outputPath);
  assertTrue(job.run(true));
  int numResults=getNumResults(job.getConfiguration(),outputPath);
  int expectedNumResults=runningInDistributedMode() ? 15 : 5;
  assertEquals(expectedNumResults,numResults);
}

</code></pre>

<pre class="type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Run a sample BSP job in JobTracker, kill a task, and make sure
 * the job fails (not enough attempts to restart)
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testBspFail() throws IOException, InterruptedException, ClassNotFoundException {
  if (!runningInDistributedMode()) {
    System.out.println("testBspFail: not executed for local setup.");
    return;
  }
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimpleFailComputation.class);
  conf.setVertexInputFormatClass(SimplePageRankVertexInputFormat.class);
  GiraphJob job=prepareJob(getCallingMethodName(),conf,getTempPath(getCallingMethodName()));
  job.getConfiguration().setInt("mapred.map.max.attempts",1);
  assertTrue(!job.run(true));
}

</code></pre>

<pre class="type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Run a sample BSP job locally and test messages.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testBspMsg() throws IOException, InterruptedException, ClassNotFoundException {
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimpleMsgComputation.class);
  conf.setVertexInputFormatClass(SimpleSuperstepVertexInputFormat.class);
  GiraphJob job=prepareJob(getCallingMethodName(),conf);
  assertTrue(job.run(true));
}

</code></pre>

<pre class="type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Run a sample BSP job locally with no vertices and make sure
 * it completes.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testEmptyVertexInputFormat() throws IOException, InterruptedException, ClassNotFoundException {
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimpleMsgComputation.class);
  conf.setVertexInputFormatClass(SimpleSuperstepVertexInputFormat.class);
  GiraphJob job=prepareJob(getCallingMethodName(),conf);
  GeneratedVertexReader.READER_VERTICES.set(job.getConfiguration(),0);
  assertTrue(job.run(true));
}

</code></pre>

<pre class="type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test halting at superstep 0
 */
@Test public void testHaltSuperstep0() throws IOException, InterruptedException, ClassNotFoundException {
  GiraphConfiguration conf=new GiraphConfiguration();
  GiraphConstants.MAX_NUMBER_OF_SUPERSTEPS.set(conf,0);
  conf.setComputationClass(SimpleMsgComputation.class);
  conf.setVertexInputFormatClass(SimpleSuperstepVertexInputFormat.class);
  GiraphJob job=prepareJob(getCallingMethodName(),conf);
  assertTrue(job.run(true));
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Do some checks for local job runner.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testLocalJobRunnerConfig() throws IOException, InterruptedException, ClassNotFoundException {
  if (runningInDistributedMode()) {
    System.out.println("testLocalJobRunnerConfig: Skipping for " + "non-local");
    return;
  }
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimpleSuperstepComputation.class);
  conf.setVertexInputFormatClass(SimpleSuperstepVertexInputFormat.class);
  GiraphJob job=prepareJob(getCallingMethodName(),conf);
  conf=job.getConfiguration();
  conf.setWorkerConfiguration(5,5,100.0f);
  GiraphConstants.SPLIT_MASTER_WORKER.set(conf,true);
  try {
    job.run(true);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  GiraphConstants.SPLIT_MASTER_WORKER.set(conf,false);
  try {
    job.run(true);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  conf.setWorkerConfiguration(1,1,100.0f);
  job.run(true);
}

</code></pre>

<pre class="type-3 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Run a sample BSP job locally with message combiner and
 * checkout output value.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testBspCombiner() throws IOException, InterruptedException, ClassNotFoundException {
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimpleCombinerComputation.class);
  conf.setVertexInputFormatClass(SimpleSuperstepVertexInputFormat.class);
  conf.setMessageCombinerClass(SimpleSumMessageCombiner.class);
  GiraphJob job=prepareJob(getCallingMethodName(),conf);
  assertTrue(job.run(true));
}

</code></pre>

<pre class="type-3 type-4 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Run a test to see if the InputSplitPathOrganizer can correctly sort
 * locality information from a mocked znode of data.
 * @throws IOException
 * @throws KeeperException
 * @throws InterruptedException
 */
@Test public void testInputSplitLocality() throws IOException, KeeperException, InterruptedException {
  List<byte[]> serializedSplits=new ArrayList<>();
  serializedSplits.add(new byte[]{1});
  serializedSplits.add(new byte[]{2});
  serializedSplits.add(new byte[]{3});
  WorkerInfo workerInfo=mock(WorkerInfo.class);
  when(workerInfo.getTaskId()).thenReturn(5);
  when(workerInfo.getHostname()).thenReturn("node.LOCAL.com");
  List<InputSplit> splits=new ArrayList<>();
  InputSplit split1=mock(InputSplit.class);
  when(split1.getLocations()).thenReturn(new String[]{"node.test1.com","node.test2.com","node.test3.com"});
  splits.add(split1);
  InputSplit split2=mock(InputSplit.class);
  when(split2.getLocations()).thenReturn(new String[]{"node.testx.com","node.LOCAL.com","node.testy.com"});
  splits.add(split2);
  InputSplit split3=mock(InputSplit.class);
  when(split3.getLocations()).thenReturn(new String[]{"node.test4.com","node.test5.com","node.test6.com"});
  splits.add(split3);
  LocalityAwareInputSplitsMasterOrganizer inputSplitOrganizer=new LocalityAwareInputSplitsMasterOrganizer(serializedSplits,splits,Lists.newArrayList(workerInfo));
  assertEquals(2,inputSplitOrganizer.getSerializedSplitFor(workerInfo.getTaskId())[0]);
}

</code></pre>

<pre class="type-10 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Just instantiate the vertex (all functions are implemented) and the
 * VertexInputFormat using reflection.
 * @throws IllegalAccessException
 * @throws InstantiationException
 * @throws InterruptedException
 * @throws IOException
 * @throws InvocationTargetException
 * @throws IllegalArgumentException
 * @throws NoSuchMethodException
 * @throws SecurityException
 */
@Test public void testInstantiateVertex() throws InstantiationException, IllegalAccessException, IOException, InterruptedException, IllegalArgumentException, InvocationTargetException, SecurityException, NoSuchMethodException {
  System.out.println("testInstantiateVertex: java.class.path=" + System.getProperty("java.class.path"));
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimpleSuperstepComputation.class);
  conf.setVertexInputFormatClass(SimpleSuperstepVertexInputFormat.class);
  GiraphJob job=prepareJob(getCallingMethodName(),conf);
  ImmutableClassesGiraphConfiguration configuration=new ImmutableClassesGiraphConfiguration(job.getConfiguration());
  Vertex<LongWritable,IntWritable,FloatWritable> vertex=configuration.createVertex();
  vertex.initialize(new LongWritable(1),new IntWritable(1));
  System.out.println("testInstantiateVertex: Got vertex " + vertex);
  VertexInputFormat<LongWritable,IntWritable,FloatWritable> inputFormat=configuration.createWrappedVertexInputFormat();
  List<InputSplit> splitArray=inputFormat.getSplits(HadoopUtils.makeJobContext(),1);
  ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  DataOutputStream outputStream=new DataOutputStream(byteArrayOutputStream);
  ((Writable)splitArray.get(0)).write(outputStream);
  System.out.println("testInstantiateVertex: Example output split = " + byteArrayOutputStream.toString());
}

</code></pre>

<pre class="type-3 type-12 type-4 type-5 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run a sample BSP job locally and test MasterCompute.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testBspMasterCompute() throws IOException, InterruptedException, ClassNotFoundException {
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimpleMasterComputeComputation.class);
  conf.setVertexInputFormatClass(SimplePageRankVertexInputFormat.class);
  conf.setMasterComputeClass(SimpleMasterComputeComputation.SimpleMasterCompute.class);
  conf.setWorkerContextClass(SimpleMasterComputeComputation.SimpleMasterComputeWorkerContext.class);
  GiraphJob job=prepareJob(getCallingMethodName(),conf);
  assertTrue(job.run(true));
  if (!runningInDistributedMode()) {
    double finalSum=SimpleMasterComputeComputation.SimpleMasterComputeWorkerContext.getFinalSum();
    System.out.println("testBspMasterCompute: finalSum=" + finalSum);
    assertEquals(32.5,finalSum,0d);
  }
}

</code></pre>

<pre class="type-3 type-12 type-4 type-5 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run a sample BSP job locally and test supersteps.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testBspSuperStep() throws IOException, InterruptedException, ClassNotFoundException {
  String callingMethod=getCallingMethodName();
  Path outputPath=getTempPath(callingMethod);
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimpleSuperstepComputation.class);
  conf.setVertexInputFormatClass(SimpleSuperstepVertexInputFormat.class);
  conf.setVertexOutputFormatClass(SimpleSuperstepVertexOutputFormat.class);
  GiraphJob job=prepareJob(callingMethod,conf,outputPath);
  Configuration configuration=job.getConfiguration();
  GeneratedVertexReader.READER_VERTICES.set(configuration,10);
  assertTrue(job.run(true));
  if (!runningInDistributedMode()) {
    FileStatus fileStatus=getSinglePartFileStatus(configuration,outputPath);
    assertEquals(49l,fileStatus.getLen());
  }
}

</code></pre>

<pre class="type-3 type-12 type-4 type-5 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run a sample BSP job locally and test PageRank with AggregatorWriter.
 * @throws IOException
 * @throws ClassNotFoundException
 * @throws InterruptedException
 */
@Test public void testBspPageRankWithAggregatorWriter() throws IOException, InterruptedException, ClassNotFoundException {
  Path outputPath=getTempPath(getCallingMethodName());
  GiraphConfiguration conf=new GiraphConfiguration();
  conf.setComputationClass(SimplePageRankComputation.class);
  conf.setAggregatorWriterClass(TextAggregatorWriter.class);
  conf.setMasterComputeClass(SimplePageRankComputation.SimplePageRankMasterCompute.class);
  conf.setVertexInputFormatClass(SimplePageRankVertexInputFormat.class);
  conf.setVertexOutputFormatClass(SimplePageRankComputation.SimplePageRankVertexOutputFormat.class);
  conf.setWorkerContextClass(SimplePageRankComputation.SimplePageRankWorkerContext.class);
  GiraphJob job=prepareJob(getCallingMethodName(),conf,outputPath);
  GiraphConfiguration configuration=job.getConfiguration();
  Path aggregatorValues=getTempPath("aggregatorValues");
  configuration.setInt(TextAggregatorWriter.FREQUENCY,TextAggregatorWriter.ALWAYS);
  configuration.set(TextAggregatorWriter.FILENAME,aggregatorValues.toString());
  assertTrue(job.run(true));
  FileSystem fs=FileSystem.get(configuration);
  Path valuesFile=new Path(aggregatorValues.toString() + "_0");
  try {
    if (!runningInDistributedMode()) {
      double maxPageRank=SimplePageRankComputation.SimplePageRankWorkerContext.getFinalMax();
      double minPageRank=SimplePageRankComputation.SimplePageRankWorkerContext.getFinalMin();
      long numVertices=SimplePageRankComputation.SimplePageRankWorkerContext.getFinalSum();
      System.out.println("testBspPageRank: maxPageRank=" + maxPageRank + " minPageRank="+ minPageRank+ " numVertices="+ numVertices);
      FSDataInputStream in=null;
      BufferedReader reader=null;
      try {
        Map<Integer,Double> minValues=Maps.newHashMap();
        Map<Integer,Double> maxValues=Maps.newHashMap();
        Map<Integer,Long> vertexCounts=Maps.newHashMap();
        in=fs.open(valuesFile);
        reader=new BufferedReader(new InputStreamReader(in,Charsets.UTF_8));
        String line;
        while ((line=reader.readLine()) != null) {
          String[] tokens=line.split("\t");
          int superstep=Integer.parseInt(tokens[0].split("=")[1]);
          String value=(tokens[1].split("=")[1]);
          String aggregatorName=(tokens[1].split("=")[0]);
          if ("min".equals(aggregatorName)) {
            minValues.put(superstep,Double.parseDouble(value));
          }
          if ("max".equals(aggregatorName)) {
            maxValues.put(superstep,Double.parseDouble(value));
          }
          if ("sum".equals(aggregatorName)) {
            vertexCounts.put(superstep,Long.parseLong(value));
          }
        }
        int maxSuperstep=SimplePageRankComputation.MAX_SUPERSTEPS;
        assertEquals(maxSuperstep + 2,minValues.size());
        assertEquals(maxSuperstep + 2,maxValues.size());
        assertEquals(maxSuperstep + 2,vertexCounts.size());
        assertEquals(maxPageRank,maxValues.get(maxSuperstep),0d);
        assertEquals(minPageRank,minValues.get(maxSuperstep),0d);
        assertEquals(numVertices,(long)vertexCounts.get(maxSuperstep));
      }
  finally {
        Closeables.close(in,true);
        Closeables.close(reader,true);
      }
    }
  }
  finally {
    fs.delete(valuesFile,false);
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
