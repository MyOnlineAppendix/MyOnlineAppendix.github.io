<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.whirr.ClusterSpecTest </h4><pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testRoleMayNotContainSpaces(){
  InstanceTemplate.builder().numberOfInstance(1).minNumberOfInstances(1).roles("a b").build();
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ConfigurationException.class) public void testBrokenPublicKey() throws IOException, JSchException, ConfigurationException {
  File privateKey=KeyPair.generateTemporaryFiles().get("private");
  File publicKey=File.createTempFile("public","key");
  publicKey.deleteOnExit();
  Files.write("ssh-rsa BROKEN PUBLIC KEY".getBytes(),publicKey);
  Configuration conf=new PropertiesConfiguration();
  conf.setProperty("whirr.private-key-file",privateKey.getAbsolutePath());
  conf.setProperty("whirr.public-key-file",publicKey.getAbsolutePath());
  ClusterSpec.withNoDefaults(conf);
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testMissingCommaInInstanceTemplates() throws Exception {
  Configuration conf=new PropertiesConfiguration();
  conf.setProperty(ClusterSpec.Property.INSTANCE_TEMPLATES.getConfigName(),"1 a+b 2 c+d");
  ClusterSpec.withTemporaryKeys(conf);
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ConfigurationException.class) public void testMissingPublicKey() throws JSchException, IOException, ConfigurationException {
  File privateKey=KeyPair.generateTemporaryFiles().get("private");
  Configuration conf=new PropertiesConfiguration();
  conf.setProperty("whirr.private-key-file",privateKey.getAbsolutePath());
  conf.setProperty("whirr.public-key-file","/dummy/path/that/does/not/exists");
  ClusterSpec.withNoDefaults(conf);
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testFailIfRunningAsRootOrClusterUserIsRoot() throws ConfigurationException {
  PropertiesConfiguration conf=new PropertiesConfiguration("whirr-core-test.properties");
  conf.setProperty("whirr.cluster-user","root");
  ClusterSpec.withNoDefaults(conf);
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ConfigurationException.class) public void testInstanceTemplateNotFoundForHardwareId() throws Exception {
  PropertiesConfiguration conf=new PropertiesConfiguration("whirr-core-test.properties");
  conf.setProperty("whirr.instance-templates","1 role1+role2");
  conf.setProperty("whirr.templates.role1.hardware-id","m1.large");
  ClusterSpec.withTemporaryKeys(conf);
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ConfigurationException.class) public void testNotSameKeyPair() throws JSchException, IOException, ConfigurationException {
  Map<String,File> first=KeyPair.generateTemporaryFiles();
  Map<String,File> second=KeyPair.generateTemporaryFiles();
  Configuration conf=new PropertiesConfiguration();
  conf.setProperty("whirr.private-key-file",first.get("private").getAbsolutePath());
  conf.setProperty("whirr.public-key-file",second.get("public").getAbsolutePath());
  ClusterSpec.withNoDefaults(conf);
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ConfigurationException.class) public void testMissingPrivateKey() throws ConfigurationException {
  Configuration conf=new PropertiesConfiguration();
  conf.setProperty("whirr.private-key-file","/dummy/path/that/does/not/exists");
  ClusterSpec.withNoDefaults(conf);
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ConfigurationException.class) public void testDummyPrivateKey() throws JSchException, IOException, ConfigurationException {
  File privateKeyFile=File.createTempFile("private","key");
  privateKeyFile.deleteOnExit();
  Files.write(("-----BEGIN RSA PRIVATE KEY-----\n" + "DUMMY FILE\n" + "-----END RSA PRIVATE KEY-----").getBytes(),privateKeyFile);
  Configuration conf=new PropertiesConfiguration();
  conf.setProperty("whirr.private-key-file",privateKeyFile.getAbsolutePath());
  ClusterSpec.withNoDefaults(conf);
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ConfigurationException.class) public void testEncryptedPrivateKey() throws JSchException, IOException, ConfigurationException {
  File privateKey=KeyPair.generateTemporaryFiles("dummy").get("private");
  Configuration conf=new PropertiesConfiguration();
  conf.setProperty("whirr.private-key-file",privateKey.getAbsolutePath());
  ClusterSpec.withNoDefaults(conf);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.actions.BootstrapClusterActionTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSubroleInvoked() throws Exception {
  CompositeConfiguration config=new CompositeConfiguration();
  if (System.getProperty("config") != null) {
    config.addConfiguration(new PropertiesConfiguration(System.getProperty("config")));
  }
  Configuration conf=new PropertiesConfiguration();
  conf.addProperty("whirr.service-name","test-service");
  conf.addProperty("whirr.cluster-name","test-cluster");
  conf.addProperty("whirr.instance-templates","1 puppet:module::manifest+something-else");
  conf.addProperty("whirr.provider","ec2");
  config.addConfiguration(conf);
  ClusterSpec clusterSpec=ClusterSpec.withTemporaryKeys(conf);
  Set<String> nn=new HashSet<String>();
  nn.add("puppet:module::manifest");
  nn.add("something-else");
  TestNodeStarterFactory nodeStarterFactory=null;
  ClusterActionHandlerFactory puppetHandlerFactory=mock(ClusterActionHandlerFactory.class);
  ClusterActionHandler handler=mock(ClusterActionHandler.class);
  when(puppetHandlerFactory.getRolePrefix()).thenReturn("puppet:");
  when(puppetHandlerFactory.create("module::manifest")).thenReturn(handler);
  when(handler.getRole()).thenReturn("something-else");
  LoadingCache<String,ClusterActionHandler> handlerMap=new HandlerMapFactory().create(ImmutableSet.of(puppetHandlerFactory),ImmutableSet.of(handler));
  Function<ClusterSpec,ComputeServiceContext> getCompute=mock(Function.class);
  ComputeServiceContext serviceContext=mock(ComputeServiceContext.class);
  ComputeService computeService=mock(ComputeService.class);
  TemplateBuilder templateBuilder=mock(TemplateBuilder.class);
  Template template=mock(Template.class);
  TemplateOptions templateOptions=mock(TemplateOptions.class);
  when(getCompute.apply(clusterSpec)).thenReturn(serviceContext);
  when(serviceContext.getComputeService()).thenReturn(computeService);
  when(computeService.getContext()).thenReturn(serviceContext);
  when(serviceContext.getBackendType()).thenReturn(TypeToken.class.cast(TypeToken.of(Context.class)));
  when(computeService.templateBuilder()).thenReturn(templateBuilder);
  when(templateBuilder.from((TemplateBuilderSpec)any())).thenReturn(templateBuilder);
  when(templateBuilder.options((TemplateOptions)any())).thenReturn(templateBuilder);
  when(templateBuilder.build()).thenReturn(template);
  when(template.getOptions()).thenReturn(templateOptions);
  Map<Set<String>,Stack<Integer>> reaction=Maps.newHashMap();
  Stack<Integer> nnStack=new Stack<Integer>();
  nnStack.push(new Integer(1));
  reaction.put(nn,nnStack);
  nodeStarterFactory=new TestNodeStarterFactory(reaction);
  BootstrapClusterAction bootstrapper=new BootstrapClusterAction(getCompute,handlerMap,nodeStarterFactory);
  bootstrapper.execute(clusterSpec,null);
  if (nodeStarterFactory != null) {
    nodeStarterFactory.validateCompletion();
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("unchecked") @Test(expected=IllegalArgumentException.class) public void testSubroleNotSupported() throws Exception {
  CompositeConfiguration config=new CompositeConfiguration();
  if (System.getProperty("config") != null) {
    config.addConfiguration(new PropertiesConfiguration(System.getProperty("config")));
  }
  Configuration conf=new PropertiesConfiguration();
  conf.addProperty("whirr.service-name","test-service");
  conf.addProperty("whirr.cluster-name","test-cluster");
  conf.addProperty("whirr.instance-templates","1 puppet:module::manifest+something-else");
  conf.addProperty("whirr.provider","ec2");
  config.addConfiguration(conf);
  ClusterSpec clusterSpec=ClusterSpec.withTemporaryKeys(conf);
  Set<String> nn=new HashSet<String>();
  nn.add("puppet:module::manifest");
  nn.add("something-else");
  TestNodeStarterFactory nodeStarterFactory=null;
  ClusterActionHandlerFactory puppetHandlerFactory=mock(ClusterActionHandlerFactory.class);
  ClusterActionHandler handler=mock(ClusterActionHandler.class);
  when(puppetHandlerFactory.getRolePrefix()).thenReturn("puppet");
  when(handler.getRole()).thenReturn("something-else");
  LoadingCache<String,ClusterActionHandler> handlerMap=new HandlerMapFactory().create(ImmutableSet.of(puppetHandlerFactory),ImmutableSet.of(handler));
  Function<ClusterSpec,ComputeServiceContext> getCompute=mock(Function.class);
  ComputeServiceContext serviceContext=mock(ComputeServiceContext.class);
  ComputeService computeService=mock(ComputeService.class);
  TemplateBuilder templateBuilder=mock(TemplateBuilder.class);
  Template template=mock(Template.class);
  when(getCompute.apply(clusterSpec)).thenReturn(serviceContext);
  when(serviceContext.getComputeService()).thenReturn(computeService);
  when(computeService.templateBuilder()).thenReturn(templateBuilder);
  when(templateBuilder.from((TemplateBuilderSpec)any())).thenReturn(templateBuilder);
  when(templateBuilder.options((TemplateOptions)any())).thenReturn(templateBuilder);
  when(templateBuilder.build()).thenReturn(template);
  Map<Set<String>,Stack<Integer>> reaction=Maps.newHashMap();
  Stack<Integer> nnStack=new Stack<Integer>();
  nnStack.push(1);
  reaction.put(nn,nnStack);
  nodeStarterFactory=new TestNodeStarterFactory(reaction);
  BootstrapClusterAction bootstrapper=new BootstrapClusterAction(getCompute,handlerMap,nodeStarterFactory);
  bootstrapper.execute(clusterSpec,null);
  if (nodeStarterFactory != null) {
    nodeStarterFactory.validateCompletion();
  }
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("unchecked") @Test public void testDoActionRetriesSucceed() throws Exception {
  CompositeConfiguration config=new CompositeConfiguration();
  if (System.getProperty("config") != null) {
    config.addConfiguration(new PropertiesConfiguration(System.getProperty("config")));
  }
  Configuration conf=new PropertiesConfiguration();
  conf.addProperty("whirr.service-name","test-service");
  conf.addProperty("whirr.cluster-name","test-cluster");
  conf.addProperty("whirr.instance-templates","1 hadoop-namenode+hadoop-jobtracker,4 hadoop-datanode+hadoop-tasktracker");
  conf.addProperty("whirr.instance-templates-max-percent-failures","60 hadoop-datanode+hadoop-tasktracker");
  conf.addProperty("whirr.provider","ec2");
  config.addConfiguration(conf);
  ClusterSpec clusterSpec=ClusterSpec.withTemporaryKeys(conf);
  Set<String> jtnn=new HashSet<String>();
  jtnn.add("hadoop-jobtracker");
  jtnn.add("hadoop-namenode");
  Set<String> dntt=new HashSet<String>();
  dntt.add("hadoop-datanode");
  dntt.add("hadoop-tasktracker");
  TestNodeStarterFactory nodeStarterFactory=null;
  ClusterActionHandler handler=mock(ClusterActionHandler.class);
  LoadingCache<String,ClusterActionHandler> handlerMap=convertMapToLoadingCache(ImmutableMap.<String,ClusterActionHandler>builder().put("hadoop-jobtracker",handler).put("hadoop-namenode",handler).put("hadoop-datanode",handler).put("hadoop-tasktracker",handler).build());
  Function<ClusterSpec,ComputeServiceContext> getCompute=mock(Function.class);
  ComputeServiceContext serviceContext=mock(ComputeServiceContext.class);
  ComputeService computeService=mock(ComputeService.class);
  TemplateBuilder templateBuilder=mock(TemplateBuilder.class);
  Template template=mock(Template.class);
  TemplateOptions templateOptions=mock(TemplateOptions.class);
  when(getCompute.apply(clusterSpec)).thenReturn(serviceContext);
  when(serviceContext.getComputeService()).thenReturn(computeService);
  when(computeService.getContext()).thenReturn(serviceContext);
  when(serviceContext.getBackendType()).thenReturn(TypeToken.class.cast(TypeToken.of(Context.class)));
  when(computeService.templateBuilder()).thenReturn(templateBuilder);
  when(templateBuilder.from((TemplateBuilderSpec)any())).thenReturn(templateBuilder);
  when(templateBuilder.options((TemplateOptions)any())).thenReturn(templateBuilder);
  when(templateBuilder.build()).thenReturn(template);
  when(template.getOptions()).thenReturn(templateOptions);
  Map<Set<String>,Stack<Integer>> reaction=Maps.newHashMap();
  Stack<Integer> jtnnStack=new Stack<Integer>();
  jtnnStack.push(1);
  jtnnStack.push(0);
  reaction.put(jtnn,jtnnStack);
  Stack<Integer> ddttStack=new Stack<Integer>();
  ddttStack.push(3);
  reaction.put(dntt,ddttStack);
  nodeStarterFactory=new TestNodeStarterFactory(reaction);
  BootstrapClusterAction bootstrapper=new BootstrapClusterAction(getCompute,handlerMap,nodeStarterFactory);
  bootstrapper.execute(clusterSpec,null);
  if (nodeStarterFactory != null) {
    nodeStarterFactory.validateCompletion();
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("unchecked") @Test(expected=IOException.class) public void testDoActionRetriesExceeds() throws Exception {
  CompositeConfiguration config=new CompositeConfiguration();
  if (System.getProperty("config") != null) {
    config.addConfiguration(new PropertiesConfiguration(System.getProperty("config")));
  }
  Configuration conf=new PropertiesConfiguration();
  conf.addProperty("whirr.service-name","test-service");
  conf.addProperty("whirr.cluster-name","test-cluster");
  conf.addProperty("whirr.instance-templates","1 hadoop-namenode+hadoop-jobtracker,4 hadoop-datanode+hadoop-tasktracker");
  conf.addProperty("whirr.instance-templates-max-percent-failures","60 hadoop-datanode+hadoop-tasktracker");
  conf.addProperty("whirr.provider","ec2");
  config.addConfiguration(conf);
  ClusterSpec clusterSpec=ClusterSpec.withTemporaryKeys(conf);
  Set<String> jtnn=new HashSet<String>();
  jtnn.add("hadoop-jobtracker");
  jtnn.add("hadoop-namenode");
  Set<String> dntt=new HashSet<String>();
  dntt.add("hadoop-datanode");
  dntt.add("hadoop-tasktracker");
  TestNodeStarterFactory nodeStarterFactory=null;
  ClusterActionHandler handler=mock(ClusterActionHandler.class);
  LoadingCache<String,ClusterActionHandler> handlerMap=convertMapToLoadingCache(ImmutableMap.<String,ClusterActionHandler>builder().put("hadoop-jobtracker",handler).put("hadoop-namenode",handler).put("hadoop-datanode",handler).put("hadoop-tasktracker",handler).build());
  Function<ClusterSpec,ComputeServiceContext> getCompute=mock(Function.class);
  ComputeServiceContext serviceContext=mock(ComputeServiceContext.class);
  ComputeService computeService=mock(ComputeService.class);
  TemplateBuilder templateBuilder=mock(TemplateBuilder.class);
  Template template=mock(Template.class);
  TemplateOptions templateOptions=mock(TemplateOptions.class);
  when(getCompute.apply(clusterSpec)).thenReturn(serviceContext);
  when(serviceContext.getComputeService()).thenReturn(computeService);
  when(computeService.getContext()).thenReturn(serviceContext);
  when(serviceContext.getBackendType()).thenReturn(TypeToken.class.cast(TypeToken.of(Context.class)));
  when(computeService.templateBuilder()).thenReturn(templateBuilder);
  when(templateBuilder.from((TemplateBuilderSpec)any())).thenReturn(templateBuilder);
  when(templateBuilder.options((TemplateOptions)any())).thenReturn(templateBuilder);
  when(templateBuilder.build()).thenReturn(template);
  when(template.getOptions()).thenReturn(templateOptions);
  Map<Set<String>,Stack<Integer>> reaction=Maps.newHashMap();
  Stack<Integer> jtnnStack=new Stack<Integer>();
  jtnnStack.push(new Integer(1));
  reaction.put(jtnn,jtnnStack);
  Stack<Integer> ddttStack=new Stack<Integer>();
  ddttStack.push(new Integer(1));
  ddttStack.push(new Integer(1));
  reaction.put(dntt,ddttStack);
  nodeStarterFactory=new TestNodeStarterFactory(reaction);
  BootstrapClusterAction bootstrapper=new BootstrapClusterAction(getCompute,handlerMap,nodeStarterFactory);
  bootstrapper.execute(clusterSpec,null);
  if (nodeStarterFactory != null) {
    nodeStarterFactory.validateCompletion();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.actions.ScriptBasedClusterActionTest </h4><pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testEmptyInstanceTemplates() throws Exception {
  T action=newClusterActionInstance(EMPTYSET,EMPTYSET);
  DryRun dryRun=getDryRunForAction(action).reset();
  ClusterSpec tempSpec=ClusterSpec.withTemporaryKeys();
  tempSpec.setClusterName("test-cluster-for-script-exection");
  tempSpec.setProvider("stub");
  tempSpec.setIdentity("dummy");
  tempSpec.setStateStore("none");
  ClusterController controller=new ClusterController();
  Cluster tempCluster=controller.launchCluster(tempSpec);
  action.execute(tempSpec,tempCluster);
  List<StatementOnNode> executions=dryRun.getTotallyOrderedExecutions();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.cli.MainTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommand() throws Exception {
  Command command=mock(Command.class);
  when(command.getName()).thenReturn("mock-command");
  Main main=new Main(command);
  main.run(null,null,null,Lists.newArrayList("mock-command","arg1","arg2"));
  verify(command).run(null,null,null,Lists.newArrayList("arg1","arg2"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.command.AbstractClusterCommandTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Ensure that an invalid service name uses the default (after logging a
 * warning).
 */
@Test public void testCreateServerWithInvalidClusterControllerName() throws Exception {
  AbstractClusterCommand clusterCommand=new AbstractClusterCommand("name","description",new ClusterControllerFactory()){
    @Override public int run(    InputStream in,    PrintStream out,    PrintStream err,    List<String> args) throws Exception {
      return 0;
    }
  }
;
  clusterCommand.createClusterController("bar");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.compute.BootstrapTemplateTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOverrideSpotPrice() throws Exception {
  ClusterSpec clusterSpec=buildClusterSpecWith(ImmutableMap.of("whirr.instance-templates","1 role1","whirr.aws-ec2-spot-price","0.1","whirr.templates.role1.aws-ec2-spot-price","0.3"));
  assertSpotPriceIs(clusterSpec,"role1",0.3f);
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDifferentPrices() throws Exception {
  ClusterSpec clusterSpec=buildClusterSpecWith(ImmutableMap.of("whirr.instance-templates","1 role1, 1 role2","whirr.aws-ec2-spot-price","0.1","whirr.templates.role2.aws-ec2-spot-price","0.3"));
  assertSpotPriceIs(clusterSpec,"role1",0.1f);
  assertSpotPriceIs(clusterSpec,"role2",0.3f);
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetGlobalSpotPrice() throws Exception {
  ClusterSpec clusterSpec=buildClusterSpecWith(ImmutableMap.of("whirr.instance-templates","1 role1","whirr.aws-ec2-spot-price","0.3"));
  assertSpotPriceIs(clusterSpec,"role1",0.3f);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.karaf.itest.WhirrServicesTest </h4><pre class="type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testServices() throws InterruptedException {
  executeCommand("features:install whirr-cassandra");
  executeCommand("features:install whirr-chef");
  executeCommand("features:install whirr-elasticsearch");
  executeCommand("features:install whirr-ganglia");
  executeCommand("features:install whirr-hadoop");
  executeCommand("features:install whirr-hama");
  executeCommand("features:install whirr-hbase");
  executeCommand("features:install whirr-puppet");
  executeCommand("features:install whirr-pig");
  executeCommand("features:install whirr-mahout");
  executeCommand("features:install whirr-yarn");
  executeCommand("features:install whirr-zookeeper");
  System.err.println(executeCommand("osgi:list"));
  getOsgiService("org.apache.whirr.ClusterController","(name=default)",SERVICE_TIMEOUT);
  testService("cassandra");
  testService("chef");
  testService("elasticsearch");
  testService("ganglia-monitor","ganglia-metad");
  testService("hadoop-namenode","hadoop-datanode","hadoop-jobtracker","hadoop-tasktracker");
  testService("hama-master","hama-groomserver");
  testService("hbase-master","hbase-regionserver","hbase-restserver","hbase-avroserver","hbase-thriftserver");
  testService("puppet-install");
  testService("pig-client");
  testService("mahout-client");
  testService("yarn-nodemanager","yarn-resourcemanager");
  testService("zookeeper");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.karaf.itest.integration.WhirrKarafZookeeperServiceTest </h4><pre class="type-13 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLive() throws IOException, ConfigurationException {
  if (isLiveConfigured()) {
    loadConfiguration("whirr-zookeeper-test.properties",ZOOKEEPER_RECIPE_PID);
    System.err.println(executeCommands("config:edit " + ZOOKEEPER_RECIPE_PID,"config:proplist","config:cancel"));
    System.err.println(executeCommand("whirr:launch-cluster --pid " + ZOOKEEPER_RECIPE_PID,20 * 60 * 1000L,false));
  }
 else {
    System.err.println("Live test not properly configured, please add whirr.test.provider, " + "whirr.test.identity & whirr.test.credential as system properties.\n" + "Also note that currently only aws-ec2, clouservers-us, cloudservers-uk are the supported providers "+ "for this integration test.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.BaseServiceDryRunTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that a simple cluster is correctly loaded and executed.
 */
@Test public void testBootstrapAndConfigure() throws Exception {
  ClusterSpec cookbookWithDefaultRecipe=newClusterSpecForProperties(ImmutableMap.of("whirr.instance-templates","1 " + Joiner.on("+").join(getInstanceRoles())));
  DryRun dryRun=launchWithClusterSpec(cookbookWithDefaultRecipe);
  assertScriptPredicateOnPhase(dryRun,"bootstrap",bootstrapPredicate());
  assertScriptPredicateOnPhase(dryRun,"configure",configurePredicate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.cdh.integration.Cdh3HadoopServiceTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testVersion() throws Exception {
  Statement checkVersion=Statements.exec("ls /etc/alternatives/hadoop-lib");
  Map<? extends NodeMetadata,ExecResponse> responses=controller.runScriptOnNodesMatching(clusterSpec,ALL,checkVersion);
  printResponses(checkVersion,responses);
  assertResponsesContain(responses,checkVersion,"cdh3");
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJobExecution() throws Exception {
  Configuration conf=getConfiguration();
  JobConf job=new JobConf(conf,Cdh3HadoopServiceTest.class);
  JobClient client=new JobClient(job);
  waitForTaskTrackers(client);
  checkHadoop(conf,client,job);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.cdh.integration.CdhHadoopServiceTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testVersion() throws Exception {
  Statement checkVersion=Statements.exec("cat /usr/lib/hadoop/cloudera/cdh_version.properties");
  Map<? extends NodeMetadata,ExecResponse> responses=controller.runScriptOnNodesMatching(clusterSpec,ALL,checkVersion);
  printResponses(checkVersion,responses);
  assertResponsesContain(responses,checkVersion,"cdh4");
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testJobExecution() throws Exception {
  Configuration conf=getConfiguration();
  JobConf job=new JobConf(conf,CdhHadoopServiceTest.class);
  JobClient client=new JobClient(job);
  waitForTaskTrackers(client);
  checkHadoop(conf,client,job);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.chef.ChefServiceDryRunTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that a simple recipe (the default recipe in a cookbook without any
 * configuration parameters) is correctly loaded and executed.
 */
@Test public void testChefWithParticularRecipe() throws Exception {
  ClusterSpec cookbookWithAttributes=newClusterSpecForProperties(ImmutableMap.<String,String>builder().put("whirr.instance-templates","1 chef:java").put("java.url","http://testurl").put("java.version","1.5").put("java.flavor","vanilla").build());
  DryRun dryRun=launchWithClusterSpec(cookbookWithAttributes);
  assertScriptPredicateOnPhase(dryRun,"bootstrap",bootstrapPredicate());
  assertScriptPredicateOnPhase(dryRun,"configure",contains(compile("{\"java\":{\"version\":\"1.5\",\"flavor\":\"vanilla\"}",LITERAL)));
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that a simple recipe (the default recipe in a cookbook without any
 * configuration parameters) is correctly loaded and executed.
 */
@Test public void testChefWithAttributes() throws Exception {
  ClusterSpec cookbookWithSpecificRecipe=newClusterSpecForProperties(ImmutableMap.of("whirr.instance-templates","1 chef:java:sun"));
  DryRun dryRun=launchWithClusterSpec(cookbookWithSpecificRecipe);
  assertScriptPredicateOnPhase(dryRun,"bootstrap",bootstrapPredicate());
  assertScriptPredicateOnPhase(dryRun,"configure",containsPattern("chef-solo -j /tmp/java::sun"));
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that a simple recipe (the default recipe in a cookbook without any
 * configuration parameters) is correctly loaded and executed.
 */
@Test public void testChefOnly() throws Exception {
  ClusterSpec chefOnly=newClusterSpecForProperties(ImmutableMap.of("whirr.instance-templates","1 chef"));
  DryRun dryRun=launchWithClusterSpec(chefOnly);
  assertScriptPredicateOnPhase(dryRun,"bootstrap",bootstrapPredicate());
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that a simple recipe (the default recipe in a cookbook without any
 * configuration parameters) is correctly loaded and executed.
 */
@Test public void testChefWithDefaultRecipe() throws Exception {
  ClusterSpec cookbookWithDefaultRecipe=newClusterSpecForProperties(ImmutableMap.of("whirr.instance-templates","1 chef:java"));
  DryRun dryRun=launchWithClusterSpec(cookbookWithDefaultRecipe);
  assertScriptPredicateOnPhase(dryRun,"bootstrap",bootstrapPredicate());
  assertScriptPredicateOnPhase(dryRun,"configure",containsPattern("chef-solo -j /tmp/java::default"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.chef.integration.ChefServiceTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testRecipesWereRanInServiceBootstrap() throws Exception {
  Statement testAnt=Statements.exec("ant -version");
  Map<? extends NodeMetadata,ExecResponse> responses=controller.runScriptOnNodesMatching(clusterSpec,allNodes,testAnt);
  printResponses(testAnt,responses);
  assertResponsesContain(responses,testAnt,"Apache Ant");
  Statement testMaven=Statements.exec("mvn --version");
  responses=controller.runScriptOnNodesMatching(clusterSpec,allNodes,testMaven);
  printResponses(testMaven,responses);
  assertResponsesContain(responses,testMaven,"Apache Maven");
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the execution of recipes (one with attribs and one with non-default
 * recipe) from the provided recipes dowloaded from opscode's git repo.
 * @throws Exception
 */
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testChefRunRecipesFromProvidedCookbooks() throws Exception {
  Recipe java=new Recipe("java");
  java.attribs.put("install_flavor","openjdk");
  Map<? extends NodeMetadata,ExecResponse> responses=runRecipe(java);
  printResponses(java,responses);
  Statement stmt=Statements.exec("java -version");
  responses=controller.runScriptOnNodesMatching(clusterSpec,allNodes,stmt);
  assertResponsesContain(responses,stmt,"Runtime Environment");
  Recipe postgreSql=new Recipe("postgresql","server");
  responses=runRecipe(postgreSql);
  printResponses(postgreSql,responses);
  stmt=Statements.exec("psql --version");
  responses=controller.runScriptOnNodesMatching(clusterSpec,allNodes,stmt);
  assertResponsesContain(responses,stmt,"PostgreSQL");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.druid.integration.DruidServiceTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testSegmentMetadata(){
  try {
    String response=getQueryInfo();
    return;
  }
 catch (  Exception e) {
    LOG.debug("Caught exception contacting cluster");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.elasticsearch.integration.ElasticSearchTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testCheckNumberOfNodes() throws Exception {
  for (int i=0; i < 20; i++) {
    int nodes=getNumberOfNodes();
    LOG.info("{}/{} nodes joined the elasticsearch cluster",nodes,cluster.getInstances().size());
    if (nodes == cluster.getInstances().size()) {
      return;
    }
    try {
      Thread.sleep(5000);
    }
 catch (    InterruptedException e) {
    }
  }
  throw new Exception("All nodes did not joined the cluster as expected");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.hadoop.integration.benchmark.HadoopServiceTestDFSIOBenchmark </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test() throws Exception {
  int runs=Integer.parseInt(System.getProperty("testDFSIORuns","3"));
  for (int i=0; i < runs; i++) {
    LOG.info("Starting TestDFSIO run {} of {}",i + 1,runs);
    TestDFSIO testDFSIO=new TestDFSIO();
    JobConf jobConf=controller.getJobConf();
    jobConf.set("test.build.data","/user/root/benchmark/TestDFSIO");
    testDFSIO.setConf(jobConf);
    testDFSIO.run("-write -nrFiles 10 -fileSize 1000".split(" "));
    testDFSIO.run("-read -nrFiles 10 -fileSize 1000".split(" "));
    testDFSIO.run(new String[]{"-clean"});
    LOG.info("Completed TestDFSIO run {} of {}",i + 1,runs);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.jclouds.RunUrlStatementTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCheckUrlExists() throws IOException {
  RunUrlStatement.checkUrlExists(new URL("http://whirr.apache.org/"),"Exists");
}

</code></pre>

<br>
<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testCheckUrlDoesNotExist() throws IOException {
  RunUrlStatement.checkUrlExists(new URL("http://whirr.apache.org/non-existent"),"Doesn't exist");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.jclouds.integration.FirewallManagerTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testFirewallAuthorizationIsIdempotent() throws IOException {
  if (EC2ComputeService.class.isInstance(context.getComputeService())) {
    EC2Api api=context.unwrapApi(EC2Api.class);
    String groupName="jclouds#" + clusterSpec.getClusterName();
    api.getSecurityGroupApi().get().createSecurityGroupInRegion(region,groupName,"group description");
    try {
      manager.addRule(Rule.create().destination(instances).port(23344));
      manager.addRule(Rule.create().destination(instances).port(23344));
      manager.authorizeAllRules();
    }
  finally {
      api.getSecurityGroupApi().get().deleteSecurityGroupInRegion(region,groupName);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.kerberos.KerberosClientDryRunTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoServer() throws Exception {
  DryRun dryRun=launchWithClusterSpec(newClusterSpecForProperties(ImmutableMap.of("whirr.instance-templates","1 " + KerberosClientHandler.ROLE)));
  assertScriptPredicateOnPhase(dryRun,"bootstrap",bootstrapPredicate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.kerberos.KerberosServerDryRunTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaInstalled() throws Exception {
  DryRun dryRun=launchWithClusterSpec(newClusterSpecForProperties(ImmutableMap.of("whirr.instance-templates","1 " + KerberosServerHandler.ROLE + "+"+ KerberosClientHandler.ROLE)));
  assertScriptPredicateOnPhase(dryRun,"bootstrap",bootstrapPredicate());
  assertScriptPredicateOnPhase(dryRun,"bootstrap",containsPattern("install_openjdk"));
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaInstalledFalse() throws Exception {
  DryRun dryRun=launchWithClusterSpec(newClusterSpecForProperties(ImmutableMap.of("whirr.instance-templates","1 " + KerberosServerHandler.ROLE + "+"+ KerberosClientHandler.ROLE,"whirr.env.jdk_installed","false")));
  assertScriptPredicateOnPhase(dryRun,"bootstrap",bootstrapPredicate());
  assertScriptPredicateOnPhase(dryRun,"bootstrap",containsPattern("install_openjdk"));
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKerberosRealm() throws Exception {
  DryRun dryRun=launchWithClusterSpec(newClusterSpecForProperties(ImmutableMap.of("whirr.instance-templates","1 " + KerberosServerHandler.ROLE)));
  assertScriptPredicateOnPhase(dryRun,"bootstrap",bootstrapPredicate());
  assertScriptPredicateOnPhase(dryRun,"configure",configurePredicate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.mahout.integration.MahoutServiceTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testBinMahout() throws Exception {
  Statement binMahout=Statements.exec("source /etc/profile; $MAHOUT_HOME/bin/mahout");
  Cluster.Instance mahoutInstance=findMahoutInstance();
  Predicate<NodeMetadata> mahoutClientRole=and(alwaysTrue(),withIds(mahoutInstance.getId()));
  Map<? extends NodeMetadata,ExecResponse> responses=controller.runScriptOnNodesMatching(clusterSpec,mahoutClientRole,binMahout);
  LOG.info("Responses for Statement: " + binMahout);
  for (  Map.Entry<? extends NodeMetadata,ExecResponse> entry : responses.entrySet()) {
    LOG.info("Node[" + entry.getKey().getId() + "]: "+ entry.getValue());
  }
  assertResponsesContain(responses,binMahout,"Running on hadoop");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.pig.integration.PigServiceTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testPigBin() throws Exception {
  Statement binPig=Statements.exec(". /etc/profile && pig -e fs -ls /");
  Cluster.Instance pigInstance=findPigInstance();
  Predicate<NodeMetadata> pigClientRole=and(alwaysTrue(),withIds(pigInstance.getId()));
  Map<? extends NodeMetadata,ExecResponse> responses=controller.runScriptOnNodesMatching(clusterSpec,pigClientRole,binPig);
  LOG.info("Responses for Statement: " + binPig);
  for (  Map.Entry<? extends NodeMetadata,ExecResponse> entry : responses.entrySet()) {
    LOG.info("Node[" + entry.getKey().getId() + "]: "+ entry.getValue());
  }
  assertResponsesContain(responses,binPig,"/hadoop");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.puppet.integration.PuppetServiceTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(timeout=TestConstants.ITEST_TIMEOUT) public void testHttpAvailable() throws Exception {
  for (  Instance instance : cluster.getInstances()) {
    HostAndPort socket=HostAndPort.fromParts(instance.getPublicAddress().getHostAddress(),80);
    assert socketTester.apply(socket) : instance;
    URI httpUrl=URI.create("http://" + instance.getPublicAddress().getHostAddress());
    Strings2.toStringAndClose(httpUrl.toURL().openStream());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.service.puppet.predicates.PuppetPredicatesTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIsRole(){
  assert !PuppetPredicates.isPuppetRole().apply("bar");
  assert PuppetPredicates.isPuppetRole().apply("puppet:foo");
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFirst(){
  assert PuppetPredicates.isFirstPuppetRoleIn(ImmutableSet.of("puppet:foo","bar","puppet:bird")).apply("foo");
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLast(){
  assert PuppetPredicates.isLastPuppetRoleIn(ImmutableSet.of("puppet:foo","bar","puppet:bird")).apply("bird");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.state.integration.BlobClusterStateStoreTest </h4><pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class,timeout=TestConstants.ITEST_TIMEOUT) public void testInvalidContainerName() throws Exception {
  ClusterSpec spec=getTestClusterSpec();
  spec.setStateStoreContainer("whirr_test");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.whirr.util.integration.BlobCacheTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUploadInEUS3Region() throws Exception {
  ClusterSpec spec=getTestClusterSpec();
  if ("aws-ec2".equals(spec.getProvider())) {
    spec.setBlobStoreLocationId("EU");
    spec.getConfiguration().setProperty("jclouds.aws-s3.endpoint","https://s3-eu-west-1.amazonaws.com");
    testBlobCacheUpload(RandomStringUtils.randomAlphanumeric(1024 * 1024),spec);
  }
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUploadLargeFileToBlobCache() throws Exception {
  testBlobCacheUpload(RandomStringUtils.randomAlphanumeric(1024 * 1024));
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUploadSmallFileToBlobCache() throws Exception {
  testBlobCacheUpload("dummy small content");
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
