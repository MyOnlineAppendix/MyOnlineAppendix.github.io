<h3><span class=" glyphicon glyphicon-tag"/>&nbspEqualityVerifier</h3><kbd>Verifies whether objects/variable are equal to an expected value </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.zookeeper.MultiResponseTest </h4><pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmptyRoundTrip() throws IOException {
  MultiResponse result=new MultiResponse();
  MultiResponse decodedResult=codeDecode(result);
  Assert.assertEquals(result,decodedResult);
  Assert.assertEquals(result.hashCode(),decodedResult.hashCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.MultiTransactionRecordTest </h4><pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoundTrip() throws IOException {
  MultiTransactionRecord request=new MultiTransactionRecord();
  request.add(Op.check("check",1));
  request.add(Op.create("create","create data".getBytes(),ZooDefs.Ids.CREATOR_ALL_ACL,ZooDefs.Perms.ALL));
  request.add(Op.delete("delete",17));
  request.add(Op.setData("setData","set data".getBytes(),19));
  MultiTransactionRecord decodedRequest=codeDecode(request);
  Assert.assertEquals(request,decodedRequest);
  Assert.assertEquals(request.hashCode(),decodedRequest.hashCode());
}

</code></pre>

<br>
<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmptyRoundTrip() throws IOException {
  MultiTransactionRecord request=new MultiTransactionRecord();
  MultiTransactionRecord decodedRequest=codeDecode(request);
  Assert.assertEquals(request,decodedRequest);
  Assert.assertEquals(request.hashCode(),decodedRequest.hashCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.PortAssignmentTest </h4><pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetupPortRange(){
  PortAssignment.PortRange portRange=PortAssignment.setupPortRange(strProcessCount,cmdLine);
  assertEquals(buildAssertionMessage("minimum"),expectedMinimumPort,portRange.getMinimum());
  assertEquals(buildAssertionMessage("maximum"),expectedMaximumPort,portRange.getMaximum());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.RemoveWatchesCmdTest </h4><pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies deletion of NodeDataChanged watches
 */
@Test(timeout=30000) public void testRemoveNodeDataChangedWatches() throws Exception {
  LOG.info("Adding data watcher using getData()");
  List<EventType> expectedEvents=new ArrayList<Watcher.Event.EventType>();
  expectedEvents.add(EventType.DataWatchRemoved);
  MyWatcher myWatcher=new MyWatcher("/testnode1",expectedEvents,1);
  zk.create("/testnode1","data".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.getData("/testnode1",myWatcher,null);
  String cmdstring="removewatches /testnode1 -d";
  LOG.info("Remove watchers using shell command : {}",cmdstring);
  zkMain.cl.parseCommand(cmdstring);
  Assert.assertTrue("Removewatches cmd fails to remove data watches",zkMain.processZKCmd(zkMain.cl));
  LOG.info("Waiting for the DataWatchRemoved event");
  myWatcher.matches();
  Assert.assertEquals("Data watches are not removed : " + zk.getDataWatches(),0,zk.getDataWatches().size());
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies deletion of NodeCreated data watches
 */
@Test(timeout=30000) public void testRemoveNodeCreatedWatches() throws Exception {
  List<EventType> expectedEvents=new ArrayList<Watcher.Event.EventType>();
  expectedEvents.add(EventType.DataWatchRemoved);
  MyWatcher myWatcher1=new MyWatcher("/testnode1",expectedEvents,1);
  MyWatcher myWatcher2=new MyWatcher("/testnode1/testnode2",expectedEvents,1);
  LOG.info("Adding NodeCreated watcher");
  zk.exists("/testnode1",myWatcher1);
  zk.exists("/testnode1/testnode2",myWatcher2);
  String cmdstring1="removewatches /testnode1 -d";
  LOG.info("Remove watchers using shell command : {}",cmdstring1);
  zkMain.cl.parseCommand(cmdstring1);
  Assert.assertTrue("Removewatches cmd fails to remove pre-create watches",zkMain.processZKCmd(zkMain.cl));
  myWatcher1.matches();
  Assert.assertEquals("Failed to remove pre-create watches :" + zk.getExistWatches(),1,zk.getExistWatches().size());
  Assert.assertTrue("Failed to remove pre-create watches :" + zk.getExistWatches(),zk.getExistWatches().contains("/testnode1/testnode2"));
  String cmdstring2="removewatches /testnode1/testnode2 -d";
  LOG.info("Remove watchers using shell command : {}",cmdstring2);
  zkMain.cl.parseCommand(cmdstring2);
  Assert.assertTrue("Removewatches cmd fails to remove data watches",zkMain.processZKCmd(zkMain.cl));
  myWatcher2.matches();
  Assert.assertEquals("Failed to remove pre-create watches : " + zk.getExistWatches(),0,zk.getExistWatches().size());
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies deletion of NodeChildrenChanged watches
 */
@Test(timeout=30000) public void testRemoveNodeChildrenChangedWatches() throws Exception {
  List<EventType> expectedEvents=new ArrayList<Watcher.Event.EventType>();
  expectedEvents.add(EventType.ChildWatchRemoved);
  MyWatcher myWatcher=new MyWatcher("/testnode1",expectedEvents,1);
  zk.create("/testnode1","data".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  LOG.info("Adding child changed watcher");
  zk.getChildren("/testnode1",myWatcher);
  String cmdstring="removewatches /testnode1 -c";
  LOG.info("Remove watchers using shell command : {}",cmdstring);
  zkMain.cl.parseCommand(cmdstring);
  Assert.assertTrue("Removewatches cmd fails to remove child watches",zkMain.processZKCmd(zkMain.cl));
  myWatcher.matches();
  Assert.assertEquals("Failed to remove child watches : " + zk.getChildWatches(),0,zk.getChildWatches().size());
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies deletion of NodeDeleted watches
 */
@Test(timeout=30000) public void testRemoveNodeDeletedWatches() throws Exception {
  LOG.info("Adding NodeDeleted watcher");
  List<EventType> expectedEvents=new ArrayList<Watcher.Event.EventType>();
  expectedEvents.add(EventType.ChildWatchRemoved);
  expectedEvents.add(EventType.NodeDeleted);
  MyWatcher myWatcher=new MyWatcher("/testnode1",expectedEvents,1);
  zk.create("/testnode1","data".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/testnode1/testnode2","data".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.getChildren("/testnode1/testnode2",myWatcher);
  zk.getChildren("/testnode1",myWatcher);
  String cmdstring="removewatches /testnode1 -c";
  LOG.info("Remove watchers using shell command : {}",cmdstring);
  zkMain.cl.parseCommand(cmdstring);
  Assert.assertTrue("Removewatches cmd fails to remove child watches",zkMain.processZKCmd(zkMain.cl));
  LOG.info("Waiting for the ChildWatchRemoved event");
  myWatcher.matches();
  Assert.assertEquals("Failed to remove child watches : " + zk.getChildWatches(),1,zk.getChildWatches().size());
  Assert.assertTrue("Failed to remove child watches :" + zk.getChildWatches(),zk.getChildWatches().contains("/testnode1/testnode2"));
  zk.delete("/testnode1/testnode2",-1);
  myWatcher.matches();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.RemoveWatchesTest </h4><pre class="type-5 type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies removal of multiple data watchers when there is server
 * connection
 */
@Test(timeout=90000) public void testMultipleDataWatchers() throws IOException, InterruptedException, KeeperException {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
  MyWatcher w1=new MyWatcher("/node1",1);
  LOG.info("Adding data watcher {} on path {}",new Object[]{w1,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w1));
  MyWatcher w2=new MyWatcher("/node1",1);
  LOG.info("Adding data watcher {} on path {}",new Object[]{w2,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w2));
  removeWatches(zk2,"/node1",w2,WatcherType.Data,false,Code.OK);
  Assert.assertEquals("Didn't find data watcher",1,zk2.getDataWatches().size());
  Assert.assertEquals("Didn't find data watcher","/node1",zk2.getDataWatches().get(0));
  removeWatches(zk2,"/node1",w1,WatcherType.Any,false,Code.OK);
  Assert.assertTrue("Didn't remove data watcher",w2.matches());
  if (zk1 != null) {
    zk1.close();
    zk1=null;
  }
  List<EventType> events=w2.getEventsAfterWatchRemoval();
  Assert.assertEquals("Shouldn't get NodeDeletedEvent after watch removal",0,events.size());
}

</code></pre>

<br>
<pre class="type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies WatcherType.Any - removes only the configured child watcher
 * function
 */
@Test(timeout=90000) public void testRemoveAnyChildWatcher() throws Exception {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher w1=new MyWatcher("/node1",2);
  MyWatcher w2=new MyWatcher("/node1",1);
  LOG.info("Adding data watcher {} on path {}",new Object[]{w1,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w1));
  LOG.info("Adding child watcher {} on path {}",new Object[]{w1,"/node1"});
  zk2.getChildren("/node1",w2);
  LOG.info("Adding child watcher {} on path {}",new Object[]{w2,"/node1"});
  zk2.getChildren("/node1",w1);
  removeWatches(zk2,"/node1",w2,WatcherType.Any,false,Code.OK);
  Assert.assertTrue("Didn't remove child watcher",w2.matches());
  Assert.assertEquals("Didn't find child watcher",1,zk2.getChildWatches().size());
  Assert.assertEquals("Didn't find data watcher",1,zk2.getDataWatches().size());
  removeWatches(zk2,"/node1",w1,WatcherType.Any,false,Code.OK);
  Assert.assertTrue("Didn't remove watchers",w1.matches());
}

</code></pre>

<br>
<pre class="type-5 type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies null watcher with WatcherType.Data - remove all data
 * watchers. Child watchers shouldn't be removed
 */
@Test(timeout=90000) public void testRemoveAllDataWatchers() throws IOException, InterruptedException, KeeperException {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher w1=new MyWatcher("/node1",1);
  MyWatcher w2=new MyWatcher("/node1",1);
  LOG.info("Adding data watcher {} on path {}",new Object[]{w1,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w1));
  LOG.info("Adding data watcher {} on path {}",new Object[]{w2,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w2));
  LOG.info("Adding child watcher {} on path {}",new Object[]{w1,"/node1"});
  zk2.getChildren("/node1",w1);
  LOG.info("Adding child watcher {} on path {}",new Object[]{w2,"/node1"});
  zk2.getChildren("/node1",w2);
  removeWatches(zk2,"/node1",w1,WatcherType.Data,false,Code.OK);
  removeWatches(zk2,"/node1",w2,WatcherType.Data,false,Code.OK);
  zk1.create("/node1/child",null,Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
  Assert.assertTrue("Didn't remove data watcher",w1.matches());
  Assert.assertTrue("Didn't remove data watcher",w2.matches());
  int count=10;
  while (count > 0) {
    if (w1.getEventsAfterWatchRemoval().size() > 0 && w2.getEventsAfterWatchRemoval().size() > 0) {
      break;
    }
    count--;
    Thread.sleep(1000);
  }
  List<EventType> events=w1.getEventsAfterWatchRemoval();
  Assert.assertEquals("Didn't get NodeChildrenChanged event",1,events.size());
  Assert.assertTrue("Didn't get NodeChildrenChanged event",events.contains(EventType.NodeChildrenChanged));
  events=w2.getEventsAfterWatchRemoval();
  Assert.assertEquals("Didn't get NodeChildrenChanged event",1,events.size());
  Assert.assertTrue("Didn't get NodeChildrenChanged event",events.contains(EventType.NodeChildrenChanged));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies removal of many watchers locally when no connection and
 * WatcherType#Any. Also, verifies internal watchManager datastructures
 */
@Test(timeout=90000) public void testManyWatchersWhenNoConnection() throws Exception {
  int count=3;
  List<MyWatcher> wList=new ArrayList<MyWatcher>(count);
  MyWatcher w;
  String path="/node";
  for (int i=0; i < count; i++) {
    String nodePath=path + i;
    zk1.create(nodePath,null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    nodePath+="/";
  }
  for (int i=0; i < count; i++) {
    String nodePath=path + i;
    w=new MyWatcher(path + i,2);
    wList.add(w);
    LOG.info("Adding child watcher {} on path {}",new Object[]{w,nodePath});
    zk1.getChildren(nodePath,w);
    nodePath+="/";
  }
  Assert.assertEquals("Failed to add watchers!",count,zk1.getChildWatches().size());
  for (int i=0; i < count; i++) {
    String nodePath=path + i;
    w=wList.get(i);
    LOG.info("Adding data watcher {} on path {}",new Object[]{w,nodePath});
    zk1.getData(nodePath,w,null);
    nodePath+="/";
  }
  Assert.assertEquals("Failed to add watchers!",count,zk1.getDataWatches().size());
  stopServer();
  for (int i=0; i < count; i++) {
    final MyWatcher watcher=wList.get(i);
    removeWatches(zk1,path + i,watcher,WatcherType.Any,true,Code.OK);
    Assert.assertTrue("Didn't remove watcher",watcher.matches());
  }
  Assert.assertEquals("Didn't remove watch references!",0,zk1.getChildWatches().size());
  Assert.assertEquals("Didn't remove watch references!",0,zk1.getDataWatches().size());
}

</code></pre>

<br>
<pre class="type-5 type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies removal of single watcher when there is server connection
 */
@Test(timeout=90000) public void testRemoveSingleWatcher() throws Exception {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
  zk1.create("/node2",null,Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
  MyWatcher w1=new MyWatcher("/node1",1);
  LOG.info("Adding data watcher {} on path {}",new Object[]{w1,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w1));
  MyWatcher w2=new MyWatcher("/node2",1);
  LOG.info("Adding data watcher {} on path {}",new Object[]{w2,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node2",w2));
  removeWatches(zk2,"/node1",w1,WatcherType.Data,false,Code.OK);
  Assert.assertEquals("Didn't find data watcher",1,zk2.getDataWatches().size());
  Assert.assertEquals("Didn't find data watcher","/node2",zk2.getDataWatches().get(0));
  removeWatches(zk2,"/node2",w2,WatcherType.Any,false,Code.OK);
  Assert.assertTrue("Didn't remove data watcher",w2.matches());
  if (zk1 != null) {
    zk1.close();
    zk1=null;
  }
  List<EventType> events=w1.getEventsAfterWatchRemoval();
  Assert.assertFalse("Shouldn't get NodeDeletedEvent after watch removal",events.contains(EventType.NodeDeleted));
  Assert.assertEquals("Shouldn't get NodeDeletedEvent after watch removal",0,events.size());
}

</code></pre>

<br>
<pre class="type-5 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies WatcherType.Children - removes only the configured child
 * watcher function
 */
@Test(timeout=90000) public void testRemoveAllChildWatchesOnAPath() throws Exception {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  final CountDownLatch cWatchCount=new CountDownLatch(2);
  final CountDownLatch rmWatchCount=new CountDownLatch(2);
  Watcher w1=new Watcher(){
    @Override public void process(    WatchedEvent event){
switch (event.getType()) {
case ChildWatchRemoved:
        rmWatchCount.countDown();
      break;
case NodeChildrenChanged:
    cWatchCount.countDown();
  break;
default :
break;
}
}
}
;
Watcher w2=new Watcher(){
@Override public void process(WatchedEvent event){
switch (event.getType()) {
case ChildWatchRemoved:
rmWatchCount.countDown();
break;
case NodeChildrenChanged:
cWatchCount.countDown();
break;
default :
break;
}
}
}
;
LOG.info("Adding child watcher {} on path {}",new Object[]{w1,"/node1"});
Assert.assertEquals("Didn't set child watches",0,zk2.getChildren("/node1",w1).size());
LOG.info("Adding child watcher {} on path {}",new Object[]{w2,"/node1"});
Assert.assertEquals("Didn't set child watches",0,zk2.getChildren("/node1",w2).size());
Assert.assertTrue("Server session is not a watcher",isServerSessionWatcher(zk2.getSessionId(),"/node1",WatcherType.Children));
removeAllWatches(zk2,"/node1",WatcherType.Children,false,Code.OK);
Assert.assertTrue("Didn't remove child watcher",rmWatchCount.await(CONNECTION_TIMEOUT,TimeUnit.MILLISECONDS));
Assert.assertFalse("Server session is still a watcher after removal",isServerSessionWatcher(zk2.getSessionId(),"/node1",WatcherType.Children));
}

</code></pre>

<br>
<pre class="type-5 type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies null watcher with WatcherType.Children - remove all child
 * watchers. Data watchers shouldn't be removed
 */
@Test(timeout=90000) public void testRemoveAllChildWatchers() throws IOException, InterruptedException, KeeperException {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher w1=new MyWatcher("/node1",1);
  MyWatcher w2=new MyWatcher("/node1",1);
  LOG.info("Adding data watcher {} on path {}",new Object[]{w1,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w1));
  LOG.info("Adding data watcher {} on path {}",new Object[]{w2,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w2));
  LOG.info("Adding child watcher {} on path {}",new Object[]{w1,"/node1"});
  zk2.getChildren("/node1",w1);
  LOG.info("Adding child watcher {} on path {}",new Object[]{w2,"/node1"});
  zk2.getChildren("/node1",w2);
  removeWatches(zk2,"/node1",w1,WatcherType.Children,false,Code.OK);
  removeWatches(zk2,"/node1",w2,WatcherType.Children,false,Code.OK);
  zk1.setData("/node1","test".getBytes(),-1);
  Assert.assertTrue("Didn't remove child watcher",w1.matches());
  Assert.assertTrue("Didn't remove child watcher",w2.matches());
  int count=10;
  while (count > 0) {
    if (w1.getEventsAfterWatchRemoval().size() > 0 && w2.getEventsAfterWatchRemoval().size() > 0) {
      break;
    }
    count--;
    Thread.sleep(1000);
  }
  List<EventType> events=w1.getEventsAfterWatchRemoval();
  Assert.assertEquals("Didn't get NodeDataChanged event",1,events.size());
  Assert.assertTrue("Didn't get NodeDataChanged event",events.contains(EventType.NodeDataChanged));
  events=w2.getEventsAfterWatchRemoval();
  Assert.assertEquals("Didn't get NodeDataChanged event",1,events.size());
  Assert.assertTrue("Didn't get NodeDataChanged event",events.contains(EventType.NodeDataChanged));
}

</code></pre>

<br>
<pre class="type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies removing watcher having namespace
 */
@Test(timeout=90000) public void testChRootRemoveWatcher() throws Exception {
  String chRoot="/appsX";
  zk1.create("/appsX",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  if (zk1 != null) {
    zk1.close();
  }
  if (zk2 != null) {
    zk2.close();
  }
  zk1=createClient(this.hostPort + chRoot);
  zk2=createClient(this.hostPort + chRoot);
  LOG.info("Creating child znode /node1 using chRoot client");
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher w1=new MyWatcher("/node1",2);
  MyWatcher w2=new MyWatcher("/node1",1);
  LOG.info("Adding data watcher {} on path {}",new Object[]{w1,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w1));
  LOG.info("Adding child watcher {} on path {}",new Object[]{w1,"/node1"});
  zk2.getChildren("/node1",w2);
  LOG.info("Adding child watcher {} on path {}",new Object[]{w2,"/node1"});
  zk2.getChildren("/node1",w1);
  removeWatches(zk2,"/node1",w1,WatcherType.Any,false,Code.OK);
  Assert.assertTrue("Didn't remove child watcher",w1.matches());
  Assert.assertEquals("Didn't find child watcher",1,zk2.getChildWatches().size());
  removeWatches(zk2,"/node1",w2,WatcherType.Any,false,Code.OK);
  Assert.assertTrue("Didn't remove child watcher",w2.matches());
}

</code></pre>

<br>
<pre class="type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies WatcherType.Any - removes only the configured data watcher
 * function
 */
@Test(timeout=90000) public void testRemoveAnyDataWatcher() throws Exception {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher w1=new MyWatcher("/node1",1);
  MyWatcher w2=new MyWatcher("/node1",2);
  LOG.info("Adding data watcher {} on path {}",new Object[]{w1,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w1));
  LOG.info("Adding data watcher {} on path {}",new Object[]{w2,"/node1"});
  Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w2));
  LOG.info("Adding child watcher {} on path {}",new Object[]{w2,"/node1"});
  zk2.getChildren("/node1",w2);
  removeWatches(zk2,"/node1",w1,WatcherType.Any,false,Code.OK);
  Assert.assertTrue("Didn't remove data watcher",w1.matches());
  Assert.assertEquals("Didn't find child watcher",1,zk2.getChildWatches().size());
  Assert.assertEquals("Didn't find data watcher",1,zk2.getDataWatches().size());
  removeWatches(zk2,"/node1",w2,WatcherType.Any,false,Code.OK);
  Assert.assertTrue("Didn't remove child watcher",w2.matches());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies many child watchers. Also, verifies internal datastructure
 * 'watchManager.childWatches'
 */
@Test(timeout=90000) public void testManyChildWatchers() throws Exception {
  int count=50;
  List<MyWatcher> wList=new ArrayList<MyWatcher>(count);
  MyWatcher w;
  String path="/node";
  for (int i=0; i < count; i++) {
    String nodePath=path + i;
    zk1.create(nodePath,null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    nodePath+="/";
  }
  for (int i=0; i < count; i++) {
    String nodePath=path + i;
    w=new MyWatcher(path + i,1);
    wList.add(w);
    LOG.info("Adding child watcher {} on path {}",new Object[]{w,nodePath});
    zk1.getChildren(nodePath,w);
    nodePath+="/";
  }
  Assert.assertEquals("Failed to add watchers!",count,zk1.getChildWatches().size());
  for (int i=0; i < count; i++) {
    final MyWatcher watcher=wList.get(i);
    removeWatches(zk1,path + i,watcher,WatcherType.Children,false,Code.OK);
    Assert.assertTrue("Didn't remove child watcher",watcher.matches());
  }
  Assert.assertEquals("Didn't remove watch references!",0,zk1.getChildWatches().size());
}

</code></pre>

<br>
<pre class="type-5 type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies WatcherType.Any - removes all the configured child,data
 * watcher functions
 */
@Test(timeout=90000) public void testRemoveAllWatchesOnAPath() throws Exception {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  final CountDownLatch watchCount=new CountDownLatch(2);
  final CountDownLatch rmWatchCount=new CountDownLatch(4);
  Watcher w1=new Watcher(){
    @Override public void process(    WatchedEvent event){
switch (event.getType()) {
case ChildWatchRemoved:
case DataWatchRemoved:
        rmWatchCount.countDown();
      break;
case NodeChildrenChanged:
case NodeDataChanged:
    watchCount.countDown();
  break;
default :
break;
}
}
}
;
Watcher w2=new Watcher(){
@Override public void process(WatchedEvent event){
switch (event.getType()) {
case ChildWatchRemoved:
case DataWatchRemoved:
rmWatchCount.countDown();
break;
case NodeChildrenChanged:
case NodeDataChanged:
watchCount.countDown();
break;
default :
break;
}
}
}
;
LOG.info("Adding child watcher {} on path {}",new Object[]{w1,"/node1"});
Assert.assertEquals("Didn't set child watches",0,zk2.getChildren("/node1",w1).size());
LOG.info("Adding child watcher {} on path {}",new Object[]{w2,"/node1"});
Assert.assertEquals("Didn't set child watches",0,zk2.getChildren("/node1",w2).size());
LOG.info("Adding data watcher {} on path {}",new Object[]{w1,"/node1"});
Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w1));
LOG.info("Adding data watcher {} on path {}",new Object[]{w2,"/node1"});
Assert.assertNotNull("Didn't set data watches",zk2.exists("/node1",w2));
Assert.assertTrue("Server session is not a watcher",isServerSessionWatcher(zk2.getSessionId(),"/node1",WatcherType.Data));
removeAllWatches(zk2,"/node1",WatcherType.Any,false,Code.OK);
Assert.assertTrue("Didn't remove data watcher",rmWatchCount.await(CONNECTION_TIMEOUT,TimeUnit.MILLISECONDS));
Assert.assertFalse("Server session is still a watcher after removal",isServerSessionWatcher(zk2.getSessionId(),"/node1",WatcherType.Data));
Assert.assertEquals("Received watch notification after removal!",2,watchCount.getCount());
}

</code></pre>

<br>
<pre class="type-5 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies WatcherType.Children - removes only the configured child
 * watcher function
 */
@Test(timeout=90000) public void testRemoveWhenMultipleChildWatchesOnAPath() throws Exception {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  final CountDownLatch childWatchCount=new CountDownLatch(1);
  final CountDownLatch rmWatchCount=new CountDownLatch(1);
  Watcher w1=new Watcher(){
    @Override public void process(    WatchedEvent event){
      if (event.getType() == EventType.ChildWatchRemoved) {
        rmWatchCount.countDown();
      }
    }
  }
;
  Watcher w2=new Watcher(){
    @Override public void process(    WatchedEvent event){
      if (event.getType() == EventType.NodeChildrenChanged) {
        childWatchCount.countDown();
      }
    }
  }
;
  LOG.info("Adding child watcher {} on path {}",new Object[]{w1,"/node1"});
  Assert.assertEquals("Didn't set child watches",0,zk2.getChildren("/node1",w1).size());
  LOG.info("Adding child watcher {} on path {}",new Object[]{w2,"/node1"});
  Assert.assertEquals("Didn't set child watches",0,zk2.getChildren("/node1",w2).size());
  removeWatches(zk2,"/node1",w1,WatcherType.Children,false,Code.OK);
  Assert.assertTrue("Didn't remove child watcher",rmWatchCount.await(CONNECTION_TIMEOUT,TimeUnit.MILLISECONDS));
  zk1.create("/node1/node2",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  LOG.info("Waiting for child watchers to be notified");
  Assert.assertTrue("Didn't get child watch notification!",childWatchCount.await(CONNECTION_TIMEOUT,TimeUnit.MILLISECONDS));
}

</code></pre>

<br>
<pre class="type-5 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies removal of multiple child watchers when there is server
 * connection
 */
@Test(timeout=90000) public void testMultipleChildWatchers() throws IOException, InterruptedException, KeeperException {
  zk1.create("/node1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher w1=new MyWatcher("/node1",1);
  LOG.info("Adding child watcher {} on path {}",new Object[]{w1,"/node1"});
  zk2.getChildren("/node1",w1);
  MyWatcher w2=new MyWatcher("/node1",1);
  LOG.info("Adding child watcher {} on path {}",new Object[]{w2,"/node1"});
  zk2.getChildren("/node1",w2);
  removeWatches(zk2,"/node1",w2,WatcherType.Children,false,Code.OK);
  Assert.assertTrue("Didn't remove child watcher",w2.matches());
  Assert.assertEquals("Didn't find child watcher",1,zk2.getChildWatches().size());
  removeWatches(zk2,"/node1",w1,WatcherType.Any,false,Code.OK);
  Assert.assertTrue("Didn't remove child watcher",w1.matches());
  zk1.create("/node1/node2",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  int count=30;
  while (count > 0) {
    if (w1.getEventsAfterWatchRemoval().size() > 0) {
      break;
    }
    count--;
    Thread.sleep(100);
  }
  List<EventType> events=w2.getEventsAfterWatchRemoval();
  Assert.assertEquals("Shouldn't get NodeChildrenChanged event",0,events.size());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies many pre-node watchers. Also, verifies internal
 * datastructure 'watchManager.existWatches'
 */
@Test(timeout=90000) public void testManyPreNodeWatchers() throws Exception {
  int count=50;
  List<MyWatcher> wList=new ArrayList<MyWatcher>(count);
  MyWatcher w;
  String path="/node";
  for (int i=0; i < count; i++) {
    final String nodePath=path + i;
    w=new MyWatcher(nodePath,1);
    wList.add(w);
    LOG.info("Adding pre node watcher {} on path {}",new Object[]{w,nodePath});
    zk1.exists(nodePath,w);
  }
  Assert.assertEquals("Failed to add watchers!",count,zk1.getExistWatches().size());
  for (int i=0; i < count; i++) {
    final MyWatcher watcher=wList.get(i);
    removeWatches(zk1,path + i,watcher,WatcherType.Data,false,Code.OK);
    Assert.assertTrue("Didn't remove data watcher",watcher.matches());
  }
  Assert.assertEquals("Didn't remove watch references!",0,zk1.getExistWatches().size());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies many data watchers. Also, verifies internal datastructure
 * 'watchManager.dataWatches'
 */
@Test(timeout=90000) public void testManyDataWatchers() throws Exception {
  int count=50;
  List<MyWatcher> wList=new ArrayList<MyWatcher>(count);
  MyWatcher w;
  String path="/node";
  for (int i=0; i < count; i++) {
    String nodePath=path + i;
    w=new MyWatcher(path + i,1);
    wList.add(w);
    zk1.create(nodePath,null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    LOG.info("Adding data watcher {} on path {}",new Object[]{w,nodePath});
    zk1.getData(nodePath,w,null);
    nodePath+="/";
  }
  Assert.assertEquals("Failed to add watchers!",count,zk1.getDataWatches().size());
  for (int i=0; i < count; i++) {
    final MyWatcher watcher=wList.get(i);
    removeWatches(zk1,path + i,watcher,WatcherType.Data,false,Code.OK);
    Assert.assertTrue("Didn't remove data watcher",watcher.matches());
  }
  Assert.assertEquals("Didn't remove watch references!",0,zk1.getDataWatches().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.VerGenTest </h4><pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParser(){
  VerGen.Version v=VerGen.parseVersionString(input);
  Assert.assertEquals(expected[0],v.maj);
  Assert.assertEquals(expected[1],v.min);
  Assert.assertEquals(expected[2],v.micro);
  Assert.assertEquals(expected[3],v.qualifier);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.ZooKeeperTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseWithExtraSpaces() throws Exception {
  final ZooKeeper zk=createClient();
  ZooKeeperMain zkMain=new ZooKeeperMain(zk);
  String cmdstring="      ls       /  ";
  zkMain.cl.parseCommand(cmdstring);
  Assert.assertEquals("Spaces also considered as characters",zkMain.cl.getNumArguments(),2);
  Assert.assertEquals("ls is not taken as first argument",zkMain.cl.getCmdArgument(0),"ls");
  Assert.assertEquals("/ is not taken as second argument",zkMain.cl.getCmdArgument(1),"/");
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteRecursiveAsync() throws IOException, InterruptedException, KeeperException {
  final ZooKeeper zk=createClient();
  zk.setData("/","some".getBytes(),-1);
  zk.create("/a","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/b","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/b/v","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/b/v/1","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/c","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/c/v","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  for (int i=0; i < 50; ++i) {
    zk.create("/a/c/" + i,"some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  }
  List<String> children=zk.getChildren("/a",false);
  Assert.assertEquals("2 children - b & c should be present ",children.size(),2);
  Assert.assertTrue(children.contains("b"));
  Assert.assertTrue(children.contains("c"));
  VoidCallback cb=new VoidCallback(){
    @Override public void processResult(    int rc,    String path,    Object ctx){
synchronized (ctx) {
        ((AtomicInteger)ctx).set(4);
        ctx.notify();
      }
    }
  }
;
  final AtomicInteger ctx=new AtomicInteger(3);
  ZKUtil.deleteRecursive(zk,"/a",cb,ctx);
synchronized (ctx) {
    ctx.wait();
  }
  Assert.assertEquals(4,((AtomicInteger)ctx).get());
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseWithMixedQuotes() throws Exception {
  final ZooKeeper zk=createClient();
  ZooKeeperMain zkMain=new ZooKeeperMain(zk);
  for (  String[] quoteChars : new String[][]{{"'","\""},{"\"","'"}}) {
    String outerQuotes=quoteChars[0];
    String innerQuotes=quoteChars[1];
    String cmdstring=String.format("create /node %1$s%2$squoted data%2$s%1$s",outerQuotes,innerQuotes);
    zkMain.cl.parseCommand(cmdstring);
    Assert.assertEquals("quotes combine arguments",zkMain.cl.getNumArguments(),3);
    Assert.assertEquals("create is not taken as first argument",zkMain.cl.getCmdArgument(0),"create");
    Assert.assertEquals("/node is not taken as second argument",zkMain.cl.getCmdArgument(1),"/node");
    Assert.assertEquals("quoted data is not taken as third argument",zkMain.cl.getCmdArgument(2),innerQuotes + "quoted data" + innerQuotes);
  }
}

</code></pre>

<br>
<pre class="type-3 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateNodeWithoutData() throws Exception {
  final ZooKeeper zk=createClient();
  ZooKeeperMain zkMain=new ZooKeeperMain(zk);
  String cmdstring="create -s /node ";
  zkMain.cl.parseCommand(cmdstring);
  Assert.assertTrue("Doesn't create node without data",zkMain.processZKCmd(zkMain.cl));
  cmdstring="create  -e /node ";
  zkMain.cl.parseCommand(cmdstring);
  Assert.assertTrue("Doesn't create node without data",zkMain.processZKCmd(zkMain.cl));
  cmdstring="create -s -e /node ";
  zkMain.cl.parseCommand(cmdstring);
  Assert.assertTrue("Doesn't create node without data",zkMain.processZKCmd(zkMain.cl));
  cmdstring="create -s y /node";
  zkMain.cl.parseCommand(cmdstring);
  try {
    Assert.assertTrue("Created node with wrong option",zkMain.processZKCmd(zkMain.cl));
    Assert.fail("Created the node with wrong option should " + "throw Exception.");
  }
 catch (  IllegalArgumentException e) {
    Assert.assertEquals("Path must start with / character",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidStatCommand() throws Exception {
  final ZooKeeper zk=createClient();
  ZooKeeperMain zkMain=new ZooKeeperMain(zk);
  String cmdstring1="stat /node123";
  zkMain.cl.parseCommand(cmdstring1);
  try {
    Assert.assertFalse(zkMain.processZKCmd(zkMain.cl));
    Assert.fail("Path doesn't exists so, command should fail.");
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
  }
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseWithEmptyQuotes() throws Exception {
  final ZooKeeper zk=createClient();
  ZooKeeperMain zkMain=new ZooKeeperMain(zk);
  String cmdstring="create /node ''";
  zkMain.cl.parseCommand(cmdstring);
  Assert.assertEquals("empty quotes should produce arguments",zkMain.cl.getNumArguments(),3);
  Assert.assertEquals("create is not taken as first argument",zkMain.cl.getCmdArgument(0),"create");
  Assert.assertEquals("/node is not taken as second argument",zkMain.cl.getCmdArgument(1),"/node");
  Assert.assertEquals("empty string is not taken as third argument",zkMain.cl.getCmdArgument(2),"");
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseWithQuotes() throws Exception {
  final ZooKeeper zk=createClient();
  ZooKeeperMain zkMain=new ZooKeeperMain(zk);
  for (  String quoteChar : new String[]{"'","\""}) {
    String cmdstring=String.format("create /node %1$squoted data%1$s",quoteChar);
    zkMain.cl.parseCommand(cmdstring);
    Assert.assertEquals("quotes combine arguments",zkMain.cl.getNumArguments(),3);
    Assert.assertEquals("create is not taken as first argument",zkMain.cl.getCmdArgument(0),"create");
    Assert.assertEquals("/node is not taken as second argument",zkMain.cl.getCmdArgument(1),"/node");
    Assert.assertEquals("quoted data is not taken as third argument",zkMain.cl.getCmdArgument(2),"quoted data");
  }
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetData() throws Exception {
  final ZooKeeper zk=createClient();
  ZooKeeperMain zkMain=new ZooKeeperMain(zk);
  String cmdstring1="create -e /node4 data";
  String cmdstring2="set /node4 " + "data";
  String cmdstring3="delete /node4";
  Stat stat=new Stat();
  int version=0;
  zkMain.cl.parseCommand(cmdstring1);
  Assert.assertTrue(zkMain.processZKCmd(zkMain.cl));
  stat=zk.exists("/node4",true);
  version=stat.getVersion();
  zkMain.cl.parseCommand(cmdstring2);
  Assert.assertFalse(zkMain.processZKCmd(zkMain.cl));
  stat=zk.exists("/node4",true);
  Assert.assertEquals(version + 1,stat.getVersion());
  zkMain.cl.parseCommand(cmdstring3);
  Assert.assertFalse(zkMain.processZKCmd(zkMain.cl));
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStatWhenPathDoesNotExist() throws IOException, InterruptedException {
  final ZooKeeper zk=createClient();
  ZooKeeperMain main=new ZooKeeperMain(zk);
  String cmdstring="stat /invalidPath";
  main.cl.parseCommand(cmdstring);
  try {
    main.processZKCmd(main.cl);
    Assert.fail("As Node does not exist, command should fail by throwing No Node Exception.");
  }
 catch (  KeeperException e) {
    Assert.assertEquals("KeeperErrorCode = NoNode for /invalidPath",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseWithMultipleQuotes() throws Exception {
  final ZooKeeper zk=createClient();
  ZooKeeperMain zkMain=new ZooKeeperMain(zk);
  String cmdstring="create /node '' ''";
  zkMain.cl.parseCommand(cmdstring);
  Assert.assertEquals("expected 5 arguments",zkMain.cl.getNumArguments(),4);
  Assert.assertEquals("create is not taken as first argument",zkMain.cl.getCmdArgument(0),"create");
  Assert.assertEquals("/node is not taken as second argument",zkMain.cl.getCmdArgument(1),"/node");
  Assert.assertEquals("empty string is not taken as third argument",zkMain.cl.getCmdArgument(2),"");
  Assert.assertEquals("empty string is not taken as fourth argument",zkMain.cl.getCmdArgument(3),"");
}

</code></pre>

<br>
<pre class="type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteRecursive() throws IOException, InterruptedException, KeeperException {
  final ZooKeeper zk=createClient();
  zk.setData("/","some".getBytes(),-1);
  zk.create("/a","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/b","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/b/v","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/b/v/1","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/c","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/a/c/v","some".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  List<String> children=zk.getChildren("/a",false);
  Assert.assertEquals("2 children - b & c should be present ",children.size(),2);
  Assert.assertTrue(children.contains("b"));
  Assert.assertTrue(children.contains("c"));
  ZooKeeperMain zkMain=new ZooKeeperMain(zk);
  String cmdstring0="rmr /a/b/v";
  String cmdstring1="deleteall /a";
  zkMain.cl.parseCommand(cmdstring0);
  Assert.assertFalse(zkMain.processZKCmd(zkMain.cl));
  Assert.assertEquals(null,zk.exists("/a/b/v",null));
  zkMain.cl.parseCommand(cmdstring1);
  Assert.assertFalse(zkMain.processZKCmd(zkMain.cl));
  Assert.assertNull(zk.exists("/a",null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.common.AtomicFileWritingIdiomTest </h4><pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOutputStreamSuccess() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  createFile(target,"before");
  assertEquals("before",getContent(target));
  new AtomicFileWritingIdiom(target,new OutputStreamStatement(){
    @Override public void write(    OutputStream os) throws IOException {
      os.write("after".getBytes("ASCII"));
      assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
    }
  }
);
  assertFalse("tmp file should have been deleted",tmp.exists());
  assertEquals("after",getContent(target));
  target.delete();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOutputStreamFailureError() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  createFile(target,"before");
  assertEquals("before",getContent(target));
  boolean exception=false;
  try {
    new AtomicFileWritingIdiom(target,new OutputStreamStatement(){
      @Override public void write(      OutputStream os) throws IOException {
        os.write("after".getBytes("ASCII"));
        os.flush();
        assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
        throw new Error();
      }
    }
);
  }
 catch (  Error ex) {
    exception=true;
  }
  assertFalse("tmp file should have been deleted",tmp.exists());
  assertTrue("should have raised an exception",exception);
  assertEquals("before",getContent(target));
  target.delete();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriterFailureIOException() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  createFile(target,"before");
  assertEquals("before",getContent(target));
  boolean exception=false;
  try {
    new AtomicFileWritingIdiom(target,new WriterStatement(){
      @Override public void write(      Writer os) throws IOException {
        os.write("after");
        os.flush();
        assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
        throw new IOException();
      }
    }
);
  }
 catch (  IOException ex) {
    exception=true;
  }
  assertFalse("tmp file should have been deleted",tmp.exists());
  assertTrue("should have raised an exception",exception);
  assertEquals("before",getContent(target));
  target.delete();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOutputStreamSuccessNE() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  target.delete();
  assertFalse("file should not exist",target.exists());
  new AtomicFileWritingIdiom(target,new OutputStreamStatement(){
    @Override public void write(    OutputStream os) throws IOException {
      os.write("after".getBytes("ASCII"));
      assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
    }
  }
);
  assertEquals("after",getContent(target));
  target.delete();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOutputStreamFailure() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  createFile(target,"before");
  assertEquals("before",getContent(target));
  boolean exception=false;
  try {
    new AtomicFileWritingIdiom(target,new OutputStreamStatement(){
      @Override public void write(      OutputStream os) throws IOException {
        os.write("after".getBytes("ASCII"));
        os.flush();
        assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
        throw new RuntimeException();
      }
    }
);
  }
 catch (  RuntimeException ex) {
    exception=true;
  }
  assertFalse("tmp file should have been deleted",tmp.exists());
  assertTrue("should have raised an exception",exception);
  assertEquals("before",getContent(target));
  target.delete();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriterSuccess() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  createFile(target,"before");
  assertEquals("before",getContent(target));
  new AtomicFileWritingIdiom(target,new WriterStatement(){
    @Override public void write(    Writer os) throws IOException {
      os.write("after");
      assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
    }
  }
);
  assertFalse("tmp file should have been deleted",tmp.exists());
  assertEquals("after",getContent(target));
  target.delete();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriterSuccessNE() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  target.delete();
  assertFalse("file should not exist",target.exists());
  new AtomicFileWritingIdiom(target,new WriterStatement(){
    @Override public void write(    Writer os) throws IOException {
      os.write("after");
      assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
    }
  }
);
  assertFalse("tmp file should have been deleted",tmp.exists());
  assertEquals("after",getContent(target));
  target.delete();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriterFailure() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  createFile(target,"before");
  assertEquals("before",getContent(target));
  boolean exception=false;
  try {
    new AtomicFileWritingIdiom(target,new WriterStatement(){
      @Override public void write(      Writer os) throws IOException {
        os.write("after");
        os.flush();
        assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
        throw new RuntimeException();
      }
    }
);
  }
 catch (  RuntimeException ex) {
    exception=true;
  }
  assertFalse("tmp file should have been deleted",tmp.exists());
  assertTrue("should have raised an exception",exception);
  assertEquals("before",getContent(target));
  target.delete();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOutputStreamFailureIOException() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  createFile(target,"before");
  assertEquals("before",getContent(target));
  boolean exception=false;
  try {
    new AtomicFileWritingIdiom(target,new OutputStreamStatement(){
      @Override public void write(      OutputStream os) throws IOException {
        os.write("after".getBytes("ASCII"));
        os.flush();
        assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
        throw new IOException();
      }
    }
);
  }
 catch (  IOException ex) {
    exception=true;
  }
  assertFalse("tmp file should have been deleted",tmp.exists());
  assertTrue("should have raised an exception",exception);
  assertEquals("before",getContent(target));
  target.delete();
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriterFailureError() throws IOException {
  File target=new File(tmpdir,"target.txt");
  final File tmp=new File(tmpdir,"target.txt.tmp");
  createFile(target,"before");
  assertEquals("before",getContent(target));
  boolean exception=false;
  try {
    new AtomicFileWritingIdiom(target,new WriterStatement(){
      @Override public void write(      Writer os) throws IOException {
        os.write("after");
        os.flush();
        assertTrue("implementation of AtomicFileOutputStream has changed, update the test",tmp.exists());
        throw new Error();
      }
    }
);
  }
 catch (  Error ex) {
    exception=true;
  }
  assertFalse("tmp file should have been deleted",tmp.exists());
  assertTrue("should have raised an exception",exception);
  assertEquals("before",getContent(target));
  target.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.common.TimeTest </h4><pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testElapsedTimeToDate() throws Exception {
  long walltime=Time.currentWallTime();
  long elapsedTime=Time.currentElapsedTime();
  Thread.sleep(200);
  Calendar cal=Calendar.getInstance();
  cal.setTime(Time.elapsedTimeToDate(elapsedTime));
  int calculatedDate=cal.get(Calendar.HOUR_OF_DAY);
  cal.setTime(new Date(walltime));
  int realDate=cal.get(Calendar.HOUR_OF_DAY);
  Assert.assertEquals(calculatedDate,realDate);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.recipes.leader.LeaderElectionSupportTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNodes9() throws IOException, InterruptedException, KeeperException {
  int testIterations=9;
  final CountDownLatch latch=new CountDownLatch(testIterations);
  final AtomicInteger failureCounter=new AtomicInteger();
  for (int i=0; i < testIterations; i++) {
    runElectionSupportThread(latch,failureCounter);
  }
  Assert.assertEquals(0,failureCounter.get());
  if (!latch.await(10,TimeUnit.SECONDS)) {
    logger.info("Waited for all threads to start, but timed out. We had {} failures.",failureCounter);
  }
}

</code></pre>

<br>
<pre class="type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLeaderHostName() throws KeeperException, InterruptedException {
  LeaderElectionSupport electionSupport=createLeaderElectionSupport();
  electionSupport.start();
  Thread.sleep(3000);
  String leaderHostName=electionSupport.getLeaderHostName();
  Assert.assertNotNull(leaderHostName);
  Assert.assertEquals("foohost",leaderHostName);
  electionSupport.stop();
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNodes20() throws IOException, InterruptedException, KeeperException {
  int testIterations=20;
  final CountDownLatch latch=new CountDownLatch(testIterations);
  final AtomicInteger failureCounter=new AtomicInteger();
  for (int i=0; i < testIterations; i++) {
    runElectionSupportThread(latch,failureCounter);
  }
  Assert.assertEquals(0,failureCounter.get());
  if (!latch.await(10,TimeUnit.SECONDS)) {
    logger.info("Waited for all threads to start, but timed out. We had {} failures.",failureCounter);
  }
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadyOffer() throws Exception {
  final ArrayList<EventType> events=new ArrayList<EventType>();
  final CountDownLatch electedComplete=new CountDownLatch(1);
  final LeaderElectionSupport electionSupport1=createLeaderElectionSupport();
  electionSupport1.start();
  LeaderElectionSupport electionSupport2=createLeaderElectionSupport();
  LeaderElectionAware listener=new LeaderElectionAware(){
    boolean stoppedElectedNode=false;
    @Override public void onElectionEvent(    EventType eventType){
      events.add(eventType);
      if (!stoppedElectedNode && eventType == EventType.DETERMINE_COMPLETE) {
        stoppedElectedNode=true;
        try {
          electionSupport1.stop();
        }
 catch (        Exception e) {
          logger.error("Unexpected error",e);
        }
      }
      if (eventType == EventType.ELECTED_COMPLETE) {
        electedComplete.countDown();
      }
    }
  }
;
  electionSupport2.addListener(listener);
  electionSupport2.start();
  electedComplete.await(CONNECTION_TIMEOUT / 3,TimeUnit.MILLISECONDS);
  final ArrayList<EventType> expectedevents=new ArrayList<EventType>();
  expectedevents.add(EventType.START);
  expectedevents.add(EventType.OFFER_START);
  expectedevents.add(EventType.OFFER_COMPLETE);
  expectedevents.add(EventType.DETERMINE_START);
  expectedevents.add(EventType.DETERMINE_COMPLETE);
  expectedevents.add(EventType.DETERMINE_START);
  expectedevents.add(EventType.DETERMINE_COMPLETE);
  expectedevents.add(EventType.ELECTED_START);
  expectedevents.add(EventType.ELECTED_COMPLETE);
  Assert.assertEquals("Events has failed to executed in the order",expectedevents,events);
  electionSupport2.stop();
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNodes100() throws IOException, InterruptedException, KeeperException {
  int testIterations=100;
  final CountDownLatch latch=new CountDownLatch(testIterations);
  final AtomicInteger failureCounter=new AtomicInteger();
  for (int i=0; i < testIterations; i++) {
    runElectionSupportThread(latch,failureCounter);
  }
  Assert.assertEquals(0,failureCounter.get());
  if (!latch.await(20,TimeUnit.SECONDS)) {
    logger.info("Waited for all threads to start, but timed out. We had {} failures.",failureCounter);
  }
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNodes3() throws IOException, InterruptedException, KeeperException {
  int testIterations=3;
  final CountDownLatch latch=new CountDownLatch(testIterations);
  final AtomicInteger failureCounter=new AtomicInteger();
  for (int i=0; i < testIterations; i++) {
    runElectionSupportThread(latch,failureCounter);
  }
  Assert.assertEquals(0,failureCounter.get());
  if (!latch.await(10,TimeUnit.SECONDS)) {
    logger.info("Waited for all threads to start, but timed out. We had {} failures.",failureCounter);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.recipes.queue.DistributedQueueTest </h4><pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTakeWait1() throws Exception {
  String dir="/testTakeWait1";
  final String testString="Hello World";
  final int num_clients=1;
  final ZooKeeper clients[]=new ZooKeeper[num_clients];
  final DistributedQueue queueHandles[]=new DistributedQueue[num_clients];
  for (int i=0; i < clients.length; i++) {
    clients[i]=createClient();
    queueHandles[i]=new DistributedQueue(clients[i],dir,null);
  }
  final byte[] takeResult[]=new byte[1][];
  Thread takeThread=new Thread(){
    public void run(){
      try {
        takeResult[0]=queueHandles[0].take();
      }
 catch (      KeeperException e) {
      }
catch (      InterruptedException e) {
      }
    }
  }
;
  takeThread.start();
  Thread.sleep(1000);
  Thread offerThread=new Thread(){
    public void run(){
      try {
        queueHandles[0].offer(testString.getBytes());
      }
 catch (      KeeperException e) {
      }
catch (      InterruptedException e) {
      }
    }
  }
;
  offerThread.start();
  offerThread.join();
  takeThread.join();
  Assert.assertTrue(takeResult[0] != null);
  Assert.assertEquals(new String(takeResult[0]),testString);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOffer1() throws Exception {
  String dir="/testOffer1";
  String testString="Hello World";
  final int num_clients=1;
  ZooKeeper clients[]=new ZooKeeper[num_clients];
  DistributedQueue queueHandles[]=new DistributedQueue[num_clients];
  for (int i=0; i < clients.length; i++) {
    clients[i]=createClient();
    queueHandles[i]=new DistributedQueue(clients[i],dir,null);
  }
  queueHandles[0].offer(testString.getBytes());
  byte dequeuedBytes[]=queueHandles[0].remove();
  Assert.assertEquals(new String(dequeuedBytes),testString);
}

</code></pre>

<br>
<pre class="type-9 type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTakeWait2() throws Exception {
  String dir="/testTakeWait2";
  final String testString="Hello World";
  final int num_clients=1;
  final ZooKeeper clients[]=new ZooKeeper[num_clients];
  final DistributedQueue queueHandles[]=new DistributedQueue[num_clients];
  for (int i=0; i < clients.length; i++) {
    clients[i]=createClient();
    queueHandles[i]=new DistributedQueue(clients[i],dir,null);
  }
  int num_attempts=2;
  for (int i=0; i < num_attempts; i++) {
    final byte[] takeResult[]=new byte[1][];
    final String threadTestString=testString + i;
    Thread takeThread=new Thread(){
      public void run(){
        try {
          takeResult[0]=queueHandles[0].take();
        }
 catch (        KeeperException e) {
        }
catch (        InterruptedException e) {
        }
      }
    }
;
    takeThread.start();
    Thread.sleep(1000);
    Thread offerThread=new Thread(){
      public void run(){
        try {
          queueHandles[0].offer(threadTestString.getBytes());
        }
 catch (        KeeperException e) {
        }
catch (        InterruptedException e) {
        }
      }
    }
;
    offerThread.start();
    offerThread.join();
    takeThread.join();
    Assert.assertTrue(takeResult[0] != null);
    Assert.assertEquals(new String(takeResult[0]),threadTestString);
  }
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOffer2() throws Exception {
  String dir="/testOffer2";
  String testString="Hello World";
  final int num_clients=2;
  ZooKeeper clients[]=new ZooKeeper[num_clients];
  DistributedQueue queueHandles[]=new DistributedQueue[num_clients];
  for (int i=0; i < clients.length; i++) {
    clients[i]=createClient();
    queueHandles[i]=new DistributedQueue(clients[i],dir,null);
  }
  queueHandles[0].offer(testString.getBytes());
  byte dequeuedBytes[]=queueHandles[1].remove();
  Assert.assertEquals(new String(dequeuedBytes),testString);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTake1() throws Exception {
  String dir="/testTake1";
  String testString="Hello World";
  final int num_clients=1;
  ZooKeeper clients[]=new ZooKeeper[num_clients];
  DistributedQueue queueHandles[]=new DistributedQueue[num_clients];
  for (int i=0; i < clients.length; i++) {
    clients[i]=createClient();
    queueHandles[i]=new DistributedQueue(clients[i],dir,null);
  }
  queueHandles[0].offer(testString.getBytes());
  byte dequeuedBytes[]=queueHandles[0].take();
  Assert.assertEquals(new String(dequeuedBytes),testString);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.ByteBufferInputStreamTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNegativeSkip() throws Exception {
  in.read();
  assertEquals(0L,in.skip(-2L));
  assertEquals(DATA_BYTES[1],in.read());
  assertEquals(DATA_BYTES[2],in.read());
}

</code></pre>

<br>
<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadArray() throws Exception {
  byte[] expected=Arrays.copyOf(DATA_BYTES,4);
  assertEquals(4,in.read(bs));
  assertArrayEquals(expected,bs);
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testReadArrayOffsetLength_AtEndOfStream() throws Exception {
  for (int i=0; i < DATA_BYTES.length; i++) {
    in.read();
  }
  byte[] expected=Arrays.copyOf(bs,bs.length);
  assertEquals(-1,in.read(bs,2,2));
  assertArrayEquals(expected,bs);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadArrayOffsetLength() throws Exception {
  assertEquals(1,in.read(bs,2,1));
  byte[] expected=new byte[]{(byte)1,(byte)2,DATA_BYTES[0],(byte)4};
  assertArrayEquals(expected,bs);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testReadArrayOffsetLength_HitEndOfStream() throws Exception {
  for (int i=0; i < DATA_BYTES.length - 1; i++) {
    in.read();
  }
  assertEquals(1,in.read(bs,2,2));
  byte[] expected=new byte[]{(byte)1,(byte)2,DATA_BYTES[DATA_BYTES.length - 1],(byte)4};
  assertArrayEquals(expected,bs);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkip2() throws Exception {
  for (int i=0; i < DATA_BYTES.length / 2; i++) {
    in.read();
  }
  long skipAmount=DATA_BYTES.length / 4;
  assertEquals(skipAmount,in.skip(skipAmount));
  int idx=DATA_BYTES.length / 2 + (int)skipAmount;
  assertEquals(DATA_BYTES[idx++],in.read());
  assertEquals(DATA_BYTES[idx++],in.read());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkip_HitEnd() throws Exception {
  for (int i=0; i < DATA_BYTES.length - 1; i++) {
    in.read();
  }
  assertEquals(1L,in.skip(2L));
  assertEquals(-1,in.read());
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRead() throws Exception {
  for (int i=0; i < DATA_BYTES.length; i++) {
    int b=in.read();
    assertEquals(DATA_BYTES[i],(byte)b);
  }
  assertEquals(-1,in.read());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkip() throws Exception {
  in.read();
  assertEquals(2L,in.skip(2L));
  assertEquals(DATA_BYTES[3],in.read());
  assertEquals(DATA_BYTES[4],in.read());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkip_AtEnd() throws Exception {
  for (int i=0; i < DATA_BYTES.length; i++) {
    in.read();
  }
  assertEquals(0L,in.skip(2L));
  assertEquals(-1,in.read());
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testAvailable() throws Exception {
  for (int i=DATA_BYTES.length; i > 0; i--) {
    assertEquals(i,in.available());
    in.read();
  }
  assertEquals(0,in.available());
}

</code></pre>

<br>
<pre class="type-5 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testReadArrayOffsetLength_0Length() throws Exception {
  byte[] expected=Arrays.copyOf(bs,bs.length);
  assertEquals(0,in.read(bs,2,0));
  assertArrayEquals(expected,bs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.CreateContainerTest </h4><pre class="type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testMultiWithContainer() throws IOException, KeeperException, InterruptedException {
  Op createContainer=Op.create("/foo",new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.CONTAINER);
  Op createChild=Op.create("/foo/bar",new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.multi(Arrays.asList(createContainer,createChild));
  DataTree dataTree=serverFactory.getZooKeeperServer().getZKDatabase().getDataTree();
  Assert.assertEquals(dataTree.getContainers().size(),1);
  zk.delete("/foo/bar",-1);
  ContainerManager containerManager=new ContainerManager(serverFactory.getZooKeeperServer().getZKDatabase(),serverFactory.getZooKeeperServer().firstProcessor,1,100);
  containerManager.checkContainers();
  Thread.sleep(1000);
  Assert.assertNull("Container should have been deleted",zk.exists("/foo",false));
  createContainer=Op.create("/foo",new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.CONTAINER);
  createChild=Op.create("/foo/bar",new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Op deleteChild=Op.delete("/foo/bar",-1);
  zk.multi(Arrays.asList(createContainer,createChild,deleteChild));
  containerManager.checkContainers();
  Thread.sleep(1000);
  Assert.assertNull("Container should have been deleted",zk.exists("/foo",false));
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=30000) public void testMultiWithContainerSimple() throws IOException, KeeperException, InterruptedException {
  Op createContainer=Op.create("/foo",new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.CONTAINER);
  zk.multi(Collections.singletonList(createContainer));
  DataTree dataTree=serverFactory.getZooKeeperServer().getZKDatabase().getDataTree();
  Assert.assertEquals(dataTree.getContainers().size(),1);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=30000) public void testMaxPerMinute() throws IOException, KeeperException, InterruptedException {
  final BlockingQueue<String> queue=new LinkedBlockingQueue<String>();
  RequestProcessor processor=new RequestProcessor(){
    @Override public void processRequest(    Request request) throws RequestProcessorException {
      queue.add(new String(request.request.array()));
    }
    @Override public void shutdown(){
    }
  }
;
  final ContainerManager containerManager=new ContainerManager(serverFactory.getZooKeeperServer().getZKDatabase(),processor,1,2){
    @Override protected long getMinIntervalMs(){
      return 1000;
    }
    @Override protected Collection<String> getCandidates(){
      return Arrays.asList("/one","/two","/three","/four");
    }
  }
;
  Executors.newSingleThreadExecutor().submit(new Callable<Void>(){
    @Override public Void call() throws Exception {
      containerManager.checkContainers();
      return null;
    }
  }
);
  Assert.assertEquals(queue.poll(5,TimeUnit.SECONDS),"/one");
  Assert.assertEquals(queue.poll(5,TimeUnit.SECONDS),"/two");
  Assert.assertEquals(queue.size(),0);
  Thread.sleep(500);
  Assert.assertEquals(queue.size(),0);
  Assert.assertEquals(queue.poll(5,TimeUnit.SECONDS),"/three");
  Assert.assertEquals(queue.poll(5,TimeUnit.SECONDS),"/four");
}

</code></pre>

<br>
<pre class="type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void testSimpleDeletionAsync() throws IOException, KeeperException, InterruptedException {
  final CountDownLatch latch=new CountDownLatch(1);
  AsyncCallback.Create2Callback cb=new AsyncCallback.Create2Callback(){
    @Override public void processResult(    int rc,    String path,    Object ctx,    String name,    Stat stat){
      Assert.assertEquals(ctx,"context");
      latch.countDown();
    }
  }
;
  zk.create("/foo",new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.CONTAINER,cb,"context");
  Assert.assertTrue(latch.await(5,TimeUnit.SECONDS));
  zk.create("/foo/bar",new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.delete("/foo/bar",-1);
  ContainerManager containerManager=new ContainerManager(serverFactory.getZooKeeperServer().getZKDatabase(),serverFactory.getZooKeeperServer().firstProcessor,1,100);
  containerManager.checkContainers();
  Thread.sleep(1000);
  Assert.assertNull("Container should have been deleted",zk.exists("/foo",false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.DataTreeTest </h4><pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=60000) public void testPathTrieClearOnDeserialize() throws Exception {
  DataTree dserTree=new DataTree();
  dserTree.createNode("/bug",new byte[20],null,-1,1,1,1);
  dserTree.createNode(Quotas.quotaZookeeper + "/bug",null,null,-1,1,1,1);
  dserTree.createNode(Quotas.quotaPath("/bug"),new byte[20],null,-1,1,1,1);
  dserTree.createNode(Quotas.statPath("/bug"),new byte[20],null,-1,1,1,1);
  DataTree tree=new DataTree();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  BinaryOutputArchive oa=BinaryOutputArchive.getArchive(baos);
  tree.serialize(oa,"test");
  baos.flush();
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  BinaryInputArchive ia=BinaryInputArchive.getArchive(bais);
  dserTree.deserialize(ia,"test");
  Field pfield=DataTree.class.getDeclaredField("pTrie");
  pfield.setAccessible(true);
  PathTrie pTrie=(PathTrie)pfield.get(dserTree);
  Assert.assertEquals("/bug is still in pTrie","",pTrie.findMaxPrefix("/bug"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.DatadirCleanupManagerTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPurgeTask() throws Exception {
  purgeMgr=new DatadirCleanupManager(snapDir,dataLogDir,3,1);
  purgeMgr.start();
  Assert.assertEquals("Data log directory is not set as configured",dataLogDir,purgeMgr.getDataLogDir());
  Assert.assertEquals("Snapshot directory is not set as configured",snapDir,purgeMgr.getSnapDir());
  Assert.assertEquals("Snapshot retain count is not set as configured",3,purgeMgr.getSnapRetainCount());
  Assert.assertEquals("Purge task is not started",STARTED,purgeMgr.getPurgeTaskStatus());
  purgeMgr.shutdown();
  Assert.assertEquals("Purge task is still running after shutdown",COMPLETED,purgeMgr.getPurgeTaskStatus());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWithZeroPurgeInterval() throws Exception {
  purgeMgr=new DatadirCleanupManager(snapDir,dataLogDir,3,0);
  purgeMgr.start();
  Assert.assertEquals("Purge task is scheduled with zero purge interval",NOT_STARTED,purgeMgr.getPurgeTaskStatus());
  purgeMgr.shutdown();
  Assert.assertEquals("Purge task is scheduled with zero purge interval",NOT_STARTED,purgeMgr.getPurgeTaskStatus());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWithNegativePurgeInterval() throws Exception {
  purgeMgr=new DatadirCleanupManager(snapDir,dataLogDir,3,-1);
  purgeMgr.start();
  Assert.assertEquals("Purge task is scheduled with negative purge interval",NOT_STARTED,purgeMgr.getPurgeTaskStatus());
  purgeMgr.shutdown();
  Assert.assertEquals("Purge task is scheduled with negative purge interval",NOT_STARTED,purgeMgr.getPurgeTaskStatus());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.InvalidSnapCountTest </h4><pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify the ability to start a standalone server instance.
 */
@Test public void testInvalidSnapCount() throws Exception {
  final int CLIENT_PORT=3181;
  MainThread main=new MainThread(CLIENT_PORT);
  main.start();
  Assert.assertTrue("waiting for server being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT,CONNECTION_TIMEOUT));
  Assert.assertEquals(SyncRequestProcessor.getSnapCount(),2);
  main.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.NettyServerCnxnTest </h4><pre class="type-9 type-10 type-3 type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies the channel closure - while closing the channel
 * servercnxnfactory should remove all channel references to avoid
 * duplicate channel closure. Duplicate closure may result in indefinite
 * hanging due to netty open issue.
 * @see <a href="https://issues.jboss.org/browse/NETTY-412">NETTY-412</a>
 */
@Test(timeout=40000) public void testSendCloseSession() throws Exception {
  Assert.assertTrue("Didn't instantiate ServerCnxnFactory with NettyServerCnxnFactory!",serverFactory instanceof NettyServerCnxnFactory);
  final ZooKeeper zk=createClient();
  final String path="/a";
  try {
    zk.create(path,"test".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    Assert.assertNotNull("Didn't create znode:" + path,zk.exists(path,false));
    Iterable<ServerCnxn> connections=serverFactory.getConnections();
    Assert.assertEquals("Mismatch in number of live connections!",1,serverFactory.getNumAliveConnections());
    for (    ServerCnxn serverCnxn : connections) {
      serverCnxn.sendCloseSession();
    }
    LOG.info("Waiting for the channel disconnected event");
    int timeout=0;
    while (serverFactory.getNumAliveConnections() != 0) {
      Thread.sleep(1000);
      timeout+=1000;
      if (timeout > CONNECTION_TIMEOUT) {
        Assert.fail("The number of live connections should be 0");
      }
    }
  }
  finally {
    zk.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.PrepRequestProcessorTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * It tests that PrepRequestProcessor will return BadArgument KeeperException
 * if the request path (if it exists) is not valid, e.g. empty string.
 */
@Test public void testInvalidPath() throws Exception {
  pLatch=new CountDownLatch(1);
  processor=new PrepRequestProcessor(zks,new MyRequestProcessor());
  SetDataRequest record=new SetDataRequest("",new byte[0],-1);
  Request req=createRequest(record,OpCode.setData);
  processor.pRequest(req);
  pLatch.await();
  Assert.assertEquals(outcome.getHdr().getType(),OpCode.error);
  Assert.assertEquals(outcome.getException().code(),KeeperException.Code.BADARGUMENTS);
}

</code></pre>

<br>
<pre class="type-6 type-8 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks that a successful multi will change outstanding record
 * and failed multi shouldn't change outstanding record.
 */
@Test public void testMultiOutstandingChange() throws Exception {
  zks.getZKDatabase().dataTree.createNode("/foo",new byte[0],Ids.OPEN_ACL_UNSAFE,0,0,0,0);
  Assert.assertNull(zks.outstandingChangesForPath.get("/foo"));
  process(Arrays.asList(Op.setData("/foo",new byte[0],-1)));
  ChangeRecord cr=zks.outstandingChangesForPath.get("/foo");
  Assert.assertNotNull("Change record wasn't set",cr);
  Assert.assertEquals("Record zxid wasn't set correctly",1,cr.zxid);
  process(Arrays.asList(Op.delete("/foo",-1)));
  cr=zks.outstandingChangesForPath.get("/foo");
  Assert.assertEquals("Record zxid wasn't set correctly",2,cr.zxid);
  process(Arrays.asList(Op.delete("/foo",-1)));
  cr=zks.outstandingChangesForPath.get("/foo");
  Assert.assertEquals("Record zxid wasn't set correctly",2,cr.zxid);
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPRequest() throws Exception {
  pLatch=new CountDownLatch(1);
  processor=new PrepRequestProcessor(zks,new MyRequestProcessor());
  Request foo=new Request(null,1l,1,OpCode.create,ByteBuffer.allocate(3),null);
  processor.pRequest(foo);
  Assert.assertEquals("Request should have marshalling error",new ErrorTxn(KeeperException.Code.MARSHALLINGERROR.intValue()),outcome.getTxn());
  Assert.assertTrue("request hasn't been processed in chain",pLatch.await(5,TimeUnit.SECONDS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.PurgeTxnTest </h4><pre class="type-9 type-5 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests finding n recent snapshots from set of snapshots and data logs
 */
@Test public void testFindNRecentSnapshots() throws Exception {
  int nRecentSnap=4;
  int nRecentCount=30;
  int offset=0;
  tmpDir=ClientBase.createTmpDir();
  File version2=new File(tmpDir.toString(),"version-2");
  Assert.assertTrue("Failed to create version_2 dir:" + version2.toString(),version2.mkdir());
  List<File> expectedNRecentSnapFiles=new ArrayList<File>();
  int counter=offset + (2 * nRecentCount);
  for (int i=0; i < nRecentCount; i++) {
    File logFile=new File(version2 + "/log." + Long.toHexString(--counter));
    Assert.assertTrue("Failed to create log File:" + logFile.toString(),logFile.createNewFile());
    File snapFile=new File(version2 + "/snapshot." + Long.toHexString(--counter));
    Assert.assertTrue("Failed to create snap File:" + snapFile.toString(),snapFile.createNewFile());
    if (i < nRecentSnap) {
      expectedNRecentSnapFiles.add(snapFile);
    }
  }
  FileTxnSnapLog txnLog=new FileTxnSnapLog(tmpDir,tmpDir);
  List<File> nRecentSnapFiles=txnLog.findNRecentSnapshots(nRecentSnap);
  txnLog.close();
  Assert.assertEquals("exactly 4 snapshots ",4,nRecentSnapFiles.size());
  expectedNRecentSnapFiles.removeAll(nRecentSnapFiles);
  Assert.assertEquals("Didn't get the recent snap files",0,expectedNRecentSnapFiles.size());
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * PurgeTxnLog is called with dataLogDir snapDir -n count This test case
 * verify these values are parsed properly and functionality works fine
 */
@Test public void testPurgeTxnLogWithDataDir() throws Exception {
  tmpDir=ClientBase.createTmpDir();
  File dataDir=new File(tmpDir,"dataDir");
  File dataLogDir=new File(tmpDir,"dataLogDir");
  File dataDirVersion2=new File(dataDir,"version-2");
  dataDirVersion2.mkdirs();
  File dataLogDirVersion2=new File(dataLogDir,"version-2");
  dataLogDirVersion2.mkdirs();
  int totalFiles=20;
  for (int i=0; i < totalFiles; i++) {
    File logFile=new File(dataLogDirVersion2,"log." + Long.toHexString(i));
    logFile.createNewFile();
    File snapFile=new File(dataDirVersion2,"snapshot." + Long.toHexString(i));
    snapFile.createNewFile();
  }
  int numberOfFilesToKeep=10;
  String[] args=new String[]{dataLogDir.getAbsolutePath(),dataDir.getAbsolutePath(),"-n",Integer.toString(numberOfFilesToKeep)};
  PurgeTxnLog.main(args);
  assertEquals(numberOfFilesToKeep,dataDirVersion2.listFiles().length);
  assertEquals(numberOfFilesToKeep,dataLogDirVersion2.listFiles().length);
  ClientBase.recursiveDelete(tmpDir);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * PurgeTxnLog is called with dataLogDir -n count This test case verify
 * these values are parsed properly and functionality works fine
 */
@Test public void testPurgeTxnLogWithoutDataDir() throws Exception {
  tmpDir=ClientBase.createTmpDir();
  File dataDir=new File(tmpDir,"dataDir");
  File dataLogDir=new File(tmpDir,"dataLogDir");
  File dataDirVersion2=new File(dataDir,"version-2");
  dataDirVersion2.mkdirs();
  File dataLogDirVersion2=new File(dataLogDir,"version-2");
  dataLogDirVersion2.mkdirs();
  int totalFiles=20;
  for (int i=0; i < totalFiles; i++) {
    File logFile=new File(dataLogDirVersion2,"log." + Long.toHexString(i));
    logFile.createNewFile();
    File snapFile=new File(dataLogDirVersion2,"snapshot." + Long.toHexString(i));
    snapFile.createNewFile();
  }
  int numberOfFilesToKeep=10;
  String[] args=new String[]{dataLogDir.getAbsolutePath(),"-n",Integer.toString(numberOfFilesToKeep)};
  PurgeTxnLog.main(args);
  assertEquals(numberOfFilesToKeep + numberOfFilesToKeep,dataLogDirVersion2.listFiles().length);
  ClientBase.recursiveDelete(tmpDir);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.SessionTrackerTest </h4><pre class="type-5 type-3 type-2 type-6 type-8 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify the create session call in the Leader.FinalRequestProcessor after
 * the session expiration.
 */
@Test(timeout=20000) public void testAddSessionAfterSessionExpiry() throws Exception {
  ZooKeeperServer zks=setupSessionTracker();
  latch=new CountDownLatch(1);
  zks.sessionTracker.addSession(sessionId,sessionTimeout);
  SessionTrackerImpl sessionTrackerImpl=(SessionTrackerImpl)zks.sessionTracker;
  SessionImpl sessionImpl=sessionTrackerImpl.sessionsById.get(sessionId);
  Assert.assertNotNull("Sessionid:" + sessionId + " doesn't exists in sessiontracker",sessionImpl);
  Object sessionOwner=new Object();
  sessionTrackerImpl.checkSession(sessionId,sessionOwner);
  latch.await(sessionTimeout * 2,TimeUnit.MILLISECONDS);
  sessionTrackerImpl.addSession(sessionId,sessionTimeout);
  try {
    sessionTrackerImpl.checkSession(sessionId,sessionOwner);
    Assert.fail("Should throw session expiry exception " + "as the session has expired and closed");
  }
 catch (  KeeperException.SessionExpiredException e) {
  }
  Assert.assertTrue("Session didn't expired",sessionImpl.isClosing());
  Assert.assertFalse("Session didn't expired",sessionTrackerImpl.touchSession(sessionId,sessionTimeout));
  Assert.assertEquals("Duplicate session expiry request has been generated",1,firstProcessor.getCountOfCloseSessionReq());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.WatchesPathReportTest </h4><pre class="type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSessions(){
  Set<Long> s=r.getSessions("path1");
  assertEquals(2,s.size());
  assertTrue(s.contains(101L));
  assertTrue(s.contains(102L));
  s=r.getSessions("path2");
  assertEquals(1,s.size());
  assertTrue(s.contains(201L));
  assertNull(r.getSessions("path3"));
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToMap(){
  assertEquals(m,r.toMap());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.WatchesReportTest </h4><pre class="type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPaths(){
  Set<String> s=r.getPaths(1L);
  assertEquals(2,s.size());
  assertTrue(s.contains("path1a"));
  assertTrue(s.contains("path1b"));
  s=r.getPaths(2L);
  assertEquals(1,s.size());
  assertTrue(s.contains("path2a"));
  assertNull(r.getPaths(3L));
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToMap(){
  assertEquals(m,r.toMap());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.WatchesSummaryTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetters(){
  assertEquals(1,s.getNumConnections());
  assertEquals(2,s.getNumPaths());
  assertEquals(3,s.getTotalWatches());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToMap(){
  Map<String,Object> m=s.toMap();
  assertEquals(3,m.size());
  assertEquals(Integer.valueOf(1),m.get(WatchesSummary.KEY_NUM_CONNECTIONS));
  assertEquals(Integer.valueOf(2),m.get(WatchesSummary.KEY_NUM_PATHS));
  assertEquals(Integer.valueOf(3),m.get(WatchesSummary.KEY_NUM_TOTAL_WATCHES));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.ZooKeeperServerBeanTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSecureClientPort() throws IOException {
  ZooKeeperServer zks=new ZooKeeperServer();
  ZooKeeperServerBean serverBean=new ZooKeeperServerBean(zks);
  String result=serverBean.getSecureClientPort();
  assertEquals("",result);
  ServerCnxnFactory cnxnFactory=ServerCnxnFactory.createFactory();
  int secureClientPort=8443;
  InetSocketAddress address=new InetSocketAddress(secureClientPort);
  cnxnFactory.configure(address,5,true);
  zks.setSecureServerCnxnFactory(cnxnFactory);
  result=serverBean.getSecureClientPort();
  assertEquals(Integer.toString(secureClientPort),result);
  cnxnFactory.shutdown();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSecureClientAddress() throws IOException {
  ZooKeeperServer zks=new ZooKeeperServer();
  ZooKeeperServerBean serverBean=new ZooKeeperServerBean(zks);
  String result=serverBean.getSecureClientPort();
  assertEquals("",result);
  ServerCnxnFactory cnxnFactory=ServerCnxnFactory.createFactory();
  int secureClientPort=8443;
  InetSocketAddress address=new InetSocketAddress(secureClientPort);
  cnxnFactory.configure(address,5,true);
  zks.setSecureServerCnxnFactory(cnxnFactory);
  result=serverBean.getSecureClientAddress();
  String ipv4="0.0.0.0:" + secureClientPort;
  String ipv6="0:0:0:0:0:0:0:0:" + secureClientPort;
  assertTrue(result.equals(ipv4) || result.equals(ipv6));
  cnxnFactory.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.ZooKeeperServerConfTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetters(){
  assertEquals(1,c.getClientPort());
  assertEquals("a",c.getDataDir());
  assertEquals("b",c.getDataLogDir());
  assertEquals(2,c.getTickTime());
  assertEquals(3,c.getMaxClientCnxnsPerHost());
  assertEquals(4,c.getMinSessionTimeout());
  assertEquals(5,c.getMaxSessionTimeout());
  assertEquals(6L,c.getServerId());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToMap(){
  Map<String,Object> m=c.toMap();
  assertEquals(8,m.size());
  assertEquals(Integer.valueOf(1),m.get(ZooKeeperServerConf.KEY_CLIENT_PORT));
  assertEquals("a",m.get(ZooKeeperServerConf.KEY_DATA_DIR));
  assertEquals("b",m.get(ZooKeeperServerConf.KEY_DATA_LOG_DIR));
  assertEquals(Integer.valueOf(2),m.get(ZooKeeperServerConf.KEY_TICK_TIME));
  assertEquals(Integer.valueOf(3),m.get(ZooKeeperServerConf.KEY_MAX_CLIENT_CNXNS));
  assertEquals(Integer.valueOf(4),m.get(ZooKeeperServerConf.KEY_MIN_SESSION_TIMEOUT));
  assertEquals(Integer.valueOf(5),m.get(ZooKeeperServerConf.KEY_MAX_SESSION_TIMEOUT));
  assertEquals(Long.valueOf(6L),m.get(ZooKeeperServerConf.KEY_SERVER_ID));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.ZooKeeperServerMainTest </h4><pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify the ability to start a standalone server instance.
 */
@Test public void testStandalone() throws Exception {
  ClientBase.setupTestEnv();
  final int CLIENT_PORT=PortAssignment.unique();
  MainThread main=new MainThread(CLIENT_PORT,true,null);
  main.start();
  Assert.assertTrue("waiting for server being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT,CONNECTION_TIMEOUT));
  ZooKeeper zk=new ZooKeeper("127.0.0.1:" + CLIENT_PORT,ClientBase.CONNECTION_TIMEOUT,this);
  zk.create("/foo","foobar".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertEquals(new String(zk.getData("/foo",null,null)),"foobar");
  zk.close();
  main.shutdown();
  main.join();
  main.deleteDirs();
  Assert.assertTrue("waiting for server down",ClientBase.waitForServerDown("127.0.0.1:" + CLIENT_PORT,ClientBase.CONNECTION_TIMEOUT));
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies the auto creation of data dir and data log dir.
 * Sets "zookeeper.datadir.autocreate" to true.
 */
@Test(timeout=30000) public void testWithAutoCreateDataLogDir() throws Exception {
  ClientBase.setupTestEnv();
  System.setProperty(FileTxnSnapLog.ZOOKEEPER_DATADIR_AUTOCREATE,"true");
  final int CLIENT_PORT=PortAssignment.unique();
  MainThread main=new MainThread(CLIENT_PORT,false,null);
  String args[]=new String[1];
  args[0]=main.confFile.toString();
  main.start();
  Assert.assertTrue("waiting for server being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT,CONNECTION_TIMEOUT));
  ZooKeeper zk=new ZooKeeper("127.0.0.1:" + CLIENT_PORT,ClientBase.CONNECTION_TIMEOUT,this);
  zk.create("/foo","foobar".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertEquals(new String(zk.getData("/foo",null,null)),"foobar");
  zk.close();
  main.shutdown();
  main.join();
  main.deleteDirs();
  Assert.assertTrue("waiting for server down",ClientBase.waitForServerDown("127.0.0.1:" + CLIENT_PORT,ClientBase.CONNECTION_TIMEOUT));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.ZooKeeperServerTest </h4><pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetLogFiles(){
  File[] files=new File[5];
  files[0]=new File("log.10027c6de");
  files[1]=new File("log.10027c6df");
  files[2]=new File("snapshot.10027c6dd");
  files[3]=new File("log.10027c6dc");
  files[4]=new File("log.20027c6dc");
  File[] orig=files.clone();
  File[] filelist=FileTxnLog.getLogFiles(files,Long.parseLong("10027c6de",16));
  Assert.assertEquals(3,filelist.length);
  Assert.assertEquals(orig[0],filelist[0]);
  Assert.assertEquals(orig[1],filelist[1]);
  Assert.assertEquals(orig[4],filelist[2]);
}

</code></pre>

<br>
<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortDataDirAscending(){
  File[] files=new File[5];
  files[0]=new File("foo.10027c6de");
  files[1]=new File("foo.10027c6df");
  files[2]=new File("bar.10027c6dd");
  files[3]=new File("foo.10027c6dc");
  files[4]=new File("foo.20027c6dc");
  File[] orig=files.clone();
  List<File> filelist=Util.sortDataDir(files,"foo",true);
  Assert.assertEquals(orig[2],filelist.get(0));
  Assert.assertEquals(orig[3],filelist.get(1));
  Assert.assertEquals(orig[0],filelist.get(2));
  Assert.assertEquals(orig[1],filelist.get(3));
  Assert.assertEquals(orig[4],filelist.get(4));
}

</code></pre>

<br>
<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSortDataDirDescending(){
  File[] files=new File[5];
  files[0]=new File("foo.10027c6de");
  files[1]=new File("foo.10027c6df");
  files[2]=new File("bar.10027c6dd");
  files[3]=new File("foo.10027c6dc");
  files[4]=new File("foo.20027c6dc");
  File[] orig=files.clone();
  List<File> filelist=Util.sortDataDir(files,"foo",false);
  Assert.assertEquals(orig[4],filelist.get(0));
  Assert.assertEquals(orig[1],filelist.get(1));
  Assert.assertEquals(orig[0],filelist.get(2));
  Assert.assertEquals(orig[3],filelist.get(3));
  Assert.assertEquals(orig[2],filelist.get(4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.admin.CommandResponseTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMap(){
  r.put("missing","sudo");
  Map<String,Object> m=new HashMap<String,Object>();
  m.put("origin","xkcd");
  m.put("url","http://xkcd.com/149/");
  r.putAll(m);
  Map<String,Object> rmap=r.toMap();
  assertEquals(5,rmap.size());
  assertEquals("makemeasandwich",rmap.get(CommandResponse.KEY_COMMAND));
  assertEquals("makeityourself",rmap.get(CommandResponse.KEY_ERROR));
  assertEquals("sudo",rmap.get("missing"));
  assertEquals("xkcd",rmap.get("origin"));
  assertEquals("http://xkcd.com/149/",rmap.get("url"));
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetters(){
  assertEquals("makemeasandwich",r.getCommand());
  assertEquals("makeityourself",r.getError());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.jersey.CreateTest </h4><pre class="type-5 type-10 type-2 type-6 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate() throws Exception {
  WebResource wr=znodesr.path(path).queryParam("dataformat",encoding).queryParam("name",name);
  if (data == null) {
    wr=wr.queryParam("null","true");
  }
  if (sequence) {
    wr=wr.queryParam("sequence","true");
  }
  Builder builder=wr.accept(accept);
  ClientResponse cr;
  if (data == null) {
    cr=builder.post(ClientResponse.class);
  }
 else {
    cr=builder.post(ClientResponse.class,data);
  }
  Assert.assertEquals(expectedStatus,cr.getClientResponseStatus());
  if (expectedPath == null) {
    return;
  }
  ZPath zpath=cr.getEntity(ZPath.class);
  if (sequence) {
    Assert.assertTrue(zpath.path.startsWith(expectedPath.path));
    Assert.assertTrue(zpath.uri.startsWith(znodesr.path(path).toString()));
  }
 else {
    Assert.assertEquals(expectedPath,zpath);
    Assert.assertEquals(znodesr.path(path).toString(),zpath.uri);
  }
  byte[] data=zk.getData(zpath.path,false,new Stat());
  if (data == null && this.data == null) {
    return;
  }
 else   if (data == null || this.data == null) {
    Assert.assertEquals(data,this.data);
  }
 else {
    Assert.assertTrue(new String(data) + " == " + new String(this.data),Arrays.equals(data,this.data));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.jersey.GetChildrenTest </h4><pre class="type-5 type-10 type-3 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetChildren() throws Exception {
  if (expectedChildren != null) {
    for (    String child : expectedChildren) {
      zk.create(expectedPath + "/" + child,null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    }
  }
  ClientResponse cr=znodesr.path(path).queryParam("view","children").accept(accept).get(ClientResponse.class);
  Assert.assertEquals(expectedStatus,cr.getClientResponseStatus());
  if (expectedChildren == null) {
    return;
  }
  if (accept.equals(MediaType.APPLICATION_JSON)) {
    ZChildrenJSON zchildren=cr.getEntity(ZChildrenJSON.class);
    Collections.sort(expectedChildren);
    Collections.sort(zchildren.children);
    Assert.assertEquals(expectedChildren,zchildren.children);
    Assert.assertEquals(znodesr.path(path).toString(),zchildren.uri);
    Assert.assertEquals(znodesr.path(path).toString() + "/{child}",zchildren.child_uri_template);
  }
 else   if (accept.equals(MediaType.APPLICATION_XML)) {
    ZChildren zchildren=cr.getEntity(ZChildren.class);
    Collections.sort(expectedChildren);
    Collections.sort(zchildren.children);
    Assert.assertEquals(expectedChildren,zchildren.children);
    Assert.assertEquals(znodesr.path(path).toString(),zchildren.uri);
    Assert.assertEquals(znodesr.path(path).toString() + "/{child}",zchildren.child_uri_template);
  }
 else {
    Assert.fail("unknown accept type");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.jersey.GetTest </h4><pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGet() throws Exception {
  if (expectedStat != null) {
    if (expectedStat.data64 != null || expectedStat.dataUtf8 == null) {
      zk.setData(expectedStat.path,expectedStat.data64,-1);
    }
 else {
      zk.setData(expectedStat.path,expectedStat.dataUtf8.getBytes(),-1);
    }
  }
  ClientResponse cr=znodesr.path(path).queryParam("dataformat",encoding).accept(accept).get(ClientResponse.class);
  Assert.assertEquals(expectedStatus,cr.getClientResponseStatus());
  if (expectedStat == null) {
    return;
  }
  ZStat zstat=cr.getEntity(ZStat.class);
  Assert.assertEquals(expectedStat,zstat);
  Assert.assertEquals(znodesr.path(path).toString(),zstat.uri);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.jersey.RootTest </h4><pre class="type-5 type-2 type-6 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreate() throws Exception {
  String path="/";
  String name="roottest-create";
  byte[] data="foo".getBytes();
  WebResource wr=znodesr.path(path).queryParam("dataformat","utf8").queryParam("name",name);
  Builder builder=wr.accept(MediaType.APPLICATION_JSON);
  ClientResponse cr;
  cr=builder.post(ClientResponse.class,data);
  Assert.assertEquals(ClientResponse.Status.CREATED,cr.getClientResponseStatus());
  ZPath zpath=cr.getEntity(ZPath.class);
  Assert.assertEquals(new ZPath(path + name),zpath);
  Assert.assertEquals(znodesr.path(path).toString(),zpath.uri);
  byte[] rdata=zk.getData(zpath.path,false,new Stat());
  Assert.assertTrue(new String(rdata) + " == " + new String(data),Arrays.equals(rdata,data));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.jersey.SessionTest </h4><pre class="type-2 type-6 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteSession(){
  ZSession session=createSession("30");
  WebResource wr=sessionsr.path(session.id);
  Builder b=wr.accept(MediaType.APPLICATION_JSON);
  Assert.assertTrue(ZooKeeperService.isConnected(CONTEXT_PATH,session.id));
  ClientResponse cr=b.delete(ClientResponse.class,null);
  Assert.assertEquals(ClientResponse.Status.NO_CONTENT,cr.getClientResponseStatus());
  Assert.assertFalse(ZooKeeperService.isConnected(CONTEXT_PATH,session.id));
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSendHeartbeat() throws InterruptedException {
  ZSession session=createSession("2");
  Thread.sleep(1000);
  WebResource wr=sessionsr.path(session.id);
  Builder b=wr.accept(MediaType.APPLICATION_JSON);
  ClientResponse cr=b.put(ClientResponse.class,null);
  Assert.assertEquals(ClientResponse.Status.OK,cr.getClientResponseStatus());
  Thread.sleep(1500);
  Assert.assertTrue(ZooKeeperService.isConnected(CONTEXT_PATH,session.id));
  Thread.sleep(1000);
  Assert.assertFalse(ZooKeeperService.isConnected(CONTEXT_PATH,session.id));
}

</code></pre>

<br>
<pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateNewSession() throws JSONException {
  ZSession session=createSession();
  Assert.assertEquals(session.id.length(),36);
  Assert.assertTrue(ZooKeeperService.isConnected(CONTEXT_PATH,session.id));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCreateEphemeralZNode() throws KeeperException, InterruptedException, IOException {
  ZSession session=createSession("30");
  WebResource wr=znodesr.path("/").queryParam("op","create").queryParam("name","ephemeral-test").queryParam("ephemeral","true").queryParam("session",session.id).queryParam("null","true");
  Builder b=wr.accept(MediaType.APPLICATION_JSON);
  ClientResponse cr=b.post(ClientResponse.class);
  Assert.assertEquals(ClientResponse.Status.CREATED,cr.getClientResponseStatus());
  Stat stat=new Stat();
  zk.getData("/ephemeral-test",false,stat);
  ZooKeeper sessionZK=ZooKeeperService.getClient(CONTEXT_PATH,session.id);
  Assert.assertEquals(stat.getEphemeralOwner(),sessionZK.getSessionId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.jersey.SetTest </h4><pre class="type-5 type-10 type-3 type-2 type-6 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSet() throws Exception {
  if (expectedStat != null) {
    zk.create(expectedStat.path,"initial".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  }
  WebResource wr=znodesr.path(path).queryParam("dataformat",encoding);
  if (data == null) {
    wr=wr.queryParam("null","true");
  }
  Builder builder=wr.accept(accept).type(MediaType.APPLICATION_OCTET_STREAM);
  ClientResponse cr;
  if (data == null) {
    cr=builder.put(ClientResponse.class);
  }
 else {
    cr=builder.put(ClientResponse.class,new String(data));
  }
  Assert.assertEquals(expectedStatus,cr.getClientResponseStatus());
  if (expectedStat == null) {
    return;
  }
  ZStat zstat=cr.getEntity(ZStat.class);
  Assert.assertEquals(expectedStat,zstat);
  byte[] data=zk.getData(zstat.path,false,new Stat());
  if (data == null && this.data == null) {
    return;
  }
 else   if (data == null || this.data == null) {
    Assert.fail((data == null ? null : new String(data)) + " == " + (this.data == null ? null : new String(this.data)));
  }
 else {
    Assert.assertTrue(new String(data) + " == " + new String(this.data),Arrays.equals(data,this.data));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.LearnerHandlerTest </h4><pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test cases when learner has new-epcoh zxid
 * (zxid & 0xffffffffL) == 0;
 */
@Test public void testNewEpochZxidWithTxnlogOnly() throws Exception {
  long peerZxid;
  db.txnLog.add(createProposal(getZxid(1,1)));
  db.txnLog.add(createProposal(getZxid(2,1)));
  db.txnLog.add(createProposal(getZxid(2,2)));
  db.txnLog.add(createProposal(getZxid(4,1)));
  db.lastProcessedZxid=getZxid(6,0);
  peerZxid=getZxid(3,0);
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,getZxid(6,0),getZxid(4,1));
  assertEquals(3,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{getZxid(4,1)});
  reset();
  peerZxid=getZxid(4,0);
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,getZxid(6,0),getZxid(4,1));
  assertEquals(3,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{getZxid(4,1)});
  reset();
  peerZxid=getZxid(5,0);
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,getZxid(6,0),getZxid(5,0));
  assertEquals(1,learnerHandler.getQueuedPackets().size());
  reset();
  peerZxid=getZxid(6,0);
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,getZxid(6,0),getZxid(6,0));
  assertEquals(1,learnerHandler.getQueuedPackets().size());
  reset();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test cases when leader has empty commitedLog
 */
@Test public void testEmptyCommittedLog() throws Exception {
  long peerZxid;
  peerZxid=3;
  db.lastProcessedZxid=1;
  db.committedLog.clear();
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.TRUNC,db.lastProcessedZxid,db.lastProcessedZxid);
  reset();
  peerZxid=1;
  db.lastProcessedZxid=1;
  db.committedLog.clear();
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,db.lastProcessedZxid,db.lastProcessedZxid);
  assertEquals(1,learnerHandler.getQueuedPackets().size());
  reset();
  peerZxid=0;
  db.setSnapshotSizeFactor(-1);
  db.lastProcessedZxid=1;
  db.committedLog.clear();
  assertTrue(learnerHandler.syncFollower(peerZxid,db,leader));
  assertEquals(0,learnerHandler.getQueuedPackets().size());
  reset();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test cases when txnlog is enabled
 */
@Test public void testTxnLog() throws Exception {
  long peerZxid;
  db.txnLog.add(createProposal(2));
  db.txnLog.add(createProposal(3));
  db.txnLog.add(createProposal(5));
  db.txnLog.add(createProposal(6));
  db.txnLog.add(createProposal(7));
  db.txnLog.add(createProposal(8));
  db.txnLog.add(createProposal(9));
  db.lastProcessedZxid=9;
  db.committedLog.add(createProposal(6));
  db.committedLog.add(createProposal(7));
  db.committedLog.add(createProposal(8));
  peerZxid=4;
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.TRUNC,3,db.getmaxCommittedLog());
  assertEquals(9,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{5,6,7,8});
  reset();
  peerZxid=3;
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,db.getmaxCommittedLog(),db.getmaxCommittedLog());
  assertEquals(9,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{5,6,7,8});
  reset();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test cases when peer has new-epoch zxid
 */
@Test public void testNewEpochZxid() throws Exception {
  long peerZxid;
  db.txnLog.add(createProposal(getZxid(0,1)));
  db.txnLog.add(createProposal(getZxid(1,1)));
  db.txnLog.add(createProposal(getZxid(1,2)));
  db.lastProcessedZxid=getZxid(2,0);
  db.committedLog.add(createProposal(getZxid(1,1)));
  db.committedLog.add(createProposal(getZxid(1,2)));
  peerZxid=getZxid(0,0);
  assertTrue(learnerHandler.syncFollower(peerZxid,db,leader));
  assertEquals(0,learnerHandler.getQueuedPackets().size());
  reset();
  peerZxid=getZxid(1,0);
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,getZxid(1,2),getZxid(1,2));
  assertEquals(5,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{getZxid(1,1),getZxid(1,2)});
  reset();
  peerZxid=getZxid(2,0);
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,getZxid(2,0),getZxid(2,0));
  assertEquals(1,learnerHandler.getQueuedPackets().size());
  reset();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test cases when txnlog is enabled and commitedLog is empty
 */
@Test public void testTxnLogOnly() throws Exception {
  long peerZxid;
  db.lastProcessedZxid=7;
  db.txnLog.add(createProposal(2));
  db.txnLog.add(createProposal(3));
  db.txnLog.add(createProposal(5));
  db.txnLog.add(createProposal(6));
  db.txnLog.add(createProposal(7));
  db.txnLog.add(createProposal(8));
  peerZxid=4;
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.TRUNC,3,db.lastProcessedZxid);
  assertEquals(7,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{5,6,7});
  reset();
  peerZxid=2;
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,db.lastProcessedZxid,db.lastProcessedZxid);
  assertEquals(9,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{3,5,6,7});
  reset();
  peerZxid=1;
  assertTrue(learnerHandler.syncFollower(peerZxid,db,leader));
  assertEquals(0,learnerHandler.getQueuedPackets().size());
  reset();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test cases when leader has committedLog
 */
@Test public void testCommittedLog() throws Exception {
  long peerZxid;
  db.lastProcessedZxid=6;
  db.committedLog.add(createProposal(2));
  db.committedLog.add(createProposal(3));
  db.committedLog.add(createProposal(5));
  peerZxid=4;
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.TRUNC,3,5);
  assertEquals(3,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{5});
  reset();
  peerZxid=2;
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,db.getmaxCommittedLog(),db.getmaxCommittedLog());
  assertEquals(5,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{3,5});
  reset();
  peerZxid=1;
  db.setSnapshotSizeFactor(-1);
  assertTrue(learnerHandler.syncFollower(peerZxid,db,leader));
  assertEquals(0,learnerHandler.getQueuedPackets().size());
  reset();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test cases with zxids that are negative long
 */
@Test public void testTxnLogWithNegativeZxid() throws Exception {
  long peerZxid;
  db.txnLog.add(createProposal(getZxid(0xf,2)));
  db.txnLog.add(createProposal(getZxid(0xf,3)));
  db.txnLog.add(createProposal(getZxid(0xf,5)));
  db.txnLog.add(createProposal(getZxid(0xf,6)));
  db.txnLog.add(createProposal(getZxid(0xf,7)));
  db.txnLog.add(createProposal(getZxid(0xf,8)));
  db.txnLog.add(createProposal(getZxid(0xf,9)));
  db.lastProcessedZxid=getZxid(0xf,9);
  db.committedLog.add(createProposal(getZxid(0xf,6)));
  db.committedLog.add(createProposal(getZxid(0xf,7)));
  db.committedLog.add(createProposal(getZxid(0xf,8)));
  peerZxid=getZxid(0xf,4);
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.TRUNC,getZxid(0xf,3),db.getmaxCommittedLog());
  assertEquals(9,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{getZxid(0xf,5),getZxid(0xf,6),getZxid(0xf,7),getZxid(0xf,8)});
  reset();
  peerZxid=getZxid(0xf,3);
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,db.getmaxCommittedLog(),db.getmaxCommittedLog());
  assertEquals(9,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{getZxid(0xf,5),getZxid(0xf,6),getZxid(0xf,7),getZxid(0xf,8)});
  reset();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test cases when we have to TRUNC learner, but it may cross epoch boundary
 * so we need to send snap instead
 */
@Test public void testCrossEpochTrunc() throws Exception {
  long peerZxid;
  db.txnLog.add(createProposal(getZxid(1,1)));
  db.txnLog.add(createProposal(getZxid(2,1)));
  db.txnLog.add(createProposal(getZxid(2,2)));
  db.txnLog.add(createProposal(getZxid(4,1)));
  db.lastProcessedZxid=getZxid(6,0);
  peerZxid=getZxid(3,1);
  assertTrue(learnerHandler.syncFollower(peerZxid,db,leader));
  assertEquals(0,learnerHandler.getQueuedPackets().size());
  reset();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test cases when there is a duplicate txn in the committedLog. This
 * should never happen unless there is a bug in initialization code
 * but the learner should never see duplicate packets
 */
@Test public void testDuplicatedTxn() throws Exception {
  long peerZxid;
  db.txnLog.add(createProposal(getZxid(0,1)));
  db.txnLog.add(createProposal(getZxid(1,1)));
  db.txnLog.add(createProposal(getZxid(1,2)));
  db.txnLog.add(createProposal(getZxid(1,1)));
  db.txnLog.add(createProposal(getZxid(1,2)));
  db.lastProcessedZxid=getZxid(2,0);
  db.committedLog.add(createProposal(getZxid(1,1)));
  db.committedLog.add(createProposal(getZxid(1,2)));
  db.committedLog.add(createProposal(getZxid(1,1)));
  db.committedLog.add(createProposal(getZxid(1,2)));
  peerZxid=getZxid(1,0);
  assertFalse(learnerHandler.syncFollower(peerZxid,db,leader));
  assertOpType(Leader.DIFF,getZxid(1,2),getZxid(1,2));
  assertEquals(5,learnerHandler.getQueuedPackets().size());
  queuedPacketMatches(new long[]{getZxid(1,1),getZxid(1,2)});
  reset();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.LearnerSnapshotThrottlerTest </h4><pre class="type-9 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTryWithResourceNoThrottle() throws Exception {
  LearnerSnapshotThrottler throttler=new LearnerSnapshotThrottler(1);
  for (int i=0; i < 3; i++) {
    LearnerSnapshot snapshot=throttler.beginSnapshot(false);
    try {
      Assert.assertFalse(snapshot.isEssential());
      Assert.assertEquals(1,snapshot.getConcurrentSnapshotNumber());
    }
  finally {
      snapshot.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.LearnerTest </h4><pre class="type-5 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void syncTest() throws Exception {
  File tmpFile=File.createTempFile("test",".dir",testData);
  tmpFile.delete();
  try {
    FileTxnSnapLog ftsl=new FileTxnSnapLog(tmpFile,tmpFile);
    SimpleLearner sl=new SimpleLearner(ftsl);
    long startZxid=sl.zk.getLastProcessedZxid();
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    BinaryOutputArchive oa=BinaryOutputArchive.getArchive(baos);
    sl.leaderOs=BinaryOutputArchive.getArchive(new ByteArrayOutputStream());
    sl.bufferedOutput=new BufferedOutputStream(System.out);
    sl.sock=new Socket();
    QuorumPacket qp=new QuorumPacket(Leader.SNAP,0,null,null);
    oa.writeRecord(qp,null);
    sl.zk.getZKDatabase().serializeSnapshot(oa);
    oa.writeString("BenWasHere","signature");
    TxnHeader hdr=new TxnHeader(0,0,0,0,ZooDefs.OpCode.create);
    CreateTxn txn=new CreateTxn("/foo",new byte[0],new ArrayList<ACL>(),false,sl.zk.getZKDatabase().getNode("/").stat.getCversion());
    ByteArrayOutputStream tbaos=new ByteArrayOutputStream();
    BinaryOutputArchive boa=BinaryOutputArchive.getArchive(tbaos);
    hdr.serialize(boa,"hdr");
    txn.serialize(boa,"txn");
    tbaos.close();
    qp=new QuorumPacket(Leader.PROPOSAL,1,tbaos.toByteArray(),null);
    oa.writeRecord(qp,null);
    sl.leaderIs=BinaryInputArchive.getArchive(new ByteArrayInputStream(baos.toByteArray()));
    try {
      sl.syncWithLeader(3);
    }
 catch (    EOFException e) {
    }
    sl.zk.shutdown();
    sl=new SimpleLearner(ftsl);
    Assert.assertEquals(startZxid,sl.zk.getLastProcessedZxid());
  }
  finally {
    TestUtils.deleteFileRecursively(tmpFile);
  }
}

</code></pre>

<br>
<pre class="type-3 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void connectionInitLimitTimeoutTest() throws Exception {
  TimeoutLearner learner=new TimeoutLearner();
  learner.self=new QuorumPeer();
  learner.self.setTickTime(2000);
  learner.self.setInitLimit(5);
  learner.self.setSyncLimit(2);
  InetSocketAddress addr=new InetSocketAddress(1111);
  learner.setTimeMultiplier((long)4000 * 1000000);
  learner.setPassConnectAttempt(5);
  try {
    learner.connectToLeader(addr);
    Assert.fail("should have thrown IOException!");
  }
 catch (  IOException e) {
    Assert.assertTrue(learner.nanoTime() > 2000 * 5 * 1000000);
    Assert.assertEquals(3,learner.getSockConnectAttempt());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.LocalPeerBeanTest </h4><pre class="type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case for https://issues.apache.org/jira/browse/ZOOKEEPER-2299
 */
@Test public void testClientAddress() throws Exception {
  QuorumPeer quorumPeer=new QuorumPeer();
  LocalPeerBean remotePeerBean=new LocalPeerBean(quorumPeer);
  String result=remotePeerBean.getClientAddress();
  assertNotNull(result);
  assertEquals(0,result.length());
  ServerCnxnFactory cnxnFactory=ServerCnxnFactory.createFactory();
  int clientPort=2181;
  InetSocketAddress address=new InetSocketAddress(clientPort);
  cnxnFactory.configure(address,5,false);
  quorumPeer.setCnxnFactory(cnxnFactory);
  result=remotePeerBean.getClientAddress();
  String ipv4="0.0.0.0:" + clientPort;
  String ipv6="0:0:0:0:0:0:0:0:" + clientPort;
  assertTrue(result.equals(ipv4) || result.equals(ipv6));
  cnxnFactory.shutdown();
  InetAddress clientIP=InetAddress.getByAddress(new byte[]{127,0,0,2});
  address=new InetSocketAddress(clientIP,clientPort);
  cnxnFactory=ServerCnxnFactory.createFactory();
  cnxnFactory.configure(address,5,false);
  quorumPeer.setCnxnFactory(cnxnFactory);
  result=remotePeerBean.getClientAddress();
  String expectedResult="127.0.0.2:" + clientPort;
  assertEquals(expectedResult,result);
  cnxnFactory.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.QuorumPeerConfigTest </h4><pre class="type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case for https://issues.apache.org/jira/browse/ZOOKEEPER-2264
 */
@Test public void testErrorMessageWhenclientPortNotSetButclientPortAddressSet() throws IOException, ConfigException {
  QuorumPeerConfig quorumPeerConfig=new QuorumPeerConfig();
  try {
    Properties zkProp=getDefaultZKProperties();
    zkProp.setProperty("clientPortAddress","localhost");
    quorumPeerConfig.parseProperties(zkProp);
    fail("IllegalArgumentException is expected");
  }
 catch (  IllegalArgumentException e) {
    String expectedMessage="clientPortAddress is set but clientPort is not set";
    assertEquals(expectedMessage,e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test case for https://issues.apache.org/jira/browse/ZOOKEEPER-2264
 */
@Test public void testErrorMessageWhensecureClientPortNotSetButsecureClientPortAddressSet() throws IOException, ConfigException {
  QuorumPeerConfig quorumPeerConfig=new QuorumPeerConfig();
  try {
    Properties zkProp=getDefaultZKProperties();
    zkProp.setProperty("secureClientPortAddress","localhost");
    quorumPeerConfig.parseProperties(zkProp);
    fail("IllegalArgumentException is expected");
  }
 catch (  IllegalArgumentException e) {
    String expectedMessage="secureClientPortAddress is set but secureClientPort is not set";
    assertEquals(expectedMessage,e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.QuorumPeerMainTest </h4><pre class="type-2 type-6 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies that the server is able to redefine if user configured only
 * minSessionTimeout limit
 */
@Test public void testWithOnlyMinSessionTimeout() throws Exception {
  ClientBase.setupTestEnv();
  final int CLIENT_PORT_QP1=PortAssignment.unique();
  final int CLIENT_PORT_QP2=PortAssignment.unique();
  String quorumCfgSection="server.1=127.0.0.1:" + PortAssignment.unique() + ":"+ PortAssignment.unique()+ "\nserver.2=127.0.0.1:"+ PortAssignment.unique()+ ":"+ PortAssignment.unique();
  final int minSessionTimeOut=15000;
  final String configs="minSessionTimeout=" + minSessionTimeOut + "\n";
  MainThread q1=new MainThread(1,CLIENT_PORT_QP1,quorumCfgSection,configs);
  MainThread q2=new MainThread(2,CLIENT_PORT_QP2,quorumCfgSection,configs);
  q1.start();
  q2.start();
  Assert.assertTrue("waiting for server 1 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP1,CONNECTION_TIMEOUT));
  Assert.assertTrue("waiting for server 2 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP2,CONNECTION_TIMEOUT));
  QuorumPeer quorumPeer=q1.main.quorumPeer;
  final int maxSessionTimeOut=quorumPeer.tickTime * 20;
  Assert.assertEquals("minimumSessionTimeOut is not considered",minSessionTimeOut,quorumPeer.getMinSessionTimeout());
  Assert.assertEquals("maximumSessionTimeOut is wrong",maxSessionTimeOut,quorumPeer.getMaxSessionTimeout());
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifies that the server is able to redefine the min/max session
 * timeouts
 */
@Test public void testMinMaxSessionTimeOut() throws Exception {
  ClientBase.setupTestEnv();
  final int CLIENT_PORT_QP1=PortAssignment.unique();
  final int CLIENT_PORT_QP2=PortAssignment.unique();
  String quorumCfgSection="server.1=127.0.0.1:" + PortAssignment.unique() + ":"+ PortAssignment.unique()+ "\nserver.2=127.0.0.1:"+ PortAssignment.unique()+ ":"+ PortAssignment.unique();
  final int minSessionTimeOut=10000;
  final int maxSessionTimeOut=15000;
  final String configs="maxSessionTimeout=" + maxSessionTimeOut + "\n"+ "minSessionTimeout="+ minSessionTimeOut+ "\n";
  MainThread q1=new MainThread(1,CLIENT_PORT_QP1,quorumCfgSection,configs);
  MainThread q2=new MainThread(2,CLIENT_PORT_QP2,quorumCfgSection,configs);
  q1.start();
  q2.start();
  Assert.assertTrue("waiting for server 1 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP1,CONNECTION_TIMEOUT));
  Assert.assertTrue("waiting for server 2 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP2,CONNECTION_TIMEOUT));
  QuorumPeer quorumPeer=q1.main.quorumPeer;
  Assert.assertEquals("minimumSessionTimeOut is not considered",minSessionTimeOut,quorumPeer.getMinSessionTimeout());
  Assert.assertEquals("maximumSessionTimeOut is not considered",maxSessionTimeOut,quorumPeer.getMaxSessionTimeout());
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify the ability to start a cluster.
 */
@Test public void testQuorum() throws Exception {
  ClientBase.setupTestEnv();
  final int CLIENT_PORT_QP1=PortAssignment.unique();
  final int CLIENT_PORT_QP2=PortAssignment.unique();
  String quorumCfgSection="server.1=127.0.0.1:" + PortAssignment.unique() + ":"+ PortAssignment.unique()+ ";"+ CLIENT_PORT_QP1+ "\nserver.2=127.0.0.1:"+ PortAssignment.unique()+ ":"+ PortAssignment.unique()+ ";"+ CLIENT_PORT_QP2;
  MainThread q1=new MainThread(1,CLIENT_PORT_QP1,quorumCfgSection);
  MainThread q2=new MainThread(2,CLIENT_PORT_QP2,quorumCfgSection);
  q1.start();
  q2.start();
  Assert.assertTrue("waiting for server 1 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP1,CONNECTION_TIMEOUT));
  Assert.assertTrue("waiting for server 2 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP2,CONNECTION_TIMEOUT));
  QuorumPeer quorumPeer=q1.main.quorumPeer;
  int tickTime=quorumPeer.getTickTime();
  Assert.assertEquals("Default value of minimumSessionTimeOut is not considered",tickTime * 2,quorumPeer.getMinSessionTimeout());
  Assert.assertEquals("Default value of maximumSessionTimeOut is not considered",tickTime * 20,quorumPeer.getMaxSessionTimeout());
  ZooKeeper zk=new ZooKeeper("127.0.0.1:" + CLIENT_PORT_QP1,ClientBase.CONNECTION_TIMEOUT,this);
  waitForOne(zk,States.CONNECTED);
  zk.create("/foo_q1","foobar1".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertEquals(new String(zk.getData("/foo_q1",null,null)),"foobar1");
  zk.close();
  zk=new ZooKeeper("127.0.0.1:" + CLIENT_PORT_QP2,ClientBase.CONNECTION_TIMEOUT,this);
  waitForOne(zk,States.CONNECTED);
  zk.create("/foo_q2","foobar2".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertEquals(new String(zk.getData("/foo_q2",null,null)),"foobar2");
  zk.close();
  q1.shutdown();
  q2.shutdown();
  Assert.assertTrue("waiting for server 1 down",ClientBase.waitForServerDown("127.0.0.1:" + CLIENT_PORT_QP1,ClientBase.CONNECTION_TIMEOUT));
  Assert.assertTrue("waiting for server 2 down",ClientBase.waitForServerDown("127.0.0.1:" + CLIENT_PORT_QP2,ClientBase.CONNECTION_TIMEOUT));
}

</code></pre>

<br>
<pre class="type-5 type-2 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the case of server with highest zxid not present at leader election and joining later.
 * This test case is for reproducing the issue and fixing the bug mentioned in ZOOKEEPER-1154
 * and ZOOKEEPER-1156.
 */
@Test public void testHighestZxidJoinLate() throws Exception {
  numServers=3;
  servers=LaunchServers(numServers);
  String path="/hzxidtest";
  int leader=-1;
  for (int i=0; i < numServers; i++) {
    if (servers.mt[i].main.quorumPeer.leader != null) {
      leader=i;
    }
  }
  Assert.assertTrue("There should be a leader",leader >= 0);
  int nonleader=(leader + 1) % numServers;
  byte[] input=new byte[1];
  input[0]=1;
  byte[] output;
  servers.zk[leader].create(path + leader,input,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  servers.zk[leader].create(path + nonleader,input,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  output=servers.zk[leader].getData(path + nonleader,false,null);
  for (int i=0; i < numServers; i++) {
    if (i != leader) {
      servers.mt[i].shutdown();
    }
  }
  input[0]=2;
  servers.zk[leader].setData(path + leader,input,-1,null,null);
  Thread.sleep(500);
  servers.mt[leader].shutdown();
  System.gc();
  waitForAll(servers.zk,States.CONNECTING);
  for (int i=0; i < numServers; i++) {
    if (i != leader) {
      servers.mt[i].start();
    }
  }
  waitForOne(servers.zk[nonleader],States.CONNECTED);
  output=servers.zk[nonleader].getData(path + leader,false,null);
  Assert.assertEquals("Expecting old value 1 since 2 isn't committed yet",output[0],1);
  servers.zk[nonleader].setData(path + nonleader,input,-1);
  servers.mt[leader].start();
  waitForOne(servers.zk[leader],States.CONNECTED);
  output=servers.zk[leader].getData(path + leader,false,null);
  Assert.assertEquals("Validating that the deposed leader has rolled back that change it had written",output[0],1);
  output=servers.zk[leader].getData(path + nonleader,false,null);
  Assert.assertEquals("Validating that the deposed leader caught up on changes it missed",output[0],2);
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * verify if bad packets are being handled properly
 * at the quorum port
 * @throws Exception
 */
@Test public void testBadPackets() throws Exception {
  ClientBase.setupTestEnv();
  final int CLIENT_PORT_QP1=PortAssignment.unique();
  final int CLIENT_PORT_QP2=PortAssignment.unique();
  int electionPort1=PortAssignment.unique();
  int electionPort2=PortAssignment.unique();
  String quorumCfgSection="server.1=127.0.0.1:" + PortAssignment.unique() + ":"+ electionPort1+ ";"+ CLIENT_PORT_QP1+ "\nserver.2=127.0.0.1:"+ PortAssignment.unique()+ ":"+ electionPort2+ ";"+ CLIENT_PORT_QP2;
  MainThread q1=new MainThread(1,CLIENT_PORT_QP1,quorumCfgSection);
  MainThread q2=new MainThread(2,CLIENT_PORT_QP2,quorumCfgSection);
  q1.start();
  q2.start();
  Assert.assertTrue("waiting for server 1 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP1,CONNECTION_TIMEOUT));
  Assert.assertTrue("waiting for server 2 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP2,CONNECTION_TIMEOUT));
  byte[] b=new byte[4];
  int length=1024 * 1024 * 1024;
  ByteBuffer buff=ByteBuffer.wrap(b);
  buff.putInt(length);
  buff.position(0);
  SocketChannel s=SocketChannel.open(new InetSocketAddress("127.0.0.1",electionPort1));
  s.write(buff);
  s.close();
  buff.position(0);
  s=SocketChannel.open(new InetSocketAddress("127.0.0.1",electionPort2));
  s.write(buff);
  s.close();
  ZooKeeper zk=new ZooKeeper("127.0.0.1:" + CLIENT_PORT_QP1,ClientBase.CONNECTION_TIMEOUT,this);
  waitForOne(zk,States.CONNECTED);
  zk.create("/foo_q1","foobar1".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertEquals(new String(zk.getData("/foo_q1",null,null)),"foobar1");
  zk.close();
  q1.shutdown();
  q2.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.QuorumPeerTest </h4><pre class="type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test case for https://issues.apache.org/jira/browse/ZOOKEEPER-2301
 */
@Test public void testQuorumPeerListendOnSpecifiedClientIP() throws IOException {
  long myId=1;
  File dataDir=ClientBase.createTmpDir();
  int clientPort=PortAssignment.unique();
  String clientIP="127.0.0.2";
  Map<Long,QuorumServer> peersView=new HashMap<Long,QuorumServer>();
  peersView.put(Long.valueOf(myId),new QuorumServer(myId,new InetSocketAddress("127.0.0.1",PortAssignment.unique()),new InetSocketAddress("127.0.0.1",PortAssignment.unique()),new InetSocketAddress(clientIP,clientPort),LearnerType.PARTICIPANT));
  QuorumPeer peer1=new QuorumPeer(peersView,dataDir,dataDir,clientPort,electionAlg,myId,tickTime,initLimit,syncLimit);
  String hostString1=peer1.cnxnFactory.getLocalAddress().getHostString();
  assertEquals(clientIP,hostString1);
  peer1.shutdown();
  peersView.clear();
  clientPort=PortAssignment.unique();
  clientIP="127.0.0.3";
  peersView.put(Long.valueOf(myId),new QuorumServer(myId,new InetSocketAddress("127.0.0.1",PortAssignment.unique()),new InetSocketAddress("127.0.0.1",PortAssignment.unique()),new InetSocketAddress(clientIP,clientPort),LearnerType.PARTICIPANT));
  QuorumPeer peer2=new QuorumPeer(peersView,dataDir,dataDir,clientPort,electionAlg,myId,tickTime,initLimit,syncLimit);
  String hostString2=peer2.cnxnFactory.getLocalAddress().getHostString();
  assertEquals(clientIP,hostString2);
  peer2.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.QuorumRequestPipelineTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreate() throws Exception {
  zkClient.create(PARENT_PATH,DATA,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertArrayEquals(String.format("%s Node created (create) with expected value",serverState),DATA,zkClient.getData(PARENT_PATH,false,null));
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetAndGetACL() throws Exception {
  create2EmptyNode(zkClient,PARENT_PATH);
  Assert.assertEquals(String.format("%s Node has open ACL",serverState),Ids.OPEN_ACL_UNSAFE,zkClient.getACL(PARENT_PATH,new Stat()));
  zkClient.setACL(PARENT_PATH,Ids.READ_ACL_UNSAFE,-1);
  Assert.assertEquals(String.format("%s Node has world read-only ACL",serverState),Ids.READ_ACL_UNSAFE,zkClient.getACL(PARENT_PATH,new Stat()));
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetAndGetData() throws Exception {
  create2EmptyNode(zkClient,PARENT_PATH);
  zkClient.setData(PARENT_PATH,DATA,-1);
  Assert.assertArrayEquals(String.format("%s Node updated with expected value",serverState),DATA,zkClient.getData(PARENT_PATH,false,null));
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetAndGetChildren2() throws Exception {
  create2EmptyNode(zkClient,PARENT_PATH);
  for (  String child : CHILDREN) {
    create2EmptyNode(zkClient,PARENT_PATH + "/" + child);
  }
  Assert.assertEquals(String.format("%s Parent has expected children",serverState),CHILDREN,new HashSet<String>(zkClient.getChildren(PARENT_PATH,false,null)));
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetAndGetChildren() throws Exception {
  create2EmptyNode(zkClient,PARENT_PATH);
  for (  String child : CHILDREN) {
    create2EmptyNode(zkClient,PARENT_PATH + "/" + child);
  }
  Assert.assertEquals(String.format("%s Parent has expected children",serverState),CHILDREN,new HashSet<String>(zkClient.getChildren(PARENT_PATH,false)));
}

</code></pre>

<br>
<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExists() throws Exception {
  Stat stat=create2EmptyNode(zkClient,PARENT_PATH);
  Assert.assertEquals(String.format("%s Exists returns correct node stat",serverState),stat,zkClient.exists(PARENT_PATH,false));
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreate2() throws Exception {
  zkClient.create(PARENT_PATH,DATA,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT,null);
  Assert.assertArrayEquals(String.format("%s Node created (create2) with expected value",serverState),DATA,zkClient.getData(PARENT_PATH,false,null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.QuorumServerTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void constructionUnderstandsIpv6LiteralsInClientConfig() throws ConfigException {
  String config="127.0.0.1:1234:1236:participant;[::1]:1237";
  QuorumServer qs=new QuorumServer(0,config);
  assertEquals("127.0.0.1:1234:1236:participant;[0:0:0:0:0:0:0:1]:1237",qs.toString());
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToString() throws ConfigException {
  String config="127.0.0.1:1234:1236:participant;0.0.0.0:1237";
  String expected="127.0.0.1:1234:1236:participant;0.0.0.0:1237";
  QuorumServer qs=new QuorumServer(0,config);
  Assert.assertEquals("Use IP address",expected,qs.toString());
  config="127.0.0.1:1234:1236;0.0.0.0:1237";
  expected="127.0.0.1:1234:1236:participant;0.0.0.0:1237";
  qs=new QuorumServer(0,config);
  Assert.assertEquals("Type unspecified",expected,qs.toString());
  config="127.0.0.1:1234:1236:observer;0.0.0.0:1237";
  expected="127.0.0.1:1234:1236:observer;0.0.0.0:1237";
  qs=new QuorumServer(0,config);
  Assert.assertEquals("Observer type",expected,qs.toString());
  config="127.0.0.1:1234:1236:participant;1237";
  expected="127.0.0.1:1234:1236:participant;0.0.0.0:1237";
  qs=new QuorumServer(0,config);
  Assert.assertEquals("Client address unspecified",expected,qs.toString());
  config="127.0.0.1:1234:1236:participant;1.2.3.4:1237";
  expected="127.0.0.1:1234:1236:participant;1.2.3.4:1237";
  qs=new QuorumServer(0,config);
  Assert.assertEquals("Client address specified",expected,qs.toString());
  config="example.com:1234:1236:participant;1237";
  expected="example.com:1234:1236:participant;0.0.0.0:1237";
  qs=new QuorumServer(0,config);
  Assert.assertEquals("Use hostname",expected,qs.toString());
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void constructionUnderstandsIpv6LiteralsInServerConfig() throws ConfigException {
  String config="[::1]:1234:1236:participant";
  QuorumServer qs=new QuorumServer(0,config);
  assertEquals("[0:0:0:0:0:0:0:1]:1234:1236:participant",qs.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.ReconfigBackupTest </h4><pre class="type-9 type-5 type-10 type-2 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks that if a version is appended to dynamic file,
 * then peer should use that version as quorum config version.
 * <p/>
 * The scenario: one server has an older version of 3 servers, and
 * four others have newer version of 5 servers. Finally, the lag-off one
 * should have server config of 5 servers.
 */
@Test public void testVersionOfDynamicFilename() throws Exception {
  final int SERVER_COUNT=5;
  final int oldServerCount=3;
  final int lagOffServerId=0;
  final int clientPorts[]=new int[SERVER_COUNT];
  StringBuilder sb=new StringBuilder();
  String server;
  StringBuilder oldSb=new StringBuilder();
  ArrayList<String> allServers=new ArrayList<String>();
  for (int i=0; i < SERVER_COUNT; i++) {
    clientPorts[i]=PortAssignment.unique();
    server="server." + i + "=localhost:"+ PortAssignment.unique()+ ":"+ PortAssignment.unique()+ ":participant;localhost:"+ clientPorts[i];
    sb.append(server + "\n");
    allServers.add(server);
    if (i < oldServerCount) {
      oldSb.append(server + "\n");
    }
  }
  String currentQuorumCfgSection=sb.toString();
  String oldQuorumCfg=oldSb.toString();
  MainThread mt[]=new MainThread[SERVER_COUNT];
  for (int i=0; i < SERVER_COUNT; i++) {
    if (i == lagOffServerId) {
      mt[i]=new MainThread(i,clientPorts[i],oldQuorumCfg,true,"100000000");
    }
 else {
      mt[i]=new MainThread(i,clientPorts[i],currentQuorumCfgSection,true,"200000000");
    }
    if (i == lagOffServerId) {
      Assert.assertNotNull(mt[i].getFileByName("zoo.cfg.dynamic.100000000"));
      Assert.assertNull(mt[i].getFileByName("zoo.cfg.dynamic.200000000"));
      Assert.assertTrue(mt[i].getPropFromStaticFile("dynamicConfigFile").endsWith(".100000000"));
    }
 else {
      Assert.assertNotNull(mt[i].getFileByName("zoo.cfg.dynamic.200000000"));
      Assert.assertTrue(mt[i].getPropFromStaticFile("dynamicConfigFile").endsWith(".200000000"));
    }
    mt[i].start();
  }
  String dynamicFileContent=null;
  for (int i=0; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT));
    ZooKeeper zk=new ZooKeeper("127.0.0.1:" + clientPorts[i],ClientBase.CONNECTION_TIMEOUT,this);
    String configStr=ReconfigTest.testServerHasConfig(zk,allServers,null);
    Assert.assertEquals("200000000",getVersionFromConfigStr(configStr));
    List<String> configLines=Arrays.asList(configStr.split("\n"));
    Collections.sort(configLines);
    String sortedConfigStr=StringUtils.joinStrings(configLines,"\n");
    File dynamicConfigFile=mt[i].getFileByName("zoo.cfg.dynamic.200000000");
    Assert.assertNotNull(dynamicConfigFile);
    if (i == 0) {
      dynamicFileContent=getFileContent(dynamicConfigFile);
      Assert.assertEquals(sortedConfigStr,dynamicFileContent + "version=200000000");
    }
 else {
      String otherDynamicFileContent=getFileContent(dynamicConfigFile);
      Assert.assertEquals(dynamicFileContent,otherDynamicFileContent);
    }
    zk.close();
  }
  Assert.assertTrue(mt[lagOffServerId].getPropFromStaticFile("dynamicConfigFile").endsWith(".200000000"));
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i].shutdown();
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-10 type-2 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks that on reconfig, a new dynamic file will be created with
 * current version appended to file name. Meanwhile, the dynamic file pointer
 * in static config file should also be changed.
 */
@Test public void testReconfigCreateNewVersionFile() throws Exception {
  final int SERVER_COUNT=3;
  final int NEW_SERVER_COUNT=5;
  final int clientPorts[]=new int[NEW_SERVER_COUNT];
  final int quorumPorts[]=new int[NEW_SERVER_COUNT];
  final int electionPorts[]=new int[NEW_SERVER_COUNT];
  final String servers[]=new String[NEW_SERVER_COUNT];
  StringBuilder sb=new StringBuilder();
  ArrayList<String> oldServers=new ArrayList<String>();
  ArrayList<String> newServers=new ArrayList<String>();
  for (int i=0; i < NEW_SERVER_COUNT; i++) {
    clientPorts[i]=PortAssignment.unique();
    quorumPorts[i]=PortAssignment.unique();
    electionPorts[i]=PortAssignment.unique();
    servers[i]="server." + i + "=localhost:"+ quorumPorts[i]+ ":"+ electionPorts[i]+ ":participant;localhost:"+ clientPorts[i];
    newServers.add(servers[i]);
    if (i >= SERVER_COUNT) {
      continue;
    }
    oldServers.add(servers[i]);
    sb.append(servers[i] + "\n");
  }
  String quorumCfgSection=sb.toString();
  MainThread mt[]=new MainThread[NEW_SERVER_COUNT];
  ZooKeeper zk[]=new ZooKeeper[NEW_SERVER_COUNT];
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i]=new MainThread(i,clientPorts[i],quorumCfgSection);
    mt[i].start();
  }
  String firstVersion=null, secondVersion=null;
  for (int i=0; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT));
    zk[i]=new ZooKeeper("127.0.0.1:" + clientPorts[i],ClientBase.CONNECTION_TIMEOUT,this);
    Properties cfg=ReconfigLegacyTest.readPropertiesFromFile(mt[i].confFile);
    String filename=cfg.getProperty("dynamicConfigFile","");
    String version=QuorumPeerConfig.getVersionFromFilename(filename);
    Assert.assertNotNull(version);
    String configStr=ReconfigTest.testServerHasConfig(zk[i],oldServers,null);
    String configVersion=getVersionFromConfigStr(configStr);
    Assert.assertEquals(version,configVersion);
    if (i == 0) {
      firstVersion=version;
    }
 else {
      Assert.assertEquals(firstVersion,version);
    }
  }
  ReconfigTest.reconfig(zk[1],null,null,newServers,-1);
  for (int i=SERVER_COUNT; i < NEW_SERVER_COUNT; i++) {
    mt[i]=new MainThread(i,clientPorts[i],quorumCfgSection + servers[i]);
    mt[i].start();
  }
  for (int i=SERVER_COUNT; i < NEW_SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT));
    zk[i]=new ZooKeeper("127.0.0.1:" + clientPorts[i],ClientBase.CONNECTION_TIMEOUT,this);
  }
  for (int i=0; i < NEW_SERVER_COUNT; i++) {
    Properties cfg=ReconfigLegacyTest.readPropertiesFromFile(mt[i].confFile);
    String filename=cfg.getProperty("dynamicConfigFile","");
    String version=QuorumPeerConfig.getVersionFromFilename(filename);
    Assert.assertNotNull(version);
    String configStr=ReconfigTest.testServerHasConfig(zk[i],newServers,null);
    String quorumVersion=getVersionFromConfigStr(configStr);
    Assert.assertEquals(version,quorumVersion);
    if (i == 0) {
      secondVersion=version;
      Assert.assertTrue(Long.parseLong(secondVersion,16) > Long.parseLong(firstVersion,16));
    }
 else {
      Assert.assertEquals(secondVersion,version);
    }
  }
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i].shutdown();
    zk[i].close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks that it will backup static file on bootup.
 */
@Test public void testBackupStatic() throws Exception {
  final int SERVER_COUNT=3;
  final int clientPorts[]=new int[SERVER_COUNT];
  StringBuilder sb=new StringBuilder();
  String server;
  for (int i=0; i < SERVER_COUNT; i++) {
    clientPorts[i]=PortAssignment.unique();
    server="server." + i + "=localhost:"+ PortAssignment.unique()+ ":"+ PortAssignment.unique()+ ":participant;localhost:"+ clientPorts[i];
    sb.append(server + "\n");
  }
  String currentQuorumCfgSection=sb.toString();
  MainThread mt[]=new MainThread[SERVER_COUNT];
  String[] staticFileContent=new String[SERVER_COUNT];
  String[] staticBackupContent=new String[SERVER_COUNT];
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i]=new MainThread(i,clientPorts[i],currentQuorumCfgSection,false);
    Assert.assertNull("static file backup shouldn't exist before bootup",mt[i].getFileByName("zoo.cfg.bak"));
    staticFileContent[i]=getFileContent(mt[i].confFile);
    mt[i].start();
  }
  for (int i=0; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT));
    File backupFile=mt[i].getFileByName("zoo.cfg.bak");
    Assert.assertNotNull("static file backup should exist",backupFile);
    staticBackupContent[i]=getFileContent(backupFile);
    Assert.assertEquals(staticFileContent[i],staticBackupContent[i]);
  }
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i].shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.ReconfigFailureCasesTest </h4><pre class="type-3 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeaderTimesoutOnNewQuorum() throws Exception {
  qu=new QuorumUtil(1);
  qu.disableJMXTest=true;
  qu.startAll();
  ZooKeeper[] zkArr=ReconfigTest.createHandles(qu);
  List<String> leavingServers=new ArrayList<String>();
  leavingServers.add("3");
  qu.shutdown(2);
  try {
    zkArr[1].reconfig(null,leavingServers,null,-1,null);
    Assert.fail("Reconfig should have failed since we don't have quorum of new config");
  }
 catch (  KeeperException.ConnectionLossException e) {
  }
catch (  Exception e) {
    Assert.fail("Should have been ConnectionLossException!");
  }
  Assert.assertEquals(QuorumStats.Provider.LOOKING_STATE,qu.getPeer(1).peer.getServerState());
  Assert.assertEquals(QuorumStats.Provider.LOOKING_STATE,qu.getPeer(3).peer.getServerState());
  ReconfigTest.closeAllHandles(zkArr);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.ReconfigLegacyTest </h4><pre class="type-9 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case for https://issues.apache.org/jira/browse/ZOOKEEPER-2244
 * @throws Exception
 */
@Test(timeout=120000) public void testRestartZooKeeperServer() throws Exception {
  final int clientPorts[]=new int[SERVER_COUNT];
  StringBuilder sb=new StringBuilder();
  String server;
  for (int i=0; i < SERVER_COUNT; i++) {
    clientPorts[i]=PortAssignment.unique();
    server="server." + i + "=127.0.0.1:"+ PortAssignment.unique()+ ":"+ PortAssignment.unique()+ ":participant;127.0.0.1:"+ clientPorts[i];
    sb.append(server + "\n");
  }
  String currentQuorumCfgSection=sb.toString();
  MainThread mt[]=new MainThread[SERVER_COUNT];
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i]=new MainThread(i,clientPorts[i],currentQuorumCfgSection,false);
    mt[i].start();
  }
  for (int i=0; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT));
  }
  CountdownWatcher watch1=new CountdownWatcher();
  ZooKeeper zk=new ZooKeeper("127.0.0.1:" + clientPorts[0],ClientBase.CONNECTION_TIMEOUT,watch1);
  watch1.waitForConnected(ClientBase.CONNECTION_TIMEOUT);
  String zNodePath="/serverRestartTest";
  String data="originalData";
  zk.create(zNodePath,data.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.close();
  mt[0].shutdown();
  mt[1].shutdown();
  mt[0].start();
  mt[1].start();
  for (int i=0; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT));
  }
  CountdownWatcher watch2=new CountdownWatcher();
  zk=new ZooKeeper("127.0.0.1:" + clientPorts[0],ClientBase.CONNECTION_TIMEOUT,watch2);
  watch2.waitForConnected(ClientBase.CONNECTION_TIMEOUT);
  byte[] dataBytes=zk.getData(zNodePath,null,null);
  String receivedData=new String(dataBytes);
  assertEquals(data,receivedData);
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i].shutdown();
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks that when started with a single static config file the
 * servers will create a valid dynamic config file. Also checks that when
 * the static config includes a clientPort but the dynamic definition also
 * includes it, the static definition is erased.
 */
@Test public void testConfigFileBackwardCompatibility() throws Exception {
  final int clientPorts[]=new int[SERVER_COUNT];
  StringBuilder sb=new StringBuilder();
  String server;
  ArrayList<String> allServers=new ArrayList<String>();
  for (int i=0; i < SERVER_COUNT; i++) {
    clientPorts[i]=PortAssignment.unique();
    server="server." + i + "=localhost:"+ PortAssignment.unique()+ ":"+ PortAssignment.unique()+ ":participant;localhost:"+ clientPorts[i];
    allServers.add(server);
    sb.append(server + "\n");
  }
  String currentQuorumCfgSection=sb.toString();
  MainThread mt[]=new MainThread[SERVER_COUNT];
  ZooKeeper zk[]=new ZooKeeper[SERVER_COUNT];
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i]=new MainThread(i,clientPorts[i],currentQuorumCfgSection,false);
    Assert.assertEquals(mt[i].getDynamicFiles().length,0);
    mt[i].start();
  }
  for (int i=0; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT));
    zk[i]=new ZooKeeper("127.0.0.1:" + clientPorts[i],ClientBase.CONNECTION_TIMEOUT,this);
    File[] dynamicFiles=mt[i].getDynamicFiles();
    Assert.assertTrue(dynamicFiles.length == 1);
    ReconfigTest.testServerHasConfig(zk[i],allServers,null);
    Properties cfg=readPropertiesFromFile(mt[i].confFile);
    for (int j=0; j < SERVER_COUNT; j++) {
      Assert.assertFalse(cfg.containsKey("server." + j));
    }
    Assert.assertTrue(cfg.containsKey("dynamicConfigFile"));
    Assert.assertFalse(cfg.containsKey("clientPort"));
    cfg=readPropertiesFromFile(dynamicFiles[0]);
    for (int j=0; j < SERVER_COUNT; j++) {
      String serverLine=cfg.getProperty("server." + j,"");
      Assert.assertEquals(allServers.get(j),"server." + j + "="+ serverLine);
    }
    Assert.assertFalse(cfg.containsKey("dynamicConfigFile"));
  }
  ReconfigTest.testNormalOperation(zk[0],zk[1]);
  for (int i=0; i < SERVER_COUNT; i++) {
    zk[i].close();
    mt[i].shutdown();
  }
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i].start();
  }
  for (int i=0; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT));
    zk[i]=new ZooKeeper("127.0.0.1:" + clientPorts[i],ClientBase.CONNECTION_TIMEOUT,this);
    ReconfigTest.testServerHasConfig(zk[i],allServers,null);
  }
  ReconfigTest.testNormalOperation(zk[0],zk[1]);
  for (int i=0; i < SERVER_COUNT; i++) {
    mt[i].shutdown();
    zk[i].close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.ReconfigRecoveryTest </h4><pre class="type-9 type-5 type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests conversion of observer to participant AFTER new config was already
 * committed. Old config: servers 0 (participant), 1 (participant), 2
 * (observer) New config: servers 2 (participant), 3 (participant) We start
 * server 2 with old config and start server 3 with new config. All other
 * servers are down. In order to terminate FLE, server 3 must 'convince'
 * server 2 to adopt the new config and turn into a participant.
 */
@Test public void testObserverConvertedToParticipantDuringFLE() throws Exception {
  ClientBase.setupTestEnv();
  final int SERVER_COUNT=4;
  int[][] ports=generatePorts(SERVER_COUNT);
  String currentQuorumCfgSection, nextQuorumCfgSection;
  HashSet<Integer> observers=new HashSet<Integer>();
  observers.add(2);
  StringBuilder sb=generateConfig(3,ports,observers);
  currentQuorumCfgSection=sb.toString();
  ArrayList<String> allServersNext=new ArrayList<String>();
  sb=new StringBuilder();
  for (int i=2; i < SERVER_COUNT; i++) {
    String server="server." + i + "=localhost:"+ ports[i][0]+ ":"+ ports[i][1]+ ":participant;localhost:"+ ports[i][2];
    allServersNext.add(server);
    sb.append(server + "\n");
  }
  nextQuorumCfgSection=sb.toString();
  MainThread mt[]=new MainThread[SERVER_COUNT];
  ZooKeeper zk[]=new ZooKeeper[SERVER_COUNT];
  mt[2]=new MainThread(2,ports[2][2],currentQuorumCfgSection,true,"100000000");
  mt[2].start();
  zk[2]=new ZooKeeper("127.0.0.1:" + ports[2][2],ClientBase.CONNECTION_TIMEOUT,this);
  mt[3]=new MainThread(3,ports[3][2],nextQuorumCfgSection,true,"200000000");
  mt[3].start();
  zk[3]=new ZooKeeper("127.0.0.1:" + ports[3][2],ClientBase.CONNECTION_TIMEOUT,this);
  for (int i=2; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + ports[i][2],CONNECTION_TIMEOUT * 2));
    ReconfigTest.testServerHasConfig(zk[i],allServersNext,null);
  }
  Assert.assertEquals(nextQuorumCfgSection + "version=200000000",ReconfigTest.testServerHasConfig(zk[2],null,null));
  Assert.assertEquals(nextQuorumCfgSection + "version=200000000",ReconfigTest.testServerHasConfig(zk[3],null,null));
  ReconfigTest.testNormalOperation(zk[2],zk[2]);
  ReconfigTest.testNormalOperation(zk[3],zk[2]);
  for (int i=2; i < SERVER_COUNT; i++) {
    zk[i].close();
    mt[i].shutdown();
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests conversion of observer to participant during reconfig recovery, new
 * config was not committed yet. Old config: servers 0 (participant), 1
 * (participant), 2 (observer) New config: servers 2 (participant), 3
 * (participant) We start server servers 0, 1, 2 with old config and a .next
 * file indicating a reconfig in progress. We start server 3 with old config
 * + itself in config file. In this scenario server 2 can't be converted to
 * participant during reconfig since we don't gossip about proposed
 * configurations, only about committed ones. This tests that new config can
 * be completed, which requires server 2's ack for the newleader message,
 * even though its an observer.
 */
@Test public void testCurrentObserverIsParticipantInNewConfig() throws Exception {
  ClientBase.setupTestEnv();
  final int SERVER_COUNT=4;
  int[][] ports=generatePorts(SERVER_COUNT);
  String currentQuorumCfg, nextQuorumCfgSection;
  HashSet<Integer> observers=new HashSet<Integer>();
  observers.add(2);
  StringBuilder sb=generateConfig(3,ports,observers);
  currentQuorumCfg=sb.toString();
  MainThread mt[]=new MainThread[SERVER_COUNT];
  ZooKeeper zk[]=new ZooKeeper[SERVER_COUNT];
  for (int i=0; i <= 2; i++) {
    mt[i]=new MainThread(i,ports[i][2],currentQuorumCfg,true,"100000000");
    mt[i].start();
    zk[i]=new ZooKeeper("127.0.0.1:" + ports[i][2],ClientBase.CONNECTION_TIMEOUT,this);
  }
  ReconfigTest.testNormalOperation(zk[0],zk[2]);
  for (int i=0; i <= 2; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + ports[i][2],CONNECTION_TIMEOUT * 2));
  }
  for (int i=0; i <= 2; i++) {
    mt[i].shutdown();
    zk[i].close();
  }
  ArrayList<String> allServersNext=new ArrayList<String>();
  sb=new StringBuilder();
  for (int i=2; i < SERVER_COUNT; i++) {
    String server="server." + i + "=localhost:"+ ports[i][0]+ ":"+ ports[i][1]+ ":participant;localhost:"+ ports[i][2];
    allServersNext.add(server);
    sb.append(server + "\n");
  }
  nextQuorumCfgSection=sb.toString();
  for (int i=0; i <= 2; i++) {
    mt[i].writeTempDynamicConfigFile(nextQuorumCfgSection,"200000000");
    mt[i].start();
    zk[i]=new ZooKeeper("127.0.0.1:" + ports[i][2],ClientBase.CONNECTION_TIMEOUT,this);
  }
  mt[3]=new MainThread(3,ports[3][2],currentQuorumCfg + allServersNext.get(1));
  mt[3].start();
  zk[3]=new ZooKeeper("127.0.0.1:" + ports[3][2],ClientBase.CONNECTION_TIMEOUT,this);
  for (int i=2; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + ports[i][2],CONNECTION_TIMEOUT * 3));
    ReconfigTest.testServerHasConfig(zk[i],allServersNext,null);
  }
  ReconfigTest.testNormalOperation(zk[0],zk[2]);
  ReconfigTest.testNormalOperation(zk[3],zk[1]);
  Assert.assertEquals(nextQuorumCfgSection + "version=200000000",ReconfigTest.testServerHasConfig(zk[2],null,null));
  Assert.assertEquals(nextQuorumCfgSection + "version=200000000",ReconfigTest.testServerHasConfig(zk[3],null,null));
  for (int i=0; i < SERVER_COUNT; i++) {
    zk[i].close();
    mt[i].shutdown();
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Reconfiguration recovery - test that old config members will join the new
 * config if its already active, and not try to complete the reconfiguration
 */
@Test public void testNextConfigAlreadyActive() throws Exception {
  ClientBase.setupTestEnv();
  final int SERVER_COUNT=5;
  final int clientPorts[]=new int[SERVER_COUNT];
  StringBuilder sb=new StringBuilder();
  String server;
  String currentQuorumCfgSection=null, nextQuorumCfgSection;
  ArrayList<String> allServers=new ArrayList<String>();
  for (int i=0; i < SERVER_COUNT; i++) {
    clientPorts[i]=PortAssignment.unique();
    server="server." + i + "=localhost:"+ PortAssignment.unique()+ ":"+ PortAssignment.unique()+ ":participant;localhost:"+ clientPorts[i];
    allServers.add(server);
    sb.append(server + "\n");
    if (i == 1)     currentQuorumCfgSection=sb.toString();
  }
  nextQuorumCfgSection=sb.toString();
  MainThread mt[]=new MainThread[SERVER_COUNT];
  ZooKeeper zk[]=new ZooKeeper[SERVER_COUNT];
  for (int i=2; i < SERVER_COUNT; i++) {
    mt[i]=new MainThread(i,clientPorts[i],nextQuorumCfgSection,true,"200000000");
    mt[i].start();
    zk[i]=new ZooKeeper("127.0.0.1:" + clientPorts[i],ClientBase.CONNECTION_TIMEOUT,this);
  }
  for (int i=2; i < SERVER_COUNT; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT));
  }
  ReconfigTest.testNormalOperation(zk[2],zk[3]);
  long epoch=mt[2].main.quorumPeer.getAcceptedEpoch();
  for (int i=0; i < 2; i++) {
    mt[i]=new MainThread(i,clientPorts[i],currentQuorumCfgSection,true,"100000000");
    mt[i].writeTempDynamicConfigFile(nextQuorumCfgSection,"200000000");
    mt[i].start();
    zk[i]=new ZooKeeper("127.0.0.1:" + clientPorts[i],ClientBase.CONNECTION_TIMEOUT,this);
  }
  for (int i=0; i < 2; i++) {
    Assert.assertTrue("waiting for server " + i + " being up",ClientBase.waitForServerUp("127.0.0.1:" + clientPorts[i],CONNECTION_TIMEOUT * 2));
  }
  Assert.assertEquals(epoch,mt[0].main.quorumPeer.getAcceptedEpoch());
  Assert.assertEquals(epoch,mt[1].main.quorumPeer.getAcceptedEpoch());
  Assert.assertEquals(epoch,mt[2].main.quorumPeer.getAcceptedEpoch());
  ReconfigTest.testServerHasConfig(zk[0],allServers,null);
  ReconfigTest.testServerHasConfig(zk[1],allServers,null);
  ReconfigTest.testNormalOperation(zk[0],zk[2]);
  ReconfigTest.testNormalOperation(zk[4],zk[1]);
  for (int i=0; i < SERVER_COUNT; i++) {
    zk[i].close();
    mt[i].shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.RemotePeerBeanTest </h4><pre class="type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case for https://issues.apache.org/jira/browse/ZOOKEEPER-2269
 */
@Test public void testGetClientAddressShouldReturnEmptyStringWhenClientAddressIsNull(){
  InetSocketAddress peerCommunicationAddress=null;
  QuorumServer peer=new QuorumServer(1,peerCommunicationAddress);
  RemotePeerBean remotePeerBean=new RemotePeerBean(peer);
  String clientAddress=remotePeerBean.getClientAddress();
  assertNotNull(clientAddress);
  assertEquals(0,clientAddress.length());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.WatchLeakTest </h4><pre class="type-10 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Check that if session has expired then no watch can be set
 */
@Test public void testWatchesLeak() throws Exception {
  NIOServerCnxnFactory serverCnxnFactory=mock(NIOServerCnxnFactory.class);
  final SelectionKey sk=new FakeSK();
  MockSelectorThread selectorThread=mock(MockSelectorThread.class);
  when(selectorThread.addInterestOpsUpdateRequest(any(SelectionKey.class))).thenAnswer(new Answer<Boolean>(){
    @Override public Boolean answer(    InvocationOnMock invocation) throws Throwable {
      SelectionKey sk=(SelectionKey)invocation.getArguments()[0];
      NIOServerCnxn nioSrvCnx=(NIOServerCnxn)sk.attachment();
      sk.interestOps(nioSrvCnx.getInterestOps());
      return true;
    }
  }
);
  ZKDatabase database=new ZKDatabase(null);
  database.setlastProcessedZxid(2L);
  QuorumPeer quorumPeer=mock(QuorumPeer.class);
  FileTxnSnapLog logfactory=mock(FileTxnSnapLog.class);
  when(logfactory.getDataDir()).thenReturn(new File(""));
  when(logfactory.getSnapDir()).thenReturn(new File(""));
  FollowerZooKeeperServer fzks=null;
  try {
    fzks=new FollowerZooKeeperServer(logfactory,quorumPeer,database);
    fzks.startup();
    fzks.setServerCnxnFactory(serverCnxnFactory);
    quorumPeer.follower=new MyFollower(quorumPeer,fzks);
    LOG.info("Follower created");
    final SocketChannel socketChannel=createClientSocketChannel();
    final MockNIOServerCnxn nioCnxn=new MockNIOServerCnxn(fzks,socketChannel,sk,serverCnxnFactory,selectorThread);
    sk.attach(nioCnxn);
    nioCnxn.doIO(sk);
    LOG.info("Client connection sent");
    QuorumPacket qp=createValidateSessionPacketResponse(!sessionTimedout);
    quorumPeer.follower.processPacket(qp);
    LOG.info("Session validation sent");
    nioCnxn.doIO(sk);
    Thread.sleep(1000L);
    LOG.info("Watches processed");
    int watchCount=database.getDataTree().getWatchCount();
    if (sessionTimedout) {
      LOG.info("session is not valid, watches = {}",watchCount);
      assertEquals("Session is not valid so there should be no watches",0,watchCount);
    }
 else {
      LOG.info("session is valid, watches = {}",watchCount);
      assertEquals("Session is valid so the watch should be there",1,watchCount);
    }
  }
  finally {
    if (fzks != null) {
      fzks.shutdown();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.quorum.Zab1_0Test </h4><pre class="type-5 type-3 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * In this test, the leader sets the last accepted epoch to 5. The call
 * to getEpochToPropose should set epoch to 6 and wait until another 
 * follower executes it. If in getEpochToPropose we don't check if
 * lastAcceptedEpoch == epoch, then the call from the subsequent
 * follower with lastAcceptedEpoch = 6 doesn't change the value
 * of epoch, and the test fails. It passes with the fix to predicate.{@link https://issues.apache.org/jira/browse/ZOOKEEPER-1343}
 * @throws Exception
 */
@Test public void testLastAcceptedEpoch() throws Exception {
  File tmpDir=File.createTempFile("test","dir",testData);
  tmpDir.delete();
  tmpDir.mkdir();
  Leader leader=null;
  LeadThread leadThread=null;
  try {
    QuorumPeer peer=createQuorumPeer(tmpDir);
    leader=createMockLeader(tmpDir,peer);
    peer.leader=leader;
    peer.setAcceptedEpoch(5);
    leadThread=new LeadThread(leader);
    leadThread.start();
    while (((MockLeader)leader).getCurrentEpochToPropose() != 6) {
      Thread.sleep(20);
    }
    try {
      long epoch=leader.getEpochToPropose(1,6);
      Assert.assertEquals("New proposed epoch is wrong",7,epoch);
    }
 catch (    Exception e) {
      Assert.fail("Timed out in getEpochToPropose");
    }
  }
  finally {
    if (leader != null) {
      leader.shutdown("end of test");
    }
    if (leadThread != null) {
      leadThread.interrupt();
      leadThread.join();
    }
    TestUtils.deleteFileRecursively(tmpDir);
  }
}

</code></pre>

<br>
<pre class="type-3 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTxnTimeout() throws Exception {
  testLeaderConversation(new LeaderConversation(){
    public void converseWithLeader(    InputArchive ia,    OutputArchive oa,    Leader l) throws IOException, InterruptedException, org.apache.zookeeper.server.quorum.Leader.XidRolloverException {
      Assert.assertEquals(0,l.self.getAcceptedEpoch());
      Assert.assertEquals(0,l.self.getCurrentEpoch());
      LearnerInfo li=new LearnerInfo(1,0x10000,0);
      byte liBytes[]=new byte[20];
      ByteBufferOutputStream.record2ByteBuffer(li,ByteBuffer.wrap(liBytes));
      QuorumPacket qp=new QuorumPacket(Leader.FOLLOWERINFO,0,liBytes,null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.LEADERINFO,qp.getType());
      Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
      Assert.assertEquals(ByteBuffer.wrap(qp.getData()).getInt(),0x10000);
      Assert.assertEquals(1,l.self.getAcceptedEpoch());
      Assert.assertEquals(0,l.self.getCurrentEpoch());
      qp=new QuorumPacket(Leader.ACKEPOCH,0,new byte[4],null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.DIFF,qp.getType());
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.NEWLEADER,qp.getType());
      Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
      Assert.assertEquals(1,l.self.getAcceptedEpoch());
      Assert.assertEquals(1,l.self.getCurrentEpoch());
      qp=new QuorumPacket(Leader.ACK,qp.getZxid(),null,null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.UPTODATE,qp.getType());
      long zxid=l.zk.getZxid();
      l.propose(new Request(1,1,ZooDefs.OpCode.create,new TxnHeader(1,1,zxid,1,ZooDefs.OpCode.create),new CreateTxn("/test","hola".getBytes(),null,true,0),zxid));
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.PROPOSAL,qp.getType());
      LOG.info("Proposal sent.");
      for (int i=0; i < (2 * SYNC_LIMIT) + 2; i++) {
        try {
          ia.readRecord(qp,null);
          LOG.info("Ping received: " + i);
          qp=new QuorumPacket(Leader.PING,qp.getZxid(),"".getBytes(),null);
          oa.writeRecord(qp,null);
        }
 catch (        EOFException e) {
          return;
        }
      }
      Assert.fail("Connection hasn't been closed by leader after transaction times out.");
    }
  }
);
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLeaderBehind() throws Exception {
  testLeaderConversation(new LeaderConversation(){
    public void converseWithLeader(    InputArchive ia,    OutputArchive oa,    Leader l) throws IOException {
      LearnerInfo li=new LearnerInfo(1,0x10000,0);
      byte liBytes[]=new byte[20];
      ByteBufferOutputStream.record2ByteBuffer(li,ByteBuffer.wrap(liBytes));
      QuorumPacket qp=new QuorumPacket(Leader.FOLLOWERINFO,ZxidUtils.makeZxid(20,0),liBytes,null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.LEADERINFO,qp.getType());
      Assert.assertEquals(ZxidUtils.makeZxid(21,0),qp.getZxid());
      Assert.assertEquals(ByteBuffer.wrap(qp.getData()).getInt(),0x10000);
      qp=new QuorumPacket(Leader.ACKEPOCH,0,new byte[4],null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.DIFF,qp.getType());
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.NEWLEADER,qp.getType());
      Assert.assertEquals(ZxidUtils.makeZxid(21,0),qp.getZxid());
      qp=new QuorumPacket(Leader.ACK,qp.getZxid(),null,null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.UPTODATE,qp.getType());
    }
  }
);
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testNormalFollowerRun() throws Exception {
  testFollowerConversation(new FollowerConversation(){
    @Override public void converseWithFollower(    InputArchive ia,    OutputArchive oa,    Follower f) throws Exception {
      File tmpDir=File.createTempFile("test","dir",testData);
      tmpDir.delete();
      tmpDir.mkdir();
      File logDir=f.fzk.getTxnLogFactory().getDataDir().getParentFile();
      File snapDir=f.fzk.getTxnLogFactory().getSnapDir().getParentFile();
      try {
        Assert.assertEquals(0,f.self.getAcceptedEpoch());
        Assert.assertEquals(0,f.self.getCurrentEpoch());
        ZKDatabase zkDb=new ZKDatabase(new FileTxnSnapLog(tmpDir,tmpDir));
        final long firstZxid=ZxidUtils.makeZxid(1,1);
        zkDb.processTxn(new TxnHeader(13,1313,firstZxid,33,ZooDefs.OpCode.create),new CreateTxn("/foo","data1".getBytes(),ZooDefs.Ids.OPEN_ACL_UNSAFE,false,1));
        Stat stat=new Stat();
        Assert.assertEquals("data1",new String(zkDb.getData("/foo",stat,null)));
        QuorumPacket qp=new QuorumPacket();
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.FOLLOWERINFO,qp.getType());
        Assert.assertEquals(qp.getZxid(),0);
        LearnerInfo learnInfo=new LearnerInfo();
        ByteBufferInputStream.byteBuffer2Record(ByteBuffer.wrap(qp.getData()),learnInfo);
        Assert.assertEquals(learnInfo.getProtocolVersion(),0x10000);
        Assert.assertEquals(learnInfo.getServerid(),0);
        qp.setType(Leader.LEADERINFO);
        qp.setZxid(ZxidUtils.makeZxid(1,0));
        byte protoBytes[]=new byte[4];
        ByteBuffer.wrap(protoBytes).putInt(0x10000);
        qp.setData(protoBytes);
        oa.writeRecord(qp,null);
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACKEPOCH,qp.getType());
        Assert.assertEquals(0,qp.getZxid());
        Assert.assertEquals(ZxidUtils.makeZxid(0,0),ByteBuffer.wrap(qp.getData()).getInt());
        Assert.assertEquals(1,f.self.getAcceptedEpoch());
        Assert.assertEquals(0,f.self.getCurrentEpoch());
        qp.setType(Leader.SNAP);
        qp.setData(new byte[0]);
        qp.setZxid(zkDb.getDataTreeLastProcessedZxid());
        oa.writeRecord(qp,null);
        zkDb.serializeSnapshot(oa);
        oa.writeString("BenWasHere",null);
        qp.setType(Leader.NEWLEADER);
        qp.setZxid(ZxidUtils.makeZxid(1,0));
        oa.writeRecord(qp,null);
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACK,qp.getType());
        Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
        Assert.assertEquals(1,f.self.getAcceptedEpoch());
        Assert.assertEquals(1,f.self.getCurrentEpoch());
        Assert.assertEquals(firstZxid,f.fzk.getLastProcessedZxid());
        ZKDatabase zkDb2=new ZKDatabase(new FileTxnSnapLog(logDir,snapDir));
        long lastZxid=zkDb2.loadDataBase();
        Assert.assertEquals("data1",new String(zkDb2.getData("/foo",stat,null)));
        Assert.assertEquals(firstZxid,lastZxid);
        long proposalZxid=ZxidUtils.makeZxid(1,1000);
        proposeSetData(qp,proposalZxid,"data2",2);
        oa.writeRecord(qp,null);
        TrackerWatcher watcher=new TrackerWatcher();
        Assert.assertEquals("data1",new String(f.fzk.getZKDatabase().getData("/foo",stat,watcher)));
        qp.setType(Leader.COMMIT);
        qp.setZxid(proposalZxid);
        oa.writeRecord(qp,null);
        qp.setType(Leader.UPTODATE);
        qp.setZxid(0);
        oa.writeRecord(qp,null);
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACK,qp.getType());
        Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACK,qp.getType());
        Assert.assertEquals(proposalZxid,qp.getZxid());
        watcher.waitForChange();
        Assert.assertEquals("data2",new String(f.fzk.getZKDatabase().getData("/foo",stat,null)));
        zkDb2=new ZKDatabase(new FileTxnSnapLog(logDir,snapDir));
        lastZxid=zkDb2.loadDataBase();
        Assert.assertEquals("data2",new String(zkDb2.getData("/foo",stat,null)));
        Assert.assertEquals(proposalZxid,lastZxid);
      }
  finally {
        TestUtils.deleteFileRecursively(tmpDir);
      }
    }
    private void proposeSetData(    QuorumPacket qp,    long zxid,    String data,    int version) throws IOException {
      qp.setType(Leader.PROPOSAL);
      qp.setZxid(zxid);
      TxnHeader hdr=new TxnHeader(4,1414,qp.getZxid(),55,ZooDefs.OpCode.setData);
      SetDataTxn sdt=new SetDataTxn("/foo",data.getBytes(),version);
      ByteArrayOutputStream baos=new ByteArrayOutputStream();
      OutputArchive boa=BinaryOutputArchive.getArchive(baos);
      boa.writeRecord(hdr,null);
      boa.writeRecord(sdt,null);
      qp.setData(baos.toByteArray());
    }
  }
);
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNormalRun() throws Exception {
  testLeaderConversation(new LeaderConversation(){
    public void converseWithLeader(    InputArchive ia,    OutputArchive oa,    Leader l) throws IOException {
      Assert.assertEquals(0,l.self.getAcceptedEpoch());
      Assert.assertEquals(0,l.self.getCurrentEpoch());
      LearnerInfo li=new LearnerInfo(1,0x10000,0);
      byte liBytes[]=new byte[20];
      ByteBufferOutputStream.record2ByteBuffer(li,ByteBuffer.wrap(liBytes));
      QuorumPacket qp=new QuorumPacket(Leader.FOLLOWERINFO,0,liBytes,null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.LEADERINFO,qp.getType());
      Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
      Assert.assertEquals(ByteBuffer.wrap(qp.getData()).getInt(),0x10000);
      Assert.assertEquals(1,l.self.getAcceptedEpoch());
      Assert.assertEquals(0,l.self.getCurrentEpoch());
      qp=new QuorumPacket(Leader.ACKEPOCH,0,new byte[4],null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.DIFF,qp.getType());
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.NEWLEADER,qp.getType());
      Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
      Assert.assertEquals(1,l.self.getAcceptedEpoch());
      Assert.assertEquals(1,l.self.getCurrentEpoch());
      qp=new QuorumPacket(Leader.ACK,qp.getZxid(),null,null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.UPTODATE,qp.getType());
    }
  }
);
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInitialAcceptedCurrent() throws Exception {
  File tmpDir=File.createTempFile("test",".dir",testData);
  tmpDir.delete();
  tmpDir.mkdir();
  try {
    FileTxnSnapLog logFactory=new FileTxnSnapLog(tmpDir,tmpDir);
    File version2=new File(tmpDir,"version-2");
    version2.mkdir();
    long zxid=ZxidUtils.makeZxid(3,3);
    logFactory.append(new Request(1,1,ZooDefs.OpCode.error,new TxnHeader(1,1,zxid,1,ZooDefs.OpCode.error),new ErrorTxn(1),zxid));
    logFactory.commit();
    ZKDatabase zkDb=new ZKDatabase(logFactory);
    QuorumPeer peer=new QuorumPeer();
    peer.setZKDatabase(zkDb);
    peer.setTxnFactory(logFactory);
    peer.getLastLoggedZxid();
    Assert.assertEquals(3,peer.getAcceptedEpoch());
    Assert.assertEquals(3,peer.getCurrentEpoch());
    Assert.assertEquals(3,Integer.parseInt(readContentsOfFile(new File(version2,QuorumPeer.CURRENT_EPOCH_FILENAME))));
    Assert.assertEquals(3,Integer.parseInt(readContentsOfFile(new File(version2,QuorumPeer.ACCEPTED_EPOCH_FILENAME))));
  }
  finally {
    TestUtils.deleteFileRecursively(tmpDir);
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that when a quorum of followers send LearnerInfo but do not ack the epoch (which is sent
 * by the leader upon receipt of LearnerInfo from a quorum), the leader does not start using this epoch
 * as it would in the normal case (when a quorum do ack the epoch). This tests ZK-1192
 * @throws Exception
 */
@Test public void testAbandonBeforeACKEpoch() throws Exception {
  testLeaderConversation(new LeaderConversation(){
    public void converseWithLeader(    InputArchive ia,    OutputArchive oa,    Leader l) throws IOException, InterruptedException {
      LearnerInfo li=new LearnerInfo(1,0x10000,0);
      byte liBytes[]=new byte[20];
      ByteBufferOutputStream.record2ByteBuffer(li,ByteBuffer.wrap(liBytes));
      QuorumPacket qp=new QuorumPacket(Leader.FOLLOWERINFO,0,liBytes,null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.LEADERINFO,qp.getType());
      Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
      Assert.assertEquals(ByteBuffer.wrap(qp.getData()).getInt(),0x10000);
      Thread.sleep(l.self.getInitLimit() * l.self.getTickTime() + 5000);
      Assert.assertEquals(0,l.self.getCurrentEpoch());
    }
  }
);
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnnecessarySnap() throws Exception {
  testPopulatedLeaderConversation(new PopulatedLeaderConversation(){
    @Override public void converseWithLeader(    InputArchive ia,    OutputArchive oa,    Leader l,    long zxid) throws Exception {
      Assert.assertEquals(1,l.self.getAcceptedEpoch());
      Assert.assertEquals(1,l.self.getCurrentEpoch());
      LearnerInfo li=new LearnerInfo(1,0x10000,0);
      byte liBytes[]=new byte[20];
      ByteBufferOutputStream.record2ByteBuffer(li,ByteBuffer.wrap(liBytes));
      QuorumPacket qp=new QuorumPacket(Leader.FOLLOWERINFO,1,liBytes,null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.LEADERINFO,qp.getType());
      Assert.assertEquals(ZxidUtils.makeZxid(2,0),qp.getZxid());
      Assert.assertEquals(ByteBuffer.wrap(qp.getData()).getInt(),0x10000);
      Assert.assertEquals(2,l.self.getAcceptedEpoch());
      Assert.assertEquals(1,l.self.getCurrentEpoch());
      byte epochBytes[]=new byte[4];
      final ByteBuffer wrappedEpochBytes=ByteBuffer.wrap(epochBytes);
      wrappedEpochBytes.putInt(1);
      qp=new QuorumPacket(Leader.ACKEPOCH,zxid,epochBytes,null);
      oa.writeRecord(qp,null);
      readPacketSkippingPing(ia,qp);
      Assert.assertEquals(Leader.DIFF,qp.getType());
    }
  }
,2);
}

</code></pre>

<br>
<pre class="type-5 type-3 type-6 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeaderInConnectingFollowers() throws Exception {
  File tmpDir=File.createTempFile("test","dir",testData);
  tmpDir.delete();
  tmpDir.mkdir();
  Leader leader=null;
  try {
    QuorumPeer peer=createQuorumPeer(tmpDir);
    leader=createLeader(tmpDir,peer);
    peer.leader=leader;
    peer.setAcceptedEpoch(5);
    FollowerMockThread f1=new FollowerMockThread(1,leader,true);
    FollowerMockThread f2=new FollowerMockThread(2,leader,true);
    f1.start();
    f2.start();
    f1.join(leader.self.getInitLimit() * leader.self.getTickTime() + 5000);
    f2.join(leader.self.getInitLimit() * leader.self.getTickTime() + 5000);
    try {
      long epoch=leader.getEpochToPropose(leader.self.getId(),leader.self.getAcceptedEpoch());
      Assert.assertEquals("leader got wrong epoch from getEpochToPropose",6,epoch);
    }
 catch (    Exception e) {
      Assert.fail("leader timed out in getEpochToPropose");
    }
  }
  finally {
    if (leader != null) {
      leader.shutdown("end of test");
    }
    TestUtils.deleteFileRecursively(tmpDir);
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-8 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalFollowerRunWithDiff() throws Exception {
  testFollowerConversation(new FollowerConversation(){
    @Override public void converseWithFollower(    InputArchive ia,    OutputArchive oa,    Follower f) throws Exception {
      File tmpDir=File.createTempFile("test","dir",testData);
      tmpDir.delete();
      tmpDir.mkdir();
      File logDir=f.fzk.getTxnLogFactory().getDataDir().getParentFile();
      File snapDir=f.fzk.getTxnLogFactory().getSnapDir().getParentFile();
      try {
        Assert.assertEquals(0,f.self.getAcceptedEpoch());
        Assert.assertEquals(0,f.self.getCurrentEpoch());
        ZKDatabase zkDb=new ZKDatabase(new FileTxnSnapLog(tmpDir,tmpDir));
        final long firstZxid=ZxidUtils.makeZxid(1,1);
        zkDb.processTxn(new TxnHeader(13,1313,firstZxid,33,ZooDefs.OpCode.create),new CreateTxn("/foo","data1".getBytes(),ZooDefs.Ids.OPEN_ACL_UNSAFE,false,1));
        Stat stat=new Stat();
        Assert.assertEquals("data1",new String(zkDb.getData("/foo",stat,null)));
        QuorumPacket qp=new QuorumPacket();
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.FOLLOWERINFO,qp.getType());
        Assert.assertEquals(qp.getZxid(),0);
        LearnerInfo learnInfo=new LearnerInfo();
        ByteBufferInputStream.byteBuffer2Record(ByteBuffer.wrap(qp.getData()),learnInfo);
        Assert.assertEquals(learnInfo.getProtocolVersion(),0x10000);
        Assert.assertEquals(learnInfo.getServerid(),0);
        qp.setType(Leader.LEADERINFO);
        qp.setZxid(ZxidUtils.makeZxid(1,0));
        byte protoBytes[]=new byte[4];
        ByteBuffer.wrap(protoBytes).putInt(0x10000);
        qp.setData(protoBytes);
        oa.writeRecord(qp,null);
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACKEPOCH,qp.getType());
        Assert.assertEquals(0,qp.getZxid());
        Assert.assertEquals(ZxidUtils.makeZxid(0,0),ByteBuffer.wrap(qp.getData()).getInt());
        Assert.assertEquals(1,f.self.getAcceptedEpoch());
        Assert.assertEquals(0,f.self.getCurrentEpoch());
        qp.setType(Leader.DIFF);
        qp.setData(new byte[0]);
        qp.setZxid(zkDb.getDataTreeLastProcessedZxid());
        oa.writeRecord(qp,null);
        final long createSessionZxid=ZxidUtils.makeZxid(1,2);
        proposeNewSession(qp,createSessionZxid,0x333);
        oa.writeRecord(qp,null);
        qp.setType(Leader.COMMIT);
        qp.setZxid(createSessionZxid);
        oa.writeRecord(qp,null);
        qp.setType(Leader.NEWLEADER);
        qp.setZxid(ZxidUtils.makeZxid(1,0));
        qp.setData(null);
        oa.writeRecord(qp,null);
        qp.setType(Leader.UPTODATE);
        qp.setZxid(0);
        oa.writeRecord(qp,null);
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACK,qp.getType());
        Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACK,qp.getType());
        Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
        Assert.assertEquals(1,f.self.getAcceptedEpoch());
        Assert.assertEquals(1,f.self.getCurrentEpoch());
        Assert.assertEquals(createSessionZxid,f.fzk.getLastProcessedZxid());
        ZKDatabase zkDb2=new ZKDatabase(new FileTxnSnapLog(logDir,snapDir));
        zkDb2.loadDataBase();
        LOG.info("zkdb2 sessions:" + zkDb2.getSessions());
        Assert.assertNotNull(zkDb2.getSessionWithTimeOuts().get(4L));
      }
  finally {
        TestUtils.deleteFileRecursively(tmpDir);
      }
    }
    private void proposeNewSession(    QuorumPacket qp,    long zxid,    long sessionId) throws IOException {
      qp.setType(Leader.PROPOSAL);
      qp.setZxid(zxid);
      TxnHeader hdr=new TxnHeader(4,1414,qp.getZxid(),55,ZooDefs.OpCode.createSession);
      CreateSessionTxn cst=new CreateSessionTxn(30000);
      ByteArrayOutputStream baos=new ByteArrayOutputStream();
      OutputArchive boa=BinaryOutputArchive.getArchive(baos);
      boa.writeRecord(hdr,null);
      boa.writeRecord(cst,null);
      qp.setData(baos.toByteArray());
    }
  }
);
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testNormalObserverRun() throws Exception {
  testObserverConversation(new ObserverConversation(){
    @Override public void converseWithObserver(    InputArchive ia,    OutputArchive oa,    Observer o) throws Exception {
      File tmpDir=File.createTempFile("test","dir",testData);
      tmpDir.delete();
      tmpDir.mkdir();
      File logDir=o.zk.getTxnLogFactory().getDataDir().getParentFile();
      File snapDir=o.zk.getTxnLogFactory().getSnapDir().getParentFile();
      try {
        Assert.assertEquals(0,o.self.getAcceptedEpoch());
        Assert.assertEquals(0,o.self.getCurrentEpoch());
        ZKDatabase zkDb=new ZKDatabase(new FileTxnSnapLog(tmpDir,tmpDir));
        final long foo1Zxid=ZxidUtils.makeZxid(1,1);
        final long foo2Zxid=ZxidUtils.makeZxid(1,2);
        zkDb.processTxn(new TxnHeader(13,1313,foo1Zxid,33,ZooDefs.OpCode.create),new CreateTxn("/foo1","data1".getBytes(),ZooDefs.Ids.OPEN_ACL_UNSAFE,false,1));
        zkDb.processTxn(new TxnHeader(13,1313,foo2Zxid,33,ZooDefs.OpCode.create),new CreateTxn("/foo2","data1".getBytes(),ZooDefs.Ids.OPEN_ACL_UNSAFE,false,1));
        Stat stat=new Stat();
        Assert.assertEquals("data1",new String(zkDb.getData("/foo1",stat,null)));
        Assert.assertEquals("data1",new String(zkDb.getData("/foo2",stat,null)));
        QuorumPacket qp=new QuorumPacket();
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.OBSERVERINFO,qp.getType());
        Assert.assertEquals(qp.getZxid(),0);
        LearnerInfo learnInfo=new LearnerInfo();
        ByteBufferInputStream.byteBuffer2Record(ByteBuffer.wrap(qp.getData()),learnInfo);
        Assert.assertEquals(learnInfo.getProtocolVersion(),0x10000);
        Assert.assertEquals(learnInfo.getServerid(),0);
        qp.setType(Leader.LEADERINFO);
        qp.setZxid(ZxidUtils.makeZxid(1,0));
        byte protoBytes[]=new byte[4];
        ByteBuffer.wrap(protoBytes).putInt(0x10000);
        qp.setData(protoBytes);
        oa.writeRecord(qp,null);
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACKEPOCH,qp.getType());
        Assert.assertEquals(0,qp.getZxid());
        Assert.assertEquals(ZxidUtils.makeZxid(0,0),ByteBuffer.wrap(qp.getData()).getInt());
        Assert.assertEquals(1,o.self.getAcceptedEpoch());
        Assert.assertEquals(0,o.self.getCurrentEpoch());
        qp.setType(Leader.SNAP);
        qp.setData(new byte[0]);
        qp.setZxid(zkDb.getDataTreeLastProcessedZxid());
        oa.writeRecord(qp,null);
        zkDb.serializeSnapshot(oa);
        oa.writeString("BenWasHere",null);
        qp.setType(Leader.NEWLEADER);
        qp.setZxid(ZxidUtils.makeZxid(1,0));
        oa.writeRecord(qp,null);
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACK,qp.getType());
        Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
        Assert.assertEquals(1,o.self.getAcceptedEpoch());
        Assert.assertEquals(1,o.self.getCurrentEpoch());
        Assert.assertEquals(foo2Zxid,o.zk.getLastProcessedZxid());
        ZKDatabase zkDb2=new ZKDatabase(new FileTxnSnapLog(logDir,snapDir));
        long lastZxid=zkDb2.loadDataBase();
        Assert.assertEquals("data1",new String(zkDb2.getData("/foo1",stat,null)));
        Assert.assertEquals(foo2Zxid,lastZxid);
        TrackerWatcher watcher=new TrackerWatcher();
        Assert.assertEquals("data1",new String(o.zk.getZKDatabase().getData("/foo2",stat,watcher)));
        long proposalZxid=ZxidUtils.makeZxid(1,1000);
        proposeSetData(qp,"/foo1",proposalZxid,"data2",2);
        oa.writeRecord(qp,null);
        qp.setType(Leader.COMMIT);
        qp.setZxid(proposalZxid);
        oa.writeRecord(qp,null);
        long informZxid=ZxidUtils.makeZxid(1,1001);
        proposeSetData(qp,"/foo2",informZxid,"data2",2);
        qp.setType(Leader.INFORM);
        oa.writeRecord(qp,null);
        qp.setType(Leader.UPTODATE);
        qp.setZxid(0);
        oa.writeRecord(qp,null);
        readPacketSkippingPing(ia,qp);
        Assert.assertEquals(Leader.ACK,qp.getType());
        Assert.assertEquals(ZxidUtils.makeZxid(1,0),qp.getZxid());
        watcher.waitForChange();
        Assert.assertEquals("data2",new String(o.zk.getZKDatabase().getData("/foo1",stat,null)));
        Assert.assertEquals("data2",new String(o.zk.getZKDatabase().getData("/foo2",stat,null)));
        o.zk.shutdown();
        zkDb2=new ZKDatabase(new FileTxnSnapLog(logDir,snapDir));
        lastZxid=zkDb2.loadDataBase();
        Assert.assertEquals("data2",new String(zkDb2.getData("/foo1",stat,null)));
        Assert.assertEquals("data2",new String(zkDb2.getData("/foo2",stat,null)));
        Assert.assertEquals(informZxid,lastZxid);
      }
  finally {
        TestUtils.deleteFileRecursively(tmpDir);
      }
    }
    private void proposeSetData(    QuorumPacket qp,    String path,    long zxid,    String data,    int version) throws IOException {
      qp.setType(Leader.PROPOSAL);
      qp.setZxid(zxid);
      TxnHeader hdr=new TxnHeader(4,1414,qp.getZxid(),55,ZooDefs.OpCode.setData);
      SetDataTxn sdt=new SetDataTxn(path,data.getBytes(),version);
      ByteArrayOutputStream baos=new ByteArrayOutputStream();
      OutputArchive boa=BinaryOutputArchive.getArchive(baos);
      boa.writeRecord(hdr,null);
      boa.writeRecord(sdt,null);
      qp.setData(baos.toByteArray());
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.server.util.VerifyingFileFactoryTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileHasCorrectPath(){
  File file=new File("/some/path");
  VerifyingFileFactory vff=new VerifyingFileFactory.Builder(log).build();
  assertEquals(file,vff.create(file.getPath()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.ACLCountTest </h4><pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a node and add 4 ACL values to it, but there are only 2 unique ACL values,
 * and each is repeated once:
 * ACL(ZooDefs.Perms.READ,ZooDefs.Ids.ANYONE_ID_UNSAFE);
 * ACL(ZooDefs.Perms.ALL,ZooDefs.Ids.AUTH_IDS);
 * ACL(ZooDefs.Perms.READ,ZooDefs.Ids.ANYONE_ID_UNSAFE);
 * ACL(ZooDefs.Perms.ALL,ZooDefs.Ids.AUTH_IDS);
 * Even though we've added 4 ACL values, there should only be 2 ACLs for that node,
 * since there are only 2 *unique* ACL values.
 */
@Test public void testAclCount() throws Exception {
  File tmpDir=ClientBase.createTmpDir();
  ClientBase.setupTestEnv();
  ZooKeeperServer zks=new ZooKeeperServer(tmpDir,tmpDir,3000);
  SyncRequestProcessor.setSnapCount(1000);
  final int PORT=Integer.parseInt(HOSTPORT.split(":")[1]);
  ServerCnxnFactory f=ServerCnxnFactory.createFactory(PORT,-1);
  f.startup(zks);
  ZooKeeper zk;
  final ArrayList<ACL> CREATOR_ALL_AND_WORLD_READABLE=new ArrayList<ACL>(){
{
      add(new ACL(ZooDefs.Perms.READ,ZooDefs.Ids.ANYONE_ID_UNSAFE));
      add(new ACL(ZooDefs.Perms.ALL,ZooDefs.Ids.AUTH_IDS));
      add(new ACL(ZooDefs.Perms.READ,ZooDefs.Ids.ANYONE_ID_UNSAFE));
      add(new ACL(ZooDefs.Perms.ALL,ZooDefs.Ids.AUTH_IDS));
    }
  }
;
  try {
    LOG.info("starting up the zookeeper server .. waiting");
    Assert.assertTrue("waiting for server being up",ClientBase.waitForServerUp(HOSTPORT,CONNECTION_TIMEOUT));
    zk=new ZooKeeper(HOSTPORT,CONNECTION_TIMEOUT,this);
    zk.addAuthInfo("digest","pat:test".getBytes());
    zk.setACL("/",Ids.CREATOR_ALL_ACL,-1);
    String path="/path";
    try {
      Assert.assertEquals(4,CREATOR_ALL_AND_WORLD_READABLE.size());
    }
 catch (    Exception e) {
      LOG.error("Something is fundamentally wrong with ArrayList's add() method. add()ing four times to an empty ArrayList should result in an ArrayList with 4 members.");
      throw e;
    }
    zk.create(path,path.getBytes(),CREATOR_ALL_AND_WORLD_READABLE,CreateMode.PERSISTENT);
    List<ACL> acls=zk.getACL("/path",new Stat());
    Assert.assertEquals(2,acls.size());
  }
 catch (  Exception e) {
    Assert.assertTrue(false);
  }
  f.shutdown();
  zks.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.AsyncTest </h4><pre class="type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAsync() throws IOException, InterruptedException, KeeperException {
  ZooKeeper zk=null;
  zk=createClient();
  try {
    zk.addAuthInfo("digest","ben:passwd".getBytes());
    zk.create("/ben",new byte[0],Ids.READ_ACL_UNSAFE,CreateMode.PERSISTENT,this,results);
    zk.create("/ben/2",new byte[0],Ids.CREATOR_ALL_ACL,CreateMode.PERSISTENT,this,results);
    zk.delete("/ben",-1,this,results);
    zk.create("/ben2",new byte[0],Ids.CREATOR_ALL_ACL,CreateMode.PERSISTENT,this,results);
    zk.getData("/ben2",false,this,results);
synchronized (results) {
      while (results.size() < 5) {
        results.wait();
      }
    }
    Assert.assertEquals(0,(int)results.get(0));
    Assert.assertEquals(Code.NOAUTH,Code.get(results.get(1)));
    Assert.assertEquals(0,(int)results.get(2));
    Assert.assertEquals(0,(int)results.get(3));
    Assert.assertEquals(0,(int)results.get(4));
  }
  finally {
    zk.close();
  }
  zk=createClient();
  try {
    zk.addAuthInfo("digest","ben:passwd2".getBytes());
    try {
      zk.getData("/ben2",false,new Stat());
      Assert.fail("Should have received a permission error");
    }
 catch (    KeeperException e) {
      Assert.assertEquals(Code.NOAUTH,e.code());
    }
  }
  finally {
    zk.close();
  }
  zk=createClient();
  try {
    zk.addAuthInfo("digest","ben:passwd".getBytes());
    zk.getData("/ben2",false,new Stat());
  }
  finally {
    zk.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.AtomicFileOutputStreamTest </h4><pre class="type-5 type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case where there is no existing file
 */
@Test public void testWriteNewFile() throws IOException {
  OutputStream fos=new AtomicFileOutputStream(dstFile);
  assertFalse(dstFile.exists());
  fos.write(TEST_STRING.getBytes());
  fos.flush();
  assertFalse(dstFile.exists());
  fos.close();
  assertTrue(dstFile.exists());
  String readBackData=ClientBase.readFile(dstFile);
  assertEquals(TEST_STRING,readBackData);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure the tmp file is cleaned up and dstFile is untouched when
 * aborting an existing file overwrite.
 */
@Test public void testAbortExistingFile() throws IOException {
  FileOutputStream fos1=new FileOutputStream(dstFile);
  fos1.write(TEST_STRING.getBytes());
  fos1.close();
  AtomicFileOutputStream fos2=new AtomicFileOutputStream(dstFile);
  fos2.abort();
  assertEquals(TEST_STRING,ClientBase.readFile(dstFile));
  assertEquals(1,testDir.list().length);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure the tmp file is cleaned up and dstFile is untouched when
 * aborting an existing file overwrite.
 */
@Test public void testAbortExistingFileAfterFlush() throws IOException {
  FileOutputStream fos1=new FileOutputStream(dstFile);
  fos1.write(TEST_STRING.getBytes());
  fos1.close();
  AtomicFileOutputStream fos2=new AtomicFileOutputStream(dstFile);
  fos2.write(TEST_STRING_2.getBytes());
  fos2.flush();
  fos2.abort();
  assertEquals(TEST_STRING,ClientBase.readFile(dstFile));
  assertEquals(1,testDir.list().length);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure the tmp file is cleaned up and dstFile is not created when
 * aborting a new file.
 */
@Test public void testAbortNewFileAfterFlush() throws IOException {
  AtomicFileOutputStream fos=new AtomicFileOutputStream(dstFile);
  fos.write(TEST_STRING.getBytes());
  fos.flush();
  fos.abort();
  assertEquals(0,testDir.list().length);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure the tmp file is cleaned up and dstFile is not created when
 * aborting a new file.
 */
@Test public void testAbortNewFile() throws IOException {
  AtomicFileOutputStream fos=new AtomicFileOutputStream(dstFile);
  fos.abort();
  assertEquals(0,testDir.list().length);
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case where the flush() fails at close time - make sure that we clean
 * up after ourselves and don't touch any existing file at the destination
 */
@Test public void testFailToFlush() throws IOException {
  FileOutputStream fos=new FileOutputStream(dstFile);
  fos.write(TEST_STRING_2.getBytes());
  fos.close();
  OutputStream failingStream=createFailingStream();
  failingStream.write(TEST_STRING.getBytes());
  try {
    failingStream.close();
    fail("Close didn't throw exception");
  }
 catch (  IOException ioe) {
  }
  assertEquals(TEST_STRING_2,ClientBase.readFile(dstFile));
  assertEquals("Temporary file should have been cleaned up",dstFile.getName(),ClientBase.join(",",testDir.list()));
}

</code></pre>

<br>
<pre class="type-5 type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case where there is no existing file
 */
@Test public void testOverwriteFile() throws IOException {
  assertTrue("Creating empty dst file",dstFile.createNewFile());
  OutputStream fos=new AtomicFileOutputStream(dstFile);
  assertTrue("Empty file still exists",dstFile.exists());
  fos.write(TEST_STRING.getBytes());
  fos.flush();
  assertEquals("",ClientBase.readFile(dstFile));
  fos.close();
  String readBackData=ClientBase.readFile(dstFile);
  assertEquals(TEST_STRING,readBackData);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.BufferSizeTest </h4><pre class="type-13 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setMaxBuffer() throws IOException, InterruptedException {
  System.setProperty("jute.maxbuffer","" + TEST_MAXBUFFER);
  assertEquals("Can't set jute.maxbuffer!",TEST_MAXBUFFER,BinaryInputArchive.maxBuffer);
  zk=createClient();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.ChrootTest </h4><pre class="type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChrootSynchronous() throws IOException, InterruptedException, KeeperException {
  ZooKeeper zk1=createClient();
  try {
    zk1.create("/ch1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  }
  finally {
    if (zk1 != null)     zk1.close();
  }
  ZooKeeper zk2=createClient(hostPort + "/ch1");
  try {
    Assert.assertEquals("/ch2",zk2.create("/ch2",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT));
  }
  finally {
    if (zk2 != null)     zk2.close();
  }
  zk1=createClient();
  zk2=createClient(hostPort + "/ch1");
  try {
    MyWatcher w1=new MyWatcher("/ch1");
    Assert.assertNotNull(zk1.exists("/ch1",w1));
    MyWatcher w2=new MyWatcher("/ch1/ch2");
    Assert.assertNotNull(zk1.exists("/ch1/ch2",w2));
    MyWatcher w3=new MyWatcher("/ch2");
    Assert.assertNotNull(zk2.exists("/ch2",w3));
    MyWatcher w4=new MyWatcher("/ch1");
    zk1.getChildren("/ch1",w4);
    MyWatcher w5=new MyWatcher("/");
    zk2.getChildren("/",w5);
    zk1.setData("/ch1","1".getBytes(),-1);
    zk2.setData("/ch2","2".getBytes(),-1);
    Assert.assertTrue(w1.matches());
    Assert.assertTrue(w2.matches());
    Assert.assertTrue(w3.matches());
    try {
      zk2.setData("/ch3","3".getBytes(),-1);
    }
 catch (    KeeperException.NoNodeException e) {
      Assert.assertEquals("/ch3",e.getPath());
    }
    Assert.assertTrue(Arrays.equals("1".getBytes(),zk1.getData("/ch1",false,null)));
    Assert.assertTrue(Arrays.equals("2".getBytes(),zk1.getData("/ch1/ch2",false,null)));
    Assert.assertTrue(Arrays.equals("2".getBytes(),zk2.getData("/ch2",false,null)));
    zk2.delete("/ch2",-1);
    Assert.assertTrue(w4.matches());
    Assert.assertTrue(w5.matches());
    zk1.delete("/ch1",-1);
    Assert.assertNull(zk1.exists("/ch1",false));
    Assert.assertNull(zk1.exists("/ch1/ch2",false));
    Assert.assertNull(zk2.exists("/ch2",false));
  }
  finally {
    if (zk1 != null)     zk1.close();
    if (zk2 != null)     zk2.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.ClientTest </h4><pre class="type-10 type-3 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testACLs() throws Exception {
  ZooKeeper zk=null;
  try {
    zk=createClient();
    try {
      zk.create("/acltest",new byte[0],Ids.CREATOR_ALL_ACL,CreateMode.PERSISTENT);
      Assert.fail("Should have received an invalid acl error");
    }
 catch (    InvalidACLException e) {
      LOG.info("Test successful, invalid acl received : " + e.getMessage());
    }
    try {
      ArrayList<ACL> testACL=new ArrayList<ACL>();
      testACL.add(new ACL(Perms.ALL | Perms.ADMIN,Ids.AUTH_IDS));
      testACL.add(new ACL(Perms.ALL | Perms.ADMIN,new Id("ip","127.0.0.1/8")));
      zk.create("/acltest",new byte[0],testACL,CreateMode.PERSISTENT);
      Assert.fail("Should have received an invalid acl error");
    }
 catch (    InvalidACLException e) {
      LOG.info("Test successful, invalid acl received : " + e.getMessage());
    }
    try {
      ArrayList<ACL> testACL=new ArrayList<ACL>();
      testACL.add(new ACL(Perms.ALL | Perms.ADMIN,new Id()));
      zk.create("/nullidtest",new byte[0],testACL,CreateMode.PERSISTENT);
      Assert.fail("Should have received an invalid acl error");
    }
 catch (    InvalidACLException e) {
      LOG.info("Test successful, invalid acl received : " + e.getMessage());
    }
    zk.addAuthInfo("digest","ben:passwd".getBytes());
    ArrayList<ACL> testACL=new ArrayList<ACL>();
    testACL.add(new ACL(Perms.ALL,new Id("auth","")));
    testACL.add(new ACL(Perms.WRITE,new Id("ip","127.0.0.1")));
    zk.create("/acltest",new byte[0],testACL,CreateMode.PERSISTENT);
    zk.close();
    zk=createClient();
    zk.addAuthInfo("digest","ben:passwd2".getBytes());
    if (skipACL) {
      try {
        zk.getData("/acltest",false,null);
      }
 catch (      KeeperException e) {
        Assert.fail("Badauth reads should succeed with skipACL.");
      }
    }
 else {
      try {
        zk.getData("/acltest",false,null);
        Assert.fail("Should have received a permission error");
      }
 catch (      KeeperException e) {
        Assert.assertEquals(Code.NOAUTH,e.code());
      }
    }
    zk.addAuthInfo("digest","ben:passwd".getBytes());
    zk.getData("/acltest",false,null);
    zk.setACL("/acltest",Ids.OPEN_ACL_UNSAFE,-1);
    zk.close();
    zk=createClient();
    zk.getData("/acltest",false,null);
    List<ACL> acls=zk.getACL("/acltest",new Stat());
    Assert.assertEquals(1,acls.size());
    Assert.assertEquals(Ids.OPEN_ACL_UNSAFE,acls);
    acls=zk.getACL("/acltest",null);
    Assert.assertEquals(1,acls.size());
    Assert.assertEquals(Ids.OPEN_ACL_UNSAFE,acls);
    zk.close();
  }
  finally {
    if (zk != null) {
      zk.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-8 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Register multiple watchers and verify that they all get notified and
 * in the right order.
 */
@Test public void testMutipleWatcherObjs() throws IOException, InterruptedException, KeeperException {
  ZooKeeper zk=createClient(new CountdownWatcher(),hostPort);
  try {
    MyWatcher watchers[]=new MyWatcher[100];
    MyWatcher watchers2[]=new MyWatcher[watchers.length];
    for (int i=0; i < watchers.length; i++) {
      watchers[i]=new MyWatcher();
      watchers2[i]=new MyWatcher();
      zk.create("/foo-" + i,("foodata" + i).getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    }
    Stat stat=new Stat();
    for (int i=0; i < watchers.length; i++) {
      Assert.assertNotNull(zk.getData("/foo-" + i,watchers[i],stat));
    }
    for (int i=0; i < watchers.length; i++) {
      Assert.assertNotNull(zk.exists("/foo-" + i,watchers[i]));
    }
    for (int i=0; i < watchers.length; i++) {
      zk.setData("/foo-" + i,("foodata2-" + i).getBytes(),-1);
      zk.setData("/foo-" + i,("foodata3-" + i).getBytes(),-1);
    }
    for (int i=0; i < watchers.length; i++) {
      WatchedEvent event=watchers[i].events.poll(10,TimeUnit.SECONDS);
      Assert.assertEquals("/foo-" + i,event.getPath());
      Assert.assertEquals(EventType.NodeDataChanged,event.getType());
      Assert.assertEquals(KeeperState.SyncConnected,event.getState());
      Assert.assertEquals(0,watchers[i].events.size());
    }
    for (int i=0; i < watchers.length; i++) {
      Assert.assertNotNull(zk.getData("/foo-" + i,watchers[i],stat));
      Assert.assertNotNull(zk.exists("/foo-" + i,watchers[i]));
    }
    for (int i=0; i < watchers.length; i++) {
      zk.setData("/foo-" + i,("foodata4-" + i).getBytes(),-1);
      zk.setData("/foo-" + i,("foodata5-" + i).getBytes(),-1);
    }
    for (int i=0; i < watchers.length; i++) {
      WatchedEvent event=watchers[i].events.poll(10,TimeUnit.SECONDS);
      Assert.assertEquals("/foo-" + i,event.getPath());
      Assert.assertEquals(EventType.NodeDataChanged,event.getType());
      Assert.assertEquals(KeeperState.SyncConnected,event.getState());
      Assert.assertEquals(0,watchers[i].events.size());
    }
    for (int i=0; i < watchers.length; i++) {
      Assert.assertNotNull(zk.getData("/foo-" + i,watchers[i],stat));
      Assert.assertNotNull(zk.exists("/foo-" + i,watchers2[i]));
    }
    for (int i=0; i < watchers.length; i++) {
      zk.setData("/foo-" + i,("foodata6-" + i).getBytes(),-1);
      zk.setData("/foo-" + i,("foodata7-" + i).getBytes(),-1);
    }
    for (int i=0; i < watchers.length; i++) {
      WatchedEvent event=watchers[i].events.poll(10,TimeUnit.SECONDS);
      Assert.assertEquals("/foo-" + i,event.getPath());
      Assert.assertEquals(EventType.NodeDataChanged,event.getType());
      Assert.assertEquals(KeeperState.SyncConnected,event.getState());
      Assert.assertEquals(0,watchers[i].events.size());
      WatchedEvent event2=watchers2[i].events.poll(10,TimeUnit.SECONDS);
      Assert.assertEquals("/foo-" + i,event2.getPath());
      Assert.assertEquals(EventType.NodeDataChanged,event2.getType());
      Assert.assertEquals(KeeperState.SyncConnected,event2.getState());
      Assert.assertEquals(0,watchers2[i].events.size());
    }
  }
  finally {
    if (zk != null) {
      zk.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteWithChildren() throws Exception {
  ZooKeeper zk=createClient();
  zk.create("/parent",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk.create("/parent/child",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  try {
    zk.delete("/parent",-1);
    Assert.fail("Should have received a not equals message");
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NOTEMPTY,e.code());
  }
  zk.delete("/parent/child",-1);
  zk.delete("/parent",-1);
  zk.close();
}

</code></pre>

<br>
<pre class="type-5 type-6 type-15 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequentialNodeData() throws Exception {
  ZooKeeper zk=null;
  String queue_handle="/queue";
  try {
    zk=createClient();
    zk.create(queue_handle,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    zk.create(queue_handle + "/element","0".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
    zk.create(queue_handle + "/element","1".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
    List<String> children=zk.getChildren(queue_handle,true);
    Assert.assertEquals(children.size(),2);
    String child1=children.get(0);
    String child2=children.get(1);
    int compareResult=child1.compareTo(child2);
    Assert.assertNotSame(compareResult,0);
    if (compareResult < 0) {
    }
 else {
      String temp=child1;
      child1=child2;
      child2=temp;
    }
    String child1data=new String(zk.getData(queue_handle + "/" + child1,false,null));
    String child2data=new String(zk.getData(queue_handle + "/" + child2,false,null));
    Assert.assertEquals(child1data,"0");
    Assert.assertEquals(child2data,"1");
  }
  finally {
    if (zk != null) {
      zk.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-3 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullAuthId() throws Exception {
  ZooKeeper zk=null;
  try {
    zk=createClient();
    zk.addAuthInfo("digest","ben:passwd".getBytes());
    ArrayList<ACL> testACL=new ArrayList<ACL>();
    testACL.add(new ACL(Perms.ALL,new Id("auth",null)));
    zk.create("/acltest",new byte[0],testACL,CreateMode.PERSISTENT);
    zk.close();
    zk=createClient();
    zk.addAuthInfo("digest","ben:passwd2".getBytes());
    if (skipACL) {
      try {
        zk.getData("/acltest",false,null);
      }
 catch (      KeeperException e) {
        Assert.fail("Badauth reads should succeed with skipACL.");
      }
    }
 else {
      try {
        zk.getData("/acltest",false,null);
        Assert.fail("Should have received a permission error");
      }
 catch (      KeeperException e) {
        Assert.assertEquals(Code.NOAUTH,e.code());
      }
    }
    zk.addAuthInfo("digest","ben:passwd".getBytes());
    zk.getData("/acltest",false,null);
    zk.setACL("/acltest",Ids.OPEN_ACL_UNSAFE,-1);
    zk.close();
    zk=createClient();
    zk.getData("/acltest",false,null);
    List<ACL> acls=zk.getACL("/acltest",new Stat());
    Assert.assertEquals(1,acls.size());
    Assert.assertEquals(Ids.OPEN_ACL_UNSAFE,acls);
  }
  finally {
    if (zk != null) {
      zk.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequentialNodeNames() throws IOException, InterruptedException, KeeperException {
  String path="/SEQUENCE";
  String file="TEST";
  String filepath=path + "/" + file;
  ZooKeeper zk=null;
  try {
    zk=createClient();
    zk.create(path,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    zk.create(filepath,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
    List<String> children=zk.getChildren(path,false);
    Assert.assertEquals(1,children.size());
    Assert.assertEquals(file + "0000000000",children.get(0));
    zk.create(filepath,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
    children=zk.getChildren(path,false);
    Assert.assertEquals(2,children.size());
    Assert.assertTrue("contains child 1",children.contains(file + "0000000001"));
    zk.create(filepath,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
    children=zk.getChildren(path,false);
    Assert.assertEquals(3,children.size());
    Assert.assertTrue("contains child 2",children.contains(file + "0000000002"));
    for (int i=children.size(); i < 105; i++)     zk.create(filepath,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
    children=zk.getChildren(path,false);
    Assert.assertTrue("contains child 104",children.contains(file + "0000000104"));
  }
  finally {
    if (zk != null)     zk.close();
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * We create a perfectly valid 'exists' request, except that the opcode is wrong.
 * @return
 * @throws Exception
 */
@Test public void testNonExistingOpCode() throws Exception {
  TestableZooKeeper zk=createClient();
  final String path="/m1";
  RequestHeader h=new RequestHeader();
  h.setType(888);
  ExistsRequest request=new ExistsRequest();
  request.setPath(path);
  request.setWatch(false);
  ExistsResponse response=new ExistsResponse();
  ReplyHeader r=zk.submitRequest(h,request,response,null);
  Assert.assertEquals(r.getErr(),Code.UNIMPLEMENTED.intValue());
  zk.testableWaitForShutdown(CONNECTION_TIMEOUT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.ConnectStringParserTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseServersWithPort(){
  String servers="10.10.10.1:112,10.10.10.2:110";
  ConnectStringParser parser=new ConnectStringParser(servers);
  Assert.assertEquals("10.10.10.1",parser.getServerAddresses().get(0).getHostString());
  Assert.assertEquals("10.10.10.2",parser.getServerAddresses().get(1).getHostString());
  Assert.assertEquals(112,parser.getServerAddresses().get(0).getPort());
  Assert.assertEquals(110,parser.getServerAddresses().get(1).getPort());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseServersWithoutPort(){
  String servers="10.10.10.1,10.10.10.2";
  ConnectStringParser parser=new ConnectStringParser(servers);
  Assert.assertEquals("10.10.10.1",parser.getServerAddresses().get(0).getHostString());
  Assert.assertEquals("10.10.10.2",parser.getServerAddresses().get(1).getHostString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.CreateModeTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFlagConversion() throws KeeperException {
  EnumSet<CreateMode> allModes=EnumSet.allOf(CreateMode.class);
  for (  CreateMode cm : allModes) {
    Assert.assertEquals(cm,CreateMode.fromFlag(cm.toFlag()));
  }
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicCreateMode(){
  CreateMode cm=CreateMode.PERSISTENT;
  Assert.assertEquals(cm.toFlag(),0);
  Assert.assertFalse(cm.isEphemeral());
  Assert.assertFalse(cm.isSequential());
  Assert.assertFalse(cm.isContainer());
  cm=CreateMode.EPHEMERAL;
  Assert.assertEquals(cm.toFlag(),1);
  Assert.assertTrue(cm.isEphemeral());
  Assert.assertFalse(cm.isSequential());
  Assert.assertFalse(cm.isContainer());
  cm=CreateMode.PERSISTENT_SEQUENTIAL;
  Assert.assertEquals(cm.toFlag(),2);
  Assert.assertFalse(cm.isEphemeral());
  Assert.assertTrue(cm.isSequential());
  Assert.assertFalse(cm.isContainer());
  cm=CreateMode.EPHEMERAL_SEQUENTIAL;
  Assert.assertEquals(cm.toFlag(),3);
  Assert.assertTrue(cm.isEphemeral());
  Assert.assertTrue(cm.isSequential());
  Assert.assertFalse(cm.isContainer());
  cm=CreateMode.CONTAINER;
  Assert.assertEquals(cm.toFlag(),4);
  Assert.assertFalse(cm.isEphemeral());
  Assert.assertFalse(cm.isSequential());
  Assert.assertTrue(cm.isContainer());
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidFlagConversion() throws KeeperException {
  try {
    CreateMode.fromFlag(99);
    Assert.fail("Shouldn't be able to convert 99 to a CreateMode.");
  }
 catch (  KeeperException ke) {
    Assert.assertEquals(Code.BADARGUMENTS,ke.code());
  }
  try {
    CreateMode.fromFlag(-1);
    Assert.fail("Shouldn't be able to convert -1 to a CreateMode.");
  }
 catch (  KeeperException ke) {
    Assert.assertEquals(Code.BADARGUMENTS,ke.code());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.DisconnectedWatcherTest </h4><pre class="type-5 type-6 type-8 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChildWatcherAutoResetWithChroot() throws Exception {
  ZooKeeper zk1=createClient();
  zk1.create("/ch1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher watcher=new MyWatcher();
  ZooKeeper zk2=createClient(watcher,hostPort + "/ch1");
  zk2.getChildren("/",true);
  zk1.create("/youdontmatter1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk1.create("/ch1/youshouldmatter1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  WatchedEvent e=watcher.events.poll(TIMEOUT,TimeUnit.MILLISECONDS);
  Assert.assertNotNull(e);
  Assert.assertEquals(EventType.NodeChildrenChanged,e.getType());
  Assert.assertEquals("/",e.getPath());
  MyWatcher childWatcher=new MyWatcher();
  zk2.getChildren("/",childWatcher);
  stopServer();
  watcher.waitForDisconnected(3000);
  startServer();
  watcher.waitForConnected(3000);
  zk1.create("/ch1/youshouldmatter2",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  e=childWatcher.events.poll(TIMEOUT,TimeUnit.MILLISECONDS);
  Assert.assertNotNull(e);
  Assert.assertEquals(EventType.NodeChildrenChanged,e.getType());
  Assert.assertEquals("/",e.getPath());
}

</code></pre>

<br>
<pre class="type-5 type-10 type-6 type-8 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManyChildWatchersAutoReset() throws Exception {
  ZooKeeper zk1=createClient();
  MyWatcher watcher=new MyWatcher();
  ZooKeeper zk2=createClient(watcher);
  String pathBase="/long-path-000000000-111111111-222222222-333333333-444444444-" + "555555555-666666666-777777777-888888888-999999999";
  zk1.create(pathBase,null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  List<String> paths=new ArrayList<String>();
  for (int i=0; i < 10000; i++) {
    String path=zk1.create(pathBase + "/ch-",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
    paths.add(path);
  }
  MyWatcher childWatcher=new MyWatcher();
  int i=0;
  for (  String path : paths) {
    if (i % 3 == 0) {
      zk2.getChildren(path,childWatcher);
    }
 else     if (i % 3 == 1) {
      zk2.exists(path + "/foo",childWatcher);
    }
 else     if (i % 3 == 2) {
      zk2.getData(path,childWatcher,null);
    }
    i++;
  }
  stopServer();
  watcher.waitForDisconnected(30000);
  startServer();
  watcher.waitForConnected(30000);
  i=0;
  for (  String path : paths) {
    if (i % 3 == 0) {
      zk1.create(path + "/ch",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      WatchedEvent e=childWatcher.events.poll(TIMEOUT,TimeUnit.MILLISECONDS);
      Assert.assertNotNull(e);
      Assert.assertEquals(EventType.NodeChildrenChanged,e.getType());
      Assert.assertEquals(path,e.getPath());
    }
 else     if (i % 3 == 1) {
      zk1.create(path + "/foo",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      WatchedEvent e=childWatcher.events.poll(TIMEOUT,TimeUnit.MILLISECONDS);
      Assert.assertNotNull(e);
      Assert.assertEquals(EventType.NodeCreated,e.getType());
      Assert.assertEquals(path + "/foo",e.getPath());
    }
 else     if (i % 3 == 2) {
      zk1.setData(path,new byte[]{1,2,3},-1);
      WatchedEvent e=childWatcher.events.poll(TIMEOUT,TimeUnit.MILLISECONDS);
      Assert.assertNotNull(e);
      Assert.assertEquals(EventType.NodeDataChanged,e.getType());
      Assert.assertEquals(path,e.getPath());
    }
    i++;
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-8 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultWatcherAutoResetWithChroot() throws Exception {
  ZooKeeper zk1=createClient();
  zk1.create("/ch1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher watcher=new MyWatcher();
  ZooKeeper zk2=createClient(watcher,hostPort + "/ch1");
  zk2.getChildren("/",true);
  zk1.create("/youdontmatter1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk1.create("/ch1/youshouldmatter1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  WatchedEvent e=watcher.events.poll(TIMEOUT,TimeUnit.MILLISECONDS);
  Assert.assertNotNull(e);
  Assert.assertEquals(EventType.NodeChildrenChanged,e.getType());
  Assert.assertEquals("/",e.getPath());
  zk2.getChildren("/",true);
  stopServer();
  watcher.waitForDisconnected(3000);
  startServer();
  watcher.waitForConnected(3000);
  zk1.create("/ch1/youshouldmatter2",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  e=watcher.events.poll(TIMEOUT,TimeUnit.MILLISECONDS);
  Assert.assertNotNull(e);
  Assert.assertEquals(EventType.NodeChildrenChanged,e.getType());
  Assert.assertEquals("/",e.getPath());
}

</code></pre>

<br>
<pre class="type-5 type-6 type-8 type-4 type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeepChildWatcherAutoResetWithChroot() throws Exception {
  ZooKeeper zk1=createClient();
  zk1.create("/ch1",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk1.create("/ch1/here",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk1.create("/ch1/here/we",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  zk1.create("/ch1/here/we/are",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher watcher=new MyWatcher();
  ZooKeeper zk2=createClient(watcher,hostPort + "/ch1/here/we");
  zk2.getChildren("/are",true);
  zk1.create("/ch1/here/we/are/now",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  WatchedEvent e=watcher.events.poll(TIMEOUT,TimeUnit.MILLISECONDS);
  Assert.assertNotNull(e);
  Assert.assertEquals(EventType.NodeChildrenChanged,e.getType());
  Assert.assertEquals("/are",e.getPath());
  MyWatcher childWatcher=new MyWatcher();
  zk2.getChildren("/are",childWatcher);
  stopServer();
  watcher.waitForDisconnected(3000);
  startServer();
  watcher.waitForConnected(3000);
  zk1.create("/ch1/here/we/are/again",null,Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  e=childWatcher.events.poll(TIMEOUT,TimeUnit.MILLISECONDS);
  Assert.assertNotNull(e);
  Assert.assertEquals(EventType.NodeChildrenChanged,e.getType());
  Assert.assertEquals("/are",e.getPath());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.EventTypeTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntConversion(){
  EnumSet<EventType> allTypes=EnumSet.allOf(EventType.class);
  for (  EventType et : allTypes) {
    Assert.assertEquals(et,EventType.fromInt(et.getIntValue()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.FollowerResyncConcurrencyTest </h4><pre class="type-5 type-10 type-3 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that the server is sending the proper zxid, and as a result
 * the watch doesn't fire. See ZOOKEEPER-1412.
 */
@Test public void testFollowerWatcherResync() throws Exception {
  QuorumUtil qu=new QuorumUtil(1);
  qu.startAll();
  int index=1;
  while (qu.getPeer(index).peer.follower == null) {
    index++;
  }
  LOG.info("Connecting to follower: {}",index);
  TestableZooKeeper zk1=createTestableClient("localhost:" + qu.getPeer(index).peer.getClientPort());
  zk1.create("/foo","foo".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  MyWatcher watcher=new MyWatcher();
  TestableZooKeeper zk2=createTestableClient(watcher,"localhost:" + qu.getPeer(index).peer.getClientPort());
  zk2.exists("/foo",true);
  watcher.reset();
  zk2.testableConnloss();
  if (!watcher.clientConnected.await(CONNECTION_TIMEOUT,TimeUnit.MILLISECONDS)) {
    fail("Unable to connect to server");
  }
  assertArrayEquals("foo".getBytes(),zk2.getData("/foo",false,null));
  assertNull(watcher.events.poll(5,TimeUnit.SECONDS));
  zk1.close();
  zk2.close();
  qu.shutdownAll();
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that the server is sending the proper zxid. See ZOOKEEPER-1412.
 */
@Test public void testFollowerSendsLastZxid() throws Exception {
  QuorumUtil qu=new QuorumUtil(1);
  qu.startAll();
  int index=1;
  while (qu.getPeer(index).peer.follower == null) {
    index++;
  }
  LOG.info("Connecting to follower: {}",index);
  TestableZooKeeper zk=createTestableClient("localhost:" + qu.getPeer(index).peer.getClientPort());
  assertEquals(0L,zk.testableLastZxid());
  zk.exists("/",false);
  long lzxid=zk.testableLastZxid();
  assertTrue("lzxid:" + lzxid + " > 0",lzxid > 0);
  zk.close();
  qu.shutdownAll();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.GetChildren2Test </h4><pre class="type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChildren() throws IOException, KeeperException, InterruptedException {
  String name="/foo";
  zk.create(name,name.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  List<String> children=new ArrayList<String>();
  List<String> children_s=new ArrayList<String>();
  for (int i=0; i < 10; i++) {
    String childname=name + "/bar" + i;
    String childname_s="bar" + i;
    children.add(childname);
    children_s.add(childname_s);
  }
  for (int i=0; i < children.size(); i++) {
    String childname=children.get(i);
    zk.create(childname,childname.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
    Stat stat=new Stat();
    List<String> s=zk.getChildren(name,false,stat);
    Assert.assertEquals(stat.getCzxid(),stat.getMzxid());
    Assert.assertEquals(stat.getCzxid() + i + 1,stat.getPzxid());
    Assert.assertEquals(stat.getCtime(),stat.getMtime());
    Assert.assertEquals(i + 1,stat.getCversion());
    Assert.assertEquals(0,stat.getVersion());
    Assert.assertEquals(0,stat.getAversion());
    Assert.assertEquals(0,stat.getEphemeralOwner());
    Assert.assertEquals(name.length(),stat.getDataLength());
    Assert.assertEquals(i + 1,stat.getNumChildren());
    Assert.assertEquals(s.size(),stat.getNumChildren());
  }
  List<String> p=zk.getChildren(name,false,null);
  List<String> c_a=children_s;
  List<String> c_b=p;
  Collections.sort(c_a);
  Collections.sort(c_b);
  Assert.assertEquals(c_a.size(),10);
  Assert.assertEquals(c_a,c_b);
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChild() throws IOException, KeeperException, InterruptedException {
  String name="/foo";
  zk.create(name,name.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  String childname=name + "/bar";
  zk.create(childname,childname.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
  Stat stat=new Stat();
  List<String> s=zk.getChildren(name,false,stat);
  Assert.assertEquals(stat.getCzxid(),stat.getMzxid());
  Assert.assertEquals(stat.getCzxid() + 1,stat.getPzxid());
  Assert.assertEquals(stat.getCtime(),stat.getMtime());
  Assert.assertEquals(1,stat.getCversion());
  Assert.assertEquals(0,stat.getVersion());
  Assert.assertEquals(0,stat.getAversion());
  Assert.assertEquals(0,stat.getEphemeralOwner());
  Assert.assertEquals(name.length(),stat.getDataLength());
  Assert.assertEquals(1,stat.getNumChildren());
  Assert.assertEquals(s.size(),stat.getNumChildren());
  s=zk.getChildren(childname,false,stat);
  Assert.assertEquals(stat.getCzxid(),stat.getMzxid());
  Assert.assertEquals(stat.getCzxid(),stat.getPzxid());
  Assert.assertEquals(stat.getCtime(),stat.getMtime());
  Assert.assertEquals(0,stat.getCversion());
  Assert.assertEquals(0,stat.getVersion());
  Assert.assertEquals(0,stat.getAversion());
  Assert.assertEquals(zk.getSessionId(),stat.getEphemeralOwner());
  Assert.assertEquals(childname.length(),stat.getDataLength());
  Assert.assertEquals(0,stat.getNumChildren());
  Assert.assertEquals(s.size(),stat.getNumChildren());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.KeeperStateTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntConversion(){
  EnumSet<KeeperState> allStates=EnumSet.allOf(KeeperState.class);
  for (  KeeperState as : allStates) {
    Assert.assertEquals(as,KeeperState.fromInt(as.getIntValue()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.LoadFromLogTest </h4><pre class="type-5 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test that we fail to load txnlog of a request zxid that is older
 * than what exist on disk
 * @throws Exception an exception might be thrown here
 */
@Test public void testLoadFailure() throws Exception {
  File tmpDir=ClientBase.createTmpDir();
  ClientBase.setupTestEnv();
  ZooKeeperServer zks=new ZooKeeperServer(tmpDir,tmpDir,3000);
  SyncRequestProcessor.setSnapCount(50);
  final int PORT=Integer.parseInt(HOSTPORT.split(":")[1]);
  ServerCnxnFactory f=ServerCnxnFactory.createFactory(PORT,-1);
  f.startup(zks);
  Assert.assertTrue("waiting for server being up ",ClientBase.waitForServerUp(HOSTPORT,CONNECTION_TIMEOUT));
  ZooKeeper zk=new ZooKeeper(HOSTPORT,CONNECTION_TIMEOUT,this);
  try {
    for (int i=0; i < NUM_MESSAGES; i++) {
      zk.create("/data-",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
    }
  }
  finally {
    zk.close();
  }
  f.shutdown();
  Assert.assertTrue("waiting for server to shutdown",ClientBase.waitForServerDown(HOSTPORT,CONNECTION_TIMEOUT));
  File logDir=new File(tmpDir,FileTxnSnapLog.version + FileTxnSnapLog.VERSION);
  File[] logFiles=FileTxnLog.getLogFiles(logDir.listFiles(),0);
  Assert.assertTrue(logFiles.length > 4);
  Assert.assertTrue("delete the first log file",logFiles[0].delete());
  long secondStartZxid=Util.getZxidFromName(logFiles[1].getName(),"log");
  FileTxnLog txnLog=new FileTxnLog(logDir);
  TxnIterator itr=txnLog.read(1,false);
  Assert.assertEquals(secondStartZxid,itr.getHeader().getZxid());
  itr=txnLog.read(secondStartZxid,false);
  Assert.assertEquals(secondStartZxid,itr.getHeader().getZxid());
  Assert.assertTrue(itr.next());
  long nextZxid=itr.getHeader().getZxid();
  itr=txnLog.read(nextZxid,false);
  Assert.assertEquals(secondStartZxid,itr.getHeader().getZxid());
  long thirdStartZxid=Util.getZxidFromName(logFiles[2].getName(),"log");
  itr=txnLog.read(thirdStartZxid,false);
  Assert.assertEquals(secondStartZxid,itr.getHeader().getZxid());
  Assert.assertTrue(itr.next());
  nextZxid=itr.getHeader().getZxid();
  itr=txnLog.read(nextZxid,false);
  Assert.assertEquals(secondStartZxid,itr.getHeader().getZxid());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.MultiAsyncTransactionTest </h4><pre class="type-2 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * ZOOKEEPER-1624: PendingChanges of create sequential node request didn't
 * get rollbacked correctly when multi-op failed. This cause
 * create sequential node request in subsequent multi-op to failed because
 * sequential node name generation is incorrect.
 * The check is to make sure that each request in multi-op failed with
 * the correct reason.
 */
@Test public void testSequentialNodeCreateInAsyncMulti() throws Exception {
  final int iteration=4;
  final List<MultiResult> results=new ArrayList<MultiResult>();
  pendingOps.set(iteration);
  List<Op> ops=Arrays.asList(Op.create("/node-",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL),Op.create("/dup",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT));
  for (int i=0; i < iteration; ++i) {
    zk.multi(ops,new MultiCallback(){
      @Override public void processResult(      int rc,      String path,      Object ctx,      List<OpResult> opResults){
        MultiResult result=new MultiResult();
        result.results=opResults;
        result.rc=rc;
        results.add(result);
        finishPendingOps();
      }
    }
,null);
  }
  waitForPendingOps(CONNECTION_TIMEOUT);
  assertEquals(KeeperException.Code.OK.intValue(),results.get(0).rc);
  assertEquals(KeeperException.Code.NODEEXISTS.intValue(),results.get(1).rc);
  assertEquals(KeeperException.Code.NODEEXISTS.intValue(),results.get(2).rc);
  assertEquals(KeeperException.Code.NODEEXISTS.intValue(),results.get(3).rc);
  assertTrue(results.get(0).results.get(0) instanceof CreateResult);
  assertEquals(KeeperException.Code.OK.intValue(),((ErrorResult)results.get(1).results.get(0)).getErr());
  assertEquals(KeeperException.Code.OK.intValue(),((ErrorResult)results.get(2).results.get(0)).getErr());
  assertEquals(KeeperException.Code.OK.intValue(),((ErrorResult)results.get(3).results.get(0)).getErr());
  assertEquals(KeeperException.Code.NODEEXISTS.intValue(),((ErrorResult)results.get(1).results.get(1)).getErr());
  assertEquals(KeeperException.Code.NODEEXISTS.intValue(),((ErrorResult)results.get(2).results.get(1)).getErr());
  assertEquals(KeeperException.Code.NODEEXISTS.intValue(),((ErrorResult)results.get(3).results.get(1)).getErr());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.MultiTransactionTest </h4><pre class="type-9 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChRootSetData() throws Exception {
  String chRoot=createNameSpace();
  zk_chroot=createClient(this.hostPort + chRoot);
  String[] names={"/multi0","/multi1","/multi2"};
  List<Op> ops=new ArrayList<Op>();
  for (int i=0; i < names.length; i++) {
    ops.add(Op.create(names[i],new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT));
    ops.add(Op.setData(names[i],names[i].getBytes(),0));
  }
  multi(zk_chroot,ops);
  for (int i=0; i < names.length; i++) {
    Assert.assertArrayEquals("zNode data not matching",names[i].getBytes(),zk_chroot.getData(names[i],false,null));
  }
}

</code></pre>

<br>
<pre class="type-3 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateConflict() throws Exception {
  Assert.assertNull(zk.exists("/multi",null));
  try {
    multi(zk,Arrays.asList(Op.create("/multi",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT),Op.setData("/multi","X".getBytes(),0),Op.setData("/multi","Y".getBytes(),0)));
    Assert.fail("Should have thrown a KeeperException for invalid version");
  }
 catch (  KeeperException e) {
    LOG.error("STACKTRACE: ",e);
  }
  Assert.assertNull(zk.exists("/multi",null));
  multi(zk,Arrays.asList(Op.create("/multi",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT),Op.setData("/multi","X".getBytes(),0),Op.setData("/multi","Y".getBytes(),1)));
  Assert.assertArrayEquals(zk.getData("/multi",false,null),"Y".getBytes());
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoWatchesTriggeredForFailedMultiRequest() throws InterruptedException, KeeperException {
  HasTriggeredWatcher watcher=new HasTriggeredWatcher();
  zk.getChildren("/",watcher);
  try {
    multi(zk,Arrays.asList(Op.create("/t",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT),Op.delete("/nonexisting",-1)));
    fail("expected previous multi op to fail!");
  }
 catch (  KeeperException.NoNodeException e) {
  }
  SyncCallback cb=new SyncCallback();
  zk.sync("/",cb,null);
  cb.done.await(CONNECTION_TIMEOUT,TimeUnit.MILLISECONDS);
  assertEquals(1,watcher.triggered.getCount());
}

</code></pre>

<br>
<pre class="type-9 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetData() throws Exception {
  String[] names={"/multi0","/multi1","/multi2"};
  List<Op> ops=new ArrayList<Op>();
  for (int i=0; i < names.length; i++) {
    ops.add(Op.create(names[i],new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT));
    ops.add(Op.setData(names[i],names[i].getBytes(),0));
  }
  multi(zk,ops);
  for (int i=0; i < names.length; i++) {
    Assert.assertArrayEquals(names[i].getBytes(),zk.getData(names[i],false,null));
  }
}

</code></pre>

<br>
<pre class="type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChRootTransaction() throws Exception {
  String chRoot=createNameSpace();
  zk_chroot=createClient(this.hostPort + chRoot);
  String childPath="/myid";
  Transaction transaction=zk_chroot.transaction();
  transaction.create(childPath,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  transaction.check(childPath,0);
  transaction.setData(childPath,childPath.getBytes(),0);
  commit(transaction);
  Assert.assertNotNull("zNode is not created under chroot:" + chRoot,zk.exists(chRoot + childPath,false));
  Assert.assertNotNull("zNode is not created under chroot:" + chRoot,zk_chroot.exists(childPath,false));
  Assert.assertNull("zNode is created directly under '/', ignored configured chroot",zk.exists(childPath,false));
  Assert.assertArrayEquals("zNode data not matching",childPath.getBytes(),zk_chroot.getData(childPath,false,null));
  transaction=zk_chroot.transaction();
  transaction.delete(childPath,1);
  commit(transaction);
  Assert.assertNull("chroot:" + chRoot + " exists after delete",zk.exists(chRoot + "/myid",false));
  Assert.assertNull("chroot:" + chRoot + " exists after delete",zk_chroot.exists("/myid",false));
}

</code></pre>

<br>
<pre class="type-3 type-2 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransactionBuilder() throws Exception {
  List<OpResult> results=commit(zk.transaction().create("/t1",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT).create("/t1/child",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT).create("/t2",null,Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL));
  assertEquals(3,results.size());
  for (  OpResult r : results) {
    CreateResult c=(CreateResult)r;
    assertTrue(c.getPath().startsWith("/t"));
    assertNotNull(c.toString());
  }
  assertNotNull(zk.exists("/t1",false));
  assertNotNull(zk.exists("/t1/child",false));
  assertNotNull(zk.exists("/t2",false));
  results=commit(zk.transaction().check("/t1",0).check("/t1/child",0).check("/t2",0));
  assertEquals(3,results.size());
  for (  OpResult r : results) {
    CheckResult c=(CheckResult)r;
    assertNotNull(c.toString());
  }
  try {
    results=commit(zk.transaction().check("/t1",0).check("/t1/child",0).check("/t2",1));
    fail();
  }
 catch (  KeeperException.BadVersionException e) {
  }
  results=commit(zk.transaction().check("/t1",0).setData("/t1",new byte[0],0));
  assertEquals(2,results.size());
  for (  OpResult r : results) {
    assertNotNull(r.toString());
  }
  try {
    results=commit(zk.transaction().check("/t1",1).setData("/t1",new byte[0],2));
    fail();
  }
 catch (  KeeperException.BadVersionException e) {
  }
  results=commit(zk.transaction().check("/t1",1).check("/t1/child",0).check("/t2",0));
  assertEquals(3,results.size());
  results=commit(zk.transaction().delete("/t2",-1).delete("/t1/child",-1));
  assertEquals(2,results.size());
  for (  OpResult r : results) {
    DeleteResult d=(DeleteResult)r;
    assertNotNull(d.toString());
  }
  assertNotNull(zk.exists("/t1",false));
  assertNull(zk.exists("/t1/child",false));
  assertNull(zk.exists("/t2",false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.ObserverTest </h4><pre class="type-2 type-6 type-15 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test ensures two things:
 * 1. That Observers can successfully proxy requests to the ensemble.
 * 2. That Observers don't participate in leader elections.
 * The second is tested by constructing an ensemble where a leader would
 * be elected if and only if an Observer voted. 
 * @throws Exception
 */
@Test public void testObserver() throws Exception {
  ClientBase.setupTestEnv();
  latch=new CountDownLatch(2);
  final int PORT_QP1=PortAssignment.unique();
  final int PORT_QP2=PortAssignment.unique();
  final int PORT_OBS=PortAssignment.unique();
  final int PORT_QP_LE1=PortAssignment.unique();
  final int PORT_QP_LE2=PortAssignment.unique();
  final int PORT_OBS_LE=PortAssignment.unique();
  final int CLIENT_PORT_QP1=PortAssignment.unique();
  final int CLIENT_PORT_QP2=PortAssignment.unique();
  final int CLIENT_PORT_OBS=PortAssignment.unique();
  String quorumCfgSection="server.1=127.0.0.1:" + (PORT_QP1) + ":"+ (PORT_QP_LE1)+ ";"+ CLIENT_PORT_QP1+ "\nserver.2=127.0.0.1:"+ (PORT_QP2)+ ":"+ (PORT_QP_LE2)+ ";"+ CLIENT_PORT_QP2+ "\nserver.3=127.0.0.1:"+ (PORT_OBS)+ ":"+ (PORT_OBS_LE)+ ":observer"+ ";"+ CLIENT_PORT_OBS;
  MainThread q1=new MainThread(1,CLIENT_PORT_QP1,quorumCfgSection);
  MainThread q2=new MainThread(2,CLIENT_PORT_QP2,quorumCfgSection);
  MainThread q3=new MainThread(3,CLIENT_PORT_OBS,quorumCfgSection);
  q1.start();
  q2.start();
  q3.start();
  Assert.assertTrue("waiting for server 1 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP1,CONNECTION_TIMEOUT));
  Assert.assertTrue("waiting for server 2 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP2,CONNECTION_TIMEOUT));
  Assert.assertTrue("waiting for server 3 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_OBS,CONNECTION_TIMEOUT));
  zk=new ZooKeeper("127.0.0.1:" + CLIENT_PORT_OBS,ClientBase.CONNECTION_TIMEOUT,this);
  zk.create("/obstest","test".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertEquals(new String(zk.getData("/obstest",null,null)),"test");
  zk.sync("/",null,null);
  zk.setData("/obstest","test2".getBytes(),-1);
  zk.getChildren("/",false);
  Assert.assertEquals(zk.getState(),States.CONNECTED);
  LOG.info("Shutting down server 2");
  q2.shutdown();
  Assert.assertTrue("Waiting for server 2 to shut down",ClientBase.waitForServerDown("127.0.0.1:" + CLIENT_PORT_QP2,ClientBase.CONNECTION_TIMEOUT));
  LOG.info("Server 2 down");
  latch.await();
  Assert.assertNotSame("Client is still connected to non-quorate cluster",KeeperState.SyncConnected,lastEvent.getState());
  LOG.info("Latch returned");
  try {
    Assert.assertFalse("Shouldn't get a response when cluster not quorate!",new String(zk.getData("/obstest",null,null)).equals("test"));
  }
 catch (  ConnectionLossException c) {
    LOG.info("Connection loss exception caught - ensemble not quorate (this is expected)");
  }
  latch=new CountDownLatch(1);
  LOG.info("Restarting server 2");
  q2=new MainThread(2,CLIENT_PORT_QP2,quorumCfgSection);
  q2.start();
  LOG.info("Waiting for server 2 to come up");
  Assert.assertTrue("waiting for server 2 being up",ClientBase.waitForServerUp("127.0.0.1:" + CLIENT_PORT_QP2,CONNECTION_TIMEOUT));
  LOG.info("Server 2 started, waiting for latch");
  latch.await();
  Assert.assertTrue("Client didn't reconnect to quorate ensemble (state was" + lastEvent.getState() + ")",(KeeperState.SyncConnected == lastEvent.getState() || KeeperState.Expired == lastEvent.getState()));
  LOG.info("Shutting down all servers");
  q1.shutdown();
  q2.shutdown();
  q3.shutdown();
  LOG.info("Closing zk client");
  zk.close();
  Assert.assertTrue("Waiting for server 1 to shut down",ClientBase.waitForServerDown("127.0.0.1:" + CLIENT_PORT_QP1,ClientBase.CONNECTION_TIMEOUT));
  Assert.assertTrue("Waiting for server 2 to shut down",ClientBase.waitForServerDown("127.0.0.1:" + CLIENT_PORT_QP2,ClientBase.CONNECTION_TIMEOUT));
  Assert.assertTrue("Waiting for server 3 to shut down",ClientBase.waitForServerDown("127.0.0.1:" + CLIENT_PORT_OBS,ClientBase.CONNECTION_TIMEOUT));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.QuorumMajorityTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 */
@Test public void testMajQuorums() throws Throwable {
  setUp(false);
  Proposal p=new Proposal();
  p.addQuorumVerifier(s1.getQuorumVerifier());
  p.addAck(Long.valueOf(1));
  p.addAck(Long.valueOf(2));
  Assert.assertEquals(false,p.hasAllQuorums());
  p.addAck(Long.valueOf(6));
  Assert.assertEquals(false,p.hasAllQuorums());
  p.addAck(Long.valueOf(3));
  Assert.assertEquals(true,p.hasAllQuorums());
  setUp(true);
  p=new Proposal();
  p.addQuorumVerifier(s1.getQuorumVerifier());
  p.addAck(Long.valueOf(1));
  Assert.assertEquals(false,p.hasAllQuorums());
  p.addAck(Long.valueOf(4));
  p.addAck(Long.valueOf(5));
  Assert.assertEquals(false,p.hasAllQuorums());
  p.addAck(Long.valueOf(6));
  Assert.assertEquals(false,p.hasAllQuorums());
  p.addAck(Long.valueOf(2));
  Assert.assertEquals(true,p.hasAllQuorums());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.QuorumTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetView(){
  Assert.assertEquals(5,qb.s1.getView().size());
  Assert.assertEquals(5,qb.s2.getView().size());
  Assert.assertEquals(5,qb.s3.getView().size());
  Assert.assertEquals(5,qb.s4.getView().size());
  Assert.assertEquals(5,qb.s5.getView().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.ReadOnlyModeTest </h4><pre class="type-3 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test write operations using multi request.
 */
@Test(timeout=90000) public void testMultiTransaction() throws Exception {
  CountdownWatcher watcher=new CountdownWatcher();
  ZooKeeper zk=new ZooKeeper(qu.getConnString(),CONNECTION_TIMEOUT,watcher,true);
  watcher.waitForConnected(CONNECTION_TIMEOUT);
  final String data="Data to be read in RO mode";
  final String node1="/tnode1";
  final String node2="/tnode2";
  zk.create(node1,data.getBytes(),ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  watcher.reset();
  qu.shutdown(2);
  watcher.waitForConnected(CONNECTION_TIMEOUT);
  Assert.assertEquals("Should be in r-o mode",States.CONNECTEDREADONLY,zk.getState());
  String remoteData=new String(zk.getData(node1,false,null));
  Assert.assertEquals("Failed to read data in r-o mode",data,remoteData);
  try {
    Transaction transaction=zk.transaction();
    transaction.setData(node1,"no way".getBytes(),-1);
    transaction.create(node2,data.getBytes(),ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    transaction.commit();
    Assert.fail("Write operation using multi-transaction" + " api has succeeded during RO mode");
  }
 catch (  NotReadOnlyException e) {
  }
  Assert.assertNull("Should have created the znode:" + node2,zk.exists(node2,false));
}

</code></pre>

<br>
<pre class="type-3 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Basic test of read-only client functionality. Tries to read and write
 * during read-only mode, then regains a quorum and tries to write again.
 */
@Test(timeout=90000) public void testReadOnlyClient() throws Exception {
  CountdownWatcher watcher=new CountdownWatcher();
  ZooKeeper zk=new ZooKeeper(qu.getConnString(),CONNECTION_TIMEOUT,watcher,true);
  watcher.waitForConnected(CONNECTION_TIMEOUT);
  final String data="Data to be read in RO mode";
  final String node="/tnode";
  zk.create(node,data.getBytes(),ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  watcher.reset();
  qu.shutdown(2);
  zk.close();
  zk=new ZooKeeper(qu.getConnString(),CONNECTION_TIMEOUT,watcher,true);
  watcher.waitForConnected(CONNECTION_TIMEOUT);
  String remoteData=new String(zk.getData(node,false,null));
  Assert.assertEquals(data,remoteData);
  try {
    zk.setData(node,"no way".getBytes(),-1);
    Assert.fail("Write operation has succeeded during RO mode");
  }
 catch (  NotReadOnlyException e) {
  }
  watcher.reset();
  qu.start(2);
  Assert.assertTrue("waiting for server up",ClientBase.waitForServerUp("127.0.0.1:" + qu.getPeer(2).clientPort,CONNECTION_TIMEOUT));
  zk.close();
  watcher.reset();
  zk=new ZooKeeper(qu.getConnString(),CONNECTION_TIMEOUT,watcher,true);
  watcher.waitForConnected(CONNECTION_TIMEOUT);
  zk.setData(node,"We're in the quorum now".getBytes(),-1);
  zk.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.ReconfigTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPortChange() throws Exception {
  qu=new QuorumUtil(1);
  qu.disableJMXTest=true;
  qu.startAll();
  ZooKeeper[] zkArr=createHandles(qu);
  List<String> joiningServers=new ArrayList<String>();
  int leaderIndex=getLeaderId(qu);
  int followerIndex=leaderIndex == 1 ? 2 : 1;
  int quorumPort=qu.getPeer(followerIndex).peer.getQuorumAddress().getPort();
  int electionPort=qu.getPeer(followerIndex).peer.getElectionAddress().getPort();
  int oldClientPort=qu.getPeer(followerIndex).peer.getClientPort();
  int newClientPort=PortAssignment.unique();
  joiningServers.add("server." + followerIndex + "=localhost:"+ quorumPort+ ":"+ electionPort+ ":participant;localhost:"+ newClientPort);
  testNormalOperation(zkArr[followerIndex],zkArr[leaderIndex]);
  reconfig(zkArr[followerIndex],joiningServers,null,null,-1);
  try {
    for (int i=0; i < 20; i++) {
      Thread.sleep(1000);
      zkArr[followerIndex].setData("/test","teststr".getBytes(),-1);
    }
  }
 catch (  KeeperException.ConnectionLossException e) {
    Assert.fail("Existing client disconnected when client port changed!");
  }
  zkArr[followerIndex].close();
  zkArr[followerIndex]=new ZooKeeper("127.0.0.1:" + oldClientPort,ClientBase.CONNECTION_TIMEOUT,new Watcher(){
    public void process(    WatchedEvent event){
    }
  }
);
  for (int i=0; i < 10; i++) {
    try {
      Thread.sleep(1000);
      zkArr[followerIndex].setData("/test","teststr".getBytes(),-1);
      Assert.fail("New client connected to old client port!");
    }
 catch (    KeeperException.ConnectionLossException e) {
    }
  }
  zkArr[followerIndex].close();
  zkArr[followerIndex]=new ZooKeeper("127.0.0.1:" + newClientPort,ClientBase.CONNECTION_TIMEOUT,new Watcher(){
    public void process(    WatchedEvent event){
    }
  }
);
  testNormalOperation(zkArr[followerIndex],zkArr[leaderIndex]);
  testServerHasConfig(zkArr[followerIndex],joiningServers,null);
  Assert.assertEquals(newClientPort,qu.getPeer(followerIndex).peer.getClientPort());
  joiningServers.clear();
  int newQuorumPort=PortAssignment.unique();
  joiningServers.add("server." + leaderIndex + "=localhost:"+ newQuorumPort+ ":"+ qu.getPeer(leaderIndex).peer.getElectionAddress().getPort()+ ":participant;localhost:"+ qu.getPeer(leaderIndex).peer.getClientPort());
  reconfig(zkArr[leaderIndex],joiningServers,null,null,-1);
  testNormalOperation(zkArr[followerIndex],zkArr[leaderIndex]);
  Assert.assertTrue(qu.getPeer(leaderIndex).peer.getQuorumAddress().getPort() == newQuorumPort);
  Assert.assertTrue(getLeaderId(qu) != leaderIndex);
  joiningServers.clear();
  for (int i=1; i <= 3; i++) {
    joiningServers.add("server." + i + "=localhost:"+ qu.getPeer(i).peer.getQuorumAddress().getPort()+ ":"+ PortAssignment.unique()+ ":participant;localhost:"+ qu.getPeer(i).peer.getClientPort());
  }
  reconfig(zkArr[1],joiningServers,null,null,-1);
  leaderIndex=getLeaderId(qu);
  int follower1=leaderIndex == 1 ? 2 : 1;
  int follower2=1;
  while (follower2 == leaderIndex || follower2 == follower1)   follower2++;
  qu.shutdown(getLeaderId(qu));
  testNormalOperation(zkArr[follower2],zkArr[follower1]);
  testServerHasConfig(zkArr[follower1],joiningServers,null);
  testServerHasConfig(zkArr[follower2],joiningServers,null);
  closeAllHandles(zkArr);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnspecifiedClientAddress() throws Exception {
  int[] ports=new int[3];
  for (  int port : ports) {
    port=PortAssignment.unique();
  }
  String server="server.0=localhost:" + ports[0] + ":"+ ports[1]+ ";"+ ports[2];
  QuorumServer qs=new QuorumServer(0,server);
  Assert.assertEquals(qs.clientAddr.getHostString(),"0.0.0.0");
  Assert.assertEquals(qs.clientAddr.getPort(),ports[2]);
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRemoveOneAsynchronous() throws Exception {
  qu=new QuorumUtil(2);
  qu.disableJMXTest=true;
  qu.startAll();
  ZooKeeper[] zkArr=createHandles(qu);
  List<String> leavingServers=new ArrayList<String>();
  leavingServers.add(getLeaderId(qu) == 5 ? "4" : "5");
  LinkedList<Integer> results=new LinkedList<Integer>();
  zkArr[1].reconfig(null,leavingServers,null,-1,this,results);
synchronized (results) {
    while (results.size() < 1) {
      results.wait();
    }
  }
  Assert.assertEquals(0,(int)results.get(0));
  testNormalOperation(zkArr[1],zkArr[2]);
  for (int i=1; i <= 5; i++)   testServerHasConfig(zkArr[i],null,leavingServers);
  closeAllHandles(zkArr);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.RecoveryTest </h4><pre class="type-9 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that if a server goes down that clients will reconnect
 * automatically after the server is restarted. Note that this requires the
 * server to restart within the connection timeout period.
 * Also note that the client latches are used to eliminate any chance
 * of spurrious connectionloss exceptions on the read ops. Specifically
 * a sync operation will throw this exception if the server goes down
 * (as recognized by the client) during the operation. If the operation
 * occurs after the server is down, but before the client recognizes
 * that the server is down (ping) then the op will throw connectionloss.
 */
@Test public void testRecovery() throws Exception {
  File tmpDir=ClientBase.createTmpDir();
  ClientBase.setupTestEnv();
  ZooKeeperServer zks=new ZooKeeperServer(tmpDir,tmpDir,3000);
  int oldSnapCount=SyncRequestProcessor.getSnapCount();
  SyncRequestProcessor.setSnapCount(1000);
  try {
    final int PORT=Integer.parseInt(HOSTPORT.split(":")[1]);
    ServerCnxnFactory f=ServerCnxnFactory.createFactory(PORT,-1);
    f.startup(zks);
    LOG.info("starting up the the server, waiting");
    Assert.assertTrue("waiting for server up",ClientBase.waitForServerUp(HOSTPORT,CONNECTION_TIMEOUT));
    startSignal=new CountDownLatch(1);
    ZooKeeper zk=new ZooKeeper(HOSTPORT,CONNECTION_TIMEOUT,this);
    startSignal.await(CONNECTION_TIMEOUT,TimeUnit.MILLISECONDS);
    Assert.assertTrue("count == 0",startSignal.getCount() == 0);
    String path;
    LOG.info("starting creating nodes");
    for (int i=0; i < 10; i++) {
      path="/" + i;
      zk.create(path,(path + "!").getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      for (int j=0; j < 10; j++) {
        String subpath=path + "/" + j;
        zk.create(subpath,(subpath + "!").getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
        for (int k=0; k < 20; k++) {
          String subsubpath=subpath + "/" + k;
          zk.create(subsubpath,(subsubpath + "!").getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
        }
      }
    }
    f.shutdown();
    zks.shutdown();
    Assert.assertTrue("waiting for server down",ClientBase.waitForServerDown(HOSTPORT,CONNECTION_TIMEOUT));
    zks=new ZooKeeperServer(tmpDir,tmpDir,3000);
    f=ServerCnxnFactory.createFactory(PORT,-1);
    startSignal=new CountDownLatch(1);
    f.startup(zks);
    Assert.assertTrue("waiting for server up",ClientBase.waitForServerUp(HOSTPORT,CONNECTION_TIMEOUT));
    startSignal.await(CONNECTION_TIMEOUT,TimeUnit.MILLISECONDS);
    Assert.assertTrue("count == 0",startSignal.getCount() == 0);
    Stat stat=new Stat();
    for (int i=0; i < 10; i++) {
      path="/" + i;
      LOG.info("Checking " + path);
      Assert.assertEquals(new String(zk.getData(path,false,stat)),path + "!");
      for (int j=0; j < 10; j++) {
        String subpath=path + "/" + j;
        Assert.assertEquals(new String(zk.getData(subpath,false,stat)),subpath + "!");
        for (int k=0; k < 20; k++) {
          String subsubpath=subpath + "/" + k;
          Assert.assertEquals(new String(zk.getData(subsubpath,false,stat)),subsubpath + "!");
        }
      }
    }
    f.shutdown();
    zks.shutdown();
    Assert.assertTrue("waiting for server down",ClientBase.waitForServerDown(HOSTPORT,ClientBase.CONNECTION_TIMEOUT));
    zks=new ZooKeeperServer(tmpDir,tmpDir,3000);
    f=ServerCnxnFactory.createFactory(PORT,-1);
    startSignal=new CountDownLatch(1);
    f.startup(zks);
    Assert.assertTrue("waiting for server up",ClientBase.waitForServerUp(HOSTPORT,CONNECTION_TIMEOUT));
    startSignal.await(CONNECTION_TIMEOUT,TimeUnit.MILLISECONDS);
    Assert.assertTrue("count == 0",startSignal.getCount() == 0);
    stat=new Stat();
    LOG.info("Check 2");
    for (int i=0; i < 10; i++) {
      path="/" + i;
      Assert.assertEquals(new String(zk.getData(path,false,stat)),path + "!");
      for (int j=0; j < 10; j++) {
        String subpath=path + "/" + j;
        Assert.assertEquals(new String(zk.getData(subpath,false,stat)),subpath + "!");
        for (int k=0; k < 20; k++) {
          String subsubpath=subpath + "/" + k;
          Assert.assertEquals(new String(zk.getData(subsubpath,false,stat)),subsubpath + "!");
        }
      }
    }
    zk.close();
    f.shutdown();
    zks.shutdown();
    Assert.assertTrue("waiting for server down",ClientBase.waitForServerDown(HOSTPORT,CONNECTION_TIMEOUT));
  }
  finally {
    SyncRequestProcessor.setSnapCount(oldSnapCount);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.SaslAuthDesignatedClientTest </h4><pre class="type-3 type-2 type-6 type-15 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSaslConfig() throws Exception {
  ZooKeeper zk=createClient();
  try {
    zk.getChildren("/",false);
    Assert.assertFalse(zk.getSaslClient().clientTunneledAuthenticationInProgress());
    Assert.assertEquals(zk.getSaslClient().getSaslState(),ZooKeeperSaslClient.SaslState.COMPLETE);
    Assert.assertNotNull(javax.security.auth.login.Configuration.getConfiguration().getAppConfigurationEntry("MyZookeeperClient"));
    Assert.assertSame(zk.getSaslClient().getLoginContext(),"MyZookeeperClient");
  }
 catch (  KeeperException e) {
    Assert.fail("test failed :" + e);
  }
 finally {
    zk.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.SaslAuthDesignatedServerTest </h4><pre class="type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuth() throws Exception {
  MyWatcher watcher=new MyWatcher();
  ZooKeeper zk=createClient(watcher);
  watcher.authCompleted.await(AUTHENTICATION_TIMEOUT,TimeUnit.MILLISECONDS);
  Assert.assertEquals(authFailed.get(),0);
  try {
    zk.create("/path1",null,Ids.CREATOR_ALL_ACL,CreateMode.PERSISTENT);
  }
 catch (  KeeperException e) {
    Assert.fail("test failed :" + e);
  }
 finally {
    zk.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.SaslAuthFailNotifyTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBadSaslAuthNotifiesWatch() throws Exception {
  ZooKeeper zk=createClient();
synchronized (authFailed) {
    authFailed.wait();
  }
  Assert.assertEquals(authFailed.get(),1);
  zk.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.ServerCnxnTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testServerCnxnExpiry() throws Exception {
  verify("ruok","imok");
  String resp=sendRequest("ruok",2 * cnxnTimeout + 1000);
  Assert.assertEquals("Connection should have closed","",resp);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.SessionInvalidationTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test solution for ZOOKEEPER-1208. Verify that operations are not
 * accepted after a close session.
 * We're using our own marshalling here in order to force an operation
 * after the session is closed (ZooKeeper.class will not allow this). Also
 * by filling the pipe with operations it increases the likelyhood that
 * the server will process the create before FinalRequestProcessor
 * removes the session from the tracker.
 */
@Test public void testCreateAfterCloseShouldFail() throws Exception {
  for (int i=0; i < 10; i++) {
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    BinaryOutputArchive boa=BinaryOutputArchive.getArchive(baos);
    boa.writeInt(44,"len");
    ConnectRequest conReq=new ConnectRequest(0,0,30000,0,new byte[16]);
    conReq.serialize(boa,"connect");
    boa.writeInt(8,"len");
    RequestHeader h=new RequestHeader(1,ZooDefs.OpCode.closeSession);
    h.serialize(boa,"header");
    boa.writeInt(52,"len");
    RequestHeader header=new RequestHeader(2,OpCode.create);
    header.serialize(boa,"header");
    CreateRequest createReq=new CreateRequest("/foo" + i,new byte[0],Ids.OPEN_ACL_UNSAFE,1);
    createReq.serialize(boa,"request");
    baos.close();
    System.out.println("Length:" + baos.toByteArray().length);
    String hp[]=hostPort.split(":");
    Socket sock=new Socket(hp[0],Integer.parseInt(hp[1]));
    InputStream resultStream=null;
    try {
      OutputStream outstream=sock.getOutputStream();
      byte[] data=baos.toByteArray();
      outstream.write(data);
      outstream.flush();
      resultStream=sock.getInputStream();
      byte[] b=new byte[10000];
      int len;
      while ((len=resultStream.read(b)) >= 0) {
        System.out.println("gotlen:" + len);
      }
    }
  finally {
      if (resultStream != null) {
        resultStream.close();
      }
      sock.close();
    }
  }
  ZooKeeper zk=createClient();
  Assert.assertEquals(1,zk.getChildren("/",false).size());
  zk.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.SessionTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * This test makes sure that duplicate state changes are not communicated
 * to the client watcher. For example we should not notify state as
 * "disconnected" if the watch has already been disconnected. In general
 * we don't consider a dup state notification if the event type is
 * not "None" (ie non-None communicates an event).
 */
@Test public void testSessionStateNoDupStateReporting() throws IOException, InterruptedException, KeeperException {
  final int TIMEOUT=3000;
  DupWatcher watcher=new DupWatcher();
  ZooKeeper zk=createClient(TIMEOUT,watcher);
  serverFactory.shutdown();
  try {
    Thread.sleep(10000);
  }
 catch (  InterruptedException e) {
  }
  Assert.assertEquals(2,watcher.states.size());
  zk.close();
}

</code></pre>

<br>
<pre class="type-5 type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test verifies that when the session id is reused, and the original
 * client is disconnected, but not session closed, that the server
 * will remove ephemeral nodes created by the original session.
 */
@Test public void testSession() throws IOException, InterruptedException, KeeperException {
  DisconnectableZooKeeper zk=createClient();
  zk.create("/e",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
  LOG.info("zk with session id 0x" + Long.toHexString(zk.getSessionId()) + " was destroyed!");
  zk.disconnect();
  Stat stat=new Stat();
  startSignal=new CountDownLatch(1);
  zk=new DisconnectableZooKeeper(HOSTPORT,CONNECTION_TIMEOUT,new MyWatcher("testSession"),zk.getSessionId(),zk.getSessionPasswd());
  startSignal.await();
  LOG.info("zk with session id 0x" + Long.toHexString(zk.getSessionId()) + " was created!");
  zk.getData("/e",false,stat);
  LOG.info("After get data /e");
  zk.close();
  zk=createClient();
  Assert.assertEquals(null,zk.exists("/e",false));
  LOG.info("before close zk with session id 0x" + Long.toHexString(zk.getSessionId()) + "!");
  zk.close();
  try {
    zk.getData("/e",false,stat);
    Assert.fail("Should have received a SessionExpiredException");
  }
 catch (  KeeperException.SessionExpiredException e) {
  }
  AsyncCallback.DataCallback cb=new AsyncCallback.DataCallback(){
    String status="not done";
    public void processResult(    int rc,    String p,    Object c,    byte[] b,    Stat s){
synchronized (this) {
        status=KeeperException.Code.get(rc).toString();
        this.notify();
      }
    }
    public String toString(){
      return status;
    }
  }
;
  zk.getData("/e",false,cb,null);
synchronized (cb) {
    if (cb.toString().equals("not done")) {
      cb.wait(1000);
    }
  }
  Assert.assertEquals(KeeperException.Code.SESSIONEXPIRED.toString(),cb.toString());
}

</code></pre>

<br>
<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMinMaxSessionTimeout() throws Exception {
  final int MINSESS=20000;
  final int MAXSESS=240000;
{
    ZooKeeperServer zs=ClientBase.getServer(serverFactory);
    zs.setMinSessionTimeout(MINSESS);
    zs.setMaxSessionTimeout(MAXSESS);
  }
  int timeout=120000;
  DisconnectableZooKeeper zk=createClient(timeout);
  Assert.assertEquals(timeout,zk.getSessionTimeout());
  LOG.info(zk.toString());
  zk.close();
  LOG.info(zk.toString());
  zk=createClient(MINSESS / 2);
  Assert.assertEquals(MINSESS,zk.getSessionTimeout());
  LOG.info(zk.toString());
  zk.close();
  LOG.info(zk.toString());
  zk=createClient(MAXSESS * 2);
  Assert.assertEquals(MAXSESS,zk.getSessionTimeout());
  LOG.info(zk.toString());
  zk.close();
  LOG.info(zk.toString());
}

</code></pre>

<br>
<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verify access to the negotiated session timeout.
 */
@Test public void testSessionTimeoutAccess() throws Exception {
  DisconnectableZooKeeper zk=createClient(TICK_TIME * 4);
  Assert.assertEquals(TICK_TIME * 4,zk.getSessionTimeout());
  LOG.info(zk.toString());
  zk.close();
  LOG.info(zk.toString());
  zk=createClient(TICK_TIME);
  Assert.assertEquals(TICK_TIME * 2,zk.getSessionTimeout());
  LOG.info(zk.toString());
  zk.close();
  LOG.info(zk.toString());
  zk=createClient(TICK_TIME * 30);
  Assert.assertEquals(TICK_TIME * 20,zk.getSessionTimeout());
  LOG.info(zk.toString());
  zk.close();
  LOG.info(zk.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.StatTest </h4><pre class="type-6 type-15 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataSizeChange() throws IOException, KeeperException, InterruptedException {
  String name="/foo";
  zk.create(name,name.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Stat stat;
  stat=newStat();
  zk.getData(name,false,stat);
  Assert.assertEquals(stat.getCzxid(),stat.getMzxid());
  Assert.assertEquals(stat.getCzxid(),stat.getPzxid());
  Assert.assertEquals(stat.getCtime(),stat.getMtime());
  Assert.assertEquals(0,stat.getCversion());
  Assert.assertEquals(0,stat.getVersion());
  Assert.assertEquals(0,stat.getAversion());
  Assert.assertEquals(0,stat.getEphemeralOwner());
  Assert.assertEquals(name.length(),stat.getDataLength());
  Assert.assertEquals(0,stat.getNumChildren());
  zk.setData(name,(name + name).getBytes(),-1);
  stat=newStat();
  zk.getData(name,false,stat);
  Assert.assertNotSame(stat.getCzxid(),stat.getMzxid());
  Assert.assertEquals(stat.getCzxid(),stat.getPzxid());
  Assert.assertNotSame(stat.getCtime(),stat.getMtime());
  Assert.assertEquals(0,stat.getCversion());
  Assert.assertEquals(1,stat.getVersion());
  Assert.assertEquals(0,stat.getAversion());
  Assert.assertEquals(0,stat.getEphemeralOwner());
  Assert.assertEquals(name.length() * 2,stat.getDataLength());
  Assert.assertEquals(0,stat.getNumChildren());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChild() throws IOException, KeeperException, InterruptedException {
  String name="/foo";
  zk.create(name,name.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  String childname=name + "/bar";
  zk.create(childname,childname.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
  Stat stat;
  stat=newStat();
  zk.getData(name,false,stat);
  Assert.assertEquals(stat.getCzxid(),stat.getMzxid());
  Assert.assertEquals(stat.getCzxid() + 1,stat.getPzxid());
  Assert.assertEquals(stat.getCtime(),stat.getMtime());
  Assert.assertEquals(1,stat.getCversion());
  Assert.assertEquals(0,stat.getVersion());
  Assert.assertEquals(0,stat.getAversion());
  Assert.assertEquals(0,stat.getEphemeralOwner());
  Assert.assertEquals(name.length(),stat.getDataLength());
  Assert.assertEquals(1,stat.getNumChildren());
  stat=newStat();
  zk.getData(childname,false,stat);
  Assert.assertEquals(stat.getCzxid(),stat.getMzxid());
  Assert.assertEquals(stat.getCzxid(),stat.getPzxid());
  Assert.assertEquals(stat.getCtime(),stat.getMtime());
  Assert.assertEquals(0,stat.getCversion());
  Assert.assertEquals(0,stat.getVersion());
  Assert.assertEquals(0,stat.getAversion());
  Assert.assertEquals(zk.getSessionId(),stat.getEphemeralOwner());
  Assert.assertEquals(childname.length(),stat.getDataLength());
  Assert.assertEquals(0,stat.getNumChildren());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasic() throws IOException, KeeperException, InterruptedException {
  String name="/foo";
  zk.create(name,name.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Stat stat;
  stat=newStat();
  zk.getData(name,false,stat);
  Assert.assertEquals(stat.getCzxid(),stat.getMzxid());
  Assert.assertEquals(stat.getCzxid(),stat.getPzxid());
  Assert.assertEquals(stat.getCtime(),stat.getMtime());
  Assert.assertEquals(0,stat.getCversion());
  Assert.assertEquals(0,stat.getVersion());
  Assert.assertEquals(0,stat.getAversion());
  Assert.assertEquals(0,stat.getEphemeralOwner());
  Assert.assertEquals(name.length(),stat.getDataLength());
  Assert.assertEquals(0,stat.getNumChildren());
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChildren() throws IOException, KeeperException, InterruptedException {
  String name="/foo";
  zk.create(name,name.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  for (int i=0; i < 10; i++) {
    String childname=name + "/bar" + i;
    zk.create(childname,childname.getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
    Stat stat;
    stat=newStat();
    zk.getData(name,false,stat);
    Assert.assertEquals(stat.getCzxid(),stat.getMzxid());
    Assert.assertEquals(stat.getCzxid() + i + 1,stat.getPzxid());
    Assert.assertEquals(stat.getCtime(),stat.getMtime());
    Assert.assertEquals(i + 1,stat.getCversion());
    Assert.assertEquals(0,stat.getVersion());
    Assert.assertEquals(0,stat.getAversion());
    Assert.assertEquals(0,stat.getEphemeralOwner());
    Assert.assertEquals(name.length(),stat.getDataLength());
    Assert.assertEquals(i + 1,stat.getNumChildren());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.StaticHostProviderTest </h4><pre class="type-9 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateMigrationGoesRound() throws UnknownHostException {
  HostProvider hostProvider=getHostProvider((byte)4);
  Collection<InetSocketAddress> newList=new ArrayList<InetSocketAddress>(10);
  for (byte i=12; i > 2; i--) {
    newList.add(new InetSocketAddress(InetAddress.getByAddress(new byte[]{10,10,10,i}),1234 + i));
  }
  Collection<InetSocketAddress> oldStaying=new ArrayList<InetSocketAddress>(2);
  for (byte i=4; i > 2; i--) {
    oldStaying.add(new InetSocketAddress(InetAddress.getByAddress(new byte[]{10,10,10,i}),1234 + i));
  }
  Collection<InetSocketAddress> newComing=new ArrayList<InetSocketAddress>(10);
  for (byte i=12; i > 4; i--) {
    newComing.add(new InetSocketAddress(InetAddress.getByAddress(new byte[]{10,10,10,i}),1234 + i));
  }
  boolean disconnectRequired=hostProvider.updateServerList(newList,new InetSocketAddress(InetAddress.getByAddress(new byte[]{10,10,10,1}),1235));
  assertTrue(disconnectRequired);
  ArrayList<InetSocketAddress> seen=new ArrayList<InetSocketAddress>();
  for (int i=0; i < newComing.size(); i++) {
    InetSocketAddress addr=hostProvider.next(0);
    assertTrue(newComing.contains(addr));
    assertTrue(!seen.contains(addr));
    seen.add(addr);
  }
  seen.clear();
  for (int i=0; i < oldStaying.size(); i++) {
    InetSocketAddress addr=hostProvider.next(0);
    assertTrue(oldStaying.contains(addr));
    assertTrue(!seen.contains(addr));
    seen.add(addr);
  }
  InetSocketAddress first=hostProvider.next(0);
  assertTrue(first != null);
  for (int i=0; i < newList.size() - 1; i++) {
    hostProvider.next(0);
  }
  assertEquals(first,hostProvider.next(0));
  hostProvider.onConnected();
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOneInvalidHostAddresses(){
  Collection<InetSocketAddress> addr=getServerAddresses((byte)1);
  addr.add(new InetSocketAddress("a...",2181));
  StaticHostProvider sp=new StaticHostProvider(addr);
  InetSocketAddress n1=sp.next(0);
  InetSocketAddress n2=sp.next(0);
  assertEquals(n2,n1);
}

</code></pre>

<br>
<pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNextGoesRound(){
  HostProvider hostProvider=getHostProvider((byte)2);
  InetSocketAddress first=hostProvider.next(0);
  assertTrue(first != null);
  hostProvider.next(0);
  assertEquals(first,hostProvider.next(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.StringUtilTest </h4><pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStrings(){
  String s1="   a  ,   b  , ";
  assertEquals("[a, b]",StringUtils.split(s1,",").toString());
  String s2="";
  assertEquals(0,StringUtils.split(s2,",").size());
  String s3="1, , 2";
  assertEquals("[1, 2]",StringUtils.split(s3,",").toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.SyncCallTest </h4><pre class="type-9 type-10 type-3 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSync() throws Exception {
  try {
    LOG.info("Starting ZK:" + (new Date()).toString());
    opsCount=new CountDownLatch(limit);
    ZooKeeper zk=createClient();
    LOG.info("Beginning test:" + (new Date()).toString());
    for (int i=0; i < 50; i++)     zk.create("/test" + i,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT,(StringCallback)this,results);
    for (int i=50; i < 100; i++) {
      zk.create("/test" + i,new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT,(Create2Callback)this,results);
    }
    zk.sync("/test",this,results);
    for (int i=0; i < 100; i++)     zk.delete("/test" + i,0,this,results);
    for (int i=0; i < 100; i++)     zk.getChildren("/",new NullWatcher(),(ChildrenCallback)this,results);
    for (int i=0; i < 100; i++)     zk.getChildren("/",new NullWatcher(),(Children2Callback)this,results);
    LOG.info("Submitted all operations:" + (new Date()).toString());
    if (!opsCount.await(10000,TimeUnit.MILLISECONDS))     Assert.fail("Haven't received all confirmations" + opsCount.getCount());
    for (int i=0; i < limit; i++) {
      Assert.assertEquals(0,(int)results.get(i));
    }
  }
 catch (  IOException e) {
    System.out.println(e.toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.TruncateTest </h4><pre class="type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTruncationStreamReset() throws Exception {
  File tmpdir=ClientBase.createTmpDir();
  FileTxnSnapLog snaplog=new FileTxnSnapLog(tmpdir,tmpdir);
  ZKDatabase zkdb=new ZKDatabase(snaplog);
  for (int i=1; i <= 100; i++) {
    append(zkdb,i);
  }
  zkdb.truncateLog(1);
  append(zkdb,200);
  zkdb.close();
  FileTxnLog txnlog=new FileTxnLog(new File(tmpdir,"version-2"));
  TxnIterator iter=txnlog.read(1);
  TxnHeader hdr=iter.getHeader();
  Record txn=iter.getTxn();
  Assert.assertEquals(1,hdr.getZxid());
  Assert.assertTrue(txn instanceof SetDataTxn);
  iter.next();
  hdr=iter.getHeader();
  txn=iter.getTxn();
  Assert.assertEquals(200,hdr.getZxid());
  Assert.assertTrue(txn instanceof SetDataTxn);
  iter.close();
  ClientBase.recursiveDelete(tmpdir);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.WatchedEventTest </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConvertingToEventWrapper(){
  WatchedEvent we=new WatchedEvent(EventType.NodeCreated,KeeperState.Expired,"blah");
  WatcherEvent wew=we.getWrapper();
  Assert.assertEquals(EventType.NodeCreated.getIntValue(),wew.getType());
  Assert.assertEquals(KeeperState.Expired.getIntValue(),wew.getState());
  Assert.assertEquals("blah",wew.getPath());
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreatingWatchedEventFromWrapper(){
  EnumSet<EventType> allTypes=EnumSet.allOf(EventType.class);
  EnumSet<KeeperState> allStates=EnumSet.allOf(KeeperState.class);
  WatchedEvent we;
  WatcherEvent wep;
  for (  EventType et : allTypes) {
    for (    KeeperState ks : allStates) {
      wep=new WatcherEvent(et.getIntValue(),ks.getIntValue(),"blah");
      we=new WatchedEvent(wep);
      Assert.assertEquals(et,we.getType());
      Assert.assertEquals(ks,we.getState());
      Assert.assertEquals("blah",we.getPath());
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreatingWatchedEvent(){
  EnumSet<EventType> allTypes=EnumSet.allOf(EventType.class);
  EnumSet<KeeperState> allStates=EnumSet.allOf(KeeperState.class);
  WatchedEvent we;
  for (  EventType et : allTypes) {
    for (    KeeperState ks : allStates) {
      we=new WatchedEvent(et,ks,"blah");
      Assert.assertEquals(et,we.getType());
      Assert.assertEquals(ks,we.getState());
      Assert.assertEquals("blah",we.getPath());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.WatcherFuncTest </h4><pre class="type-3 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDataSync() throws IOException, InterruptedException, KeeperException {
  try {
    lsnr.getData("/foo",true,null);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/foo",e.getPath());
  }
  try {
    lsnr.getData("/foo/bar",true,null);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/foo/bar",e.getPath());
  }
  client.create("/foo","parent".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertNotNull(lsnr.getData("/foo",true,null));
  client.create("/foo/bar","child".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertNotNull(lsnr.getData("/foo/bar",true,null));
  client.setData("/foo","parent".getBytes(),-1);
  expected.add(EventType.NodeDataChanged);
  client.setData("/foo/bar","child".getBytes(),-1);
  expected.add(EventType.NodeDataChanged);
  verify();
  Assert.assertNotNull(lsnr.getData("/foo",true,null));
  Assert.assertNotNull(lsnr.getData("/foo/bar",true,null));
  client.delete("/foo/bar",-1);
  expected.add(EventType.NodeDeleted);
  client.delete("/foo",-1);
  expected.add(EventType.NodeDeleted);
  verify();
}

</code></pre>

<br>
<pre class="type-3 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetChildrenSync() throws IOException, InterruptedException, KeeperException {
  try {
    lsnr.getChildren("/foo",true);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/foo",e.getPath());
  }
  try {
    lsnr.getChildren("/foo/bar",true);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/foo/bar",e.getPath());
  }
  client.create("/foo","parent".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertNotNull(lsnr.getChildren("/foo",true));
  client.create("/foo/bar","child".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  expected.add(EventType.NodeChildrenChanged);
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",true));
  client.setData("/foo","parent".getBytes(),-1);
  client.setData("/foo/bar","child".getBytes(),-1);
  Assert.assertNotNull(lsnr.exists("/foo",true));
  Assert.assertNotNull(lsnr.getChildren("/foo",true));
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",true));
  client.delete("/foo/bar",-1);
  expected.add(EventType.NodeDeleted);
  expected.add(EventType.NodeChildrenChanged);
  client.delete("/foo",-1);
  expected.add(EventType.NodeDeleted);
  verify();
}

</code></pre>

<br>
<pre class="type-3 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDataSyncWObj() throws IOException, InterruptedException, KeeperException {
  SimpleWatcher w1=new SimpleWatcher(null);
  SimpleWatcher w2=new SimpleWatcher(null);
  SimpleWatcher w3=new SimpleWatcher(null);
  SimpleWatcher w4=new SimpleWatcher(null);
  List<EventType> e2=new ArrayList<EventType>();
  try {
    lsnr.getData("/foo",w1,null);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/foo",e.getPath());
  }
  try {
    lsnr.getData("/foo/bar",w2,null);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/foo/bar",e.getPath());
  }
  client.create("/foo","parent".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertNotNull(lsnr.getData("/foo",true,null));
  Assert.assertNotNull(lsnr.getData("/foo",w1,null));
  client.create("/foo/bar","child".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertNotNull(lsnr.getData("/foo/bar",w2,null));
  Assert.assertNotNull(lsnr.getData("/foo/bar",w3,null));
  Assert.assertNotNull(lsnr.getData("/foo/bar",w4,null));
  Assert.assertNotNull(lsnr.getData("/foo/bar",w4,null));
  client.setData("/foo","parent".getBytes(),-1);
  expected.add(EventType.NodeDataChanged);
  client.setData("/foo/bar","child".getBytes(),-1);
  e2.add(EventType.NodeDataChanged);
  lsnr_dwatch.verify(expected);
  w1.verify(expected);
  w2.verify(e2);
  w3.verify(e2);
  w4.verify(e2);
  expected.clear();
  e2.clear();
  Assert.assertNotNull(lsnr.getData("/foo",true,null));
  Assert.assertNotNull(lsnr.getData("/foo",w1,null));
  Assert.assertNotNull(lsnr.getData("/foo/bar",w2,null));
  Assert.assertNotNull(lsnr.getData("/foo/bar",w3,null));
  Assert.assertNotNull(lsnr.getData("/foo/bar",w3,null));
  Assert.assertNotNull(lsnr.getData("/foo/bar",w4,null));
  client.delete("/foo/bar",-1);
  expected.add(EventType.NodeDeleted);
  client.delete("/foo",-1);
  e2.add(EventType.NodeDeleted);
  lsnr_dwatch.verify(expected);
  w1.verify(expected);
  w2.verify(e2);
  w3.verify(e2);
  w4.verify(e2);
  expected.clear();
  e2.clear();
}

</code></pre>

<br>
<pre class="type-3 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExistsSync() throws IOException, InterruptedException, KeeperException {
  Assert.assertNull(lsnr.exists("/foo",true));
  Assert.assertNull(lsnr.exists("/foo/bar",true));
  client.create("/foo","parent".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  expected.add(EventType.NodeCreated);
  client.create("/foo/bar","child".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  expected.add(EventType.NodeCreated);
  verify();
  Assert.assertNotNull(lsnr.exists("/foo",true));
  Assert.assertNotNull(lsnr.exists("/foo/bar",true));
  try {
    Assert.assertNull(lsnr.exists("/car",true));
    client.setData("/car","missing".getBytes(),-1);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/car",e.getPath());
  }
  try {
    Assert.assertNull(lsnr.exists("/foo/car",true));
    client.setData("/foo/car","missing".getBytes(),-1);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/foo/car",e.getPath());
  }
  client.setData("/foo","parent".getBytes(),-1);
  expected.add(EventType.NodeDataChanged);
  client.setData("/foo/bar","child".getBytes(),-1);
  expected.add(EventType.NodeDataChanged);
  verify();
  Assert.assertNotNull(lsnr.exists("/foo",true));
  Assert.assertNotNull(lsnr.exists("/foo/bar",true));
  client.delete("/foo/bar",-1);
  expected.add(EventType.NodeDeleted);
  client.delete("/foo",-1);
  expected.add(EventType.NodeDeleted);
  verify();
}

</code></pre>

<br>
<pre class="type-3 type-6 type-8 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetChildrenSyncWObj() throws IOException, InterruptedException, KeeperException {
  SimpleWatcher w1=new SimpleWatcher(null);
  SimpleWatcher w2=new SimpleWatcher(null);
  SimpleWatcher w3=new SimpleWatcher(null);
  SimpleWatcher w4=new SimpleWatcher(null);
  List<EventType> e2=new ArrayList<EventType>();
  try {
    lsnr.getChildren("/foo",true);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/foo",e.getPath());
  }
  try {
    lsnr.getChildren("/foo/bar",true);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.NONODE,e.code());
    Assert.assertEquals("/foo/bar",e.getPath());
  }
  client.create("/foo","parent".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  Assert.assertNotNull(lsnr.getChildren("/foo",true));
  Assert.assertNotNull(lsnr.getChildren("/foo",w1));
  client.create("/foo/bar","child".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  expected.add(EventType.NodeChildrenChanged);
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",w2));
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",w2));
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",w3));
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",w4));
  client.setData("/foo","parent".getBytes(),-1);
  client.setData("/foo/bar","child".getBytes(),-1);
  Assert.assertNotNull(lsnr.exists("/foo",true));
  Assert.assertNotNull(lsnr.exists("/foo",w1));
  Assert.assertNotNull(lsnr.exists("/foo",true));
  Assert.assertNotNull(lsnr.exists("/foo",w1));
  Assert.assertNotNull(lsnr.getChildren("/foo",true));
  Assert.assertNotNull(lsnr.getChildren("/foo",w1));
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",w2));
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",w3));
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",w4));
  Assert.assertNotNull(lsnr.getChildren("/foo/bar",w4));
  client.delete("/foo/bar",-1);
  e2.add(EventType.NodeDeleted);
  expected.add(EventType.NodeChildrenChanged);
  client.delete("/foo",-1);
  expected.add(EventType.NodeDeleted);
  lsnr_dwatch.verify(expected);
  w1.verify(expected);
  w2.verify(e2);
  w3.verify(e2);
  w4.verify(e2);
  expected.clear();
  e2.clear();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.WatcherTest </h4><pre class="type-9 type-6 type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Verify that we get all of the events we expect to get. This particular
 * case verifies that we see all of the data events on a particular node.
 * There was a bug (ZOOKEEPER-137) that resulted in events being dropped
 * in some cases (timing).
 * @throws IOException
 * @throws InterruptedException
 * @throws KeeperException
 */
@Test public void testWatcherCorrectness() throws IOException, InterruptedException, KeeperException {
  ZooKeeper zk=null;
  try {
    MyWatcher watcher=new MyWatcher();
    zk=createClient(watcher,hostPort);
    StatCallback scb=new StatCallback(){
      public void processResult(      int rc,      String path,      Object ctx,      Stat stat){
      }
    }
;
    VoidCallback vcb=new VoidCallback(){
      public void processResult(      int rc,      String path,      Object ctx){
      }
    }
;
    String names[]=new String[10];
    for (int i=0; i < names.length; i++) {
      String name=zk.create("/tc-","initialvalue".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT_SEQUENTIAL);
      names[i]=name;
      Stat stat=new Stat();
      zk.getData(name,watcher,stat);
      zk.setData(name,"new".getBytes(),stat.getVersion(),scb,null);
      stat=zk.exists(name,watcher);
      zk.delete(name,stat.getVersion(),vcb,null);
    }
    for (int i=0; i < names.length; i++) {
      String name=names[i];
      WatchedEvent event=watcher.events.poll(10,TimeUnit.SECONDS);
      Assert.assertEquals(name,event.getPath());
      Assert.assertEquals(Event.EventType.NodeDataChanged,event.getType());
      Assert.assertEquals(Event.KeeperState.SyncConnected,event.getState());
      event=watcher.events.poll(10,TimeUnit.SECONDS);
      Assert.assertEquals(name,event.getPath());
      Assert.assertEquals(Event.EventType.NodeDeleted,event.getType());
      Assert.assertEquals(Event.KeeperState.SyncConnected,event.getState());
    }
  }
  finally {
    if (zk != null) {
      zk.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWatcherCount() throws IOException, InterruptedException, KeeperException {
  ZooKeeper zk1=null, zk2=null;
  try {
    MyWatcher w1=new MyWatcher();
    zk1=createClient(w1,hostPort);
    MyWatcher w2=new MyWatcher();
    zk2=createClient(w2,hostPort);
    Stat stat=new Stat();
    zk1.create("/watch-count-test","value".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
    zk1.create("/watch-count-test-2","value".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
    zk1.getData("/watch-count-test",w1,stat);
    zk1.getData("/watch-count-test-2",w1,stat);
    zk2.getData("/watch-count-test",w2,stat);
    Assert.assertEquals(ClientBase.getServer(serverFactory).getZKDatabase().getDataTree().getWatchCount(),3);
  }
  finally {
    if (zk1 != null) {
      zk1.close();
    }
    if (zk2 != null) {
      zk2.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-10 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks that watches for pending requests do not get triggered,
 * but watches set by previous requests do.
 * @throws Exception
 */
@Test public void testWatchAutoResetWithPending() throws Exception {
  MyWatcher watches[]=new MyWatcher[COUNT];
  MyStatCallback cbs[]=new MyStatCallback[COUNT];
  MyWatcher watcher=new MyWatcher();
  int count[]=new int[1];
  TestableZooKeeper zk=createClient(watcher,hostPort,6000);
  ZooKeeper zk2=createClient(watcher,hostPort,5000);
  zk2.create("/test",new byte[0],Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
  for (int i=0; i < COUNT / 2; i++) {
    watches[i]=new MyWatcher();
    cbs[i]=new MyStatCallback();
    zk.exists("/test",watches[i],cbs[i],count);
  }
  zk.exists("/test",false);
  Assert.assertTrue("Failed to pause the connection!",zk.pauseCnxn(3000));
  zk2.close();
  stopServer();
  watches[0].waitForDisconnected(60000);
  for (int i=COUNT / 2; i < COUNT; i++) {
    watches[i]=new MyWatcher();
    cbs[i]=new MyStatCallback();
    zk.exists("/test",watches[i],cbs[i],count);
  }
  startServer();
  watches[COUNT / 2 - 1].waitForConnected(60000);
  Assert.assertEquals(null,zk.exists("/test",false));
  Thread.sleep(10);
  for (int i=0; i < COUNT / 2; i++) {
    Assert.assertEquals("For " + i,1,watches[i].events.size());
  }
  for (int i=COUNT / 2; i < COUNT; i++) {
    if (cbs[i].rc == 0) {
      Assert.assertEquals("For " + i,1,watches[i].events.size());
    }
 else {
      Assert.assertEquals("For " + i,0,watches[i].events.size());
    }
  }
  Assert.assertEquals(COUNT,count[0]);
  zk.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.X509AuthTest </h4><pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTrustedAuth(){
  X509AuthenticationProvider provider=createProvider(clientCert);
  MockServerCnxn cnxn=new MockServerCnxn();
  cnxn.clientChain=new X509Certificate[]{clientCert};
  Assert.assertEquals(KeeperException.Code.OK,provider.handleAuthentication(cnxn,null));
}

</code></pre>

<br>
<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSuperAuth(){
  X509AuthenticationProvider provider=createProvider(superCert);
  MockServerCnxn cnxn=new MockServerCnxn();
  cnxn.clientChain=new X509Certificate[]{superCert};
  Assert.assertEquals(KeeperException.Code.OK,provider.handleAuthentication(cnxn,null));
  Assert.assertEquals("super",cnxn.getAuthInfo().get(0).getScheme());
}

</code></pre>

<br>
<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUntrustedAuth(){
  X509AuthenticationProvider provider=createProvider(clientCert);
  MockServerCnxn cnxn=new MockServerCnxn();
  cnxn.clientChain=new X509Certificate[]{unknownCert};
  Assert.assertEquals(KeeperException.Code.AUTHFAILED,provider.handleAuthentication(cnxn,null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.zookeeper.test.system.SimpleSysTest </h4><pre class="type-9 type-10 type-3 type-2 type-6 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks the following:
 * 1) All clients connect successfully
 * 2) Half of the servers die (assuming odd number) and a write succeeds
 * 3) All servers are restarted and cluster stays alive
 * 4) Clients see a change by the server
 * 5) Clients' ephemeral nodes are cleaned up
 * @throws Exception
 */
@Test public void testSimpleCase() throws Exception {
  configureServers(serverCount);
  configureClients(clientCount,SimpleClient.class,getHostPort());
  Stat stat=new Stat();
  startServers();
  LOG.debug("Connecting to " + getHostPort());
  ZooKeeper zk=new ZooKeeper(getHostPort(),15000,this);
  waitForConnect(zk,10000);
  zk.create("/simpleCase","orig".getBytes(),Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  startClients();
  for (int i=0; i < getClientCount(); i++) {
    for (int j=0; j < maxTries; j++) {
      try {
        byte b[]=zk.getData("/simpleCase/" + i,false,stat);
        Assert.assertEquals("orig",new String(b));
      }
 catch (      NoNodeException e) {
        if (j + 1 == maxTries) {
          Assert.fail("Max tries exceeded on client " + i);
        }
        Thread.sleep(1000);
      }
    }
  }
  for (int i=0; i < getServerCount(); i++) {
    stopServer(i);
    if (i + 1 > getServerCount() / 2) {
      startServer(i);
    }
 else     if (i + 1 == getServerCount() / 2) {
      Assert.assertTrue("Connection didn't recover",waitForConnect(zk,10000));
      try {
        zk.setData("/simpleCase","new".getBytes(),-1);
      }
 catch (      ConnectionLossException e) {
        Assert.assertTrue("Connection didn't recover",waitForConnect(zk,10000));
        zk.setData("/simpleCase","new".getBytes(),-1);
      }
      for (int j=0; j < i; j++) {
        LOG.info("Starting server " + j);
        startServer(i);
      }
    }
  }
  Thread.sleep(100);
  Assert.assertTrue("Servers didn't bounce",waitForConnect(zk,15000));
  try {
    zk.getData("/simpleCase",false,stat);
  }
 catch (  ConnectionLossException e) {
    Assert.assertTrue("Servers didn't bounce",waitForConnect(zk,15000));
  }
  for (int i=0; i < getClientCount(); i++) {
    for (int j=0; j < maxTries; j++) {
      byte data[]=zk.getData("/simpleCase/" + i,false,stat);
      if (new String(data).equals("new")) {
        break;
      }
      if (j + 1 == maxTries) {
        Assert.fail("max tries exceeded for " + i);
      }
      Thread.sleep(1000);
    }
  }
  zk.setData("/simpleCase","die".getBytes(),-1);
  for (int i=0; i < getClientCount(); i++) {
    try {
      for (int j=0; j < maxTries; j++) {
        zk.getData("/simpleCase/" + i,false,stat);
        if (j + 1 == maxTries) {
          Assert.fail("max tries exceeded waiting for child " + i + " to die");
        }
        Thread.sleep(200);
      }
    }
 catch (    NoNodeException e) {
    }
  }
  stopClients();
  stopServers();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
