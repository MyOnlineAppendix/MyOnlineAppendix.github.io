<h3 style="margin:0px">Class: org.apache.openejb.config.DeploymentsElementTest (19 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(17)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="15"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('15')" data-toggle="tooltip" title="Verifies values related to public fields."><kbd id="tag-15"class="label-info"style="display: inline-block;font-size:7pt" >PublicFieldVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Is an empty test case"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >EmptyTester&nbsp;(1)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="17"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('17')" data-toggle="tooltip" title="Is not executed with the test suite"><kbd id="tag-17"class="label-info"style="display: inline-block;font-size:7pt" >IgnoredMethod&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-12 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is an empty test case
- Is not executed with the test suite
"></span><br>
/** 
 * If something is in the process of being deployed, do not try to autoDeploy it
 * @throws Exception
 */
@Test @Ignore public void alreadyInDeployProcess() throws Exception {
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void invalidFile_notAFile() throws Exception {
  exceptions.expect(RuntimeException.class);
  exceptions.expectMessage("Deployments file=");
  exceptions.expectMessage("Not a file");
  exceptions.expectMessage("myapp.jar");
  final Server server=new Server();
  final File file=server.deploymentsFile("myapp.jar");
  Files.delete(file);
  Files.mkdir(file);
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(0,configuration.containerSystem.applications.size());
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <Deployments dir="myapps"/>
 * <p/>
 * EAR file not extracted
 * Application.xml
 * @throws Exception
 */
@Test public void deploymentsDir_Ear_Packed_ApplicationXml() throws Exception {
  final Server server=new Server();
  final File apps=server.deploymentsDir("myapps");
  final File ear=new File(apps,"colors.ear");
{
    final Map<String,Object> contents=new HashMap<String,Object>();
    contents.put("foo.jar",Archives.jarArchive(Orange.class));
    contents.put("META-INF/application.xml","<application><module><ejb>foo.jar</ejb></module></application>");
    Archives.jarArchive(ear,contents);
  }
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(1,configuration.containerSystem.applications.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-1 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * <Deployments dir="myapps"/>
 * <p/>
 * Two ejb jars
 * <p/>
 * Order should be guaranteed to be the same as
 * they are declared in the openejb.xml
 * <p/>
 * To test, the jars are named intentionally in an order
 * that would naturally sort to be the reverse.
 * @throws Exception
 */
@Test public void deploymentsFile_Jars_Order() throws Exception {
  final Server server=new Server();
{
    final File jar=server.deploymentsFile("2000.jar");
    Archives.jarArchive(jar,null,Yellow.class);
  }
{
    final File jar=server.deploymentsFile("1000.jar");
    Archives.jarArchive(jar,null,Orange.class);
  }
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(2,configuration.containerSystem.applications.size());
  assertEquals("2000",configuration.containerSystem.applications.get(0).appId);
  assertEquals("1000",configuration.containerSystem.applications.get(1).appId);
  final AppInfo yellow=configuration.containerSystem.applications.get(0);
  assertEquals(1,yellow.ejbJars.size());
  assertEquals(1,yellow.ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Yellow",yellow.ejbJars.get(0).enterpriseBeans.get(0).ejbName);
  final AppInfo orange=configuration.containerSystem.applications.get(1);
  assertEquals(1,orange.ejbJars.size());
  assertEquals(1,orange.ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",orange.ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void after(){
  SystemInstance.reset();
}

</code></pre>

<pre class="type-2 type-1 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * <Deployments dir="myapps"/>
 * <p/>
 * Two ejb jars
 * @throws Exception
 */
@Test public void deploymentsDir_Jars_Packed() throws Exception {
  final Server server=new Server();
  final File apps=server.deploymentsDir("myapps");
{
    final File ear=new File(apps,"yellow.jar");
    Archives.jarArchive(ear,null,Yellow.class);
  }
{
    final File ear=new File(apps,"orange.jar");
    Archives.jarArchive(ear,null,Orange.class);
  }
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(2,configuration.containerSystem.applications.size());
  final AppInfo yellow=select(configuration.containerSystem.applications,"yellow");
  assertEquals(1,yellow.ejbJars.size());
  assertEquals(1,yellow.ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Yellow",yellow.ejbJars.get(0).enterpriseBeans.get(0).ejbName);
  final AppInfo orange=select(configuration.containerSystem.applications,"orange");
  assertEquals(1,orange.ejbJars.size());
  assertEquals(1,orange.ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",orange.ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-11 type-1 type-6 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidDir_notReadable() throws Exception {
  if (!System.getProperty("os.name","unknown").toLowerCase().startsWith("win")) {
    exceptions.expect(RuntimeException.class);
    exceptions.expectMessage("Deployments dir=");
    exceptions.expectMessage("Not readable");
    exceptions.expectMessage("myapps");
    final Server server=new Server();
    final File dir=server.deploymentsDir("myapps");
    assertTrue(dir.setReadable(false));
    final OpenEjbConfiguration configuration=server.init();
    assertEquals(0,configuration.containerSystem.applications.size());
  }
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <Deployments dir="myapps"/>
 * <p/>
 * EAR file packed
 * EAR file extracted
 * Application.xml
 * @throws Exception
 */
@Test public void deploymentsDir_Ear_Packed_Unpacked_ApplicationXml() throws Exception {
  final Server server=new Server();
  final File apps=server.deploymentsDir("myapps");
  final File ear=new File(server.getBase(),"colors.ear");
{
    final Map<String,Object> contents=new HashMap<String,Object>();
    contents.put("foo.jar",Archives.jarArchive(Orange.class));
    contents.put("META-INF/application.xml","<application><module><ejb>foo.jar</ejb></module></application>");
    Archives.jarArchive(ear,contents);
  }
  IO.copy(ear,Files.path(apps,"colors.ear"));
  Zips.unzip(ear,Files.mkdir(apps,"colors"));
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(1,configuration.containerSystem.applications.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void invalidFile_doesNotExist() throws Exception {
  exceptions.expect(RuntimeException.class);
  exceptions.expectMessage("Deployments file=");
  exceptions.expectMessage("not exist");
  exceptions.expectMessage("myapp.jar");
  final Server server=new Server();
  final File file=server.deploymentsFile("myapp.jar");
  Files.delete(file);
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(0,configuration.containerSystem.applications.size());
}

</code></pre>

<pre class="type-2 type-11 type-1 type-6 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidFile_notReadable() throws Exception {
  if (!System.getProperty("os.name","unknown").toLowerCase().startsWith("win")) {
    exceptions.expect(RuntimeException.class);
    exceptions.expectMessage("Deployments file=");
    exceptions.expectMessage("Not readable");
    exceptions.expectMessage("myapp.jar");
    final Server server=new Server();
    final File file=server.deploymentsFile("myapp.jar");
    assertTrue(file.createNewFile());
    assertTrue(file.setReadable(false));
    final OpenEjbConfiguration configuration=server.init();
    assertEquals(0,configuration.containerSystem.applications.size());
  }
}

</code></pre>

<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void invalidDir_notADirectory() throws Exception {
  exceptions.expect(RuntimeException.class);
  exceptions.expectMessage("Deployments dir=");
  exceptions.expectMessage("Not a directory");
  exceptions.expectMessage("myapps");
  final Server server=new Server();
  final File dir=server.deploymentsDir("myapps");
  Files.delete(dir);
  assertTrue(dir.createNewFile());
  server.init();
}

</code></pre>

<pre class="type-2 type-1 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * <Deployments dir="myapps/2000.jar"/>
 * <Deployments dir="myapps/2000.jar"/>
 * <Deployments dir="myapps"/>
 * <Deployments dir="myapps"/>
 * <p/>
 * Order should be guaranteed to be the same as
 * they are declared in the openejb.xml
 * <p/>
 * To test, the jars are named intentionally in an order
 * that would naturally sort to be the reverse.
 * @throws Exception
 */
@Test public void deployments_Duplicates() throws Exception {
  final Server server=new Server();
  final File apps=Files.mkdir(server.getBase(),"myapps");
{
    final File jar=server.deploymentsFile("myapps/2000.jar");
    server.deploymentsFile("myapps/2000.jar");
    Archives.jarArchive(jar,null,Yellow.class);
  }
{
    server.deploymentsDir("myapps");
    server.deploymentsDir("myapps");
    final File jar=Files.path(apps,"1000.jar");
    Archives.jarArchive(jar,null,Orange.class);
  }
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(2,configuration.containerSystem.applications.size());
  assertEquals("2000",configuration.containerSystem.applications.get(0).appId);
  assertEquals("1000",configuration.containerSystem.applications.get(1).appId);
  final AppInfo yellow=configuration.containerSystem.applications.get(0);
  assertEquals(1,yellow.ejbJars.size());
  assertEquals(1,yellow.ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Yellow",yellow.ejbJars.get(0).enterpriseBeans.get(0).ejbName);
  final AppInfo orange=configuration.containerSystem.applications.get(1);
  assertEquals(1,orange.ejbJars.size());
  assertEquals(1,orange.ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",orange.ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <Deployments dir="myapps"/>
 * <p/>
 * EAR file extracted
 * @throws Exception
 */
@Test public void deploymentsDir_Ear_Unpacked_NoApplicationXml() throws Exception {
  final Server server=new Server();
  final File apps=server.deploymentsDir("myapps");
  final File ear=new File(server.getBase(),"colors.ear");
{
    final Map<String,Object> contents=new HashMap<String,Object>();
    contents.put("foo.jar",Archives.jarArchive(Orange.class));
    Archives.jarArchive(ear,contents);
  }
  Zips.unzip(ear,Files.mkdir(apps,"colors"));
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(1,configuration.containerSystem.applications.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <Deployments dir="myapps"/>
 * <p/>
 * EAR file not extracted
 * @throws Exception
 */
@Test public void deploymentsDir_Ear_Packed_NoApplicationXml() throws Exception {
  final Server server=new Server();
  final File apps=server.deploymentsDir("myapps");
  final File ear=new File(apps,"colors.ear");
{
    final Map<String,Object> contents=new HashMap<String,Object>();
    contents.put("foo.jar",Archives.jarArchive(Orange.class));
    Archives.jarArchive(ear,contents);
  }
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(1,configuration.containerSystem.applications.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <Deployments dir="myapps"/>
 * <p/>
 * EAR file packed
 * EAR file extracted
 * <p/>
 * The packed version is newer and an updated version of the packed version
 * We should remove the extracted version and unpack the newer ear
 * @throws Exception
 */
@Test public void deploymentsDir_Ear_Packed_Unpacked_Modified() throws Exception {
  final Server server=new Server();
  final File apps=server.deploymentsDir("myapps");
{
    final File ear=new File(server.getBase(),"colors.ear");
    final Map<String,Object> contents=new HashMap<String,Object>();
    contents.put("foo.jar",Archives.jarArchive(Orange.class));
    contents.put("META-INF/application.xml","<application><module><ejb>foo.jar</ejb></module></application>");
    Archives.jarArchive(ear,contents);
    Zips.unzip(ear,Files.mkdir(apps,"colors"));
  }
  Thread.sleep(100);
{
    final File ear=new File(server.getBase(),"colors.ear");
    final Map<String,Object> contents=new HashMap<String,Object>();
    contents.put("foo.jar",Archives.jarArchive(Yellow.class));
    contents.put("META-INF/application.xml","<application><module><ejb>foo.jar</ejb></module></application>");
    Archives.jarArchive(ear,contents);
    Zips.unzip(ear,Files.mkdir(apps,"colors"));
  }
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(1,configuration.containerSystem.applications.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Yellow",configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <Deployments dir="myapps"/>
 * <p/>
 * EAR file packed
 * EAR file extracted
 * @throws Exception
 */
@Test public void deploymentsDir_Ear_Packed_Unpacked_NoApplicationXml() throws Exception {
  final Server server=new Server();
  final File apps=server.deploymentsDir("myapps");
  final File ear=new File(server.getBase(),"colors.ear");
{
    final Map<String,Object> contents=new HashMap<String,Object>();
    contents.put("foo.jar",Archives.jarArchive(Orange.class));
    Archives.jarArchive(ear,contents);
  }
  IO.copy(ear,Files.path(apps,"colors.ear"));
  Zips.unzip(ear,Files.mkdir(apps,"colors"));
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(1,configuration.containerSystem.applications.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-1 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * <Deployments dir="myapps/2000.jar"/>
 * <Deployments dir="myapps"/>
 * <p/>
 * Order should be guaranteed to be the same as
 * they are declared in the openejb.xml
 * <p/>
 * To test, the jars are named intentionally in an order
 * that would naturally sort to be the reverse.
 * @throws Exception
 */
@Test public void deploymentsFile_and_Dir_Jars_Order() throws Exception {
  final Server server=new Server();
  final File apps=Files.mkdir(server.getBase(),"myapps");
{
    final File jar=server.deploymentsFile("myapps/2000.jar");
    Archives.jarArchive(jar,null,Yellow.class);
  }
{
    server.deploymentsDir("myapps");
    final File jar=Files.path(apps,"1000.jar");
    Archives.jarArchive(jar,null,Orange.class);
  }
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(2,configuration.containerSystem.applications.size());
  assertEquals("2000",configuration.containerSystem.applications.get(0).appId);
  assertEquals("1000",configuration.containerSystem.applications.get(1).appId);
  final AppInfo yellow=configuration.containerSystem.applications.get(0);
  assertEquals(1,yellow.ejbJars.size());
  assertEquals(1,yellow.ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Yellow",yellow.ejbJars.get(0).enterpriseBeans.get(0).ejbName);
  final AppInfo orange=configuration.containerSystem.applications.get(1);
  assertEquals(1,orange.ejbJars.size());
  assertEquals(1,orange.ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",orange.ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <Deployments dir="myapps"/>
 * <p/>
 * EAR file extracted
 * Application.xml
 * @throws Exception
 */
@Test public void deploymentsDir_Ear_Unpacked_ApplicationXml() throws Exception {
  final Server server=new Server();
  final File apps=server.deploymentsDir("myapps");
  final File ear=new File(server.getBase(),"colors.ear");
{
    final Map<String,Object> contents=new HashMap<String,Object>();
    contents.put("foo.jar",Archives.jarArchive(Orange.class));
    contents.put("META-INF/application.xml","<application><module><ejb>foo.jar</ejb></module></application>");
    Archives.jarArchive(ear,contents);
  }
  Zips.unzip(ear,Files.mkdir(apps,"colors"));
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(1,configuration.containerSystem.applications.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.size());
  assertEquals(1,configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.size());
  assertEquals("Orange",configuration.containerSystem.applications.get(0).ejbJars.get(0).enterpriseBeans.get(0).ejbName);
}

</code></pre>

<pre class="type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * We do not treat this as a failure case due to backwards compatibility
 * @throws Exception
 */
@Test public void invalidDir_doesNotExist() throws Exception {
  final Server server=new Server();
  final File dir=server.deploymentsDir("myapps");
  Files.delete(dir);
  final OpenEjbConfiguration configuration=server.init();
  assertEquals(0,configuration.containerSystem.applications.size());
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
