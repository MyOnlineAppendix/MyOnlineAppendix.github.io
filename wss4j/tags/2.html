<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.wss4j.common.attachment.CRLFOutputStreamTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRandom() throws Exception {
  byte[] pool=new byte[]{'\r','\n','a'};
  Random random=new Random();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  CRLFOutputStream crlfOutputStream=new CRLFOutputStream(baos);
  ByteArrayOutputStream testString=new ByteArrayOutputStream();
  for (int h=0; h < 10000; h++) {
    if (random.nextBoolean()) {
      byte b=pool[random.nextInt(pool.length)];
      testString.write(b);
      crlfOutputStream.write(b);
    }
 else {
      int byteCount=random.nextInt(1000);
      byte[] bytes=new byte[byteCount];
      for (int i=0; i < byteCount; i++) {
        bytes[i]=pool[random.nextInt(pool.length)];
      }
      testString.write(bytes);
      crlfOutputStream.write(bytes);
    }
  }
  crlfOutputStream.close();
  byte[] res=baos.toByteArray();
  for (int i=0; i < res.length; i++) {
    byte re=res[i];
    if (re == '\r') {
      if (res[i + 1] != '\n') {
        throw new Exception("Missing \\n in\n" + createEscapedString(res) + "\n input string: "+ createEscapedString(testString.toByteArray()));
      }
    }
 else     if (re == '\n' && res[i - 1] != '\r') {
      throw new Exception("Missing \\r in\n" + createEscapedString(res) + "\n input string: "+ createEscapedString(testString.toByteArray()));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.components.crypto.CryptoProviderTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Like before but substitute in an "E" instead of the OID
 * @throws Exception
 */
@Test public void testSignatureOtherEmailAddress() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("wss86","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=sign.build(doc,crypto,secHeader);
  String outputString=XMLUtils.prettyDocumentToString(signedDoc);
  outputString=outputString.replace("1.2.840.113549.1.9.1=#16125765726e6572406578616d706c652e636f6d","E=Werner@example.com");
  DocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();
  dbf.setNamespaceAware(true);
  InputStream is=new ByteArrayInputStream(outputString.getBytes());
  Document parsedDoc=dbf.newDocumentBuilder().parse(is);
  verify(parsedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test signing a SOAP message using a cert with an OID
 */
@Test public void testSignatureOID() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("wss86","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=sign.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test loading a certificate using BouncyCastle, and using it to encrypt a message, but
 * decrypt the message using the Java Keystore provider
 */
@Test public void testInterop() throws Exception {
  byte[] certBytes=Base64.decode("MIIDqTCCApGgAwIBAgIEePiYTTANBgkqhkiG9w0BAQsFADCBhDELMAkGA1UEBhMCREUxDzANBgNV" + "BAgTBkJheWVybjEPMA0GA1UEBxMGTXVuaWNoMQ8wDQYDVQQKEwZBcGFjaGUxDjAMBgNVBAsTBVdT" + "UzRKMQ8wDQYDVQQDEwZXZXJuZXIxITAfBgkqhkiG9w0BCQEWEldlcm5lckBleGFtcGxlLmNvbTAe"+ "Fw0xNTA5MDkxNTA3MzFaFw0yNTA5MDYxNTA3MzFaMIGEMQswCQYDVQQGEwJERTEPMA0GA1UECBMG"+ "QmF5ZXJuMQ8wDQYDVQQHEwZNdW5pY2gxDzANBgNVBAoTBkFwYWNoZTEOMAwGA1UECxMFV1NTNEox"+ "DzANBgNVBAMTBldlcm5lcjEhMB8GCSqGSIb3DQEJARYSV2VybmVyQGV4YW1wbGUuY29tMIIBIjAN"+ "BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoUlwwKbNU0vNPwEc32E85k36n7cWAmuuhpX+CoTk"+ "XOfvpyoVcwBI8LwMmT1CR9KPxa+zmcE7RmX5qzVaW7Ukzra/pfD7YC3WGGAU9Awsq5OFLsMc4tZ/"+ "7FM5azGdZA/wSI2384Ytnu88Z8O1qnBblLdNluNWVADq5tvgAdPQMoks9Xg+9SBiwj2p3C0RD0uM"+ "x0bwscNEDWeHUJeGqNbWzEeYCvFLDGdl1Or3uha+drq4fNoVGstybM0VeGvFjP3NEX8dfl9WTxAl"+ "3dB0TXzb70RuQghLqHJtDEXMC/ckaNHht6F/VcOxjZCtpLlMUptyPjrMDFOIaZ5q/6NSiMIjqwID"+ "AQABoyEwHzAdBgNVHQ4EFgQUviIg1rtoiwto4gYIAWFHCsCDISkwDQYJKoZIhvcNAQELBQADggEB"+ "AJEaMtEBpI7X1lx2+Wcjn2a3xugfTGZcy3s4fxGpbCxcdbDS7gWR/N+acwp4GXEbDrObwxIO/Kt5"+ "eMzfD5EPCuMdLfLjK+G27RXc/89bR3aphm6ZyLnTLBJ5h24Of9+uDKY2bVIcF62uyXCnVAoq6dY/"+ "rBj7btSjAOWFshMDJGNN7k/78s33sTdJfD2NQDvAvRZb1hYiUGcUij0ka+bhS/EtazH411w2NOQY"+ "UyZ50HRroKJx1PPCE+OTO5JYPNQB2rauK63RHGGC94mY2ySCE2KP/yaWhkDJ60X2JKgnTLKUZxLP"+ "9IioeHVeUzGIccIicoiZR5kqaiqoEk82V81R+VA=");
  try {
    Security.addProvider(new BouncyCastleProvider());
    CertificateFactory factory=CertificateFactory.getInstance("X.509","BC");
    X509Certificate cert=(X509Certificate)factory.generateCertificate(new ByteArrayInputStream(certBytes));
    WSSecEncrypt encrypt=new WSSecEncrypt();
    encrypt.setUseThisCert(cert);
    Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
    WSSecHeader secHeader=new WSSecHeader(doc);
    secHeader.insertSecurityHeader();
    Document encryptedDoc=encrypt.build(doc,crypto,secHeader);
    if (LOG.isDebugEnabled()) {
      String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
      LOG.debug(outputString);
    }
    verify(encryptedDoc);
  }
  finally {
    Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Like before but substitute in an "EMAILADDRESS" instead of the OID
 * @throws Exception
 */
@Test public void testSignatureEmailAddress() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("wss86","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=sign.build(doc,crypto,secHeader);
  String outputString=XMLUtils.prettyDocumentToString(signedDoc);
  outputString=outputString.replace("1.2.840.113549.1.9.1=#16125765726e6572406578616d706c652e636f6d","EMAILADDRESS=Werner@example.com");
  DocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();
  dbf.setNamespaceAware(true);
  InputStream is=new ByteArrayInputStream(outputString.getBytes());
  Document parsedDoc=dbf.newDocumentBuilder().parse(is);
  verify(parsedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.handler.SecurityActionTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMixedDoubleSignature() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  SignatureActionToken actionToken=new SignatureActionToken();
  actionToken.setUser("wss40");
  actionToken.setCryptoProperties("wss40.properties");
  actionToken.setKeyIdentifierId(WSConstants.BST_DIRECT_REFERENCE);
  SignatureActionToken actionToken2=new SignatureActionToken();
  actionToken2.setKeyIdentifierId(WSConstants.ENCRYPTED_KEY_SHA1_IDENTIFIER);
  actionToken2.setKey(keyData);
  actionToken2.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  WSEncryptionPart encP=new WSEncryptionPart("Timestamp",WSConstants.WSU_NS,"");
  actionToken2.setParts(Collections.singletonList(encP));
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN,actionToken));
  actions.add(new HandlerAction(WSConstants.SIGN,actionToken2));
  actions.add(new HandlerAction(WSConstants.TS,null));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  SecretKeyCallbackHandler secretKeyCallbackHandler=new SecretKeyCallbackHandler();
  byte[] encodedBytes=KeyUtils.generateDigest(keyData);
  String identifier=Base64.encode(encodedBytes);
  secretKeyCallbackHandler.addSecretKey(identifier,keyData);
  verify(doc,secretKeyCallbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAsymmetricSignature() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  SignatureActionToken actionToken=new SignatureActionToken();
  actionToken.setUser("wss40");
  actionToken.setCryptoProperties("wss40.properties");
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN,actionToken));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc,null);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAsymmetricEncryption() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  EncryptionActionToken actionToken=new EncryptionActionToken();
  actionToken.setUser("wss40");
  actionToken.setCryptoProperties("wss40.properties");
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc,new KeystoreCallbackHandler());
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSymmetricSignatureEncryptionResponse() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  EncryptionActionToken actionToken=new EncryptionActionToken();
  actionToken.setKey(keyData);
  actionToken.setSymmetricAlgorithm(WSConstants.AES_128);
  actionToken.setKeyIdentifierId(WSConstants.ENCRYPTED_KEY_SHA1_IDENTIFIER);
  actionToken.setEncSymmetricEncryptionKey(false);
  SignatureActionToken actionToken2=new SignatureActionToken();
  actionToken2.setKeyIdentifierId(WSConstants.ENCRYPTED_KEY_SHA1_IDENTIFIER);
  actionToken2.setKey(keyData);
  actionToken2.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN,actionToken2));
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  SecretKeyCallbackHandler secretKeyCallbackHandler=new SecretKeyCallbackHandler();
  byte[] encodedBytes=KeyUtils.generateDigest(keyData);
  String identifier=Base64.encode(encodedBytes);
  secretKeyCallbackHandler.addSecretKey(identifier,keyData);
  verify(doc,secretKeyCallbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAsymmetricSignatureEncryption() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  SignatureActionToken actionToken=new SignatureActionToken();
  actionToken.setUser("wss40");
  actionToken.setCryptoProperties("wss40.properties");
  actionToken.setKeyIdentifierId(WSConstants.BST_DIRECT_REFERENCE);
  EncryptionActionToken actionToken2=new EncryptionActionToken();
  actionToken2.setUser("wss40");
  actionToken2.setCryptoProperties("wss40.properties");
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN,actionToken));
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken2));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc,new KeystoreCallbackHandler());
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSymmetricEncryption() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  EncryptionActionToken actionToken=new EncryptionActionToken();
  actionToken.setKeyIdentifierId(WSConstants.ENCRYPTED_KEY_SHA1_IDENTIFIER);
  actionToken.setKey(keyData);
  actionToken.setSymmetricAlgorithm(WSConstants.AES_128);
  actionToken.setEncSymmetricEncryptionKey(false);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  SecretKeyCallbackHandler secretKeyCallbackHandler=new SecretKeyCallbackHandler();
  byte[] encodedBytes=KeyUtils.generateDigest(keyData);
  String identifier=Base64.encode(encodedBytes);
  secretKeyCallbackHandler.addSecretKey(identifier,keyData);
  verify(doc,secretKeyCallbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSymmetricSignature() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  SignatureActionToken actionToken=new SignatureActionToken();
  actionToken.setKeyIdentifierId(WSConstants.ENCRYPTED_KEY_SHA1_IDENTIFIER);
  actionToken.setKey(keyData);
  actionToken.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN,actionToken));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  SecretKeyCallbackHandler secretKeyCallbackHandler=new SecretKeyCallbackHandler();
  byte[] encodedBytes=KeyUtils.generateDigest(keyData);
  String identifier=Base64.encode(encodedBytes);
  secretKeyCallbackHandler.addSecretKey(identifier,keyData);
  verify(doc,secretKeyCallbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSymmetricSignatureEncryption() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  EncryptionActionToken actionToken=new EncryptionActionToken();
  actionToken.setKey(keyData);
  actionToken.setSymmetricAlgorithm(WSConstants.AES_128);
  actionToken.setKeyIdentifierId(WSConstants.SKI_KEY_IDENTIFIER);
  actionToken.setUser("wss40");
  actionToken.setCryptoProperties("wss40.properties");
  actionToken.setTokenId(IDGenerator.generateID("EK-"));
  SignatureActionToken actionToken2=new SignatureActionToken();
  actionToken2.setKeyIdentifierId(WSConstants.CUSTOM_SYMM_SIGNING);
  actionToken2.setKey(keyData);
  actionToken2.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  actionToken2.setTokenType(WSConstants.WSS_ENC_KEY_VALUE_TYPE);
  actionToken2.setTokenId(actionToken.getTokenId());
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN,actionToken2));
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc,new KeystoreCallbackHandler());
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAsymmetricDoubleSignature() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  SignatureActionToken actionToken=new SignatureActionToken();
  actionToken.setUser("wss40");
  actionToken.setCryptoProperties("wss40.properties");
  actionToken.setKeyIdentifierId(WSConstants.BST_DIRECT_REFERENCE);
  SignatureActionToken actionToken2=new SignatureActionToken();
  actionToken2.setUser("16c73ab6-b892-458f-abf5-2f875f74882e");
  actionToken2.setCryptoProperties("crypto.properties");
  actionToken2.setIncludeToken(false);
  WSEncryptionPart encP=new WSEncryptionPart("Timestamp",WSConstants.WSU_NS,"");
  actionToken2.setParts(Collections.singletonList(encP));
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN,actionToken));
  actions.add(new HandlerAction(WSConstants.SIGN,actionToken2));
  actions.add(new HandlerAction(WSConstants.TS,null));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMixedDoubleEncryption() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  EncryptionActionToken actionToken=new EncryptionActionToken();
  actionToken.setUser("wss40");
  actionToken.setCryptoProperties("wss40.properties");
  EncryptionActionToken actionToken2=new EncryptionActionToken();
  actionToken2.setKeyIdentifierId(WSConstants.ENCRYPTED_KEY_SHA1_IDENTIFIER);
  actionToken2.setKey(keyData);
  actionToken2.setSymmetricAlgorithm(WSConstants.AES_128);
  actionToken2.setEncSymmetricEncryptionKey(false);
  WSEncryptionPart encP=new WSEncryptionPart("Timestamp",WSConstants.WSU_NS,"");
  actionToken2.setParts(Collections.singletonList(encP));
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken));
  actions.add(new HandlerAction(WSConstants.TS,null));
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken2));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  SecretKeyCallbackHandler secretKeyCallbackHandler=new SecretKeyCallbackHandler();
  byte[] encodedBytes=KeyUtils.generateDigest(keyData);
  String identifier=Base64.encode(encodedBytes);
  secretKeyCallbackHandler.addSecretKey(identifier,keyData);
  CombinedCallbackHandler combinedCallbackHandler=new CombinedCallbackHandler(secretKeyCallbackHandler,new KeystoreCallbackHandler());
  verify(doc,combinedCallbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAsymmetricDoubleEncryption() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  EncryptionActionToken actionToken=new EncryptionActionToken();
  actionToken.setUser("wss40");
  actionToken.setCryptoProperties("wss40.properties");
  EncryptionActionToken actionToken2=new EncryptionActionToken();
  actionToken2.setUser("16c73ab6-b892-458f-abf5-2f875f74882e");
  actionToken2.setCryptoProperties("crypto.properties");
  WSEncryptionPart encP=new WSEncryptionPart("Timestamp",WSConstants.WSU_NS,"");
  actionToken2.setParts(Collections.singletonList(encP));
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken));
  actions.add(new HandlerAction(WSConstants.TS,null));
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken2));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAsymmetricEncryptionIncludeToken() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  reqData.setMsgContext(messageContext);
  EncryptionActionToken actionToken=new EncryptionActionToken();
  actionToken.setUser("wss40");
  actionToken.setCryptoProperties("wss40.properties");
  actionToken.setIncludeToken(true);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.ENCR,actionToken));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc,new KeystoreCallbackHandler());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.handler.SignatureUTAliasTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test involving adding a Username Token to a SOAP message and signing it, where the
 * private key for signature is extracted from the KeyStore using a different username/alias
 * to the UsernameToken.
 */
@Test public void testUsernameTokenSignatureHandler() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("alice");
  reqData.setPwType(WSConstants.PASSWORD_TEXT);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,this);
  messageContext.put(WSHandlerConstants.SIGNATURE_USER,"wss40");
  messageContext.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  messageContext.put(WSHandlerConstants.SIGNATURE_PARTS,"{}{" + WSConstants.WSSE_NS + "}"+ "UsernameToken");
  messageContext.put(WSHandlerConstants.SIG_KEY_ID,"DirectReference");
  reqData.setMsgContext(messageContext);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.UT));
  actions.add(new HandlerAction(WSConstants.SIGN));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After Signing....");
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.handler.UseReqSigCertTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncludedCertificate() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("wss40");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  config.put(WSHandlerConstants.SIG_KEY_ID,"DirectReference");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  config.put(WSHandlerConstants.SIGNATURE_PARTS,"{}{" + WSConstants.WSU_NS + "}Timestamp");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN));
  actions.add(new HandlerAction(WSConstants.TS));
  handler.send(doc,reqData,actions,true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message:");
    LOG.debug(outputString);
  }
  WSHandlerResult results=processRequest(doc);
  List<WSHandlerResult> handlerResults=new ArrayList<>();
  handlerResults.add(0,results);
  sendResponse(handlerResults);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSKIKeyIdentifier() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("wss40");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  config.put(WSHandlerConstants.SIG_KEY_ID,"SKIKeyIdentifier");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  config.put(WSHandlerConstants.SIGNATURE_PARTS,"{}{" + WSConstants.WSU_NS + "}Timestamp");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN));
  actions.add(new HandlerAction(WSConstants.TS));
  handler.send(doc,reqData,actions,true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message:");
    LOG.debug(outputString);
  }
  WSHandlerResult results=processRequest(doc);
  List<WSHandlerResult> handlerResults=new ArrayList<>();
  handlerResults.add(0,results);
  sendResponse(handlerResults);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIssuerSerial() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("wss40");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  config.put(WSHandlerConstants.SIG_KEY_ID,"IssuerSerial");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  config.put(WSHandlerConstants.SIGNATURE_PARTS,"{}{" + WSConstants.WSU_NS + "}Timestamp");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN));
  actions.add(new HandlerAction(WSConstants.TS));
  handler.send(doc,reqData,actions,true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message:");
    LOG.debug(outputString);
  }
  WSHandlerResult results=processRequest(doc);
  List<WSHandlerResult> handlerResults=new ArrayList<>();
  handlerResults.add(0,results);
  sendResponse(handlerResults);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.DerivedKeyActionTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureX509() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("wss40");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,callbackHandler);
  config.put(WSHandlerConstants.DERIVED_TOKEN_REFERENCE,"DirectReference");
  config.put(WSHandlerConstants.DERIVED_TOKEN_KEY_ID,"X509KeyIdentifier");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.DKT_SIGN);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureThumbprintSHA1StrongDigest() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("wss40");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,callbackHandler);
  config.put(WSHandlerConstants.SIG_DIGEST_ALGO,WSConstants.SHA256);
  config.put(WSHandlerConstants.DERIVED_TOKEN_KEY_ID,"Thumbprint");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.DKT_SIGN);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureSCT() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  SecretKeyCallbackHandler secretKeyCallbackHandler=new SecretKeyCallbackHandler();
  KeyGenerator keyGen=KeyGenerator.getInstance("AES");
  keyGen.init(128);
  SecretKey key=keyGen.generateKey();
  byte[] keyData=key.getEncoded();
  secretKeyCallbackHandler.setOutboundSecret(keyData);
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.PW_CALLBACK_REF,secretKeyCallbackHandler);
  config.put(WSHandlerConstants.DERIVED_TOKEN_REFERENCE,"SecurityContextToken");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.DKT_SIGN);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc,secretKeyCallbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureSKI() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("wss40");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,callbackHandler);
  config.put(WSHandlerConstants.DERIVED_TOKEN_KEY_ID,"SKIKeyIdentifier");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.DKT_SIGN);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureEncryptedKeyThumbprintSHA1() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("wss40");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,callbackHandler);
  config.put(WSHandlerConstants.DERIVED_TOKEN_REFERENCE,"EncryptedKey");
  config.put(WSHandlerConstants.DERIVED_TOKEN_KEY_ID,"Thumbprint");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.DKT_SIGN);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.DerivedKeyTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test encryption using a DerivedKeyToken using TRIPLEDES
 * @throws Exception Thrown when there is any problem in signing or
 * verification
 */
@Test public void testEncryptionDecryptionTRIPLEDES() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecEncryptedKey encrKeyBuilder=new WSSecEncryptedKey();
  encrKeyBuilder.setUserInfo("wss40");
  encrKeyBuilder.setKeyIdentifierType(WSConstants.THUMBPRINT_IDENTIFIER);
  encrKeyBuilder.prepare(doc,crypto);
  byte[] ek=encrKeyBuilder.getEphemeralKey();
  String tokenIdentifier=encrKeyBuilder.getId();
  WSSecDKEncrypt encrBuilder=new WSSecDKEncrypt();
  encrBuilder.setSymmetricEncAlgorithm(WSConstants.AES_128);
  encrBuilder.setExternalKey(ek,tokenIdentifier);
  Document encryptedDoc=encrBuilder.build(doc,secHeader);
  encrKeyBuilder.prependToHeader(secHeader);
  encrKeyBuilder.prependBSTElementToHeader(secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Encrypted message: 3DES  + DerivedKeys");
    String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureEncrypt() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecEncryptedKey encrKeyBuilder=new WSSecEncryptedKey();
  encrKeyBuilder.setUserInfo("wss40");
  encrKeyBuilder.setKeyIdentifierType(WSConstants.THUMBPRINT_IDENTIFIER);
  encrKeyBuilder.prepare(doc,crypto);
  byte[] ek=encrKeyBuilder.getEphemeralKey();
  String tokenIdentifier=encrKeyBuilder.getId();
  WSSecDKSign sigBuilder=new WSSecDKSign();
  sigBuilder.setExternalKey(ek,tokenIdentifier);
  sigBuilder.setSignatureAlgorithm(WSConstants.HMAC_SHA1);
  LOG.info("Before HMAC-SHA1 signature");
  Document signedDoc=sigBuilder.build(doc,secHeader);
  WSSecDKEncrypt encrBuilder=new WSSecDKEncrypt();
  encrBuilder.setSymmetricEncAlgorithm(WSConstants.AES_128);
  encrBuilder.setExternalKey(ek,tokenIdentifier);
  Document signedEncryptedDoc=encrBuilder.build(signedDoc,secHeader);
  encrKeyBuilder.prependToHeader(secHeader);
  encrKeyBuilder.prependBSTElementToHeader(secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Encrypted message: 3DES  + DerivedKeys");
    String outputString=XMLUtils.prettyDocumentToString(signedEncryptedDoc);
    LOG.debug(outputString);
  }
  verify(signedEncryptedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEncryptSignature() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecEncryptedKey encrKeyBuilder=new WSSecEncryptedKey();
  encrKeyBuilder.setUserInfo("wss40");
  encrKeyBuilder.setKeyIdentifierType(WSConstants.THUMBPRINT_IDENTIFIER);
  encrKeyBuilder.prepare(doc,crypto);
  byte[] ek=encrKeyBuilder.getEphemeralKey();
  String tokenIdentifier=encrKeyBuilder.getId();
  WSSecDKEncrypt encrBuilder=new WSSecDKEncrypt();
  encrBuilder.setSymmetricEncAlgorithm(WSConstants.AES_128);
  encrBuilder.setExternalKey(ek,tokenIdentifier);
  encrBuilder.build(doc,secHeader);
  WSSecDKSign sigBuilder=new WSSecDKSign();
  sigBuilder.setExternalKey(ek,tokenIdentifier);
  sigBuilder.setSignatureAlgorithm(WSConstants.HMAC_SHA1);
  LOG.info("Before HMAC-SHA1 signature");
  Document encryptedSignedDoc=sigBuilder.build(doc,secHeader);
  encrKeyBuilder.prependToHeader(secHeader);
  encrKeyBuilder.prependBSTElementToHeader(secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Encrypted message: 3DES  + DerivedKeys");
    String outputString=XMLUtils.prettyDocumentToString(encryptedSignedDoc);
    LOG.debug(outputString);
  }
  verify(encryptedSignedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test encryption using a DerivedKeyToken using AES128
 * @throws Exception Thrown when there is any problem in signing or verification
 */
@Test public void testEncryptionDecryptionAES128() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecEncryptedKey encrKeyBuilder=new WSSecEncryptedKey();
  encrKeyBuilder.setUserInfo("wss40");
  encrKeyBuilder.setKeyIdentifierType(WSConstants.THUMBPRINT_IDENTIFIER);
  encrKeyBuilder.prepare(doc,crypto);
  byte[] ek=encrKeyBuilder.getEphemeralKey();
  String tokenIdentifier=encrKeyBuilder.getId();
  WSSecDKEncrypt encrBuilder=new WSSecDKEncrypt();
  encrBuilder.setSymmetricEncAlgorithm(WSConstants.AES_128);
  encrBuilder.setExternalKey(ek,tokenIdentifier);
  Document encryptedDoc=encrBuilder.build(doc,secHeader);
  encrKeyBuilder.prependToHeader(secHeader);
  encrKeyBuilder.prependBSTElementToHeader(secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Encrypted message: 3DES  + DerivedKeys");
    String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.EncryptionCRLTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that encrypts without certificate revocation check
 * so it should pass
 * @throws java.lang.Exception Thrown when there is any problem in encryption or decryption
 */
@Test public void testEncryptionWithOutRevocationCheck() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  EncryptionActionToken actionToken=new EncryptionActionToken();
  actionToken.setUser("wss40rev");
  actionToken.setKeyIdentifierId(WSConstants.BST_DIRECT_REFERENCE);
  actionToken.setSymmetricAlgorithm(WSConstants.TRIPLE_DES);
  actionToken.setCrypto(crypto);
  reqData.setEncryptionToken(actionToken);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,keystoreCallbackHandler);
  reqData.setMsgContext(messageContext);
  reqData.setUsername("wss40rev");
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  handler.send(doc,reqData,Collections.singletonList(new HandlerAction(WSConstants.ENCR)),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc,crypto,keystoreCallbackHandler);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.EncryptionPartsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOptionalSOAPHeaderNotPresent() throws Exception {
  WSSecEncrypt encrypt=new WSSecEncrypt();
  encrypt.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  encrypt.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSEncryptionPart encP=new WSEncryptionPart("foobar","urn:foo.bar","");
  encP.setRequired(false);
  encrypt.getParts().add(encP);
  String soapNamespace=WSSecurityUtil.getSOAPNamespace(doc.getDocumentElement());
  encP=new WSEncryptionPart(WSConstants.ELEM_BODY,soapNamespace,"Content");
  encrypt.getParts().add(encP);
  Document encryptedDoc=encrypt.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
    LOG.debug(outputString);
  }
  verify(encryptedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOptionalSOAPHeaderPresent() throws Exception {
  WSSecEncrypt encrypt=new WSSecEncrypt();
  encrypt.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  encrypt.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  Document doc=SOAPUtil.toSOAPPart(SOAPMSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSEncryptionPart encP=new WSEncryptionPart("foobar","urn:foo.bar","");
  encP.setRequired(false);
  encrypt.getParts().add(encP);
  String soapNamespace=WSSecurityUtil.getSOAPNamespace(doc.getDocumentElement());
  encP=new WSEncryptionPart(WSConstants.ELEM_BODY,soapNamespace,"Content");
  encrypt.getParts().add(encP);
  Document encryptedDoc=encrypt.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
    LOG.debug(outputString);
  }
  verify(encryptedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.EncryptionTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * In this test an EncryptedKey structure is embedded in the EncryptedData structure.
 * The EncryptedKey structure refers to a certificate via the SKI_KEY_IDENTIFIER.
 */
@Test public void testEmbeddedEncryptedKey() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecEncrypt builder=new WSSecEncrypt();
  builder.setUserInfo("wss40");
  builder.setKeyIdentifierType(WSConstants.SKI_KEY_IDENTIFIER);
  builder.setSymmetricEncAlgorithm(WSConstants.AES_128);
  builder.prepare(doc,crypto);
  builder.setEmbedEncryptedKey(true);
  SOAPConstants soapConstants=WSSecurityUtil.getSOAPConstants(doc.getDocumentElement());
  java.util.List<WSEncryptionPart> parts=new ArrayList<>();
  WSEncryptionPart encP=new WSEncryptionPart(soapConstants.getBodyQName().getLocalPart(),soapConstants.getEnvelopeURI(),"Content");
  parts.add(encP);
  builder.encrypt();
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc,crypto,keystoreCallbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that encrypt and then again encrypts (Super encryption) WS-Security
 * envelope and then verifies it <p/>
 * @throws ExceptionThrown when there is any problem in encryption or
 * verification
 */
@Test public void testEncryptionEncryption() throws Exception {
  Crypto encCrypto=CryptoFactory.getInstance();
  WSSecEncrypt encrypt=new WSSecEncrypt();
  encrypt.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e");
  LOG.info("Before Encryption....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document encryptedDoc=encrypt.build(doc,encCrypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After the first encryption:");
    String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
    LOG.debug(outputString);
  }
  Document encryptedEncryptedDoc=encrypt.build(encryptedDoc,encCrypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After the second encryption:");
    String outputString=XMLUtils.prettyDocumentToString(encryptedEncryptedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Encryption....");
  verify(encryptedEncryptedDoc,encCrypto,keystoreCallbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that encrypts using EncryptedKeySHA1, where it uses a symmetric key, rather than a
 * generated session key which is then encrypted using a public key. The request is generated
 * using WSHandler, instead of coding it.
 * @throws java.lang.Exception Thrown when there is any problem in encryption or decryption
 */
@Test public void testEncryptionSHA1SymmetricBytesHandler() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.ENC_SYM_ENC_KEY,"false");
  messageContext.put(WSHandlerConstants.ENC_KEY_ID,"EncryptedKeySHA1");
  secretKeyCallbackHandler.setOutboundSecret(keyData);
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,secretKeyCallbackHandler);
  reqData.setMsgContext(messageContext);
  reqData.setUsername("");
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.ENCR);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc,null,secretKeyCallbackHandler);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.NoSoapPrefixSignatureTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test signing a SOAP message that has no SOAP namespace prefix
 */
@Test public void testNoSOAPNamespacePrefix() throws Exception {
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  sign.setKeyIdentifierType(WSConstants.BST_DIRECT_REFERENCE);
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.setActor("bob");
  secHeader.insertSecurityHeader();
  Document signedDoc=sign.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.PasswordEncryptorTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignature() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  builder.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureWSHandler() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("16c73ab6-b892-458f-abf5-2f875f74882e");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"crypto_enc.properties");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,callbackHandler);
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.SIGN);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDecryptionWSHandler() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("16c73ab6-b892-458f-abf5-2f875f74882e");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.ENC_PROP_FILE,"crypto_enc.properties");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,callbackHandler);
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.ENCR);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDecryption() throws Exception {
  WSSecEncrypt builder=new WSSecEncrypt();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  builder.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  builder.setKeyEncAlgo(WSConstants.KEYTRANSPORT_RSAOEP);
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document encryptedDoc=builder.build(doc,crypto,secHeader);
  String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(encryptedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.ReplayTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that creates, sends and processes an unsigned SAML 2 authentication assertion. This
 * is just a sanity test to make sure that it is possible to send the SAML token twice, as
 * no "OneTimeUse" Element is defined there is no problem with replaying it.
 * with a OneTimeUse Element
 */
@Test public void testEhCacheReplayedSAML2() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setConfirmationMethod(SAML2Constants.CONF_BEARER);
  ConditionsBean conditions=new ConditionsBean();
  conditions.setTokenPeriodMinutes(5);
  callbackHandler.setConditions(conditions);
  SAMLCallback samlCallback=new SAMLCallback();
  SAMLUtil.doSAMLCallback(callbackHandler,samlCallback);
  SamlAssertionWrapper samlAssertion=new SamlAssertionWrapper(samlCallback);
  WSSecSAMLToken wsSign=new WSSecSAMLToken();
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document unsignedDoc=wsSign.build(doc,samlAssertion,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(unsignedDoc);
    LOG.debug(outputString);
  }
  WSSConfig wssConfig=WSSConfig.getNewInstance();
  SamlAssertionValidator assertionValidator=new SamlAssertionValidator();
  assertionValidator.setRequireBearerSignature(false);
  wssConfig.setValidator(WSConstants.SAML_TOKEN,assertionValidator);
  wssConfig.setValidator(WSConstants.SAML2_TOKEN,assertionValidator);
  RequestData data=new RequestData();
  data.setWssConfig(wssConfig);
  data.setCallbackHandler(callbackHandler);
  verify(unsignedDoc,wssConfig,data);
  verify(unsignedDoc,wssConfig,data);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.SKISignatureTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a WS-Security envelope using SubjectKeyIdentifier.
 * This test uses the SubjectKeyIdentifier to identify the certificate.
 * It gets a certificate with a DSA public key algo to sign, WSSignEnvelope shall
 * detect the algo and set the signature algo accordingly.
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testX509SignatureDSA_Autodetect() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("wss40DSA","security");
  builder.setKeyIdentifierType(WSConstants.SKI_KEY_IDENTIFIER);
  LOG.info("Before SigningDSA_Autodetect....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message with DSA_Autodetect:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After SigningDSA_Autodetect....");
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a WS-Security envelope using SubjectKeyIdentifier.
 * This test uses the SubjectKeyIdentifier to identify the certificate.
 * It gets a certificate with a RSA public key algo to sign, WSSignEnvelope shall
 * detect the algo and set the signature algo accordingly.
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testX509SignatureRSA_Autodetect() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("wss40","security");
  builder.setKeyIdentifierType(WSConstants.SKI_KEY_IDENTIFIER);
  LOG.info("Before SigningRSA_Autodetect....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message with RSA Autodetect:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After SigningRSA_Autodetect....");
  verify(signedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.STRSignatureTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is a test for WSS-96:
 * "Error when making a signature when containing a WSSecTimestamp"
 * A timestamp is added to the document and signed.
 */
@Test public void testWSS96() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("wss40","security");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  SOAPConstants soapConstants=WSSecurityUtil.getSOAPConstants(doc.getDocumentElement());
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSEncryptionPart encP=new WSEncryptionPart(soapConstants.getBodyQName().getLocalPart(),soapConstants.getEnvelopeURI(),"Content");
  builder.getParts().add(encP);
  encP=new WSEncryptionPart("STRTransform",soapConstants.getEnvelopeURI(),"Content");
  builder.getParts().add(encP);
  WSSecTimestamp timestamp=new WSSecTimestamp();
  timestamp.setTimeToLive(600);
  timestamp.build(doc,secHeader);
  builder.getParts().add(new WSEncryptionPart(timestamp.getId()));
  builder.setKeyIdentifierType(WSConstants.BST_DIRECT_REFERENCE);
  LOG.info("Before Signing STR DirectReference....");
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message with STR DirectReference key identifier:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Signing STR DirectReference....");
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a WS-Security envelope.
 * This test uses the IssuerSerial reference key identifier (certificate not included
 * in the message)and reads the certificate from a keystore using IssuerSerialNumber
 * to identify it.
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testX509SignatureISSTR() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("wss40","security");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  SOAPConstants soapConstants=WSSecurityUtil.getSOAPConstants(doc.getDocumentElement());
  WSEncryptionPart encP=new WSEncryptionPart(soapConstants.getBodyQName().getLocalPart(),soapConstants.getEnvelopeURI(),"Content");
  builder.getParts().add(encP);
  encP=new WSEncryptionPart("STRTransform",soapConstants.getEnvelopeURI(),"Content");
  builder.getParts().add(encP);
  builder.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  LOG.info("Before Signing STR IS....");
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message with STR IssuerSerial key identifier:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Signing STR IS....");
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a WS-Security envelope.
 * This test uses the direct reference key identifier (certificate included
 * as a BinarySecurityToken (BST) in the message). The test signs the message
 * body (SOAP Body) and uses the STRTransform to sign the embedded certificate
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testX509SignatureDirectSTR() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("wss40","security");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  SOAPConstants soapConstants=WSSecurityUtil.getSOAPConstants(doc.getDocumentElement());
  WSEncryptionPart encP=new WSEncryptionPart(soapConstants.getBodyQName().getLocalPart(),soapConstants.getEnvelopeURI(),"Content");
  builder.getParts().add(encP);
  encP=new WSEncryptionPart("STRTransform",soapConstants.getEnvelopeURI(),"Content");
  builder.getParts().add(encP);
  builder.setKeyIdentifierType(WSConstants.BST_DIRECT_REFERENCE);
  LOG.info("Before Signing STR DirectReference....");
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message with STR DirectReference key identifier:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Signing STR DirectReference....");
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a WS-Security envelope.
 * This test uses the SubjectKeyIdentifier key identifier (certificate not included
 * in the message) and reads the certificate from a keystore using SKI
 * to identify it.
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testX509SignatureSKISTR() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("wss40","security");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  SOAPConstants soapConstants=WSSecurityUtil.getSOAPConstants(doc.getDocumentElement());
  WSEncryptionPart encP=new WSEncryptionPart(soapConstants.getBodyQName().getLocalPart(),soapConstants.getEnvelopeURI(),"Content");
  builder.getParts().add(encP);
  encP=new WSEncryptionPart("STRTransform",soapConstants.getEnvelopeURI(),"Content");
  builder.getParts().add(encP);
  builder.setKeyIdentifierType(WSConstants.SKI_KEY_IDENTIFIER);
  LOG.info("Before Signing STR SKI....");
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message with STR SKI key identifier:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Signing STR SKI....");
  verify(signedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.SignatureEncryptionTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs a SOAP Body, and then encrypts some data inside the SOAP Body.
 * As the encryption adds a wsu:Id to the encrypted element, this test checks that
 * verification still works ok.
 */
@Test public void testWSS198() throws Exception {
  WSSecEncrypt encrypt=new WSSecEncrypt();
  WSSecSignature sign=new WSSecSignature();
  encrypt.setUserInfo("wss40");
  sign.setUserInfo("wss40","security");
  LOG.info("Before Encryption....");
  Document doc=SOAPUtil.toSOAPPart(SOAPMSG);
  WSEncryptionPart encP=new WSEncryptionPart("add","http://ws.apache.org/counter/counter_port_type","");
  encrypt.getParts().add(encP);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=sign.build(doc,crypto,secHeader);
  Document encryptedSignedDoc=encrypt.build(signedDoc,crypto,secHeader);
  LOG.info("WSS198");
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(encryptedSignedDoc);
    LOG.debug(outputString);
  }
  verify(encryptedSignedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and then encrypts a WS-Security envelope, then performs
 * decryption and verification <p/>
 * @throws ExceptionThrown when there is any problem in signing, encryption,
 * decryption, or verification
 */
@Test public void testSigningEncryption() throws Exception {
  WSSecEncrypt encrypt=new WSSecEncrypt();
  WSSecSignature sign=new WSSecSignature();
  encrypt.setUserInfo("wss40");
  sign.setUserInfo("wss40","security");
  LOG.info("Before Encryption....");
  Document doc=SOAPUtil.toSOAPPart(SOAPMSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=sign.build(doc,crypto,secHeader);
  Document encryptedSignedDoc=encrypt.build(signedDoc,crypto,secHeader);
  LOG.info("After Encryption....");
  verify(encryptedSignedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that first signs, then encrypts a WS-Security envelope.
 * The test uses the IssuerSerial key identifier to get the keys for
 * signature and encryption. Encryption uses 3DES.
 * <p/>
 * @throws Exception Thrown when there is any problem in signing, encryption,
 * decryption, or verification
 */
@Test public void testSigningEncryptionIS3DES() throws Exception {
  WSSecEncrypt encrypt=new WSSecEncrypt();
  encrypt.setUserInfo("wss40");
  encrypt.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  encrypt.setSymmetricEncAlgorithm(WSConstants.TRIPLE_DES);
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("wss40","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  LOG.info("Before Sign/Encryption....");
  Document doc=SOAPUtil.toSOAPPart(SOAPMSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=sign.build(doc,crypto,secHeader);
  Document encryptedSignedDoc=encrypt.build(signedDoc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed and encrypted message with IssuerSerial key identifier (both), 3DES:");
    String outputString=XMLUtils.prettyDocumentToString(encryptedSignedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Sign/Encryption....");
  verify(encryptedSignedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test signature created using an encrypted key
 * SOAP Body is signed and encrypted. In the encryption, The ReferenceList element is
 * put into the Encrypted Key, as a child of the EncryptedKey. Signature is created
 * using the encrypted key.
 */
@Test public void testEncryptedKeySignature() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPMSG);
  LOG.info("Before Sign/Encryption....");
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecEncryptedKey encrKey=new WSSecEncryptedKey();
  encrKey.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  encrKey.setUserInfo("wss40","security");
  encrKey.setSymmetricEncAlgorithm(WSConstants.AES_192);
  encrKey.prepare(doc,crypto);
  WSSecEncrypt encrypt=new WSSecEncrypt();
  encrypt.setEncKeyId(encrKey.getId());
  encrypt.setEphemeralKey(encrKey.getEphemeralKey());
  encrypt.setSymmetricEncAlgorithm(WSConstants.TRIPLE_DES);
  encrypt.setEncryptSymmKey(false);
  encrypt.setEncryptedKeyElement(encrKey.getEncryptedKeyElement());
  WSSecSignature sign=new WSSecSignature();
  sign.setKeyIdentifierType(WSConstants.CUSTOM_SYMM_SIGNING);
  sign.setCustomTokenId(encrKey.getId());
  sign.setSecretKey(encrKey.getEphemeralKey());
  sign.setCustomTokenValueType(WSConstants.WSS_ENC_KEY_VALUE_TYPE);
  sign.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  Document encryptedSignedDoc=encrypt.build(signedDoc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed and encrypted message with IssuerSerial key identifier (both), 3DES:");
    String outputString=XMLUtils.prettyDocumentToString(encryptedSignedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Sign/Encryption....");
  verify(encryptedSignedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEncryptionSigningHandler() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  messageContext.put(WSHandlerConstants.ENC_PROP_REF_ID,"" + crypto.hashCode());
  messageContext.put(WSHandlerConstants.SIG_PROP_REF_ID,"" + crypto.hashCode());
  messageContext.put("" + crypto.hashCode(),crypto);
  reqData.setMsgContext(messageContext);
  reqData.setUsername("wss40");
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> handlerActions=new ArrayList<>();
  HandlerAction action=new HandlerAction(WSConstants.ENCR);
  handlerActions.add(action);
  action=new HandlerAction(WSConstants.SIGN);
  handlerActions.add(action);
  handler.send(doc,reqData,handlerActions,true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  List<Integer> receivingActions=new ArrayList<>();
  receivingActions.add(WSConstants.ENCR);
  receivingActions.add(WSConstants.SIGN);
  messageContext.put(WSHandlerConstants.DEC_PROP_REF_ID,"" + crypto.hashCode());
  messageContext.put(WSHandlerConstants.SIG_VER_PROP_REF_ID,"" + crypto.hashCode());
  handler.receive(receivingActions,reqData);
  WSSecurityEngine newEngine=new WSSecurityEngine();
  newEngine.processSecurityHeader(doc,reqData);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that encrypts and then signs a WS-Security envelope, then performs
 * verification and decryption <p/>
 * @throws ExceptionThrown when there is any problem in signing, encryption,
 * decryption, or verification
 */
@Test public void testEncryptionSigning() throws Exception {
  WSSecEncrypt encrypt=new WSSecEncrypt();
  WSSecSignature sign=new WSSecSignature();
  encrypt.setUserInfo("wss40");
  sign.setUserInfo("wss40","security");
  LOG.info("Before Encryption....");
  Document doc=SOAPUtil.toSOAPPart(SOAPMSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document encryptedDoc=encrypt.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After Encryption....");
    String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
    LOG.debug(outputString);
  }
  Document encryptedSignedDoc=sign.build(encryptedDoc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After Signing....");
    String outputString=XMLUtils.prettyDocumentToString(encryptedSignedDoc);
    LOG.debug(outputString);
  }
  verify(encryptedSignedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSigningEncryptionHandler() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,new KeystoreCallbackHandler());
  messageContext.put(WSHandlerConstants.ENC_PROP_REF_ID,"" + crypto.hashCode());
  messageContext.put(WSHandlerConstants.SIG_PROP_REF_ID,"" + crypto.hashCode());
  messageContext.put("" + crypto.hashCode(),crypto);
  reqData.setMsgContext(messageContext);
  reqData.setUsername("wss40");
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> handlerActions=new ArrayList<>();
  HandlerAction action=new HandlerAction(WSConstants.SIGN);
  handlerActions.add(action);
  action=new HandlerAction(WSConstants.ENCR);
  handlerActions.add(action);
  handler.send(doc,reqData,handlerActions,true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  List<Integer> receivingActions=new ArrayList<>();
  receivingActions.add(WSConstants.SIGN);
  receivingActions.add(WSConstants.ENCR);
  messageContext.put(WSHandlerConstants.DEC_PROP_REF_ID,"" + crypto.hashCode());
  messageContext.put(WSHandlerConstants.SIG_VER_PROP_REF_ID,"" + crypto.hashCode());
  handler.receive(receivingActions,reqData);
  WSSecurityEngine newEngine=new WSSecurityEngine();
  newEngine.processSecurityHeader(doc,reqData);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.SignaturePartsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOptionalSOAPHeaderNotPresent() throws Exception {
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSEncryptionPart encP=new WSEncryptionPart("foobar","urn:foo.bar","");
  encP.setRequired(false);
  sign.getParts().add(encP);
  String soapNamespace=WSSecurityUtil.getSOAPNamespace(doc.getDocumentElement());
  encP=new WSEncryptionPart(WSConstants.ELEM_BODY,soapNamespace,"Content");
  sign.getParts().add(encP);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test signing two SOAP Body elements with the same QName.
 */
@Test public void testMultipleElements() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPMSG_MULTIPLE);
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSEncryptionPart encP=new WSEncryptionPart("testMethod","http://axis/service/security/test6/LogTestService8","");
  sign.getParts().add(encP);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  String outputString=XMLUtils.prettyDocumentToString(signedDoc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOptionalSOAPHeaderPresent() throws Exception {
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  Document doc=SOAPUtil.toSOAPPart(SOAPMSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSEncryptionPart encP=new WSEncryptionPart("foobar","urn:foo.bar","");
  encP.setRequired(false);
  sign.getParts().add(encP);
  String soapNamespace=WSSecurityUtil.getSOAPNamespace(doc.getDocumentElement());
  encP=new WSEncryptionPart(WSConstants.ELEM_BODY,soapNamespace,"Content");
  sign.getParts().add(encP);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.SignatureTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommentInSOAPBody() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  LOG.info("Before Signing....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  Element body=WSSecurityUtil.findBodyElement(signedDoc);
  Node commentNode=signedDoc.createComment("This is a comment");
  body.getFirstChild().appendChild(commentNode);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is a test for WSS-283 - "ClassCastException when signing message with existing
 * WSSE header containing Text as first child":
 * https://issues.apache.org/jira/browse/WSS-283
 */
@Test public void testWSS283() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  builder.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  Element secHeaderElement=secHeader.insertSecurityHeader();
  Node textNode=doc.createTextNode("This is a text node");
  secHeaderElement.appendChild(textNode);
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message with text node:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs (twice) and verifies a WS-Security envelope.
 * The test uses the ThumbprintSHA1 key identifier type.
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testDoubleX509SignatureThumb() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  builder.setKeyIdentifierType(WSConstants.THUMBPRINT_IDENTIFIER);
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  Document signedDoc1=builder.build(signedDoc,crypto,secHeader);
  verify(signedDoc1);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a Timestamp. The Signature element is appended to the security
 * header, and so appears after the Timestamp element.
 */
@Test public void testSignedTimestamp() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecTimestamp timestamp=new WSSecTimestamp();
  timestamp.setTimeToLive(300);
  Document createdDoc=timestamp.build(doc,secHeader);
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  WSEncryptionPart encP=new WSEncryptionPart("Timestamp",WSConstants.WSU_NS,"");
  builder.getParts().add(encP);
  builder.prepare(createdDoc,crypto,secHeader);
  List<javax.xml.crypto.dsig.Reference> referenceList=builder.addReferencesToSign(builder.getParts(),secHeader);
  builder.computeSignature(referenceList,false,null);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After Signing....");
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a WS-Security envelope
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testSignatureInclusivePrefixes() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setAddInclusivePrefixes(true);
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  LOG.info("Before Signing....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After Signing....");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureEncryptTimestampOrder() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("16c73ab6-b892-458f-abf5-2f875f74882e");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"crypto.properties");
  config.put(WSHandlerConstants.ENC_PROP_FILE,"crypto.properties");
  config.put("password","security");
  config.put(WSHandlerConstants.SIGNATURE_PARTS,"{}{" + WSConstants.WSU_NS + "}Timestamp");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.SIGN));
  actions.add(new HandlerAction(WSConstants.ENCR));
  actions.add(new HandlerAction(WSConstants.TS));
  handler.send(doc,reqData,actions,true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message:");
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * The test uses the Issuer Serial key identifier type.
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testX509SignatureDefaultPassword() throws Exception {
  Crypto passwordCrypto=CryptoFactory.getInstance("alice.properties");
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo(passwordCrypto.getDefaultX509Identifier(),null);
  builder.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  LOG.info("Before Signing IS....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,passwordCrypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message with IssuerSerial key identifier:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Signing IS....");
  WSSecurityEngine newEngine=new WSSecurityEngine();
  newEngine.processSecurityHeader(doc,null,null,passwordCrypto);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a Timestamp. The request is then modified so that the
 * Timestamp has a default (WSU) namespace inserted. The signature validation should still
 * pass due to c14n (see WSS-181).
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testValidModifiedSignature() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  LOG.info("Before Signing....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecTimestamp timestamp=new WSSecTimestamp();
  timestamp.setTimeToLive(300);
  Document createdDoc=timestamp.build(doc,secHeader);
  WSEncryptionPart encP=new WSEncryptionPart("Timestamp",WSConstants.WSU_NS,"");
  builder.getParts().add(encP);
  Document signedDoc=builder.build(createdDoc,crypto,secHeader);
  Element secHeaderElement=secHeader.getSecurityHeader();
  Node timestampNode=secHeaderElement.getElementsByTagNameNS(WSConstants.WSU_NS,"Timestamp").item(0);
  ((Element)timestampNode).setAttributeNS(WSConstants.XMLNS_NS,"xmlns",WSConstants.WSU_NS);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After Signing....");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a WS-Security envelope
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testIssuerSerialSignature() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  LOG.info("Before Signing....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After Signing....");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is a test for WSS-234 -
 * "When a document contains a comment as its first child element,
 * wss4j will not find the SOAP body."
 */
@Test public void testWSS234() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  LOG.info("Before Signing....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  Node firstChild=signedDoc.getFirstChild();
  Node newNode=signedDoc.removeChild(firstChild);
  Node commentNode=signedDoc.createComment("This is a comment");
  signedDoc.appendChild(commentNode);
  signedDoc.appendChild(newNode);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After Signing....");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Create a signature that uses a custom SecurityTokenReference.
 */
@Test public void testCustomSTR() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  builder.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  LOG.info("Before Signing IS....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  SecurityTokenReference secRef=new SecurityTokenReference(doc);
  Reference ref=new Reference(doc);
  ref.setURI("custom-uri");
  secRef.setReference(ref);
  builder.setSecurityTokenReference(secRef);
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs and verifies a WS-Security envelope
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testBSTPKIPathSignature() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("wss40","security");
  builder.setKeyIdentifierType(WSConstants.BST_DIRECT_REFERENCE);
  builder.setUseSingleCertificate(false);
  LOG.info("Before Signing....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Crypto pkiCrypto=CryptoFactory.getInstance("wss40.properties");
  Document signedDoc=builder.build(doc,pkiCrypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("After PKI Signing....");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  secEngine.processSecurityHeader(doc,null,callbackHandler,pkiCrypto,null);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Sign using a different digest algorithm (SHA-256).
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testX509SignatureSha256() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  builder.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  builder.setSignatureAlgorithm("http://www.w3.org/2001/04/xmldsig-more#rsa-sha256");
  builder.setDigestAlgo("http://www.w3.org/2001/04/xmlenc#sha256");
  LOG.info("Before Signing IS....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message with IssuerSerial key identifier:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Signing IS....");
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that signs (twice) and verifies a WS-Security envelope.
 * <p/>
 * @throws java.lang.Exception Thrown when there is any problem in signing or verification
 */
@Test public void testDoubleX509SignatureIS() throws Exception {
  WSSecSignature builder=new WSSecSignature();
  builder.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,crypto,secHeader);
  Document signedDoc1=builder.build(signedDoc,crypto,secHeader);
  verify(signedDoc1);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEncryptSignatureTimestampOrder() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("16c73ab6-b892-458f-abf5-2f875f74882e");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"crypto.properties");
  config.put(WSHandlerConstants.ENC_PROP_FILE,"crypto.properties");
  config.put("password","security");
  config.put(WSHandlerConstants.SIGNATURE_PARTS,"{}{" + WSConstants.WSU_NS + "}Timestamp");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.ENCR));
  actions.add(new HandlerAction(WSConstants.SIGN));
  actions.add(new HandlerAction(WSConstants.TS));
  handler.send(doc,reqData,actions,true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message:");
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.SymmetricSignatureTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test signing a message body using a symmetric key with EncryptedKeySHA1.
 * The request is generated using WSHandler, instead of coding it.
 */
@Test public void testSymmetricSignatureSHA1Handler() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.SIG_KEY_ID,"EncryptedKeySHA1");
  messageContext.put(WSHandlerConstants.SIG_ALGO,SignatureMethod.HMAC_SHA1);
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,this);
  reqData.setMsgContext(messageContext);
  reqData.setUsername("");
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.SIGN);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug(outputString);
  }
  reqData=new RequestData();
  reqData.setWssConfig(WSSConfig.getNewInstance());
  messageContext=new java.util.TreeMap<String,Object>();
  messageContext.put(WSHandlerConstants.PW_CALLBACK_REF,this);
  reqData.setMsgContext(messageContext);
  reqData.setUsername("");
  handler.receive(Collections.singletonList(WSConstants.SIGN),reqData);
  secEngine.processSecurityHeader(doc,null,this,null,crypto);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that first signs, then encrypts a WS-Security envelope.
 * <p/>
 * @throws Exception Thrown when there is any problem in signing, encryption,
 * decryption, or verification
 */
@Test public void testEncryptedKeySignature() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  LOG.info("Before Sign/Encryption....");
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecEncryptedKey encrKey=new WSSecEncryptedKey();
  encrKey.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  encrKey.setUserInfo("wss40","security");
  encrKey.setSymmetricEncAlgorithm(WSConstants.AES_192);
  encrKey.prepare(doc,crypto);
  WSSecEncrypt encrypt=new WSSecEncrypt();
  encrypt.setEncKeyId(encrKey.getId());
  encrypt.setEphemeralKey(encrKey.getEphemeralKey());
  encrypt.setSymmetricEncAlgorithm(WSConstants.TRIPLE_DES);
  encrypt.setEncryptSymmKey(false);
  encrypt.setEncryptedKeyElement(encrKey.getEncryptedKeyElement());
  WSSecSignature sign=new WSSecSignature();
  sign.setKeyIdentifierType(WSConstants.CUSTOM_SYMM_SIGNING);
  sign.setCustomTokenId(encrKey.getId());
  sign.setCustomTokenValueType(WSConstants.WSS_ENC_KEY_VALUE_TYPE);
  sign.setSecretKey(encrKey.getEphemeralKey());
  sign.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  Document encryptedSignedDoc=encrypt.build(signedDoc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed and encrypted message with IssuerSerial key identifier (both), 3DES:");
    String outputString=XMLUtils.prettyDocumentToString(encryptedSignedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After Sign/Encryption....");
  verify(encryptedSignedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test signing a message body using a symmetric key with EncryptedKeySHA1
 */
@Test public void testSymmetricSignatureSHA1() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecSignature sign=new WSSecSignature();
  sign.setKeyIdentifierType(WSConstants.ENCRYPTED_KEY_SHA1_IDENTIFIER);
  sign.setSecretKey(keyData);
  sign.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  byte[] encodedBytes=KeyUtils.generateDigest(keyData);
  String identifier=Base64.encode(encodedBytes);
  secretKeyCallbackHandler.addSecretKey(identifier,keyData);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed symmetric message SHA1:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  secEngine.processSecurityHeader(doc,null,secretKeyCallbackHandler,null,crypto);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test signing a message body using a symmetric key with Direct Reference to an
 * EncryptedKey
 */
@Test public void testSymmetricSignatureDR() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  WSSecEncryptedKey encrKey=new WSSecEncryptedKey();
  encrKey.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  encrKey.setUserInfo("wss40","security");
  encrKey.setSymmetricEncAlgorithm(WSConstants.AES_192);
  encrKey.prepare(doc,crypto);
  WSSecSignature sign=new WSSecSignature();
  sign.setKeyIdentifierType(WSConstants.CUSTOM_SYMM_SIGNING);
  sign.setCustomTokenId(encrKey.getId());
  sign.setSecretKey(encrKey.getEphemeralKey());
  sign.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  sign.setCustomTokenValueType(WSConstants.WSS_ENC_KEY_VALUE_TYPE);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  encrKey.prependToHeader(secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed symmetric message DR:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.UsernameTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that adds a UserNameToken with no password via WSHandler
 */
@Test public void testUsernameTokenWSHandlerNoPassword() throws Exception {
  CustomHandler handler=new CustomHandler();
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  RequestData reqData=new RequestData();
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.PASSWORD_TYPE,WSConstants.PW_NONE);
  reqData.setUsername("wernerd");
  reqData.setMsgContext(config);
  HandlerAction action=new HandlerAction(WSConstants.UT);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Username Token via WSHandler");
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test with a non-standard password type. This will pass as the WSSConfig is configured to
 * handle custom token types.
 */
@Test public void testUsernameTokenCustomPass() throws Exception {
  WSSecUsernameToken builder=new WSSecUsernameToken();
  builder.setPasswordType("RandomType");
  builder.setUserInfo("wernerd","verySecret");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Message with UserNameToken PW custom type:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  WSSecurityEngine secEngine=new WSSecurityEngine();
  RequestData requestData=new RequestData();
  requestData.setHandleCustomPasswordTypes(true);
  requestData.setCallbackHandler(callbackHandler);
  secEngine.processSecurityHeader(doc,requestData);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that adds a UserNameToken with an empty password
 */
@Test public void testUsernameTokenEmptyPassword() throws Exception {
  WSSecUsernameToken builder=new WSSecUsernameToken();
  builder.setPasswordType(WSConstants.PASSWORD_TEXT);
  builder.setUserInfo("emptyuser","");
  LOG.info("Before adding UsernameToken with an empty password....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  WSSecurityEngine secEngine=new WSSecurityEngine();
  secEngine.processSecurityHeader(doc,null,this,null);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that adds a UserNameToken with password Digest to a WS-Security envelope
 */
@Test public void testUsernameTokenWithEncodedPassword() throws Exception {
  WSSecUsernameToken builder=new WSSecUsernameToken();
  builder.setPasswordsAreEncoded(true);
  builder.setUserInfo("wernerd",Base64.encode(MessageDigest.getInstance("SHA-1").digest("verySecret".getBytes(StandardCharsets.UTF_8))));
  LOG.info("Before adding UsernameToken PW Digest....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Message with UserNameToken PW Digest:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  LOG.info("After adding UsernameToken PW Digest....");
  WSSecurityEngine newEngine=new WSSecurityEngine();
  RequestData requestData=new RequestData();
  requestData.setEncodePasswords(true);
  requestData.setCallbackHandler(new EncodedPasswordCallbackHandler());
  newEngine.processSecurityHeader(signedDoc,requestData);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that processes a UserNameToken with an empty password
 */
@Test public void testEmptyPasswordProcessing() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(EMPTY_PASSWORD_MSG);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Empty password message: ");
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  WSSecurityEngine secEngine=new WSSecurityEngine();
  secEngine.processSecurityHeader(doc,null,this,null);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that adds a UserNameToken with an empty password via WSHandler
 */
@Test public void testUsernameTokenWSHandlerEmptyPassword() throws Exception {
  CustomHandler handler=new CustomHandler();
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  RequestData reqData=new RequestData();
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.PASSWORD_TYPE,WSConstants.PW_TEXT);
  config.put(WSHandlerConstants.PW_CALLBACK_REF,this);
  reqData.setUsername("emptyuser");
  reqData.setMsgContext(config);
  HandlerAction action=new HandlerAction(WSConstants.UT);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Username Token with an empty password via WSHandler");
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that adds a UserNameToken with a digested password but with type of
 * password test.
 */
@Test public void testUsernameTokenDigestText() throws Exception {
  WSSecUsernameToken builder=new WSSecUsernameToken();
  builder.setPasswordType(WSConstants.PASSWORD_TEXT);
  byte[] password="verySecret".getBytes();
  MessageDigest sha=MessageDigest.getInstance("MD5");
  sha.reset();
  sha.update(password);
  String passwdDigest=Base64.encode(sha.digest());
  builder.setUserInfo("wernerd",passwdDigest);
  LOG.info("Before adding UsernameToken PW Text....");
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=builder.build(doc,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Message with UserNameToken PW Text:");
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that adds a UserNameToken via WSHandler
 */
@Test public void testUsernameTokenWSHandler() throws Exception {
  CustomHandler handler=new CustomHandler();
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  RequestData reqData=new RequestData();
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put("password","verySecret");
  config.put(WSHandlerConstants.PASSWORD_TYPE,WSConstants.PW_TEXT);
  reqData.setUsername("wernerd");
  reqData.setMsgContext(config);
  HandlerAction action=new HandlerAction(WSConstants.UT);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Username Token via WSHandler");
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUsernameTokenWSHandlerNonceCreated() throws Exception {
  CustomHandler handler=new CustomHandler();
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  RequestData reqData=new RequestData();
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put("password","verySecret");
  config.put(WSHandlerConstants.PASSWORD_TYPE,WSConstants.PW_TEXT);
  config.put(WSHandlerConstants.ADD_USERNAMETOKEN_NONCE,"true");
  config.put(WSHandlerConstants.ADD_USERNAMETOKEN_CREATED,"true");
  reqData.setUsername("wernerd");
  reqData.setMsgContext(config);
  HandlerAction action=new HandlerAction(WSConstants.UT);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Username Token via WSHandler");
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.token.BSTKerberosTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A test for signing using a KeyIdentifier to a Kerberos token
 */
@Test public void testKerberosSignatureKICreation() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  BinarySecurity bst=new BinarySecurity(doc);
  bst.setValueType(AP_REQ);
  bst.setEncodingType(BASE64_NS);
  KeyGenerator keyGen=KeyGenerator.getInstance("AES");
  keyGen.init(128);
  SecretKey key=keyGen.generateKey();
  byte[] keyData=key.getEncoded();
  bst.setToken(keyData);
  bst.setID("Id-" + bst.hashCode());
  WSSecurityUtil.prependChildElement(secHeader.getSecurityHeader(),bst.getElement());
  WSSecSignature sign=new WSSecSignature();
  sign.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  sign.setKeyIdentifierType(WSConstants.CUSTOM_KEY_IDENTIFIER);
  sign.setCustomTokenValueType(WSConstants.WSS_KRB_KI_VALUE_TYPE);
  byte[] digestBytes=KeyUtils.generateDigest(keyData);
  sign.setCustomTokenId(Base64.encode(digestBytes));
  sign.setSecretKey(keyData);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A test for encryption using a direct reference to a Kerberos token
 */
@Test public void testKerberosEncryptionDRCreation() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  BinarySecurity bst=new BinarySecurity(doc);
  bst.setValueType(AP_REQ);
  bst.setEncodingType(BASE64_NS);
  KeyGenerator keyGen=KeyGenerator.getInstance("AES");
  keyGen.init(128);
  SecretKey key=keyGen.generateKey();
  byte[] keyData=key.getEncoded();
  bst.setToken(keyData);
  bst.setID("Id-" + bst.hashCode());
  WSSecurityUtil.prependChildElement(secHeader.getSecurityHeader(),bst.getElement());
  WSSecEncrypt builder=new WSSecEncrypt();
  builder.setSymmetricEncAlgorithm(WSConstants.AES_128);
  builder.setSymmetricKey(key);
  builder.setEncryptSymmKey(false);
  builder.setCustomReferenceValue(AP_REQ);
  builder.setEncKeyId(bst.getID());
  Document encryptedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A test for encryption using a Key Identifier to a Kerberos token
 */
@Test public void testKerberosEncryptionKICreation() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  BinarySecurity bst=new BinarySecurity(doc);
  bst.setValueType(AP_REQ);
  bst.setEncodingType(BASE64_NS);
  KeyGenerator keyGen=KeyGenerator.getInstance("AES");
  keyGen.init(128);
  SecretKey key=keyGen.generateKey();
  byte[] keyData=key.getEncoded();
  bst.setToken(keyData);
  bst.setID("Id-" + bst.hashCode());
  WSSecurityUtil.prependChildElement(secHeader.getSecurityHeader(),bst.getElement());
  WSSecEncrypt builder=new WSSecEncrypt();
  builder.setSymmetricEncAlgorithm(WSConstants.AES_128);
  builder.setSymmetricKey(key);
  builder.setEncryptSymmKey(false);
  builder.setCustomReferenceValue(WSConstants.WSS_KRB_KI_VALUE_TYPE);
  byte[] digestBytes=KeyUtils.generateDigest(keyData);
  builder.setEncKeyId(Base64.encode(digestBytes));
  Document encryptedDoc=builder.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(encryptedDoc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A test for signing using a direct reference to a Kerberos token
 */
@Test public void testKerberosSignatureDRCreation() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  BinarySecurity bst=new BinarySecurity(doc);
  bst.setValueType(AP_REQ);
  bst.setEncodingType(BASE64_NS);
  KeyGenerator keyGen=KeyGenerator.getInstance("AES");
  keyGen.init(128);
  SecretKey key=keyGen.generateKey();
  byte[] keyData=key.getEncoded();
  bst.setToken(keyData);
  bst.setID("Id-" + bst.hashCode());
  WSSecurityUtil.prependChildElement(secHeader.getSecurityHeader(),bst.getElement());
  WSSecSignature sign=new WSSecSignature();
  sign.setSignatureAlgorithm(SignatureMethod.HMAC_SHA1);
  sign.setKeyIdentifierType(WSConstants.CUSTOM_SYMM_SIGNING);
  sign.setCustomTokenValueType(AP_REQ);
  sign.setCustomTokenId(bst.getID());
  sign.setSecretKey(keyData);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A test for signing a Kerberos BST
 */
@Test public void testSignBST() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  BinarySecurity bst=new BinarySecurity(doc);
  bst.setValueType(AP_REQ);
  bst.setEncodingType(BASE64_NS);
  bst.setToken("12345678".getBytes());
  bst.setID("Id-" + bst.hashCode());
  WSSecurityUtil.prependChildElement(secHeader.getSecurityHeader(),bst.getElement());
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  WSEncryptionPart encP=new WSEncryptionPart(bst.getID());
  sign.getParts().add(encP);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A test for signing a Kerberos BST as well as a Timestamp
 */
@Test public void testSignBSTTimestamp() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  BinarySecurity bst=new BinarySecurity(doc);
  bst.setValueType(AP_REQ);
  bst.setEncodingType(BASE64_NS);
  bst.setToken("12345678".getBytes());
  bst.setID("Id-" + bst.hashCode());
  WSSecurityUtil.prependChildElement(secHeader.getSecurityHeader(),bst.getElement());
  WSSecTimestamp timestamp=new WSSecTimestamp();
  timestamp.setTimeToLive(600);
  timestamp.build(doc,secHeader);
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  sign.getParts().add(new WSEncryptionPart(bst.getID()));
  sign.getParts().add(new WSEncryptionPart(timestamp.getId()));
  Document signedDoc=sign.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(signedDoc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.token.SecurityTokenReferenceTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for a SecurityTokenReference having a Key Identifier with no EncodingType, but
 * it should pass as the ValueType is for a SAML Assertion.
 */
@Test public void testKeyIdentifierSAMLNoEncodingType() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  SecurityTokenReference str=new SecurityTokenReference(doc);
  str.addWSSENamespace();
  Element strElement=str.getElement();
  Element keyId=doc.createElementNS(WSConstants.WSSE_NS,"wsse:KeyIdentifier");
  keyId.setAttributeNS(null,"ValueType",WSConstants.WSS_SAML_KI_VALUE_TYPE);
  keyId.appendChild(doc.createTextNode("#123"));
  strElement.appendChild(keyId);
  if (LOG.isDebugEnabled()) {
    LOG.debug(str.toString());
  }
  BSPEnforcer bspEnforcer=new BSPEnforcer();
  new SecurityTokenReference(strElement,bspEnforcer);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.message.token.WCFUsernameTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that adds a UserNameToken with a namespace qualified type. This should pass
 * as WSS4J has been configured to accept these tokens.
 */
@Test public void testNamespaceQualifiedTypeAccepted() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUTMSG);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Message with UserNameToken PW Digest:");
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  RequestData requestData=new RequestData();
  requestData.setAllowNamespaceQualifiedPasswordTypes(true);
  requestData.setWssConfig(WSSConfig.getNewInstance());
  requestData.setIgnoredBSPRules(Collections.singletonList(BSPRule.R4201));
  verify(doc,requestData);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.misc.SecurityHeaderTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for processing multiple security headers with different actors
 */
@Test public void testTwoActors() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(TWO_ACTOR_MSG);
  secEngine.processSecurityHeader(doc,null,null,null);
  secEngine.processSecurityHeader(doc,"user",null,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.processor.EncryptedKeyDataRefTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that check for correct WSDataRef object from EncryptedKey Processor
 * @throws ExceptionThrown when there is an error in encryption or decryption
 */
@Test public void testDataRefEncryptedKeyProcessor() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecEncrypt builder=new WSSecEncrypt();
  builder.setUserInfo("wss40");
  builder.setKeyIdentifierType(WSConstants.BST_DIRECT_REFERENCE);
  builder.setSymmetricEncAlgorithm(WSConstants.TRIPLE_DES);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  LOG.info("Before Encryption Triple DES....");
  builder.prepare(doc,crypto);
  WSEncryptionPart encP=new WSEncryptionPart("add","http://ws.apache.org/counter/counter_port_type","Element");
  builder.getParts().add(encP);
  Element refs=builder.encrypt();
  builder.addInternalRefElement(refs);
  builder.prependToHeader(secHeader);
  builder.prependBSTElementToHeader(secHeader);
  Document encryptedDoc=doc;
  LOG.info("After Encryption Triple DES....");
  checkDataRef(encryptedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.processor.ReferenceListDataRefTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that check for correct WSDataRef object from ReferenceList Processor
 * @throws ExceptionThrown when there is an error in encryption or decryption
 */
@Test public void testDataRefReferenceListProcessor() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecEncrypt builder=new WSSecEncrypt();
  builder.setUserInfo("wss40");
  builder.setKeyIdentifierType(WSConstants.BST_DIRECT_REFERENCE);
  builder.setSymmetricEncAlgorithm(WSConstants.TRIPLE_DES);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  LOG.info("Before Encryption Triple DES....");
  builder.prepare(doc,crypto);
  WSEncryptionPart encP=new WSEncryptionPart("add","http://ws.apache.org/counter/counter_port_type","Element");
  builder.getParts().add(encP);
  Element refs=builder.encrypt();
  builder.addExternalRefElement(refs,secHeader);
  builder.prependToHeader(secHeader);
  builder.prependBSTElementToHeader(secHeader);
  Document encryptedDoc=doc;
  LOG.info("After Encryption Triple DES....");
  checkDataRef(encryptedDoc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.saml.SamlAuthnTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2InalidSubjectLocality() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSubjectLocality("xyz.ws.apache.org","xyz.ws.apache.org");
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2FutureAuthnInstant() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setAuthenticationInstant(new DateTime().plusMinutes(70));
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2AuthnAssertion() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  createAndVerifyMessage(callbackHandler,true);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2ValidSubjectLocality() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSubjectLocality("127.0.0.1","xyz.ws.apache.org");
  createAndVerifyMessage(callbackHandler,true);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2StaleSessionNotOnOrAfter() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSessionNotOnOrAfter(new DateTime().minusMinutes(70));
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML1FutureAuthnInstant() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setAuthenticationInstant(new DateTime().plusMinutes(70));
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML1AuthnAssertion() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  createAndVerifyMessage(callbackHandler,true);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML1InvalidSubjectLocality() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSubjectLocality("xyz.ws.apache.org","xyz.ws.apache.org");
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML1ValidSubjectLocality() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSubjectLocality("127.0.0.1","xyz.ws.apache.org");
  createAndVerifyMessage(callbackHandler,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.saml.SamlConditionsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that creates, sends and processes an unsigned SAML 1.1 authentication assertion
 * with a custom Conditions statement.
 */
@Test public void testSAML1Conditions() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  ConditionsBean conditions=new ConditionsBean();
  DateTime notBefore=new DateTime();
  conditions.setNotBefore(notBefore);
  conditions.setNotAfter(notBefore.plusMinutes(20));
  callbackHandler.setConditions(conditions);
  createAndVerifyMessage(callbackHandler,true);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2FutureNotBefore() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  ConditionsBean conditions=new ConditionsBean();
  DateTime notBefore=new DateTime();
  conditions.setNotAfter(new DateTime().plusMinutes(70));
  conditions.setNotBefore(notBefore.plusMinutes(60));
  callbackHandler.setConditions(conditions);
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that creates, sends and processes an unsigned SAML 2 authentication assertion
 * with a Conditions statement that has a NotBefore "in the future".
 */
@Test public void testSAML2FutureTTLConditions() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  ConditionsBean conditions=new ConditionsBean();
  DateTime notBefore=new DateTime();
  conditions.setNotBefore(notBefore.plusSeconds(30));
  conditions.setNotAfter(notBefore.plusMinutes(5));
  callbackHandler.setConditions(conditions);
  createAndVerifyMessage(callbackHandler,true);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2Delegate() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  ConditionsBean conditions=new ConditionsBean();
  DateTime notBefore=new DateTime();
  conditions.setNotBefore(notBefore);
  conditions.setNotAfter(notBefore.plusMinutes(20));
  DelegateBean delegate=new DelegateBean();
  delegate.setDelegationInstant(DateTime.now());
  delegate.setConfirmationMethod(SAML2Constants.CONF_BEARER);
  NameIDBean nameID=new NameIDBean();
  nameID.setNameValue("bob");
  nameID.setNameQualifier("www.example.com");
  delegate.setNameIDBean(nameID);
  conditions.setDelegates(Collections.singletonList(delegate));
  callbackHandler.setConditions(conditions);
  createAndVerifyMessage(callbackHandler,true);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that creates, sends and processes an unsigned SAML 2 authentication assertion
 * with an (invalid) custom Conditions statement.
 */
@Test public void testSAML2InvalidBeforeConditions() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  ConditionsBean conditions=new ConditionsBean();
  DateTime notBefore=new DateTime();
  conditions.setNotBefore(notBefore.plusMinutes(2));
  conditions.setNotAfter(notBefore.plusMinutes(5));
  callbackHandler.setConditions(conditions);
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2StaleIssueInstantButWithNotOnOrAfter() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  SAMLCallback samlCallback=new SAMLCallback();
  SAMLUtil.doSAMLCallback(callbackHandler,samlCallback);
  SamlAssertionWrapper samlAssertion=new SamlAssertionWrapper(samlCallback);
  ConditionsBean conditions=new ConditionsBean();
  conditions.setNotBefore(new DateTime());
  conditions.setNotAfter(new DateTime().plusMinutes(35));
  DateTime issueInstant=new DateTime();
  issueInstant=issueInstant.minusMinutes(31);
  samlAssertion.getSaml2().setIssueInstant(issueInstant);
  WSSecSAMLToken wsSign=new WSSecSAMLToken();
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document unsignedDoc=wsSign.build(doc,samlAssertion,secHeader);
  if (LOG.isDebugEnabled()) {
    LOG.debug("SAML 2 Authn Assertion (sender vouches):");
    String outputString=XMLUtils.prettyDocumentToString(unsignedDoc);
    LOG.debug(outputString);
  }
  verify(unsignedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2StaleNotOnOrAfter() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  ConditionsBean conditions=new ConditionsBean();
  DateTime notBefore=new DateTime();
  conditions.setNotAfter(notBefore.minusMinutes(60));
  conditions.setNotBefore(notBefore.minusMinutes(70));
  callbackHandler.setConditions(conditions);
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that creates, sends and processes an unsigned SAML 2 authentication assertion
 * with an (invalid) custom Conditions statement.
 */
@Test public void testSAML2InvalidAfterConditions() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example.com");
  ConditionsBean conditions=new ConditionsBean();
  DateTime notBefore=new DateTime();
  conditions.setNotBefore(notBefore.minusMinutes(5));
  conditions.setNotAfter(notBefore.minusMinutes(3));
  callbackHandler.setConditions(conditions);
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.saml.SamlTokenActionTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAssertionAction() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("wss40");
  CallbackHandler callbackHandler=new KeystoreCallbackHandler();
  SAML1CallbackHandler samlCallbackHandler=new SAML1CallbackHandler();
  samlCallbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  samlCallbackHandler.setIssuer("www.example.com");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,callbackHandler);
  config.put(WSHandlerConstants.SAML_CALLBACK_REF,samlCallbackHandler);
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.ST_UNSIGNED);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc,callbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignedAssertionAction() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  CallbackHandler callbackHandler=new KeystoreCallbackHandler();
  SAML1CallbackHandler samlCallbackHandler=new SAML1CallbackHandler();
  samlCallbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  samlCallbackHandler.setIssuer("www.example.com");
  samlCallbackHandler.setIssuerCrypto(crypto);
  samlCallbackHandler.setIssuerName("wss40");
  samlCallbackHandler.setIssuerPassword("security");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.PW_CALLBACK_REF,callbackHandler);
  config.put(WSHandlerConstants.SAML_CALLBACK_REF,samlCallbackHandler);
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  HandlerAction action=new HandlerAction(WSConstants.ST_SIGNED);
  handler.send(doc,reqData,Collections.singletonList(action),true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc,callbackHandler);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAssertionWithSignatureAction() throws Exception {
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("wss40");
  CallbackHandler callbackHandler=new KeystoreCallbackHandler();
  SAML1CallbackHandler samlCallbackHandler=new SAML1CallbackHandler();
  samlCallbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  samlCallbackHandler.setIssuer("www.example.com");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"wss40.properties");
  config.put(WSHandlerConstants.PW_CALLBACK_REF,callbackHandler);
  config.put(WSHandlerConstants.SAML_CALLBACK_REF,samlCallbackHandler);
  config.put(WSHandlerConstants.SIGNATURE_PARTS,"{}{" + WSConstants.SAML_NS + "}Assertion;");
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  actions.add(new HandlerAction(WSConstants.ST_UNSIGNED));
  actions.add(new HandlerAction(WSConstants.SIGN));
  handler.send(doc,reqData,actions,true);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(doc,callbackHandler);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.saml.SamlTokenCustomSignatureTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddSAML1AndSign() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML1Constants.CONF_SENDER_VOUCHES);
  callbackHandler.setIssuer("www.example.com");
  SAMLCallback samlCallback=new SAMLCallback();
  SAMLUtil.doSAMLCallback(callbackHandler,samlCallback);
  SamlAssertionWrapper samlAssertion=new SamlAssertionWrapper(samlCallback);
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  Element assertionElement=samlAssertion.toDOM(doc);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  secHeader.getSecurityHeader().appendChild(assertionElement);
  WSSecSignature sign=new WSSecSignature();
  sign.setUserInfo("16c73ab6-b892-458f-abf5-2f875f74882e","security");
  sign.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);
  WSEncryptionPart encP=new WSEncryptionPart("Assertion","urn:oasis:names:tc:SAML:1.0:assertion","Element");
  encP.setRequired(false);
  sign.getParts().add(encP);
  Document signedDoc=sign.build(doc,crypto,secHeader);
  if (LOG.isDebugEnabled()) {
    String outputString=XMLUtils.prettyDocumentToString(doc);
    LOG.debug(outputString);
  }
  verify(signedDoc);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddSAML1AndSignAction() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML1Constants.CONF_SENDER_VOUCHES);
  callbackHandler.setIssuer("www.example.com");
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  reqData.setUsername("16c73ab6-b892-458f-abf5-2f875f74882e");
  java.util.Map<String,Object> config=new java.util.TreeMap<String,Object>();
  config.put(WSHandlerConstants.SIG_PROP_FILE,"crypto.properties");
  config.put("password","security");
  config.put(WSHandlerConstants.SIG_KEY_ID,"DirectReference");
  config.put(WSHandlerConstants.SIGNATURE_PARTS,"{Element}{urn:oasis:names:tc:SAML:1.0:assertion}Assertion");
  config.put(WSHandlerConstants.SAML_CALLBACK_REF,callbackHandler);
  reqData.setMsgContext(config);
  final Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  CustomHandler handler=new CustomHandler();
  List<HandlerAction> actions=new ArrayList<>();
  HandlerAction action=new HandlerAction(WSConstants.ST_UNSIGNED);
  actions.add(action);
  action=new HandlerAction(WSConstants.SIGN);
  actions.add(action);
  handler.send(doc,reqData,actions,true);
  String outputString=XMLUtils.prettyDocumentToString(doc);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Signed message:");
    LOG.debug(outputString);
  }
  verify(doc);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.saml.SamlTokenSVTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * A test for WSS-62: "the crypto file not being retrieved in the doReceiverAction
 * method for the Saml Signed Token"
 * https://issues.apache.org/jira/browse/WSS-62
 */
@Test public void testWSS62() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.ATTR);
  callbackHandler.setConfirmationMethod(SAML2Constants.CONF_SENDER_VOUCHES);
  callbackHandler.setIssuer("www.example.com");
  SAMLCallback samlCallback=new SAMLCallback();
  SAMLUtil.doSAMLCallback(callbackHandler,samlCallback);
  SamlAssertionWrapper samlAssertion=new SamlAssertionWrapper(samlCallback);
  WSSecSignatureSAML wsSign=new WSSecSignatureSAML();
  wsSign.setKeyIdentifierType(WSConstants.BST_DIRECT_REFERENCE);
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  Document signedDoc=wsSign.build(doc,null,samlAssertion,crypto,"16c73ab6-b892-458f-abf5-2f875f74882e","security",secHeader);
  final WSSConfig cfg=WSSConfig.getNewInstance();
  final RequestData reqData=new RequestData();
  reqData.setWssConfig(cfg);
  java.util.Map<String,Object> msgContext=new java.util.HashMap<String,Object>();
  msgContext.put(WSHandlerConstants.SIG_VER_PROP_FILE,"crypto.properties");
  reqData.setMsgContext(msgContext);
  CustomHandler handler=new CustomHandler();
  handler.receive(Collections.singletonList(WSConstants.ST_SIGNED),reqData);
  secEngine.processSecurityHeader(signedDoc,null,callbackHandler,reqData.getSigVerCrypto(),reqData.getDecCrypto());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.dom.saml.SamlTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that creates, sends and processes an unsigned SAML 1.1 authentication assertion.
 * The issuer is different from what the custom Validator is expecting, so it throws an
 * exception.
 */
@Test public void testSAML1AuthnBadIssuerAssertion() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example2.com");
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that creates, sends and processes an unsigned SAML 2 authentication assertion.
 * The issuer is different from what the custom Validator is expecting, so it throws an
 * exception.
 */
@Test public void testSAML2AuthnBadIssuerAssertion() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setIssuer("www.example2.com");
  createAndVerifyMessage(callbackHandler,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.performance.PerformanceMemoryTest </h4><pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="memory-in",dataProvider="xmlsizes",dependsOnMethods={"doBeforeStreamIn","testOutStreamingMemoryPerformance"}) public void testInboundStreamingMemoryPerformance(int run,int tagCount) throws Exception {
  System.out.println("Run " + run);
  long startMem=getUsedMemory();
  ThreadStopper threadStopper=new ThreadStopper();
  Thread thread=new Thread(new MemorySamplerThread(threadStopper,inSamples,startMem));
  thread.setPriority(9);
  thread.start();
  doStreamingInSecurity(new File("target/performanceMemoryTest/stream-" + tagCount + ".xml"));
  threadStopper.setStop(true);
  thread.join();
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="memory-out",dataProvider="xmlsizes",dependsOnMethods={"doBeforeStreamCompressedOut"}) public void testOutStreamingCompressedMemoryPerformance(int run,int tagCount) throws Exception {
  System.out.println("Run " + run);
  File input=genBigFile(run * 40);
  long startMem=getUsedMemory();
  ThreadStopper threadStopper=new ThreadStopper();
  Thread thread=new Thread(new MemorySamplerThread(threadStopper,outSamples,startMem));
  thread.setPriority(9);
  thread.start();
  doStreamingSecurityOutboundCompressed(input,new File("target/performanceMemoryTest/stream-compressed-" + tagCount + ".xml"),"http://www.apache.org/2012/04/xmlsec/gzip");
  threadStopper.setStop(true);
  thread.join();
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="memory-in",dataProvider="xmlsizes",dependsOnMethods={"doBeforeStreamCompressedIn","testOutStreamingCompressedMemoryPerformance"}) public void testInboundStreamingCompressedMemoryPerformance(int run,int tagCount) throws Exception {
  System.out.println("Run " + run);
  long startMem=getUsedMemory();
  ThreadStopper threadStopper=new ThreadStopper();
  Thread thread=new Thread(new MemorySamplerThread(threadStopper,inSamples,startMem));
  thread.setPriority(9);
  thread.start();
  doStreamingInSecurity(new File("target/performanceMemoryTest/stream-compressed-" + tagCount + ".xml"));
  threadStopper.setStop(true);
  thread.join();
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="memory-in",dataProvider="xmlsizes",dependsOnMethods={"doBeforeDOMIn","testOutDOMMemoryPerformance"}) public void testInboundDOMMemoryPerformance(int run,int tagCount) throws Exception {
  System.out.println("Run " + run);
  long startMem=getUsedMemory();
  ThreadStopper threadStopper=new ThreadStopper();
  Thread thread=new Thread(new MemorySamplerThread(threadStopper,inSamples,startMem));
  thread.setPriority(9);
  thread.start();
  doDOMInSecurity(new File("target/performanceMemoryTest/dom-" + tagCount + ".xml"));
  threadStopper.setStop(true);
  thread.join();
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="memory-out",dataProvider="xmlsizes",dependsOnMethods={"doBeforeStreamOut"}) public void testOutStreamingMemoryPerformance(int run,int tagCount) throws Exception {
  System.out.println("Run " + run);
  File input=genBigFile(run * 40);
  long startMem=getUsedMemory();
  ThreadStopper threadStopper=new ThreadStopper();
  Thread thread=new Thread(new MemorySamplerThread(threadStopper,outSamples,startMem));
  thread.setPriority(9);
  thread.start();
  doStreamingSecurityOutbound(input,new File("target/performanceMemoryTest/stream-" + tagCount + ".xml"));
  threadStopper.setStop(true);
  thread.join();
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="memory-out",dataProvider="xmlsizes",dependsOnMethods={"doBeforeDOMOut"}) public void testOutDOMMemoryPerformance(int run,int tagCount) throws Exception {
  System.out.println("Run " + run);
  File input=genBigFile(run * 40);
  long startMem=getUsedMemory();
  ThreadStopper threadStopper=new ThreadStopper();
  Thread thread=new Thread(new MemorySamplerThread(threadStopper,outSamples,startMem));
  thread.setPriority(9);
  thread.start();
  doDOMSecurityOutbound(input,new File("target/performanceMemoryTest/dom-" + tagCount + ".xml"));
  threadStopper.setStop(true);
  thread.join();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.performance.PerformanceTimingTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups={"timing-out"}) public void setUpOut() throws Exception {
  File input=genBigFile(1);
  doDOMSecurityOutbound(input,new File("target/performanceTimingTest/bigfile-dom.xml"));
  doStreamingSecurityOutbound(input,new File("target/performanceTimingTest/bigfile-stream.xml"));
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="timing-in",dataProvider="xmlsizes",dependsOnMethods="setUpIn") public void testInboundTimePerformance(int run,int tagCount) throws Exception {
  System.out.println("Run " + run);
  System.gc();
  System.gc();
  long start=System.currentTimeMillis();
  try {
    inSamples.write("" + tagCount);
    inSamples.write(" ");
    doDOMInSecurity(new File("target/performanceTimingTest/dom-" + tagCount + ".xml"));
    inSamples.write("" + (System.currentTimeMillis() - start) / 1000.0);
  }
 catch (  OutOfMemoryError e) {
    System.gc();
    inSamples.write("" + 0);
  }
  inSamples.write(" ");
  inSamples.flush();
  System.gc();
  System.gc();
  start=System.currentTimeMillis();
  doStreamingInSecurity(new File("target/performanceTimingTest/stream-" + tagCount + ".xml"));
  inSamples.write("" + (System.currentTimeMillis() - start) / 1000.0);
  inSamples.write(" ");
  inSamples.flush();
  System.gc();
  System.gc();
  start=System.currentTimeMillis();
  doStreamingInSecurity(new File("target/performanceTimingTest/stream-compressed-" + tagCount + ".xml"));
  inSamples.write("" + (System.currentTimeMillis() - start) / 1000.0);
  inSamples.write("\n");
  inSamples.flush();
  System.gc();
  System.gc();
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="timing-out",dataProvider="xmlsizes",dependsOnMethods="setUpOut") public void testOutboundTimePerformance(int run,int tagCount) throws Exception {
  System.out.println("Run " + run);
  File input=genBigFile(run * 40);
  System.gc();
  long start=System.currentTimeMillis();
  try {
    outSamples.write("" + tagCount);
    outSamples.write(" ");
    doDOMSecurityOutbound(input,new File("target/performanceTimingTest/dom-" + tagCount + ".xml"));
    outSamples.write("" + (System.currentTimeMillis() - start) / 1000.0);
  }
 catch (  OutOfMemoryError e) {
    System.gc();
    outSamples.write("" + 0);
  }
  outSamples.write(" ");
  outSamples.flush();
  System.gc();
  System.gc();
  start=System.currentTimeMillis();
  doStreamingSecurityOutbound(input,new File("target/performanceTimingTest/stream-" + tagCount + ".xml"));
  outSamples.write("" + (System.currentTimeMillis() - start) / 1000.0);
  outSamples.write(" ");
  outSamples.flush();
  System.gc();
  System.gc();
  start=System.currentTimeMillis();
  doStreamingSecurityOutboundCompressed(input,new File("target/performanceTimingTest/stream-compressed-" + tagCount + ".xml"),"http://www.apache.org/2012/04/xmlsec/gzip");
  outSamples.write("" + (System.currentTimeMillis() - start) / 1000.0);
  outSamples.write("\n");
  outSamples.flush();
  System.gc();
  System.gc();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups={"timing-in"},dependsOnMethods="testOutboundTimePerformance") public void setUpIn() throws Exception {
  File input=genBigFile(1);
  doDOMSecurityOutbound(input,new File("target/performanceTimingTest/bigfile-dom.xml"));
  doStreamingSecurityOutbound(input,new File("target/performanceTimingTest/bigfile-stream.xml"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.AlgorithmSuiteTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlgorithmSuitePolicy() throws Exception {
  String policyString="<sp:AlgorithmSuite xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:TripleDesRsa15/>\n"+ "</wsp:Policy>\n"+ "</sp:AlgorithmSuite>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  AlgorithmSuiteSecurityEvent algorithmSuiteSecurityEvent=new AlgorithmSuiteSecurityEvent();
  algorithmSuiteSecurityEvent.setAlgorithmURI("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  algorithmSuiteSecurityEvent.setKeyLength(192);
  algorithmSuiteSecurityEvent.setAlgorithmUsage(WSSConstants.Enc);
  policyEnforcer.registerSecurityEvent(algorithmSuiteSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlgorithmSuitePolicyAlternatives() throws Exception {
  String policyString="<sp:AlgorithmSuite xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<wsp:ExactlyOne>\n"+ "<sp:Basic256/>\n"+ "<sp:TripleDesRsa15/>\n"+ "</wsp:ExactlyOne>\n"+ "</wsp:Policy>\n"+ "</sp:AlgorithmSuite>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  AlgorithmSuiteSecurityEvent algorithmSuiteSecurityEvent=new AlgorithmSuiteSecurityEvent();
  algorithmSuiteSecurityEvent.setAlgorithmURI("http://www.w3.org/2001/04/xmlenc#tripledes-cbc");
  algorithmSuiteSecurityEvent.setKeyLength(192);
  algorithmSuiteSecurityEvent.setAlgorithmUsage(WSSConstants.Enc);
  policyEnforcer.registerSecurityEvent(algorithmSuiteSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.AsymmetricBindingIntegrationTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncludeTimestampPolicy() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:AsymmetricBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                    <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:WssX509V3Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:AsymmetricBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Expires</sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSU_TIMESTAMP,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_CREATED,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_EXPIRES,SecurePart.Modifier.Content));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,inSecurityProperties));
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTokenScenarioLateEncryption() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:AsymmetricBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                               <sp:SamlToken sp:IncludeToken=\" http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Always\">\n"+ "                                  <sp:IssuerName>www.example.com</sp:IssuerName>\n"+ "                                    <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "                                        <sp:WssSamlV20Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:SamlToken>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:RequireDerivedKeys/>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:AsymmetricBinding>\n"+ "                <sp:SignedSupportingTokens>\n"+ "                   <wsp:Policy>\n"+ "                     <sp:UsernameToken sp:IncludeToken=\" http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                       <wsp:Policy>\n"+ "                       </wsp:Policy>\n"+ "                     </sp:UsernameToken>\n"+ "                   </wsp:Policy>\n"+ "                </sp:SignedSupportingTokens>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Created"+ "                    </sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsdl=\"http://schemas.xmlsoap.org/wsdl/\" "+ "                       xmlns:xsd=\"http://www.w3.org/1999/XMLSchema\">"+ "                       /soap:Envelope/soap:Body/wsdl:definitions/wsdl:types/xsd:schema/xsd:simpleType"+ "                    </sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.USERNAMETOKEN);
  actions.add(WSSConstants.SAML_TOKEN_SIGNED);
  actions.add(WSSConstants.ENCRYPT_WITH_DERIVED_KEY);
  outSecurityProperties.setActions(actions);
  SAMLCallbackHandlerImpl samlCallbackHandler=new SAMLCallbackHandlerImpl();
  samlCallbackHandler.setSamlVersion(Version.SAML_20);
  samlCallbackHandler.setStatement(SAMLCallbackHandlerImpl.Statement.AUTHN);
  samlCallbackHandler.setConfirmationMethod(SAML2Constants.CONF_HOLDER_KEY);
  samlCallbackHandler.setIssuer("www.example.com");
  byte[] secret=WSSConstants.generateBytes(128 / 8);
  CallbackHandlerImpl callbackHandler=new CallbackHandlerImpl();
  callbackHandler.setSecret(secret);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResourceAsStream("transmitter.jks"),"default".toCharArray());
  Merlin crypto=new Merlin();
  crypto.setKeyStore(keyStore);
  CryptoType cryptoType=new CryptoType(CryptoType.TYPE.ALIAS);
  cryptoType.setAlias("transmitter");
  samlCallbackHandler.setCerts(crypto.getX509Certificates(cryptoType));
  outSecurityProperties.setCallbackHandler(callbackHandler);
  outSecurityProperties.setSamlCallbackHandler(samlCallbackHandler);
  outSecurityProperties.setTokenUser("tester");
  outSecurityProperties.setSignatureKeyIdentifier(WSSecurityTokenConstants.KEYIDENTIFIER_EMBEDDED_KEY_IDENTIFIER_REF);
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSSE_USERNAME_TOKEN,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSU_TIMESTAMP,SecurePart.Modifier.Element));
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.addEncryptionPart(new SecurePart(new QName("http://www.w3.org/1999/XMLSchema","simpleType"),SecurePart.Modifier.Element));
  outSecurityProperties.setUsernameTokenPasswordType(UsernameTokenPasswordType.PASSWORD_TEXT);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,inSecurityProperties));
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyReenabledRSA15KeyTransportAlgorithm() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:AsymmetricBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                    <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:WssX509V3Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256Rsa15/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:AsymmetricBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Expires</sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-1_5");
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSU_TIMESTAMP,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_CREATED,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_EXPIRES,SecurePart.Modifier.Content));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,inSecurityProperties));
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTokenScenario() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:AsymmetricBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                               <sp:SamlToken sp:IncludeToken=\" http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Always\">\n"+ "                                  <sp:IssuerName>www.example.com</sp:IssuerName>\n"+ "                                    <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "                                        <sp:WssSamlV20Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:SamlToken>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:RequireDerivedKeys/>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:AsymmetricBinding>\n"+ "                <sp:SignedSupportingTokens>\n"+ "                   <wsp:Policy>\n"+ "                     <sp:UsernameToken sp:IncludeToken=\" http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                       <wsp:Policy>\n"+ "                       </wsp:Policy>\n"+ "                     </sp:UsernameToken>\n"+ "                   </wsp:Policy>\n"+ "                </sp:SignedSupportingTokens>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Created"+ "                    </sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Created"+ "                    </sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Expires"+ "                    </sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.USERNAMETOKEN);
  actions.add(WSSConstants.SAML_TOKEN_SIGNED);
  actions.add(WSSConstants.ENCRYPT_WITH_DERIVED_KEY);
  outSecurityProperties.setActions(actions);
  SAMLCallbackHandlerImpl samlCallbackHandler=new SAMLCallbackHandlerImpl();
  samlCallbackHandler.setSamlVersion(Version.SAML_20);
  samlCallbackHandler.setStatement(SAMLCallbackHandlerImpl.Statement.AUTHN);
  samlCallbackHandler.setConfirmationMethod(SAML2Constants.CONF_HOLDER_KEY);
  samlCallbackHandler.setIssuer("www.example.com");
  byte[] secret=WSSConstants.generateBytes(128 / 8);
  CallbackHandlerImpl callbackHandler=new CallbackHandlerImpl();
  callbackHandler.setSecret(secret);
  KeyStore keyStore=KeyStore.getInstance("jks");
  keyStore.load(this.getClass().getClassLoader().getResourceAsStream("transmitter.jks"),"default".toCharArray());
  Merlin crypto=new Merlin();
  crypto.setKeyStore(keyStore);
  CryptoType cryptoType=new CryptoType(CryptoType.TYPE.ALIAS);
  cryptoType.setAlias("transmitter");
  samlCallbackHandler.setCerts(crypto.getX509Certificates(cryptoType));
  outSecurityProperties.setCallbackHandler(callbackHandler);
  outSecurityProperties.setSamlCallbackHandler(samlCallbackHandler);
  outSecurityProperties.setTokenUser("tester");
  outSecurityProperties.setSignatureKeyIdentifier(WSSecurityTokenConstants.KEYIDENTIFIER_EMBEDDED_KEY_IDENTIFIER_REF);
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSSE_USERNAME_TOKEN,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSU_TIMESTAMP,SecurePart.Modifier.Element));
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_CREATED,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_EXPIRES,SecurePart.Modifier.Content));
  outSecurityProperties.setUsernameTokenPasswordType(UsernameTokenPasswordType.PASSWORD_TEXT);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,inSecurityProperties));
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncludeTimestampPolicy2ndAlternative() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:AsymmetricBinding>\n"+ "                    <wsp:Policy>\n"+ "                       <wsp:ExactlyOne>\n"+ "                       <wsp:All>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                    <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:WssX509V1Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                       </wsp:All>\n"+ "                       <wsp:All>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                    <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:WssX509V3Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                       </wsp:All>\n"+ "                       </wsp:ExactlyOne>\n"+ "                    </wsp:Policy>\n"+ "                </sp:AsymmetricBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Expires</sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSU_TIMESTAMP,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_CREATED,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_EXPIRES,SecurePart.Modifier.Content));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,inSecurityProperties));
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncludeTimestampAndProtectionOrderEncryptBeforeSignAndSignedUsernameSupportingTokenPolicyTest() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:AsymmetricBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                    <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:WssX509V3Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                        <sp:EncryptBeforeSigning/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:AsymmetricBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:SignedSupportingTokens>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:UsernameToken sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                            <wsp:Policy>\n"+ "                                <sp:NoPassword/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:UsernameToken>\n"+ "                    </wsp:Policy>\n"+ "                </sp:SignedSupportingTokens>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.setTokenUser("transmitter");
  outSecurityProperties.setUsernameTokenPasswordType(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE);
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSU_TIMESTAMP,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSSE_USERNAME_TOKEN,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.USERNAMETOKEN);
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.ENCRYPT);
  actions.add(WSSConstants.SIGNATURE);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,inSecurityProperties));
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEntireHeaderAndBodySignature() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:AsymmetricBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                    <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:WssX509V3Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                        <sp:OnlySignEntireHeadersAndBody/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:AsymmetricBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Created"+ "                    </sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Created"+ "                    </sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Expires"+ "                    </sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSU_TIMESTAMP,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(new QName("http://schemas.xmlsoap.org/wsdl/","definitions"),SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_CREATED,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_EXPIRES,SecurePart.Modifier.Content));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,inSecurityProperties));
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureProtectionPolicy() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:AsymmetricBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                    <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:WssX509V3Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                        <sp:EncryptSignature/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:AsymmetricBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Expires</sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSU_TIMESTAMP,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_dsig_Signature,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_CREATED,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_EXPIRES,SecurePart.Modifier.Content));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,inSecurityProperties));
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncludeTimestampAndSignedUsernameSupportingTokenPolicy() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:AsymmetricBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:InitiatorToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                    <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:WssX509V3Token11/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:InitiatorToken>\n"+ "                        <sp:RecipientToken>\n"+ "                            <wsp:Policy>\n"+ "                              <sp:X509Token sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never\">\n"+ "                                  <sp:IssuerName>CN=receiver,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                  <wsp:Policy>\n"+ "                                      <sp:WssX509V3Token11/>\n"+ "                                  </wsp:Policy>\n"+ "                              </sp:X509Token>\n"+ "                            </wsp:Policy>\n"+ "                         </sp:RecipientToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:AsymmetricBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Expires</sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "                <sp:SignedSupportingTokens>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:UsernameToken sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                            <wsp:Policy>\n"+ "                                <sp:NoPassword/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:UsernameToken>\n"+ "                    </wsp:Policy>\n"+ "                </sp:SignedSupportingTokens>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.setTokenUser("transmitter");
  outSecurityProperties.setUsernameTokenPasswordType(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE);
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSU_TIMESTAMP,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_WSSE_USERNAME_TOKEN,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_CREATED,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_WSU_EXPIRES,SecurePart.Modifier.Content));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.USERNAMETOKEN);
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,inSecurityProperties));
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.AsymmetricBindingTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:AsymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "<sp:IncludeTimestamp/>\n"+ "<sp:EncryptSignature/>\n"+ "<sp:OnlySignEntireHeadersAndBody/>\n"+ "</wsp:Policy>\n"+ "</sp:AsymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  TimestampSecurityEvent timestampSecurityEvent=new TimestampSecurityEvent();
  policyEnforcer.registerSecurityEvent(timestampSecurityEvent);
  RequiredElementSecurityEvent requiredElementSecurityEvent=new RequiredElementSecurityEvent();
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_WSU_TIMESTAMP);
  requiredElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(requiredElementSecurityEvent);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  x509TokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  x509TokenSecurityEvent=new X509TokenSecurityEvent();
  securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  x509TokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedElementSecurityEvent encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_dsig_Signature);
  encryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_WSSE11_SIG_CONF);
  encryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOnlySignEntireHeadersAndBodyPolicyNothingSigned() throws Exception {
  String policyString="<sp:AsymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "<sp:OnlySignEntireHeadersAndBody/>\n"+ "</wsp:Policy>\n"+ "</sp:AsymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.ContentEncryptedElementsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:ContentEncryptedElements xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<sp:XPath xmlns:b=\"http://example.org\">/b:a</sp:XPath>\n" + "</sp:ContentEncryptedElements>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent(null,true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.add(new QName("http://example.org","a"));
  contentEncryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.add(new QName("http://example.org","b"));
  contentEncryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.DerivedKeyTests </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDerivedKeySupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireDerivedKeys/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(securityToken);
  DerivedKeyTokenSecurityEvent derivedKeyTokenSecurityEvent=new DerivedKeyTokenSecurityEvent();
  derivedKeyTokenSecurityEvent.setSecurityToken(getX509Token(WSSecurityTokenConstants.DerivedKeyToken));
  securityToken.addWrappedToken((InboundSecurityToken)derivedKeyTokenSecurityEvent.getSecurityToken());
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  x509TokenSecurityEvent=new X509TokenSecurityEvent();
  securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(securityToken);
  derivedKeyTokenSecurityEvent=new DerivedKeyTokenSecurityEvent();
  derivedKeyTokenSecurityEvent.setSecurityToken(getX509Token(WSSecurityTokenConstants.DerivedKeyToken));
  securityToken.addWrappedToken((InboundSecurityToken)derivedKeyTokenSecurityEvent.getSecurityToken());
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDerivedKeySupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireDerivedKeys/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(securityToken);
  DerivedKeyTokenSecurityEvent derivedKeyTokenSecurityEvent=new DerivedKeyTokenSecurityEvent();
  derivedKeyTokenSecurityEvent.setSecurityToken(getX509Token(WSSecurityTokenConstants.DerivedKeyToken));
  securityToken.addWrappedToken((InboundSecurityToken)derivedKeyTokenSecurityEvent.getSecurityToken());
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  x509TokenSecurityEvent=new X509TokenSecurityEvent();
  securityToken=getX509Token(WSSecurityTokenConstants.X509V1Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDerivedKeySupportingTokenPolicy() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireDerivedKeys/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(securityToken);
  DerivedKeyTokenSecurityEvent derivedKeyTokenSecurityEvent=new DerivedKeyTokenSecurityEvent();
  derivedKeyTokenSecurityEvent.setSecurityToken(getX509Token(WSSecurityTokenConstants.DerivedKeyToken));
  securityToken.addWrappedToken((InboundSecurityToken)derivedKeyTokenSecurityEvent.getSecurityToken());
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDerivedKeySupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireDerivedKeys/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V1Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  x509TokenSecurityEvent=new X509TokenSecurityEvent();
  securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(securityToken);
  DerivedKeyTokenSecurityEvent derivedKeyTokenSecurityEvent=new DerivedKeyTokenSecurityEvent();
  derivedKeyTokenSecurityEvent.setSecurityToken(getX509Token(WSSecurityTokenConstants.DerivedKeyToken));
  securityToken.addWrappedToken((InboundSecurityToken)derivedKeyTokenSecurityEvent.getSecurityToken());
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDerivedKeyInitiatorTokenPolicy() throws Exception {
  String policyString="<sp:AsymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:InitiatorToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireDerivedKeys/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:InitiatorToken>\n"+ "<sp:RecipientToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireDerivedKeys/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:RecipientToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:AsymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent initiatorX509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorX509TokenSecurityEvent.setSecurityToken(securityToken);
  DerivedKeyTokenSecurityEvent derivedKeyTokenSecurityEvent=new DerivedKeyTokenSecurityEvent();
  derivedKeyTokenSecurityEvent.setSecurityToken(getX509Token(WSSecurityTokenConstants.DerivedKeyToken));
  securityToken.addWrappedToken((InboundSecurityToken)derivedKeyTokenSecurityEvent.getSecurityToken());
  policyEnforcer.registerSecurityEvent(initiatorX509TokenSecurityEvent);
  X509TokenSecurityEvent recipientX509TokenSecurityEvent=new X509TokenSecurityEvent();
  securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientX509TokenSecurityEvent.setSecurityToken(securityToken);
  derivedKeyTokenSecurityEvent=new DerivedKeyTokenSecurityEvent();
  derivedKeyTokenSecurityEvent.setSecurityToken(getX509Token(WSSecurityTokenConstants.DerivedKeyToken));
  securityToken.addWrappedToken((InboundSecurityToken)derivedKeyTokenSecurityEvent.getSecurityToken());
  policyEnforcer.registerSecurityEvent(recipientX509TokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientX509TokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientX509TokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.EncryptedElementsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:EncryptedElements xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<sp:XPath xmlns:b=\"http://example.org\">/b:a</sp:XPath>\n" + "</sp:EncryptedElements>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedElementSecurityEvent encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  encryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.add(new QName("http://example.org","a"));
  encryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.add(new QName("http://example.org","b"));
  encryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.EncryptedPartsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyWholeBody() throws Exception {
  String policyString="<sp:EncryptedParts xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "</sp:EncryptedParts>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedPartSecurityEvent encryptedPartSecurityEvent=new EncryptedPartSecurityEvent(null,true,protectionOrder);
  encryptedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","a"));
  encryptedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","b"));
  encryptedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyWildcardHeader() throws Exception {
  String policyString="<sp:EncryptedParts xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<sp:Body/>\n" + "<sp:Header Namespace=\"http://example.org\"/>\n"+ "<sp:Attachments/>\n"+ "</sp:EncryptedParts>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedPartSecurityEvent encryptedPartSecurityEvent=new EncryptedPartSecurityEvent(null,true,protectionOrder);
  encryptedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","a"));
  encryptedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","b"));
  encryptedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:EncryptedParts xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<sp:Body/>\n" + "<sp:Header Name=\"a\" Namespace=\"http://example.org\"/>\n"+ "<sp:Attachments/>\n"+ "</sp:EncryptedParts>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedPartSecurityEvent encryptedPartSecurityEvent=new EncryptedPartSecurityEvent(null,true,protectionOrder);
  encryptedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","a"));
  encryptedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","b"));
  encryptedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.HttpsTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:TransportBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:TransportToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:HttpsToken>\n"+ "       <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "       <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "           <sp:RequireClientCertificate/>\n"+ "       </wsp:Policy>\n"+ "       </sp:HttpsToken>"+ "   </wsp:Policy>\n"+ "</sp:TransportToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:TransportBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  HttpsTokenSecurityEvent httpsTokenSecurityEvent=new HttpsTokenSecurityEvent();
  HttpsSecurityTokenImpl securityToken=getHttpsSecurityToken(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  httpsTokenSecurityEvent.setSecurityToken(securityToken);
  httpsTokenSecurityEvent.setAuthenticationType(HttpsTokenSecurityEvent.AuthenticationType.HttpsClientCertificateAuthentication);
  httpsTokenSecurityEvent.setIssuerName("xs:anyURI");
  policyEnforcer.registerSecurityEvent(httpsTokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.IssuedTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyWithSAMLToken() throws Exception {
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(samlPolicyString);
  SAMLCallback samlCallback=new SAMLCallback();
  samlCallback.setSamlVersion(Version.SAML_20);
  samlCallback.setIssuer("http://initiatorTokenIssuer.com");
  SubjectBean subjectBean=new SubjectBean();
  samlCallback.setSubject(subjectBean);
  List<AttributeStatementBean> attributeStatementBeans=new ArrayList<>();
  List<AttributeBean> attributeBeans=new ArrayList<>();
  List attributeValues=new ArrayList<>();
  attributeValues.add("test@example.com");
  attributeBeans.add(new AttributeBean("email","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/email",attributeValues));
  attributeValues.clear();
  attributeValues.add("Proper");
  attributeBeans.add(new AttributeBean("surname","http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname",attributeValues));
  attributeStatementBeans.add(new AttributeStatementBean(subjectBean,attributeBeans));
  samlCallback.setAttributeStatementData(attributeStatementBeans);
  SamlAssertionWrapper samlAssertionWrapper=createSamlAssertionWrapper(samlCallback);
  SamlTokenSecurityEvent initiatorTokenSecurityEvent=new SamlTokenSecurityEvent();
  SamlSecurityTokenImpl securityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  samlCallback.setIssuer("http://recipientTokenIssuer.com");
  samlAssertionWrapper=createSamlAssertionWrapper(samlCallback);
  SamlTokenSecurityEvent recipientTokenSecurityEvent=new SamlTokenSecurityEvent();
  securityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyWithKerberosToken() throws Exception {
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(kerberosPolicyString);
  KerberosTokenSecurityEvent initiatorTokenSecurityEvent=new KerberosTokenSecurityEvent();
  initiatorTokenSecurityEvent.setIssuerName("http://initiatorTokenIssuer.com");
  KerberosServiceSecurityTokenImpl securityToken=new KerberosServiceSecurityTokenImpl(null,null,null,"http://docs.oasisopen.org/wss/oasiswss-kerberos-tokenprofile-1.1#Kerberosv5APREQSHA1","1",WSSecurityTokenConstants.KEYIDENTIFIER_EMBEDDED_KEY_IDENTIFIER_REF);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  KerberosTokenSecurityEvent recipientTokenSecurityEvent=new KerberosTokenSecurityEvent();
  recipientTokenSecurityEvent.setIssuerName("http://recipientTokenIssuer.com");
  securityToken=new KerberosServiceSecurityTokenImpl(null,null,null,"http://docs.oasisopen.org/wss/oasiswss-kerberos-tokenprofile-1.1#Kerberosv5APREQSHA1","1",WSSecurityTokenConstants.KEYIDENTIFIER_EMBEDDED_KEY_IDENTIFIER_REF);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.KerberosTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:SymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:EncryptionToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:KerberosToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireKeyIdentifierReference/>"+ "               <sp:WssKerberosV5ApReqToken11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:KerberosToken>\n"+ "   </wsp:Policy>\n"+ "</sp:EncryptionToken>\n"+ "<sp:SignatureToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:KerberosToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireKeyIdentifierReference/>"+ "               <sp:WssKerberosV5ApReqToken11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:KerberosToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SignatureToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:SymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  KerberosTokenSecurityEvent initiatorTokenSecurityEvent=new KerberosTokenSecurityEvent();
  initiatorTokenSecurityEvent.setIssuerName("xs:anyURI");
  KerberosServiceSecurityTokenImpl kerberosServiceSecurityToken=new KerberosServiceSecurityTokenImpl(null,null,null,WSSConstants.NS_KERBEROS5_AP_REQ,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_EMBEDDED_KEY_IDENTIFIER_REF);
  kerberosServiceSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(kerberosServiceSecurityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  KerberosTokenSecurityEvent recipientTokenSecurityEvent=new KerberosTokenSecurityEvent();
  recipientTokenSecurityEvent.setIssuerName("xs:anyURI");
  kerberosServiceSecurityToken=new KerberosServiceSecurityTokenImpl(null,null,null,WSSConstants.NS_KERBEROS5_AP_REQ,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_EMBEDDED_KEY_IDENTIFIER_REF);
  kerberosServiceSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(kerberosServiceSecurityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.KeyValueTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:AsymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:InitiatorToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:KeyValueToken>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RsaKeyValue/>\n"+ "           </wsp:Policy>\n"+ "       </sp:KeyValueToken>\n"+ "   </wsp:Policy>\n"+ "</sp:InitiatorToken>\n"+ "<sp:RecipientToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:KeyValueToken>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RsaKeyValue/>\n"+ "           </wsp:Policy>\n"+ "       </sp:KeyValueToken>\n"+ "   </wsp:Policy>\n"+ "</sp:RecipientToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:AsymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  KeyValueTokenSecurityEvent initiatorTokenSecurityEvent=new KeyValueTokenSecurityEvent();
  RsaKeyValueSecurityTokenImpl securityToken=getRsaKeyValueSecurityToken();
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  KeyValueTokenSecurityEvent recipientTokenSecurityEvent=new KeyValueTokenSecurityEvent();
  securityToken=getRsaKeyValueSecurityToken();
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.ProtectionOrderTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyEncryptBeforeSign() throws Exception {
  String policyString="<sp:AsymmetricBinding  xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "   <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "       <sp:EncryptBeforeSigning/>\n"+ "   </wsp:Policy>\n"+ "</sp:AsymmetricBinding>\n";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  SignedElementSecurityEvent signedElementSecurityEvent=new SignedElementSecurityEvent(null,true,protectionOrder);
  signedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
  EncryptedPartSecurityEvent encryptedPartSecurityEvent=new EncryptedPartSecurityEvent(null,true,protectionOrder);
  encryptedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  EncryptedElementSecurityEvent encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  encryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent(null,true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyEncryptBeforeSignWithoutSignature() throws Exception {
  String policyString="<sp:AsymmetricBinding  xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "   <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "       <sp:EncryptBeforeSigning/>\n"+ "   </wsp:Policy>\n"+ "</sp:AsymmetricBinding>\n";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedPartSecurityEvent encryptedPartSecurityEvent=new EncryptedPartSecurityEvent(null,true,protectionOrder);
  encryptedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicySignBeforeEncryptWithoutEncryption() throws Exception {
  String policyString="<sp:AsymmetricBinding  xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "   <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "   </wsp:Policy>\n"+ "</sp:AsymmetricBinding>\n";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicySignBeforeEncrypt() throws Exception {
  String policyString="<sp:AsymmetricBinding  xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "   <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "   </wsp:Policy>\n"+ "</sp:AsymmetricBinding>\n";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  SignedElementSecurityEvent signedElementSecurityEvent=new SignedElementSecurityEvent(null,true,protectionOrder);
  signedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
  EncryptedPartSecurityEvent encryptedPartSecurityEvent=new EncryptedPartSecurityEvent(null,true,protectionOrder);
  encryptedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(encryptedPartSecurityEvent);
  EncryptedElementSecurityEvent encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  encryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent(null,true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.RelTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:AsymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:InitiatorToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:RelToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:WssRelV20Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:RelToken>\n"+ "   </wsp:Policy>\n"+ "</sp:InitiatorToken>\n"+ "<sp:RecipientToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:RelToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:WssRelV20Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:RelToken>\n"+ "   </wsp:Policy>\n"+ "</sp:RecipientToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:AsymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  RelTokenSecurityEvent initiatorTokenSecurityEvent=new RelTokenSecurityEvent();
  initiatorTokenSecurityEvent.setIssuerName("xs:anyURI");
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  RelTokenSecurityEvent recipientTokenSecurityEvent=new RelTokenSecurityEvent();
  recipientTokenSecurityEvent.setIssuerName("xs:anyURI");
  securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.RequiredElementsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:RequiredElements xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<sp:XPath xmlns:b=\"http://example.org\">/b:a</sp:XPath>\n" + "</sp:RequiredElements>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  RequiredElementSecurityEvent requiredElementSecurityEvent=new RequiredElementSecurityEvent();
  requiredElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(requiredElementSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.add(new QName("http://example.org","a"));
  requiredElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(requiredElementSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.add(new QName("http://example.org","b"));
  requiredElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(requiredElementSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.RequiredPartsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:RequiredParts xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<sp:Header Name=\"a\" Namespace=\"http://example.org\"/>\n" + "</sp:RequiredParts>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  RequiredPartSecurityEvent requiredPartSecurityEvent=new RequiredPartSecurityEvent();
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","a"));
  requiredPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(requiredPartSecurityEvent);
  requiredPartSecurityEvent=new RequiredPartSecurityEvent();
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","b"));
  requiredPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(requiredPartSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.SamlTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:AsymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:InitiatorToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:SamlToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:WssSamlV20Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:SamlToken>\n"+ "   </wsp:Policy>\n"+ "</sp:InitiatorToken>\n"+ "<sp:RecipientToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:SamlToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:WssSamlV20Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:SamlToken>\n"+ "   </wsp:Policy>\n"+ "</sp:RecipientToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:AsymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SAMLCallback samlCallback=new SAMLCallback();
  samlCallback.setSamlVersion(Version.SAML_20);
  samlCallback.setIssuer("xs:anyURI");
  SubjectBean subjectBean=new SubjectBean();
  samlCallback.setSubject(subjectBean);
  SamlAssertionWrapper samlAssertionWrapper=createSamlAssertionWrapper(samlCallback);
  SamlTokenSecurityEvent initiatorTokenSecurityEvent=new SamlTokenSecurityEvent();
  SamlSecurityTokenImpl securityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  SamlTokenSecurityEvent recipientTokenSecurityEvent=new SamlTokenSecurityEvent();
  securityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.SecureConversationTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:SymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:EncryptionToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:SecureConversationToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireExternalUriReference/>\n"+ "           </wsp:Policy>\n"+ "       </sp:SecureConversationToken>\n"+ "   </wsp:Policy>\n"+ "</sp:EncryptionToken>\n"+ "<sp:SignatureToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:SecureConversationToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireExternalUriReference/>\n"+ "           </wsp:Policy>\n"+ "       </sp:SecureConversationToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SignatureToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:SymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent initiatorTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  initiatorTokenSecurityEvent.setIssuerName("xs:anyURI");
  initiatorTokenSecurityEvent.setExternalUriRef(true);
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  SecurityContextTokenSecurityEvent recipientTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  recipientTokenSecurityEvent.setIssuerName("xs:anyURI");
  recipientTokenSecurityEvent.setExternalUriRef(true);
  securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.SecurityContextTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:SymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:EncryptionToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:SecurityContextToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireExternalUriReference/>\n"+ "           </wsp:Policy>\n"+ "       </sp:SecurityContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:EncryptionToken>\n"+ "<sp:SignatureToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:SecurityContextToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireExternalUriReference/>\n"+ "           </wsp:Policy>\n"+ "       </sp:SecurityContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SignatureToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:SymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent initiatorTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  initiatorTokenSecurityEvent.setIssuerName("xs:anyURI");
  initiatorTokenSecurityEvent.setExternalUriRef(true);
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  SecurityContextTokenSecurityEvent recipientTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  recipientTokenSecurityEvent.setIssuerName("xs:anyURI");
  recipientTokenSecurityEvent.setExternalUriRef(true);
  securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.SignedElementsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:SignedElements xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<sp:XPath xmlns:b=\"http://example.org\">/b:a</sp:XPath>\n" + "</sp:SignedElements>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedElementSecurityEvent signedElementSecurityEvent=new SignedElementSecurityEvent(null,true,protectionOrder);
  signedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","a"));
  signedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","b"));
  signedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.SignedPartsTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyWildcardHeader() throws Exception {
  String policyString="<sp:SignedParts xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<sp:Body/>\n" + "<sp:Header Namespace=\"http://example.org\"/>\n"+ "<sp:Attachments>\n"+ "<sp3:ContentSignatureTransform/>\n"+ "<sp3:AttachmentCompleteSignatureTransform/>\n"+ "</sp:Attachments>\n"+ "</sp:SignedParts>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","a"));
  signedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","b"));
  signedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:SignedParts xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<sp:Body/>\n" + "<sp:Header Name=\"a\" Namespace=\"http://example.org\"/>\n"+ "<sp:Attachments>\n"+ "<sp3:ContentSignatureTransform/>\n"+ "<sp3:AttachmentCompleteSignatureTransform/>\n"+ "</sp:Attachments>\n"+ "</sp:SignedParts>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","a"));
  signedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","b"));
  signedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyAllHeaders() throws Exception {
  String policyString="<sp:SignedParts xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "</sp:SignedParts>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","a"));
  signedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.SOAP_11_HEADER_PATH);
  headerPath.add(new QName("http://example.org","b"));
  signedPartSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.SpnegoContextTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:AsymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:InitiatorToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:SpnegoContextToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:MustNotSendCancel/>\n"+ "           </wsp:Policy>\n"+ "       </sp:SpnegoContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:InitiatorToken>\n"+ "<sp:RecipientToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:SpnegoContextToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:MustNotSendCancel/>\n"+ "           </wsp:Policy>\n"+ "       </sp:SpnegoContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:RecipientToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:AsymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent initiatorTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  initiatorTokenSecurityEvent.setIssuerName("xs:anyURI");
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  SecurityContextTokenSecurityEvent recipientTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  recipientTokenSecurityEvent.setIssuerName("xs:anyURI");
  securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.SupportingTokensTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testX509SupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireThumbprintReference/>\n"+ "               <sp:WssX509V3Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  x509TokenSecurityEvent=new X509TokenSecurityEvent();
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSecureConversationTokenSupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SecureConversationToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SecureConversationToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSecureConversationTokenSupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SecureConversationToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SecureConversationToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSecurityContextTokenSupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SecurityContextToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SecurityContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKerberosSupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:KerberosToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:KerberosToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  KerberosTokenSecurityEvent tokenSecurityEvent=new KerberosTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  KerberosServiceSecurityTokenImpl kerberosServiceSecurityToken=getKerberosServiceSecurityToken(WSSecurityTokenConstants.KERBEROS_TOKEN);
  kerberosServiceSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(kerberosServiceSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new KerberosTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  kerberosServiceSecurityToken=getKerberosServiceSecurityToken(WSSecurityTokenConstants.KERBEROS_TOKEN);
  kerberosServiceSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(kerberosServiceSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKerberosSupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:KerberosToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:KerberosToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  KerberosTokenSecurityEvent tokenSecurityEvent=new KerberosTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  KerberosServiceSecurityTokenImpl kerberosServiceSecurityToken=getKerberosServiceSecurityToken(WSSecurityTokenConstants.KERBEROS_TOKEN);
  kerberosServiceSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(kerberosServiceSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new KerberosTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  kerberosServiceSecurityToken=getKerberosServiceSecurityToken(WSSecurityTokenConstants.KERBEROS_TOKEN);
  kerberosServiceSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(kerberosServiceSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSpnegoSupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SpnegoContextToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SpnegoContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRelTokenSupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:RelToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "       </sp:RelToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  RelTokenSecurityEvent tokenSecurityEvent=new RelTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new RelTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSamlTokenSupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SamlToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SamlToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SAMLCallback samlCallback=new SAMLCallback();
  samlCallback.setSamlVersion(Version.SAML_20);
  samlCallback.setIssuer("CN=transmitter,OU=swssf,C=CH");
  SubjectBean subjectBean=new SubjectBean();
  samlCallback.setSubject(subjectBean);
  SamlAssertionWrapper samlAssertionWrapper=createSamlAssertionWrapper(samlCallback);
  SamlTokenSecurityEvent tokenSecurityEvent=new SamlTokenSecurityEvent();
  SamlSecurityTokenImpl samlSecurityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  samlSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(samlSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SamlTokenSecurityEvent();
  samlSecurityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  samlSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(samlSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIssuedSupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:IssuedToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <sp:RequestSecurityTokenTemplate/>\n"+ "           <wsp:Policy/>\n"+ "       </sp:IssuedToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent securityContextTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  securityContextTokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  securityContextTokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(securityContextTokenSecurityEvent);
  securityContextTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  securityContextTokenSecurityEvent.setIssuerName("test");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  securityContextTokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(securityContextTokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSecureConversationTokenSupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SecureConversationToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SecureConversationToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testX509SupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireThumbprintReference/>\n"+ "               <sp:WssX509V3Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V1Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  x509TokenSecurityEvent=new X509TokenSecurityEvent();
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSamlTokenSupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SamlToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SamlToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SAMLCallback samlCallback=new SAMLCallback();
  samlCallback.setSamlVersion(Version.SAML_20);
  samlCallback.setIssuer("xs:anyURI");
  SubjectBean subjectBean=new SubjectBean();
  samlCallback.setSubject(subjectBean);
  SamlAssertionWrapper samlAssertionWrapper=createSamlAssertionWrapper(samlCallback);
  SamlTokenSecurityEvent tokenSecurityEvent=new SamlTokenSecurityEvent();
  SamlSecurityTokenImpl samlSecurityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  samlSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(samlSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  samlCallback.setIssuer("CN=transmitter,OU=swssf,C=CH");
  samlAssertionWrapper=createSamlAssertionWrapper(samlCallback);
  tokenSecurityEvent=new SamlTokenSecurityEvent();
  samlSecurityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  samlSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(samlSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSupportingTokenPolicy() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireThumbprintReference/>\n"+ "               <sp:WssX509V3Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIssuedSupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:IssuedToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <sp:RequestSecurityTokenTemplate/>\n"+ "           <wsp:Policy/>\n"+ "       </sp:IssuedToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent securityContextTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  securityContextTokenSecurityEvent.setIssuerName("test");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  securityContextTokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(securityContextTokenSecurityEvent);
  securityContextTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  securityContextTokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  securityContextTokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(securityContextTokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRelTokenSupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:RelToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "       </sp:RelToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  RelTokenSecurityEvent tokenSecurityEvent=new RelTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new RelTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUsernameSupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:UsernameToken>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:NoPassword/>\n"+ "           </wsp:Policy>\n"+ "       </sp:UsernameToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  UsernameTokenSecurityEvent usernameTokenSecurityEvent=new UsernameTokenSecurityEvent();
  usernameTokenSecurityEvent.setUsernameTokenProfile(WSSConstants.NS_USERNAMETOKEN_PROFILE11);
  UsernameSecurityTokenImpl securityToken=new UsernameSecurityTokenImpl(WSSConstants.UsernameTokenPasswordType.PASSWORD_DIGEST,"username","password",new Date().toString(),null,new byte[10],10L,null,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  usernameTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(usernameTokenSecurityEvent);
  usernameTokenSecurityEvent=new UsernameTokenSecurityEvent();
  usernameTokenSecurityEvent.setUsernameTokenProfile(WSSConstants.NS_USERNAMETOKEN_PROFILE11);
  securityToken=new UsernameSecurityTokenImpl(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE,"username",null,new Date().toString(),null,new byte[10],10L,null,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  usernameTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(usernameTokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSpnegoSupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SpnegoContextToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SpnegoContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSpnegoSupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SpnegoContextToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SpnegoContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testX509SupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireThumbprintReference/>\n"+ "               <sp:WssX509V3Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  x509TokenSecurityEvent=new X509TokenSecurityEvent();
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V1Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  x509TokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKeyValueTokenSupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:KeyValueToken>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RsaKeyValue/>\n"+ "           </wsp:Policy>\n"+ "       </sp:KeyValueToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  KeyValueTokenSecurityEvent tokenSecurityEvent=new KeyValueTokenSecurityEvent();
  RsaKeyValueSecurityTokenImpl rsaKeyValueSecurityToken=getRsaKeyValueSecurityToken();
  rsaKeyValueSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(rsaKeyValueSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new KeyValueTokenSecurityEvent();
  rsaKeyValueSecurityToken=getRsaKeyValueSecurityToken();
  rsaKeyValueSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(rsaKeyValueSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKeyValueTokenSupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:KeyValueToken>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RsaKeyValue/>\n"+ "           </wsp:Policy>\n"+ "       </sp:KeyValueToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  KeyValueTokenSecurityEvent tokenSecurityEvent=new KeyValueTokenSecurityEvent();
  RsaKeyValueSecurityTokenImpl rsaKeyValueSecurityToken=getRsaKeyValueSecurityToken();
  rsaKeyValueSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(rsaKeyValueSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new KeyValueTokenSecurityEvent();
  rsaKeyValueSecurityToken=getRsaKeyValueSecurityToken();
  rsaKeyValueSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(rsaKeyValueSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUsernameSupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:UsernameToken>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:NoPassword/>\n"+ "           </wsp:Policy>\n"+ "       </sp:UsernameToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  UsernameTokenSecurityEvent usernameTokenSecurityEvent=new UsernameTokenSecurityEvent();
  usernameTokenSecurityEvent.setUsernameTokenProfile(WSSConstants.NS_USERNAMETOKEN_PROFILE11);
  UsernameSecurityTokenImpl securityToken=new UsernameSecurityTokenImpl(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE,"username",null,new Date().toString(),null,new byte[10],10L,null,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  usernameTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(usernameTokenSecurityEvent);
  usernameTokenSecurityEvent=new UsernameTokenSecurityEvent();
  usernameTokenSecurityEvent.setUsernameTokenProfile(WSSConstants.NS_USERNAMETOKEN_PROFILE11);
  securityToken=new UsernameSecurityTokenImpl(WSSConstants.UsernameTokenPasswordType.PASSWORD_DIGEST,"username","password",new Date().toString(),null,new byte[10],10L,null,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  usernameTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(usernameTokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIssuedSupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:IssuedToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <sp:RequestSecurityTokenTemplate/>\n"+ "           <wsp:Policy/>\n"+ "       </sp:IssuedToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent securityContextTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  securityContextTokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  securityContextTokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(securityContextTokenSecurityEvent);
  securityContextTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  securityContextTokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  securityContextTokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(securityContextTokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSecurityContextTokenSupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SecurityContextToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SecurityContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKeyValueTokenSupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:KeyValueToken>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RsaKeyValue/>\n"+ "           </wsp:Policy>\n"+ "       </sp:KeyValueToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  KeyValueTokenSecurityEvent tokenSecurityEvent=new KeyValueTokenSecurityEvent();
  RsaKeyValueSecurityTokenImpl rsaKeyValueSecurityToken=getRsaKeyValueSecurityToken();
  rsaKeyValueSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(rsaKeyValueSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new KeyValueTokenSecurityEvent();
  rsaKeyValueSecurityToken=getRsaKeyValueSecurityToken();
  rsaKeyValueSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(rsaKeyValueSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRelTokenSupportingTokenPolicyAdditionalTokenFirstIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:RelTokenSecurityEvent>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "       </sp:RelTokenSecurityEvent>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  RelTokenSecurityEvent tokenSecurityEvent=new RelTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new RelTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testKerberosSupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:KerberosToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:KerberosToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  KerberosTokenSecurityEvent tokenSecurityEvent=new KerberosTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  KerberosServiceSecurityTokenImpl kerberosServiceSecurityToken=getKerberosServiceSecurityToken(WSSecurityTokenConstants.KERBEROS_TOKEN);
  kerberosServiceSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(kerberosServiceSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new KerberosTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  kerberosServiceSecurityToken=getKerberosServiceSecurityToken(WSSecurityTokenConstants.KERBEROS_TOKEN);
  kerberosServiceSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(kerberosServiceSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSecurityContextTokenSupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SecurityContextToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SecurityContextToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SecurityContextTokenSecurityEvent tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  tokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  tokenSecurityEvent.setIssuerName("test");
  x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSamlTokenSupportingTokenPolicyAdditionalTokenLastIgnore() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:SamlToken>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy/>\n"+ "       </sp:SamlToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  SAMLCallback samlCallback=new SAMLCallback();
  samlCallback.setSamlVersion(Version.SAML_20);
  samlCallback.setIssuer("CN=transmitter,OU=swssf,C=CH");
  SubjectBean subjectBean=new SubjectBean();
  samlCallback.setSubject(subjectBean);
  SamlAssertionWrapper samlAssertionWrapper=createSamlAssertionWrapper(samlCallback);
  SamlTokenSecurityEvent tokenSecurityEvent=new SamlTokenSecurityEvent();
  SamlSecurityTokenImpl samlSecurityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  samlSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(samlSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  samlCallback.setIssuer("xs:anyURI");
  samlAssertionWrapper=createSamlAssertionWrapper(samlCallback);
  tokenSecurityEvent=new SamlTokenSecurityEvent();
  samlSecurityToken=new SamlSecurityTokenImpl(samlAssertionWrapper,getX509Token(WSSecurityTokenConstants.X509V3Token),null,null,WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE,null);
  samlSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  tokenSecurityEvent.setSecurityToken(samlSecurityToken);
  policyEnforcer.registerSecurityEvent(tokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUsernameSupportingTokenPolicyAdditionalToken() throws Exception {
  String policyString="<sp:SupportingTokens xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "       <sp:UsernameToken>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:NoPassword/>\n"+ "           </wsp:Policy>\n"+ "       </sp:UsernameToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SupportingTokens>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  UsernameTokenSecurityEvent usernameTokenSecurityEvent=new UsernameTokenSecurityEvent();
  usernameTokenSecurityEvent.setUsernameTokenProfile(WSSConstants.NS_USERNAMETOKEN_PROFILE11);
  UsernameSecurityTokenImpl usernameSecurityToken=new UsernameSecurityTokenImpl(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE,"username",null,new Date().toString(),null,new byte[10],10L,null,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  usernameSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  usernameTokenSecurityEvent.setSecurityToken(usernameSecurityToken);
  policyEnforcer.registerSecurityEvent(usernameTokenSecurityEvent);
  usernameTokenSecurityEvent=new UsernameTokenSecurityEvent();
  usernameTokenSecurityEvent.setUsernameTokenProfile(WSSConstants.NS_USERNAMETOKEN_PROFILE11);
  usernameSecurityToken=new UsernameSecurityTokenImpl(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE,"username",null,new Date().toString(),null,new byte[10],10L,null,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  usernameSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS);
  usernameTokenSecurityEvent.setSecurityToken(usernameSecurityToken);
  policyEnforcer.registerSecurityEvent(usernameTokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.SymmetricBindingTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:SymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "<sp:IncludeTimestamp/>\n"+ "<sp:EncryptSignature/>\n"+ "<sp:OnlySignEntireHeadersAndBody/>\n"+ "</wsp:Policy>\n"+ "</sp:SymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  TimestampSecurityEvent timestampSecurityEvent=new TimestampSecurityEvent();
  policyEnforcer.registerSecurityEvent(timestampSecurityEvent);
  RequiredElementSecurityEvent requiredElementSecurityEvent=new RequiredElementSecurityEvent();
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_WSU_TIMESTAMP);
  requiredElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(requiredElementSecurityEvent);
  SecurityContextTokenSecurityEvent initiatorTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  SecureConversationSecurityTokenImpl securityToken=new SecureConversationSecurityTokenImpl(null,"1",WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  SecurityContextTokenSecurityEvent recipientTokenSecurityEvent=new SecurityContextTokenSecurityEvent();
  securityToken=new SecureConversationSecurityTokenImpl(null,"1",WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedElementSecurityEvent encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_dsig_Signature);
  encryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_WSSE11_SIG_CONF);
  encryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,true,protectionOrder);
  signedPartSecurityEvent.setXmlSecEvent(XMLSecEventFactory.createXmlSecStartElement(WSSConstants.TAG_SOAP11_BODY,null,null));
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.TokenProtectionTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicySymmetricBindingProtectSignatureToken() throws Exception {
  String policyString="<sp:SymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "<sp:ProtectTokens/>\n"+ "</wsp:Policy>\n"+ "</sp:SymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  List<QName> bstPath=new ArrayList<>();
  bstPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  bstPath.add(WSSConstants.TAG_WSSE_BINARY_SECURITY_TOKEN);
  List<QName> ekPath=new ArrayList<>();
  ekPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  ekPath.add(WSSConstants.TAG_xenc_EncryptedKey);
  List<QName> sigPath=new ArrayList<>();
  sigPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  sigPath.add(WSSConstants.TAG_dsig_Signature);
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  x509SecurityToken.setElementPath(bstPath);
  AbstractInboundSecurityToken ekSecurityToken=new AbstractInboundSecurityToken(null,IDGenerator.generateID(null),SecurityTokenConstants.KeyIdentifier_EncryptedKey,true){
    @Override public SecurityTokenConstants.TokenType getTokenType(){
      return SecurityTokenConstants.EncryptedKeyToken;
    }
  }
;
  ekSecurityToken.addTokenUsage(WSSecurityTokenConstants.TokenUsage_Signature);
  ekSecurityToken.setKeyWrappingToken(x509SecurityToken);
  ekSecurityToken.setElementPath(ekPath);
  x509SecurityToken.addWrappedToken(ekSecurityToken);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  x509TokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  EncryptedKeyTokenSecurityEvent encryptedKeyTokenSecurityEvent=new EncryptedKeyTokenSecurityEvent();
  encryptedKeyTokenSecurityEvent.setSecurityToken(ekSecurityToken);
  policyEnforcer.registerSecurityEvent(encryptedKeyTokenSecurityEvent);
  SignedElementSecurityEvent signedElementSecurityEvent=new SignedElementSecurityEvent(ekSecurityToken,true,protectionOrder);
  signedElementSecurityEvent.setElementPath(ekPath);
  policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:AsymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "<sp:ProtectTokens/>\n"+ "</wsp:Policy>\n"+ "</sp:AsymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  List<QName> bstPath=new ArrayList<>();
  bstPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  bstPath.add(WSSConstants.TAG_WSSE_BINARY_SECURITY_TOKEN);
  List<QName> sigPath=new ArrayList<>();
  sigPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  sigPath.add(WSSConstants.TAG_dsig_Signature);
  List<SecurityToken> securityTokens=new LinkedList<>();
  for (int i=0; i < tokenUsages.size(); i++) {
    WSSecurityTokenConstants.TokenUsage tokenUsage=tokenUsages.get(i);
    X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
    X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
    securityTokens.add(securityToken);
    securityToken.setElementPath(bstPath);
    securityToken.addTokenUsage(tokenUsage);
    x509TokenSecurityEvent.setSecurityToken(securityToken);
    policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
    if (tokenUsage.getName().contains("Signature") || tokenUsage.getName().contains("Endorsing")) {
      SignedElementSecurityEvent signedElementSecurityEvent=new SignedElementSecurityEvent(securityToken,true,protectionOrder);
      signedElementSecurityEvent.setElementPath(bstPath);
      policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
    }
    if (tokenUsage.getName().contains("Endorsing")) {
      SignedElementSecurityEvent signedElementSecurityEvent=new SignedElementSecurityEvent(securityToken,true,protectionOrder);
      signedElementSecurityEvent.setElementPath(sigPath);
      policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
    }
  }
  SecurityToken mainSignatureToken=null;
  Iterator<SecurityToken> securityTokenIterator=securityTokens.iterator();
  while (securityTokenIterator.hasNext()) {
    SecurityToken securityToken=securityTokenIterator.next();
    if (securityToken.getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE)) {
      mainSignatureToken=securityToken;
      break;
    }
  }
  securityTokenIterator=securityTokens.iterator();
  while (securityTokenIterator.hasNext()) {
    SecurityToken securityToken=securityTokenIterator.next();
    if (securityToken.getTokenUsages().get(0).getName().contains("Signed")) {
      SignedElementSecurityEvent signedElementSecurityEvent=new SignedElementSecurityEvent((InboundSecurityToken)mainSignatureToken,true,protectionOrder);
      signedElementSecurityEvent.setElementPath(bstPath);
      policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
    }
  }
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicySymmetricBindingProtectAllToken() throws Exception {
  String policyString="<sp:SymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "<sp:ProtectTokens/>\n"+ "</wsp:Policy>\n"+ "</sp:SymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  List<QName> bstPath=new ArrayList<>();
  bstPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  bstPath.add(WSSConstants.TAG_WSSE_BINARY_SECURITY_TOKEN);
  List<QName> ekPath=new ArrayList<>();
  ekPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  ekPath.add(WSSConstants.TAG_xenc_EncryptedKey);
  List<QName> sigPath=new ArrayList<>();
  sigPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  sigPath.add(WSSConstants.TAG_dsig_Signature);
  X509SecurityTokenImpl x509SecurityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  x509SecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  x509SecurityToken.setElementPath(bstPath);
  AbstractInboundSecurityToken ekSecurityToken=new AbstractInboundSecurityToken(null,IDGenerator.generateID(null),SecurityTokenConstants.KeyIdentifier_EncryptedKey,true){
    @Override public SecurityTokenConstants.TokenType getTokenType(){
      return SecurityTokenConstants.EncryptedKeyToken;
    }
  }
;
  ekSecurityToken.addTokenUsage(WSSecurityTokenConstants.TokenUsage_Signature);
  ekSecurityToken.setKeyWrappingToken(x509SecurityToken);
  ekSecurityToken.setElementPath(ekPath);
  x509SecurityToken.addWrappedToken(ekSecurityToken);
  X509TokenSecurityEvent x509TokenSecurityEvent=new X509TokenSecurityEvent();
  x509TokenSecurityEvent.setSecurityToken(x509SecurityToken);
  policyEnforcer.registerSecurityEvent(x509TokenSecurityEvent);
  EncryptedKeyTokenSecurityEvent encryptedKeyTokenSecurityEvent=new EncryptedKeyTokenSecurityEvent();
  encryptedKeyTokenSecurityEvent.setSecurityToken(ekSecurityToken);
  policyEnforcer.registerSecurityEvent(encryptedKeyTokenSecurityEvent);
  SignedElementSecurityEvent signedElementSecurityEvent=new SignedElementSecurityEvent(x509SecurityToken,true,protectionOrder);
  signedElementSecurityEvent.setElementPath(bstPath);
  policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
  signedElementSecurityEvent=new SignedElementSecurityEvent(ekSecurityToken,true,protectionOrder);
  signedElementSecurityEvent.setElementPath(ekPath);
  policyEnforcer.registerSecurityEvent(signedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.TransportBindingIntegrationTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncludeTimestampAndSignedUsernameSupportingTokenPolicy() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:TransportBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:TransportToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:HttpsToken>\n"+ "                                    <!--<sp:Issuer>wsa:EndpointReferenceType</sp:Issuer>-->\n"+ "                                    <sp:IssuerName>transmitter</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:HttpBasicAuthentication/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:HttpsToken>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:TransportToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:TransportBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Expires</sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "                <sp:SignedSupportingTokens>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:UsernameToken sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                            <wsp:Policy>\n"+ "                                <sp:NoPassword/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:UsernameToken>\n"+ "                    </wsp:Policy>\n"+ "                </sp:SignedSupportingTokens>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.setTokenUser("transmitter");
  outSecurityProperties.setUsernameTokenPasswordType(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE);
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.USERNAMETOKEN);
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,null));
  HttpsTokenSecurityEvent httpsTokenSecurityEvent=new HttpsTokenSecurityEvent();
  httpsTokenSecurityEvent.setIssuerName("transmitter");
  httpsTokenSecurityEvent.setAuthenticationType(HttpsTokenSecurityEvent.AuthenticationType.HttpBasicAuthentication);
  HttpsSecurityTokenImpl httpsSecurityToken=new HttpsSecurityTokenImpl(true,"transmitter");
  httpsSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  httpsTokenSecurityEvent.setSecurityToken(httpsSecurityToken);
  List<SecurityEvent> securityEventList=new ArrayList<>();
  securityEventList.add(httpsTokenSecurityEvent);
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),securityEventList,policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHttpsClientAuthenticationIncludeTimestampAndSignedUsernameSupportingTokenPolicy() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:TransportBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:TransportToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:HttpsToken>\n"+ "                                    <!--<sp:Issuer>wsa:EndpointReferenceType</sp:Issuer>-->\n"+ "                                    <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:RequireClientCertificate/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:HttpsToken>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:TransportToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:TransportBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Created"+ "                    </sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Created"+ "                    </sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" "+ "                       xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" "+ "                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">"+ "                       /soap:Envelope/soap:Header/wsse:Security/wsu:Timestamp/wsu:Expires"+ "                    </sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "                <sp:SignedSupportingTokens>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:UsernameToken sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                            <wsp:Policy>\n"+ "                                <!--<sp:HashPassword/>-->\n"+ "                                <sp:NoPassword/>\n"+ "                                <!--<sp:Created/>\n"+ "                                <sp:Nonce/>-->\n"+ "                            </wsp:Policy>\n"+ "                        </sp:UsernameToken>\n"+ "                    </wsp:Policy>\n"+ "                </sp:SignedSupportingTokens>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.setTokenUser("transmitter");
  outSecurityProperties.setUsernameTokenPasswordType(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE);
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.addSignaturePart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Element));
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.USERNAMETOKEN);
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,null));
  HttpsTokenSecurityEvent httpsTokenSecurityEvent=new HttpsTokenSecurityEvent();
  httpsTokenSecurityEvent.setIssuerName("CN=transmitter,OU=swssf,C=CH");
  httpsTokenSecurityEvent.setAuthenticationType(HttpsTokenSecurityEvent.AuthenticationType.HttpsClientCertificateAuthentication);
  HttpsSecurityTokenImpl httpsSecurityToken=new HttpsSecurityTokenImpl(true,"CN=transmitter,OU=swssf,C=CH");
  httpsSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  httpsTokenSecurityEvent.setSecurityToken(httpsSecurityToken);
  List<SecurityEvent> securityEventList=new ArrayList<>();
  securityEventList.add(httpsTokenSecurityEvent);
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),securityEventList,policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncludeTimestampAndSignedEncryptedUsernameSupportingTokenPolicy() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:TransportBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:TransportToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:HttpsToken>\n"+ "                                    <!--<sp:Issuer>wsa:EndpointReferenceType</sp:Issuer>-->\n"+ "                                    <sp:IssuerName>transmitter</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:HttpBasicAuthentication/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:HttpsToken>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:TransportToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:TransportBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Expires</sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "                <sp:SignedEncryptedSupportingTokens>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:UsernameToken sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                            <wsp:Policy>\n"+ "                                <sp:NoPassword/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:UsernameToken>\n"+ "                    </wsp:Policy>\n"+ "                </sp:SignedEncryptedSupportingTokens>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.setTokenUser("transmitter");
  outSecurityProperties.setUsernameTokenPasswordType(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE);
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.USERNAMETOKEN);
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,null));
  HttpsTokenSecurityEvent httpsTokenSecurityEvent=new HttpsTokenSecurityEvent();
  httpsTokenSecurityEvent.setIssuerName("transmitter");
  httpsTokenSecurityEvent.setAuthenticationType(HttpsTokenSecurityEvent.AuthenticationType.HttpBasicAuthentication);
  HttpsSecurityTokenImpl httpsSecurityToken=new HttpsSecurityTokenImpl(true,"transmitter");
  httpsSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  httpsTokenSecurityEvent.setSecurityToken(httpsSecurityToken);
  List<SecurityEvent> securityEventList=new ArrayList<>();
  securityEventList.add(httpsTokenSecurityEvent);
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),securityEventList,policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncludeTimestampAndProtectionOrderEncryptBeforeSignAndSignedUsernameSupportingTokenPolicyTest() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:TransportBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:TransportToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:HttpsToken>\n"+ "                                    <!--<sp:Issuer>wsa:EndpointReferenceType</sp:Issuer>-->\n"+ "                                    <sp:IssuerName>transmitter</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:HttpBasicAuthentication/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:HttpsToken>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:TransportToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:TransportBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:SignedSupportingTokens>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:UsernameToken sp:IncludeToken=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient\">\n"+ "                            <wsp:Policy>\n"+ "                                <sp:NoPassword/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:UsernameToken>\n"+ "                    </wsp:Policy>\n"+ "                </sp:SignedSupportingTokens>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.setTokenUser("transmitter");
  outSecurityProperties.setUsernameTokenPasswordType(WSSConstants.UsernameTokenPasswordType.PASSWORD_NONE);
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.addEncryptionPart(new SecurePart(WSSConstants.TAG_SOAP11_BODY,SecurePart.Modifier.Content));
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.USERNAMETOKEN);
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,null));
  HttpsTokenSecurityEvent httpsTokenSecurityEvent=new HttpsTokenSecurityEvent();
  httpsTokenSecurityEvent.setIssuerName("transmitter");
  httpsTokenSecurityEvent.setAuthenticationType(HttpsTokenSecurityEvent.AuthenticationType.HttpBasicAuthentication);
  HttpsSecurityTokenImpl httpsSecurityToken=new HttpsSecurityTokenImpl(true,"transmitter");
  httpsSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  httpsTokenSecurityEvent.setSecurityToken(httpsSecurityToken);
  List<SecurityEvent> securityEventList=new ArrayList<>();
  securityEventList.add(httpsTokenSecurityEvent);
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),securityEventList,policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIncludeTimestampPolicy() throws Exception {
  String policyString="<wsp:ExactlyOne xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\" " + "xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\">\n" + "            <wsp:All>\n"+ "                <sp:TransportBinding>\n"+ "                    <wsp:Policy>\n"+ "                        <sp:TransportToken>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:HttpsToken>\n"+ "                                    <sp:IssuerName>transmitter</sp:IssuerName>\n"+ "                                    <wsp:Policy>\n"+ "                                        <sp:HttpBasicAuthentication/>\n"+ "                                    </wsp:Policy>\n"+ "                                </sp:HttpsToken>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:TransportToken>\n"+ "                        <sp:AlgorithmSuite>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Basic256/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:AlgorithmSuite>\n"+ "                        <sp:Layout>\n"+ "                            <wsp:Policy>\n"+ "                                <sp:Lax/>\n"+ "                            </wsp:Policy>\n"+ "                        </sp:Layout>\n"+ "                        <sp:IncludeTimestamp/>\n"+ "                    </wsp:Policy>\n"+ "                </sp:TransportBinding>\n"+ "                <sp:SignedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header1\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:SignedParts>\n"+ "                <sp:SignedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:SignedElements>\n"+ "                <sp:EncryptedParts>\n"+ "                    <sp:Body/>\n"+ "                    <sp:Header Name=\"Header2\" Namespace=\"...\"/>\n"+ "                    <sp:Header Namespace=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"/>\n"+ "                </sp:EncryptedParts>\n"+ "                <sp:EncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Created</sp:XPath>\n"+ "                </sp:EncryptedElements>\n"+ "                <sp:ContentEncryptedElements>\n"+ "                    <sp:XPath xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">wsu:Expires</sp:XPath>\n"+ "                </sp:ContentEncryptedElements>\n"+ "            </wsp:All>\n"+ "        </wsp:ExactlyOne>";
  WSSSecurityProperties outSecurityProperties=new WSSSecurityProperties();
  outSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  outSecurityProperties.setEncryptionUser("receiver");
  outSecurityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  outSecurityProperties.setSignatureUser("transmitter");
  outSecurityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  List<WSSConstants.Action> actions=new ArrayList<>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  outSecurityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(outSecurityProperties,sourceDocument);
  WSSSecurityProperties inSecurityProperties=new WSSSecurityProperties();
  inSecurityProperties.setCallbackHandler(new CallbackHandlerImpl());
  inSecurityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  inSecurityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  inSecurityProperties.addInputProcessor(new PolicyInputProcessor(policyEnforcer,null));
  HttpsTokenSecurityEvent httpsTokenSecurityEvent=new HttpsTokenSecurityEvent();
  httpsTokenSecurityEvent.setIssuerName("transmitter");
  httpsTokenSecurityEvent.setAuthenticationType(HttpsTokenSecurityEvent.AuthenticationType.HttpBasicAuthentication);
  HttpsSecurityTokenImpl httpsSecurityToken=new HttpsSecurityTokenImpl(true,"transmitter");
  httpsSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  httpsTokenSecurityEvent.setSecurityToken(httpsSecurityToken);
  List<SecurityEvent> securityEventList=new ArrayList<>();
  securityEventList.add(httpsTokenSecurityEvent);
  Document document=doInboundSecurity(inSecurityProperties,new ByteArrayInputStream(baos.toByteArray()),securityEventList,policyEnforcer);
  Transformer transformer=TransformerFactory.newInstance().newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.TransportBindingTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:TransportBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "<sp:IncludeTimestamp/>\n"+ "</wsp:Policy>\n"+ "</sp:TransportBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  TimestampSecurityEvent timestampSecurityEvent=new TimestampSecurityEvent();
  policyEnforcer.registerSecurityEvent(timestampSecurityEvent);
  RequiredElementSecurityEvent requiredElementSecurityEvent=new RequiredElementSecurityEvent();
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_WSU_TIMESTAMP);
  requiredElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(requiredElementSecurityEvent);
  HttpsTokenSecurityEvent httpsTokenSecurityEvent=new HttpsTokenSecurityEvent();
  HttpsSecurityTokenImpl httpsSecurityToken=new HttpsSecurityTokenImpl(true,"username");
  httpsSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  httpsTokenSecurityEvent.setSecurityToken(httpsSecurityToken);
  policyEnforcer.registerSecurityEvent(httpsTokenSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedElementSecurityEvent encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_dsig_Signature);
  requiredElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_WSSE11_SIG_CONF);
  requiredElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicyNotWholeBodySigned() throws Exception {
  String policyString="<sp:TransportBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "<sp:IncludeTimestamp/>\n"+ "</wsp:Policy>\n"+ "</sp:TransportBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  TimestampSecurityEvent timestampSecurityEvent=new TimestampSecurityEvent();
  policyEnforcer.registerSecurityEvent(timestampSecurityEvent);
  RequiredElementSecurityEvent requiredElementSecurityEvent=new RequiredElementSecurityEvent();
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_WSU_TIMESTAMP);
  requiredElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(requiredElementSecurityEvent);
  HttpsTokenSecurityEvent httpsTokenSecurityEvent=new HttpsTokenSecurityEvent();
  HttpsSecurityTokenImpl httpsSecurityToken=new HttpsSecurityTokenImpl(true,"username");
  httpsSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  httpsTokenSecurityEvent.setSecurityToken(httpsSecurityToken);
  policyEnforcer.registerSecurityEvent(httpsTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedElementSecurityEvent encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_dsig_Signature);
  encryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,true,protectionOrder);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_WSSE11_SIG_CONF);
  encryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent(null,false,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicySignatureNotEncrypted() throws Exception {
  String policyString="<sp:TransportBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "<sp:IncludeTimestamp/>\n"+ "</wsp:Policy>\n"+ "</sp:TransportBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  TimestampSecurityEvent timestampSecurityEvent=new TimestampSecurityEvent();
  policyEnforcer.registerSecurityEvent(timestampSecurityEvent);
  RequiredElementSecurityEvent requiredElementSecurityEvent=new RequiredElementSecurityEvent();
  List<QName> headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_WSU_TIMESTAMP);
  requiredElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(requiredElementSecurityEvent);
  HttpsTokenSecurityEvent httpsTokenSecurityEvent=new HttpsTokenSecurityEvent();
  HttpsSecurityTokenImpl httpsSecurityToken=new HttpsSecurityTokenImpl(true,"username");
  httpsSecurityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  httpsTokenSecurityEvent.setSecurityToken(httpsSecurityToken);
  policyEnforcer.registerSecurityEvent(httpsTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  EncryptedElementSecurityEvent encryptedElementSecurityEvent=new EncryptedElementSecurityEvent(null,false,protectionOrder);
  headerPath=new ArrayList<>();
  headerPath.addAll(WSSConstants.WSSE_SECURITY_HEADER_PATH);
  headerPath.add(WSSConstants.TAG_dsig_Signature);
  encryptedElementSecurityEvent.setElementPath(headerPath);
  policyEnforcer.registerSecurityEvent(encryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.UsernameTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:SymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:EncryptionToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:UsernameToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:HashPassword/>\n"+ "               <sp:WssUsernameToken11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:UsernameToken>\n"+ "   </wsp:Policy>\n"+ "</sp:EncryptionToken>\n"+ "<sp:SignatureToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:UsernameToken>\n"+ "           <sp:IssuerName>xs:anyURI</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:HashPassword/>\n"+ "               <sp:WssUsernameToken11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:UsernameToken>\n"+ "   </wsp:Policy>\n"+ "</sp:SignatureToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:SymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  UsernameTokenSecurityEvent initiatorTokenSecurityEvent=new UsernameTokenSecurityEvent();
  initiatorTokenSecurityEvent.setUsernameTokenProfile(WSSConstants.NS_USERNAMETOKEN_PROFILE11);
  UsernameSecurityTokenImpl securityToken=new UsernameSecurityTokenImpl(WSSConstants.UsernameTokenPasswordType.PASSWORD_DIGEST,"username","password",new Date().toString(),null,new byte[10],10L,null,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorTokenSecurityEvent);
  UsernameTokenSecurityEvent recipientTokenSecurityEvent=new UsernameTokenSecurityEvent();
  recipientTokenSecurityEvent.setUsernameTokenProfile(WSSConstants.NS_USERNAMETOKEN_PROFILE11);
  securityToken=new UsernameSecurityTokenImpl(WSSConstants.UsernameTokenPasswordType.PASSWORD_DIGEST,"username","password",new Date().toString(),null,new byte[10],10L,null,IDGenerator.generateID(null),WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientTokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientTokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientTokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.WSP13SpecTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAsymmetricBindingC31a() throws Exception {
{
    String policyString=loadResourceAsString("testdata/policy/asymmetricBindingPolicyC31.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateAsymmetricBindingSecurityEvents();
    applyPolicy(null,null,null,policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/asymmetricBindingPolicyC31.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateAsymmetricBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.REQUIRED_ELEMENT,8,"Element /{http://schemas.xmlsoap.org/soap/envelope/}Envelope/{http://schemas.xmlsoap.org/soap/envelope/}Header/{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd}Security/{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp must be present",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/asymmetricBindingPolicyC31.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateAsymmetricBindingSecurityEvents();
    applyPolicy(SecurityEventConstants.X509Token,0,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}X509Token not satisfied",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/asymmetricBindingPolicyC31.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateAsymmetricBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.USERNAME_TOKEN,1,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}UsernameToken not satisfied",policyEnforcer,securityEventList);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSymmetricBindingC21b() throws Exception {
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21b.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(null,null,null,policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21b.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.REQUIRED_ELEMENT,4,"Element /{http://schemas.xmlsoap.org/soap/envelope/}Envelope/{http://schemas.xmlsoap.org/soap/envelope/}Header/{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd}Security/{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp must be present",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21b.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.SAML_TOKEN,-1,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}IssuedToken not satisfied",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21b.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.USERNAME_TOKEN,0,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}UsernameToken not satisfied",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21b.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(SecurityEventConstants.X509Token,2,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}X509Token not satisfied",policyEnforcer,securityEventList);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTransportBindingC11a() throws Exception {
{
    String policyString=loadResourceAsString("testdata/policy/transportBindingPolicyC11.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateTransportBindingSecurityEvents();
    applyPolicy(null,null,null,policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/transportBindingPolicyC11.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateTransportBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.HTTPS_TOKEN,2,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}HttpsToken not satisfied",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/transportBindingPolicyC11.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateTransportBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.REQUIRED_ELEMENT,4,"Element /{http://schemas.xmlsoap.org/soap/envelope/}Envelope/{http://schemas.xmlsoap.org/soap/envelope/}Header/{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd}Security/{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp must be present",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/transportBindingPolicyC11.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateTransportBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.USERNAME_TOKEN,0,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}UsernameToken not satisfied",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/transportBindingPolicyC11.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateTransportBindingSecurityEvents();
    applyPolicy(SecurityEventConstants.X509Token,1,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}X509Token not satisfied",policyEnforcer,securityEventList);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSymmetricBindingC21a() throws Exception {
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21a.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(null,null,null,policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21a.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.REQUIRED_ELEMENT,4,"Element /{http://schemas.xmlsoap.org/soap/envelope/}Envelope/{http://schemas.xmlsoap.org/soap/envelope/}Header/{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd}Security/{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp must be present",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21a.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.SAML_TOKEN,-1,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}IssuedToken not satisfied",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21a.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(WSSecurityEventConstants.USERNAME_TOKEN,0,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}UsernameToken not satisfied",policyEnforcer,securityEventList);
  }
{
    String policyString=loadResourceAsString("testdata/policy/symmetricBindingPolicyC21a.xml",StandardCharsets.UTF_8);
    PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
    List<SecurityEvent> securityEventList=inboundWSSecurityContextImplTest.generateSymmetricBindingSecurityEvents();
    applyPolicy(SecurityEventConstants.X509Token,2,"Assertion {http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702}X509Token not satisfied",policyEnforcer,securityEventList);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.stax.test.X509TokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPolicy() throws Exception {
  String policyString="<sp:AsymmetricBinding xmlns:sp=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702\" xmlns:sp3=\"http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200802\">\n" + "<wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n" + "<sp:InitiatorToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireThumbprintReference/>\n"+ "               <sp:WssX509V3Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:InitiatorToken>\n"+ "<sp:RecipientToken>\n"+ "   <wsp:Policy>\n"+ "       <sp:X509Token>\n"+ "           <sp:IssuerName>CN=transmitter,OU=swssf,C=CH</sp:IssuerName>\n"+ "           <wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\">\n"+ "               <sp:RequireThumbprintReference/>\n"+ "               <sp:WssX509V3Token11/>\n"+ "           </wsp:Policy>\n"+ "       </sp:X509Token>\n"+ "   </wsp:Policy>\n"+ "</sp:RecipientToken>\n"+ "   <sp:AlgorithmSuite>\n"+ "       <wsp:Policy>\n"+ "           <sp:Basic256/>\n"+ "       </wsp:Policy>\n"+ "   </sp:AlgorithmSuite>\n"+ "</wsp:Policy>\n"+ "</sp:AsymmetricBinding>";
  PolicyEnforcer policyEnforcer=buildAndStartPolicyEngine(policyString);
  X509TokenSecurityEvent initiatorX509TokenSecurityEvent=new X509TokenSecurityEvent();
  X509SecurityTokenImpl securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE);
  initiatorX509TokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(initiatorX509TokenSecurityEvent);
  X509TokenSecurityEvent recipientX509TokenSecurityEvent=new X509TokenSecurityEvent();
  securityToken=getX509Token(WSSecurityTokenConstants.X509V3Token);
  securityToken.addTokenUsage(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION);
  recipientX509TokenSecurityEvent.setSecurityToken(securityToken);
  policyEnforcer.registerSecurityEvent(recipientX509TokenSecurityEvent);
  List<XMLSecurityConstants.ContentType> protectionOrder=new LinkedList<>();
  protectionOrder.add(XMLSecurityConstants.ContentType.SIGNATURE);
  protectionOrder.add(XMLSecurityConstants.ContentType.ENCRYPTION);
  SignedPartSecurityEvent signedPartSecurityEvent=new SignedPartSecurityEvent((InboundSecurityToken)recipientX509TokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  signedPartSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(signedPartSecurityEvent);
  ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=new ContentEncryptedElementSecurityEvent((InboundSecurityToken)recipientX509TokenSecurityEvent.getSecurityToken(),true,protectionOrder);
  contentEncryptedElementSecurityEvent.setElementPath(WSSConstants.SOAP_11_BODY_PATH);
  policyEnforcer.registerSecurityEvent(contentEncryptedElementSecurityEvent);
  OperationSecurityEvent operationSecurityEvent=new OperationSecurityEvent();
  operationSecurityEvent.setOperation(new QName("definitions"));
  policyEnforcer.registerSecurityEvent(operationSecurityEvent);
  policyEnforcer.doFinal();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.FaultTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEncryptedFaultInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/soap-fault.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,new Properties());
    javax.xml.transform.Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    InboundWSSec wsSecIn=WSSec.getInboundWSSec(securityProperties);
    XMLStreamReader xmlStreamReader=wsSecIn.processInMessage(xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())));
    StAX2DOM.readDoc(documentBuilderFactory.newDocumentBuilder(),xmlStreamReader);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnsecuredFaultInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/soap-fault.xml");
    DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
    factory.setNamespaceAware(true);
    DocumentBuilder builder=factory.newDocumentBuilder();
    Document securedDocument=builder.parse(sourceDocument);
    javax.xml.transform.Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    InboundWSSec wsSecIn=WSSec.getInboundWSSec(securityProperties);
    XMLStreamReader xmlStreamReader=wsSecIn.processInMessage(xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())));
    StAX2DOM.readDoc(documentBuilderFactory.newDocumentBuilder(),xmlStreamReader);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.InteroperabilityTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilityOutboundSignature() throws Exception {
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setEncryptionUser("receiver");
  securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  securityProperties.setSignatureUser("transmitter");
  securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
  actions.add(WSSConstants.SIGNATURE);
  securityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(securityProperties,sourceDocument);
  String action=WSHandlerConstants.SIGNATURE;
  doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilitySOAPActionOutbound() throws Exception {
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setActor("test");
  securityProperties.setEncryptionUser("receiver");
  securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  securityProperties.setSignatureUser("transmitter");
  securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  securityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(securityProperties,sourceDocument);
  String action=WSHandlerConstants.TIMESTAMP + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
  Properties properties=new Properties();
  properties.setProperty(WSHandlerConstants.ACTOR,"test");
  doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action,properties,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilityOutboundReverseOrder() throws Exception {
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setEncryptionUser("receiver");
  securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  securityProperties.setSignatureUser("transmitter");
  securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
  actions.add(WSSConstants.ENCRYPT);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.TIMESTAMP);
  securityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(securityProperties,sourceDocument);
  String action=WSHandlerConstants.ENCRYPT + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.TIMESTAMP;
  doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilityTwoSecurityHeadersSOAPRoleOutbound() throws Exception {
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setEncryptionUser("receiver");
  securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  securityProperties.setSignatureUser("transmitter");
  securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  securityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.2.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(securityProperties,sourceDocument);
  securityProperties.setActor("test");
  baos=doOutboundSecurity(securityProperties,new ByteArrayInputStream(baos.toByteArray()));
  String action=WSHandlerConstants.TIMESTAMP + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
  Properties properties=new Properties();
  properties.setProperty(WSHandlerConstants.ACTOR,"test");
  doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action,properties,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilitySOAPRoleOutbound() throws Exception {
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setActor("test");
  securityProperties.setEncryptionUser("receiver");
  securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  securityProperties.setSignatureUser("transmitter");
  securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  securityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.2.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(securityProperties,sourceDocument);
  String action=WSHandlerConstants.TIMESTAMP + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
  Properties properties=new Properties();
  properties.setProperty(WSHandlerConstants.ACTOR,"test");
  doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action,properties,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilityOutbound() throws Exception {
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setEncryptionUser("receiver");
  securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  securityProperties.setSignatureUser("transmitter");
  securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
  List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
  actions.add(WSSConstants.TIMESTAMP);
  actions.add(WSSConstants.SIGNATURE);
  actions.add(WSSConstants.ENCRYPT);
  securityProperties.setActions(actions);
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  ByteArrayOutputStream baos=doOutboundSecurity(securityProperties,sourceDocument);
  String action=WSHandlerConstants.TIMESTAMP + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
  doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilitySOAPRoleInbound() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.2.xml");
  String action=WSHandlerConstants.TIMESTAMP + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
  Properties properties=new Properties();
  properties.setProperty(WSHandlerConstants.ACTOR,"test");
  properties.setProperty(WSHandlerConstants.SIGNATURE_PARTS,"{Element}{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp;{Element}{http://www.w3.org/2003/05/soap-envelope}Body;");
  Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  javax.xml.transform.Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setActor("test");
  securityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.SignatureValue,WSSecurityEventConstants.TIMESTAMP,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.SIGNED_PART,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
  final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
  Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
  transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
  securityEventListener.compare();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilityTwoSecurityHeadersSOAPRoleInbound() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.2.xml");
  String action=WSHandlerConstants.TIMESTAMP + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
  Properties properties=new Properties();
  properties.setProperty(WSHandlerConstants.SIGNATURE_PARTS,"{Element}{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp;{Element}{http://www.w3.org/2003/05/soap-envelope}Body;");
  Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  javax.xml.transform.Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  properties.setProperty(WSHandlerConstants.ACTOR,"test");
  securedDocument=doOutboundSecurityWithWSS4J(new ByteArrayInputStream(baos.toByteArray()),action,properties);
  transformer=TRANSFORMER_FACTORY.newTransformer();
  baos.reset();
  transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setActor("test");
  securityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())));
  transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilitySOAPActionInbound() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  String action=WSHandlerConstants.TIMESTAMP + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
  Properties properties=new Properties();
  properties.setProperty(WSHandlerConstants.SIGNATURE_PARTS,"{Element}{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp;{Element}{http://schemas.xmlsoap.org/soap/envelope/}Body;");
  properties.setProperty(WSHandlerConstants.ACTOR,"test");
  Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  javax.xml.transform.Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setActor("test");
  securityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.SignatureValue,WSSecurityEventConstants.TIMESTAMP,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.SIGNED_PART,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
  final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
  Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
  transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
  securityEventListener.compare();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilityInvalidSOAPActionInbound() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
  String action=WSHandlerConstants.TIMESTAMP + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
  Properties properties=new Properties();
  properties.setProperty(WSHandlerConstants.SIGNATURE_PARTS,"{Element}{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp;{Element}{http://schemas.xmlsoap.org/soap/envelope/}Body;");
  properties.setProperty(WSHandlerConstants.ACTOR,"test");
  Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  javax.xml.transform.Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.setActor("anotherTest");
  securityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.NO_SECURITY,WSSecurityEventConstants.OPERATION};
  final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
  Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
  transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
  securityEventListener.compare();
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInteroperabilityInboundSOAP12() throws Exception {
  InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.2.xml");
  String action=WSHandlerConstants.TIMESTAMP + " " + WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
  Properties properties=new Properties();
  properties.setProperty(WSHandlerConstants.SIGNATURE_PARTS,"{Element}{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp;{Element}{http://www.w3.org/2003/05/soap-envelope}Body;");
  Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  javax.xml.transform.Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  securityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.SignatureValue,WSSecurityEventConstants.TIMESTAMP,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.SIGNED_PART,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
  final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
  Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
  transformer=TRANSFORMER_FACTORY.newTransformer();
  transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
    @Override public void write(    int b) throws IOException {
    }
  }
));
  securityEventListener.compare();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.MultipleActionTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test @org.junit.Ignore public void testTwoEncryptionActions() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUser("transmitter");
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    OutboundWSSec wsSecOut=WSSec.getOutboundWSSec(securityProperties);
    XMLStreamWriter xmlStreamWriter=wsSecOut.processOutMessage(baos,StandardCharsets.UTF_8.name(),new ArrayList<SecurityEvent>());
    XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml"));
    XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
    xmlStreamWriter.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.SecurityContextTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSCTKDKTSignAbsoluteInbound() throws Exception {
  byte[] tempSecret=WSSecurityUtil.generateNonce(16);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
    WSSecHeader secHeader=new WSSecHeader(doc);
    secHeader.insertSecurityHeader();
    WSSecSecurityContextToken sctBuilder=new WSSecSecurityContextToken();
    sctBuilder.setWscVersion(version);
    Crypto crypto=CryptoFactory.getInstance("transmitter-crypto.properties");
    sctBuilder.prepare(doc,crypto);
    SecretKeyCallbackHandler callbackHandler=new SecretKeyCallbackHandler();
    callbackHandler.addSecretKey(sctBuilder.getIdentifier(),tempSecret);
    WSSecDKSign sigBuilder=new WSSecDKSign();
    sigBuilder.setWscVersion(version);
    sigBuilder.setExternalKey(tempSecret,sctBuilder.getIdentifier());
    sigBuilder.setTokenIdDirectId(true);
    sigBuilder.setSignatureAlgorithm(WSConstants.HMAC_SHA1);
    sigBuilder.build(doc,secHeader);
    sctBuilder.prependSCTElementToHeader(doc,secHeader);
    javax.xml.transform.Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(doc),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    CallbackHandlerImpl callbackHandler=new CallbackHandlerImpl(tempSecret);
    securityProperties.setCallbackHandler(callbackHandler);
    securityProperties.addIgnoreBSPRule(BSPRule.R5204);
    InboundWSSec wsSecIn=WSSec.getInboundWSSec(securityProperties);
    XMLStreamReader xmlStreamReader=wsSecIn.processInMessage(xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())));
    StAX2DOM.readDoc(documentBuilderFactory.newDocumentBuilder(),xmlStreamReader);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.SignatureEncryptionTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEncryptionSymmetricOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    actions.add(WSSConstants.TIMESTAMP);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUser("receiver");
    OutboundWSSec wsSecOut=WSSec.getOutboundWSSec(securityProperties);
    String keyAlgorithm=JCEAlgorithmMapper.getJCEKeyAlgorithmFromURI(WSSConstants.NS_XENC_AES128);
    KeyGenerator keyGen;
    try {
      keyGen=KeyGenerator.getInstance(keyAlgorithm);
    }
 catch (    NoSuchAlgorithmException e) {
      throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE,e);
    }
    int keyLength=JCEAlgorithmMapper.getKeyLengthFromURI(WSSConstants.NS_XENC_AES128);
    keyGen.init(keyLength);
    final Key symmetricKey=keyGen.generateKey();
    final String ekId=IDGenerator.generateID(null);
    final GenericOutboundSecurityToken encryptedKeySecurityToken=new GenericOutboundSecurityToken(ekId,WSSecurityTokenConstants.EncryptedKeyToken,symmetricKey);
    final SecurityTokenProvider<OutboundSecurityToken> encryptedKeySecurityTokenProvider=new SecurityTokenProvider<OutboundSecurityToken>(){
      @Override public OutboundSecurityToken getSecurityToken() throws XMLSecurityException {
        return encryptedKeySecurityToken;
      }
      @Override public String getId(){
        return ekId;
      }
    }
;
    final OutboundSecurityContextImpl outboundSecurityContext=new OutboundSecurityContextImpl();
    outboundSecurityContext.putList(SecurityEvent.class,new ArrayList<SecurityEvent>());
    outboundSecurityContext.registerSecurityTokenProvider(encryptedKeySecurityTokenProvider.getId(),encryptedKeySecurityTokenProvider);
    outboundSecurityContext.put(WSSConstants.PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTION,encryptedKeySecurityTokenProvider.getId());
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=new ByteArrayOutputStream();
    XMLStreamWriter xmlStreamWriter=wsSecOut.processOutMessage(baos,StandardCharsets.UTF_8.name(),outboundSecurityContext);
    XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(sourceDocument);
    XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
    xmlStreamWriter.close();
    documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
  }
{
    String action=WSHandlerConstants.ENCRYPT + " " + WSHandlerConstants.TIMESTAMP;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSignatureEncryptionOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.SIGNATURE);
    actions.add(WSSConstants.ENCRYPT);
    actions.add(WSSConstants.TIMESTAMP);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUser("receiver");
    securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setSignatureUser("transmitter");
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    securityProperties.addSignaturePart(new SecurePart(new QName(WSSConstants.NS_WSU10,"Timestamp"),SecurePart.Modifier.Element));
    securityProperties.addSignaturePart(new SecurePart(new QName(WSSConstants.NS_SOAP11,"Body"),SecurePart.Modifier.Element));
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
  }
{
    String action=WSHandlerConstants.SIGNATURE + " " + WSHandlerConstants.ENCRYPT+ " "+ WSHandlerConstants.TIMESTAMP;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.UsernameTokenTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is a test for processing a UsernameToken where the "Created" element is in the (near)
 * future. It should be accepted by default when it is created 30 seconds in the future.
 */
@Test public void testNearFutureCreated() throws Exception {
  GregorianCalendar createdCalendar=new GregorianCalendar();
  createdCalendar.add(Calendar.SECOND,30);
  XMLGregorianCalendar created=WSSConstants.datatypeFactory.newXMLGregorianCalendar(createdCalendar);
  String createdString=created.toXMLFormat();
  String digest=org.apache.wss4j.dom.message.token.UsernameToken.doPasswordDigest("Ex2YEKVvSa1qne1m6TM8XA==",createdString,"default");
  String req="<?xml version=\"1.0\" encoding=\"UTF_8\"?>" + "<env:Envelope xmlns:env=\"http://schemas.xmlsoap.org/soap/envelope/\">\n" + "    <env:Header>"+ "       <wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" env:mustUnderstand=\"1\">"+ "           <wsse:UsernameToken wsu:Id=\"UsernameToken-1\">"+ "               <wsse:Username>transmitter</wsse:Username>"+ "               <wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest\">" + digest + "</wsse:Password>"+ "               <wsse:Nonce EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\">Ex2YEKVvSa1qne1m6TM8XA==</wsse:Nonce>"+ "               <wsu:Created>"+ createdString+ "</wsu:Created>"+ "           </wsse:UsernameToken>"+ "       </wsse:Security>\n"+ "    </env:Header>\n"+ "    <env:Body>\n"+ "    </env:Body>\n"+ "</env:Envelope>";
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  securityProperties.setCallbackHandler(new CallbackHandlerImpl());
  InboundWSSec wsSecIn=WSSec.getInboundWSSec(securityProperties);
  XMLStreamReader xmlStreamReader=wsSecIn.processInMessage(xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(req.getBytes())));
  StAX2DOM.readDoc(documentBuilderFactory.newDocumentBuilder(),xmlStreamReader);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.saml.SamlAuthnTest </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2FutureAuthnInstant() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML2Constants.CONF_HOLDER_KEY);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setAuthenticationInstant(new DateTime().plusMinutes(70));
  createDOMMessageAndVerifyStAX(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML1AuthnAssertion() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML1Constants.CONF_HOLDER_KEY);
  callbackHandler.setIssuer("www.example.com");
  createDOMMessageAndVerifyStAX(callbackHandler,true);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2ValidSubjectLocality() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML2Constants.CONF_HOLDER_KEY);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSubjectLocality(IP_ADDRESS,"xyz.ws.apache.org");
  createDOMMessageAndVerifyStAX(callbackHandler,true);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2StaleSessionNotOnOrAfter() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML2Constants.CONF_HOLDER_KEY);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSessionNotOnOrAfter(new DateTime().minusMinutes(70));
  createDOMMessageAndVerifyStAX(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML1FutureAuthnInstant() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML1Constants.CONF_HOLDER_KEY);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setAuthenticationInstant(new DateTime().plusMinutes(70));
  createDOMMessageAndVerifyStAX(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML1InvalidSubjectLocality() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML1Constants.CONF_HOLDER_KEY);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSubjectLocality("xyz.ws.apache.org","xyz.ws.apache.org");
  createDOMMessageAndVerifyStAX(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2InvalidSubjectLocality() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML2Constants.CONF_HOLDER_KEY);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSubjectLocality("xyz.ws.apache.org","xyz.ws.apache.org");
  createDOMMessageAndVerifyStAX(callbackHandler,false);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML2AuthnAssertion() throws Exception {
  SAML2CallbackHandler callbackHandler=new SAML2CallbackHandler();
  callbackHandler.setStatement(SAML2CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML2Constants.CONF_HOLDER_KEY);
  callbackHandler.setIssuer("www.example.com");
  createDOMMessageAndVerifyStAX(callbackHandler,true);
}

</code></pre>

<br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSAML1ValidSubjectLocality() throws Exception {
  SAML1CallbackHandler callbackHandler=new SAML1CallbackHandler();
  callbackHandler.setStatement(SAML1CallbackHandler.Statement.AUTHN);
  callbackHandler.setConfirmationMethod(SAML1Constants.CONF_HOLDER_KEY);
  callbackHandler.setIssuer("www.example.com");
  callbackHandler.setSubjectLocality(IP_ADDRESS,"xyz.ws.apache.org");
  createDOMMessageAndVerifyStAX(callbackHandler,true);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
