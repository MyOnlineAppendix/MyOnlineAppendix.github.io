<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.wss4j.stax.test.EncDecryptionTest </h4><pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPartsContentInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Properties properties=new Properties();
    properties.setProperty(WSHandlerConstants.ENCRYPTION_PARTS,"{Content}{http://www.w3.org/1999/XMLSchema}simpleType;");
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
    NodeList nodeList=securedDocument.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.X509Token,WSSecurityEventConstants.OPERATION,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ContentEncrypted) {
        ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=(ContentEncryptedElementSecurityEvent)securityEvent;
        Assert.assertNotNull(contentEncryptedElementSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(contentEncryptedElementSecurityEvent.getSecurityToken());
        Assert.assertNotNull(contentEncryptedElementSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://www.w3.org/1999/XMLSchema","simpleType");
        Assert.assertEquals(contentEncryptedElementSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(contentEncryptedElementSecurityEvent.getElementPath().size(),6);
        Assert.assertEquals(contentEncryptedElementSecurityEvent.getElementPath().get(contentEncryptedElementSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    List<ContentEncryptedElementSecurityEvent> contentEncryptedElementSecurityEventList=securityEventListener.getSecurityEvents(SecurityEventConstants.ContentEncrypted);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID1=contentEncryptedElementSecurityEventList.get(0).getCorrelationID();
    String encryptedPartCorrelationID2=contentEncryptedElementSecurityEventList.get(1).getCorrelationID();
    String encryptedPartCorrelationID3=contentEncryptedElementSecurityEventList.get(2).getCorrelationID();
    String encryptedPartCorrelationID4=contentEncryptedElementSecurityEventList.get(3).getCorrelationID();
    String encryptedPartCorrelationID5=contentEncryptedElementSecurityEventList.get(4).getCorrelationID();
    String encryptedPartCorrelationID6=contentEncryptedElementSecurityEventList.get(5).getCorrelationID();
    String encryptedPartCorrelationID7=contentEncryptedElementSecurityEventList.get(6).getCorrelationID();
    String encryptedPartCorrelationID8=contentEncryptedElementSecurityEventList.get(7).getCorrelationID();
    String encryptedPartCorrelationID9=contentEncryptedElementSecurityEventList.get(8).getCorrelationID();
    String encryptedPartCorrelationID10=contentEncryptedElementSecurityEventList.get(9).getCorrelationID();
    String encryptedPartCorrelationID11=contentEncryptedElementSecurityEventList.get(10).getCorrelationID();
    String encryptedPartCorrelationID12=contentEncryptedElementSecurityEventList.get(11).getCorrelationID();
    String encryptedPartCorrelationID13=contentEncryptedElementSecurityEventList.get(12).getCorrelationID();
    String encryptedPartCorrelationID14=contentEncryptedElementSecurityEventList.get(13).getCorrelationID();
    String encryptedPartCorrelationID15=contentEncryptedElementSecurityEventList.get(14).getCorrelationID();
    String encryptedPartCorrelationID16=contentEncryptedElementSecurityEventList.get(15).getCorrelationID();
    String encryptedPartCorrelationID17=contentEncryptedElementSecurityEventList.get(16).getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents1=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents2=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents3=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents4=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents5=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents6=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents7=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents8=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents9=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents10=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents11=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents12=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents13=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents14=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents15=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents16=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents17=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID1)) {
        encryptedPartSecurityEvents1.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID2)) {
        encryptedPartSecurityEvents2.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID3)) {
        encryptedPartSecurityEvents3.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID4)) {
        encryptedPartSecurityEvents4.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID5)) {
        encryptedPartSecurityEvents5.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID6)) {
        encryptedPartSecurityEvents6.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID7)) {
        encryptedPartSecurityEvents7.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID8)) {
        encryptedPartSecurityEvents8.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID9)) {
        encryptedPartSecurityEvents9.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID10)) {
        encryptedPartSecurityEvents10.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID11)) {
        encryptedPartSecurityEvents11.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID12)) {
        encryptedPartSecurityEvents12.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID13)) {
        encryptedPartSecurityEvents13.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID14)) {
        encryptedPartSecurityEvents14.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID15)) {
        encryptedPartSecurityEvents15.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID16)) {
        encryptedPartSecurityEvents16.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID17)) {
        encryptedPartSecurityEvents17.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents1.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents2.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents3.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents4.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents5.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents6.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents7.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents8.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents9.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents10.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents11.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents12.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents13.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents14.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents15.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents16.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents17.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents1.size() + encryptedPartSecurityEvents2.size()+ encryptedPartSecurityEvents3.size()+ encryptedPartSecurityEvents4.size()+ encryptedPartSecurityEvents5.size()+ encryptedPartSecurityEvents6.size()+ encryptedPartSecurityEvents7.size()+ encryptedPartSecurityEvents8.size()+ encryptedPartSecurityEvents9.size()+ encryptedPartSecurityEvents10.size()+ encryptedPartSecurityEvents11.size()+ encryptedPartSecurityEvents12.size()+ encryptedPartSecurityEvents13.size()+ encryptedPartSecurityEvents14.size()+ encryptedPartSecurityEvents15.size()+ encryptedPartSecurityEvents16.size()+ encryptedPartSecurityEvents17.size()+ 1);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionUseThisCert() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    KeyStore keyStore=KeyStore.getInstance("jks");
    keyStore.load(this.getClass().getClassLoader().getResourceAsStream("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUseThisCertificate((X509Certificate)keyStore.getCertificate("receiver"));
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),"Body");
    NodeList childNodes=nodeList.item(0).getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new org.apache.wss4j.stax.test.CallbackHandlerImpl());
    Document document=doInboundSecurity(securityProperties,new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * rsa-oaep, Digest:SHA384, MGF:SHA1, PSource: None
 */
@Test public void testKeyWrappingRSAOAEPAES192GCMSHA384MGF1sha384Outbound() throws Exception {
  try {
    Security.addProvider(new BouncyCastleProvider());
    ByteArrayOutputStream baos;
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
      actions.add(WSSConstants.ENCRYPT);
      securityProperties.setActions(actions);
      securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.setEncryptionUser("receiver");
      securityProperties.setEncryptionSymAlgorithm("http://www.w3.org/2009/xmlenc11#aes192-gcm");
      securityProperties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2009/xmlenc11#rsa-oaep");
      securityProperties.setEncryptionKeyTransportDigestAlgorithm("http://www.w3.org/2001/04/xmldsig-more#sha384");
      securityProperties.setEncryptionKeyTransportMGFAlgorithm("http://www.w3.org/2009/xmlenc11#mgf1sha384");
      InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
      baos=doOutboundSecurity(securityProperties,sourceDocument);
      Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
      NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
      XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#rsa-oaep']");
      Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/dsig:DigestMethod[@Algorithm='http://www.w3.org/2001/04/xmldsig-more#sha384']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/xenc11:MGF[@Algorithm='http://www.w3.org/2009/xmlenc11#mgf1sha384']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#aes192-gcm']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
      NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
      for (int i=0; i < childNodes.getLength(); i++) {
        Node child=childNodes.item(i);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(0));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
{
      String action=WSHandlerConstants.ENCRYPT;
      doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
    }
  }
  finally {
    Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionCryptoPropertiesInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,new Properties());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(securedDocument,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    Properties properties=CryptoFactory.getProperties("receiver-crypto.properties",this.getClass().getClassLoader());
    securityProperties.setDecryptionCryptoProperties(properties);
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://schemas.xmlsoap.org/soap/envelope/","Body");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),2);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionCryptoPropertiesOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    Properties properties=CryptoFactory.getProperties("transmitter-crypto.properties",this.getClass().getClassLoader());
    securityProperties.setEncryptionCryptoProperties(properties);
    securityProperties.setEncryptionUser("receiver");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPartsContentOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUser("receiver");
    securityProperties.addEncryptionPart(new SecurePart(new QName("http://www.w3.org/1999/XMLSchema","complexType"),SecurePart.Modifier.Content));
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),25);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),25);
    for (int i=0; i < nodeList.getLength(); i++) {
      Assert.assertEquals(nodeList.item(i).getParentNode().getLocalName(),"complexType");
      Assert.assertEquals(nodeList.item(i).getParentNode().getNamespaceURI(),"http://www.w3.org/1999/XMLSchema");
      NodeList childNodes=nodeList.item(i).getParentNode().getChildNodes();
      for (int j=0; j < childNodes.getLength(); j++) {
        Node child=childNodes.item(j);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(i));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * rsa-oaep-mgf1p, Digest:SHA256, MGF:SHA1, PSource: None
 */
@Test public void testKeyWrappingRSAOAEPMGF1AESGCM128Outbound() throws Exception {
  try {
    Security.addProvider(new BouncyCastleProvider());
    ByteArrayOutputStream baos;
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
      actions.add(WSSConstants.ENCRYPT);
      securityProperties.setActions(actions);
      securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.setEncryptionUser("receiver");
      securityProperties.setEncryptionSymAlgorithm("http://www.w3.org/2009/xmlenc11#aes128-gcm");
      securityProperties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p");
      InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
      baos=doOutboundSecurity(securityProperties,sourceDocument);
      Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
      NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
      XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
      Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#aes128-gcm']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
      NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
      for (int i=0; i < childNodes.getLength(); i++) {
        Node child=childNodes.item(i);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(0));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
{
      String action=WSHandlerConstants.ENCRYPT;
      doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
    }
  }
  finally {
    Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testCompressedEncDecryption() throws Exception {
  Init.init(WSSec.class.getClassLoader().getResource("wss/wss-config.xml").toURI(),WSSec.class);
  Field algorithmsClassMapField=TransformerAlgorithmMapper.class.getDeclaredField("algorithmsClassMapOut");
  algorithmsClassMapField.setAccessible(true);
  Map<String,Class<?>> map=(Map<String,Class<?>>)algorithmsClassMapField.get(null);
  map.put("http://www.apache.org/2012/04/xmlsec/gzip",GzipCompressorOutputStream.class);
  algorithmsClassMapField=TransformerAlgorithmMapper.class.getDeclaredField("algorithmsClassMapIn");
  algorithmsClassMapField.setAccessible(true);
  map=(Map<String,Class<?>>)algorithmsClassMapField.get(null);
  map.put("http://www.apache.org/2012/04/xmlsec/gzip",GzipCompressorInputStream.class);
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUser("receiver");
    securityProperties.setEncryptionCompressionAlgorithm("http://www.apache.org/2012/04/xmlsec/gzip");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://schemas.xmlsoap.org/soap/envelope/","Body");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),2);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPropertiesOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    Map<String,Object> config=new HashMap<String,Object>();
    config.put(ConfigurationConstants.ACTION,ConfigurationConstants.ENCRYPT);
    config.put(ConfigurationConstants.ENCRYPTION_USER,"receiver");
    config.put(ConfigurationConstants.ENC_PROP_FILE,"transmitter-crypto.properties");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(config,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * rsa-oaep, Digest:SHA512, MGF:SHA1, PSource: Specified 8 bytes
 */
@Test public void testKeyWrappingRSAOAEPAESGCM192SHA384MGF1SHA384PSourceOutbound() throws Exception {
  try {
    Security.addProvider(new BouncyCastleProvider());
    ByteArrayOutputStream baos;
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
      actions.add(WSSConstants.ENCRYPT);
      securityProperties.setActions(actions);
      securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.setEncryptionUser("receiver");
      securityProperties.setEncryptionSymAlgorithm("http://www.w3.org/2009/xmlenc11#aes192-gcm");
      securityProperties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2009/xmlenc11#rsa-oaep");
      securityProperties.setEncryptionKeyTransportDigestAlgorithm("http://www.w3.org/2001/04/xmldsig-more#sha384");
      securityProperties.setEncryptionKeyTransportMGFAlgorithm("http://www.w3.org/2009/xmlenc11#mgf1sha384");
      securityProperties.setEncryptionKeyTransportOAEPParams(Base64.decode("ZHVtbXkxMjM=".getBytes(StandardCharsets.UTF_8)));
      InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
      baos=doOutboundSecurity(securityProperties,sourceDocument);
      Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
      NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
      XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#rsa-oaep']");
      Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/xenc:OAEPparams");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/dsig:DigestMethod[@Algorithm='http://www.w3.org/2001/04/xmldsig-more#sha384']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/xenc11:MGF[@Algorithm='http://www.w3.org/2009/xmlenc11#mgf1sha384']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#aes192-gcm']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
      NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
      for (int i=0; i < childNodes.getLength(); i++) {
        Node child=childNodes.item(i);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(0));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
{
      String action=WSHandlerConstants.ENCRYPT;
      doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
    }
  }
  finally {
    Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPartsHeaderInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-encryptedHeader.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Properties properties=new Properties();
    properties.setProperty(WSHandlerConstants.ENCRYPTION_PARTS,"{Header}{http://www.example.com}testEncryptedHeader;");
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
    NodeList nodeList=securedDocument.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new org.apache.wss4j.stax.test.CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_wsse11_EncryptedHeader.getNamespaceURI(),WSSConstants.TAG_wsse11_EncryptedHeader.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://www.example.com","testEncryptedHeader");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),3);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPartsElementInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Properties properties=new Properties();
    properties.setProperty(WSHandlerConstants.ENCRYPTION_PARTS,"{Element}{http://www.w3.org/1999/XMLSchema}simpleType;");
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
    NodeList nodeList=securedDocument.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new org.apache.wss4j.stax.test.CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.X509Token,WSSecurityEventConstants.OPERATION,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.EncryptedElement) {
        EncryptedElementSecurityEvent encryptedElementSecurityEvent=(EncryptedElementSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedElementSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedElementSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedElementSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://www.w3.org/1999/XMLSchema","simpleType");
        Assert.assertEquals(encryptedElementSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedElementSecurityEvent.getElementPath().size(),6);
        Assert.assertEquals(encryptedElementSecurityEvent.getElementPath().get(encryptedElementSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * rsa-oaep-mgf1p, Digest:SHA256, MGF:SHA1, PSource: None
 */
@Test public void testKeyWrappingRSAOAEPAESGCM192SHA256Outbound() throws Exception {
  try {
    Security.addProvider(new BouncyCastleProvider());
    ByteArrayOutputStream baos;
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
      actions.add(WSSConstants.ENCRYPT);
      securityProperties.setActions(actions);
      securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.setEncryptionUser("receiver");
      securityProperties.setEncryptionSymAlgorithm("http://www.w3.org/2009/xmlenc11#aes192-gcm");
      securityProperties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p");
      securityProperties.setEncryptionKeyTransportDigestAlgorithm("http://www.w3.org/2001/04/xmlenc#sha256");
      InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
      baos=doOutboundSecurity(securityProperties,sourceDocument);
      Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
      NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
      XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
      Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/dsig:DigestMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#sha256']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#aes192-gcm']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
      NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
      for (int i=0; i < childNodes.getLength(); i++) {
        Node child=childNodes.item(i);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(0));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
{
      String action=WSHandlerConstants.ENCRYPT;
      doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
    }
  }
  finally {
    Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionDefaultConfigurationOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUser("receiver");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionDefaultConfigurationInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,new Properties());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(securedDocument,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://schemas.xmlsoap.org/soap/envelope/","Body");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),2);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPropertiesInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,new Properties());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(securedDocument,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    Map<String,Object> config=new HashMap<String,Object>();
    config.put(ConfigurationConstants.ACTION,ConfigurationConstants.ENCRYPT);
    config.put(ConfigurationConstants.DEC_PROP_FILE,"receiver-crypto.properties");
    config.put(ConfigurationConstants.PW_CALLBACK_REF,new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    WSSSecurityProperties securityProperties=ConfigurationConverter.convert(config);
    InboundWSSec wsSecIn=WSSec.getInboundWSSec(securityProperties);
    XMLStreamReader outXmlStreamReader=wsSecIn.processInMessage(xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),new ArrayList<SecurityEvent>(),securityEventListener);
    Document document=StAX2DOM.readDoc(documentBuilderFactory.newDocumentBuilder(),outXmlStreamReader);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://schemas.xmlsoap.org/soap/envelope/","Body");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),2);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.EncryptionCRLTest </h4><pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptionWithOutRevocationCheck() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("wss40rev.jks"),"security".toCharArray());
    securityProperties.setEncryptionUser("wss40rev");
    securityProperties.setEncryptionKeyIdentifier(WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.InboundWSSecurityContextImplTest </h4><pre class="type-3 type-11 type-15 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenIdentificationTransportSecurity() throws Exception {
  final List<SecurityEvent> securityEventList=generateTransportBindingSecurityEvents();
  Assert.assertEquals(securityEventList.size(),11);
  for (int i=0; i < securityEventList.size(); i++) {
    SecurityEvent securityEvent=securityEventList.get(i);
    if (securityEvent instanceof HttpsTokenSecurityEvent) {
      HttpsTokenSecurityEvent tokenSecurityEvent=(HttpsTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),2);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE));
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION));
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent) {
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENDORSING_ENCRYPTED_SUPPORTING_TOKENS));
    }
 else     if (securityEvent instanceof UsernameTokenSecurityEvent) {
      UsernameTokenSecurityEvent tokenSecurityEvent=(UsernameTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENCRYPTED_SUPPORTING_TOKENS));
    }
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenIdentificationAsymmetricSecurity() throws Exception {
  final List<SecurityEvent> securityEventList=generateAsymmetricBindingSecurityEvents();
  boolean mainSignatureTokenOccured=false;
  boolean signedEndorsingSupportingTokenOccured=false;
  boolean signedEndorsingEncryptedSupportingTokenOccured=false;
  boolean supportingTokensOccured=false;
  boolean encryptedSupportingTokensOccured=false;
  boolean mainEncryptionTokenOccured=false;
  boolean usernameTokenOccured=false;
  Assert.assertEquals(securityEventList.size(),34);
  int x509TokenIndex=0;
  for (int i=0; i < securityEventList.size(); i++) {
    SecurityEvent securityEvent=securityEventList.get(i);
    if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 0) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION));
      mainEncryptionTokenOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 1) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_ENCRYPTED_SUPPORTING_TOKENS));
      signedEndorsingSupportingTokenOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 2) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS));
      encryptedSupportingTokensOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 3) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE));
      supportingTokensOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 4) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENDORSING_SUPPORTING_TOKENS));
      signedEndorsingEncryptedSupportingTokenOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 5) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENDORSING_ENCRYPTED_SUPPORTING_TOKENS));
      mainSignatureTokenOccured=true;
    }
 else     if (securityEvent instanceof UsernameTokenSecurityEvent) {
      UsernameTokenSecurityEvent tokenSecurityEvent=(UsernameTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENCRYPTED_SUPPORTING_TOKENS));
      usernameTokenOccured=true;
    }
  }
  Assert.assertTrue(mainSignatureTokenOccured);
  Assert.assertTrue(mainEncryptionTokenOccured);
  Assert.assertTrue(signedEndorsingSupportingTokenOccured);
  Assert.assertTrue(signedEndorsingEncryptedSupportingTokenOccured);
  Assert.assertTrue(supportingTokensOccured);
  Assert.assertTrue(encryptedSupportingTokensOccured);
  Assert.assertTrue(usernameTokenOccured);
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenIdentificationSymmetricSecurity() throws Exception {
  final List<SecurityEvent> securityEventList=generateSymmetricBindingSecurityEvents();
  Assert.assertEquals(securityEventList.size(),24);
  for (int i=0; i < securityEventList.size(); i++) {
    SecurityEvent securityEvent=securityEventList.get(i);
    if (securityEvent instanceof X509TokenSecurityEvent) {
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENDORSING_SUPPORTING_TOKENS));
    }
 else     if (securityEvent instanceof UsernameTokenSecurityEvent) {
      UsernameTokenSecurityEvent tokenSecurityEvent=(UsernameTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENCRYPTED_SUPPORTING_TOKENS));
    }
 else     if (securityEvent instanceof SamlTokenSecurityEvent) {
      SamlTokenSecurityEvent tokenSecurityEvent=(SamlTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),2);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE));
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.OutputChainTest </h4><pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptionAction() throws Exception {
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
  actions.add(WSSConstants.ENCRYPT);
  securityProperties.setActions(actions);
  securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  securityProperties.setEncryptionUser("receiver");
  OutboundWSSec wsSecOut=WSSec.getOutboundWSSec(securityProperties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=wsSecOut.processOutMessage(baos,StandardCharsets.UTF_8.name(),new ArrayList<SecurityEvent>());
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml"));
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
  Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
  nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),"Body");
  NodeList childNodes=nodeList.item(0).getParentNode().getChildNodes();
  for (int i=0; i < childNodes.getLength(); i++) {
    Node child=childNodes.item(i);
    if (child.getNodeType() == Node.TEXT_NODE) {
      Assert.assertEquals(child.getTextContent().trim(),"");
    }
 else     if (child.getNodeType() == Node.ELEMENT_NODE) {
      Assert.assertEquals(child,nodeList.item(0));
    }
 else {
      Assert.fail("Unexpected Node encountered");
    }
  }
  nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Signature.getNamespaceURI(),WSSConstants.TAG_dsig_Signature.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_WSU_TIMESTAMP.getNamespaceURI(),WSSConstants.TAG_WSU_TIMESTAMP.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.PasswordEncryptorTest </h4><pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionCryptoPropertiesOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    Properties properties=CryptoFactory.getProperties("transmitter-crypto-enc.properties",this.getClass().getClassLoader());
    PasswordEncryptor passwordEncryptor=new JasyptPasswordEncryptor(new CallbackHandlerImpl());
    securityProperties.setEncryptionCryptoProperties(properties,passwordEncryptor);
    securityProperties.setEncryptionUser("receiver");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.SignatureTest </h4><pre class="type-3 type-11 type-15 type-7 type-5 type-9 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignatureC14NInclusivePartsOutbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.SIGNATURE);
    securityProperties.setActions(actions);
    securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setSignatureUser("transmitter");
    securityProperties.addSignaturePart(new SecurePart(new QName("http://www.w3.org/1999/XMLSchema","complexType"),SecurePart.Modifier.Element));
    securityProperties.setSignatureCanonicalizationAlgorithm("http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments");
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    OutboundWSSec wsSecOut=WSSec.getOutboundWSSec(securityProperties);
    XMLStreamWriter xmlStreamWriter=wsSecOut.processOutMessage(baos,StandardCharsets.UTF_8.name(),new ArrayList<SecurityEvent>());
    XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml"));
    XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
    xmlStreamWriter.close();
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Signature.getNamespaceURI(),WSSConstants.TAG_dsig_Signature.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Reference.getNamespaceURI(),WSSConstants.TAG_dsig_Reference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),25);
    nodeList=document.getElementsByTagNameNS("http://www.w3.org/1999/XMLSchema","complexType");
    Assert.assertEquals(nodeList.getLength(),26);
    for (int i=0; i < nodeList.getLength(); i++) {
      String idAttrValue=((Element)nodeList.item(i)).getAttributeNS(WSSConstants.ATT_WSU_ID.getNamespaceURI(),WSSConstants.ATT_WSU_ID.getLocalPart());
      if (i == 10) {
        Assert.assertSame(idAttrValue,"");
      }
 else {
        Assert.assertNotSame(idAttrValue,"");
        Assert.assertTrue(idAttrValue.length() > 0);
      }
    }
  }
{
    String action=WSHandlerConstants.SIGNATURE;
    Properties properties=new Properties();
    doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action,properties,false);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-7 type-5 type-9 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignaturePartsOutbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.SIGNATURE);
    securityProperties.setActions(actions);
    securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setSignatureUser("transmitter");
    securityProperties.addSignaturePart(new SecurePart(new QName("http://www.w3.org/1999/XMLSchema","complexType"),SecurePart.Modifier.Element));
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    OutboundWSSec wsSecOut=WSSec.getOutboundWSSec(securityProperties);
    XMLStreamWriter xmlStreamWriter=wsSecOut.processOutMessage(baos,StandardCharsets.UTF_8.name(),new ArrayList<SecurityEvent>());
    XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml"));
    XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
    xmlStreamWriter.close();
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Signature.getNamespaceURI(),WSSConstants.TAG_dsig_Signature.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Reference.getNamespaceURI(),WSSConstants.TAG_dsig_Reference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),25);
    nodeList=document.getElementsByTagNameNS("http://www.w3.org/1999/XMLSchema","complexType");
    Assert.assertEquals(nodeList.getLength(),26);
    for (int i=0; i < nodeList.getLength(); i++) {
      String idAttrValue=((Element)nodeList.item(i)).getAttributeNS(WSSConstants.ATT_WSU_ID.getNamespaceURI(),WSSConstants.ATT_WSU_ID.getLocalPart());
      if (i == 10) {
        Assert.assertSame(idAttrValue,"");
      }
 else {
        Assert.assertNotSame(idAttrValue,"");
        Assert.assertTrue(idAttrValue.length() > 0);
      }
    }
  }
{
    String action=WSHandlerConstants.SIGNATURE;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
