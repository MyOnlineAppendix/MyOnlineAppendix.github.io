<h3><span class=" glyphicon glyphicon-tag"/>&nbspIterativeVerifier</h3><kbd>Verifies assertions in iterations</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.wss4j.dom.message.UTDerivedKeyTest </h4><pre class="type-3 type-11 type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Unit test for the UsernameToken derived key functionality
 */
@Test public void testUsernameTokenUnit() throws Exception {
  Document doc=SOAPUtil.toSOAPPart(SOAPUtil.SAMPLE_SOAP_MSG);
  WSSecHeader secHeader=new WSSecHeader(doc);
  secHeader.insertSecurityHeader();
  UsernameToken usernameToken=new UsernameToken(true,doc,null);
  usernameToken.setName("bob");
  byte[] salt=usernameToken.addSalt(doc,null,false);
  assertTrue(salt.length == 16);
  assertTrue(salt[0] == 0x02);
  byte[] utSalt=usernameToken.getSalt();
  assertTrue(salt.length == utSalt.length);
  for (int i=0; i < salt.length; i++) {
    assertTrue(salt[i] == utSalt[i]);
  }
  usernameToken.addIteration(doc,500);
  assertTrue(usernameToken.getIteration() == 500);
  WSSecurityUtil.prependChildElement(secHeader.getSecurityHeader(),usernameToken.getElement());
  String outputString=XMLUtils.prettyDocumentToString(doc);
  assertTrue(outputString.contains("wsse:Username"));
  assertFalse(outputString.contains("wsse:Password"));
  assertTrue(outputString.contains("wsse11:Salt"));
  assertTrue(outputString.contains("wsse11:Iteration"));
  byte[] derivedKey=UsernameTokenUtil.generateDerivedKey("security",salt,500);
  assertTrue(derivedKey.length == 20);
  derivedKey=UsernameTokenUtil.generateDerivedKey(Base64.decode("c2VjdXJpdHk="),salt,500);
  assertTrue(derivedKey.length == 20);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.AlgorithmSuiteTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlgorithmSuite() throws Exception {
  String fileName="AlgorithmSuite.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof AlgorithmSuite);
    AlgorithmSuite algorithmSuite=(AlgorithmSuite)alternative.get(0);
    assertFalse(algorithmSuite.isNormalized());
    assertTrue(algorithmSuite.isIgnorable());
    assertTrue(algorithmSuite.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,algorithmSuite.getType());
    assertEquals(SP12Constants.ALGORITHM_SUITE,algorithmSuite.getName());
    assertEquals(algorithmSuite.getAlgorithmSuiteType().getEncryption(),SPConstants.TRIPLE_DES);
    assertEquals(AlgorithmSuite.C14NType.InclusiveC14N,algorithmSuite.getC14n());
    assertEquals(AlgorithmSuite.SOAPNormType.SOAPNormalization10,algorithmSuite.getSoapNormType());
    assertEquals(AlgorithmSuite.STRType.STRTransform10,algorithmSuite.getStrType());
    assertEquals(AlgorithmSuite.XPathType.AbsXPath,algorithmSuite.getXPathType());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  AlgorithmSuite algorithmSuite=(AlgorithmSuite)policyComponentIterator.next();
  assertTrue(algorithmSuite.isNormalized());
  assertTrue(algorithmSuite.isIgnorable());
  assertFalse(algorithmSuite.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,algorithmSuite.getType());
  assertEquals(SP12Constants.ALGORITHM_SUITE,algorithmSuite.getName());
  assertEquals(algorithmSuite.getAlgorithmSuiteType().getEncryption(),SPConstants.TRIPLE_DES);
  assertEquals(AlgorithmSuite.C14NType.InclusiveC14N,algorithmSuite.getC14n());
  assertEquals(AlgorithmSuite.SOAPNormType.SOAPNormalization10,algorithmSuite.getSoapNormType());
  assertEquals(AlgorithmSuite.STRType.STRTransform10,algorithmSuite.getStrType());
  assertEquals(AlgorithmSuite.XPathType.AbsXPath,algorithmSuite.getXPathType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.AsymmetricBindingTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAsymmetricBinding() throws Exception {
  String fileName="AsymmetricBinding.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof AsymmetricBinding);
    AsymmetricBinding asymmetricBinding=(AsymmetricBinding)alternative.get(0);
    assertFalse(asymmetricBinding.isNormalized());
    assertTrue(asymmetricBinding.isIgnorable());
    assertTrue(asymmetricBinding.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,asymmetricBinding.getType());
    assertEquals(SP12Constants.ASYMMETRIC_BINDING,asymmetricBinding.getName());
    assertNotNull(asymmetricBinding.getInitiatorEncryptionToken());
    assertNotNull(asymmetricBinding.getInitiatorSignatureToken());
    assertNull(asymmetricBinding.getInitiatorToken());
    assertNotNull(asymmetricBinding.getRecipientEncryptionToken());
    assertNotNull(asymmetricBinding.getRecipientSignatureToken());
    assertNull(asymmetricBinding.getRecipientToken());
    assertNotNull(asymmetricBinding.getAlgorithmSuite());
    assertNotNull(asymmetricBinding.getLayout());
    assertEquals(AbstractSymmetricAsymmetricBinding.ProtectionOrder.EncryptBeforeSigning,asymmetricBinding.getProtectionOrder());
    assertTrue(asymmetricBinding.isEncryptSignature());
    assertTrue(asymmetricBinding.isIncludeTimestamp());
    assertTrue(asymmetricBinding.isOnlySignEntireHeadersAndBody());
    assertTrue(asymmetricBinding.isProtectTokens());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  AsymmetricBinding asymmetricBinding=(AsymmetricBinding)policyComponentIterator.next();
  assertTrue(asymmetricBinding.isNormalized());
  assertTrue(asymmetricBinding.isIgnorable());
  assertFalse(asymmetricBinding.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,asymmetricBinding.getType());
  assertEquals(SP12Constants.ASYMMETRIC_BINDING,asymmetricBinding.getName());
  assertNotNull(asymmetricBinding.getInitiatorEncryptionToken());
  assertNotNull(asymmetricBinding.getInitiatorSignatureToken());
  assertNull(asymmetricBinding.getInitiatorToken());
  assertNotNull(asymmetricBinding.getRecipientEncryptionToken());
  assertNotNull(asymmetricBinding.getRecipientSignatureToken());
  assertNull(asymmetricBinding.getRecipientToken());
  assertNotNull(asymmetricBinding.getAlgorithmSuite());
  assertNotNull(asymmetricBinding.getLayout());
  assertEquals(AbstractSymmetricAsymmetricBinding.ProtectionOrder.EncryptBeforeSigning,asymmetricBinding.getProtectionOrder());
  assertTrue(asymmetricBinding.isEncryptSignature());
  assertTrue(asymmetricBinding.isIncludeTimestamp());
  assertTrue(asymmetricBinding.isOnlySignEntireHeadersAndBody());
  assertTrue(asymmetricBinding.isProtectTokens());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.ContentEncryptedElementsTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContentEncryptedElements() throws Exception {
  String fileName="ContentEncryptedElements.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof ContentEncryptedElements);
    ContentEncryptedElements contentEncryptedElements=(ContentEncryptedElements)alternative.get(0);
    assertFalse(contentEncryptedElements.isNormalized());
    assertTrue(contentEncryptedElements.isIgnorable());
    assertTrue(contentEncryptedElements.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,contentEncryptedElements.getType());
    assertEquals(SP12Constants.CONTENT_ENCRYPTED_ELEMENTS,contentEncryptedElements.getName());
    assertEquals("1.1",contentEncryptedElements.getXPathVersion());
    assertEquals(2,contentEncryptedElements.getXPaths().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  ContentEncryptedElements contentEncryptedElements=(ContentEncryptedElements)policyComponentIterator.next();
  assertTrue(contentEncryptedElements.isNormalized());
  assertTrue(contentEncryptedElements.isIgnorable());
  assertFalse(contentEncryptedElements.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,contentEncryptedElements.getType());
  assertEquals(SP12Constants.CONTENT_ENCRYPTED_ELEMENTS,contentEncryptedElements.getName());
  assertEquals("1.1",contentEncryptedElements.getXPathVersion());
  assertEquals(2,contentEncryptedElements.getXPaths().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.EncryptedElementsTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptedElements() throws Exception {
  String fileName="EncryptedElements.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof EncryptedElements);
    EncryptedElements encryptedElements=(EncryptedElements)alternative.get(0);
    assertFalse(encryptedElements.isNormalized());
    assertTrue(encryptedElements.isIgnorable());
    assertTrue(encryptedElements.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,encryptedElements.getType());
    assertEquals(SP12Constants.ENCRYPTED_ELEMENTS,encryptedElements.getName());
    assertEquals("1.1",encryptedElements.getXPathVersion());
    assertEquals(2,encryptedElements.getXPaths().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  EncryptedElements encryptedElements=(EncryptedElements)policyComponentIterator.next();
  assertTrue(encryptedElements.isNormalized());
  assertTrue(encryptedElements.isIgnorable());
  assertFalse(encryptedElements.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,encryptedElements.getType());
  assertEquals(SP12Constants.ENCRYPTED_ELEMENTS,encryptedElements.getName());
  assertEquals("1.1",encryptedElements.getXPathVersion());
  assertEquals(2,encryptedElements.getXPaths().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.EncryptedPartsTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptedParts12() throws Exception {
  String fileName="EncryptedParts.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof EncryptedParts);
    EncryptedParts encryptedParts=(EncryptedParts)alternative.get(0);
    assertFalse(encryptedParts.isNormalized());
    assertTrue(encryptedParts.isIgnorable());
    assertTrue(encryptedParts.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,encryptedParts.getType());
    assertEquals(SP12Constants.ENCRYPTED_PARTS,encryptedParts.getName());
    assertTrue(encryptedParts.isBody());
    assertNotNull(encryptedParts.getAttachments());
    assertEquals(2,encryptedParts.getHeaders().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  EncryptedParts encryptedParts=(EncryptedParts)policyComponentIterator.next();
  assertTrue(encryptedParts.isNormalized());
  assertTrue(encryptedParts.isIgnorable());
  assertFalse(encryptedParts.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,encryptedParts.getType());
  assertEquals(SP12Constants.ENCRYPTED_PARTS,encryptedParts.getName());
  assertTrue(encryptedParts.isBody());
  assertNotNull(encryptedParts.getAttachments());
  assertEquals(2,encryptedParts.getHeaders().size());
}

</code></pre>

<br>
<pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptedParts13() throws Exception {
  String fileName="EncryptedParts.xml";
  String policyFile=loadPolicyFile("policy/model/sp13/" + fileName);
  String serializedPolicyRefereneFile=loadPolicyFile("policy/model/sp13/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp13/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyRefereneFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof EncryptedParts);
    EncryptedParts encryptedParts=(EncryptedParts)alternative.get(0);
    assertFalse(encryptedParts.isNormalized());
    assertTrue(encryptedParts.isIgnorable());
    assertTrue(encryptedParts.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,encryptedParts.getType());
    assertEquals(SP12Constants.ENCRYPTED_PARTS,encryptedParts.getName());
    assertTrue(encryptedParts.isBody());
    assertNotNull(encryptedParts.getAttachments());
    assertTrue(encryptedParts.getAttachments().isContentSignatureTransform());
    assertTrue(encryptedParts.getAttachments().isAttachmentCompleteSignatureTransform());
    assertEquals(2,encryptedParts.getHeaders().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  EncryptedParts encryptedParts=(EncryptedParts)policyComponentIterator.next();
  assertTrue(encryptedParts.isNormalized());
  assertTrue(encryptedParts.isIgnorable());
  assertFalse(encryptedParts.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,encryptedParts.getType());
  assertEquals(SP12Constants.ENCRYPTED_PARTS,encryptedParts.getName());
  assertTrue(encryptedParts.isBody());
  assertNotNull(encryptedParts.getAttachments());
  assertTrue(encryptedParts.getAttachments().isContentSignatureTransform());
  assertTrue(encryptedParts.getAttachments().isAttachmentCompleteSignatureTransform());
  assertEquals(2,encryptedParts.getHeaders().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.HttpsTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHttpsToken() throws Exception {
  String fileName="HttpsToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof HttpsToken);
    HttpsToken httpsToken=(HttpsToken)alternative.get(0);
    assertFalse(httpsToken.isNormalized());
    assertTrue(httpsToken.isIgnorable());
    assertTrue(httpsToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,httpsToken.getType());
    assertEquals(SP12Constants.HTTPS_TOKEN,httpsToken.getName());
    assertEquals(HttpsToken.AuthenticationType.RequireClientCertificate,httpsToken.getAuthenticationType());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  HttpsToken httpsToken=(HttpsToken)policyComponentIterator.next();
  assertTrue(httpsToken.isNormalized());
  assertTrue(httpsToken.isIgnorable());
  assertFalse(httpsToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,httpsToken.getType());
  assertEquals(SP12Constants.HTTPS_TOKEN,httpsToken.getName());
  assertEquals(HttpsToken.AuthenticationType.RequireClientCertificate,httpsToken.getAuthenticationType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.InitiatorTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitiatorToken() throws Exception {
  String fileName="InitiatorToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof InitiatorToken);
    InitiatorToken initiatorToken=(InitiatorToken)alternative.get(0);
    assertFalse(initiatorToken.isNormalized());
    assertTrue(initiatorToken.isIgnorable());
    assertTrue(initiatorToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,initiatorToken.getType());
    assertEquals(SP12Constants.INITIATOR_TOKEN,initiatorToken.getName());
    assertNotNull(initiatorToken.getToken());
    assertEquals(SP12Constants.X509_TOKEN,initiatorToken.getToken().getName());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  InitiatorToken initiatorToken=(InitiatorToken)policyComponentIterator.next();
  assertTrue(initiatorToken.isNormalized());
  assertTrue(initiatorToken.isIgnorable());
  assertFalse(initiatorToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,initiatorToken.getType());
  assertEquals(SP12Constants.INITIATOR_TOKEN,initiatorToken.getName());
  assertNotNull(initiatorToken.getToken());
  assertEquals(SP12Constants.X509_TOKEN,initiatorToken.getToken().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.IssuedTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIssuedToken() throws Exception {
  String fileName="IssuedToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof IssuedToken);
    IssuedToken issuedToken=(IssuedToken)alternative.get(0);
    assertFalse(issuedToken.isNormalized());
    assertTrue(issuedToken.isIgnorable());
    assertTrue(issuedToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,issuedToken.getType());
    assertEquals(SP12Constants.ISSUED_TOKEN,issuedToken.getName());
    assertNotNull(issuedToken.getRequestSecurityTokenTemplate());
    assertTrue(issuedToken.isRequireExternalReference());
    assertTrue(issuedToken.isRequireInternalReference());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  IssuedToken issuedToken=(IssuedToken)policyComponentIterator.next();
  assertTrue(issuedToken.isNormalized());
  assertTrue(issuedToken.isIgnorable());
  assertFalse(issuedToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,issuedToken.getType());
  assertEquals(SP12Constants.ISSUED_TOKEN,issuedToken.getName());
  assertNotNull(issuedToken.getRequestSecurityTokenTemplate());
  assertTrue(issuedToken.isRequireExternalReference());
  assertTrue(issuedToken.isRequireInternalReference());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.KerberosTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKerberosToken() throws Exception {
  String fileName="KerberosToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof KerberosToken);
    KerberosToken kerberosToken=(KerberosToken)alternative.get(0);
    assertFalse(kerberosToken.isNormalized());
    assertTrue(kerberosToken.isIgnorable());
    assertTrue(kerberosToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,kerberosToken.getType());
    assertEquals(SP12Constants.KERBEROS_TOKEN,kerberosToken.getName());
    assertEquals(KerberosToken.ApReqTokenType.WssKerberosV5ApReqToken11,kerberosToken.getApReqTokenType());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  KerberosToken kerberosToken=(KerberosToken)policyComponentIterator.next();
  assertTrue(kerberosToken.isNormalized());
  assertTrue(kerberosToken.isIgnorable());
  assertFalse(kerberosToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,kerberosToken.getType());
  assertEquals(SP12Constants.KERBEROS_TOKEN,kerberosToken.getName());
  assertEquals(KerberosToken.ApReqTokenType.WssKerberosV5ApReqToken11,kerberosToken.getApReqTokenType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.KeyValueTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeyValueToken() throws Exception {
  String fileName="KeyValueToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof KeyValueToken);
    KeyValueToken keyValueToken=(KeyValueToken)alternative.get(0);
    assertFalse(keyValueToken.isNormalized());
    assertTrue(keyValueToken.isIgnorable());
    assertTrue(keyValueToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,keyValueToken.getType());
    assertEquals(SP12Constants.KEY_VALUE_TOKEN,keyValueToken.getName());
    assertTrue(keyValueToken.isRsaKeyValue());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  KeyValueToken keyValueToken=(KeyValueToken)policyComponentIterator.next();
  assertTrue(keyValueToken.isNormalized());
  assertTrue(keyValueToken.isIgnorable());
  assertFalse(keyValueToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,keyValueToken.getType());
  assertEquals(SP12Constants.KEY_VALUE_TOKEN,keyValueToken.getName());
  assertTrue(keyValueToken.isRsaKeyValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.LayoutTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLayout() throws Exception {
  String fileName="Layout.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof Layout);
    Layout layout=(Layout)alternative.get(0);
    assertFalse(layout.isNormalized());
    assertTrue(layout.isIgnorable());
    assertTrue(layout.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,layout.getType());
    assertEquals(SP12Constants.LAYOUT,layout.getName());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  Layout layout=(Layout)policyComponentIterator.next();
  assertTrue(layout.isNormalized());
  assertTrue(layout.isIgnorable());
  assertFalse(layout.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,layout.getType());
  assertEquals(SP12Constants.LAYOUT,layout.getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.RecipientTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecipientToken() throws Exception {
  String fileName="RecipientToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof RecipientToken);
    RecipientToken recipientToken=(RecipientToken)alternative.get(0);
    assertFalse(recipientToken.isNormalized());
    assertTrue(recipientToken.isIgnorable());
    assertTrue(recipientToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,recipientToken.getType());
    assertEquals(SP12Constants.RECIPIENT_TOKEN,recipientToken.getName());
    assertNotNull(recipientToken.getToken());
    assertEquals(SP12Constants.X509_TOKEN,recipientToken.getToken().getName());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  RecipientToken recipientToken=(RecipientToken)policyComponentIterator.next();
  assertTrue(recipientToken.isNormalized());
  assertTrue(recipientToken.isIgnorable());
  assertFalse(recipientToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,recipientToken.getType());
  assertEquals(SP12Constants.RECIPIENT_TOKEN,recipientToken.getName());
  assertNotNull(recipientToken.getToken());
  assertEquals(SP12Constants.X509_TOKEN,recipientToken.getToken().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.RelTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRelToken() throws Exception {
  String fileName="RelToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof RelToken);
    RelToken relToken=(RelToken)alternative.get(0);
    assertFalse(relToken.isNormalized());
    assertTrue(relToken.isIgnorable());
    assertTrue(relToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,relToken.getType());
    assertEquals(SP12Constants.REL_TOKEN,relToken.getName());
    assertEquals(RelToken.RelTokenType.WssRelV20Token10,relToken.getRelTokenType());
    assertTrue(relToken.isRequireKeyIdentifierReference());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  RelToken relToken=(RelToken)policyComponentIterator.next();
  assertTrue(relToken.isNormalized());
  assertTrue(relToken.isIgnorable());
  assertFalse(relToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,relToken.getType());
  assertEquals(SP12Constants.REL_TOKEN,relToken.getName());
  assertEquals(RelToken.RelTokenType.WssRelV20Token10,relToken.getRelTokenType());
  assertTrue(relToken.isRequireKeyIdentifierReference());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.RequiredElementsTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequiredElements() throws Exception {
  String fileName="RequiredElements.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof RequiredElements);
    RequiredElements requiredElements=(RequiredElements)alternative.get(0);
    assertFalse(requiredElements.isNormalized());
    assertTrue(requiredElements.isIgnorable());
    assertTrue(requiredElements.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,requiredElements.getType());
    assertEquals(SP12Constants.REQUIRED_ELEMENTS,requiredElements.getName());
    assertEquals("1.1",requiredElements.getXPathVersion());
    assertEquals(2,requiredElements.getXPaths().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  RequiredElements requiredElements=(RequiredElements)policyComponentIterator.next();
  assertTrue(requiredElements.isNormalized());
  assertTrue(requiredElements.isIgnorable());
  assertFalse(requiredElements.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,requiredElements.getType());
  assertEquals(SP12Constants.REQUIRED_ELEMENTS,requiredElements.getName());
  assertEquals("1.1",requiredElements.getXPathVersion());
  assertEquals(2,requiredElements.getXPaths().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.RequiredPartsTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequiredParts() throws Exception {
  String fileName="RequiredParts.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof RequiredParts);
    RequiredParts requiredParts=(RequiredParts)alternative.get(0);
    assertFalse(requiredParts.isNormalized());
    assertTrue(requiredParts.isIgnorable());
    assertTrue(requiredParts.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,requiredParts.getType());
    assertEquals(SP12Constants.REQUIRED_PARTS,requiredParts.getName());
    assertEquals(2,requiredParts.getHeaders().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  RequiredParts requiredParts=(RequiredParts)policyComponentIterator.next();
  assertTrue(requiredParts.isNormalized());
  assertTrue(requiredParts.isIgnorable());
  assertFalse(requiredParts.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,requiredParts.getType());
  assertEquals(SP12Constants.REQUIRED_PARTS,requiredParts.getName());
  assertEquals(2,requiredParts.getHeaders().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.SamlTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSamlToken() throws Exception {
  String fileName="SamlToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SamlToken);
    SamlToken samlToken=(SamlToken)alternative.get(0);
    assertFalse(samlToken.isNormalized());
    assertTrue(samlToken.isIgnorable());
    assertTrue(samlToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,samlToken.getType());
    assertEquals(SP12Constants.SAML_TOKEN,samlToken.getName());
    assertEquals(SamlToken.SamlTokenType.WssSamlV20Token11,samlToken.getSamlTokenType());
    assertTrue(samlToken.isRequireKeyIdentifierReference());
    assertTrue(samlToken.getClaims() != null);
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SamlToken samlToken=(SamlToken)policyComponentIterator.next();
  assertTrue(samlToken.isNormalized());
  assertTrue(samlToken.isIgnorable());
  assertFalse(samlToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,samlToken.getType());
  assertEquals(SP12Constants.SAML_TOKEN,samlToken.getName());
  assertEquals(SamlToken.SamlTokenType.WssSamlV20Token11,samlToken.getSamlTokenType());
  assertTrue(samlToken.isRequireKeyIdentifierReference());
  assertTrue(samlToken.getClaims() != null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.SecureConversationTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecureConversationToken() throws Exception {
  String fileName="SecureConversationToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SecureConversationToken);
    SecureConversationToken secureConversationToken=(SecureConversationToken)alternative.get(0);
    assertFalse(secureConversationToken.isNormalized());
    assertTrue(secureConversationToken.isIgnorable());
    assertTrue(secureConversationToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,secureConversationToken.getType());
    assertEquals(SP12Constants.SECURE_CONVERSATION_TOKEN,secureConversationToken.getName());
    assertTrue(secureConversationToken.isMustNotSendAmend());
    assertTrue(secureConversationToken.isMustNotSendRenew());
    assertTrue(secureConversationToken.isMustNotSendCancel());
    assertNotNull(secureConversationToken.getBootstrapPolicy());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SecureConversationToken secureConversationToken=(SecureConversationToken)policyComponentIterator.next();
  assertTrue(secureConversationToken.isNormalized());
  assertTrue(secureConversationToken.isIgnorable());
  assertFalse(secureConversationToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,secureConversationToken.getType());
  assertEquals(SP12Constants.SECURE_CONVERSATION_TOKEN,secureConversationToken.getName());
  assertTrue(secureConversationToken.isMustNotSendAmend());
  assertTrue(secureConversationToken.isMustNotSendRenew());
  assertTrue(secureConversationToken.isMustNotSendCancel());
  assertNotNull(secureConversationToken.getBootstrapPolicy());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.SecurityContextTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecurityContextToken() throws Exception {
  String fileName="SecurityContextToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SecurityContextToken);
    SecurityContextToken securityContextToken=(SecurityContextToken)alternative.get(0);
    assertFalse(securityContextToken.isNormalized());
    assertTrue(securityContextToken.isIgnorable());
    assertTrue(securityContextToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,securityContextToken.getType());
    assertEquals(SP12Constants.SECURITY_CONTEXT_TOKEN,securityContextToken.getName());
    assertTrue(securityContextToken.isRequireExternalUriReference());
    assertTrue(securityContextToken.isSc13SecurityContextToken());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SecurityContextToken securityContextToken=(SecurityContextToken)policyComponentIterator.next();
  assertTrue(securityContextToken.isNormalized());
  assertTrue(securityContextToken.isIgnorable());
  assertFalse(securityContextToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,securityContextToken.getType());
  assertEquals(SP12Constants.SECURITY_CONTEXT_TOKEN,securityContextToken.getName());
  assertTrue(securityContextToken.isRequireExternalUriReference());
  assertTrue(securityContextToken.isSc13SecurityContextToken());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.SignedElementsTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignedElements12() throws Exception {
  String fileName="SignedElements.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SignedElements);
    SignedElements signedElements=(SignedElements)alternative.get(0);
    assertFalse(signedElements.isNormalized());
    assertTrue(signedElements.isIgnorable());
    assertTrue(signedElements.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,signedElements.getType());
    assertEquals(SP12Constants.SIGNED_ELEMENTS,signedElements.getName());
    assertEquals("1.1",signedElements.getXPathVersion());
    assertEquals(2,signedElements.getXPaths().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SignedElements signedElements=(SignedElements)policyComponentIterator.next();
  assertTrue(signedElements.isNormalized());
  assertTrue(signedElements.isIgnorable());
  assertFalse(signedElements.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,signedElements.getType());
  assertEquals(SP12Constants.SIGNED_ELEMENTS,signedElements.getName());
  assertEquals("1.1",signedElements.getXPathVersion());
  assertEquals(2,signedElements.getXPaths().size());
}

</code></pre>

<br>
<pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignedElements13() throws Exception {
  String fileName="SignedElements.xml";
  String policyFile=loadPolicyFile("policy/model/sp13/" + fileName);
  String serializedPolicyRefereneFile=loadPolicyFile("policy/model/sp13/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp13/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyRefereneFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SignedElements);
    SignedElements signedElements=(SignedElements)alternative.get(0);
    assertFalse(signedElements.isNormalized());
    assertTrue(signedElements.isIgnorable());
    assertTrue(signedElements.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,signedElements.getType());
    assertEquals(SP12Constants.SIGNED_ELEMENTS,signedElements.getName());
    assertEquals("1.1",signedElements.getXPathVersion());
    assertEquals(3,signedElements.getXPaths().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SignedElements signedElements=(SignedElements)policyComponentIterator.next();
  assertTrue(signedElements.isNormalized());
  assertTrue(signedElements.isIgnorable());
  assertFalse(signedElements.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,signedElements.getType());
  assertEquals(SP12Constants.SIGNED_ELEMENTS,signedElements.getName());
  assertEquals("1.1",signedElements.getXPathVersion());
  assertEquals(3,signedElements.getXPaths().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.SignedPartsTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignedParts13() throws Exception {
  String fileName="SignedParts.xml";
  String policyFile=loadPolicyFile("policy/model/sp13/" + fileName);
  String serializedPolicyRefereneFile=loadPolicyFile("policy/model/sp13/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp13/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyRefereneFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SignedParts);
    SignedParts signedParts=(SignedParts)alternative.get(0);
    assertFalse(signedParts.isNormalized());
    assertTrue(signedParts.isIgnorable());
    assertTrue(signedParts.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,signedParts.getType());
    assertEquals(SP12Constants.SIGNED_PARTS,signedParts.getName());
    assertTrue(signedParts.isBody());
    assertNotNull(signedParts.getAttachments());
    assertEquals(2,signedParts.getHeaders().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SignedParts signedParts=(SignedParts)policyComponentIterator.next();
  assertTrue(signedParts.isNormalized());
  assertTrue(signedParts.isIgnorable());
  assertFalse(signedParts.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,signedParts.getType());
  assertEquals(SP12Constants.SIGNED_PARTS,signedParts.getName());
  assertTrue(signedParts.isBody());
  assertNotNull(signedParts.getAttachments());
  assertEquals(2,signedParts.getHeaders().size());
}

</code></pre>

<br>
<pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignedParts12() throws Exception {
  String fileName="SignedParts.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SignedParts);
    SignedParts signedParts=(SignedParts)alternative.get(0);
    assertFalse(signedParts.isNormalized());
    assertTrue(signedParts.isIgnorable());
    assertTrue(signedParts.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,signedParts.getType());
    assertEquals(SP12Constants.SIGNED_PARTS,signedParts.getName());
    assertTrue(signedParts.isBody());
    assertNotNull(signedParts.getAttachments());
    assertEquals(2,signedParts.getHeaders().size());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SignedParts signedParts=(SignedParts)policyComponentIterator.next();
  assertTrue(signedParts.isNormalized());
  assertTrue(signedParts.isIgnorable());
  assertFalse(signedParts.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,signedParts.getType());
  assertEquals(SP12Constants.SIGNED_PARTS,signedParts.getName());
  assertTrue(signedParts.isBody());
  assertNotNull(signedParts.getAttachments());
  assertEquals(2,signedParts.getHeaders().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.SpnegoContextTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSpnegoContextToken() throws Exception {
  String fileName="SpnegoContextToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SpnegoContextToken);
    SpnegoContextToken spnegoContextToken=(SpnegoContextToken)alternative.get(0);
    assertFalse(spnegoContextToken.isNormalized());
    assertTrue(spnegoContextToken.isIgnorable());
    assertTrue(spnegoContextToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,spnegoContextToken.getType());
    assertEquals(SP12Constants.SPNEGO_CONTEXT_TOKEN,spnegoContextToken.getName());
    assertTrue(spnegoContextToken.isMustNotSendAmend());
    assertTrue(spnegoContextToken.isMustNotSendCancel());
    assertTrue(spnegoContextToken.isMustNotSendRenew());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SpnegoContextToken spnegoContextToken=(SpnegoContextToken)policyComponentIterator.next();
  assertTrue(spnegoContextToken.isNormalized());
  assertTrue(spnegoContextToken.isIgnorable());
  assertFalse(spnegoContextToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,spnegoContextToken.getType());
  assertEquals(SP12Constants.SPNEGO_CONTEXT_TOKEN,spnegoContextToken.getName());
  assertTrue(spnegoContextToken.isMustNotSendAmend());
  assertTrue(spnegoContextToken.isMustNotSendCancel());
  assertTrue(spnegoContextToken.isMustNotSendRenew());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.SupportingTokensTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSupportingTokens() throws Exception {
  String fileName="SupportingTokens.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SupportingTokens);
    SupportingTokens supportingTokens=(SupportingTokens)alternative.get(0);
    assertFalse(supportingTokens.isNormalized());
    assertTrue(supportingTokens.isIgnorable());
    assertTrue(supportingTokens.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,supportingTokens.getType());
    assertEquals(SP12Constants.SUPPORTING_TOKENS,supportingTokens.getName());
    assertEquals(1,supportingTokens.getTokens().size());
    assertNotNull(supportingTokens.getSignedParts());
    assertNotNull(supportingTokens.getSignedElements());
    assertNotNull(supportingTokens.getEncryptedParts());
    assertNotNull(supportingTokens.getEncryptedElements());
    assertNotNull(supportingTokens.getAlgorithmSuite());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SupportingTokens supportingTokens=(SupportingTokens)policyComponentIterator.next();
  assertTrue(supportingTokens.isNormalized());
  assertTrue(supportingTokens.isIgnorable());
  assertFalse(supportingTokens.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,supportingTokens.getType());
  assertEquals(SP12Constants.SUPPORTING_TOKENS,supportingTokens.getName());
  assertEquals(1,supportingTokens.getTokens().size());
  assertNotNull(supportingTokens.getSignedParts());
  assertNotNull(supportingTokens.getSignedElements());
  assertNotNull(supportingTokens.getEncryptedParts());
  assertNotNull(supportingTokens.getEncryptedElements());
  assertNotNull(supportingTokens.getAlgorithmSuite());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.SymmetricBindingTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSymmetricBinding() throws Exception {
  String fileName="SymmetricBinding.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof SymmetricBinding);
    SymmetricBinding symmetricBinding=(SymmetricBinding)alternative.get(0);
    assertFalse(symmetricBinding.isNormalized());
    assertTrue(symmetricBinding.isIgnorable());
    assertTrue(symmetricBinding.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,symmetricBinding.getType());
    assertEquals(SP12Constants.SYMMETRIC_BINDING,symmetricBinding.getName());
    assertNotNull(symmetricBinding.getEncryptionToken());
    assertNotNull(symmetricBinding.getSignatureToken());
    assertNotNull(symmetricBinding.getAlgorithmSuite());
    assertNotNull(symmetricBinding.getLayout());
    assertEquals(AbstractSymmetricAsymmetricBinding.ProtectionOrder.EncryptBeforeSigning,symmetricBinding.getProtectionOrder());
    assertTrue(symmetricBinding.isEncryptSignature());
    assertTrue(symmetricBinding.isIncludeTimestamp());
    assertTrue(symmetricBinding.isOnlySignEntireHeadersAndBody());
    assertTrue(symmetricBinding.isProtectTokens());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  SymmetricBinding symmetricBinding=(SymmetricBinding)policyComponentIterator.next();
  assertTrue(symmetricBinding.isNormalized());
  assertTrue(symmetricBinding.isIgnorable());
  assertFalse(symmetricBinding.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,symmetricBinding.getType());
  assertEquals(SP12Constants.SYMMETRIC_BINDING,symmetricBinding.getName());
  assertNotNull(symmetricBinding.getEncryptionToken());
  assertNotNull(symmetricBinding.getSignatureToken());
  assertNotNull(symmetricBinding.getAlgorithmSuite());
  assertNotNull(symmetricBinding.getLayout());
  assertEquals(AbstractSymmetricAsymmetricBinding.ProtectionOrder.EncryptBeforeSigning,symmetricBinding.getProtectionOrder());
  assertTrue(symmetricBinding.isEncryptSignature());
  assertTrue(symmetricBinding.isIncludeTimestamp());
  assertTrue(symmetricBinding.isOnlySignEntireHeadersAndBody());
  assertTrue(symmetricBinding.isProtectTokens());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.TransportBindingTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransportBinding() throws Exception {
  String fileName="TransportBinding.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof TransportBinding);
    TransportBinding transportBinding=(TransportBinding)alternative.get(0);
    assertFalse(transportBinding.isNormalized());
    assertTrue(transportBinding.isIgnorable());
    assertTrue(transportBinding.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,transportBinding.getType());
    assertEquals(SP12Constants.TRANSPORT_BINDING,transportBinding.getName());
    assertNotNull(transportBinding.getTransportToken());
    assertNotNull(transportBinding.getAlgorithmSuite());
    assertNotNull(transportBinding.getLayout());
    assertTrue(transportBinding.isIncludeTimestamp());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  TransportBinding transportBinding=(TransportBinding)policyComponentIterator.next();
  assertTrue(transportBinding.isNormalized());
  assertTrue(transportBinding.isIgnorable());
  assertFalse(transportBinding.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,transportBinding.getType());
  assertEquals(SP12Constants.TRANSPORT_BINDING,transportBinding.getName());
  assertNotNull(transportBinding.getTransportToken());
  assertNotNull(transportBinding.getAlgorithmSuite());
  assertNotNull(transportBinding.getLayout());
  assertTrue(transportBinding.isIncludeTimestamp());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.Trust10Test </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrust10_11() throws Exception {
  String fileName="Trust10.xml";
  String policyFile=loadPolicyFile("policy/model/sp11/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp11/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp11/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof Trust10);
    Trust10 trust10=(Trust10)alternative.get(0);
    assertFalse(trust10.isNormalized());
    assertTrue(trust10.isIgnorable());
    assertTrue(trust10.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,trust10.getType());
    assertEquals(SP11Constants.TRUST_10,trust10.getName());
    assertTrue(trust10.isMustSupportClientChallenge());
    assertTrue(trust10.isMustSupportServerChallenge());
    assertTrue(trust10.isRequireClientEntropy());
    assertTrue(trust10.isRequireServerEntropy());
    assertTrue(trust10.isMustSupportIssuedTokens());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  Trust10 trust13=(Trust10)policyComponentIterator.next();
  assertTrue(trust13.isNormalized());
  assertTrue(trust13.isIgnorable());
  assertFalse(trust13.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,trust13.getType());
  assertEquals(SP11Constants.TRUST_10,trust13.getName());
  assertTrue(trust13.isMustSupportClientChallenge());
  assertTrue(trust13.isMustSupportServerChallenge());
  assertTrue(trust13.isRequireClientEntropy());
  assertTrue(trust13.isRequireServerEntropy());
  assertTrue(trust13.isMustSupportIssuedTokens());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.Trust13Test </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrust13_12() throws Exception {
  String fileName="Trust13.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof Trust13);
    Trust13 trust13=(Trust13)alternative.get(0);
    assertFalse(trust13.isNormalized());
    assertTrue(trust13.isIgnorable());
    assertTrue(trust13.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,trust13.getType());
    assertEquals(SP12Constants.TRUST_13,trust13.getName());
    assertTrue(trust13.isMustSupportClientChallenge());
    assertTrue(trust13.isMustSupportServerChallenge());
    assertTrue(trust13.isRequireClientEntropy());
    assertTrue(trust13.isRequireServerEntropy());
    assertTrue(trust13.isMustSupportIssuedTokens());
    assertTrue(trust13.isRequireRequestSecurityTokenCollection());
    assertTrue(trust13.isRequireAppliesTo());
    assertFalse(trust13.isScopePolicy15());
    assertFalse(trust13.isMustSupportInteractiveChallenge());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  Trust13 trust13=(Trust13)policyComponentIterator.next();
  assertTrue(trust13.isNormalized());
  assertTrue(trust13.isIgnorable());
  assertFalse(trust13.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,trust13.getType());
  assertEquals(SP12Constants.TRUST_13,trust13.getName());
  assertTrue(trust13.isMustSupportClientChallenge());
  assertTrue(trust13.isMustSupportServerChallenge());
  assertTrue(trust13.isRequireClientEntropy());
  assertTrue(trust13.isRequireServerEntropy());
  assertTrue(trust13.isMustSupportIssuedTokens());
  assertTrue(trust13.isRequireRequestSecurityTokenCollection());
  assertTrue(trust13.isRequireAppliesTo());
  assertFalse(trust13.isScopePolicy15());
  assertFalse(trust13.isMustSupportInteractiveChallenge());
}

</code></pre>

<br>
<pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrust13_13() throws Exception {
  String fileName="Trust13.xml";
  String policyFile=loadPolicyFile("policy/model/sp13/" + fileName);
  String serializedPolicyRefereneFile=loadPolicyFile("policy/model/sp13/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp13/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyRefereneFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof Trust13);
    Trust13 trust13=(Trust13)alternative.get(0);
    assertFalse(trust13.isNormalized());
    assertTrue(trust13.isIgnorable());
    assertTrue(trust13.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,trust13.getType());
    assertEquals(SP13Constants.TRUST_13,trust13.getName());
    assertTrue(trust13.isMustSupportClientChallenge());
    assertTrue(trust13.isMustSupportServerChallenge());
    assertTrue(trust13.isRequireClientEntropy());
    assertTrue(trust13.isRequireServerEntropy());
    assertTrue(trust13.isMustSupportIssuedTokens());
    assertTrue(trust13.isRequireRequestSecurityTokenCollection());
    assertTrue(trust13.isRequireAppliesTo());
    assertTrue(trust13.isScopePolicy15());
    assertTrue(trust13.isMustSupportInteractiveChallenge());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  Trust13 trust13=(Trust13)policyComponentIterator.next();
  assertTrue(trust13.isNormalized());
  assertTrue(trust13.isIgnorable());
  assertFalse(trust13.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,trust13.getType());
  assertEquals(SP13Constants.TRUST_13,trust13.getName());
  assertTrue(trust13.isMustSupportClientChallenge());
  assertTrue(trust13.isMustSupportServerChallenge());
  assertTrue(trust13.isRequireClientEntropy());
  assertTrue(trust13.isRequireServerEntropy());
  assertTrue(trust13.isMustSupportIssuedTokens());
  assertTrue(trust13.isRequireRequestSecurityTokenCollection());
  assertTrue(trust13.isRequireAppliesTo());
  assertTrue(trust13.isScopePolicy15());
  assertTrue(trust13.isMustSupportInteractiveChallenge());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.UsernameTokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUsernameToken12() throws Exception {
  String fileName="UsernameToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof UsernameToken);
    UsernameToken usernameToken=(UsernameToken)alternative.get(0);
    assertFalse(usernameToken.isNormalized());
    assertTrue(usernameToken.isIgnorable());
    assertTrue(usernameToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,usernameToken.getType());
    assertEquals(SP12Constants.USERNAME_TOKEN,usernameToken.getName());
    assertEquals(UsernameToken.PasswordType.HashPassword,usernameToken.getPasswordType());
    assertEquals(UsernameToken.UsernameTokenType.WssUsernameToken10,usernameToken.getUsernameTokenType());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  UsernameToken usernameToken=(UsernameToken)policyComponentIterator.next();
  assertTrue(usernameToken.isNormalized());
  assertTrue(usernameToken.isIgnorable());
  assertFalse(usernameToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,usernameToken.getType());
  assertEquals(SP12Constants.USERNAME_TOKEN,usernameToken.getName());
  assertEquals(UsernameToken.PasswordType.HashPassword,usernameToken.getPasswordType());
  assertEquals(UsernameToken.UsernameTokenType.WssUsernameToken10,usernameToken.getUsernameTokenType());
}

</code></pre>

<br>
<pre class="type-3 type-11 type-7 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUsernameToken13() throws Exception {
  String fileName="UsernameToken.xml";
  String policyFile=loadPolicyFile("policy/model/sp13/" + fileName);
  String serializedPolicyRefereneFile=loadPolicyFile("policy/model/sp13/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp13/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyRefereneFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof UsernameToken);
    UsernameToken usernameToken=(UsernameToken)alternative.get(0);
    assertFalse(usernameToken.isNormalized());
    assertTrue(usernameToken.isIgnorable());
    assertTrue(usernameToken.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,usernameToken.getType());
    assertEquals(SP12Constants.USERNAME_TOKEN,usernameToken.getName());
    assertTrue(usernameToken.isCreated());
    assertTrue(usernameToken.isNonce());
    assertNull(usernameToken.getPasswordType());
    assertEquals(UsernameToken.UsernameTokenType.WssUsernameToken10,usernameToken.getUsernameTokenType());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  UsernameToken usernameToken=(UsernameToken)policyComponentIterator.next();
  assertTrue(usernameToken.isNormalized());
  assertTrue(usernameToken.isIgnorable());
  assertFalse(usernameToken.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,usernameToken.getType());
  assertEquals(SP12Constants.USERNAME_TOKEN,usernameToken.getName());
  assertTrue(usernameToken.isCreated());
  assertTrue(usernameToken.isNonce());
  assertNull(usernameToken.getPasswordType());
  assertEquals(UsernameToken.UsernameTokenType.WssUsernameToken10,usernameToken.getUsernameTokenType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.Wss10Test </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWss10() throws Exception {
  String fileName="Wss10.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof Wss10);
    Wss10 wss10=(Wss10)alternative.get(0);
    assertFalse(wss10.isNormalized());
    assertTrue(wss10.isIgnorable());
    assertTrue(wss10.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,wss10.getType());
    assertEquals(SP12Constants.WSS10,wss10.getName());
    assertTrue(wss10.isMustSupportRefEmbeddedToken());
    assertTrue(wss10.isMustSupportRefExternalURI());
    assertTrue(wss10.isMustSupportRefIssuerSerial());
    assertTrue(wss10.isMustSupportRefKeyIdentifier());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  Wss10 wss10=(Wss10)policyComponentIterator.next();
  assertTrue(wss10.isNormalized());
  assertTrue(wss10.isIgnorable());
  assertFalse(wss10.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,wss10.getType());
  assertEquals(SP12Constants.WSS10,wss10.getName());
  assertTrue(wss10.isMustSupportRefEmbeddedToken());
  assertTrue(wss10.isMustSupportRefExternalURI());
  assertTrue(wss10.isMustSupportRefIssuerSerial());
  assertTrue(wss10.isMustSupportRefKeyIdentifier());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.Wss11Test </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWss11() throws Exception {
  String fileName="Wss11.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof Wss11);
    Wss11 wss11=(Wss11)alternative.get(0);
    assertFalse(wss11.isNormalized());
    assertTrue(wss11.isIgnorable());
    assertTrue(wss11.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,wss11.getType());
    assertEquals(SP12Constants.WSS11,wss11.getName());
    assertTrue(wss11.isMustSupportRefEmbeddedToken());
    assertTrue(wss11.isMustSupportRefExternalURI());
    assertTrue(wss11.isMustSupportRefIssuerSerial());
    assertTrue(wss11.isMustSupportRefKeyIdentifier());
    assertTrue(wss11.isMustSupportRefEncryptedKey());
    assertTrue(wss11.isMustSupportRefThumbprint());
    assertTrue(wss11.isRequireSignatureConfirmation());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  Wss11 wss11=(Wss11)policyComponentIterator.next();
  assertTrue(wss11.isNormalized());
  assertTrue(wss11.isIgnorable());
  assertFalse(wss11.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,wss11.getType());
  assertEquals(SP12Constants.WSS11,wss11.getName());
  assertTrue(wss11.isMustSupportRefEmbeddedToken());
  assertTrue(wss11.isMustSupportRefExternalURI());
  assertTrue(wss11.isMustSupportRefIssuerSerial());
  assertTrue(wss11.isMustSupportRefKeyIdentifier());
  assertTrue(wss11.isMustSupportRefEncryptedKey());
  assertTrue(wss11.isMustSupportRefThumbprint());
  assertTrue(wss11.isRequireSignatureConfirmation());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.policy.tests.X509TokenTest </h4><pre class="type-3 type-11 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testX509Token() throws Exception {
  String fileName="X509Token.xml";
  String policyFile=loadPolicyFile("policy/model/sp12/" + fileName);
  String serializedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/serialized/" + fileName);
  String normalizedPolicyReferenceFile=loadPolicyFile("policy/model/sp12/normalized/" + fileName);
  Policy policy=loadPolicy(policyFile);
  String serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,serializedPolicyReferenceFile);
  Iterator<List<Assertion>> alternativeIterator=policy.getAlternatives();
  int count=0;
  while (alternativeIterator.hasNext()) {
    List<Assertion> alternative=alternativeIterator.next();
    assertEquals(1,alternative.size());
    assertTrue(alternative.get(0) instanceof X509Token);
    X509Token x509Token=(X509Token)alternative.get(0);
    assertFalse(x509Token.isNormalized());
    assertTrue(x509Token.isIgnorable());
    assertTrue(x509Token.isOptional());
    assertEquals(Constants.TYPE_ASSERTION,x509Token.getType());
    assertEquals(SP12Constants.X509_TOKEN,x509Token.getName());
    assertTrue(x509Token.isRequireEmbeddedTokenReference());
    assertTrue(x509Token.isRequireIssuerSerialReference());
    assertTrue(x509Token.isRequireKeyIdentifierReference());
    assertTrue(x509Token.isRequireThumbprintReference());
    assertEquals(X509Token.TokenType.WssX509V1Token11,x509Token.getTokenType());
    count++;
  }
  assertEquals(1,count);
  policy=policy.normalize(true);
  serializedPolicy=serializePolicy(policy);
  assertXMLisEqual(serializedPolicy,normalizedPolicyReferenceFile);
  alternativeIterator=policy.getAlternatives();
  List<Assertion> alternative=alternativeIterator.next();
  assertEquals(0,alternative.size());
  List<PolicyComponent> policyComponents=policy.getPolicyComponents();
  assertEquals(1,policyComponents.size());
  PolicyOperator policyOperator=(PolicyOperator)policyComponents.get(0);
  policyComponents=policyOperator.getPolicyComponents();
  assertEquals(2,policyComponents.size());
  All all=(All)policyComponents.get(0);
  List<PolicyComponent> policyComponentsAll=all.getAssertions();
  assertEquals(0,policyComponentsAll.size());
  all=(All)policyComponents.get(1);
  policyComponentsAll=all.getAssertions();
  assertEquals(1,policyComponentsAll.size());
  Iterator<PolicyComponent> policyComponentIterator=policyComponentsAll.iterator();
  X509Token x509Token=(X509Token)policyComponentIterator.next();
  assertTrue(x509Token.isNormalized());
  assertTrue(x509Token.isIgnorable());
  assertFalse(x509Token.isOptional());
  assertEquals(Constants.TYPE_ASSERTION,x509Token.getType());
  assertEquals(SP12Constants.X509_TOKEN,x509Token.getName());
  assertTrue(x509Token.isRequireEmbeddedTokenReference());
  assertTrue(x509Token.isRequireIssuerSerialReference());
  assertTrue(x509Token.isRequireKeyIdentifierReference());
  assertTrue(x509Token.isRequireThumbprintReference());
  assertEquals(X509Token.TokenType.WssX509V1Token11,x509Token.getTokenType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.EncDecryptionTest </h4><pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPartsContentInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Properties properties=new Properties();
    properties.setProperty(WSHandlerConstants.ENCRYPTION_PARTS,"{Content}{http://www.w3.org/1999/XMLSchema}simpleType;");
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
    NodeList nodeList=securedDocument.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.X509Token,WSSecurityEventConstants.OPERATION,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.ContentEncrypted};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ContentEncrypted) {
        ContentEncryptedElementSecurityEvent contentEncryptedElementSecurityEvent=(ContentEncryptedElementSecurityEvent)securityEvent;
        Assert.assertNotNull(contentEncryptedElementSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(contentEncryptedElementSecurityEvent.getSecurityToken());
        Assert.assertNotNull(contentEncryptedElementSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://www.w3.org/1999/XMLSchema","simpleType");
        Assert.assertEquals(contentEncryptedElementSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(contentEncryptedElementSecurityEvent.getElementPath().size(),6);
        Assert.assertEquals(contentEncryptedElementSecurityEvent.getElementPath().get(contentEncryptedElementSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    List<ContentEncryptedElementSecurityEvent> contentEncryptedElementSecurityEventList=securityEventListener.getSecurityEvents(SecurityEventConstants.ContentEncrypted);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID1=contentEncryptedElementSecurityEventList.get(0).getCorrelationID();
    String encryptedPartCorrelationID2=contentEncryptedElementSecurityEventList.get(1).getCorrelationID();
    String encryptedPartCorrelationID3=contentEncryptedElementSecurityEventList.get(2).getCorrelationID();
    String encryptedPartCorrelationID4=contentEncryptedElementSecurityEventList.get(3).getCorrelationID();
    String encryptedPartCorrelationID5=contentEncryptedElementSecurityEventList.get(4).getCorrelationID();
    String encryptedPartCorrelationID6=contentEncryptedElementSecurityEventList.get(5).getCorrelationID();
    String encryptedPartCorrelationID7=contentEncryptedElementSecurityEventList.get(6).getCorrelationID();
    String encryptedPartCorrelationID8=contentEncryptedElementSecurityEventList.get(7).getCorrelationID();
    String encryptedPartCorrelationID9=contentEncryptedElementSecurityEventList.get(8).getCorrelationID();
    String encryptedPartCorrelationID10=contentEncryptedElementSecurityEventList.get(9).getCorrelationID();
    String encryptedPartCorrelationID11=contentEncryptedElementSecurityEventList.get(10).getCorrelationID();
    String encryptedPartCorrelationID12=contentEncryptedElementSecurityEventList.get(11).getCorrelationID();
    String encryptedPartCorrelationID13=contentEncryptedElementSecurityEventList.get(12).getCorrelationID();
    String encryptedPartCorrelationID14=contentEncryptedElementSecurityEventList.get(13).getCorrelationID();
    String encryptedPartCorrelationID15=contentEncryptedElementSecurityEventList.get(14).getCorrelationID();
    String encryptedPartCorrelationID16=contentEncryptedElementSecurityEventList.get(15).getCorrelationID();
    String encryptedPartCorrelationID17=contentEncryptedElementSecurityEventList.get(16).getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents1=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents2=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents3=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents4=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents5=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents6=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents7=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents8=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents9=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents10=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents11=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents12=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents13=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents14=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents15=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents16=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents17=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID1)) {
        encryptedPartSecurityEvents1.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID2)) {
        encryptedPartSecurityEvents2.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID3)) {
        encryptedPartSecurityEvents3.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID4)) {
        encryptedPartSecurityEvents4.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID5)) {
        encryptedPartSecurityEvents5.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID6)) {
        encryptedPartSecurityEvents6.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID7)) {
        encryptedPartSecurityEvents7.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID8)) {
        encryptedPartSecurityEvents8.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID9)) {
        encryptedPartSecurityEvents9.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID10)) {
        encryptedPartSecurityEvents10.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID11)) {
        encryptedPartSecurityEvents11.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID12)) {
        encryptedPartSecurityEvents12.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID13)) {
        encryptedPartSecurityEvents13.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID14)) {
        encryptedPartSecurityEvents14.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID15)) {
        encryptedPartSecurityEvents15.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID16)) {
        encryptedPartSecurityEvents16.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID17)) {
        encryptedPartSecurityEvents17.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents1.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents2.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents3.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents4.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents5.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents6.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents7.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents8.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents9.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents10.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents11.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents12.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents13.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents14.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents15.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents16.size());
    Assert.assertEquals(3,encryptedPartSecurityEvents17.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents1.size() + encryptedPartSecurityEvents2.size()+ encryptedPartSecurityEvents3.size()+ encryptedPartSecurityEvents4.size()+ encryptedPartSecurityEvents5.size()+ encryptedPartSecurityEvents6.size()+ encryptedPartSecurityEvents7.size()+ encryptedPartSecurityEvents8.size()+ encryptedPartSecurityEvents9.size()+ encryptedPartSecurityEvents10.size()+ encryptedPartSecurityEvents11.size()+ encryptedPartSecurityEvents12.size()+ encryptedPartSecurityEvents13.size()+ encryptedPartSecurityEvents14.size()+ encryptedPartSecurityEvents15.size()+ encryptedPartSecurityEvents16.size()+ encryptedPartSecurityEvents17.size()+ 1);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionUseThisCert() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    KeyStore keyStore=KeyStore.getInstance("jks");
    keyStore.load(this.getClass().getClassLoader().getResourceAsStream("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUseThisCertificate((X509Certificate)keyStore.getCertificate("receiver"));
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),"Body");
    NodeList childNodes=nodeList.item(0).getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new org.apache.wss4j.stax.test.CallbackHandlerImpl());
    Document document=doInboundSecurity(securityProperties,new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * rsa-oaep, Digest:SHA384, MGF:SHA1, PSource: None
 */
@Test public void testKeyWrappingRSAOAEPAES192GCMSHA384MGF1sha384Outbound() throws Exception {
  try {
    Security.addProvider(new BouncyCastleProvider());
    ByteArrayOutputStream baos;
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
      actions.add(WSSConstants.ENCRYPT);
      securityProperties.setActions(actions);
      securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.setEncryptionUser("receiver");
      securityProperties.setEncryptionSymAlgorithm("http://www.w3.org/2009/xmlenc11#aes192-gcm");
      securityProperties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2009/xmlenc11#rsa-oaep");
      securityProperties.setEncryptionKeyTransportDigestAlgorithm("http://www.w3.org/2001/04/xmldsig-more#sha384");
      securityProperties.setEncryptionKeyTransportMGFAlgorithm("http://www.w3.org/2009/xmlenc11#mgf1sha384");
      InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
      baos=doOutboundSecurity(securityProperties,sourceDocument);
      Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
      NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
      XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#rsa-oaep']");
      Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/dsig:DigestMethod[@Algorithm='http://www.w3.org/2001/04/xmldsig-more#sha384']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/xenc11:MGF[@Algorithm='http://www.w3.org/2009/xmlenc11#mgf1sha384']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#aes192-gcm']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
      NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
      for (int i=0; i < childNodes.getLength(); i++) {
        Node child=childNodes.item(i);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(0));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
{
      String action=WSHandlerConstants.ENCRYPT;
      doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
    }
  }
  finally {
    Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionCryptoPropertiesInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,new Properties());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(securedDocument,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    Properties properties=CryptoFactory.getProperties("receiver-crypto.properties",this.getClass().getClassLoader());
    securityProperties.setDecryptionCryptoProperties(properties);
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://schemas.xmlsoap.org/soap/envelope/","Body");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),2);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionCryptoPropertiesOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    Properties properties=CryptoFactory.getProperties("transmitter-crypto.properties",this.getClass().getClassLoader());
    securityProperties.setEncryptionCryptoProperties(properties);
    securityProperties.setEncryptionUser("receiver");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPartsContentOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUser("receiver");
    securityProperties.addEncryptionPart(new SecurePart(new QName("http://www.w3.org/1999/XMLSchema","complexType"),SecurePart.Modifier.Content));
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),25);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),25);
    for (int i=0; i < nodeList.getLength(); i++) {
      Assert.assertEquals(nodeList.item(i).getParentNode().getLocalName(),"complexType");
      Assert.assertEquals(nodeList.item(i).getParentNode().getNamespaceURI(),"http://www.w3.org/1999/XMLSchema");
      NodeList childNodes=nodeList.item(i).getParentNode().getChildNodes();
      for (int j=0; j < childNodes.getLength(); j++) {
        Node child=childNodes.item(j);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(i));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * rsa-oaep-mgf1p, Digest:SHA256, MGF:SHA1, PSource: None
 */
@Test public void testKeyWrappingRSAOAEPMGF1AESGCM128Outbound() throws Exception {
  try {
    Security.addProvider(new BouncyCastleProvider());
    ByteArrayOutputStream baos;
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
      actions.add(WSSConstants.ENCRYPT);
      securityProperties.setActions(actions);
      securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.setEncryptionUser("receiver");
      securityProperties.setEncryptionSymAlgorithm("http://www.w3.org/2009/xmlenc11#aes128-gcm");
      securityProperties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p");
      InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
      baos=doOutboundSecurity(securityProperties,sourceDocument);
      Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
      NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
      XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
      Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#aes128-gcm']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
      NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
      for (int i=0; i < childNodes.getLength(); i++) {
        Node child=childNodes.item(i);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(0));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
{
      String action=WSHandlerConstants.ENCRYPT;
      doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
    }
  }
  finally {
    Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testCompressedEncDecryption() throws Exception {
  Init.init(WSSec.class.getClassLoader().getResource("wss/wss-config.xml").toURI(),WSSec.class);
  Field algorithmsClassMapField=TransformerAlgorithmMapper.class.getDeclaredField("algorithmsClassMapOut");
  algorithmsClassMapField.setAccessible(true);
  Map<String,Class<?>> map=(Map<String,Class<?>>)algorithmsClassMapField.get(null);
  map.put("http://www.apache.org/2012/04/xmlsec/gzip",GzipCompressorOutputStream.class);
  algorithmsClassMapField=TransformerAlgorithmMapper.class.getDeclaredField("algorithmsClassMapIn");
  algorithmsClassMapField.setAccessible(true);
  map=(Map<String,Class<?>>)algorithmsClassMapField.get(null);
  map.put("http://www.apache.org/2012/04/xmlsec/gzip",GzipCompressorInputStream.class);
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUser("receiver");
    securityProperties.setEncryptionCompressionAlgorithm("http://www.apache.org/2012/04/xmlsec/gzip");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://schemas.xmlsoap.org/soap/envelope/","Body");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),2);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPropertiesOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    Map<String,Object> config=new HashMap<String,Object>();
    config.put(ConfigurationConstants.ACTION,ConfigurationConstants.ENCRYPT);
    config.put(ConfigurationConstants.ENCRYPTION_USER,"receiver");
    config.put(ConfigurationConstants.ENC_PROP_FILE,"transmitter-crypto.properties");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(config,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * rsa-oaep, Digest:SHA512, MGF:SHA1, PSource: Specified 8 bytes
 */
@Test public void testKeyWrappingRSAOAEPAESGCM192SHA384MGF1SHA384PSourceOutbound() throws Exception {
  try {
    Security.addProvider(new BouncyCastleProvider());
    ByteArrayOutputStream baos;
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
      actions.add(WSSConstants.ENCRYPT);
      securityProperties.setActions(actions);
      securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.setEncryptionUser("receiver");
      securityProperties.setEncryptionSymAlgorithm("http://www.w3.org/2009/xmlenc11#aes192-gcm");
      securityProperties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2009/xmlenc11#rsa-oaep");
      securityProperties.setEncryptionKeyTransportDigestAlgorithm("http://www.w3.org/2001/04/xmldsig-more#sha384");
      securityProperties.setEncryptionKeyTransportMGFAlgorithm("http://www.w3.org/2009/xmlenc11#mgf1sha384");
      securityProperties.setEncryptionKeyTransportOAEPParams(Base64.decode("ZHVtbXkxMjM=".getBytes(StandardCharsets.UTF_8)));
      InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
      baos=doOutboundSecurity(securityProperties,sourceDocument);
      Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
      NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
      XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#rsa-oaep']");
      Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/xenc:OAEPparams");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/dsig:DigestMethod[@Algorithm='http://www.w3.org/2001/04/xmldsig-more#sha384']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/xenc11:MGF[@Algorithm='http://www.w3.org/2009/xmlenc11#mgf1sha384']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#aes192-gcm']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
      NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
      for (int i=0; i < childNodes.getLength(); i++) {
        Node child=childNodes.item(i);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(0));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
{
      String action=WSHandlerConstants.ENCRYPT;
      doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
    }
  }
  finally {
    Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPartsHeaderInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-encryptedHeader.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Properties properties=new Properties();
    properties.setProperty(WSHandlerConstants.ENCRYPTION_PARTS,"{Header}{http://www.example.com}testEncryptedHeader;");
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
    NodeList nodeList=securedDocument.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new org.apache.wss4j.stax.test.CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_wsse11_EncryptedHeader.getNamespaceURI(),WSSConstants.TAG_wsse11_EncryptedHeader.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://www.example.com","testEncryptedHeader");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),3);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPartsElementInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Properties properties=new Properties();
    properties.setProperty(WSHandlerConstants.ENCRYPTION_PARTS,"{Element}{http://www.w3.org/1999/XMLSchema}simpleType;");
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
    NodeList nodeList=securedDocument.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new org.apache.wss4j.stax.test.CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.X509Token,WSSecurityEventConstants.OPERATION,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement,WSSecurityEventConstants.EncryptedKeyToken,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.EncryptedElement};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.EncryptedElement) {
        EncryptedElementSecurityEvent encryptedElementSecurityEvent=(EncryptedElementSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedElementSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedElementSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedElementSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://www.w3.org/1999/XMLSchema","simpleType");
        Assert.assertEquals(encryptedElementSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedElementSecurityEvent.getElementPath().size(),6);
        Assert.assertEquals(encryptedElementSecurityEvent.getElementPath().get(encryptedElementSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * rsa-oaep-mgf1p, Digest:SHA256, MGF:SHA1, PSource: None
 */
@Test public void testKeyWrappingRSAOAEPAESGCM192SHA256Outbound() throws Exception {
  try {
    Security.addProvider(new BouncyCastleProvider());
    ByteArrayOutputStream baos;
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
      actions.add(WSSConstants.ENCRYPT);
      securityProperties.setActions(actions);
      securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.setEncryptionUser("receiver");
      securityProperties.setEncryptionSymAlgorithm("http://www.w3.org/2009/xmlenc11#aes192-gcm");
      securityProperties.setEncryptionKeyTransportAlgorithm("http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p");
      securityProperties.setEncryptionKeyTransportDigestAlgorithm("http://www.w3.org/2001/04/xmlenc#sha256");
      InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
      baos=doOutboundSecurity(securityProperties,sourceDocument);
      Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
      NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
      XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
      Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod/dsig:DigestMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#sha256']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2009/xmlenc11#aes192-gcm']");
      node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
      Assert.assertNotNull(node);
      Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
      NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
      for (int i=0; i < childNodes.getLength(); i++) {
        Node child=childNodes.item(i);
        if (child.getNodeType() == Node.TEXT_NODE) {
          Assert.assertEquals(child.getTextContent().trim(),"");
        }
 else         if (child.getNodeType() == Node.ELEMENT_NODE) {
          Assert.assertEquals(child,nodeList.item(0));
        }
 else {
          Assert.fail("Unexpected Node encountered");
        }
      }
    }
{
      String action=WSHandlerConstants.ENCRYPT;
      doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
    }
  }
  finally {
    Security.removeProvider(BouncyCastleProvider.PROVIDER_NAME);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionDefaultConfigurationOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setEncryptionUser("receiver");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionDefaultConfigurationInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,new Properties());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(securedDocument,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),securityEventListener);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://schemas.xmlsoap.org/soap/envelope/","Body");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),2);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionPropertiesInbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    String action=WSHandlerConstants.ENCRYPT;
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,new Properties());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(securedDocument,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
  }
{
    Map<String,Object> config=new HashMap<String,Object>();
    config.put(ConfigurationConstants.ACTION,ConfigurationConstants.ENCRYPT);
    config.put(ConfigurationConstants.DEC_PROP_FILE,"receiver-crypto.properties");
    config.put(ConfigurationConstants.PW_CALLBACK_REF,new CallbackHandlerImpl());
    WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION};
    final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
    WSSSecurityProperties securityProperties=ConfigurationConverter.convert(config);
    InboundWSSec wsSecIn=WSSec.getInboundWSSec(securityProperties);
    XMLStreamReader outXmlStreamReader=wsSecIn.processInMessage(xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),new ArrayList<SecurityEvent>(),securityEventListener);
    Document document=StAX2DOM.readDoc(documentBuilderFactory.newDocumentBuilder(),outXmlStreamReader);
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),0);
    securityEventListener.compare();
    List<SecurityEvent> receivedSecurityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < receivedSecurityEvents.size(); i++) {
      SecurityEvent securityEvent=receivedSecurityEvents.get(i);
      if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.OPERATION) {
        OperationSecurityEvent operationSecurityEvent=(OperationSecurityEvent)securityEvent;
        Assert.assertEquals(operationSecurityEvent.getOperation(),new QName("http://schemas.xmlsoap.org/wsdl/","definitions"));
      }
 else       if (securityEvent.getSecurityEventType() == WSSecurityEventConstants.ENCRYPTED_PART) {
        EncryptedPartSecurityEvent encryptedPartSecurityEvent=(EncryptedPartSecurityEvent)securityEvent;
        Assert.assertNotNull(encryptedPartSecurityEvent.getXmlSecEvent());
        Assert.assertNotNull(encryptedPartSecurityEvent.getSecurityToken());
        Assert.assertNotNull(encryptedPartSecurityEvent.getElementPath());
        final QName expectedElementName=new QName("http://schemas.xmlsoap.org/soap/envelope/","Body");
        Assert.assertEquals(encryptedPartSecurityEvent.getXmlSecEvent().asStartElement().getName(),expectedElementName);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().size(),2);
        Assert.assertEquals(encryptedPartSecurityEvent.getElementPath().get(encryptedPartSecurityEvent.getElementPath().size() - 1),expectedElementName);
      }
    }
    EncryptedPartSecurityEvent encryptedPartSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.ENCRYPTED_PART);
    OperationSecurityEvent operationSecurityEvent=securityEventListener.getSecurityEvent(WSSecurityEventConstants.OPERATION);
    String encryptedPartCorrelationID=encryptedPartSecurityEvent.getCorrelationID();
    String operationCorrelationID=operationSecurityEvent.getCorrelationID();
    List<SecurityEvent> operationSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> encryptedPartSecurityEvents=new ArrayList<SecurityEvent>();
    List<SecurityEvent> securityEvents=securityEventListener.getReceivedSecurityEvents();
    for (int i=0; i < securityEvents.size(); i++) {
      SecurityEvent securityEvent=securityEvents.get(i);
      if (securityEvent.getCorrelationID().equals(encryptedPartCorrelationID)) {
        encryptedPartSecurityEvents.add(securityEvent);
      }
 else       if (securityEvent.getCorrelationID().equals(operationCorrelationID)) {
        operationSecurityEvents.add(securityEvent);
      }
    }
    Assert.assertEquals(4,encryptedPartSecurityEvents.size());
    Assert.assertEquals(securityEventListener.getReceivedSecurityEvents().size(),operationSecurityEvents.size() + encryptedPartSecurityEvents.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.EncryptionCRLTest </h4><pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptionWithOutRevocationCheck() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("wss40rev.jks"),"security".toCharArray());
    securityProperties.setEncryptionUser("wss40rev");
    securityProperties.setEncryptionKeyIdentifier(WSSecurityTokenConstants.KEYIDENTIFIER_SECURITY_TOKEN_DIRECT_REFERENCE);
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.InboundWSSecurityContextImplTest </h4><pre class="type-3 type-11 type-15 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenIdentificationTransportSecurity() throws Exception {
  final List<SecurityEvent> securityEventList=generateTransportBindingSecurityEvents();
  Assert.assertEquals(securityEventList.size(),11);
  for (int i=0; i < securityEventList.size(); i++) {
    SecurityEvent securityEvent=securityEventList.get(i);
    if (securityEvent instanceof HttpsTokenSecurityEvent) {
      HttpsTokenSecurityEvent tokenSecurityEvent=(HttpsTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),2);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE));
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION));
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent) {
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENDORSING_ENCRYPTED_SUPPORTING_TOKENS));
    }
 else     if (securityEvent instanceof UsernameTokenSecurityEvent) {
      UsernameTokenSecurityEvent tokenSecurityEvent=(UsernameTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENCRYPTED_SUPPORTING_TOKENS));
    }
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenIdentificationAsymmetricSecurity() throws Exception {
  final List<SecurityEvent> securityEventList=generateAsymmetricBindingSecurityEvents();
  boolean mainSignatureTokenOccured=false;
  boolean signedEndorsingSupportingTokenOccured=false;
  boolean signedEndorsingEncryptedSupportingTokenOccured=false;
  boolean supportingTokensOccured=false;
  boolean encryptedSupportingTokensOccured=false;
  boolean mainEncryptionTokenOccured=false;
  boolean usernameTokenOccured=false;
  Assert.assertEquals(securityEventList.size(),34);
  int x509TokenIndex=0;
  for (int i=0; i < securityEventList.size(); i++) {
    SecurityEvent securityEvent=securityEventList.get(i);
    if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 0) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION));
      mainEncryptionTokenOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 1) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_ENCRYPTED_SUPPORTING_TOKENS));
      signedEndorsingSupportingTokenOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 2) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SUPPORTING_TOKENS));
      encryptedSupportingTokensOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 3) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE));
      supportingTokensOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 4) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENDORSING_SUPPORTING_TOKENS));
      signedEndorsingEncryptedSupportingTokenOccured=true;
    }
 else     if (securityEvent instanceof X509TokenSecurityEvent && x509TokenIndex == 5) {
      x509TokenIndex++;
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENDORSING_ENCRYPTED_SUPPORTING_TOKENS));
      mainSignatureTokenOccured=true;
    }
 else     if (securityEvent instanceof UsernameTokenSecurityEvent) {
      UsernameTokenSecurityEvent tokenSecurityEvent=(UsernameTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENCRYPTED_SUPPORTING_TOKENS));
      usernameTokenOccured=true;
    }
  }
  Assert.assertTrue(mainSignatureTokenOccured);
  Assert.assertTrue(mainEncryptionTokenOccured);
  Assert.assertTrue(signedEndorsingSupportingTokenOccured);
  Assert.assertTrue(signedEndorsingEncryptedSupportingTokenOccured);
  Assert.assertTrue(supportingTokensOccured);
  Assert.assertTrue(encryptedSupportingTokensOccured);
  Assert.assertTrue(usernameTokenOccured);
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-7 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenIdentificationSymmetricSecurity() throws Exception {
  final List<SecurityEvent> securityEventList=generateSymmetricBindingSecurityEvents();
  Assert.assertEquals(securityEventList.size(),24);
  for (int i=0; i < securityEventList.size(); i++) {
    SecurityEvent securityEvent=securityEventList.get(i);
    if (securityEvent instanceof X509TokenSecurityEvent) {
      X509TokenSecurityEvent tokenSecurityEvent=(X509TokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENDORSING_SUPPORTING_TOKENS));
    }
 else     if (securityEvent instanceof UsernameTokenSecurityEvent) {
      UsernameTokenSecurityEvent tokenSecurityEvent=(UsernameTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),1);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_SIGNED_ENCRYPTED_SUPPORTING_TOKENS));
    }
 else     if (securityEvent instanceof SamlTokenSecurityEvent) {
      SamlTokenSecurityEvent tokenSecurityEvent=(SamlTokenSecurityEvent)securityEvent;
      Assert.assertEquals(tokenSecurityEvent.getSecurityToken().getTokenUsages().size(),2);
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_SIGNATURE));
      Assert.assertTrue(tokenSecurityEvent.getSecurityToken().getTokenUsages().contains(WSSecurityTokenConstants.TOKENUSAGE_MAIN_ENCRYPTION));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.InteroperabilityTest </h4><pre class="type-3 type-11 type-5 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Inclusive Canonicalization with Encryption is problematic because xenc namespace "leaks"
 * WSS4J sets the xenc ns on the soap envelope which is not included in the signature on the sending
 * side. swsssf sets the ns where it belongs and so we don't have this problem. But if we
 * get an xenc ns on the envelope we will get a signature error. This case can't be handled correctly.
 * This is also one of the reasons why a exclusive canonicalisation is preferred for SOAP
 * @throws Exception
 */
@Test public void testSignatureC14NInclusivePartsInbound() throws Exception {
  for (int i=0; i < 100; i++) {
    Document securedDocument;
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
      actions.add(WSSConstants.SIGNATURE);
      actions.add(WSSConstants.ENCRYPT);
      securityProperties.setActions(actions);
      securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
      securityProperties.setSignatureUser("transmitter");
      securityProperties.setEncryptionUser("receiver");
      securityProperties.addSignaturePart(new SecurePart(new QName("http://www.w3.org/1999/XMLSchema","complexType"),SecurePart.Modifier.Element));
      securityProperties.setSignatureCanonicalizationAlgorithm("http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments");
      securityProperties.setCallbackHandler(new CallbackHandlerImpl());
      OutboundWSSec wsSecOut=WSSec.getOutboundWSSec(securityProperties);
      XMLStreamWriter xmlStreamWriter=wsSecOut.processOutMessage(baos,StandardCharsets.UTF_8.name(),new ArrayList<SecurityEvent>());
      XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml"));
      XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
      xmlStreamWriter.close();
      securedDocument=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
      NodeList nodeList=securedDocument.getElementsByTagNameNS(WSSConstants.TAG_dsig_Signature.getNamespaceURI(),WSSConstants.TAG_dsig_Signature.getLocalPart());
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    }
{
      String action=WSHandlerConstants.SIGNATURE + " " + WSHandlerConstants.ENCRYPT;
      Properties properties=new Properties();
      doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action,properties,false);
    }
{
      WSSSecurityProperties securityProperties=new WSSSecurityProperties();
      securityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
      securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
      securityProperties.setCallbackHandler(new CallbackHandlerImpl());
      securityProperties.addIgnoreBSPRule(BSPRule.R5404);
      securityProperties.addIgnoreBSPRule(BSPRule.R5423);
      securityProperties.addIgnoreBSPRule(BSPRule.R5412);
      InboundWSSec wsSecIn=WSSec.getInboundWSSec(securityProperties);
      WSSecurityEventConstants.Event[] expectedSecurityEvents=new WSSecurityEventConstants.Event[]{WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.X509Token,WSSecurityEventConstants.SignatureValue,WSSecurityEventConstants.ENCRYPTED_PART,WSSecurityEventConstants.OPERATION,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.AlgorithmSuite,WSSecurityEventConstants.SignedElement};
      final TestSecurityEventListener securityEventListener=new TestSecurityEventListener(expectedSecurityEvents);
      XMLStreamReader xmlStreamReader=wsSecIn.processInMessage(xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())),null,securityEventListener);
      Document document=StAX2DOM.readDoc(documentBuilderFactory.newDocumentBuilder(),xmlStreamReader);
      NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Signature.getNamespaceURI(),WSSConstants.TAG_dsig_Signature.getLocalPart());
      Assert.assertEquals(nodeList.getLength(),1);
      Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
      securityEventListener.compare();
    }
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testInvalidXML() throws Exception {
  int i=0;
  int e=10000;
  while (i < e) {
    String action=WSHandlerConstants.USERNAME_TOKEN + " " + WSHandlerConstants.TIMESTAMP+ " "+ WSHandlerConstants.SIGNATURE+ " "+ WSHandlerConstants.ENCRYPT;
    Properties properties=new Properties();
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    Document securedDocument=doOutboundSecurityWithWSS4J(sourceDocument,action,properties);
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    if (i == 0) {
      i=indexOfNode(securedDocument.getDocumentElement(),new NodeIndex(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart()).index;
      e=indexOfNode(securedDocument.getDocumentElement(),new NodeIndex(),"definitions").index;
    }
    i++;
    Node nodeToRemove=nodeOnIndex(securedDocument.getDocumentElement(),new NodeIndex(),i).node;
    if (nodeToRemove.getNodeType() == Node.ATTRIBUTE_NODE) {
      ((Attr)nodeToRemove).getOwnerElement().removeAttributeNode((Attr)nodeToRemove);
    }
 else {
      Node parentNode=nodeToRemove.getParentNode();
      parentNode.removeChild(nodeToRemove);
    }
    javax.xml.transform.Transformer transformer=TRANSFORMER_FACTORY.newTransformer();
    transformer.transform(new DOMSource(securedDocument),new StreamResult(baos));
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    securityProperties.loadSignatureVerificationKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    securityProperties.loadDecryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
    Iterator<BSPRule> bspRules=EnumSet.allOf(BSPRule.class).iterator();
    while (bspRules.hasNext()) {
      securityProperties.addIgnoreBSPRule(bspRules.next());
    }
    try {
      Document document=doInboundSecurity(securityProperties,xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray())));
      transformer=TRANSFORMER_FACTORY.newTransformer();
      transformer.transform(new DOMSource(document),new StreamResult(new OutputStream(){
        @Override public void write(        int b) throws IOException {
        }
      }
));
    }
 catch (    XMLStreamException ex) {
      int k=0;
      Throwable t=ex.getCause();
      while (t != null && k < 100) {
        StringWriter stringWriter=new StringWriter();
        PrintWriter pw=new PrintWriter(stringWriter);
        ex.printStackTrace(pw);
        Assert.assertFalse(stringWriter.toString(),t instanceof NullPointerException);
        t=t.getCause();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.OutputChainTest </h4><pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptionAction() throws Exception {
  WSSSecurityProperties securityProperties=new WSSSecurityProperties();
  List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
  actions.add(WSSConstants.ENCRYPT);
  securityProperties.setActions(actions);
  securityProperties.loadEncryptionKeystore(this.getClass().getClassLoader().getResource("receiver.jks"),"default".toCharArray());
  securityProperties.setEncryptionUser("receiver");
  OutboundWSSec wsSecOut=WSSec.getOutboundWSSec(securityProperties);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  XMLStreamWriter xmlStreamWriter=wsSecOut.processOutMessage(baos,StandardCharsets.UTF_8.name(),new ArrayList<SecurityEvent>());
  XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml"));
  XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
  xmlStreamWriter.close();
  Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
  NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
  Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
  nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),1);
  Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),"Body");
  NodeList childNodes=nodeList.item(0).getParentNode().getChildNodes();
  for (int i=0; i < childNodes.getLength(); i++) {
    Node child=childNodes.item(i);
    if (child.getNodeType() == Node.TEXT_NODE) {
      Assert.assertEquals(child.getTextContent().trim(),"");
    }
 else     if (child.getNodeType() == Node.ELEMENT_NODE) {
      Assert.assertEquals(child,nodeList.item(0));
    }
 else {
      Assert.fail("Unexpected Node encountered");
    }
  }
  nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Signature.getNamespaceURI(),WSSConstants.TAG_dsig_Signature.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),0);
  nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_WSU_TIMESTAMP.getNamespaceURI(),WSSConstants.TAG_WSU_TIMESTAMP.getLocalPart());
  Assert.assertEquals(nodeList.getLength(),0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.PasswordEncryptorTest </h4><pre class="type-3 type-11 type-15 type-8 type-5 type-1 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncDecryptionCryptoPropertiesOutbound() throws Exception {
  ByteArrayOutputStream baos;
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.ENCRYPT);
    securityProperties.setActions(actions);
    Properties properties=CryptoFactory.getProperties("transmitter-crypto-enc.properties",this.getClass().getClassLoader());
    PasswordEncryptor passwordEncryptor=new JasyptPasswordEncryptor(new CallbackHandlerImpl());
    securityProperties.setEncryptionCryptoProperties(properties,passwordEncryptor);
    securityProperties.setEncryptionUser("receiver");
    InputStream sourceDocument=this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml");
    baos=doOutboundSecurity(securityProperties,sourceDocument);
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedKey.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedKey.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    XPathExpression xPathExpression=getXPath("/soap:Envelope/soap:Header/wsse:Security/xenc:EncryptedKey/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p']");
    Node node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_DataReference.getNamespaceURI(),WSSConstants.TAG_xenc_DataReference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_xenc_EncryptedData.getNamespaceURI(),WSSConstants.TAG_xenc_EncryptedData.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),1);
    xPathExpression=getXPath("/soap:Envelope/soap:Body/xenc:EncryptedData/xenc:EncryptionMethod[@Algorithm='http://www.w3.org/2001/04/xmlenc#aes256-cbc']");
    node=(Node)xPathExpression.evaluate(document,XPathConstants.NODE);
    Assert.assertNotNull(node);
    Assert.assertEquals(node.getParentNode().getParentNode().getLocalName(),"Body");
    NodeList childNodes=node.getParentNode().getParentNode().getChildNodes();
    for (int i=0; i < childNodes.getLength(); i++) {
      Node child=childNodes.item(i);
      if (child.getNodeType() == Node.TEXT_NODE) {
        Assert.assertEquals(child.getTextContent().trim(),"");
      }
 else       if (child.getNodeType() == Node.ELEMENT_NODE) {
        Assert.assertEquals(child,nodeList.item(0));
      }
 else {
        Assert.fail("Unexpected Node encountered");
      }
    }
  }
{
    String action=WSHandlerConstants.ENCRYPT;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.wss4j.stax.test.SignatureTest </h4><pre class="type-3 type-11 type-15 type-7 type-5 type-9 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignatureC14NInclusivePartsOutbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.SIGNATURE);
    securityProperties.setActions(actions);
    securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setSignatureUser("transmitter");
    securityProperties.addSignaturePart(new SecurePart(new QName("http://www.w3.org/1999/XMLSchema","complexType"),SecurePart.Modifier.Element));
    securityProperties.setSignatureCanonicalizationAlgorithm("http://www.w3.org/TR/2001/REC-xml-c14n-20010315#WithComments");
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    OutboundWSSec wsSecOut=WSSec.getOutboundWSSec(securityProperties);
    XMLStreamWriter xmlStreamWriter=wsSecOut.processOutMessage(baos,StandardCharsets.UTF_8.name(),new ArrayList<SecurityEvent>());
    XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml"));
    XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
    xmlStreamWriter.close();
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Signature.getNamespaceURI(),WSSConstants.TAG_dsig_Signature.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Reference.getNamespaceURI(),WSSConstants.TAG_dsig_Reference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),25);
    nodeList=document.getElementsByTagNameNS("http://www.w3.org/1999/XMLSchema","complexType");
    Assert.assertEquals(nodeList.getLength(),26);
    for (int i=0; i < nodeList.getLength(); i++) {
      String idAttrValue=((Element)nodeList.item(i)).getAttributeNS(WSSConstants.ATT_WSU_ID.getNamespaceURI(),WSSConstants.ATT_WSU_ID.getLocalPart());
      if (i == 10) {
        Assert.assertSame(idAttrValue,"");
      }
 else {
        Assert.assertNotSame(idAttrValue,"");
        Assert.assertTrue(idAttrValue.length() > 0);
      }
    }
  }
{
    String action=WSHandlerConstants.SIGNATURE;
    Properties properties=new Properties();
    doInboundSecurityWithWSS4J_1(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action,properties,false);
  }
}

</code></pre>

<br>
<pre class="type-3 type-11 type-15 type-7 type-5 type-9 type-1 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSignaturePartsOutbound() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
{
    WSSSecurityProperties securityProperties=new WSSSecurityProperties();
    List<WSSConstants.Action> actions=new ArrayList<WSSConstants.Action>();
    actions.add(WSSConstants.SIGNATURE);
    securityProperties.setActions(actions);
    securityProperties.loadSignatureKeyStore(this.getClass().getClassLoader().getResource("transmitter.jks"),"default".toCharArray());
    securityProperties.setSignatureUser("transmitter");
    securityProperties.addSignaturePart(new SecurePart(new QName("http://www.w3.org/1999/XMLSchema","complexType"),SecurePart.Modifier.Element));
    securityProperties.setCallbackHandler(new CallbackHandlerImpl());
    OutboundWSSec wsSecOut=WSSec.getOutboundWSSec(securityProperties);
    XMLStreamWriter xmlStreamWriter=wsSecOut.processOutMessage(baos,StandardCharsets.UTF_8.name(),new ArrayList<SecurityEvent>());
    XMLStreamReader xmlStreamReader=xmlInputFactory.createXMLStreamReader(this.getClass().getClassLoader().getResourceAsStream("testdata/plain-soap-1.1.xml"));
    XmlReaderToWriter.writeAll(xmlStreamReader,xmlStreamWriter);
    xmlStreamWriter.close();
    Document document=documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray()));
    NodeList nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Signature.getNamespaceURI(),WSSConstants.TAG_dsig_Signature.getLocalPart());
    Assert.assertEquals(nodeList.item(0).getParentNode().getLocalName(),WSSConstants.TAG_WSSE_SECURITY.getLocalPart());
    nodeList=document.getElementsByTagNameNS(WSSConstants.TAG_dsig_Reference.getNamespaceURI(),WSSConstants.TAG_dsig_Reference.getLocalPart());
    Assert.assertEquals(nodeList.getLength(),25);
    nodeList=document.getElementsByTagNameNS("http://www.w3.org/1999/XMLSchema","complexType");
    Assert.assertEquals(nodeList.getLength(),26);
    for (int i=0; i < nodeList.getLength(); i++) {
      String idAttrValue=((Element)nodeList.item(i)).getAttributeNS(WSSConstants.ATT_WSU_ID.getNamespaceURI(),WSSConstants.ATT_WSU_ID.getLocalPart());
      if (i == 10) {
        Assert.assertSame(idAttrValue,"");
      }
 else {
        Assert.assertNotSame(idAttrValue,"");
        Assert.assertTrue(idAttrValue.length() > 0);
      }
    }
  }
{
    String action=WSHandlerConstants.SIGNATURE;
    doInboundSecurityWithWSS4J(documentBuilderFactory.newDocumentBuilder().parse(new ByteArrayInputStream(baos.toByteArray())),action);
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
