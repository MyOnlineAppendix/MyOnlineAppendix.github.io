<h3><span class=" glyphicon glyphicon-tag"/>&nbspNullVerifier</h3><kbd>Verifies whether objects are null</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.helix.TestConfigAccessor </h4><pre class="type-4 type-5 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasic() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,10,5,3,"MasterSlave",true);
  ConfigAccessor configAccessor=new ConfigAccessor(_zkclient);
  HelixConfigScope clusterScope=new HelixConfigScopeBuilder(ConfigScopeProperty.CLUSTER).forCluster(clusterName).build();
  String clusterConfigValue=configAccessor.get(clusterScope,"clusterConfigKey");
  Assert.assertNull(clusterConfigValue);
  for (int i=0; i < 2; i++) {
    configAccessor.set(clusterScope,"clusterConfigKey" + i,"clusterConfigValue" + i);
    clusterConfigValue=configAccessor.get(clusterScope,"clusterConfigKey" + i);
    Assert.assertEquals(clusterConfigValue,"clusterConfigValue" + i);
  }
  HelixConfigScope resourceScope=new HelixConfigScopeBuilder(ConfigScopeProperty.RESOURCE).forCluster(clusterName).forResource("testResource").build();
  configAccessor.set(resourceScope,"resourceConfigKey","resourceConfigValue");
  String resourceConfigValue=configAccessor.get(resourceScope,"resourceConfigKey");
  Assert.assertEquals(resourceConfigValue,"resourceConfigValue");
  HelixConfigScope partitionScope=new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forCluster(clusterName).forResource("testResource").forPartition("testPartition").build();
  configAccessor.set(partitionScope,"partitionConfigKey","partitionConfigValue");
  String partitionConfigValue=configAccessor.get(partitionScope,"partitionConfigKey");
  Assert.assertEquals(partitionConfigValue,"partitionConfigValue");
  HelixConfigScope participantScope=new HelixConfigScopeBuilder(ConfigScopeProperty.PARTICIPANT).forCluster(clusterName).forParticipant("localhost_12918").build();
  configAccessor.set(participantScope,"participantConfigKey","participantConfigValue");
  String participantConfigValue=configAccessor.get(participantScope,"participantConfigKey");
  Assert.assertEquals(participantConfigValue,"participantConfigValue");
  HelixConfigScope partialResourceScope=new HelixConfigScopeBuilder(ConfigScopeProperty.RESOURCE).forCluster(clusterName).build();
  List<String> keys=configAccessor.getKeys(partialResourceScope);
  Assert.assertEquals(keys.size(),1,"should be [testResource]");
  Assert.assertEquals(keys.get(0),"testResource");
  keys=configAccessor.getKeys(clusterScope);
  Assert.assertEquals(keys.size(),2,"should be [clusterConfigKey0, clusterConfigKey1]");
  Assert.assertEquals(keys.get(0),"clusterConfigKey0");
  Assert.assertEquals(keys.get(1),"clusterConfigKey1");
  HelixConfigScope partialParticipantScope=new HelixConfigScopeBuilder(ConfigScopeProperty.PARTICIPANT).forCluster(clusterName).build();
  keys=configAccessor.getKeys(partialParticipantScope);
  Assert.assertEquals(keys.size(),5,"should be [localhost_12918~22] sorted");
  Assert.assertEquals(keys.get(0),"localhost_12918");
  Assert.assertEquals(keys.get(4),"localhost_12922");
  HelixConfigScope partialPartitionScope=new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forCluster(clusterName).forResource("testResource").build();
  keys=configAccessor.getKeys(partialPartitionScope);
  Assert.assertEquals(keys.size(),1,"should be [testPartition]");
  Assert.assertEquals(keys.get(0),"testPartition");
  keys=configAccessor.getKeys(resourceScope);
  Assert.assertEquals(keys.size(),1,"should be [resourceConfigKey]");
  Assert.assertEquals(keys.get(0),"resourceConfigKey");
  keys=configAccessor.getKeys(participantScope);
  System.out.println((keys));
  Assert.assertEquals(keys.size(),4,"should be [HELIX_ENABLED, HELIX_HOST, HELIX_PORT, participantConfigKey]");
  Assert.assertEquals(keys.get(3),"participantConfigKey");
  keys=configAccessor.getKeys(partitionScope);
  Assert.assertEquals(keys.size(),1,"should be [partitionConfigKey]");
  Assert.assertEquals(keys.get(0),"partitionConfigKey");
  configAccessor.remove(clusterScope,"clusterConfigKey");
  clusterConfigValue=configAccessor.get(clusterScope,"clusterConfigKey");
  Assert.assertNull(clusterConfigValue,"Should be null since it's removed");
  configAccessor.remove(resourceScope,"resourceConfigKey");
  resourceConfigValue=configAccessor.get(resourceScope,"resourceConfigKey");
  Assert.assertNull(resourceConfigValue,"Should be null since it's removed");
  configAccessor.remove(partitionScope,"partitionConfigKey");
  partitionConfigValue=configAccessor.get(partitionScope,"partitionConfigKey");
  Assert.assertNull(partitionConfigValue,"Should be null since it's removed");
  configAccessor.remove(participantScope,"participantConfigKey");
  participantConfigValue=configAccessor.get(partitionScope,"participantConfigKey");
  Assert.assertNull(participantConfigValue,"Should be null since it's removed");
  try {
    new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forPartition("testPartition").build();
    Assert.fail("Should fail since cluster name is not set");
  }
 catch (  Exception e) {
  }
  try {
    new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forCluster("testCluster").forPartition("testPartition").build();
    Assert.fail("Should fail since resource name is not set");
  }
 catch (  Exception e) {
  }
  try {
    new HelixConfigScopeBuilder(ConfigScopeProperty.PARTICIPANT).forParticipant("testParticipant").build();
    Assert.fail("Should fail since cluster name is not set");
  }
 catch (  Exception e) {
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.TestGetProperty </h4><pre class="type-7 type-5 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperty(){
  String version;
  Properties props=new Properties();
  try {
    InputStream stream=Thread.currentThread().getContextClassLoader().getResourceAsStream("cluster-manager-version.properties");
    props.load(stream);
    version=props.getProperty("clustermanager.version");
    Assert.assertNotNull(version);
    System.out.println("cluster-manager-version:" + version);
  }
 catch (  IOException e) {
    Assert.fail("could not open cluster-manager-version.properties. ",e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.TestHelixConfigAccessor </h4><pre class="type-5 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasic() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,10,5,3,"MasterSlave",true);
  ConfigAccessor configAccessor=new ConfigAccessor(_zkclient);
  HelixConfigScope clusterScope=new HelixConfigScopeBuilder(ConfigScopeProperty.CLUSTER).forCluster(clusterName).build();
  String clusterConfigValue=configAccessor.get(clusterScope,"clusterConfigKey");
  Assert.assertNull(clusterConfigValue);
  configAccessor.set(clusterScope,"clusterConfigKey","clusterConfigValue");
  clusterConfigValue=configAccessor.get(clusterScope,"clusterConfigKey");
  Assert.assertEquals(clusterConfigValue,"clusterConfigValue");
  HelixConfigScope resourceScope=new HelixConfigScopeBuilder(ConfigScopeProperty.RESOURCE).forCluster(clusterName).forResource("testResource").build();
  configAccessor.set(resourceScope,"resourceConfigKey","resourceConfigValue");
  String resourceConfigValue=configAccessor.get(resourceScope,"resourceConfigKey");
  Assert.assertEquals(resourceConfigValue,"resourceConfigValue");
  HelixConfigScope partitionScope=new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forCluster(clusterName).forResource("testResource").forPartition("testPartition").build();
  configAccessor.set(partitionScope,"partitionConfigKey","partitionConfigValue");
  String partitionConfigValue=configAccessor.get(partitionScope,"partitionConfigKey");
  Assert.assertEquals(partitionConfigValue,"partitionConfigValue");
  HelixConfigScope participantScope=new HelixConfigScopeBuilder(ConfigScopeProperty.PARTICIPANT).forCluster(clusterName).forParticipant("localhost_12918").build();
  configAccessor.set(participantScope,"participantConfigKey","participantConfigValue");
  String participantConfigValue=configAccessor.get(participantScope,"participantConfigKey");
  Assert.assertEquals(participantConfigValue,"participantConfigValue");
  List<String> keys=configAccessor.getKeys(new HelixConfigScopeBuilder(ConfigScopeProperty.RESOURCE).forCluster(clusterName).build());
  Assert.assertEquals(keys.size(),1,"should be [testResource]");
  Assert.assertEquals(keys.get(0),"testResource");
  keys=configAccessor.getKeys(new HelixConfigScopeBuilder(ConfigScopeProperty.PARTICIPANT).forCluster(clusterName).build());
  Assert.assertEquals(keys.size(),5,"should be [localhost_12918~22] sorted");
  Assert.assertTrue(keys.contains("localhost_12918"));
  Assert.assertTrue(keys.contains("localhost_12922"));
  keys=configAccessor.getKeys(new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forCluster(clusterName).forResource("testResource").build());
  Assert.assertEquals(keys.size(),1,"should be [testPartition]");
  Assert.assertEquals(keys.get(0),"testPartition");
  keys=configAccessor.getKeys(new HelixConfigScopeBuilder(ConfigScopeProperty.RESOURCE).forCluster(clusterName).forResource("testResource").build());
  Assert.assertEquals(keys.size(),1,"should be [resourceConfigKey]");
  Assert.assertTrue(keys.contains("resourceConfigKey"));
  keys=configAccessor.getKeys(new HelixConfigScopeBuilder(ConfigScopeProperty.CLUSTER).forCluster(clusterName).build());
  Assert.assertEquals(keys.size(),1,"should be [clusterConfigKey]");
  Assert.assertTrue(keys.contains("clusterConfigKey"));
  keys=configAccessor.getKeys(new HelixConfigScopeBuilder(ConfigScopeProperty.PARTICIPANT).forCluster(clusterName).forParticipant("localhost_12918").build());
  Assert.assertEquals(keys.size(),4,"should be [HELIX_ENABLED, HELIX_PORT, HELIX_HOST, participantConfigKey]");
  Assert.assertTrue(keys.contains("participantConfigKey"));
  keys=configAccessor.getKeys(new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forCluster(clusterName).forResource("testResource").forPartition("testPartition").build());
  Assert.assertEquals(keys.size(),1,"should be [partitionConfigKey]");
  Assert.assertEquals(keys.get(0),"partitionConfigKey");
  configAccessor.remove(clusterScope,"clusterConfigKey");
  clusterConfigValue=configAccessor.get(clusterScope,"clusterConfigKey");
  Assert.assertNull(clusterConfigValue,"Should be null since it's removed");
  configAccessor.remove(resourceScope,"resourceConfigKey");
  resourceConfigValue=configAccessor.get(resourceScope,"resourceConfigKey");
  Assert.assertNull(resourceConfigValue,"Should be null since it's removed");
  configAccessor.remove(partitionScope,"partitionConfigKey");
  partitionConfigValue=configAccessor.get(partitionScope,"partitionConfigKey");
  Assert.assertNull(partitionConfigValue,"Should be null since it's removed");
  configAccessor.remove(participantScope,"participantConfigKey");
  participantConfigValue=configAccessor.get(partitionScope,"participantConfigKey");
  Assert.assertNull(participantConfigValue,"Should be null since it's removed");
  try {
    new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forPartition("testPartition").build();
    Assert.fail("Should fail since cluster name is not set");
  }
 catch (  Exception e) {
  }
  try {
    new HelixConfigScopeBuilder(ConfigScopeProperty.PARTICIPANT).forParticipant("testParticipant").build();
    Assert.fail("Should fail since cluster name is not set");
  }
 catch (  Exception e) {
  }
  try {
    new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forCluster("testCluster").forPartition("testPartition").build();
    Assert.fail("Should fail since resource name is not set");
  }
 catch (  Exception e) {
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.TestRoutingTable </h4><pre class="type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testSimple(){
  List<InstanceConfig> instances;
  RoutingTableProvider routingTable=new RoutingTableProvider();
  ZNRecord record=new ZNRecord("TESTDB");
  add(record,"TESTDB_0","localhost_8900","MASTER");
  List<ExternalView> externalViewList=new ArrayList<ExternalView>();
  externalViewList.add(new ExternalView(record));
  routingTable.onExternalViewChange(externalViewList,changeContext);
  instances=routingTable.getInstances("TESTDB","TESTDB_0","MASTER");
  AssertJUnit.assertNotNull(instances);
  AssertJUnit.assertEquals(instances.size(),1);
  add(record,"TESTDB_0","localhost_8901","MASTER");
  add(record,"TESTDB_1","localhost_8900","SLAVE");
  externalViewList=new ArrayList<ExternalView>();
  externalViewList.add(new ExternalView(record));
  routingTable.onExternalViewChange(externalViewList,changeContext);
  instances=routingTable.getInstances("TESTDB","TESTDB_0","MASTER");
  AssertJUnit.assertNotNull(instances);
  AssertJUnit.assertEquals(instances.size(),2);
  instances=routingTable.getInstances("TESTDB","TESTDB_1","SLAVE");
  AssertJUnit.assertNotNull(instances);
  AssertJUnit.assertEquals(instances.size(),1);
  add(record,"TESTDB_0","localhost_8901","SLAVE");
  externalViewList=new ArrayList<ExternalView>();
  externalViewList.add(new ExternalView(record));
  routingTable.onExternalViewChange(externalViewList,changeContext);
  instances=routingTable.getInstances("TESTDB","TESTDB_0","SLAVE");
  AssertJUnit.assertNotNull(instances);
  AssertJUnit.assertEquals(instances.size(),1);
}

</code></pre>

<br>
<pre class="type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testStateUnitGroupDeletion(){
  List<InstanceConfig> instances;
  RoutingTableProvider routingTable=new RoutingTableProvider();
  List<ExternalView> externalViewList=new ArrayList<ExternalView>();
  ZNRecord record=new ZNRecord("TESTDB");
  add(record,"TESTDB_0","localhost_8900","MASTER");
  externalViewList.add(new ExternalView(record));
  routingTable.onExternalViewChange(externalViewList,changeContext);
  instances=routingTable.getInstances("TESTDB","TESTDB_0","MASTER");
  AssertJUnit.assertNotNull(instances);
  AssertJUnit.assertEquals(instances.size(),1);
  externalViewList.clear();
  routingTable.onExternalViewChange(externalViewList,changeContext);
  instances=routingTable.getInstances("TESTDB","TESTDB_0","MASTER");
  AssertJUnit.assertNotNull(instances);
  AssertJUnit.assertEquals(instances.size(),0);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testGetInstanceForAllStateUnits(){
  List<InstanceConfig> instancesList;
  Set<InstanceConfig> instancesSet;
  InstanceConfig instancesArray[];
  RoutingTableProvider routingTable=new RoutingTableProvider();
  List<ExternalView> externalViewList=new ArrayList<ExternalView>();
  ZNRecord record=new ZNRecord("TESTDB");
  add(record,"TESTDB_0","localhost_8900","MASTER");
  add(record,"TESTDB_1","localhost_8900","MASTER");
  add(record,"TESTDB_2","localhost_8900","MASTER");
  add(record,"TESTDB_3","localhost_8900","SLAVE");
  add(record,"TESTDB_4","localhost_8900","SLAVE");
  add(record,"TESTDB_5","localhost_8900","SLAVE");
  add(record,"TESTDB_0","localhost_8901","SLAVE");
  add(record,"TESTDB_1","localhost_8901","SLAVE");
  add(record,"TESTDB_2","localhost_8901","SLAVE");
  add(record,"TESTDB_3","localhost_8901","MASTER");
  add(record,"TESTDB_4","localhost_8901","MASTER");
  add(record,"TESTDB_5","localhost_8901","MASTER");
  externalViewList.add(new ExternalView(record));
  routingTable.onExternalViewChange(externalViewList,changeContext);
  instancesList=routingTable.getInstances("TESTDB","TESTDB_0","MASTER");
  AssertJUnit.assertNotNull(instancesList);
  AssertJUnit.assertEquals(instancesList.size(),1);
  instancesSet=routingTable.getInstances("TESTDB","MASTER");
  AssertJUnit.assertNotNull(instancesSet);
  AssertJUnit.assertEquals(instancesSet.size(),2);
  instancesSet=routingTable.getInstances("TESTDB","SLAVE");
  AssertJUnit.assertNotNull(instancesSet);
  AssertJUnit.assertEquals(instancesSet.size(),2);
  instancesArray=new InstanceConfig[instancesSet.size()];
  instancesSet.toArray(instancesArray);
  AssertJUnit.assertEquals(instancesArray[0].getHostName(),"localhost");
  AssertJUnit.assertEquals(instancesArray[0].getPort(),"8900");
  AssertJUnit.assertEquals(instancesArray[1].getHostName(),"localhost");
  AssertJUnit.assertEquals(instancesArray[1].getPort(),"8901");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.TestZNRecord </h4><pre class="type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtract(){
  ZNRecord record=new ZNRecord("test");
  Map<String,String> map=new HashMap<String,String>();
  map.put("mapKey1","mapValue1");
  map.put("mapKey2","mapValue2");
  record.setMapField("key1",map);
  ZNRecord delta=new ZNRecord("test");
  Map<String,String> deltaMap=new HashMap<String,String>();
  deltaMap.put("mapKey1","mapValue1");
  delta.setMapField("key1",deltaMap);
  record.subtract(delta);
  Assert.assertEquals(record.getMapFields().size(),1);
  Assert.assertNotNull(record.getMapField("key1"));
  Assert.assertEquals(record.getMapField("key1").size(),1);
  Assert.assertNotNull(record.getMapField("key1").get("mapKey2"));
  Assert.assertEquals(record.getMapField("key1").get("mapKey2"),"mapValue2");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.TestZkBasis </h4><pre class="type-8 type-2 type-6 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test zk watchers are renewed automatically after session expiry
 * zookeeper-client side keeps all registered watchers see ZooKeeper.WatchRegistration.register()
 * after session expiry, all watchers are renewed
 * if a path that has watches on it has been removed during session expiry,
 * the watchers on that path will still get callbacks after session renewal, especially:
 * a data-watch will get data-deleted callback
 * a child-watch will get a child-change callback with current-child-list = null
 * this can be used for cleanup watchers on the zookeeper-client side
 */
@Test public void testWatchRenew() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  final ZkClient client=new ZkClient(_zkaddr,ZkClient.DEFAULT_SESSION_TIMEOUT,ZkClient.DEFAULT_CONNECTION_TIMEOUT,new ZNRecordSerializer());
  final String path="/" + testName + "/test";
  client.delete(path);
  ZkListener listener=new ZkListener();
  client.subscribeDataChanges(path,listener);
  client.subscribeChildChanges(path,listener);
  ZkTestHelper.expireSession(client);
  boolean succeed=listener._childChangeCountDown.await(10,TimeUnit.SECONDS);
  Assert.assertTrue(succeed,"fail to wait on child-change count-down in 10 seconds after session-expiry");
  Assert.assertEquals(listener._parentPath,path,"fail to get child-change callback after session-expiry");
  Assert.assertNull(listener._currentChilds,"fail to get child-change callback with currentChilds=null after session expiry");
  succeed=listener._dataDeleteCountDown.await(10,TimeUnit.SECONDS);
  Assert.assertTrue(succeed,"fail to wait on data-delete count-down in 10 seconds after session-expiry");
  Assert.assertEquals(listener._dataDeletePath,path,"fail to get data-delete callback after session-expiry");
  client.close();
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * after calling zkclient#unsubscribeXXXListener()
 * an already registered watch will not be removed from ZooKeeper#watchManager#XXXWatches
 * immediately.
 * the watch will get removed on the following conditions:
 * 1) there is a set/delete on the listening path via the zkclient
 * 2) session expiry on the zkclient (i.e. the watch will not be renewed after session expiry)
 * @throws Exception
 */
@Test public void testWatchRemove() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  final ZkClient client=new ZkClient(_zkaddr,ZkClient.DEFAULT_SESSION_TIMEOUT,ZkClient.DEFAULT_CONNECTION_TIMEOUT,new ZNRecordSerializer());
  final String path="/" + testName + "/test";
  client.createPersistent(path,true);
  ZkListener listener=new ZkListener();
  client.subscribeDataChanges(path,listener);
  client.subscribeChildChanges(path,listener);
  Map<String,Set<IZkDataListener>> dataListenerMap=ZkTestHelper.getZkDataListener(client);
  Assert.assertEquals(dataListenerMap.size(),1,"ZkClient#_dataListener should have 1 listener");
  Set<IZkDataListener> dataListenerSet=dataListenerMap.get(path);
  Assert.assertNotNull(dataListenerSet,"ZkClient#_dataListener should have 1 listener on path: " + path);
  Assert.assertEquals(dataListenerSet.size(),1,"ZkClient#_dataListener should have 1 listener on path: " + path);
  Map<String,Set<IZkChildListener>> childListenerMap=ZkTestHelper.getZkChildListener(client);
  Assert.assertEquals(childListenerMap.size(),1,"ZkClient#_childListener should have 1 listener");
  Set<IZkChildListener> childListenerSet=childListenerMap.get(path);
  Assert.assertNotNull(childListenerSet,"ZkClient#_childListener should have 1 listener on path: " + path);
  Assert.assertEquals(childListenerSet.size(),1,"ZkClient#_childListener should have 1 listener on path: " + path);
  Map<String,List<String>> watchMap=ZkTestHelper.getZkWatch(client);
  List<String> dataWatch=watchMap.get("dataWatches");
  Assert.assertNotNull(dataWatch,"ZooKeeper#watchManager#dataWatches should have 1 data watch on path: " + path);
  Assert.assertEquals(dataWatch.size(),1,"ZooKeeper#watchManager#dataWatches should have 1 data watch on path: " + path);
  Assert.assertEquals(dataWatch.get(0),path,"ZooKeeper#watchManager#dataWatches should have 1 data watch on path: " + path);
  List<String> childWatch=watchMap.get("childWatches");
  Assert.assertNotNull(childWatch,"ZooKeeper#watchManager#childWatches should have 1 child watch on path: " + path);
  Assert.assertEquals(childWatch.size(),1,"ZooKeeper#watchManager#childWatches should have 1 child watch on path: " + path);
  Assert.assertEquals(childWatch.get(0),path,"ZooKeeper#watchManager#childWatches should have 1 child watch on path: " + path);
  client.unsubscribeDataChanges(path,listener);
  client.unsubscribeChildChanges(path,listener);
  ZkTestHelper.expireSession(client);
  watchMap=ZkTestHelper.getZkWatch(client);
  dataWatch=watchMap.get("dataWatches");
  Assert.assertTrue(dataWatch.isEmpty(),"ZooKeeper#watchManager#dataWatches should be empty");
  childWatch=watchMap.get("childWatches");
  Assert.assertTrue(childWatch.isEmpty(),"ZooKeeper#watchManager#childWatches should be empty");
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.TestZkClientWrapper </h4><pre class="type-1 type-11 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() void testGetStat(){
  String path="/tmp/getStatTest";
  _zkClient.deleteRecursive(path);
  Stat stat, newStat;
  stat=_zkClient.getStat(path);
  AssertJUnit.assertNull(stat);
  _zkClient.createPersistent(path,true);
  stat=_zkClient.getStat(path);
  AssertJUnit.assertNotNull(stat);
  newStat=_zkClient.getStat(path);
  AssertJUnit.assertEquals(stat,newStat);
  _zkClient.writeData(path,new ZNRecord("Test"));
  newStat=_zkClient.getStat(path);
  AssertJUnit.assertNotSame(stat,newStat);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.api.TestId </h4><pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
/** 
 * Ensure that trying to create an id with null yields null
 */
@Test public void testNull(){
  Assert.assertNull(ClusterId.from(null));
  Assert.assertNull(ResourceId.from(null));
  Assert.assertNull(PartitionId.from(null));
  Assert.assertNull(ParticipantId.from(null));
  Assert.assertNull(SessionId.from(null));
  Assert.assertNull(ProcId.from(null));
  Assert.assertNull(StateModelDefId.from(null));
  Assert.assertNull(StateModelFactoryId.from(null));
  Assert.assertNull(MessageId.from(null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.api.TestNamespacedConfig </h4><pre class="type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceUserConfigCompatibility(){
  final String KEY1="key1";
  final String VALUE1="value1";
  final String KEY2="key2";
  final String VALUE2="value2";
  final String KEY3="key3";
  final String VALUE3="value3";
  ResourceId resourceId=ResourceId.from("resourceId");
  UserConfig userConfig=new UserConfig(Scope.resource(resourceId));
  userConfig.setSimpleField(KEY1,VALUE1);
  ResourceConfiguration resourceConfig=new ResourceConfiguration(resourceId);
  resourceConfig.addNamespacedConfig(userConfig);
  resourceConfig.getRecord().setSimpleField(KEY2,VALUE2);
  IdealState idealState=new IdealState(resourceId);
  idealState.setRebalanceMode(RebalanceMode.USER_DEFINED);
  idealState.getRecord().setSimpleField(KEY3,VALUE3);
  UserConfig result=resourceConfig.getUserConfig();
  idealState.updateUserConfig(result);
  Assert.assertEquals(result.getSimpleField(KEY1),VALUE1);
  Assert.assertEquals(result.getSimpleField(KEY2),VALUE2);
  Assert.assertEquals(result.getSimpleField(KEY3),VALUE3);
  Assert.assertNull(result.getSimpleField(IdealState.IdealStateProperty.REBALANCE_MODE.toString()));
}

</code></pre>

<br>
<pre class="type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParticipantUserConfigCompatibility(){
  final String KEY1="key1";
  final String VALUE1="value1";
  final String KEY2="key2";
  final String VALUE2="value2";
  ParticipantId participantId=ParticipantId.from("participantId");
  UserConfig userConfig=new UserConfig(Scope.participant(participantId));
  userConfig.setSimpleField(KEY1,VALUE1);
  InstanceConfig instanceConfig=new InstanceConfig(participantId);
  instanceConfig.setHostName("localhost");
  instanceConfig.addNamespacedConfig(userConfig);
  instanceConfig.getRecord().setSimpleField(KEY2,VALUE2);
  UserConfig result=instanceConfig.getUserConfig();
  Assert.assertEquals(result.getSimpleField(KEY1),VALUE1);
  Assert.assertEquals(result.getSimpleField(KEY2),VALUE2);
  Assert.assertNull(result.getSimpleField(InstanceConfig.InstanceConfigProperty.HELIX_HOST.toString()));
}

</code></pre>

<br>
<pre class="type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClusterUserConfigCompatibility(){
  final String KEY1="key1";
  final String VALUE1="value1";
  final String KEY2="key2";
  final String VALUE2="value2";
  ClusterId clusterId=ClusterId.from("clusterId");
  UserConfig userConfig=new UserConfig(Scope.cluster(clusterId));
  userConfig.setSimpleField(KEY1,VALUE1);
  ClusterConfiguration clusterConfiguration=new ClusterConfiguration(clusterId);
  clusterConfiguration.addNamespacedConfig(userConfig);
  clusterConfiguration.getRecord().setSimpleField(KEY2,VALUE2);
  clusterConfiguration.setAutoJoinAllowed(true);
  UserConfig result=clusterConfiguration.getUserConfig();
  Assert.assertEquals(result.getSimpleField(KEY1),VALUE1);
  Assert.assertEquals(result.getSimpleField(KEY2),VALUE2);
  Assert.assertNull(result.getSimpleField(ZKHelixManager.ALLOW_PARTICIPANT_AUTO_JOIN));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.controller.stages.TestStagesWithLogicalAccessors </h4><pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadClusterDataStage(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  ClusterAccessor clusterAccessor=new ClusterAccessor(_clusterId,_dataAccessor);
  Cluster cluster=clusterAccessor.readCluster();
  ClusterId id=cluster.getId();
  Assert.assertEquals(id,_clusterId);
  Map<ParticipantId,Participant> liveParticipantMap=cluster.getLiveParticipantMap();
  Assert.assertEquals(liveParticipantMap.size(),n);
  for (  ParticipantId participantId : liveParticipantMap.keySet()) {
    Participant participant=liveParticipantMap.get(participantId);
    Map<ResourceId,CurrentState> curStateMap=participant.getCurrentStateMap();
    Assert.assertEquals(curStateMap.size(),1);
    ResourceId resourceId=ResourceId.from("TestDB0");
    Assert.assertTrue(curStateMap.containsKey(resourceId));
    CurrentState curState=curStateMap.get(resourceId);
    Map<PartitionId,State> partitionStateMap=curState.getTypedPartitionStateMap();
    Assert.assertEquals(partitionStateMap.size(),p);
  }
  Map<ResourceId,Resource> resourceMap=cluster.getResourceMap();
  Assert.assertEquals(resourceMap.size(),1);
  ResourceId resourceId=ResourceId.from("TestDB0");
  Assert.assertTrue(resourceMap.containsKey(resourceId));
  Resource resource=resourceMap.get(resourceId);
  Assert.assertNotNull(resource.getIdealState());
  Assert.assertEquals(resource.getIdealState().getRebalanceMode(),RebalanceMode.SEMI_AUTO);
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-5 type-1 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicBestPossibleStateCalcStage(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  ClusterAccessor clusterAccessor=new ClusterAccessor(_clusterId,_dataAccessor);
  Cluster cluster=clusterAccessor.readCluster();
  ClusterEvent event=new ClusterEvent(testName);
  event.addAttribute(AttributeName.CURRENT_STATE.toString(),new ResourceCurrentState());
  Map<ResourceId,ResourceConfig> resourceConfigMap=Maps.transformValues(cluster.getResourceMap(),new Function<Resource,ResourceConfig>(){
    @Override public ResourceConfig apply(    Resource resource){
      return resource.getConfig();
    }
  }
);
  event.addAttribute(AttributeName.RESOURCES.toString(),resourceConfigMap);
  event.addAttribute("Cluster",cluster);
  try {
    new BestPossibleStateCalcStage().process(event);
  }
 catch (  Exception e) {
    Assert.fail(e.toString());
  }
  BestPossibleStateOutput bestPossibleStateOutput=event.getAttribute(AttributeName.BEST_POSSIBLE_STATE.toString());
  Assert.assertNotNull(bestPossibleStateOutput);
  ResourceId resourceId=ResourceId.from("TestDB0");
  ResourceAssignment assignment=bestPossibleStateOutput.getResourceAssignment(resourceId);
  Assert.assertNotNull(assignment);
  Resource resource=cluster.getResource(resourceId);
  verifySemiAutoRebalance(resource,assignment);
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.controller.strategy.TestAutoRebalanceStrategy </h4><pre class="type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the following scenario: there is only a single partition for a resource. Two nodes up,
 * partition should
 * be assigned to one of them. Take down that node, partition should move. Bring back up that
 * node, partition should not move unnecessarily.
 */
@Test public void testWontMoveSinglePartitionUnnecessarily(){
  final ResourceId RESOURCE=ResourceId.from("resource");
  final PartitionId partition=PartitionId.from("resource_0");
  final StateModelDefinition STATE_MODEL=new StateModelDefinition(StateModelConfigGenerator.generateConfigForOnlineOffline());
  LinkedHashMap<State,Integer> stateCount=Maps.newLinkedHashMap();
  stateCount.put(State.from("ONLINE"),1);
  final ParticipantId[] NODES={ParticipantId.from("n0"),ParticipantId.from("n1")};
  ReplicaPlacementScheme scheme=new AutoRebalanceStrategy.DefaultPlacementScheme();
  List<ParticipantId> allNodes=Lists.newArrayList(NODES);
  List<ParticipantId> liveNodes=Lists.newArrayList(NODES);
  Map<PartitionId,Map<ParticipantId,State>> currentMapping=Maps.newHashMap();
  currentMapping.put(partition,new HashMap<ParticipantId,State>());
  List<PartitionId> partitions=Lists.newArrayList(partition);
  Map<State,String> upperBounds=Maps.newHashMap();
  for (  State state : STATE_MODEL.getTypedStatesPriorityList()) {
    upperBounds.put(state,STATE_MODEL.getNumParticipantsPerState(state));
  }
  ZNRecord znRecord=new AutoRebalanceStrategy(RESOURCE,partitions,stateCount,Integer.MAX_VALUE,scheme).typedComputePartitionAssignment(liveNodes,currentMapping,allNodes);
  Map<String,List<String>> preferenceLists=znRecord.getListFields();
  List<String> preferenceList=preferenceLists.get(partition.toString());
  Assert.assertNotNull(preferenceList,"invalid preference list for " + partition);
  Assert.assertEquals(preferenceList.size(),1,"invalid preference list for " + partition);
  String state=znRecord.getMapField(partition.toString()).get(preferenceList.get(0));
  Assert.assertEquals(state,"ONLINE","Invalid state for " + partition);
  ParticipantId preferredNode=ParticipantId.from(preferenceList.get(0));
  ParticipantId otherNode=preferredNode.equals(NODES[0]) ? NODES[1] : NODES[0];
  currentMapping.get(partition).put(otherNode,State.from(state));
  znRecord=new AutoRebalanceStrategy(RESOURCE,partitions,stateCount,Integer.MAX_VALUE,scheme).typedComputePartitionAssignment(liveNodes,currentMapping,allNodes);
  preferenceLists=znRecord.getListFields();
  preferenceList=preferenceLists.get(partition.toString());
  Assert.assertNotNull(preferenceList,"invalid preference list for " + partition);
  Assert.assertEquals(preferenceList.size(),1,"invalid preference list for " + partition);
  state=znRecord.getMapField(partition.toString()).get(preferenceList.get(0));
  Assert.assertEquals(state,"ONLINE","Invalid state for " + partition);
  ParticipantId finalPreferredNode=ParticipantId.from(preferenceList.get(0));
  Assert.assertEquals(finalPreferredNode,otherNode);
}

</code></pre>

<br>
<pre class="type-7 type-14 type-1 type-8 type-11 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the following scenario: nodes come up one by one, then one node is taken down. Preference
 * lists should prefer nodes in the current mapping at all times, but when all nodes are in the
 * current mapping, then it should distribute states as evenly as possible.
 */
@Test public void testOrphansNotPreferred(){
  final ResourceId RESOURCE=ResourceId.from("resource");
  final PartitionId[] PARTITIONS={PartitionId.from("resource_0"),PartitionId.from("resource_1"),PartitionId.from("resource_2")};
  final StateModelDefinition STATE_MODEL=new StateModelDefinition(StateModelConfigGenerator.generateConfigForMasterSlave());
  final int REPLICA_COUNT=2;
  final ParticipantId[] NODES={ParticipantId.from("n0"),ParticipantId.from("n1"),ParticipantId.from("n2")};
  ReplicaPlacementScheme scheme=new AutoRebalanceStrategy.DefaultPlacementScheme();
  List<ParticipantId> allNodes=Lists.newArrayList(NODES[0]);
  List<ParticipantId> liveNodes=Lists.newArrayList(NODES[0]);
  Map<PartitionId,Map<ParticipantId,State>> currentMapping=Maps.newHashMap();
  for (  PartitionId partition : PARTITIONS) {
    currentMapping.put(partition,new HashMap<ParticipantId,State>());
  }
  List<PartitionId> partitions=ImmutableList.copyOf(PARTITIONS);
  Map<State,String> upperBounds=Maps.newHashMap();
  for (  State state : STATE_MODEL.getTypedStatesPriorityList()) {
    upperBounds.put(state,STATE_MODEL.getNumParticipantsPerState(state));
  }
  LinkedHashMap<State,Integer> stateCount=ConstraintBasedAssignment.stateCount(upperBounds,STATE_MODEL,liveNodes.size(),REPLICA_COUNT);
  ZNRecord znRecord=new AutoRebalanceStrategy(RESOURCE,partitions,stateCount,Integer.MAX_VALUE,scheme).typedComputePartitionAssignment(liveNodes,currentMapping,allNodes);
  Map<String,List<String>> preferenceLists=znRecord.getListFields();
  for (  PartitionId partition : currentMapping.keySet()) {
    List<String> preferenceList=preferenceLists.get(partition.toString());
    Assert.assertNotNull(preferenceList,"invalid preference list for " + partition);
    Assert.assertEquals(preferenceList.size(),1,"invalid preference list for " + partition);
  }
  allNodes.add(NODES[1]);
  liveNodes.add(NODES[1]);
  stateCount=ConstraintBasedAssignment.stateCount(upperBounds,STATE_MODEL,liveNodes.size(),REPLICA_COUNT);
  for (  PartitionId partition : PARTITIONS) {
    currentMapping.get(partition).put(NODES[0],State.from("MASTER"));
  }
  znRecord=new AutoRebalanceStrategy(RESOURCE,partitions,stateCount,Integer.MAX_VALUE,scheme).typedComputePartitionAssignment(liveNodes,currentMapping,allNodes);
  preferenceLists=znRecord.getListFields();
  for (  PartitionId partition : currentMapping.keySet()) {
    List<String> preferenceList=preferenceLists.get(partition.toString());
    Assert.assertNotNull(preferenceList,"invalid preference list for " + partition);
    Assert.assertEquals(preferenceList.size(),2,"invalid preference list for " + partition);
    Assert.assertEquals(preferenceList.get(0),NODES[0].toString(),"invalid preference list for " + partition);
    Assert.assertEquals(preferenceList.get(1),NODES[1].toString(),"invalid preference list for " + partition);
  }
  for (  PartitionId partition : PARTITIONS) {
    currentMapping.get(partition).put(NODES[1],State.from("SLAVE"));
  }
  znRecord=new AutoRebalanceStrategy(RESOURCE,partitions,stateCount,Integer.MAX_VALUE,scheme).typedComputePartitionAssignment(liveNodes,currentMapping,allNodes);
  preferenceLists=znRecord.getListFields();
  Set<String> firstNodes=Sets.newHashSet();
  for (  PartitionId partition : currentMapping.keySet()) {
    List<String> preferenceList=preferenceLists.get(partition.toString());
    Assert.assertNotNull(preferenceList,"invalid preference list for " + partition);
    Assert.assertEquals(preferenceList.size(),2,"invalid preference list for " + partition);
    firstNodes.add(preferenceList.get(0));
  }
  Assert.assertEquals(firstNodes.size(),2,"masters not evenly distributed");
  allNodes.add(NODES[2]);
  liveNodes.add(NODES[2]);
  stateCount=ConstraintBasedAssignment.stateCount(upperBounds,STATE_MODEL,liveNodes.size(),REPLICA_COUNT);
  currentMapping.get(PARTITIONS[1]).put(NODES[0],State.from("SLAVE"));
  currentMapping.get(PARTITIONS[1]).put(NODES[1],State.from("MASTER"));
  znRecord=new AutoRebalanceStrategy(RESOURCE,partitions,stateCount,Integer.MAX_VALUE,scheme).typedComputePartitionAssignment(liveNodes,currentMapping,allNodes);
  preferenceLists=znRecord.getListFields();
  boolean newNodeUsed=false;
  for (  PartitionId partition : currentMapping.keySet()) {
    List<String> preferenceList=preferenceLists.get(partition.toString());
    Assert.assertNotNull(preferenceList,"invalid preference list for " + partition);
    Assert.assertEquals(preferenceList.size(),2,"invalid preference list for " + partition);
    if (preferenceList.contains(NODES[2].toString())) {
      newNodeUsed=true;
      Assert.assertEquals(preferenceList.get(1),NODES[2].toString(),"newly added node not at preference list tail for " + partition);
    }
  }
  Assert.assertTrue(newNodeUsed,"not using " + NODES[2]);
  for (  PartitionId partition : PARTITIONS) {
    currentMapping.get(partition).clear();
  }
  currentMapping.get(PARTITIONS[0]).put(NODES[0],State.from("MASTER"));
  currentMapping.get(PARTITIONS[0]).put(NODES[1],State.from("SLAVE"));
  currentMapping.get(PARTITIONS[1]).put(NODES[1],State.from("MASTER"));
  currentMapping.get(PARTITIONS[1]).put(NODES[2],State.from("SLAVE"));
  currentMapping.get(PARTITIONS[2]).put(NODES[0],State.from("MASTER"));
  currentMapping.get(PARTITIONS[2]).put(NODES[2],State.from("SLAVE"));
  znRecord=new AutoRebalanceStrategy(RESOURCE,partitions,stateCount,Integer.MAX_VALUE,scheme).typedComputePartitionAssignment(liveNodes,currentMapping,allNodes);
  preferenceLists=znRecord.getListFields();
  firstNodes.clear();
  Set<String> secondNodes=Sets.newHashSet();
  for (  PartitionId partition : currentMapping.keySet()) {
    List<String> preferenceList=preferenceLists.get(partition.toString());
    Assert.assertNotNull(preferenceList,"invalid preference list for " + partition);
    Assert.assertEquals(preferenceList.size(),2,"invalid preference list for " + partition);
    firstNodes.add(preferenceList.get(0));
    secondNodes.add(preferenceList.get(1));
  }
  Assert.assertEquals(firstNodes.size(),3,"masters not distributed evenly");
  Assert.assertEquals(secondNodes.size(),3,"slaves not distributed evenly");
  liveNodes.remove(0);
  stateCount=ConstraintBasedAssignment.stateCount(upperBounds,STATE_MODEL,liveNodes.size(),REPLICA_COUNT);
  for (  PartitionId partition : PARTITIONS) {
    currentMapping.get(partition).clear();
  }
  currentMapping.get(PARTITIONS[0]).put(NODES[1],State.from("MASTER"));
  currentMapping.get(PARTITIONS[1]).put(NODES[1],State.from("MASTER"));
  currentMapping.get(PARTITIONS[1]).put(NODES[2],State.from("SLAVE"));
  currentMapping.get(PARTITIONS[2]).put(NODES[2],State.from("MASTER"));
  znRecord=new AutoRebalanceStrategy(RESOURCE,partitions,stateCount,Integer.MAX_VALUE,scheme).typedComputePartitionAssignment(liveNodes,currentMapping,allNodes);
  preferenceLists=znRecord.getListFields();
  for (  PartitionId partition : currentMapping.keySet()) {
    List<String> preferenceList=preferenceLists.get(partition.toString());
    Assert.assertNotNull(preferenceList,"invalid preference list for " + partition);
    Assert.assertEquals(preferenceList.size(),2,"invalid preference list for " + partition);
    Map<ParticipantId,State> stateMap=currentMapping.get(partition);
    for (    ParticipantId participant : stateMap.keySet()) {
      Assert.assertTrue(preferenceList.contains(participant.toString()),"minimal movement violated for " + partition);
    }
    for (    String participant : preferenceList) {
      if (!stateMap.containsKey(ParticipantId.from(participant))) {
        Assert.assertNotSame(preferenceList.get(0),participant,"newly moved replica should not be master for " + partition);
      }
    }
  }
  for (  PartitionId partition : PARTITIONS) {
    currentMapping.get(partition).clear();
  }
  currentMapping.get(PARTITIONS[0]).put(NODES[1],State.from("MASTER"));
  currentMapping.get(PARTITIONS[0]).put(NODES[2],State.from("SLAVE"));
  currentMapping.get(PARTITIONS[1]).put(NODES[1],State.from("SLAVE"));
  currentMapping.get(PARTITIONS[1]).put(NODES[2],State.from("MASTER"));
  currentMapping.get(PARTITIONS[2]).put(NODES[1],State.from("SLAVE"));
  currentMapping.get(PARTITIONS[2]).put(NODES[2],State.from("MASTER"));
  znRecord=new AutoRebalanceStrategy(RESOURCE,partitions,stateCount,Integer.MAX_VALUE,scheme).typedComputePartitionAssignment(liveNodes,currentMapping,allNodes);
  preferenceLists=znRecord.getListFields();
  firstNodes.clear();
  for (  PartitionId partition : currentMapping.keySet()) {
    List<String> preferenceList=preferenceLists.get(partition.toString());
    Assert.assertNotNull(preferenceList,"invalid preference list for " + partition);
    Assert.assertEquals(preferenceList.size(),2,"invalid preference list for " + partition);
    firstNodes.add(preferenceList.get(0));
  }
  Assert.assertEquals(firstNodes.size(),2,"masters not evenly distributed");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.TestCleanupExternalView </h4><pre class="type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=2;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,2,n,2,"MasterSlave",true);
  MockController controller=new MockController(_zkaddr,clusterName,"controller_0");
  controller.syncStart();
  MockParticipant[] participants=new MockParticipant[n];
  for (int i=0; i < n; i++) {
    String instanceName="localhost_" + (12918 + i);
    participants[i]=new MockParticipant(_zkaddr,clusterName,instanceName);
    participants[i].syncStart();
  }
  boolean result=ClusterStateVerifier.verifyByZkCallback(new ClusterStateVerifier.BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  ZKHelixAdmin admin=new ZKHelixAdmin(_zkclient);
  admin.enableCluster(clusterName,false);
  ZkTestHelper.tryWaitZkEventsCleaned(controller.getZkClient());
  admin.dropResource(clusterName,"TestDB0");
  ZKHelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  LiveInstance liveInstance=accessor.getProperty(keyBuilder.liveInstance("localhost_12918"));
  accessor.removeProperty(keyBuilder.currentState("localhost_12918",liveInstance.getTypedSessionId().stringify(),"TestDB0"));
  liveInstance=accessor.getProperty(keyBuilder.liveInstance("localhost_12919"));
  accessor.removeProperty(keyBuilder.currentState("localhost_12919",liveInstance.getTypedSessionId().stringify(),"TestDB0"));
  admin.enableCluster(clusterName,true);
  ExternalView externalView=null;
  for (int i=0; i < 10; i++) {
    Thread.sleep(100);
    externalView=accessor.getProperty(keyBuilder.externalView("TestDB0"));
    if (externalView == null) {
      break;
    }
  }
  Assert.assertNull(externalView,"external-view for TestDB0 should be removed, but was: " + externalView);
  controller.syncStop();
  for (int i=0; i < n; i++) {
    participants[i].syncStop();
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.TestCustomizedIdealStateRebalancer </h4><pre class="type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomizedIdealStateRebalancer() throws InterruptedException {
  _setupTool.addResourceToCluster(CLUSTER_NAME,db2,60,"MasterSlave");
  _setupTool.addResourceProperty(CLUSTER_NAME,db2,IdealStateProperty.REBALANCER_CLASS_NAME.toString(),TestCustomizedIdealStateRebalancer.TestRebalancer.class.getName());
  _setupTool.addResourceProperty(CLUSTER_NAME,db2,IdealStateProperty.REBALANCE_MODE.toString(),RebalanceMode.USER_DEFINED.toString());
  _setupTool.rebalanceStorageCluster(CLUSTER_NAME,db2,3);
  boolean result=ClusterStateVerifier.verifyByZkCallback(new ExternalViewBalancedVerifier(_zkclient,CLUSTER_NAME,db2));
  Assert.assertTrue(result);
  Thread.sleep(1000);
  HelixDataAccessor accessor=new ZKHelixDataAccessor(CLUSTER_NAME,_baseAccessor);
  Builder keyBuilder=accessor.keyBuilder();
  ExternalView ev=accessor.getProperty(keyBuilder.externalView(db2));
  Assert.assertEquals(ev.getPartitionSet().size(),60);
  for (  String partition : ev.getPartitionSet()) {
    Assert.assertEquals(ev.getStateMap(partition).size(),1);
  }
  IdealState is=accessor.getProperty(keyBuilder.idealStates(db2));
  for (  PartitionId partition : is.getPartitionIdSet()) {
    Assert.assertEquals(is.getPreferenceList(partition).size(),0);
    Assert.assertEquals(is.getParticipantStateMap(partition).size(),0);
  }
  Assert.assertTrue(testRebalancerCreated);
  Assert.assertTrue(testRebalancerInvoked);
  ControllerContextHolder holder=accessor.getProperty(keyBuilder.controllerContext(db2));
  Assert.assertNotNull(holder);
  Assert.assertNotNull(holder.getContext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.TestDisableCustomCodeRunner </h4><pre class="type-7 type-14 type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,PARTITION_NUM,N,2,"MasterSlave",true);
  MockController controller=new MockController(_zkaddr,clusterName,"controller");
  controller.syncStart();
  Map<String,MockParticipant> participants=new HashMap<String,MockParticipant>();
  Map<String,HelixCustomCodeRunner> customCodeRunners=new HashMap<String,HelixCustomCodeRunner>();
  Map<String,DummyCallback> callbacks=new HashMap<String,DummyCallback>();
  for (int i=0; i < N; i++) {
    String instanceName="localhost_" + (12918 + i);
    participants.put(instanceName,new MockParticipant(_zkaddr,clusterName,instanceName));
    customCodeRunners.put(instanceName,new HelixCustomCodeRunner(participants.get(instanceName),_zkaddr));
    callbacks.put(instanceName,new DummyCallback());
    customCodeRunners.get(instanceName).invoke(callbacks.get(instanceName)).on(ChangeType.LIVE_INSTANCE).usingLeaderStandbyModel("TestParticLeader").start();
    participants.get(instanceName).syncStart();
  }
  boolean result=ClusterStateVerifier.verifyByZkCallback(new ClusterStateVerifier.BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  BaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  final HelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,baseAccessor);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  final String customCodeRunnerResource=customCodeRunners.get("localhost_12918").getResourceName();
  ExternalView extView=accessor.getProperty(keyBuilder.externalView(customCodeRunnerResource));
  Map<String,String> instanceStates=extView.getStateMap(customCodeRunnerResource + "_0");
  String leader=null;
  for (  String instance : instanceStates.keySet()) {
    String state=instanceStates.get(instance);
    if ("LEADER".equals(state)) {
      leader=instance;
      break;
    }
  }
  Assert.assertNotNull(leader);
  for (  String instance : callbacks.keySet()) {
    DummyCallback callback=callbacks.get(instance);
    if (instance.equals(leader)) {
      Assert.assertTrue(callback.isInitTypeInvoked());
    }
 else {
      Assert.assertFalse(callback.isInitTypeInvoked());
    }
    callback.reset();
  }
  HelixAdmin admin=new ZKHelixAdmin(_zkclient);
  admin.enableResource(clusterName,customCodeRunnerResource,false);
  result=TestHelper.verify(new TestHelper.Verifier(){
    @Override public boolean verify() throws Exception {
      PropertyKey.Builder keyBuilder=accessor.keyBuilder();
      ExternalView extView=accessor.getProperty(keyBuilder.externalView(customCodeRunnerResource));
      if (extView == null) {
        return false;
      }
      Set<String> partitionSet=extView.getPartitionSet();
      if (partitionSet == null || partitionSet.size() != PARTITION_NUM) {
        return false;
      }
      for (      String partition : partitionSet) {
        Map<String,String> instanceStates=extView.getStateMap(partition);
        for (        String state : instanceStates.values()) {
          if (!"OFFLINE".equals(state)) {
            return false;
          }
        }
      }
      return true;
    }
  }
,10 * 1000);
  Assert.assertTrue(result);
  LiveInstance fakeInstance=new LiveInstance("fakeInstance");
  fakeInstance.setSessionId("fakeSessionId");
  fakeInstance.setHelixVersion("0.6");
  accessor.setProperty(keyBuilder.liveInstance("fakeInstance"),fakeInstance);
  Thread.sleep(1000);
  for (  Map.Entry<String,DummyCallback> e : callbacks.entrySet()) {
    String instance=e.getKey();
    DummyCallback callback=e.getValue();
    Assert.assertFalse(callback.isInitTypeInvoked());
    Assert.assertFalse(callback.isCallbackTypeInvoked());
    if (instance.equals(leader)) {
      Assert.assertTrue(callback.isFinalizeTypeInvoked());
    }
  }
  accessor.removeProperty(keyBuilder.liveInstance("fakeInstance"));
  admin.enableResource(clusterName,customCodeRunnerResource,true);
  result=ClusterStateVerifier.verifyByZkCallback(new ClusterStateVerifier.BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  extView=accessor.getProperty(keyBuilder.externalView(customCodeRunnerResource));
  instanceStates=extView.getStateMap(customCodeRunnerResource + "_0");
  leader=null;
  for (  String instance : instanceStates.keySet()) {
    String state=instanceStates.get(instance);
    if ("LEADER".equals(state)) {
      leader=instance;
      break;
    }
  }
  Assert.assertNotNull(leader);
  for (  String instance : callbacks.keySet()) {
    DummyCallback callback=callbacks.get(instance);
    if (instance.equals(leader)) {
      Assert.assertTrue(callback.isInitTypeInvoked());
    }
 else {
      Assert.assertFalse(callback.isInitTypeInvoked());
    }
    callback.reset();
  }
  accessor.setProperty(keyBuilder.liveInstance("fakeInstance"),fakeInstance);
  Thread.sleep(1000);
  for (  String instance : callbacks.keySet()) {
    DummyCallback callback=callbacks.get(instance);
    if (instance.equals(leader)) {
      Assert.assertTrue(callback.isCallbackTypeInvoked());
    }
 else {
      Assert.assertFalse(callback.isCallbackTypeInvoked());
    }
  }
  controller.syncStop();
  for (  MockParticipant participant : participants.values()) {
    participant.syncStop();
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.TestDrop </h4><pre class="type-4 type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailToDropResourceWithErrorPartitionSemiAuto() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  final int n=5;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  MockParticipant[] participants=new MockParticipant[n];
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,8,n,3,"MasterSlave",true);
  MockController controller=new MockController(_zkaddr,clusterName,"controller_0");
  controller.syncStart();
  Map<String,Set<String>> errTransitions=new HashMap<String,Set<String>>();
  errTransitions.put("SLAVE-MASTER",TestHelper.setOf("TestDB0_4"));
  errTransitions.put("ERROR-DROPPED",TestHelper.setOf("TestDB0_4"));
  for (int i=0; i < n; i++) {
    String instanceName="localhost_" + (12918 + i);
    if (i == 0) {
      participants[i]=new MockParticipant(_zkaddr,clusterName,instanceName);
      participants[i].setTransition(new ErrTransition(errTransitions));
    }
 else {
      participants[i]=new MockParticipant(_zkaddr,clusterName,instanceName);
    }
    participants[i].syncStart();
  }
  Map<String,Map<String,String>> errStateMap=new HashMap<String,Map<String,String>>();
  errStateMap.put("TestDB0",new HashMap<String,String>());
  errStateMap.get("TestDB0").put("TestDB0_4","localhost_12918");
  boolean result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName,errStateMap));
  Assert.assertTrue(result);
  ClusterSetup.processCommandLineArgs(new String[]{"--zkSvr",_zkaddr,"--dropResource",clusterName,"TestDB0"});
  result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName,errStateMap));
  Assert.assertTrue(result);
  ZKHelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  InstanceConfig config=accessor.getProperty(keyBuilder.instanceConfig("localhost_12918"));
  List<String> disabledPartitions=config.getDisabledPartitions();
  Assert.assertEquals(disabledPartitions.size(),1,"TestDB0_4 should be disabled");
  Assert.assertEquals(disabledPartitions.get(0),"TestDB0_4");
  ExternalView ev=accessor.getProperty(keyBuilder.externalView("TestDB0"));
  Set<String> partitions=ev.getPartitionSet();
  Assert.assertEquals(partitions.size(),1,"Should have TestDB0_4->localhost_12918->ERROR");
  String errPartition=partitions.iterator().next();
  Assert.assertEquals(errPartition,"TestDB0_4");
  Map<String,String> stateMap=ev.getStateMap(errPartition);
  Assert.assertEquals(stateMap.size(),1);
  Assert.assertEquals(stateMap.keySet().iterator().next(),"localhost_12918");
  Assert.assertEquals(stateMap.get("localhost_12918"),HelixDefinedState.ERROR.name());
  CurrentState cs=accessor.getProperty(keyBuilder.currentState(participants[0].getInstanceName(),participants[0].getSessionId(),"TestDB0"));
  Map<String,String> partitionStateMap=cs.getPartitionStateMap();
  Assert.assertEquals(partitionStateMap.size(),1);
  Assert.assertEquals(partitionStateMap.keySet().iterator().next(),"TestDB0_4");
  Assert.assertEquals(partitionStateMap.get("TestDB0_4"),HelixDefinedState.ERROR.name());
  for (int i=1; i < n; i++) {
    String instanceName=participants[i].getInstanceName();
    String sessionId=participants[i].getSessionId();
    Assert.assertNull(accessor.getProperty(keyBuilder.currentState(instanceName,sessionId,"TestDB0")));
  }
  controller.syncStop();
  for (int i=0; i < n; i++) {
    participants[i].syncStop();
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.TestSchemataSM </h4><pre class="type-4 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemataSM() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=5;
  MockParticipant[] participants=new MockParticipant[n];
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestSchemata",1,1,n,0,"STORAGE_DEFAULT_SM_SCHEMATA",false);
  ZKHelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  PropertyKey key=keyBuilder.idealStates("TestSchemata0");
  IdealState idealState=accessor.getProperty(key);
  idealState.setReplicas(HelixConstants.StateModelToken.ANY_LIVEINSTANCE.toString());
  idealState.getRecord().setListField("TestSchemata0_0",Arrays.asList(HelixConstants.StateModelToken.ANY_LIVEINSTANCE.toString()));
  accessor.setProperty(key,idealState);
  MockController controller=new MockController(_zkaddr,clusterName,"controller");
  controller.syncStart();
  for (int i=1; i < n; i++) {
    String instanceName="localhost_" + (12918 + i);
    participants[i]=new MockParticipant(_zkaddr,clusterName,instanceName);
    participants[i].syncStart();
  }
  boolean result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  participants[0]=new MockParticipant(_zkaddr,clusterName,"localhost_12918");
  participants[0].syncStart();
  result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  key=keyBuilder.externalView("TestSchemata0");
  ExternalView externalView=accessor.getProperty(key);
  Map<String,String> stateMap=externalView.getStateMap("TestSchemata0_0");
  Assert.assertNotNull(stateMap);
  Assert.assertEquals(stateMap.size(),n,"all " + n + " participants should be in Master state");
  for (int i=0; i < n; i++) {
    String instanceName="localhost_" + (12918 + i);
    Assert.assertNotNull(stateMap.get(instanceName));
    Assert.assertEquals(stateMap.get(instanceName),"MASTER");
  }
  controller.syncStop();
  for (int i=0; i < n; i++) {
    participants[i].syncStop();
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.TestZkCallbackHandlerLeak </h4><pre class="type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveUserCbHandlerOnPathRemoval() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  final int n=3;
  final String zkAddr=_zkaddr;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,zkAddr,12918,"localhost","TestDB",1,32,n,2,"MasterSlave",true);
  final MockController controller=new MockController(zkAddr,clusterName,"controller_0");
  controller.syncStart();
  MockParticipant[] participants=new MockParticipant[n];
  for (int i=0; i < n; i++) {
    String instanceName="localhost_" + (12918 + i);
    participants[i]=new MockParticipant(zkAddr,clusterName,instanceName);
    participants[i].syncStart();
    if (i == 0) {
      MockParticipant manager=participants[0];
      manager.addCurrentStateChangeListener(new CurrentStateChangeListener(){
        @Override public void onStateChange(        String instanceName,        List<CurrentState> statesInfo,        NotificationContext changeContext){
        }
      }
,manager.getInstanceName(),manager.getSessionId());
    }
  }
  Boolean result=ClusterStateVerifier.verifyByZkCallback(new ClusterStateVerifier.BestPossAndExtViewZkVerifier(zkAddr,clusterName));
  Assert.assertTrue(result);
  MockParticipant participantToExpire=participants[0];
  String oldSessionId=participantToExpire.getSessionId();
  PropertyKey.Builder keyBuilder=new PropertyKey.Builder(clusterName);
  Assert.assertEquals(participantToExpire.getHandlers().size(),2,"Should have 2 handlers: CURRENTSTATE/{sessionId}, and MESSAGES");
  Map<String,Set<IZkDataListener>> dataListeners=ZkTestHelper.getZkDataListener(participantToExpire.getZkClient());
  Map<String,Set<IZkChildListener>> childListeners=ZkTestHelper.getZkChildListener(participantToExpire.getZkClient());
  Assert.assertEquals(dataListeners.size(),1,"Should have 1 path (CURRENTSTATE/{sessionId}/TestDB0) which has 1 data-listeners");
  String path=keyBuilder.currentState(participantToExpire.getInstanceName(),oldSessionId,"TestDB0").getPath();
  Assert.assertEquals(dataListeners.get(path).size(),1,"Should have 1 data-listeners on path: " + path);
  Assert.assertEquals(childListeners.size(),2,"Should have 2 paths (CURRENTSTATE/{sessionId}, and MESSAGES) each of which has 1 child-listener");
  path=keyBuilder.currentStates(participantToExpire.getInstanceName(),oldSessionId).getPath();
  Assert.assertEquals(childListeners.get(path).size(),1,"Should have 1 child-listener on path: " + path);
  path=keyBuilder.messages(participantToExpire.getInstanceName()).getPath();
  Assert.assertEquals(childListeners.get(path).size(),1,"Should have 1 child-listener on path: " + path);
  path=keyBuilder.controller().getPath();
  Assert.assertNull(childListeners.get(path),"Should have no child-listener on path: " + path);
  Map<String,List<String>> watchPaths=ZkTestHelper.getZkWatch(participantToExpire.getZkClient());
  Assert.assertEquals(watchPaths.get("dataWatches").size(),3,"Should have 3 data-watches: CURRENTSTATE/{sessionId}, CURRENTSTATE/{sessionId}/TestDB, MESSAGES");
  Assert.assertEquals(watchPaths.get("childWatches").size(),2,"Should have 2 child-watches: MESSAGES, and CURRENTSTATE/{sessionId}");
  System.out.println("Expire participant: " + participantToExpire.getInstanceName() + ", session: "+ participantToExpire.getSessionId());
  ZkTestHelper.expireSession(participantToExpire.getZkClient());
  String newSessionId=participantToExpire.getSessionId();
  System.out.println(participantToExpire.getInstanceName() + " oldSessionId: " + oldSessionId+ ", newSessionId: "+ newSessionId);
  result=ClusterStateVerifier.verifyByZkCallback(new ClusterStateVerifier.BestPossAndExtViewZkVerifier(zkAddr,clusterName));
  Assert.assertTrue(result);
  Assert.assertEquals(participantToExpire.getHandlers().size(),1,"Should have 1 handlers: MESSAGES. CURRENTSTATE/{sessionId} handler should be removed by CallbackHandler#handleChildChange()");
  dataListeners=ZkTestHelper.getZkDataListener(participantToExpire.getZkClient());
  childListeners=ZkTestHelper.getZkChildListener(participantToExpire.getZkClient());
  Assert.assertTrue(dataListeners.isEmpty(),"Should have no data-listeners");
  Assert.assertEquals(childListeners.size(),2,"Should have 2 paths (CURRENTSTATE/{oldSessionId}, and MESSAGES). " + "CONTROLLER and MESSAGE has 1 child-listener each. CURRENTSTATE/{oldSessionId} doesn't have listener (ZkClient doesn't remove empty childListener set. probably a ZkClient bug. see ZkClient#unsubscribeChildChange())");
  path=keyBuilder.currentStates(participantToExpire.getInstanceName(),oldSessionId).getPath();
  Assert.assertEquals(childListeners.get(path).size(),0,"Should have no child-listener on path: " + path);
  path=keyBuilder.messages(participantToExpire.getInstanceName()).getPath();
  Assert.assertEquals(childListeners.get(path).size(),1,"Should have 1 child-listener on path: " + path);
  path=keyBuilder.controller().getPath();
  Assert.assertNull(childListeners.get(path),"Should have no child-listener on path: " + path);
  watchPaths=ZkTestHelper.getZkWatch(participantToExpire.getZkClient());
  Assert.assertEquals(watchPaths.get("dataWatches").size(),1,"Should have 1 data-watches: MESSAGES");
  Assert.assertEquals(watchPaths.get("childWatches").size(),1,"Should have 1 child-watches: MESSAGES");
  Assert.assertEquals(watchPaths.get("existWatches").size(),2,"Should have 2 exist-watches: CURRENTSTATE/{oldSessionId} and CURRENTSTATE/{oldSessionId}/TestDB0");
  System.out.println("Expire participant: " + participantToExpire.getInstanceName() + ", session: "+ participantToExpire.getSessionId());
  ZkTestHelper.expireSession(participantToExpire.getZkClient());
  result=ClusterStateVerifier.verifyByZkCallback(new ClusterStateVerifier.BestPossAndExtViewZkVerifier(zkAddr,clusterName));
  Assert.assertTrue(result);
  watchPaths=ZkTestHelper.getZkWatch(participantToExpire.getZkClient());
  Assert.assertEquals(watchPaths.get("dataWatches").size(),1,"Should have 1 data-watches: MESSAGES");
  Assert.assertEquals(watchPaths.get("childWatches").size(),1,"Should have 1 child-watches: MESSAGES");
  Assert.assertEquals(watchPaths.get("existWatches").size(),0,"Should have no exist-watches. exist-watches on CURRENTSTATE/{oldSessionId} and CURRENTSTATE/{oldSessionId}/TestDB0 should be cleared during handleNewSession");
  controller.syncStop();
  for (int i=0; i < n; i++) {
    participants[i].syncStop();
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.manager.TestConsecutiveZkSessionExpiry </h4><pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiClusterController() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=2;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,4,n,2,"MasterSlave",true);
  MockMultiClusterController[] multiClusterControllers=new MockMultiClusterController[n];
  CountDownLatch startCountdown=new CountDownLatch(1);
  CountDownLatch endCountdown=new CountDownLatch(1);
  for (int i=0; i < n; i++) {
    String contrllerName="localhost_" + (12918 + i);
    multiClusterControllers[i]=new MockMultiClusterController(_zkaddr,clusterName,contrllerName);
    multiClusterControllers[i].getStateMachineEngine().registerStateModelFactory(StateModelDefId.MasterSlave,new MockMSModelFactory());
    if (i == 0) {
      multiClusterControllers[i].addPreConnectCallback(new PreConnectTestCallback(contrllerName,startCountdown,endCountdown));
    }
    multiClusterControllers[i].connect();
  }
  boolean result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  LOG.info("1st Expiring multiClusterController session...");
  String oldSessionId=multiClusterControllers[0].getSessionId();
  ZkTestHelper.asyncExpireSession(multiClusterControllers[0].getZkClient());
  String newSessionId=multiClusterControllers[0].getSessionId();
  LOG.info("Expried multiClusterController session. oldSessionId: " + oldSessionId + ", newSessionId: "+ newSessionId);
  startCountdown.await();
  LOG.info("2nd Expiring multiClusterController session...");
  oldSessionId=multiClusterControllers[0].getSessionId();
  ZkTestHelper.asyncExpireSession(multiClusterControllers[0].getZkClient());
  newSessionId=multiClusterControllers[0].getSessionId();
  LOG.info("Expried multiClusterController session. oldSessionId: " + oldSessionId + ", newSessionId: "+ newSessionId);
  endCountdown.countDown();
  result=ClusterStateVerifier.verifyByPolling(new ClusterStateVerifier.BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  HelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  Assert.assertNotNull(HelixTestUtil.pollForProperty(LiveInstance.class,accessor,keyBuilder.liveInstance("localhost_12918"),true));
  LiveInstance leader=HelixTestUtil.pollForProperty(LiveInstance.class,accessor,keyBuilder.controllerLeader(),true);
  Assert.assertNotNull(leader);
  Assert.assertEquals(leader.getId(),"localhost_12919");
  TestHelper.printHandlers(multiClusterControllers[0],multiClusterControllers[0].getHandlers());
  List<ZkCallbackHandler> handlers=multiClusterControllers[0].getHandlers();
  Assert.assertEquals(handlers.size(),2,"MultiCluster controller should have 2 handler (message and leader election) after lose leadership, but was " + handlers.size());
  multiClusterControllers[0].disconnect();
  multiClusterControllers[1].disconnect();
  Assert.assertNull(HelixTestUtil.pollForProperty(LiveInstance.class,accessor,keyBuilder.liveInstance("localhost_12918"),false));
  Assert.assertNull(HelixTestUtil.pollForProperty(LiveInstance.class,accessor,keyBuilder.liveInstance("localhost_12919"),false));
  Assert.assertNull(HelixTestUtil.pollForProperty(LiveInstance.class,accessor,keyBuilder.controllerLeader(),false));
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.manager.TestHelixMultiClusterController </h4><pre class="type-4 type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleSessionExpiryTest() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=2;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,4,n,2,"MasterSlave",true);
  MockMultiClusterController[] multiClusterControllers=new MockMultiClusterController[n];
  for (int i=0; i < n; i++) {
    String contrllerName="localhost_" + (12918 + i);
    multiClusterControllers[i]=new MockMultiClusterController(_zkaddr,clusterName,contrllerName);
    multiClusterControllers[i].getStateMachineEngine().registerStateModelFactory(StateModelDefId.MasterSlave,new MockMSModelFactory());
    multiClusterControllers[i].connect();
  }
  boolean result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  expireController(multiClusterControllers[0],multiClusterControllers[1]);
  expireController(multiClusterControllers[1],multiClusterControllers[0]);
  ZKHelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  for (int i=0; i < n; i++) {
    multiClusterControllers[i].disconnect();
    Assert.assertNull(accessor.getProperty(keyBuilder.liveInstance(multiClusterControllers[i].getInstanceName())));
  }
  Assert.assertNull(accessor.getProperty(keyBuilder.controllerLeader()));
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleIntegrationTest() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=2;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,4,n,2,"MasterSlave",true);
  HelixManager[] multiClusterControllers=new HelixManager[n];
  for (int i=0; i < n; i++) {
    int port=12918 + i;
    multiClusterControllers[i]=new ZKHelixManager(clusterName,"localhost_" + port,InstanceType.CONTROLLER_PARTICIPANT,_zkaddr);
    multiClusterControllers[i].getStateMachineEngine().registerStateModelFactory(StateModelDefId.MasterSlave,new MockMSModelFactory());
    multiClusterControllers[i].connect();
  }
  boolean result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  multiClusterControllers[0].disconnect();
  Thread.sleep(100);
  result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  ZKHelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  Assert.assertNull(accessor.getProperty(keyBuilder.liveInstance("localhost_12918")));
  LiveInstance leader=accessor.getProperty(keyBuilder.controllerLeader());
  Assert.assertNotNull(leader);
  Assert.assertEquals(leader.getId(),"localhost_12919");
  multiClusterControllers[1].disconnect();
  Assert.assertNull(accessor.getProperty(keyBuilder.liveInstance("localhost_12919")));
  Assert.assertNull(accessor.getProperty(keyBuilder.controllerLeader()));
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.manager.TestParticipantManager </h4><pre class="type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleIntegrationTest() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=1;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,4,n,1,"MasterSlave",true);
  HelixManager participant=new ZKHelixManager(clusterName,"localhost_12918",InstanceType.PARTICIPANT,_zkaddr);
  participant.getStateMachineEngine().registerStateModelFactory(StateModelDefId.MasterSlave,new MockMSModelFactory());
  participant.connect();
  HelixManager controller=new ZKHelixManager(clusterName,"controller_0",InstanceType.CONTROLLER,_zkaddr);
  controller.connect();
  boolean result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  controller.disconnect();
  participant.disconnect();
  ZKHelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  Assert.assertNull(accessor.getProperty(keyBuilder.liveInstance("localhost_12918")));
  Assert.assertNull(accessor.getProperty(keyBuilder.controllerLeader()));
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-11 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionExpiryInTransition() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  final String clusterName=className + "_" + methodName;
  int n=1;
  CountDownLatch startCountdown=new CountDownLatch(1);
  CountDownLatch endCountdown=new CountDownLatch(1);
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  MockParticipant[] participants=new MockParticipant[n];
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,1,n,1,"MasterSlave",true);
  MockController controller=new MockController(_zkaddr,clusterName,"controller_0");
  controller.syncStart();
  for (int i=0; i < n; i++) {
    String instanceName="localhost_" + (12918 + i);
    participants[i]=new MockParticipant(_zkaddr,clusterName,instanceName);
    participants[i].setTransition(new SessionExpiryTransition(startCountdown,endCountdown));
    participants[i].syncStart();
  }
  startCountdown.await();
  String oldSessionId=participants[0].getSessionId();
  System.out.println("oldSessionId: " + oldSessionId);
  ZkTestHelper.expireSession(participants[0].getZkClient());
  boolean result=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(result);
  String newSessionId=participants[0].getSessionId();
  Assert.assertNotSame(newSessionId,oldSessionId);
  String errPath=PropertyPathConfig.getPath(PropertyType.ERRORS,clusterName,"localhost_12918",oldSessionId,"TestDB0","TestDB0_0");
  ZNRecord error=_zkclient.readData(errPath);
  Assert.assertNotNull(error,"InterruptedException should happen in old session since task is being cancelled during handleNewSession");
  String errString=new String(new ZNRecordSerializer().serialize(error));
  Assert.assertTrue(errString.indexOf("InterruptedException") != -1);
  controller.syncStop();
  for (int i=0; i < n; i++) {
    participants[i].syncStop();
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.integration.task.TestTaskRebalancer </h4><pre class="type-7 type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNamedQueue() throws Exception {
  String queueName=TestHelper.getTestMethodName();
  JobQueue queue=new JobQueue.Builder(queueName).build();
  _driver.createQueue(queue);
  Set<String> master=Sets.newHashSet("MASTER");
  Set<String> slave=Sets.newHashSet("SLAVE");
  JobConfig.Builder job1=new JobConfig.Builder().setCommand("Reindex").setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB).setTargetPartitionStates(master);
  JobConfig.Builder job2=new JobConfig.Builder().setCommand("Reindex").setTargetResource(WorkflowGenerator.DEFAULT_TGT_DB).setTargetPartitionStates(slave);
  _driver.enqueueJob(queueName,"masterJob",job1);
  _driver.enqueueJob(queueName,"slaveJob",job2);
  String namespacedJob1=queueName + "_masterJob";
  String namespacedJob2=queueName + "_slaveJob";
  TestUtil.pollForJobState(_manager,queueName,namespacedJob1,TaskState.COMPLETED);
  TestUtil.pollForJobState(_manager,queueName,namespacedJob2,TaskState.COMPLETED);
  JobContext masterJobContext=TaskUtil.getJobContext(_manager,namespacedJob1);
  JobContext slaveJobContext=TaskUtil.getJobContext(_manager,namespacedJob2);
  long job1Finish=masterJobContext.getFinishTime();
  long job2Start=slaveJobContext.getStartTime();
  Assert.assertTrue(job2Start >= job1Finish);
  _driver.flushQueue(queueName);
  HelixDataAccessor accessor=_manager.getHelixDataAccessor();
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  Assert.assertNull(accessor.getProperty(keyBuilder.idealStates(namespacedJob1)));
  Assert.assertNull(accessor.getProperty(keyBuilder.resourceConfig(namespacedJob1)));
  Assert.assertNull(accessor.getProperty(keyBuilder.idealStates(namespacedJob2)));
  Assert.assertNull(accessor.getProperty(keyBuilder.resourceConfig(namespacedJob2)));
  WorkflowConfig workflowCfg=TaskUtil.getWorkflowCfg(_manager,queueName);
  JobDag dag=workflowCfg.getJobDag();
  Assert.assertFalse(dag.getAllNodes().contains(namespacedJob1));
  Assert.assertFalse(dag.getAllNodes().contains(namespacedJob2));
  Assert.assertFalse(dag.getChildrenToParents().containsKey(namespacedJob1));
  Assert.assertFalse(dag.getChildrenToParents().containsKey(namespacedJob2));
  Assert.assertFalse(dag.getParentsToChildren().containsKey(namespacedJob1));
  Assert.assertFalse(dag.getParentsToChildren().containsKey(namespacedJob2));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void partitionSet() throws Exception {
  final String jobResource="partitionSet";
  ImmutableList<String> targetPartitions=ImmutableList.of("TestDB_1","TestDB_2","TestDB_3","TestDB_5","TestDB_8","TestDB_13");
  Map<String,String> commandConfig=ImmutableMap.of(TIMEOUT_CONFIG,String.valueOf(100));
  Workflow flow=WorkflowGenerator.generateDefaultSingleJobWorkflowBuilderWithExtraConfigs(jobResource,commandConfig,JobConfig.MAX_ATTEMPTS_PER_TASK,String.valueOf(1),JobConfig.TARGET_PARTITIONS,Joiner.on(",").join(targetPartitions)).build();
  _driver.start(flow);
  TestUtil.pollForWorkflowState(_manager,jobResource,TaskState.COMPLETED);
  String namespacedName=TaskUtil.getNamespacedJobName(jobResource);
  JobContext ctx=TaskUtil.getJobContext(_manager,namespacedName);
  WorkflowContext workflowContext=TaskUtil.getWorkflowContext(_manager,jobResource);
  Assert.assertNotNull(ctx);
  Assert.assertNotNull(workflowContext);
  Assert.assertEquals(workflowContext.getJobState(namespacedName),TaskState.COMPLETED);
  for (  String pName : targetPartitions) {
    int i=ctx.getPartitionsByTarget().get(pName).get(0);
    Assert.assertEquals(ctx.getPartitionState(i),TaskPartitionState.COMPLETED);
    Assert.assertEquals(ctx.getPartitionNumAttempts(i),1);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.ipc.TestNettyHelixIPCService </h4><pre class="type-7 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testService() throws Exception {
  final int numMessages=1000;
  final int messageType=1;
  final ConcurrentMap<String,AtomicInteger> firstCounts=new ConcurrentHashMap<String,AtomicInteger>();
  final HelixIPCService firstIPC=new NettyHelixIPCService(new NettyHelixIPCService.Config().setInstanceName(firstNode.getInstanceName()).setPort(firstPort));
  firstIPC.registerCallback(messageType,new HelixIPCCallback(){
    @Override public void onMessage(    HelixMessageScope scope,    UUID messageId,    ByteBuf message){
      String key=scope.getPartition() + ":" + scope.getState();
      firstCounts.putIfAbsent(key,new AtomicInteger());
      firstCounts.get(key).incrementAndGet();
    }
  }
);
  firstIPC.start();
  final ConcurrentMap<String,AtomicInteger> secondCounts=new ConcurrentHashMap<String,AtomicInteger>();
  final HelixIPCService secondIPC=new NettyHelixIPCService(new NettyHelixIPCService.Config().setInstanceName(secondNode.getInstanceName()).setPort(secondPort));
  secondIPC.registerCallback(messageType,new HelixIPCCallback(){
    @Override public void onMessage(    HelixMessageScope scope,    UUID messageId,    ByteBuf message){
      String key=scope.getPartition() + ":" + scope.getState();
      secondCounts.putIfAbsent(key,new AtomicInteger());
      secondCounts.get(key).incrementAndGet();
    }
  }
);
  secondIPC.start();
  Thread.sleep(500);
  String secondName="localhost_" + secondPort;
  Set<String> secondPartitions=new HashSet<String>();
  IdealState idealState=controller.getClusterManagmentTool().getResourceIdealState(CLUSTER_NAME,RESOURCE_NAME);
  for (  String partitionName : idealState.getPartitionSet()) {
    for (    Map.Entry<String,String> stateEntry : idealState.getInstanceStateMap(partitionName).entrySet()) {
      if (stateEntry.getKey().equals(secondName)) {
        secondPartitions.add(partitionName);
      }
    }
  }
  for (  String partitionName : secondPartitions) {
    for (int i=0; i < numMessages; i++) {
      HelixMessageScope scope=new HelixMessageScope.Builder().cluster(firstNode.getClusterName()).resource(RESOURCE_NAME).partition(partitionName).state("ONLINE").build();
      Set<HelixAddress> destinations=firstResolver.getDestinations(scope);
      for (      HelixAddress destination : destinations) {
        ByteBuf message=Unpooled.wrappedBuffer(("Hello" + i).getBytes());
        firstIPC.send(destination,messageType,UUID.randomUUID(),message);
      }
    }
  }
  for (  String partitionName : secondPartitions) {
    for (int i=0; i < numMessages; i++) {
      HelixMessageScope scope=new HelixMessageScope.Builder().cluster(secondNode.getClusterName()).resource(RESOURCE_NAME).partition(partitionName).state("ONLINE").build();
      Set<HelixAddress> destinations=secondResolver.getDestinations(scope);
      for (      HelixAddress destination : destinations) {
        ByteBuf message=Unpooled.wrappedBuffer(("Hello" + i).getBytes());
        secondIPC.send(destination,messageType,UUID.randomUUID(),message);
      }
    }
  }
  Thread.sleep(500);
  for (  String partitionName : secondPartitions) {
    AtomicInteger count=secondCounts.get(partitionName + ":ONLINE");
    Assert.assertNotNull(count);
    Assert.assertEquals(count.get(),2 * numMessages);
  }
  firstIPC.shutdown();
  secondIPC.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZKLiveInstanceData </h4><pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataChange() throws Exception {
  HelixManager adminManager=HelixManagerFactory.getZKHelixManager(clusterName,null,InstanceType.ADMINISTRATOR,_zkaddr);
  adminManager.connect();
  final BlockingQueue<List<LiveInstance>> changeList=new LinkedBlockingQueue<List<LiveInstance>>();
  adminManager.addLiveInstanceChangeListener(new LiveInstanceChangeListener(){
    @Override public void onLiveInstanceChange(    List<LiveInstance> liveInstances,    NotificationContext changeContext){
      changeList.add(deepCopy(liveInstances));
    }
  }
);
  List<LiveInstance> instances=changeList.poll(1,TimeUnit.SECONDS);
  Assert.assertNotNull(instances,"Expecting a list of live instance");
  Assert.assertTrue(instances.isEmpty(),"Expecting an empty list of live instance");
  HelixManager manager=HelixManagerFactory.getZKHelixManager(clusterName,"localhost_54321",InstanceType.PARTICIPANT,_zkaddr);
  manager.connect();
  instances=changeList.poll(1,TimeUnit.SECONDS);
  Assert.assertNotNull(instances,"Expecting a list of live instance");
  Assert.assertEquals(instances.size(),1,"Expecting one live instance");
  Assert.assertEquals(instances.get(0).getInstanceName(),manager.getInstanceName());
  HelixDataAccessor helixDataAccessor=manager.getHelixDataAccessor();
  PropertyKey propertyKey=helixDataAccessor.keyBuilder().liveInstance(manager.getInstanceName());
  LiveInstance instance=helixDataAccessor.getProperty(propertyKey);
  Map<String,String> map=new TreeMap<String,String>();
  map.put("k1","v1");
  instance.getRecord().setMapField("test",map);
  Assert.assertTrue(helixDataAccessor.updateProperty(propertyKey,instance),"Failed to update live instance node");
  instances=changeList.poll(1,TimeUnit.SECONDS);
  Assert.assertNotNull(instances,"Expecting a list of live instance");
  Assert.assertEquals(instances.get(0).getRecord().getMapField("test"),map,"Wrong map data.");
  manager.disconnect();
  Thread.sleep(1000);
  instances=changeList.poll(1,TimeUnit.SECONDS);
  Assert.assertNotNull(instances,"Expecting a list of live instance");
  Assert.assertTrue(instances.isEmpty(),"Expecting an empty list of live instance");
  adminManager.disconnect();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZKUtil </h4><pre class="type-7 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test() public void testSubtract(){
  String path=PropertyPathConfig.getPath(PropertyType.CONFIGS,clusterName,ConfigScopeProperty.PARTICIPANT.toString(),"id5");
  ZNRecord record=new ZNRecord("id5");
  record.setSimpleField("key1","value1");
  _zkClient.createPersistent(path,record);
  ZKUtil.subtract(_zkClient,path,record);
  record=_zkClient.<ZNRecord>readData(path);
  AssertJUnit.assertNull(record.getSimpleField("key1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZNRecordSizeLimit </h4><pre class="type-7 type-5 type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZNRecordSizeLimitUseZNRecordSerializer(){
  String className=TestUtil.getTestName();
  System.out.println("START testZNRecordSizeLimitUseZNRecordSerializer at " + new Date(System.currentTimeMillis()));
  String root=className;
  byte[] buf=new byte[1024];
  for (int i=0; i < 1024; i++) {
    buf[i]='a';
  }
  String bufStr=new String(buf);
  final ZNRecord smallRecord=new ZNRecord("normalsize");
  smallRecord.getSimpleFields().clear();
  for (int i=0; i < 900; i++) {
    smallRecord.setSimpleField(i + "",bufStr);
  }
  String path1="/" + root + "/test1";
  _zkclient.createPersistent(path1,true);
  _zkclient.writeData(path1,smallRecord);
  ZNRecordStreamingSerializer serializer=new ZNRecordStreamingSerializer();
  ZNRecord record=_zkclient.readData(path1);
  Assert.assertTrue(serializer.serialize(record).length > 900 * 1024);
  final ZNRecord largeRecord=new ZNRecord("oversize");
  largeRecord.getSimpleFields().clear();
  for (int i=0; i < 1024; i++) {
    largeRecord.setSimpleField(i + "",bufStr);
  }
  String path2="/" + root + "/test2";
  _zkclient.createPersistent(path2,true);
  try {
    _zkclient.writeData(path2,largeRecord);
    Assert.fail("Should fail because data size is larger than 1M");
  }
 catch (  HelixException e) {
  }
  record=_zkclient.readData(path2);
  Assert.assertNull(record);
  record=_zkclient.readData(path1);
  try {
    _zkclient.writeData(path1,largeRecord);
    Assert.fail("Should fail because data size is larger than 1M");
  }
 catch (  HelixException e) {
  }
  ZNRecord recordNew=_zkclient.readData(path1);
  byte[] arr=serializer.serialize(record);
  byte[] arrNew=serializer.serialize(recordNew);
  Assert.assertTrue(Arrays.equals(arr,arrNew));
  ZKHelixAdmin admin=new ZKHelixAdmin(_zkclient);
  admin.addCluster(className,true);
  InstanceConfig instanceConfig=new InstanceConfig("localhost_12918");
  admin.addInstance(className,instanceConfig);
  ZKHelixDataAccessor accessor=new ZKHelixDataAccessor(className,new ZkBaseDataAccessor<ZNRecord>(_zkclient));
  Builder keyBuilder=accessor.keyBuilder();
  IdealState idealState=new IdealState("currentState");
  idealState.setStateModelDefId(StateModelDefId.from("MasterSlave"));
  idealState.setRebalanceMode(RebalanceMode.SEMI_AUTO);
  idealState.setNumPartitions(10);
  for (int i=0; i < 1024; i++) {
    idealState.getRecord().setSimpleField(i + "",bufStr);
  }
  boolean succeed=accessor.setProperty(keyBuilder.idealStates("TestDB0"),idealState);
  Assert.assertFalse(succeed);
  HelixProperty property=accessor.getProperty(keyBuilder.stateTransitionStatus("localhost_12918","session_1","partition_1"));
  Assert.assertNull(property);
  idealState.getRecord().getSimpleFields().clear();
  idealState.setStateModelDefId(StateModelDefId.from("MasterSlave"));
  idealState.setRebalanceMode(RebalanceMode.SEMI_AUTO);
  idealState.setNumPartitions(10);
  for (int i=0; i < 900; i++) {
    idealState.getRecord().setSimpleField(i + "",bufStr);
  }
  succeed=accessor.setProperty(keyBuilder.idealStates("TestDB1"),idealState);
  Assert.assertTrue(succeed);
  record=accessor.getProperty(keyBuilder.idealStates("TestDB1")).getRecord();
  Assert.assertTrue(serializer.serialize(record).length > 900 * 1024);
  idealState.getRecord().getSimpleFields().clear();
  idealState.setStateModelDefId(StateModelDefId.from("MasterSlave"));
  idealState.setRebalanceMode(RebalanceMode.SEMI_AUTO);
  idealState.setNumPartitions(10);
  for (int i=900; i < 1024; i++) {
    idealState.getRecord().setSimpleField(i + "",bufStr);
  }
  succeed=accessor.updateProperty(keyBuilder.idealStates("TestDB1"),idealState);
  Assert.assertFalse(succeed);
  recordNew=accessor.getProperty(keyBuilder.idealStates("TestDB1")).getRecord();
  arr=serializer.serialize(record);
  arrNew=serializer.serialize(recordNew);
  Assert.assertTrue(Arrays.equals(arr,arrNew));
  System.out.println("END testZNRecordSizeLimitUseZNRecordSerializer at " + new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZNRecordSizeLimitUseZNRecordStreamingSerializer(){
  String className=TestUtil.getTestName();
  System.out.println("START testZNRecordSizeLimitUseZNRecordStreamingSerializer at " + new Date(System.currentTimeMillis()));
  ZNRecordStreamingSerializer serializer=new ZNRecordStreamingSerializer();
  String root=className;
  byte[] buf=new byte[1024];
  for (int i=0; i < 1024; i++) {
    buf[i]='a';
  }
  String bufStr=new String(buf);
  final ZNRecord smallRecord=new ZNRecord("normalsize");
  smallRecord.getSimpleFields().clear();
  for (int i=0; i < 900; i++) {
    smallRecord.setSimpleField(i + "",bufStr);
  }
  String path1="/" + root + "/test1";
  _zkclient.createPersistent(path1,true);
  _zkclient.writeData(path1,smallRecord);
  ZNRecord record=_zkclient.readData(path1);
  Assert.assertTrue(serializer.serialize(record).length > 900 * 1024);
  final ZNRecord largeRecord=new ZNRecord("oversize");
  largeRecord.getSimpleFields().clear();
  for (int i=0; i < 1024; i++) {
    largeRecord.setSimpleField(i + "",bufStr);
  }
  String path2="/" + root + "/test2";
  _zkclient.createPersistent(path2,true);
  try {
    _zkclient.writeData(path2,largeRecord);
    Assert.fail("Should fail because data size is larger than 1M");
  }
 catch (  HelixException e) {
  }
  record=_zkclient.readData(path2);
  Assert.assertNull(record);
  record=_zkclient.readData(path1);
  try {
    _zkclient.writeData(path1,largeRecord);
    Assert.fail("Should fail because data size is larger than 1M");
  }
 catch (  HelixException e) {
  }
  ZNRecord recordNew=_zkclient.readData(path1);
  byte[] arr=serializer.serialize(record);
  byte[] arrNew=serializer.serialize(recordNew);
  Assert.assertTrue(Arrays.equals(arr,arrNew));
  ZKHelixAdmin admin=new ZKHelixAdmin(_zkclient);
  admin.addCluster(className,true);
  InstanceConfig instanceConfig=new InstanceConfig("localhost_12918");
  admin.addInstance(className,instanceConfig);
  ZKHelixDataAccessor accessor=new ZKHelixDataAccessor(className,new ZkBaseDataAccessor<ZNRecord>(_zkclient));
  Builder keyBuilder=accessor.keyBuilder();
  IdealState idealState=new IdealState("currentState");
  idealState.setStateModelDefId(StateModelDefId.from("MasterSlave"));
  idealState.setRebalanceMode(RebalanceMode.SEMI_AUTO);
  idealState.setNumPartitions(10);
  for (int i=0; i < 1024; i++) {
    idealState.getRecord().setSimpleField(i + "",bufStr);
  }
  boolean succeed=accessor.setProperty(keyBuilder.idealStates("TestDB_1"),idealState);
  Assert.assertFalse(succeed);
  HelixProperty property=accessor.getProperty(keyBuilder.idealStates("TestDB_1"));
  Assert.assertNull(property);
  idealState.getRecord().getSimpleFields().clear();
  idealState.setStateModelDefId(StateModelDefId.from("MasterSlave"));
  idealState.setRebalanceMode(RebalanceMode.SEMI_AUTO);
  idealState.setNumPartitions(10);
  for (int i=0; i < 900; i++) {
    idealState.getRecord().setSimpleField(i + "",bufStr);
  }
  succeed=accessor.setProperty(keyBuilder.idealStates("TestDB_2"),idealState);
  Assert.assertTrue(succeed);
  record=accessor.getProperty(keyBuilder.idealStates("TestDB_2")).getRecord();
  Assert.assertTrue(serializer.serialize(record).length > 900 * 1024);
  idealState.getRecord().getSimpleFields().clear();
  idealState.setStateModelDefId(StateModelDefId.from("MasterSlave"));
  idealState.setRebalanceMode(RebalanceMode.SEMI_AUTO);
  idealState.setNumPartitions(10);
  for (int i=900; i < 1024; i++) {
    idealState.getRecord().setSimpleField(i + "",bufStr);
  }
  succeed=accessor.updateProperty(keyBuilder.idealStates("TestDB_2"),idealState);
  Assert.assertFalse(succeed);
  recordNew=accessor.getProperty(keyBuilder.idealStates("TestDB_2")).getRecord();
  arr=serializer.serialize(record);
  arrNew=serializer.serialize(recordNew);
  Assert.assertTrue(Arrays.equals(arr,arrNew));
  System.out.println("END testZNRecordSizeLimitUseZNRecordStreamingSerializer at " + new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZNRecordStreamingSerializer </h4><pre class="type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the json still deserizalizes correctly if id is not first
 */
@Test public void idNotFirstTest(){
  StringBuilder jsonString=new StringBuilder("{\n").append("  \"simpleFields\": {},\n").append("  \"listFields\": {},\n").append("  \"mapFields\": {},\n").append("\"id\": \"myId\"\n").append("}");
  ZNRecordStreamingSerializer serializer=new ZNRecordStreamingSerializer();
  ZNRecord result=(ZNRecord)serializer.deserialize(jsonString.toString().getBytes());
  Assert.assertNotNull(result);
  Assert.assertEquals(result.getId(),"myId");
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that simple, list, and map fields are initialized as empty even when not in json
 */
@Test public void fieldAutoInitTest(){
  StringBuilder jsonString=new StringBuilder("{\n").append("\"id\": \"myId\"\n").append("}");
  ZNRecordStreamingSerializer serializer=new ZNRecordStreamingSerializer();
  ZNRecord result=(ZNRecord)serializer.deserialize(jsonString.toString().getBytes());
  Assert.assertNotNull(result);
  Assert.assertEquals(result.getId(),"myId");
  Assert.assertNotNull(result.getSimpleFields());
  Assert.assertTrue(result.getSimpleFields().isEmpty());
  Assert.assertNotNull(result.getListFields());
  Assert.assertTrue(result.getListFields().isEmpty());
  Assert.assertNotNull(result.getMapFields());
  Assert.assertTrue(result.getMapFields().isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Check that the ZNRecord is not constructed if there is no id in the json
 */
@Test public void noIdTest(){
  StringBuilder jsonString=new StringBuilder("{\n").append("  \"simpleFields\": {},\n").append("  \"listFields\": {},\n").append("  \"mapFields\": {}\n").append("}\n");
  ZNRecordStreamingSerializer serializer=new ZNRecordStreamingSerializer();
  ZNRecord result=(ZNRecord)serializer.deserialize(jsonString.toString().getBytes());
  Assert.assertNull(result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZkBaseDataAccessor </h4><pre class="type-7 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyncSet(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  String path=String.format("/%s/%s",testName,"msg_0");
  ZNRecord record=new ZNRecord("msg_0");
  boolean success=_baseAccessor.set(path,record,AccessOption.PERSISTENT);
  Assert.assertTrue(success);
  ZNRecord getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getId(),"msg_0");
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyncCreate(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  String path=String.format("/%s/%s",testName,"msg_0");
  ZNRecord record=new ZNRecord("msg_0");
  ZkBaseDataAccessor<ZNRecord> accessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  boolean success=accessor.create(path,record,AccessOption.PERSISTENT);
  Assert.assertTrue(success);
  ZNRecord getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getId(),"msg_0");
  record.setSimpleField("key0","value0");
  success=accessor.create(path,record,AccessOption.PERSISTENT);
  Assert.assertFalse(success,"Should fail since node already exists");
  getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getSimpleFields().size(),0);
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAsyncZkBaseDataAccessor(){
  System.out.println("START TestZkBaseDataAccessor.async at " + new Date(System.currentTimeMillis()));
  String root="TestZkBaseDataAccessor_asyn";
  ZkClient zkClient=new ZkClient(_zkaddr);
  zkClient.setZkSerializer(new ZNRecordSerializer());
  zkClient.deleteRecursive("/" + root);
  ZkBaseDataAccessor<ZNRecord> accessor=new ZkBaseDataAccessor<ZNRecord>(zkClient);
  String parentPath=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1");
  List<ZNRecord> records=new ArrayList<ZNRecord>();
  List<String> paths=new ArrayList<String>();
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    paths.add(PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId));
    records.add(new ZNRecord(msgId));
  }
  boolean[] success=accessor.createChildren(paths,records,AccessOption.PERSISTENT);
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    Assert.assertTrue(success[i],"Should succeed in create " + msgId);
  }
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    String path=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId);
    ZNRecord record=zkClient.readData(path);
    Assert.assertEquals(record.getId(),msgId,"Should get what we created");
  }
  parentPath=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1");
  records=new ArrayList<ZNRecord>();
  paths=new ArrayList<String>();
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    paths.add(PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId));
    ZNRecord newRecord=new ZNRecord(msgId);
    newRecord.setSimpleField("key1","value1");
    records.add(newRecord);
  }
  success=accessor.setChildren(paths,records,AccessOption.PERSISTENT);
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    Assert.assertTrue(success[i],"Should succeed in set " + msgId);
  }
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    String path=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId);
    ZNRecord record=zkClient.readData(path);
    Assert.assertEquals(record.getSimpleFields().size(),1,"Should have 1 simple field set");
    Assert.assertEquals(record.getSimpleField("key1"),"value1","Should have value1 set");
  }
  parentPath=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1");
  List<DataUpdater<ZNRecord>> znrecordUpdaters=new ArrayList<DataUpdater<ZNRecord>>();
  paths=new ArrayList<String>();
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    paths.add(PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId));
    ZNRecord newRecord=new ZNRecord(msgId);
    newRecord.setSimpleField("key2","value2");
    znrecordUpdaters.add(new ZNRecordUpdater(newRecord));
  }
  success=accessor.updateChildren(paths,znrecordUpdaters,AccessOption.PERSISTENT);
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    Assert.assertTrue(success[i],"Should succeed in update " + msgId);
  }
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    String path=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId);
    ZNRecord record=zkClient.readData(path);
    Assert.assertEquals(record.getSimpleFields().size(),2,"Should have 2 simple fields set");
    Assert.assertEquals(record.getSimpleField("key2"),"value2","Should have value2 set");
  }
  parentPath=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1");
  records=accessor.getChildren(parentPath,null,0);
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    ZNRecord record=records.get(i);
    Assert.assertEquals(record.getId(),msgId,"Should get what we updated");
    Assert.assertEquals(record.getSimpleFields().size(),2,"Should have 2 simple fields set");
    Assert.assertEquals(record.getSimpleField("key2"),"value2","Should have value2 set");
  }
  parentPath=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1");
  paths=new ArrayList<String>();
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    paths.add(PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId));
  }
  boolean[] exists=accessor.exists(paths,0);
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    Assert.assertTrue(exists[i],"Should exist " + msgId);
  }
  parentPath=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1");
  paths=new ArrayList<String>();
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    paths.add(PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId));
  }
  Stat[] stats=accessor.getStats(paths,0);
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    Assert.assertNotNull(stats[i],"Stat should exist for " + msgId);
    Assert.assertEquals(stats[i].getVersion(),2,"DataVersion should be 2, since we set 1 and update 1 for " + msgId);
  }
  parentPath=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1");
  paths=new ArrayList<String>();
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    paths.add(PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId));
  }
  success=accessor.remove(paths,0);
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    Assert.assertTrue(success[i],"Should succeed in remove " + msgId);
  }
  for (int i=0; i < 10; i++) {
    String msgId="msg_" + i;
    String path=PropertyPathConfig.getPath(PropertyType.MESSAGES,root,"host_1",msgId);
    boolean pathExists=zkClient.exists(path);
    Assert.assertFalse(pathExists,"Should be removed " + msgId);
  }
  zkClient.close();
  System.out.println("END TestZkBaseDataAccessor.async at " + new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-11 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyncGetStat(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  String path=String.format("/%s/%s",testName,"msg_0");
  ZNRecord record=new ZNRecord("msg_0");
  ZkBaseDataAccessor<ZNRecord> accessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  Stat stat=accessor.getStat(path,0);
  Assert.assertNull(stat);
  boolean success=accessor.create(path,record,AccessOption.EPHEMERAL);
  Assert.assertTrue(success);
  stat=accessor.getStat(path,0);
  Assert.assertNotNull(stat);
  Assert.assertEquals(stat.getVersion(),0);
  Assert.assertNotSame(stat.getEphemeralOwner(),0);
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyncDoSet(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  String path=String.format("/%s/%s/%s",testName,"msg_0","submsg_0");
  ZNRecord record=new ZNRecord("submsg_0");
  ZkBaseDataAccessor<ZNRecord> accessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  AccessResult result=accessor.doSet(path,record,-1,AccessOption.PERSISTENT);
  Assert.assertEquals(result._retCode,RetCode.OK);
  Assert.assertEquals(result._pathCreated.size(),3);
  Assert.assertTrue(result._pathCreated.contains(String.format("/%s",testName)));
  Assert.assertTrue(result._pathCreated.contains(String.format("/%s/%s",testName,"msg_0")));
  Assert.assertTrue(result._pathCreated.contains(path));
  Assert.assertTrue(_zkclient.exists(String.format("/%s",testName)));
  Assert.assertTrue(_zkclient.exists(String.format("/%s/%s",testName,"msg_0")));
  ZNRecord getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getId(),"submsg_0");
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyncUpdate(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  String path=String.format("/%s/%s",testName,"msg_0");
  ZNRecord record=new ZNRecord("msg_0");
  ZkBaseDataAccessor<ZNRecord> accessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  boolean success=accessor.update(path,new ZNRecordUpdater(record),AccessOption.PERSISTENT);
  Assert.assertTrue(success);
  ZNRecord getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getId(),"msg_0");
  record.setSimpleField("key0","value0");
  success=accessor.update(path,new ZNRecordUpdater(record),AccessOption.PERSISTENT);
  Assert.assertTrue(success);
  getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getSimpleFields().size(),1);
  Assert.assertNotNull(getRecord.getSimpleField("key0"));
  Assert.assertEquals(getRecord.getSimpleField("key0"),"value0");
  success=accessor.update(path,new DataUpdater<ZNRecord>(){
    @Override public ZNRecord update(    ZNRecord currentData){
      throw new RuntimeException("IGNORABLE: test throw exception from updater");
    }
  }
,AccessOption.PERSISTENT);
  Assert.assertFalse(success);
  getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getSimpleFields().size(),1);
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyncSetWithVersion(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  String path=String.format("/%s/%s",testName,"msg_0");
  ZNRecord record=new ZNRecord("msg_0");
  boolean success=_baseAccessor.set(path,record,0,AccessOption.PERSISTENT);
  Assert.assertFalse(success,"Should fail since version not match");
  try {
    _zkclient.readData(path,false);
    Assert.fail("Should get no node exception");
  }
 catch (  Exception e) {
  }
  success=_baseAccessor.set(path,record,-1,AccessOption.PERSISTENT);
  Assert.assertTrue(success);
  ZNRecord getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getId(),"msg_0");
  path=String.format("/%s/%s",testName,"msg_1");
  record=new ZNRecord("msg_1");
  success=_baseAccessor.set(path,record,0,AccessOption.EPHEMERAL);
  Assert.assertFalse(success);
  try {
    _zkclient.readData(path,false);
    Assert.fail("Should get no node exception");
  }
 catch (  Exception e) {
  }
  success=_baseAccessor.set(path,record,-1,AccessOption.EPHEMERAL);
  Assert.assertTrue(success);
  getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getId(),"msg_1");
  record.setSimpleField("key0","value0");
  success=_baseAccessor.set(path,record,0,AccessOption.PERSISTENT);
  Assert.assertTrue(success,"Should pass. AccessOption.PERSISTENT is ignored");
  getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getSimpleFields().size(),1);
  Assert.assertNotNull(getRecord.getSimpleField("key0"));
  Assert.assertEquals(getRecord.getSimpleField("key0"),"value0");
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyncRemove(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  String path=String.format("/%s/%s",testName,"msg_0");
  ZNRecord record=new ZNRecord("msg_0");
  ZkBaseDataAccessor<ZNRecord> accessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  boolean success=accessor.remove(path,0);
  Assert.assertFalse(success);
  success=accessor.create(path,record,AccessOption.PERSISTENT);
  Assert.assertTrue(success);
  ZNRecord getRecord=_zkclient.readData(path);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getId(),"msg_0");
  success=accessor.remove(path,0);
  Assert.assertTrue(success);
  Assert.assertFalse(_zkclient.exists(path));
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-5 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyncGet(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String testName=className + "_" + methodName;
  System.out.println("START " + testName + " at "+ new Date(System.currentTimeMillis()));
  String path=String.format("/%s/%s",testName,"msg_0");
  ZNRecord record=new ZNRecord("msg_0");
  ZkBaseDataAccessor<ZNRecord> accessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  Stat stat=new Stat();
  ZNRecord getRecord=accessor.get(path,stat,0);
  Assert.assertNull(getRecord);
  try {
    accessor.get(path,stat,AccessOption.THROW_EXCEPTION_IFNOTEXIST);
    Assert.fail("Should throw exception if not exist");
  }
 catch (  Exception e) {
  }
  boolean success=accessor.create(path,record,AccessOption.PERSISTENT);
  Assert.assertTrue(success);
  getRecord=accessor.get(path,stat,0);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getId(),"msg_0");
  Assert.assertEquals(stat.getVersion(),0);
  record.setSimpleField("key0","value0");
  success=accessor.set(path,record,AccessOption.PERSISTENT);
  Assert.assertTrue(success);
  getRecord=accessor.get(path,stat,0);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(record.getSimpleFields().size(),1);
  Assert.assertNotNull(getRecord.getSimpleField("key0"));
  Assert.assertEquals(getRecord.getSimpleField("key0"),"value0");
  Assert.assertEquals(stat.getVersion(),1);
  ZNRecord newRecord=new ZNRecord("msg_0");
  newRecord.setSimpleField("key1","value1");
  success=accessor.update(path,new ZNRecordUpdater(newRecord),AccessOption.PERSISTENT);
  Assert.assertTrue(success);
  getRecord=accessor.get(path,stat,0);
  Assert.assertNotNull(getRecord);
  Assert.assertEquals(getRecord.getSimpleFields().size(),2);
  Assert.assertNotNull(getRecord.getSimpleField("key0"));
  Assert.assertEquals(getRecord.getSimpleField("key0"),"value0");
  Assert.assertNotNull(getRecord.getSimpleField("key1"));
  Assert.assertEquals(getRecord.getSimpleField("key1"),"value1");
  Assert.assertEquals(stat.getVersion(),2);
  System.out.println("END " + testName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZkFlapping </h4><pre class="type-4 type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParticipantFlapping() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  final HelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  final PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,32,1,1,"MasterSlave",false);
  final String instanceName="localhost_12918";
  MockParticipant participant=new MockParticipant(_zkaddr,clusterName,instanceName);
  participant.syncStart();
  final ZkClient client=participant.getZkClient();
  final ZkStateCountListener listener=new ZkStateCountListener();
  client.subscribeStateChanges(listener);
  final AtomicInteger expectDisconnectCnt=new AtomicInteger(0);
  final int n=ZKHelixManager.MAX_DISCONNECT_THRESHOLD;
  for (int i=0; i < n; i++) {
    String oldSessionId=ZkTestHelper.getSessionId(client);
    ZkTestHelper.simulateZkStateDisconnected(client);
    expectDisconnectCnt.incrementAndGet();
    TestHelper.verify(new Verifier(){
      @Override public boolean verify() throws Exception {
        return listener.count == expectDisconnectCnt.get();
      }
    }
,30 * 1000);
    String newSessionId=ZkTestHelper.getSessionId(client);
    Assert.assertEquals(newSessionId,oldSessionId);
  }
  client.unsubscribeStateChanges(listener);
  LiveInstance liveInstance=accessor.getProperty(keyBuilder.liveInstance(instanceName));
  Assert.assertNotNull(liveInstance,"Live-instance should exist after " + n + " disconnects");
  ZkTestHelper.simulateZkStateDisconnected(client);
  boolean success=TestHelper.verify(new Verifier(){
    @Override public boolean verify() throws Exception {
      return client.getShutdownTrigger();
    }
  }
,30 * 1000);
  Assert.assertTrue(success,"The " + (n + 1) + "th disconnect event should trigger ZkHelixManager#disonnect");
  success=TestHelper.verify(new TestHelper.Verifier(){
    @Override public boolean verify() throws Exception {
      LiveInstance liveInstance=accessor.getProperty(keyBuilder.liveInstance(instanceName));
      return liveInstance == null;
    }
  }
,3 * 1000);
  Assert.assertTrue(success,"Live-instance should be gone after " + (n + 1) + " disconnects");
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testControllerFlapping() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  final HelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  final PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,32,1,1,"MasterSlave",false);
  MockController controller=new MockController(_zkaddr,clusterName,"controller");
  controller.syncStart();
  final ZkClient client=controller.getZkClient();
  final ZkStateCountListener listener=new ZkStateCountListener();
  client.subscribeStateChanges(listener);
  final AtomicInteger expectDisconnectCnt=new AtomicInteger(0);
  final int n=ZKHelixManager.MAX_DISCONNECT_THRESHOLD;
  for (int i=0; i < n; i++) {
    String oldSessionId=ZkTestHelper.getSessionId(client);
    ZkTestHelper.simulateZkStateDisconnected(client);
    expectDisconnectCnt.incrementAndGet();
    TestHelper.verify(new Verifier(){
      @Override public boolean verify() throws Exception {
        return listener.count == expectDisconnectCnt.get();
      }
    }
,30 * 1000);
    String newSessionId=ZkTestHelper.getSessionId(client);
    Assert.assertEquals(newSessionId,oldSessionId);
  }
  LiveInstance leader=accessor.getProperty(keyBuilder.controllerLeader());
  Assert.assertNotNull(leader,"Leader should exist after " + n + " disconnects");
  ZkTestHelper.simulateZkStateDisconnected(client);
  boolean success=TestHelper.verify(new Verifier(){
    @Override public boolean verify() throws Exception {
      return client.getShutdownTrigger();
    }
  }
,30 * 1000);
  Assert.assertTrue(success,"The " + (n + 1) + "th disconnect event should trigger ZkHelixManager#disonnect");
  success=TestHelper.verify(new TestHelper.Verifier(){
    @Override public boolean verify() throws Exception {
      LiveInstance leader=accessor.getProperty(keyBuilder.controllerLeader());
      return leader == null;
    }
  }
,5 * 1000);
  Assert.assertTrue(success,"Leader should be gone after " + (n + 1) + " disconnects");
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZkHelixAdmin </h4><pre class="type-5 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddRemoveMsgConstraint(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  HelixAdmin tool=new ZKHelixAdmin(_zkclient);
  tool.addCluster(clusterName,true);
  Assert.assertTrue(ZKUtil.isClusterSetup(clusterName,_zkclient),"Cluster should be setup");
  ClusterConstraints constraints=tool.getConstraints(clusterName,ConstraintType.MESSAGE_CONSTRAINT);
  Assert.assertNull(constraints,"message-constraint should NOT exist for cluster: " + className);
  try {
    tool.removeConstraint(clusterName,ConstraintType.MESSAGE_CONSTRAINT,"constraint1");
  }
 catch (  Exception e) {
    Assert.fail("Should not throw exception when remove a non-exist constraint.");
  }
  ConstraintItemBuilder builder=new ConstraintItemBuilder();
  builder.addConstraintAttribute(ConstraintAttribute.RESOURCE.toString(),"MyDB").addConstraintAttribute(ConstraintAttribute.CONSTRAINT_VALUE.toString(),"1");
  tool.setConstraint(clusterName,ConstraintType.MESSAGE_CONSTRAINT,"constraint1",builder.build());
  HelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,new ZkBaseDataAccessor<ZNRecord>(_zkclient));
  PropertyKey.Builder keyBuilder=new PropertyKey.Builder(clusterName);
  constraints=accessor.getProperty(keyBuilder.constraint(ConstraintType.MESSAGE_CONSTRAINT.toString()));
  Assert.assertNotNull(constraints,"message-constraint should exist");
  ConstraintItem item=constraints.getConstraintItem(ConstraintId.from("constraint1"));
  Assert.assertNotNull(item,"message-constraint for constraint1 should exist");
  Assert.assertEquals(item.getConstraintValue(),"1");
  Assert.assertEquals(item.getAttributeValue(ConstraintAttribute.RESOURCE),"MyDB");
  constraints=tool.getConstraints(clusterName,ConstraintType.MESSAGE_CONSTRAINT);
  Assert.assertNotNull(constraints,"message-constraint should exist");
  item=constraints.getConstraintItem(ConstraintId.from("constraint1"));
  Assert.assertNotNull(item,"message-constraint for constraint1 should exist");
  Assert.assertEquals(item.getConstraintValue(),"1");
  Assert.assertEquals(item.getAttributeValue(ConstraintAttribute.RESOURCE),"MyDB");
  tool.removeConstraint(clusterName,ConstraintType.MESSAGE_CONSTRAINT,"constraint1");
  constraints=accessor.getProperty(keyBuilder.constraint(ConstraintType.MESSAGE_CONSTRAINT.toString()));
  Assert.assertNotNull(constraints,"message-constraint should exist");
  item=constraints.getConstraintItem(ConstraintId.from("constraint1"));
  Assert.assertNull(item,"message-constraint for constraint1 should NOT exist");
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-5 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testZkHelixAdmin(){
  System.out.println("START testZkHelixAdmin at " + new Date(System.currentTimeMillis()));
  final String clusterName=TestUtil.getTestName();
  String rootPath="/" + clusterName;
  if (_zkclient.exists(rootPath)) {
    _zkclient.deleteRecursive(rootPath);
  }
  HelixAdmin tool=new ZKHelixAdmin(_zkclient);
  tool.addCluster(clusterName,true);
  Assert.assertTrue(ZKUtil.isClusterSetup(clusterName,_zkclient));
  tool.addCluster(clusterName,true);
  Assert.assertTrue(ZKUtil.isClusterSetup(clusterName,_zkclient));
  List<String> list=tool.getClusters();
  AssertJUnit.assertTrue(list.size() > 0);
  try {
    Stat oldstat=_zkclient.getStat(rootPath);
    Assert.assertNotNull(oldstat);
    boolean success=tool.addCluster(clusterName,false);
    Assert.assertTrue(success);
    Stat newstat=_zkclient.getStat(rootPath);
    Assert.assertEquals(oldstat,newstat);
  }
 catch (  HelixException e) {
  }
  InstanceConfig config=new InstanceConfig("host1_9999");
  config.setHostName("host1");
  config.setPort("9999");
  tool.addInstance(clusterName,config);
  tool.enableInstance(clusterName,"host1_9999",true);
  String path=PropertyPathConfig.getPath(PropertyType.INSTANCES,clusterName,"host1_9999");
  AssertJUnit.assertTrue(_zkclient.exists(path));
  try {
    tool.addInstance(clusterName,config);
    Assert.fail("should fail if add an alredy-existing instance");
  }
 catch (  HelixException e) {
  }
  config=tool.getInstanceConfig(clusterName,"host1_9999");
  AssertJUnit.assertEquals(config.getId(),"host1_9999");
  tool.dropInstance(clusterName,config);
  try {
    tool.getInstanceConfig(clusterName,"host1_9999");
    Assert.fail("should fail if get a non-existent instance");
  }
 catch (  HelixException e) {
  }
  try {
    tool.dropInstance(clusterName,config);
    Assert.fail("should fail if drop on a non-existent instance");
  }
 catch (  HelixException e) {
  }
  try {
    tool.enableInstance(clusterName,"host1_9999",false);
    Assert.fail("should fail if enable a non-existent instance");
  }
 catch (  HelixException e) {
  }
  ZNRecord stateModelRecord=new ZNRecord("id1");
  try {
    tool.addStateModelDef(clusterName,"id1",new StateModelDefinition(stateModelRecord));
    path=PropertyPathConfig.getPath(PropertyType.STATEMODELDEFS,clusterName,"id1");
    AssertJUnit.assertTrue(_zkclient.exists(path));
    Assert.fail("should fail");
  }
 catch (  HelixException e) {
  }
catch (  IllegalArgumentException ex) {
  }
  tool.addStateModelDef(clusterName,"MasterSlave",new StateModelDefinition(StateModelConfigGenerator.generateConfigForMasterSlave()));
  stateModelRecord=StateModelConfigGenerator.generateConfigForMasterSlave();
  try {
    tool.addStateModelDef(clusterName,stateModelRecord.getId(),new StateModelDefinition(stateModelRecord));
    Assert.fail("should fail if add an already-existing state model");
  }
 catch (  HelixException e) {
  }
  list=tool.getStateModelDefs(clusterName);
  AssertJUnit.assertEquals(list.size(),1);
  try {
    tool.addResource(clusterName,"resource",10,"nonexistStateModelDef");
    Assert.fail("should fail if add a resource without an existing state model");
  }
 catch (  HelixException e) {
  }
  try {
    tool.addResource(clusterName,"resource",10,"id1");
    Assert.fail("should fail");
  }
 catch (  HelixException e) {
  }
  list=tool.getResourcesInCluster(clusterName);
  AssertJUnit.assertEquals(list.size(),0);
  try {
    tool.addResource(clusterName,"resource",10,"id1");
    Assert.fail("should fail");
  }
 catch (  HelixException e) {
  }
  list=tool.getResourcesInCluster(clusterName);
  AssertJUnit.assertEquals(list.size(),0);
  ExternalView resourceExternalView=tool.getResourceExternalView(clusterName,"resource");
  AssertJUnit.assertNull(resourceExternalView);
  HelixConfigScope scope=new HelixConfigScopeBuilder(ConfigScopeProperty.PARTITION).forCluster(clusterName).forResource("testResource").forPartition("testPartition").build();
  Map<String,String> properties=new HashMap<String,String>();
  properties.put("pKey1","pValue1");
  properties.put("pKey2","pValue2");
  for (int i=0; i < 100; i++) {
    tool.setConfig(scope,properties);
    Map<String,String> newProperties=tool.getConfig(scope,new ArrayList<String>(properties.keySet()));
    Assert.assertEquals(newProperties.size(),2);
    Assert.assertEquals(newProperties.get("pKey1"),"pValue1");
    Assert.assertEquals(newProperties.get("pKey2"),"pValue2");
  }
  System.out.println("END testZkHelixAdmin at " + new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZkHelixController </h4><pre class="type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnConnectedAndDisconnecting() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=2;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,32,n,2,"MasterSlave",true);
  HelixConnection connection=new ZkHelixConnection(_zkaddr);
  connection.connect();
  ClusterId clusterId=ClusterId.from(clusterName);
  ControllerId controllerId=ControllerId.from("controller");
  HelixController controller=connection.createController(clusterId,controllerId);
  controller.start();
  HelixDataAccessor accessor=connection.createDataAccessor(clusterId);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  LiveInstance leader=accessor.getProperty(keyBuilder.controllerLeader());
  Assert.assertNotNull(leader);
  Assert.assertEquals(leader.getInstanceName(),controllerId.stringify());
  controller.stop();
  Assert.assertNull(accessor.getProperty(keyBuilder.controllerLeader()));
  connection.disconnect();
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Remove leader znode externally should invoke another round of leader-election
 * this simulates the race condition in{@link ZkHelixLeaderElection#onControllerChange(org.apache.helix.NotificationContext)}
 * @throws Exception
 */
@Test public void testRemoveLeaderZnode() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=2;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,32,n,2,"MasterSlave",true);
  HelixConnection connection=new ZkHelixConnection(_zkaddr);
  connection.connect();
  ClusterId clusterId=ClusterId.from(clusterName);
  final ControllerId controllerId=ControllerId.from("controller");
  HelixController controller=connection.createController(clusterId,controllerId);
  controller.start();
  final HelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  final PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  LiveInstance leader=accessor.getProperty(keyBuilder.controllerLeader());
  Assert.assertNotNull(leader);
  Assert.assertEquals(leader.getInstanceName(),controllerId.stringify());
  accessor.removeProperty(keyBuilder.controllerLeader());
  boolean result=TestHelper.verify(new TestHelper.Verifier(){
    @Override public boolean verify() throws Exception {
      LiveInstance leader=accessor.getProperty(keyBuilder.controllerLeader());
      if (leader == null) {
        return false;
      }
      return leader.getInstanceName().equals(controllerId.stringify());
    }
  }
,3 * 1000);
  Assert.assertTrue(result,"Fail to re-elect a new leader");
  connection.disconnect();
  Assert.assertNull(accessor.getProperty(keyBuilder.controllerLeader()));
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZkHelixMultiClusterController </h4><pre class="type-4 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnConnectedAndDisconnecting() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=2;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,32,n,2,"MasterSlave",true);
  HelixConnection connection=new ZkHelixConnection(_zkaddr);
  connection.connect();
  ClusterId clusterId=ClusterId.from(clusterName);
  final HelixMultiClusterController[] controllers=new HelixMultiClusterController[n];
  for (int i=0; i < n; i++) {
    int port=12918 + i;
    ControllerId controllerId=ControllerId.from("localhost_" + port);
    controllers[i]=connection.createMultiClusterController(clusterId,controllerId);
    controllers[i].start();
  }
  final HelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  final PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  for (int i=0; i < n; i++) {
    String instanceName=controllers[i].getControllerId().stringify();
    Assert.assertNotNull(accessor.getProperty(keyBuilder.liveInstance(instanceName)));
  }
  LiveInstance leader=accessor.getProperty(keyBuilder.controllerLeader());
  Assert.assertNotNull(leader);
  Assert.assertEquals(leader.getInstanceName(),controllers[0].getControllerId().stringify());
  controllers[0].stop();
  String instanceName=controllers[0].getControllerId().stringify();
  Assert.assertNull(accessor.getProperty(keyBuilder.liveInstance(instanceName)));
  boolean success=TestHelper.verify(new TestHelper.Verifier(){
    @Override public boolean verify() throws Exception {
      LiveInstance leader=accessor.getProperty(keyBuilder.controllerLeader());
      if (leader == null) {
        return false;
      }
      return leader.getInstanceName().equals(controllers[1].getControllerId().stringify());
    }
  }
,3 * 1000);
  Assert.assertTrue(success,"fail to re-elect new leader");
  connection.disconnect();
  instanceName=controllers[1].getControllerId().stringify();
  Assert.assertNull(accessor.getProperty(keyBuilder.liveInstance(instanceName)));
  Assert.assertNull(accessor.getProperty(keyBuilder.controllerLeader()));
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.manager.zk.TestZkHelixParticipant </h4><pre class="type-4 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testOnConnectedAndDisconnecting() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=2;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,32,n,2,"MasterSlave",true);
  HelixConnection connection=new ZkHelixConnection(_zkaddr);
  connection.connect();
  ClusterId clusterId=ClusterId.from(clusterName);
  HelixParticipant[] participants=new HelixParticipant[n];
  for (int i=0; i < n; i++) {
    int port=12918 + i;
    ParticipantId participantId=ParticipantId.from("localhost_" + port);
    participants[i]=connection.createParticipant(clusterId,participantId);
    participants[i].getStateMachineEngine().registerStateModelFactory(StateModelDefId.from("MasterSlave"),new TestHelixConnection.MockStateModelFactory());
    participants[i].start();
  }
  HelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,_baseAccessor);
  PropertyKey.Builder keyBuilder=accessor.keyBuilder();
  for (int i=0; i < n; i++) {
    Assert.assertNotNull(accessor.getProperty(keyBuilder.liveInstance(participants[i].getParticipantId().stringify())));
  }
  participants[0].stop();
  Assert.assertNull(accessor.getProperty(keyBuilder.liveInstance(participants[0].getParticipantId().stringify())));
  connection.disconnect();
  Assert.assertNull(accessor.getProperty(keyBuilder.liveInstance(participants[1].getParticipantId().stringify())));
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.participant.statemachine.TestStateModelParser </h4><pre class="type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUsingAnnotation(){
  StateModelParser parser=new StateModelParser();
  StateModelUsingAnnotation testModel=new StateModelUsingAnnotation();
  Method method=parser.getMethodForTransitionUsingAnnotation(testModel.getClass(),"offline","slave",new Class[]{Message.class,NotificationContext.class});
  Assert.assertNotNull(method);
  Assert.assertEquals(method.getName(),"onBecomeSlaveFromOffline");
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDerivedUsingAnnotation(){
  StateModelParser parser=new StateModelParser();
  DerivedStateModelUsingAnnotation testModel=new DerivedStateModelUsingAnnotation();
  Method method=parser.getMethodForTransitionUsingAnnotation(testModel.getClass(),"offline","slave",new Class[]{Message.class,NotificationContext.class});
  Assert.assertNotNull(method);
  Assert.assertEquals(method.getName(),"derivedOnBecomeSlaveFromOffline");
  method=parser.getMethodForTransitionUsingAnnotation(testModel.getClass(),"error","dropped",new Class[]{Message.class,NotificationContext.class});
  Assert.assertNotNull(method);
  Assert.assertEquals(method.getName(),"onBecomeDroppedFromError");
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUsingNameConvention(){
  StateModelParser parser=new StateModelParser();
  StateModelUsingNameConvention testModel=new StateModelUsingNameConvention();
  Method method=parser.getMethodForTransition(testModel.getClass(),"error","dropped",new Class[]{Message.class,NotificationContext.class});
  Assert.assertNotNull(method);
  Assert.assertEquals(method.getName(),"onBecomeDroppedFromError");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.resolver.TestZKHelixResolver </h4><pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolution(){
  HelixMessageScope clusterScope=new HelixMessageScope.Builder().cluster(CLUSTER_NAME).build();
  Set<HelixAddress> destinations=_resolver.getDestinations(clusterScope);
  Assert.assertNotNull(destinations);
  Set<InetSocketAddress> addresses=new HashSet<InetSocketAddress>();
  for (  HelixAddress destination : destinations) {
    addresses.add(destination.getSocketAddress());
  }
  Assert.assertTrue(addresses.containsAll(_socketMap.values()),"Expected " + _socketMap.values() + ", found "+ addresses);
  HelixMessageScope resourceScope=new HelixMessageScope.Builder().cluster(CLUSTER_NAME).resource(RESOURCE_NAME).build();
  destinations=_resolver.getDestinations(resourceScope);
  Assert.assertNotNull(destinations);
  addresses.clear();
  for (  HelixAddress destination : destinations) {
    addresses.add(destination.getSocketAddress());
  }
  Assert.assertTrue(addresses.containsAll(_socketMap.values()),"Expected " + _socketMap.values() + ", found "+ addresses);
  HelixMessageScope partition0Scope=new HelixMessageScope.Builder().cluster(CLUSTER_NAME).resource(RESOURCE_NAME).partition(RESOURCE_NAME + "_0").build();
  destinations=_resolver.getDestinations(partition0Scope);
  Assert.assertNotNull(destinations);
  ExternalView externalView=_setupTool.getClusterManagementTool().getResourceExternalView(CLUSTER_NAME,RESOURCE_NAME);
  Set<String> instanceSet=externalView.getStateMap(RESOURCE_NAME + "_0").keySet();
  Set<InetSocketAddress> expectedSocketAddrs=Sets.newHashSet();
  for (  String instanceName : instanceSet) {
    expectedSocketAddrs.add(_socketMap.get(instanceName));
  }
  addresses.clear();
  for (  HelixAddress destination : destinations) {
    addresses.add(destination.getSocketAddress());
  }
  Assert.assertEquals(addresses,expectedSocketAddrs,"Expected " + expectedSocketAddrs + ", found "+ addresses);
  HelixMessageScope sourceInstanceScope=new HelixMessageScope.Builder().cluster(CLUSTER_NAME).resource(RESOURCE_NAME).partition(RESOURCE_NAME + "_0").sourceInstance(_participants[0].getInstanceName()).build();
  HelixAddress sourceAddress=_resolver.getSource(sourceInstanceScope);
  Assert.assertNotNull(sourceAddress);
  Assert.assertEquals(sourceAddress.getSocketAddress(),_socketMap.get(_participants[0].getInstanceName()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.store.TestPropertyStoreException </h4><pre class="type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(groups={"unitTest"}) public void testPropertyStoreException(){
  PropertyStoreException exception=new PropertyStoreException("msg");
  AssertJUnit.assertEquals(exception.getMessage(),"msg");
  exception=new PropertyStoreException();
  AssertJUnit.assertNull(exception.getMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.store.zk.TestAutoFallbackPropertyStore </h4><pre class="type-4 type-7 type-14 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetChildren(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 20; i++) {
    if (i < 10) {
      String path=String.format("%s/%d",fallbackRoot,i);
      baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
    }
 else {
      String path=String.format("%s/%d",root,i);
      baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
    }
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  List<String> paths=new ArrayList<String>();
  for (int i=0; i < 20; i++) {
    String path=String.format("/%d",i);
    if (i < 10) {
      Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
      Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
    }
 else {
      Assert.assertFalse(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should not exist under fallback location");
      Assert.assertTrue(baseAccessor.exists(String.format("%s%s",root,path),0),"Should exist under new location");
    }
    paths.add(path);
  }
  List<String> childs=store.getChildNames("/",0);
  Assert.assertNotNull(childs);
  Assert.assertEquals(childs.size(),20);
  for (int i=0; i < 20; i++) {
    String child=childs.get(i);
    Assert.assertTrue(childs.contains(child));
  }
  List<ZNRecord> records=store.getChildren("/",null,0);
  Assert.assertNotNull(records);
  Assert.assertEquals(records.size(),20);
  for (int i=0; i < 20; i++) {
    ZNRecord record=records.get(i);
    Assert.assertNotNull(record);
    String id=record.getId();
    Assert.assertTrue(childs.contains(id));
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test void testMultiGetOnFallbackPath(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 10; i++) {
    String path=String.format("%s/%d",fallbackRoot,i);
    baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  List<String> paths=new ArrayList<String>();
  for (int i=0; i < 10; i++) {
    String path=String.format("/%d",i);
    Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
    Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
    paths.add(path);
  }
  boolean exists[]=store.exists(paths,0);
  for (int i=0; i < paths.size(); i++) {
    Assert.assertTrue(exists[i]);
  }
  Stat stats[]=store.getStats(paths,0);
  for (int i=0; i < paths.size(); i++) {
    Assert.assertNotNull(stats[i]);
  }
  List<ZNRecord> records=store.get(paths,null,0);
  Assert.assertNotNull(records);
  Assert.assertEquals(records.size(),10);
  for (int i=0; i < 10; i++) {
    ZNRecord record=records.get(i);
    String path=paths.get(i);
    Assert.assertNotNull(record);
    Assert.assertEquals(record.getId(),Integer.toString(i));
    Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location after get");
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiUpdateUsingFallbackPath(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 10; i++) {
    String path=String.format("%s/%d",fallbackRoot,i);
    baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  List<String> paths=new ArrayList<String>();
  List<DataUpdater<ZNRecord>> updaters=new ArrayList<DataUpdater<ZNRecord>>();
  for (int i=0; i < 10; i++) {
    String path=String.format("/%d",i);
    Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
    Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
    paths.add(path);
    updaters.add(new MyDataUpdater("new" + i));
  }
  boolean succeed[]=store.updateChildren(paths,updaters,AccessOption.PERSISTENT);
  for (int i=0; i < 10; i++) {
    Assert.assertTrue(succeed[i]);
    String path=paths.get(i);
    ZNRecord record=baseAccessor.get(String.format("%s%s",fallbackRoot,path),null,0);
    Assert.assertNotNull(record);
    Assert.assertEquals(record.getId(),"" + i);
    Assert.assertNull(record.getSimpleField("key"));
    record=baseAccessor.get(String.format("%s%s",root,path),null,0);
    Assert.assertNotNull(record);
    Assert.assertEquals(record.getId(),"" + i);
    Assert.assertNotNull(record.getSimpleField("key"));
    Assert.assertEquals(record.getSimpleField("key"),"value");
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleUpdateUsingFallbackPath(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 1; i++) {
    String path=String.format("%s/%d",fallbackRoot,i);
    baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  String path=String.format("/%d",0);
  Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
  Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
  boolean succeed=store.update(path,new MyDataUpdater("new0"),AccessOption.PERSISTENT);
  Assert.assertTrue(succeed);
  ZNRecord record=baseAccessor.get(String.format("%s%s",fallbackRoot,path),null,0);
  Assert.assertNotNull(record);
  Assert.assertEquals(record.getId(),"0");
  Assert.assertNull(record.getSimpleField("key"));
  record=baseAccessor.get(String.format("%s%s",root,path),null,0);
  Assert.assertNotNull(record);
  Assert.assertEquals(record.getId(),"0");
  Assert.assertNotNull(record.getSimpleField("key"));
  Assert.assertEquals(record.getSimpleField("key"),"value");
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-14 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiUpdateUsingNewath(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 10; i++) {
    String path=String.format("%s/%d",fallbackRoot,i);
    baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
    path=String.format("%s/%d",root,i);
    baseAccessor.create(path,new ZNRecord("new" + i),AccessOption.PERSISTENT);
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  List<String> paths=new ArrayList<String>();
  List<DataUpdater<ZNRecord>> updaters=new ArrayList<DataUpdater<ZNRecord>>();
  for (int i=0; i < 20; i++) {
    String path=String.format("/%d",i);
    if (i < 10) {
      Assert.assertTrue(baseAccessor.exists(String.format("%s%s",root,path),0),"Should exist under new location");
      Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
    }
 else {
      Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
      Assert.assertFalse(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should not exist under fallback location");
    }
    paths.add(path);
    updaters.add(new MyDataUpdater("new" + i));
  }
  boolean succeed[]=store.updateChildren(paths,updaters,AccessOption.PERSISTENT);
  for (int i=0; i < 10; i++) {
    Assert.assertTrue(succeed[i]);
    String path=paths.get(i);
    if (i < 10) {
      ZNRecord record=baseAccessor.get(String.format("%s%s",fallbackRoot,path),null,0);
      Assert.assertNotNull(record);
      Assert.assertEquals(record.getId(),"" + i);
      Assert.assertNull(record.getSimpleField("key"));
    }
 else {
      Assert.assertFalse(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should not exist under fallback location");
    }
    ZNRecord record=baseAccessor.get(String.format("%s%s",root,path),null,0);
    Assert.assertNotNull(record);
    Assert.assertEquals(record.getId(),"new" + i);
    if (i < 10) {
      Assert.assertNotNull(record.getSimpleField("key"));
      Assert.assertEquals(record.getSimpleField("key"),"value");
    }
 else {
      Assert.assertNull(record.getSimpleField("key"));
    }
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiSet(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 10; i++) {
    String path=String.format("%s/%d",fallbackRoot,i);
    baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  List<String> paths=new ArrayList<String>();
  List<ZNRecord> records=new ArrayList<ZNRecord>();
  for (int i=0; i < 10; i++) {
    String path=String.format("/%d",i);
    Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
    Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
    paths.add(path);
    ZNRecord record=new ZNRecord("new" + i);
    records.add(record);
  }
  boolean succeed[]=store.setChildren(paths,records,AccessOption.PERSISTENT);
  for (int i=0; i < 10; i++) {
    Assert.assertTrue(succeed[i]);
    String path=String.format("/%d",i);
    ZNRecord record=baseAccessor.get(String.format("%s%s",fallbackRoot,path),null,0);
    Assert.assertNotNull(record);
    Assert.assertEquals(record.getId(),Integer.toString(i));
    record=baseAccessor.get(String.format("%s%s",root,path),null,0);
    Assert.assertNotNull(record);
    Assert.assertEquals(record.getId(),"new" + i);
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleSet(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 1; i++) {
    String path=String.format("%s/%d",fallbackRoot,i);
    baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  String path=String.format("/%d",0);
  Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
  Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
  ZNRecord record=new ZNRecord("new0");
  boolean succeed=store.set(path,record,AccessOption.PERSISTENT);
  Assert.assertTrue(succeed);
  record=baseAccessor.get(String.format("%s%s",fallbackRoot,path),null,0);
  Assert.assertNotNull(record);
  Assert.assertEquals(record.getId(),"0");
  record=baseAccessor.get(String.format("%s%s",root,path),null,0);
  Assert.assertNotNull(record);
  Assert.assertEquals(record.getId(),"new0");
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-14 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailOnMultiGet(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 10; i++) {
    String path=String.format("%s/%d",fallbackRoot,i);
    baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  List<String> paths=new ArrayList<String>();
  for (int i=0; i < 20; i++) {
    String path=String.format("/%d",i);
    Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
    if (i < 10) {
      Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
    }
 else {
      Assert.assertFalse(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should not exist under fallback location");
    }
    paths.add(path);
  }
  boolean exists[]=store.exists(paths,0);
  for (int i=0; i < paths.size(); i++) {
    if (i < 10) {
      Assert.assertTrue(exists[i]);
    }
 else {
      Assert.assertFalse(exists[i]);
    }
  }
  Stat stats[]=store.getStats(paths,0);
  for (int i=0; i < paths.size(); i++) {
    if (i < 10) {
      Assert.assertNotNull(stats[i]);
    }
 else {
      Assert.assertNull(stats[i]);
    }
  }
  List<ZNRecord> records=store.get(paths,null,0);
  Assert.assertNotNull(records);
  Assert.assertEquals(records.size(),20);
  for (int i=0; i < 20; i++) {
    ZNRecord record=records.get(i);
    String path=paths.get(i);
    if (i < 10) {
      Assert.assertNotNull(record);
      Assert.assertEquals(record.getId(),Integer.toString(i));
    }
 else {
      Assert.assertNull(record);
    }
    Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location after get");
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailOnSingleGet(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  String path=String.format("/%d",0);
  Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
  Assert.assertFalse(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should not exist under fallback location");
  boolean exist=store.exists(path,0);
  Assert.assertFalse(exist);
  Stat stat=store.getStat(path,0);
  Assert.assertNull(stat);
  ZNRecord record=store.get(path,null,0);
  Assert.assertNull(record);
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleUpdateUsingNewPath(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 1; i++) {
    String path=String.format("%s/%d",root,i);
    baseAccessor.create(path,new ZNRecord("new" + i),AccessOption.PERSISTENT);
    path=String.format("%s/%d",fallbackRoot,i);
    baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  String path=String.format("/%d",0);
  Assert.assertTrue(baseAccessor.exists(String.format("%s%s",root,path),0),"Should exist under new location");
  Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
  boolean succeed=store.update(path,new MyDataUpdater("0"),AccessOption.PERSISTENT);
  Assert.assertTrue(succeed);
  ZNRecord record=baseAccessor.get(String.format("%s%s",fallbackRoot,path),null,0);
  Assert.assertNotNull(record);
  Assert.assertEquals(record.getId(),"0");
  Assert.assertNull(record.getSimpleField("key"));
  record=baseAccessor.get(String.format("%s%s",root,path),null,0);
  Assert.assertNotNull(record);
  Assert.assertEquals(record.getId(),"new0");
  Assert.assertNotNull(record.getSimpleField("key"));
  Assert.assertEquals(record.getSimpleField("key"),"value");
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleGetOnFallbackPath(){
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String root=String.format("/%s/%s",clusterName,PropertyType.PROPERTYSTORE.name());
  String fallbackRoot=String.format("/%s/%s",clusterName,"HELIX_PROPERTYSTORE");
  ZkBaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  for (int i=0; i < 1; i++) {
    String path=String.format("%s/%d",fallbackRoot,i);
    baseAccessor.create(path,new ZNRecord(Integer.toString(i)),AccessOption.PERSISTENT);
  }
  AutoFallbackPropertyStore<ZNRecord> store=new AutoFallbackPropertyStore<ZNRecord>(baseAccessor,root,fallbackRoot);
  String path=String.format("/%d",0);
  Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location");
  Assert.assertTrue(baseAccessor.exists(String.format("%s%s",fallbackRoot,path),0),"Should exist under fallback location");
  boolean exist=store.exists(path,0);
  Assert.assertTrue(exist);
  Stat stat=store.getStat(path,0);
  Assert.assertNotNull(stat);
  ZNRecord record=store.get(path,null,0);
  Assert.assertNotNull(record);
  Assert.assertEquals(record.getId(),"0");
  Assert.assertFalse(baseAccessor.exists(String.format("%s%s",root,path),0),"Should not exist under new location after get");
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.store.zk.TestZkHelixPropertyStore </h4><pre class="type-4 type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSet(){
  System.out.println("START testSet() at " + new Date(System.currentTimeMillis()));
  String subRoot=_root + "/" + "set";
  List<String> subscribedPaths=new ArrayList<String>();
  subscribedPaths.add(subRoot);
  ZkHelixPropertyStore<ZNRecord> store=new ZkHelixPropertyStore<ZNRecord>(new ZkBaseDataAccessor<ZNRecord>(_zkclient),subRoot,subscribedPaths);
  setNodes(store,'a',false);
  for (int i=0; i < 10; i++) {
    for (int j=0; j < 10; j++) {
      String nodeId=getNodeId(i,j);
      String key=getSecondLevelKey(i,j);
      ZNRecord record=store.get(key,null,0);
      Assert.assertEquals(record.getId(),nodeId);
    }
  }
  long startT=System.currentTimeMillis();
  for (int i=0; i < 1000; i++) {
    ZNRecord record=store.get("/node_0/childNode_0_0",null,0);
    Assert.assertNotNull(record);
  }
  long endT=System.currentTimeMillis();
  System.out.println("1000 Get() time used: " + (endT - startT) + "ms");
  long latency=endT - startT;
  Assert.assertTrue(latency < 200,"1000 Gets should be finished within 200ms, but was " + latency + " ms");
  store.stop();
  System.out.println("END testSet() at " + new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.store.zk.TestZkManagerWithAutoFallbackStore </h4><pre class="type-4 type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasic() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  int n=2;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,32,n,2,"MasterSlave",false);
  MockParticipant[] participants=new MockParticipant[n];
  for (int i=0; i < 1; i++) {
    String instanceName="localhost_" + (12918 + i);
    participants[i]=new MockParticipant(_zkaddr,clusterName,instanceName);
    participants[i].syncStart();
  }
  BaseDataAccessor<ZNRecord> accessor=participants[0].getHelixDataAccessor().getBaseDataAccessor();
  for (int i=0; i < 10; i++) {
    String path=String.format("/%s/HELIX_PROPERTYSTORE/%d",clusterName,i);
    ZNRecord record=new ZNRecord("" + i);
    record.setSimpleField("key1","value1");
    accessor.set(path,record,AccessOption.PERSISTENT);
  }
  ZkHelixPropertyStore<ZNRecord> store=participants[0].getHelixPropertyStore();
  for (int i=0; i < 10; i++) {
    String path=String.format("/%d",i);
    ZNRecord record=store.get(path,null,0);
    Assert.assertNotNull(record);
    Assert.assertEquals(record.getId(),"" + i);
    Assert.assertNotNull(record.getSimpleField("key1"));
    Assert.assertEquals(record.getSimpleField("key1"),"value1");
  }
  for (int i=0; i < 10; i++) {
    String path=String.format("/%d",i);
    store.update(path,new DataUpdater<ZNRecord>(){
      @Override public ZNRecord update(      ZNRecord currentData){
        if (currentData != null) {
          currentData.setSimpleField("key2","value2");
        }
        return currentData;
      }
    }
,AccessOption.PERSISTENT);
  }
  for (int i=0; i < 10; i++) {
    String path=String.format("/%d",i);
    ZNRecord record=store.get(path,null,0);
    Assert.assertNotNull(record);
    Assert.assertEquals(record.getId(),"" + i);
    Assert.assertNotNull(record.getSimpleField("key1"));
    Assert.assertEquals(record.getSimpleField("key1"),"value1");
    Assert.assertNotNull(record.getSimpleField("key2"));
    Assert.assertEquals(record.getSimpleField("key2"),"value2");
  }
  for (int i=10; i < 20; i++) {
    String path=String.format("/%d",i);
    ZNRecord record=new ZNRecord("" + i);
    record.setSimpleField("key3","value3");
    store.set(path,record,AccessOption.PERSISTENT);
  }
  for (int i=10; i < 20; i++) {
    String path=String.format("/%d",i);
    ZNRecord record=store.get(path,null,0);
    Assert.assertNotNull(record);
    Assert.assertEquals(record.getId(),"" + i);
    Assert.assertNotNull(record.getSimpleField("key3"));
    Assert.assertEquals(record.getSimpleField("key3"),"value3");
  }
  participants[0].syncStop();
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.tools.TestClusterSetup </h4><pre class="type-5 type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropInstance() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  TestHelper.setupCluster(clusterName,_zkaddr,12918,"localhost","TestDB",1,10,5,3,"MasterSlave",true);
  ZKHelixDataAccessor accessor=new ZKHelixDataAccessor(clusterName,new ZkBaseDataAccessor<ZNRecord>(_zkclient));
  Builder keyBuilder=new Builder(clusterName);
  LiveInstance liveInstance=new LiveInstance("localhost_12918");
  liveInstance.setSessionId("session_0");
  liveInstance.setHelixVersion("version_0");
  accessor.setProperty(keyBuilder.liveInstance("localhost_12918"),liveInstance);
  try {
    ClusterSetup.processCommandLineArgs(new String[]{"--zkSvr",_zkaddr,"--dropNode",clusterName,"localhost:12918"});
    Assert.fail("Should throw exception since localhost_12918 is still in LIVEINSTANCES/");
  }
 catch (  Exception e) {
  }
  accessor.removeProperty(keyBuilder.liveInstance("localhost_12918"));
  try {
    ClusterSetup.processCommandLineArgs(new String[]{"--zkSvr",_zkaddr,"--dropNode",clusterName,"localhost:12918"});
    Assert.fail("Should throw exception since localhost_12918 is enabled");
  }
 catch (  Exception e) {
  }
  ClusterSetup.processCommandLineArgs(new String[]{"--zkSvr",_zkaddr,"--enableInstance",clusterName,"localhost_12918","false"});
  ClusterSetup.processCommandLineArgs(new String[]{"--zkSvr",_zkaddr,"--dropNode",clusterName,"localhost:12918"});
  Assert.assertNull(accessor.getProperty(keyBuilder.instanceConfig("localhost_12918")),"Instance config should be dropped");
  Assert.assertFalse(_zkclient.exists(PropertyPathConfig.getPath(PropertyType.INSTANCES,clusterName,"localhost_12918")),"Instance/host should be dropped");
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testSetGetRemoveParticipantConfig() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  _setupTool.addCluster(clusterName,true);
  _setupTool.addInstanceToCluster(clusterName,"localhost_0");
  String scopeArgs=clusterName + ",localhost_0";
  String keyValueMap="key1=value1,key2=value2";
  String keys="key1,key2";
  ClusterSetup.processCommandLineArgs(new String[]{"--zkSvr",_zkaddr,"--setConfig",ConfigScopeProperty.PARTICIPANT.toString(),scopeArgs,keyValueMap});
  String valuesStr=_setupTool.getConfig(ConfigScopeProperty.PARTICIPANT,scopeArgs,keys);
  ZNRecordSerializer serializer=new ZNRecordSerializer();
  ZNRecord record=(ZNRecord)serializer.deserialize(valuesStr.getBytes());
  Assert.assertEquals(record.getSimpleField("key1"),"value1");
  Assert.assertEquals(record.getSimpleField("key2"),"value2");
  ClusterSetup.processCommandLineArgs(new String[]{"--zkSvr",_zkaddr,"--removeConfig",ConfigScopeProperty.PARTICIPANT.toString(),scopeArgs,keys});
  valuesStr=_setupTool.getConfig(ConfigScopeProperty.PARTICIPANT,scopeArgs,keys);
  record=(ZNRecord)serializer.deserialize(valuesStr.getBytes());
  Assert.assertNull(record.getSimpleField("key1"));
  Assert.assertNull(record.getSimpleField("key2"));
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.tools.TestHelixAdminCli </h4><pre class="type-5 type-1 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStartCluster() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  String grandClusterName=clusterName + "_grand";
  final int n=6;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  MockParticipant[] participants=new MockParticipant[n];
  MockMultiClusterController[] controllers=new MockMultiClusterController[2];
  setupCluster(clusterName,grandClusterName,n,participants,controllers);
  String command="-zkSvr localhost:2183 -activateCluster " + clusterName + " nonExistGrandCluster true";
  try {
    ClusterSetup.processCommandLineArgs(command.split("\\s+"));
    Assert.fail("add " + clusterName + " to grandCluster should fail since grandCluster doesn't exists");
  }
 catch (  Exception e) {
  }
  command="-zkSvr localhost:2183 -activateCluster nonExistCluster " + grandClusterName + " true";
  try {
    ClusterSetup.processCommandLineArgs(command.split("\\s+"));
    Assert.fail("add nonExistCluster to " + grandClusterName + " should fail since nonExistCluster doesn't exists");
  }
 catch (  Exception e) {
  }
  command="-zkSvr localhost:2183 -activateCluster " + clusterName + " "+ grandClusterName+ " true";
  ClusterSetup.processCommandLineArgs(command.split("\\s+"));
  Thread.sleep(500);
  command="-zkSvr localhost:2183 -dropCluster " + clusterName;
  try {
    ClusterSetup.processCommandLineArgs(command.split("\\s+"));
    Assert.fail("drop " + clusterName + " should fail since it's still running");
  }
 catch (  Exception e) {
  }
  BaseDataAccessor<ZNRecord> baseAccessor=new ZkBaseDataAccessor<ZNRecord>(_zkclient);
  HelixDataAccessor accessor=new ZKHelixDataAccessor(grandClusterName,baseAccessor);
  LiveInstance controllerLeader=accessor.getProperty(accessor.keyBuilder().controllerLeader());
  Assert.assertNotNull(controllerLeader,"controllerLeader should be either controller_9000 or controller_9001");
  Assert.assertTrue(controllerLeader.getInstanceName().startsWith("controller_900"));
  accessor=new ZKHelixDataAccessor(clusterName,baseAccessor);
  LiveInstance leader=accessor.getProperty(accessor.keyBuilder().controllerLeader());
  for (int i=0; i < 20; i++) {
    if (leader != null) {
      break;
    }
    Thread.sleep(200);
    leader=accessor.getProperty(accessor.keyBuilder().controllerLeader());
  }
  Assert.assertTrue(leader.getInstanceName().startsWith("controller_900"));
  boolean verifyResult=ClusterStateVerifier.verifyByZkCallback(new MasterNbInExtViewVerifier(_zkaddr,clusterName));
  Assert.assertTrue(verifyResult);
  verifyResult=ClusterStateVerifier.verifyByZkCallback(new BestPossAndExtViewZkVerifier(_zkaddr,clusterName));
  Assert.assertTrue(verifyResult);
  for (  MockMultiClusterController controller : controllers) {
    controller.syncStop();
  }
  for (int i=0; i < participants.length; i++) {
    participants[i].syncStop();
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.tools.TestZkCopy </h4><pre class="type-4 type-7 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  String className=TestHelper.getTestClassName();
  String methodName=TestHelper.getTestMethodName();
  String clusterName=className + "_" + methodName;
  System.out.println("START " + clusterName + " at "+ new Date(System.currentTimeMillis()));
  String fromPath="/" + clusterName + "/from";
  _zkclient.createPersistent(fromPath,true);
  for (int i=0; i < 5; i++) {
    for (int j=0; j < 5; j++) {
      String path=String.format("%s/%d/%d",fromPath,i,j);
      _zkclient.createPersistent(path,true);
      _zkclient.writeData(path,new ZNRecord(String.format("%d/%d",i,j)));
    }
  }
  String toPath="/" + clusterName + "/to";
  ZkCopy.main(new String[]{"--src","zk://" + _zkaddr + fromPath,"--dst","zk://" + _zkaddr + toPath});
  Assert.assertTrue(_zkclient.exists(toPath));
  Assert.assertNull(_zkclient.readData(toPath));
  for (int i=0; i < 5; i++) {
    for (int j=0; j < 5; j++) {
      String path=String.format("%s/%d/%d",toPath,i,j);
      Assert.assertTrue(_zkclient.exists(path));
      ZNRecord record=_zkclient.readData(path);
      Assert.assertEquals(String.format("%d/%d",i,j),record.getId());
    }
  }
  System.out.println("END " + clusterName + " at "+ new Date(System.currentTimeMillis()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.helix.webapp.TestHelixAdminScenariosRest </h4><pre class="type-7 type-1 type-8 type-2 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetResources() throws IOException {
  final String clusterName="TestTagAwareness_testGetResources";
  final String TAG="tag";
  final String URL_BASE="http://localhost:" + ADMIN_PORT + "/clusters/"+ clusterName+ "/resourceGroups";
  _setupTool.addCluster(clusterName,true);
  HelixAdmin admin=_setupTool.getClusterManagementTool();
  IdealState taggedResource=new IdealState("taggedResource");
  taggedResource.setInstanceGroupTag(TAG);
  taggedResource.setStateModelDefRef("OnlineOffline");
  admin.addResource(clusterName,taggedResource.getId(),taggedResource);
  IdealState untaggedResource=new IdealState("untaggedResource");
  untaggedResource.setStateModelDefRef("OnlineOffline");
  admin.addResource(clusterName,untaggedResource.getId(),untaggedResource);
  Reference resourceRef=new Reference(URL_BASE);
  Request request=new Request(Method.GET,resourceRef);
  Response response=_gClient.handle(request);
  ZNRecord responseRecord=ClusterRepresentationUtil.JsonToObject(ZNRecord.class,response.getEntityAsText());
  Assert.assertNotNull(responseRecord.getMapField("ResourceTags"));
  Assert.assertEquals(TAG,responseRecord.getMapField("ResourceTags").get(taggedResource.getId()));
  Assert.assertFalse(responseRecord.getMapField("ResourceTags").containsKey(untaggedResource.getId()));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
