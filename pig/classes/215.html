<h3 style="margin:0px">Class: org.apache.pig.test.TestMergeJoin (29 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(21)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(21)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(2)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(2)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParallelism() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "';"+ "B = LOAD '"+ INPUT_FILE+ "';"+ "C = join A by $0, B by $0 using 'merge' parallel 50;"+ "store C into 'out';";
  PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
  pc.connect();
  MROperPlan mro=Util.buildMRPlan(Util.buildPp(pigServer,query),pc);
  Assert.assertEquals(1,mro.getRoots().get(0).getRequestedParallelism());
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmptyRightFile() throws IOException {
  DataBag dbmrj=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
  Util.createInputFile(cluster,"temp_file",new String[]{});
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD 'temp_file';");
  pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
  pigServer.openIterator("C");
{
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext())     dbmrj.add(iter.next());
  }
{
    pigServer.registerQuery("C = join A by $0, B by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbmrj.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbmrj,dbshj));
  Util.deleteFile(cluster,"temp_file");
}

</code></pre>

<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpressionFail() throws IOException {
  pigServer.registerQuery("A = LOAD 'leftinput' as (a:int);");
  pigServer.registerQuery("B = LOAD 'temp_file*' using " + DummyIndexableLoader.class.getName() + "() as (a:int);");
  boolean exceptionThrown=false;
  try {
    pigServer.registerQuery("C = join A by $0 + 10, B by $0 + 10 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
  }
 catch (  Exception e) {
    e.printStackTrace();
    PigException pe=LogUtils.getPigException(e);
    Assert.assertEquals(1106,pe.getErrorCode());
    exceptionThrown=true;
  }
  Assert.assertEquals(true,exceptionThrown);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinSch1() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  Schema mjSch=null, shjSch=null;
  pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
  mjSch=pigServer.dumpSchema("C");
  pigServer.registerQuery("C = join A by $0, B by $0;");
  shjSch=pigServer.dumpSchema("C");
  Assert.assertEquals(true,shjSch.equals(mjSch));
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinWithUDF() throws Exception {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (x:int,y:double);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:double);");
  pigServer.registerQuery("A = FOREACH A GENERATE x, ABS(y) AS y;");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = JOIN A BY x, B BY x USING 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = JOIN A BY x, B BY x;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinWithNulls() throws IOException {
  String[] input=new String[3 * 3];
  input[0]="\t2";
  input[1]="1\t2";
  input[2]="1\t2";
  input[3]="\t2";
  input[4]="3\t2";
  input[5]="\t";
  input[6]="5\t";
  input[7]="7\t";
  input[8]="7\t1";
  Util.createInputFile(cluster,"temp_file",input);
  pigServer.registerQuery("A = LOAD 'temp_file';");
  pigServer.registerQuery("B = LOAD 'temp_file';");
  DataBag dbmrj=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbmrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by $0, B by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Util.deleteFile(cluster,"temp_file");
  Assert.assertEquals(dbmrj.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbmrj,dbshj));
}

</code></pre>

<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMergeJoinSch2() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "';");
  Schema mjSch=null, shjSch=null;
  pigServer.registerQuery("C = join A by ($0,$1), B by ($0,$1) using 'merge';");
  mjSch=pigServer.dumpSchema("C");
  pigServer.registerQuery("C = join A by ($0,$1), B by ($0,$1);");
  shjSch=pigServer.dumpSchema("C");
  Assert.assertTrue(shjSch == null);
}

</code></pre>

<pre class="type-7 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoinFailure2() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, n);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name);");
  pigServer.registerQuery("C = GROUP B by id;");
  pigServer.registerQuery("D = join A by id, C by $0 using 'merge';");
  try {
    pigServer.openIterator("D");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertEquals(1103,pe.getErrorCode());
    return;
  }
  Assert.fail("Should fail to compile");
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinOutPipeline() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (f1:int,f2:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (f1:int,f2:int);");
  DataBag dbmrj=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
    pigServer.registerQuery("G = LOAD '" + INPUT_FILE + "' as (f1:int,f2:int);");
    pigServer.registerQuery("H = LOAD '" + INPUT_FILE + "' as (f1:int,f2:int);");
    pigServer.registerQuery("D = join G by $0, H by $0 using 'merge';");
    pigServer.registerQuery("E = union C,D;");
    pigServer.registerQuery("F = filter E by 1 == 1;");
    Iterator<Tuple> iter=pigServer.openIterator("F");
    while (iter.hasNext()) {
      dbmrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by $0, B by $0;");
    pigServer.registerQuery("D = join A by $0, B by $0;");
    pigServer.registerQuery("E = union C,D;");
    pigServer.registerQuery("F = filter E by 1 == 1;");
    Iterator<Tuple> iter=pigServer.openIterator("F");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbmrj.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbmrj,dbshj));
}

</code></pre>

<pre class="type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void oneTimeTearDown() throws Exception {
  cluster.shutDown();
}

</code></pre>

<pre class="type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
/** 
 * @throws java.lang.Exception
 */
@After public void tearDown() throws Exception {
  Util.deleteFile(cluster,INPUT_FILE);
  Util.deleteFile(cluster,INPUT_FILE2);
  Util.deleteFile(cluster,INPUT_FILE3);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinWithReplicatedJoin() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (f1:int,f2:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (f1:int,f2:int);");
  pigServer.registerQuery("C = LOAD '" + INPUT_FILE + "' as (f1:int,f2:int);");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("D = join A by f1, B by f1 using 'replicated';");
    pigServer.registerQuery("E = join D by A::f1, C by f1 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("D = join A by f1, B by f1 using 'replicated';");
    pigServer.registerQuery("E = join D by A::f1, C by f1;");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbshj.size(),dbMergeJoin.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
/** 
 * @throws java.lang.Exception
 */
@Before public void setUp() throws Exception {
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++)     input[k++]=si + "\t" + j;
  }
  Util.createInputFile(cluster,INPUT_FILE,input);
  Util.createInputFile(cluster,INPUT_FILE2,new String[]{"2"});
  String[] input3=new String[LOOP_SIZE];
  for (int i=0; i <= LOOP_SIZE - 1; i++) {
    input3[i]="(" + (i + 1) + ")\t + {";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input3[i]=input3[i] + "(" + j+ ")";
      if (j != LOOP_SIZE) {
        input3[i]=input3[i] + ",";
      }
    }
    input3[i]=input3[i] + "}";
  }
  Util.createInputFile(cluster,INPUT_FILE3,input3);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinOutWithProjects() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (f1,f2);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "'as (f1,f2);");
  pigServer.registerQuery("C = foreach A generate f1;");
  pigServer.registerQuery("D = foreach B generate f1;");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("E = join C by f1, D by f1 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("E = join C by f1, D by f1;");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinWithMRBoundaryLater() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
    pigServer.registerQuery("D = group C by $0;");
    pigServer.registerQuery("E = filter D by $0 > 0;");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by $0, B by $0;");
    pigServer.registerQuery("D = group C by $0 ;");
    pigServer.registerQuery("E = filter D by $0 > 0;");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRecursiveFileListing() throws IOException {
  Util.createInputFile(cluster,"foo/bar/test.dat",new String[]{"2"});
  pigServer.registerQuery("A = LOAD 'foo';");
  pigServer.registerQuery("B = LOAD 'foo';");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by $0, B by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
  Util.deleteFile(cluster,"foo/bar/test.dat");
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinEmptyIndex() throws IOException {
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE2 + "';");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "';");
{
    pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by $0, B by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeJoinWithOrderAndSplit() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "' as (id, name, n);\n"+ "B = LOAD '"+ INPUT_FILE+ "' as (id, name);\n"+ "C = ORDER A by $0 parallel 5;\n"+ "D = join A by id, C by id using 'merge';\n"+ "store D into '/dev/null/1';";
  Util.buildPp(pigServer,query);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinOutWithFilters() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("C = FILTER A by $1 > 1;");
  pigServer.registerQuery("D = FILTER B by $1 > 1;");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("E = join C by $0, D by $0 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("E = join C by $0, D by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIndexer() throws IOException {
  Util.createInputFile(cluster,"temp_file1",new String[]{1 + ""});
  Util.createInputFile(cluster,"temp_file2",new String[]{2 + ""});
  Util.createInputFile(cluster,"temp_file3",new String[]{10 + ""});
  pigServer.registerQuery("A = LOAD 'temp_file*' as (a:int);");
  pigServer.registerQuery("B = LOAD 'temp_file*' as (a:int);");
  DataBag dbmrj=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbmrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by $0, B by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Util.deleteFile(cluster,"temp_file1");
  Util.deleteFile(cluster,"temp_file2");
  Util.deleteFile(cluster,"temp_file3");
  Assert.assertEquals(dbmrj.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbmrj,dbshj));
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinOutWithSchema() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by $0, B by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeJoinWithOrder() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "' as (id, name, n);\n"+ "B = LOAD '"+ INPUT_FILE+ "' as (id, name);\n"+ "C = ORDER B by $0 parallel 5;\n"+ "D = join A by id, C by id using 'merge';\n"+ "store D into '/dev/null/1';";
  Util.buildPp(pigServer,query);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinWithForeachFlatten() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (f1:int,f2:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE3 + "' as (t:(f1:int), b:{(f1:int)});");
  pigServer.registerQuery("C = foreach B generate flatten(t) as f1:int, flatten(b);");
  pigServer.registerQuery("D = join C by f1, A by f1 using 'merge';");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("D = join C by f1, A by f1 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("D");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("D = join C by f1, A by f1;");
    Iterator<Tuple> iter=pigServer.openIterator("D");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbshj.size(),dbMergeJoin.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinOnMultiFields() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "';");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by ($0,$1), B by ($0,$1) using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by ($0,$1), B by ($0,$1);");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testMergeJoinWithCommaSeparatedFilePaths() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD 'temp_file,righinput_file' using " + DummyIndexableLoader.class.getName() + "();");
  pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinSimplest() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "';");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by $0, B by $0 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by $0, B by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpression() throws IOException {
  Util.createInputFile(cluster,"temp_file1",new String[]{"8","9"});
  Util.createInputFile(cluster,"temp_file2",new String[]{"10","11"});
  Util.createInputFile(cluster,"temp_file3",new String[]{"20"});
  Util.createInputFile(cluster,"leftinput",new String[]{"9","11"});
  pigServer.registerQuery("A = LOAD 'leftinput' as (a:int);");
  pigServer.registerQuery("B = LOAD 'temp_file*' as (a:int);");
  DataBag dbmrj=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by $0 + 10, B by $0 + 10 using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbmrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by $0 + 10, B by $0 + 10;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Util.deleteFile(cluster,"temp_file1");
  Util.deleteFile(cluster,"temp_file2");
  Util.deleteFile(cluster,"temp_file3");
  Util.deleteFile(cluster,"leftinput");
  Assert.assertEquals(dbmrj.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbmrj,dbshj));
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMergeJoinWithExpr() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "';");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "';");
  DataBag dbMergeJoin=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join A by ($0+10), B by ($0+10) using 'merge';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbMergeJoin.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join A by ($0+10), B by ($0+10);");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  Assert.assertEquals(dbMergeJoin.size(),dbshj.size());
  Assert.assertEquals(true,TestHelper.compareBags(dbMergeJoin,dbshj));
}

</code></pre>

<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoin3Way() throws IOException {
  try {
    pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, n);");
    pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name);");
    pigServer.registerQuery("C = LOAD '" + INPUT_FILE + "' as (id, name);");
    pigServer.registerQuery("D = join A by id, B by id, C by id using 'merge';");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertTrue(pe.getMessage().contains("Merge join can only be applied for 2-way joins"));
    return;
  }
  Assert.fail("Should throw exception, do not support 3 way join");
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
