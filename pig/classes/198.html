<h3 style="margin:0px">Class: org.apache.pig.test.TestLoad (17 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(13)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteAbs() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    boolean noConversionExpected=true;
    checkLoadPath("/tmp/test","/tmp/test",noConversionExpected);
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString2() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("t?s*,test","/tmp/t?s*,/tmp/test");
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("unchecked") @Test public void testCommaSeparatedString3() throws Exception {
  PigServer pig=servers[0];
  pc=pig.getPigContext();
  boolean noConversionExpected=true;
  checkLoadPath("hdfs:/tmp/test,hdfs:/tmp/test2,hdfs:/tmp/test3","hdfs:/tmp/test,hdfs:/tmp/test2,hdfs:/tmp/test3",noConversionExpected);
  String[] inputFileNames=new String[]{"/tmp/TestLoad-testCommaSeparatedString3-input1.txt","/tmp/TestLoad-testCommaSeparatedString3-input2.txt"};
  String inputString="hdfs:" + inputFileNames[0] + ",hdfs:"+ inputFileNames[1];
  testLoadingMultipleFiles(inputFileNames,inputString);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString5() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("/usr/pig/{a,c},usr/pig/b","/usr/pig/{a,c},/tmp/usr/pig/b");
  }
  String loadLocationString="/tmp/TestLoad-testCommaSeparatedStringMixed-input{1,2}.txt," + "TestLoad-testCommaSeparatedStringMixed-input3.txt";
  String[] inputFileNames=new String[]{"/tmp/TestLoad-testCommaSeparatedStringMixed-input1.txt","/tmp/TestLoad-testCommaSeparatedStringMixed-input2.txt","/tmp/TestLoad-testCommaSeparatedStringMixed-input3.txt"};
  pc=servers[0].getPigContext();
  testLoadingMultipleFiles(inputFileNames,loadLocationString);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString4() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("usr/pig/{a,c},usr/pig/b","/tmp/usr/pig/{a,c},/tmp/usr/pig/b");
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString6() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("usr/pig/{a,c},/usr/pig/b","/tmp/usr/pig/{a,c},/usr/pig/b");
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteAbsScheme() throws Exception {
  pc=servers[0].getPigContext();
  boolean noConversionExpected=true;
  checkLoadPath("hdfs:/tmp/test","hdfs:/tmp/test",noConversionExpected);
  String[] inputFileNames=new String[]{"/tmp/TestLoad-testLoadRemoteAbsSchema-input.txt"};
  testLoadingMultipleFiles(inputFileNames,"hdfs:" + inputFileNames[0]);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteRel() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("test","/tmp/test");
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGlobChars() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("t?s*","/tmp/t?s*");
  }
}

</code></pre>

<pre class="type-13 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetNextTuple() throws IOException {
  pc=servers[0].getPigContext();
  String curDir=System.getProperty("user.dir");
  String inpDir=curDir + File.separatorChar + "test/org/apache/pig/test/data/InputFiles/";
  Util.copyFromLocalToCluster(cluster,inpDir + "passwd","passwd");
  FileSpec inpFSpec=new FileSpec("passwd",new FuncSpec(PigStorage.class.getName(),new String[]{":"}));
  POLoad ld=GenPhyOp.topLoadOp();
  ld.setLFile(inpFSpec);
  ld.setPc(pc);
  DataBag inpDB=DefaultBagFactory.getInstance().newDefaultBag();
  BufferedReader br=new BufferedReader(new FileReader("test/org/apache/pig/test/data/InputFiles/passwd"));
  for (String line=br.readLine(); line != null; line=br.readLine()) {
    String[] flds=line.split(":",-1);
    Tuple t=new DefaultTuple();
    for (    String fld : flds) {
      t.append((fld.compareTo("") != 0 ? new DataByteArray(fld.getBytes()) : null));
    }
    inpDB.add(t);
  }
  Tuple t=null;
  int size=0;
  for (Result res=ld.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=ld.getNextTuple()) {
    assertEquals(true,TestHelper.bagContains(inpDB,(Tuple)res.result));
    ++size;
  }
  assertEquals(true,size == inpDB.size());
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommaSeparatedString() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("usr/pig/a,usr/pig/b","/tmp/usr/pig/a,/tmp/usr/pig/b");
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteRelScheme() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    checkLoadPath("test","/tmp/test");
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteAbsAuth() throws Exception {
  pc=servers[0].getPigContext();
  checkLoadPath(cluster.getFileSystem().getUri() + "/test","/test");
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp() throws Exception {
  FileLocalizer.deleteTempFiles();
  servers=new PigServer[]{new PigServer(cluster.getExecType(),cluster.getProperties()),new PigServer(Util.getLocalTestMode(),new Properties())};
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRemoteNormalize() throws Exception {
  for (  PigServer pig : servers) {
    pc=pig.getPigContext();
    boolean noConversionExpected=true;
    checkLoadPath("/tmp/foo/../././","/tmp/foo/.././.",noConversionExpected);
  }
}

</code></pre>

<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNonDfsLocation() throws Exception {
  String nonDfsUrl="har:///user/foo/f.har";
  String query="a = load '" + nonDfsUrl + "' using PigStorage('\t','-noschema');"+ "store a into 'output';";
  LogicalPlan lp=Util.buildLp(servers[1],query);
  LOLoad load=(LOLoad)lp.getSources().get(0);
  nonDfsUrl=nonDfsUrl.replaceFirst("/$","");
  assertEquals(nonDfsUrl,load.getFileSpec().getFileName());
}

</code></pre>

<pre class="type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void oneTimeTearDown() throws Exception {
  cluster.shutDown();
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
