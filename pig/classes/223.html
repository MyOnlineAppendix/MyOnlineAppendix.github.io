<h3 style="margin:0px">Class: org.apache.pig.test.TestMultiply (2 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp() throws Exception {
  lt=new ConstantExpression(new OperatorKey("",r.nextLong()));
  rt=new ConstantExpression(new OperatorKey("",r.nextLong()));
}

</code></pre>

<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Multiply operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 * inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 * inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 * inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 * inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
{
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
}
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
