<h3 style="margin:0px">Class: org.apache.pig.tez.TestTezJobControlCompiler (10 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="16"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('16')" data-toggle="tooltip" title="Verifies values related to public fields."><kbd id="tag-16"class="label-info"style="display: inline-block;font-size:7pt" >PublicFieldVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="17"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('17')" data-toggle="tooltip" title="Is an empty test case"><kbd id="tag-17"class="label-info"style="display: inline-block;font-size:7pt" >EmptyTester&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testTezParallelismDefaultParallelism() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  pc.defaultParallel=5;
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = group a by name;"+ "store b into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),5);
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezParallelismEstimatorFilterFlatten() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = filter a by age>20;"+ "c = group b by name;"+ "d = foreach c generate group, flatten(b.gpa);"+ "e = group d by group;"+ "store e into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  assertTrue(leafOper.isUseGraceParallelism());
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),-1);
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezParallelismEstimatorSplitBranch() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = filter a by age>20;"+ "c = filter a by age>50;"+ "store b into 'o1';"+ "d = group c by name;"+ "store d into 'o2';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  Collections.sort(leaves);
  TezOperator leafOper=leaves.get(1);
  assertTrue(leafOper.isUseGraceParallelism());
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),-1);
}

</code></pre>

<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testTezParallelismEstimatorHashJoin() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = load '5' using "+ ArbitarySplitsLoader.class.getName()+ "() as (name:chararray, course:chararray);"+ "c = join a by name, b by name;"+ "store c into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),15);
}

</code></pre>

<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun2() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = group a by x;"+ "c = foreach b generate group, a;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(1,root.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(1,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root.getOutputVertices().get(0),leaf);
  assertEquals(root,leaf.getInputVertices().get(0));
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp() throws ExecException {
  pc=new PigContext(new TezLocalExecType(),new Properties());
  pigServer=new PigServer(pc);
}

</code></pre>

<pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun3() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = load '"+ input2+ "' as (x:int, z:int);"+ "c = join a by x, b by x;"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(2,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root0=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  Vertex root1=compiledPlan.second.getVertex(roots.get(1).getOperatorKey().toString());
  assertNotNull(root0);
  assertNotNull(root1);
  assertEquals(0,root0.getInputVertices().size());
  assertEquals(1,root1.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(2,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root0.getOutputVertices().get(0),leaf);
  assertEquals(root1.getOutputVertices().get(0),leaf);
  assertTrue(leaf.getInputVertices().contains(root0));
  assertTrue(leaf.getInputVertices().contains(root1));
}

</code></pre>

<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun1() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = filter a by x > 0;"+ "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(0,root.getOutputVertices().size());
}

</code></pre>

<pre class="type-14 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Is an empty test case
"></span><br>
@AfterClass public static void tearDownAfterClass() throws Exception {
}

</code></pre>

<pre class="type-7 type-6 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testTezParallelismEstimatorOrderBy() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '2' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = group a by name parallel 3;"+ "c = foreach b generate group as name, AVG(a.age) as age;"+ "d = order c by age;"+ "store d into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator sortOper=compiledPlan.first.getLeaves().get(0);
  Vertex sortVertex=compiledPlan.second.getVertex(sortOper.getOperatorKey().toString());
  assertEquals(sortVertex.getParallelism(),-1);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
