<h3 style="margin:0px">Class: org.apache.pig.test.TestPigRunner (33 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(31)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(28)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(26)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(19)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(18)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(15)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="20"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('20')" data-toggle="tooltip" title="Sets implicit assumptions "><kbd id="tag-20"class="label-info"style="display: inline-block;font-size:7pt" >AssumptionSetter&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleTest2() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 == 3;");
  w.println("C = limit B 1;");
  w.println("dump C;");
  w.close();
  try {
    String[] args={"-Dstop.on.failure=true","-Dopt.multiquery=false","-Daggregate.warning=false","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (execType.toString().startsWith("tez")) {
      assertEquals(1,stats.getNumberJobs());
      assertEquals(stats.getJobGraph().size(),1);
    }
 else {
      assertEquals(2,stats.getNumberJobs());
      assertEquals(stats.getJobGraph().size(),2);
    }
    Configuration conf=ConfigurationUtil.toConfiguration(stats.getPigProperties());
    assertTrue(conf.getBoolean("stop.on.failure",false));
    assertTrue(!conf.getBoolean("aggregate.warning",true));
    assertTrue(!conf.getBoolean(PigConfiguration.PIG_OPT_MULTIQUERY,true));
    assertTrue(conf.getBoolean("opt.fetch",true));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void simpleNegativeTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = group A by a;");
  w.println("C = foreach B generate group, COUNT(A);");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  String[] args={"-x",execType,"-c",PIG_FILE};
  PigStats stats=PigRunner.run(args,null);
  assertTrue(stats.getReturnCode() == ReturnCode.PIG_EXCEPTION);
}

</code></pre>

<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void returnCodeTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load 'non-existine.file' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 > 0;;");
  w.println("C = group B by $0;");
  w.println("D = join C by $0, B by $0;");
  w.println("store D into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    assertTrue(stats.getReturnCode() != 0);
    assertTrue(stats.getOutputStats().size() == 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisablePigCounters2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 > 3;");
  w1.println("store A into 'output';");
  w1.println("store B into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-Dpig.disable.counter=true","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    if (execType.equals("tez")) {
      assertEquals(outputs.get(0).getNumberRecords(),5);
      assertEquals(outputs.get(1).getNumberRecords(),2);
    }
 else {
      for (      OutputStats outstats : outputs) {
        assertEquals(-1,outstats.getNumberRecords());
      }
    }
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(1,inputs.size());
    InputStats instats=inputs.get(0);
    assertEquals(5,instats.getNumberRecords());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFileCounter2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 < 0;");
  w1.println("store A into '" + OUTPUT_FILE + "';");
  w1.println("store B into 'output2';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    for (    OutputStats outstats : outputs) {
      if (outstats.getLocation().endsWith("output2")) {
        assertEquals(0,outstats.getNumberRecords());
      }
 else {
        assertEquals(5,outstats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"output2");
  }
}

</code></pre>

<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void fsCommandTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("fs -mv nonexist.file dummy.file");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(!stats.isSuccessful());
    assertTrue(stats.getReturnCode() == PigRunner.ReturnCode.IO_EXCEPTION);
  }
  finally {
    new File(PIG_FILE).delete();
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void streamNegativeTest() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ temporarily as it hangs",Util.isMapredExecType(cluster.getExecType()));
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = foreach A generate 1;");
  w.println("C = foreach A generate 0/0;");
  w.println("store B into '" + OUTPUT_FILE + "';");
  w.println("store C into '" + OUTPUT_FILE_2 + "';");
  w.println("D = load '" + OUTPUT_FILE_2 + "';");
  w.println("E = stream D through `false`;");
  w.println("store E into 'ee';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    if (execType.equals("tez")) {
      assertTrue(stats.getReturnCode() == ReturnCode.FAILURE);
      assertTrue(stats.getJobGraph().size() == 1);
      JobStats job=(JobStats)stats.getJobGraph().getSinks().get(0);
      assertTrue(!job.isSuccessful());
      assertTrue(stats.getOutputStats().size() == 3);
      for (      OutputStats output : stats.getOutputStats()) {
        assertTrue(!output.isSuccessful());
      }
    }
 else {
      assertTrue(stats.getReturnCode() == ReturnCode.PARTIAL_FAILURE);
      assertTrue(stats.getJobGraph().size() == 2);
      JobStats job=(JobStats)stats.getJobGraph().getSources().get(0);
      assertTrue(job.isSuccessful());
      job=(JobStats)stats.getJobGraph().getSinks().get(0);
      assertTrue(!job.isSuccessful());
      assertTrue(stats.getOutputStats().size() == 3);
      for (      OutputStats output : stats.getOutputStats()) {
        if (output.getName().equals("ee")) {
          assertTrue(!output.isSuccessful());
        }
 else {
          assertTrue(output.isSuccessful());
        }
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<pre class="type-7 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCounterName() throws Exception {
  String s="jdbc:hsqldb:file:/tmp/batchtest;hsqldb.default_table_type=cached;hsqldb.cache_rows=100";
  String name=MRPigStatsUtil.getMultiInputsCounterName(s,0);
  assertEquals(MRPigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "_0_batchtest",name);
  s="file:///tmp/batchtest{1,2}.txt";
  name=MRPigStatsUtil.getMultiInputsCounterName(s,1);
  assertEquals(MRPigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "_1_batchtest{1,2}.txt",name);
  s="file:///tmp/batchtest*.txt";
  name=MRPigStatsUtil.getMultiInputsCounterName(s,2);
  assertEquals(MRPigStatsUtil.MULTI_INPUTS_RECORD_COUNTER + "_2_batchtest*.txt",name);
}

</code></pre>

<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testErrorLogFile() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = foreach A generate StringSize(a0);");
  w.println("store B into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x","local",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    Properties props=stats.getPigProperties();
    String logfile=props.getProperty("pig.logfile");
    File f=new File(logfile);
    assertTrue(f.exists());
  }
  finally {
    new File(PIG_FILE).delete();
  }
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = group A by a0;");
  w.println("C = foreach B generate group, COUNT(A);");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-Dstop.on.failure=true","-Dopt.multiquery=false","-Dopt.fetch=false","-Daggregate.warning=false","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    String name=stats.getOutputNames().get(0);
    assertEquals(OUTPUT_FILE,name);
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
    Configuration conf=ConfigurationUtil.toConfiguration(stats.getPigProperties());
    assertTrue(conf.getBoolean("stop.on.failure",false));
    assertTrue(!conf.getBoolean("aggregate.warning",true));
    assertTrue(!conf.getBoolean(PigConfiguration.PIG_OPT_MULTIQUERY,true));
    assertTrue(!conf.getBoolean("opt.fetch",true));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertTrue(stats.getJobGraph().size() == 1);
    final int numOfRecords=5;
    final int numOfCharsPerRecord=6;
    assertEquals(numOfRecords,stats.getRecordWritten());
    assertEquals(numOfRecords * numOfCharsPerRecord,stats.getBytesWritten());
    assertTrue(stats.getOutputNames().size() == 2);
    for (    String fname : stats.getOutputNames()) {
      assertTrue(fname.equals(OUTPUT_FILE) || fname.equals(OUTPUT_FILE_2));
      if (fname.equals(OUTPUT_FILE)) {
        assertEquals(3,stats.getNumberRecords(fname));
      }
 else {
        assertEquals(2,stats.getNumberRecords(fname));
      }
    }
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFileCounter() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.close();
  Util.copyFromLocalToCluster(cluster,"myinputfile","1.txt");
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '1.txt' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      if (instats.getLocation().endsWith("1.txt")) {
        assertEquals(0,instats.getNumberRecords());
      }
 else {
        assertEquals(5,instats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisablePigCounters() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-Dpig.disable.counter=true","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    if (execType.equals("tez")) {
      assertEquals(5,inputs.get(0).getNumberRecords());
      assertEquals(5,inputs.get(1).getNumberRecords());
    }
 else {
      for (      InputStats instats : inputs) {
        assertEquals(-1,instats.getNumberRecords());
      }
    }
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(1,outputs.size());
    OutputStats outstats=outputs.get(0);
    assertEquals(9,outstats.getNumberRecords());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void classLoaderTest() throws Exception {
  if (org.apache.pig.impl.util.Utils.isHadoop23() || org.apache.pig.impl.util.Utils.isHadoop2())   return;
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("register test/org/apache/pig/test/data/pigtestloader.jar");
  w.println("A = load '" + INPUT_FILE + "' using org.apache.pig.test.PigTestLoader();");
  w.println("store A into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp(){
  deleteAll(new File(OUTPUT_FILE));
  Util.resetStateForExecModeSwitch();
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongCounterName() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.println("1\t2\t3");
  w.println("5\t3\t4");
  w.println("3\t4\t5");
  w.println("5\t6\t7");
  w.println("3\t7\t8");
  w.close();
  String longfilename="longlonglonglonglonglonglonglonglonglonglonglongfilefilefilename";
  Util.copyFromLocalToCluster(cluster,"myinputfile",longfilename);
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + longfilename + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      assertEquals(5,instats.getNumberRecords());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-13 type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void MQDepJobFailedTest() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (name:chararray, a1:int, a2:int);");
  w.println("store A into '" + OUTPUT_FILE_2 + "';");
  w.println("B = FOREACH A GENERATE org.apache.pig.test.utils.UPPER(name);");
  w.println("C= order B by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    Iterator<JobStats> iter=stats.getJobGraph().iterator();
    while (iter.hasNext()) {
      JobStats js=iter.next();
      if (execType.equals("tez")) {
        assertEquals(js.getState().name(),"FAILED");
      }
 else {
        if (js.getState().name().equals("FAILED")) {
          List<Operator> ops=stats.getJobGraph().getSuccessors(js);
          for (          Operator op : ops) {
            assertEquals(((JobStats)op).getState().toString(),"UNKNOWN");
          }
        }
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void returnCodeTest2() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load 'non-existine.file' as (a0, a1);");
  w.println("B = load 'data' as (b0, b1);");
  w.println("C = join B by b0, A by a0 using 'repl';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    assertTrue(stats.getReturnCode() != 0);
    assertTrue(stats.getOutputStats().size() == 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * PIG-2780: In this test case, Pig submits three jobs at the same time and
 * one of them will fail due to nonexistent input file. If users enable
 * stop.on.failure, then Pig should immediately stop if anyone of the three
 * jobs has failed.
 */
@Test public void testStopOnFailure() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A1 = load '" + INPUT_FILE + "';");
  w1.println("B1 = load 'nonexist';");
  w1.println("C1 = load '" + INPUT_FILE + "';");
  w1.println("A2 = distinct A1;");
  w1.println("B2 = distinct B1;");
  w1.println("C2 = distinct C1;");
  w1.println("ret = union A2,B2,C2;");
  w1.println("store ret into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-x",execType,"-F",PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(!stats.isSuccessful());
    int successfulJobs=0;
    Iterator<Operator> it=stats.getJobGraph().getOperators();
    while (it.hasNext()) {
      JobStats js=(JobStats)it.next();
      if (js.isSuccessful())       successfulJobs++;
    }
    assertTrue("Should have less than 2 successful jobs",successfulJobs < 2);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testErrorLogFile2() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = foreach A generate StringSize(a0);");
  w.println("store B into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-M","-x","local",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    Properties props=stats.getPigProperties();
    if (props != null) {
      String logfile=props.getProperty("pig.logfile");
      File f=new File(logfile);
      assertTrue(f.exists());
    }
  }
  finally {
    new File(PIG_FILE).delete();
  }
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void scriptsInDfsTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = group A by a0;");
  w.println("C = foreach B generate group, COUNT(A);");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  Util.copyFromLocalToCluster(cluster,PIG_FILE,PIG_FILE);
  Path inputInDfs=new Path(cluster.getFileSystem().getHomeDirectory(),PIG_FILE);
  try {
    String[] args={"-x",execType,inputInDfs.toString()};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertTrue(stats.getJobGraph().size() == 1);
    String name=stats.getOutputNames().get(0);
    assertEquals(OUTPUT_FILE,name);
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,PIG_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetHadoopCounters() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("D = group C by a0;");
  w.println("E = foreach D generate group, COUNT(C);");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store E into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    String TASK_COUNTER_GROUP=execType.equals("tez") ? "org.apache.tez.common.counters.TaskCounter" : MRPigStatsUtil.TASK_COUNTER_GROUP;
    String FS_COUNTER_GROUP=execType.equals("tez") ? "org.apache.tez.common.counters.FileSystemCounter" : MRPigStatsUtil.FS_COUNTER_GROUP;
    if (execType.equals("tez")) {
      Counters counter=((JobStats)stats.getJobGraph().getSinks().get(0)).getHadoopCounters();
      assertEquals(5,counter.getGroup(TASK_COUNTER_GROUP).getCounterForName("INPUT_RECORDS_PROCESSED").getValue());
      assertEquals(2,counter.getGroup(TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.REDUCE_INPUT_RECORDS).getValue());
      assertEquals(7,counter.getGroup(TASK_COUNTER_GROUP).getCounterForName("OUTPUT_RECORDS").getValue());
      assertEquals(20,counter.getGroup(FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_WRITTEN).getValue());
      assertEquals(new File(INPUT_FILE).length(),counter.getGroup(FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_READ).getValue());
    }
 else {
      Counters counter=((MRJobStats)stats.getJobGraph().getSinks().get(0)).getHadoopCounters();
      assertEquals(5,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.MAP_INPUT_RECORDS).getValue());
      assertEquals(3,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.MAP_OUTPUT_RECORDS).getValue());
      assertEquals(2,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.REDUCE_INPUT_RECORDS).getValue());
      assertEquals(0,counter.getGroup(MRPigStatsUtil.TASK_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.REDUCE_OUTPUT_RECORDS).getValue());
      assertEquals(20,counter.getGroup(MRPigStatsUtil.FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_WRITTEN).getValue());
      if (Util.isHadoop203plus())       return;
      assertEquals(30,counter.getGroup(MRPigStatsUtil.FS_COUNTER_GROUP).getCounterForName(MRPigStatsUtil.HDFS_BYTES_READ).getValue());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFile() throws IOException {
  File f1=new File(PIG_FILE);
  FileWriter fw1=new FileWriter(f1);
  fw1.close();
  try {
    String[] args={"-x","local","-c",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    assertEquals(0,stats.getReturnCode());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest3() throws Exception {
  final String INPUT_FILE_2="input2";
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE_2));
  w.println("3\t4\t5");
  w.println("5\t6\t7");
  w.println("3\t7\t8");
  w.close();
  Util.copyFromLocalToCluster(cluster,INPUT_FILE_2,INPUT_FILE_2);
  new File(INPUT_FILE_2).delete();
  w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("A1 = load '" + INPUT_FILE_2 + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 == 3;");
  w.println("C = filter A by a1 <=5;");
  w.println("D = join C by a0, B by a0, A1 by a0 using 'replicated';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.println("store D into '" + OUTPUT_FILE_2 + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (Util.isMapredExecType(cluster.getExecType())) {
      assertEquals(3,stats.getJobGraph().size());
    }
 else {
      assertEquals(1,stats.getJobGraph().size());
    }
    final int numOfRecords1=3;
    final int numOfRecords2=4;
    final int numOfBytesWritten1=18;
    final int numOfBytesWritten2=72;
    assertEquals(numOfRecords1 + numOfRecords2,stats.getRecordWritten());
    assertEquals(numOfBytesWritten1 + numOfBytesWritten2,stats.getBytesWritten());
    List<String> outputNames=new ArrayList<String>(stats.getOutputNames());
    assertTrue(outputNames.size() == 2);
    Collections.sort(outputNames);
    assertEquals(OUTPUT_FILE,outputNames.get(0));
    assertEquals(OUTPUT_FILE_2,outputNames.get(1));
    assertEquals(3,stats.getNumberRecords(OUTPUT_FILE));
    assertEquals(4,stats.getNumberRecords(OUTPUT_FILE_2));
    List<InputStats> inputStats=new ArrayList<InputStats>(stats.getInputStats());
    assertTrue(inputStats.size() == 2);
    Collections.sort(inputStats,new Comparator<InputStats>(){
      @Override public int compare(      InputStats o1,      InputStats o2){
        return o1.getLocation().compareTo(o2.getLocation());
      }
    }
);
    assertEquals(5,inputStats.get(0).getNumberRecords());
    assertEquals(3,inputStats.get(1).getNumberRecords());
    if (!Util.isMapredExecType(cluster.getExecType())) {
      assertEquals(30,inputStats.get(0).getBytes());
      assertEquals(18,inputStats.get(1).getBytes());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,INPUT_FILE_2);
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest2() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("D = group C by a0;");
  w.println("E = foreach D generate group, COUNT(C);");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store E into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(stats.getJobGraph().size(),1);
    final int numOfRecords1=2;
    final int numOfRecords2=2;
    final int numOfCharsPerRecord1=6;
    final int numOfCharsPerRecord2=4;
    assertEquals(numOfRecords1 + numOfRecords2,stats.getRecordWritten());
    assertEquals((numOfRecords1 * numOfCharsPerRecord1) + (numOfRecords2 * numOfCharsPerRecord2),stats.getBytesWritten());
    assertTrue(stats.getOutputNames().size() == 2);
    for (    String fname : stats.getOutputNames()) {
      assertTrue(fname.equals(OUTPUT_FILE) || fname.equals(OUTPUT_FILE_2));
      if (fname.equals(OUTPUT_FILE)) {
        assertEquals(2,stats.getNumberRecords(fname));
      }
 else {
        assertEquals(2,stats.getNumberRecords(fname));
      }
    }
    assertEquals("A,B,C,D,E",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleNegativeTest3() throws Exception {
  String[] args={"-x",execType,"-c","-y"};
  PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
  assertTrue(stats.getReturnCode() == ReturnCode.PARSE_EXCEPTION);
  assertEquals("Found unknown option (-y) at position 4",stats.getErrorMessage());
}

</code></pre>

<pre class="type-13 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsTempFile() throws Exception {
  PigContext context=new PigContext(Util.getLocalTestMode(),new Properties());
  context.connect();
  for (int i=0; i < 100; i++) {
    String file=FileLocalizer.getTemporaryPath(context).toString();
    assertTrue("not a temp file: " + file,PigStatsUtil.isTempFile(file));
  }
}

</code></pre>

<pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterExternalJar() throws Exception {
  String jarName=Util.findPigJarName();
  String[] args={"-Dpig.additional.jars=" + jarName,"-Dmapred.job.queue.name=default","-x",execType,"-e","A = load '" + INPUT_FILE + "';store A into '"+ OUTPUT_FILE+ "';\n"};
  PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
  Util.deleteFile(cluster,OUTPUT_FILE);
  PigContext ctx=stats.getPigContext();
  assertNotNull(ctx);
  assertTrue(ctx.extraJars.contains(ClassLoader.getSystemResource(jarName)));
  assertTrue("default",ctx.getProperties().getProperty(MRConfiguration.JOB_QUEUE_NAME) != null && ctx.getProperties().getProperty(MRConfiguration.JOB_QUEUE_NAME).equals("default") || ctx.getProperties().getProperty("mapreduce.job.queuename") != null && ctx.getProperties().getProperty("mapreduce.job.queuename").equals("default"));
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCounterName2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 > 3;");
  w1.println("store A into 'output';");
  w1.println("store B into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    for (    OutputStats outstats : outputs) {
      if (outstats.getLocation().endsWith("tmp/output")) {
        assertEquals(2,outstats.getNumberRecords());
      }
 else {
        assertEquals(5,outstats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void orderByTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = order A by a0;");
  w.println("C = limit B 2;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  String[] args={"-x",execType,PIG_FILE};
  try {
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (execType.equals("tez")) {
      assertEquals(stats.getJobGraph().size(),1);
      assertEquals(stats.getJobGraph().getSources().get(0).getPlan().size(),5);
    }
 else {
      assertEquals(stats.getJobGraph().size(),4);
    }
    assertTrue(stats.getJobGraph().getSinks().size() == 1);
    assertTrue(stats.getJobGraph().getSources().size() == 1);
    JobStats js=(JobStats)stats.getJobGraph().getSinks().get(0);
    assertEquals(OUTPUT_FILE,js.getOutputs().get(0).getName());
    assertEquals(2,js.getOutputs().get(0).getNumberRecords());
    assertEquals(12,js.getOutputs().get(0).getBytes());
    assertEquals(OUTPUT_FILE,stats.getOutputNames().get(0));
    assertEquals(2,stats.getRecordWritten());
    assertEquals(12,stats.getBytesWritten());
    if (execType.equals("tez")) {
      assertEquals("A,B",((JobStats)stats.getJobGraph().getSources().get(0)).getAlias());
    }
 else {
      assertEquals("A",((JobStats)stats.getJobGraph().getSources().get(0)).getAlias());
      assertEquals("B",((JobStats)stats.getJobGraph().getPredecessors(js).get(0)).getAlias());
      assertEquals("B",js.getAlias());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void simpleNegativeTest2() throws Exception {
  String[] args={"-x",execType,"-c","-e","this is a test"};
  PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
  assertTrue(stats.getReturnCode() == ReturnCode.ILLEGAL_ARGS);
}

</code></pre>

<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCounterName() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.println("1\t2\t3");
  w.println("5\t3\t4");
  w.close();
  String samefilename="tmp/input";
  Util.copyFromLocalToCluster(cluster,"myinputfile",samefilename);
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + samefilename + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      if (instats.getLocation().endsWith("tmp/input")) {
        assertEquals(2,instats.getNumberRecords());
      }
 else {
        assertEquals(5,instats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<pre class="type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void tearDownAfterClass() throws Exception {
  new File(INPUT_FILE).delete();
  cluster.shutDown();
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
