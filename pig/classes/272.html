<h3 style="margin:0px">Class: org.apache.pig.test.TestPigServer (34 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(19)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(3)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(2)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Jar file to register is not present in the system resources
 * in this case name of jar file is relative to current working dir
 */
@Test public void testRegisterJarLocalDir() throws Throwable {
  String dir1="test1_register_jar_local";
  String dir2="test2_register_jar_local";
  String jarLocation=dir1 + FILE_SEPARATOR + dir2+ FILE_SEPARATOR;
  String jarName="TestRegisterJarLocal.jar";
  createFakeJarFile(jarLocation,jarName);
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  verifyStringContained(pig.getPigContext().extraJars,jarName,false);
  pig.registerJar(jarLocation + jarName);
  verifyStringContained(pig.getPigContext().extraJars,jarName,true);
  assertTrue((new File(jarLocation + jarName)).delete());
  (new File(dir1 + FILE_SEPARATOR + dir2)).delete();
  (new File(dir1)).delete();
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeJoin() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = load 'b' as (field4, field5: double, field6: chararray );");
  pig.registerQuery("c = join a by field1, b by field4;");
  Schema dumpedSchema=pig.dumpSchema("c");
  Schema expectedSchema=Utils.getSchemaFromString("a::field1: int,a::field2: float,a::field3: chararray,b::field4: bytearray,b::field5: double,b::field6: chararray");
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultPigProperties() throws Throwable {
  PigServer pigServer=new PigServer(cluster.getExecType());
  Properties properties=pigServer.getPigContext().getProperties();
  assertEquals("999",properties.getProperty("pig.exec.reducers.max"));
  assertEquals("true",properties.getProperty("aggregate.warning"));
  assertEquals("true",properties.getProperty(PigConfiguration.PIG_OPT_MULTIQUERY));
  assertEquals("false",properties.getProperty("stop.on.failure"));
  File propertyFile=new File(tempDir,"pig.properties");
  properties=PropertiesUtil.loadDefaultProperties();
  assertEquals("999",properties.getProperty("pig.exec.reducers.max"));
  assertEquals("true",properties.getProperty("aggregate.warning"));
  assertEquals("true",properties.getProperty(PigConfiguration.PIG_OPT_MULTIQUERY));
  assertEquals("false",properties.getProperty("stop.on.failure"));
  PrintWriter out=new PrintWriter(new FileWriter(propertyFile));
  out.println("aggregate.warning=false");
  out.println("opt.multiquery=false");
  out.println("stop.on.failure=true");
  out.close();
  properties=PropertiesUtil.loadDefaultProperties();
  assertEquals("false",properties.getProperty("aggregate.warning"));
  assertEquals("false",properties.getProperty(PigConfiguration.PIG_OPT_MULTIQUERY));
  assertEquals("true",properties.getProperty("stop.on.failure"));
  propertyFile.delete();
}

</code></pre>

<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUniquePigTempDir() throws Throwable {
  Properties properties=PropertiesUtil.loadDefaultProperties();
  File pigTempDir=new File(tempDir,FILE_SEPARATOR + "tmp" + FILE_SEPARATOR+ "test");
  properties.put("pig.temp.dir",pigTempDir.getPath());
  PigContext pigContext=new PigContext(ExecType.LOCAL,properties);
  pigContext.connect();
  FileLocalizer.setInitialized(false);
  Random r=new Random(5);
  FileLocalizer.setR(r);
  String tempPath1=FileLocalizer.getTemporaryPath(pigContext).toString();
  FileLocalizer.setInitialized(false);
  r=new Random(5);
  FileLocalizer.setR(r);
  String tempPath2=FileLocalizer.getTemporaryPath(pigContext).toString();
  assertFalse(tempPath1.toString().equals(tempPath2.toString()));
  pigTempDir.delete();
  FileLocalizer.setInitialized(false);
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * The jar file to register is not present
 */
@Test public void testRegisterJarFileNotPresent() throws Throwable {
  String jarName="BadFileNameTestJarNotPresent.jar";
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  verifyStringContained(pig.getPigContext().extraJars,jarName,false);
  boolean raisedException=false;
  try {
    pig.registerJar(jarName);
  }
 catch (  IOException e) {
    raisedException=true;
  }
  assertTrue("registerJar on jarName [" + jarName + "] should have raised an exception",raisedException);
  verifyStringContained(pig.getPigContext().extraJars,jarName,false);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeCogroup() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = load 'b' as (field4, field5: double, field6: chararray );");
  pig.registerQuery("c = cogroup a by field1, b by field4;");
  Schema dumpedSchema=pig.dumpSchema("c");
  Schema expectedSchema=Utils.getSchemaFromString("group:int,a:{(field1:int,field2:float,field3:chararray)},b:{(field4:bytearray,field5:double,field6:chararray)}");
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDescribeForEachFlatten() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a';");
  pig.registerQuery("b = group a by $0;");
  pig.registerQuery("c = foreach b generate flatten(a);");
  Schema s=pig.dumpSchema("c");
  assertNull(s);
}

</code></pre>

<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescribeForeachFail() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = foreach a generate field1 + 10;");
  try {
    pig.dumpSchema("c");
    fail("Error expected");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Unable to describe schema for alias c"));
  }
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeSort() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = order a by * desc;");
  Schema dumpedSchema=pig.dumpSchema("b");
  Schema expectedSchema=Utils.getSchemaFromString("field1: int,field2: float,field3: chararray");
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRegisterJarRemoteScript() throws Throwable {
  if (Util.WINDOWS) {
    properties.setProperty("pig.jars.relative.to.dfs","true");
    String jarName=JarManager.findContainingJar(org.codehaus.jackson.JsonParser.class);
    PigServer pig=new PigServer(cluster.getExecType(),properties);
    pig.registerJar(jarName);
  }
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigTempDir() throws Throwable {
  Properties properties=PropertiesUtil.loadDefaultProperties();
  File pigTempDir=new File(tempDir,FILE_SEPARATOR + "tmp" + FILE_SEPARATOR+ "test");
  properties.put("pig.temp.dir",pigTempDir.getPath());
  PigContext pigContext=new PigContext(ExecType.LOCAL,properties);
  pigContext.connect();
  FileLocalizer.setInitialized(false);
  String tempPath=FileLocalizer.getTemporaryPath(pigContext).toString();
  Path path=new Path(tempPath);
  assertTrue(tempPath.startsWith(pigTempDir.toURI().toString()));
  FileSystem fs=FileSystem.get(path.toUri(),ConfigurationUtil.toConfiguration(pigContext.getProperties()));
  FileStatus status=fs.getFileStatus(path.getParent());
  assertEquals("rwx------",status.getPermission().toString());
  pigTempDir.delete();
  FileLocalizer.setInitialized(false);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeComplex() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (site: chararray, count: int, itemCounts: bag { itemCountsTuple: tuple (type: chararray, typeCount: int, f: float, m: map[]) } ) ;");
  pig.registerQuery("b = foreach a generate site, count, FLATTEN(itemCounts);");
  Schema dumpedSchema=pig.dumpSchema("b");
  Schema expectedSchema=Utils.getSchemaFromString("site: chararray,count: int," + "itemCounts::type: chararray,itemCounts::typeCount: int," + "itemCounts::f: float,itemCounts::m: map[ ]");
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterRemoteScript() throws Throwable {
  String scriptName="script.py";
  File scriptFile=File.createTempFile("tmp","");
  PrintWriter pw=new PrintWriter(new FileWriter(scriptFile));
  pw.println("@outputSchema(\"word:chararray\")\ndef helloworld():\n    return 'Hello, World'");
  pw.close();
  FileSystem fs=cluster.getFileSystem();
  fs.copyFromLocalFile(new Path(scriptFile.getAbsolutePath()),new Path(scriptName));
  String absPath=fs.getFileStatus(new Path(scriptName)).getPath().toString();
  Util.createInputFile(cluster,"testRegisterRemoteScript_input",new String[]{"1","2"});
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerCode(absPath,"jython","pig");
  pig.registerQuery("a = load 'testRegisterRemoteScript_input';");
  pig.registerQuery("b = foreach a generate pig.helloworld($0);");
  Iterator<Tuple> iter=pig.openIterator("b");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertTrue(t.size() > 0);
  assertEquals("Hello, World",t.get(0));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertTrue(t.size() > 0);
  assertEquals("Hello, World",t.get(0));
  assertFalse(iter.hasNext());
}

</code></pre>

<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRegisterRemoteGlobbingJar() throws Throwable {
  String dir="test1_register_remote_jar_globbing";
  String jarLocation=dir + FILE_SEPARATOR;
  String jar1Name="TestRegisterRemoteJarGlobbing1.jar";
  String jar2Name="TestRegisterRemoteJarGlobbing2.jar";
  FileSystem fs=cluster.getFileSystem();
  createFakeJarFile(jarLocation,jar1Name,fs);
  createFakeJarFile(jarLocation,jar2Name,fs);
  String absPath=fs.getFileStatus(new Path(jarLocation)).getPath().toString();
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerJar(absPath + FILE_SEPARATOR + "TestRegister{Remote}Jar*.jar");
  verifyStringContained(pig.getPigContext().extraJars,jar1Name,true);
  verifyStringContained(pig.getPigContext().extraJars,jar2Name,true);
  assertTrue(fs.delete(new Path(jarLocation),true));
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Jar file is located via system resources
 * Test verifies that even with multiple resources matching,
 * only one of them is registered.
 */
@Test public void testRegisterJarFromResources() throws Throwable {
  String dir="test_register_jar_res_dir";
  String subDir1="test_register_jar_res_sub_dir1";
  String subDir2="test_register_jar_res_sub_dir2";
  String jarName="TestRegisterJarFromRes.jar";
  String jarLocation1=dir + FILE_SEPARATOR + subDir1+ FILE_SEPARATOR;
  String jarLocation2=dir + FILE_SEPARATOR + subDir2+ FILE_SEPARATOR;
  createFakeJarFile(jarLocation1,jarName);
  createFakeJarFile(jarLocation2,jarName);
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  verifyStringContained(pig.getPigContext().extraJars,jarName,false);
  registerNewResource(jarLocation1);
  registerNewResource(jarLocation2);
  pig.registerJar(jarName);
  verifyStringContained(pig.getPigContext().extraJars,jarName,true);
  assertTrue((new File(jarLocation1 + jarName)).delete());
  assertTrue((new File(jarLocation2 + jarName)).delete());
  (new File(jarLocation1)).delete();
  (new File(jarLocation2)).delete();
  (new File(dir)).delete();
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeLimit() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = limit a 10;");
  Schema dumpedSchema=pig.dumpSchema("b");
  Schema expectedSchema=Utils.getSchemaFromString("field1: int,field2: float,field3: chararray");
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<pre class="type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void oneTimeTearDown() throws Exception {
  cluster.shutDown();
}

</code></pre>

<pre class="type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After public void tearDown() throws Exception {
  tempDir.delete();
}

</code></pre>

<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExplainXmlComplex() throws Throwable {
  if (cluster.getExecType() != ExecType.MAPREDUCE) {
    return;
  }
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (site: chararray, count: int, itemCounts: bag { itemCountsTuple: tuple (type: chararray, typeCount: int, f: float, m: map[]) } ) ;");
  pig.registerQuery("b = foreach a generate site, count, FLATTEN(itemCounts);");
  pig.registerQuery("c = group b by site;");
  pig.registerQuery("d = foreach c generate FLATTEN($1);");
  pig.registerQuery("e = group d by $2;");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pig.explain("e","xml",true,false,ps,ps,null,null);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DocumentBuilderFactory dbFactory=DocumentBuilderFactory.newInstance();
  DocumentBuilder dBuilder=dbFactory.newDocumentBuilder();
  Document doc=dBuilder.parse(bais);
  NodeList logicalPlan=doc.getElementsByTagName("logicalPlan");
  assertEquals(1,logicalPlan.getLength());
  assertTrue(logicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList physicalPlan=doc.getElementsByTagName("physicalPlan");
  assertEquals(1,physicalPlan.getLength());
  assertTrue(physicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList loads=doc.getElementsByTagName("POLoad");
  assertEquals(2,loads.getLength());
  boolean sawTempLoad=false;
  boolean sawNonTempLoad=false;
  for (int i=0; i < loads.getLength(); i++) {
    Boolean isTempLoad=null;
    boolean hasAlias=false;
    Node poLoad=loads.item(i);
    NodeList children=poLoad.getChildNodes();
    for (int j=0; j < children.getLength(); j++) {
      Node child=children.item(j);
      if (child.getNodeName().equals("alias")) {
        hasAlias=true;
      }
      if (child.getNodeName().equals("isTmpLoad")) {
        if (child.getTextContent().equals("false")) {
          isTempLoad=false;
        }
 else         if (child.getTextContent().equals("true")) {
          isTempLoad=true;
        }
      }
    }
    if (isTempLoad == null) {
      fail("POLoad elements should have isTmpLoad child node.");
    }
 else     if (isTempLoad && hasAlias) {
      fail("Temp loads should not have aliases");
    }
 else     if (!isTempLoad && !hasAlias) {
      fail("Non temporary loads should be associated with alias.");
    }
    sawTempLoad=sawTempLoad || isTempLoad;
    sawNonTempLoad=sawNonTempLoad || !isTempLoad;
  }
  assertTrue(sawTempLoad && sawNonTempLoad);
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testRegisterJarGlobbingRelative() throws Throwable {
  String dir="test1_register_jar_globbing_relative";
  String jarLocation=dir + FILE_SEPARATOR;
  String jar1Name="TestRegisterJarGlobbing1.jar";
  String jar2Name="TestRegisterJarGlobbing2.jar";
  createFakeJarFile(jarLocation,jar1Name);
  createFakeJarFile(jarLocation,jar2Name);
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerJar(jarLocation + "TestRegisterJarGlobbing*.jar");
  verifyStringContained(pig.getPigContext().extraJars,jar1Name,true);
  verifyStringContained(pig.getPigContext().extraJars,jar2Name,true);
  assertTrue((new File(jarLocation + jar1Name)).delete());
  assertTrue((new File(jarLocation + jar2Name)).delete());
  (new File(dir)).delete();
}

</code></pre>

<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDescribeTuple2Elem() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: int, field3: int );");
  pig.registerQuery("b = foreach a generate field1, (field2, field3);");
  Schema dumpedSchema=pig.dumpSchema("b");
  assertTrue(dumpedSchema.getField(0).type == DataType.INTEGER);
  assertTrue(dumpedSchema.getField(1).type == DataType.TUPLE);
}

</code></pre>

<pre class="type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigProperties() throws Throwable {
  File propertyFile=new File(tempDir,"pig.properties");
  propertyFile.deleteOnExit();
  TestPigServer.registerNewResource(propertyFile.getAbsolutePath());
  File cliPropertyFile=new File("commandLine_pig.properties");
  cliPropertyFile.deleteOnExit();
  TestPigServer.registerNewResource(cliPropertyFile.getAbsolutePath());
  Properties properties=PropertiesUtil.loadDefaultProperties();
  assertEquals("40000000",properties.getProperty("pig.spill.gc.activation.size"));
  assertNull(properties.getProperty("test123"));
  PrintWriter out=new PrintWriter(new FileWriter(propertyFile));
  out.println("test123=properties");
  out.close();
  properties=PropertiesUtil.loadDefaultProperties();
  assertEquals("properties",properties.getProperty("test123"));
  out=new PrintWriter(new FileWriter(cliPropertyFile));
  out.println("test123=cli_properties");
  out.close();
  properties=PropertiesUtil.loadDefaultProperties();
  PropertiesUtil.loadPropertiesFromFile(properties,"commandLine_pig.properties");
  assertEquals("cli_properties",properties.getProperty("test123"));
  propertyFile.delete();
  cliPropertyFile.delete();
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testRegisterJarGlobbingAbsolute() throws Throwable {
  String dir="test1_register_jar_globbing_absolute";
  String jarLocation=dir + FILE_SEPARATOR;
  String jar1Name="TestRegisterJarGlobbing1.jar";
  String jar2Name="TestRegisterJarGlobbing2.jar";
  createFakeJarFile(jarLocation,jar1Name);
  createFakeJarFile(jarLocation,jar2Name);
  String currentDir=System.getProperty("user.dir");
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerJar(new File(currentDir,dir) + FILE_SEPARATOR + "TestRegisterJarGlobbing*.jar");
  verifyStringContained(pig.getPigContext().extraJars,jar1Name,true);
  verifyStringContained(pig.getPigContext().extraJars,jar2Name,true);
  assertTrue((new File(jarLocation + jar1Name)).delete());
  assertTrue((new File(jarLocation + jar2Name)).delete());
  (new File(dir)).delete();
}

</code></pre>

<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Use a resource inside a jar file.
 * Verify that the containing jar file is registered correctly.
 * @throws Exception
 */
@Test public void testRegisterJarResourceInJar() throws Throwable {
  String dir="test_register_jar_res_in_jar";
  String subDir="sub_dir";
  String jarName="TestRegisterJarNonEmpty.jar";
  String className="TestRegisterJar";
  String javaSrc="package " + subDir + "; class "+ className+ " { }";
  (new File(dir + FILE_SEPARATOR + subDir)).mkdirs();
  FileOutputStream outStream=new FileOutputStream(new File(dir + FILE_SEPARATOR + subDir+ FILE_SEPARATOR+ className+ ".java"));
  OutputStreamWriter outWriter=new OutputStreamWriter(outStream);
  outWriter.write(javaSrc);
  outWriter.close();
  int status;
  status=Util.executeJavaCommand("javac " + dir + FILE_SEPARATOR+ subDir+ FILE_SEPARATOR+ className+ ".java");
  assertEquals(0,status);
  (new File(dir + FILE_SEPARATOR + subDir+ FILE_SEPARATOR+ className+ ".java")).delete();
  status=Util.executeJavaCommand("jar -cf " + dir + FILE_SEPARATOR+ jarName+ " "+ "-C "+ dir+ " "+ subDir);
  assertEquals(0,status);
  (new File(dir + FILE_SEPARATOR + subDir+ FILE_SEPARATOR+ className+ ".class")).delete();
  (new File(dir + FILE_SEPARATOR + subDir)).delete();
  registerNewResource(dir + FILE_SEPARATOR + jarName);
  boolean exceptionRaised=false;
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  try {
    pig.registerJar("sub_dir/TestRegisterJar.class");
  }
 catch (  IOException e) {
    exceptionRaised=true;
  }
  assertFalse(exceptionRaised);
  verifyStringContained(pig.getPigContext().extraJars,jarName,true);
  (new File(dir + FILE_SEPARATOR + jarName)).delete();
  (new File(dir)).delete();
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeUnion() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = load 'b' as (field4, field5: double, field6: chararray );");
  pig.registerQuery("c = union a, b;");
  Schema dumpedSchema=pig.dumpSchema("c");
  Schema expectedSchema=Utils.getSchemaFromString("field1: int,field2: double,field3: chararray");
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeFilter() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = filter a by field1 > 10;");
  Schema dumpedSchema=pig.dumpSchema("b");
  Schema expectedSchema=Utils.getSchemaFromString("field1: int,field2: float,field3: chararray");
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScalarResolution() throws Throwable {
  registerScalarScript(false,"a: int,every: {(b: int)},even: int,odd: {(b: int)}");
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeForeach() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = foreach a generate field1 + 10;");
  Schema dumpedSchema=pig.dumpSchema("b");
  Schema expectedSchema=new Schema(new Schema.FieldSchema(null,DataType.INTEGER));
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testScalarPrecedence() throws Throwable {
  registerScalarScript(true,"a: int,every: {(b: int)},even: {(b: int)},odd: {(b: int)}");
}

</code></pre>

<pre class="type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void test1() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.setValidateEachStatement(true);
  pig.registerQuery("A = load 'x' as (u, v);");
  try {
    pig.registerQuery("B = foreach A generate $2;");
    fail("Query is supposed to fail.");
  }
 catch (  FrontendException ex) {
    String msg="Out of bound access. " + "Trying to access non-existent column: 2";
    Util.checkMessageInException(ex,msg);
  }
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp() throws Exception {
  tempDir=Files.createTempDir();
  tempDir.deleteOnExit();
  registerNewResource(tempDir.getAbsolutePath());
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeDistinct() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = distinct a ;");
  Schema dumpedSchema=pig.dumpSchema("b");
  Schema expectedSchema=Utils.getSchemaFromString("field1: int,field2: float,field3: chararray");
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<pre class="type-6 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testDescribeForeachNoSchema() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' ;");
  pig.registerQuery("b = foreach a generate *;");
  Schema dumpedSchema=pig.dumpSchema("b");
  assertNull(dumpedSchema);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescribeCross() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = load 'b' as (field4, field5: double, field6: chararray );");
  pig.registerQuery("c = cross a, b;");
  Schema dumpedSchema=pig.dumpSchema("c");
  Schema expectedSchema=Utils.getSchemaFromString("a::field1: int,a::field2: float,a::field3: chararray,b::field4: bytearray,b::field5: double,b::field6: chararray");
  assertEquals(expectedSchema,dumpedSchema);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
