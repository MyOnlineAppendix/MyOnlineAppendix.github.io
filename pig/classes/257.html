<h3 style="margin:0px">Class: org.apache.pig.test.TestPOSort (14 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(10)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortDescInt() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortDescInt(input);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortDescString() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortDescString(input);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortAscString() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortAscString(input);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortAsc() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortAscInt(input);
}

</code></pre>

<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Sorting
 * (null, 10)
 * (1, 8)
 * (1, null)
 * (null,null)
 * (3, 8)
 * BY $1 DESC, $0 ASC
 * should return
 * (null, 10)
 * (1, 8 )
 * (3, 8 )
 * (null,null)
 * (1, null)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc1WithNull() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(null);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(1);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(1);
  t3.append(null);
  input.add(t3);
  Tuple t4=TupleFactory.getInstance().newTuple();
  t4.append(null);
  t4.append(null);
  input.add(t4);
  Tuple t5=TupleFactory.getInstance().newTuple();
  t5.append(3);
  t5.append(8);
  input.add(t5);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertEquals(((Tuple)res.result).get(1),10);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertNull(((Tuple)res.result).get(1));
}

</code></pre>

<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Sorting
 * (1, 10)
 * (3, 8)
 * (2, 8)
 * BY $1 DESC, $0 ASC
 * should return
 * (1, 10)
 * (2 ,8)
 * (3, 8)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc1() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(1);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(3);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(2);
  t3.append(8);
  input.add(t3);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),10);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),2);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortAscStringWithNull() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortAscString(input);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortUDFWithNull() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortUDFWithNull(input);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortUDF() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBag(r,MAX_TUPLES,100);
  poSortUDFWithNull(input);
}

</code></pre>

<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Sorting
 * (1, 2)
 * (3, 5)
 * (3, 8)
 * BY $0 DESC, $1 ASC
 * should return
 * (3, 5)
 * (3 ,8)
 * (1, 2)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc2() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(1);
  t1.append(2);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(3);
  t2.append(5);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(3);
  t3.append(8);
  input.add(t3);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),5);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),2);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortAscWithNulls() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortAscInt(input);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortDescStringWithNulls() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortDescString(input);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPOSortDescIntWithNulls() throws ExecException {
  DataBag input=(DataBag)GenRandomData.genRandSmallTupDataBagWithNulls(r,MAX_TUPLES,100);
  poSortDescInt(input);
}

</code></pre>

<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Sorting
 * (null, 10)
 * (1, 8)
 * (1, null)
 * (null,null)
 * (3, 8)
 * BY $0 DESC, $1 ASC
 * should return
 * (3, 8 )
 * (1, null)
 * (1, 8 )
 * (null,null)
 * (null, 10)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc2Null() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(null);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(1);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(1);
  t3.append(null);
  input.add(t3);
  Tuple t4=TupleFactory.getInstance().newTuple();
  t4.append(null);
  t4.append(null);
  input.add(t4);
  Tuple t5=TupleFactory.getInstance().newTuple();
  t5.append(3);
  t5.append(8);
  input.add(t5);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertEquals(((Tuple)res.result).get(1),10);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
