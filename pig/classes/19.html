<h3 style="margin:0px">Class: org.apache.pig.builtin.TestAvroStorage (41 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(36)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecursiveRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recursiveRecord.avro";
  testAvroStorage(false,basedir + "code/pig/recursive_tests.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_IN_2","-n this.is.ignored.in.a.loadFunc","AVROSTORAGE_OUT_1","recordsSubSchemaNullable","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecursiveRecordsOptionOn() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recursiveRecord.avro";
  final String check=basedir + "data/avro/uncompressed/recordsSubSchemaNullable.avro";
  testAvroStorage(true,basedir + "code/pig/recursive_tests.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_IN_2","-r","AVROSTORAGE_OUT_1","recordsSubSchemaNullable","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjectionWithSchema() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/projectionTestWithSchema.avro";
  testAvroStorage(true,basedir + "code/pig/projection_test_with_schema.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_IN_2","-f " + basedir + "schema/records.avsc","AVROSTORAGE_OUT_1","projectionTest","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAvroMapWrapper() throws Exception {
  final Map<CharSequence,Object> m=new HashMap<CharSequence,Object>();
  for (  String fn : avroSchemas) {
    final String avro=basedir + "data/avro/uncompressed/" + fn+ ".avro";
    int i=0;
    for (    GenericContainer r : readAvroData(avro)) {
      m.put(new Utf8(fn + i),r);
      i+=1;
    }
  }
  final AvroMapWrapper amw=new AvroMapWrapper(m);
  for (  Object o : amw.values()) {
    assertTrue(isValidPigObject(o));
  }
  for (  CharSequence k : amw.keySet()) {
    assertTrue(isValidPigObject(k));
    assertTrue(isValidPigObject(amw.get(k)));
  }
  for (  Map.Entry<CharSequence,Object> e : amw.entrySet()) {
    assertTrue(isValidPigObject(e.getKey()));
    assertTrue(isValidPigObject(e.getValue()));
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithMaps() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithMaps.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithMaps.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSeparatedByComma() throws Exception {
  final String temp=basedir + "data/avro/uncompressed/testdirectory/part-m-0000";
  StringBuffer sb=new StringBuffer();
  sb.append(temp + "0.avro");
  for (int i=1; i <= 7; ++i) {
    sb.append(",");
    sb.append(temp + String.valueOf(i) + ".avro");
  }
  final String input=sb.toString();
  final String check=basedir + "data/avro/uncompressed/testDirectoryCounts.avro";
  testAvroStorage(true,basedir + "code/pig/directory_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","stats","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadDeflateCompressedRecords() throws Exception {
  final String input=basedir + "data/avro/compressed/deflate/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithMapsOfRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithMapsOfRecords.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithMapsOfRecords.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithRepeatedSubRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordWithRepeatedSubRecords.avro";
  final String check=basedir + "data/avro/uncompressed/recordWithRepeatedSubRecords.avro";
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordWithRepeatedSubRecords.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifySubSchemaFromFile() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsSubSchema.avro";
  testAvroStorage(true,basedir + "code/pig/identity_blank_first_args.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsSubSchema.avsc","AVROSTORAGE_IN_2","-f " + basedir + "schema/recordsSubSchema.avsc"));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadTrevniRecords() throws Exception {
  final String input=basedir + "data/trevni/uncompressed/simpleRecordsTrevni.trevni";
  final String check=basedir + "data/avro/uncompressed/simpleRecordsTrevni.avro";
  testAvroStorage(true,basedir + "code/pig/trevni_to_avro.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/simpleRecordsTrevni.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleUnderscore() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsWithDoubleUnderscores.avro";
  testAvroStorage(true,basedir + "code/pig/namesWithDoubleColons.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","recordsWithDoubleUnderscores","AVROSTORAGE_OUT_2","-d -n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithEnums() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithEnums.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithEnums.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifyFullSchemaFromClass() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_IN_2","-c org.apache.pig.builtin.avro.code.java.RecordPojo","AVROSTORAGE_OUT_1","''","AVROSTORAGE_OUT_2","-c org.apache.pig.builtin.avro.code.java.RecordPojo"));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadGlob() throws Exception {
  final String input=basedir + "data/avro/uncompressed/testdirectory/part-m-0000*";
  final String check=basedir + "data/avro/uncompressed/testDirectoryCounts.avro";
  testAvroStorage(true,basedir + "code/pig/directory_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","stats","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsOfArrays() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsOfArrays.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsOfArrays.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifySubSchema() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsSubSchema.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ai1_ao2.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin -f " + basedir + "schema/recordsSubSchema.avsc","AVROSTORAGE_IN_1",loadFileIntoString(basedir + "schema/recordsSubSchema.avsc")));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithMapsOfArrayOfRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithMapsOfArrayOfRecords.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithMapsOfArrayOfRecords.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPartialLoadGlob() throws Exception {
  final String input=basedir + "data/avro/uncompressed/testdirectory/part-m-0000{0,2,4,6}.avro";
  final String check=basedir + "data/avro/uncompressed/evenFileNameTestDirectoryCounts.avro";
  testAvroStorage(true,basedir + "code/pig/directory_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","stats","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testProjection() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/projectionTest.avro";
  testAvroStorage(true,basedir + "code/pig/projection_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","projectionTest","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-7 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRetrieveDataFromMap() throws Exception {
  pigServerLocal=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServerLocal);
  Map<String,String> mapv1=new HashMap<String,String>();
  mapv1.put("key1","v11");
  mapv1.put("key2","v12");
  Map<String,String> mapv2=new HashMap<String,String>();
  mapv2.put("key1","v21");
  mapv2.put("key2","v22");
  data.set("testMap","maps:map[chararray]",tuple(mapv1),tuple(mapv2));
  String schemaDescription=new String("{" + "\"type\": \"record\"," + "\"name\": \"record\","+ "\"fields\" : ["+ "{\"name\" : \"maps\", \"type\" :{\"type\" : \"map\", \"values\" : \"string\"}}"+ "]"+ "}");
  pigServerLocal.registerQuery("A = LOAD 'testMap' USING mock.Storage();");
  pigServerLocal.registerQuery("STORE A INTO '" + createOutputName() + "' USING AvroStorage('"+ schemaDescription+ "');");
  pigServerLocal.registerQuery("B = LOAD '" + createOutputName() + "' USING AvroStorage();");
  pigServerLocal.registerQuery("C = FOREACH B generate maps#'key1';");
  pigServerLocal.registerQuery("STORE C INTO 'out' USING mock.Storage();");
  List<Tuple> out=data.get("out");
  assertEquals(tuple("v11"),out.get(0));
  assertEquals(tuple("v21"),out.get(1));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsOfStringArrays() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsOfStringArrays.avro";
  testAvroStorage(true,basedir + "code/pig/dump.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsOfStringArrays.avsc","OUTFILE",createOutputName()));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleUnderscoreNoFlag() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  testAvroStorage(false,basedir + "code/pig/namesWithDoubleColons.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","recordsWithDoubleUnderscores","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithSimpleUnion() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithSimpleUnion.avro";
  final String check=basedir + "data/avro/uncompressed/recordsWithSimpleUnionOutput.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin -f " + basedir + "schema/recordsSubSchema.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsOfArraysOfRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsOfArraysOfRecords.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsOfArraysOfRecords.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadSnappyCompressedRecords() throws Exception {
  final String input=basedir + "data/avro/compressed/snappy/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifyFullSchemaFromFile() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","AVROSTORAGE_IN_2","-f " + basedir + "schema/records.avsc"));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifyFullSchema() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  final String schema=loadFileIntoString(basedir + "schema/records.avsc");
  testAvroStorage(true,basedir + "code/pig/identity_ai1_ao2.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","AVROSTORAGE_IN_1",schema));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreSnappyCompressedRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/compressed/snappy/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_codec.pig",ImmutableMap.<String,String>builder().put("INFILE",input).put("OUTFILE",createOutputName()).put("AVROSTORAGE_OUT_1","records").put("AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin").put("CODEC","snappy").put("LEVEL","6").build());
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void teardown() throws IOException {
  if (pigServerLocal != null) {
    pigServerLocal.shutdown();
  }
  deleteInputFiles();
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithNullableUnions() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithNullableUnions.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithNullableUnions.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDates() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPigWithDates.avro";
  testAvroStorage(true,basedir + "code/pig/with_dates.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadArrays() throws Exception {
  final String input=basedir + "data/avro/uncompressed/arrays.avro";
  final String check=basedir + "data/avro/uncompressed/arraysAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","arrays","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsWithFixed() throws Exception {
  final String input=basedir + "data/avro/uncompressed/recordsWithFixed.avro";
  final String check=input;
  testAvroStorage(true,basedir + "code/pig/identity_just_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsWithFixed.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecordsSpecifySubSchemaFromExampleFile() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsSubSchema.avro";
  testAvroStorage(true,basedir + "code/pig/identity_blank_first_args.pig",ImmutableMap.of("INFILE",input,"OUTFILE",createOutputName(),"AVROSTORAGE_OUT_2","-f " + basedir + "schema/recordsSubSchema.avsc","AVROSTORAGE_IN_2","-e " + basedir + "data/avro/uncompressed/recordsSubSchema.avro"));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStoreDeflateCompressedRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/compressed/deflate/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_codec.pig",ImmutableMap.<String,String>builder().put("INFILE",input).put("OUTFILE",createOutputName()).put("AVROSTORAGE_OUT_1","records").put("AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin").put("CODEC","deflate").put("LEVEL","6").build());
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadAndSaveTrevniRecords() throws Exception {
  final String input=basedir + "data/trevni/uncompressed/simpleRecordsTrevni.trevni";
  final String check=basedir + "data/avro/uncompressed/simpleRecordsTrevni.avro";
  testAvroStorage(true,basedir + "code/pig/trevni_to_trevni.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_2","-f " + basedir + "schema/simpleRecordsTrevni.avsc","OUTFILE",createOutputName() + "Trevni"));
  testAvroStorage(true,basedir + "code/pig/trevni_to_avro.pig",ImmutableMap.of("INFILE",createOutputName() + "Trevni","AVROSTORAGE_OUT_2","-f " + basedir + "schema/simpleRecordsTrevni.avsc","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadDirectory() throws Exception {
  final String input=basedir + "data/avro/uncompressed/testdirectory";
  final String check=basedir + "data/avro/uncompressed/testDirectoryCounts.avro";
  testAvroStorage(true,basedir + "code/pig/directory_test.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","stats","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUtf8KeyLookupFromMap() throws Exception {
  Map<CharSequence,Object> tm=new TreeMap<CharSequence,Object>();
  tm.put(new Utf8("foo"),"foo");
  tm.put(new Utf8("bar"),"bar");
  AvroMapWrapper wrapper=new AvroMapWrapper(tm);
  String v=(String)wrapper.get(new Utf8("foo"));
  assertEquals("foo",v);
  v=(String)wrapper.get(new Utf8("bar"));
  assertEquals("bar",v);
}

</code></pre>

<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testCompareToOfBagWrapper() throws Exception {
  final String check=basedir + "data/avro/uncompressed/arraysAsOutputByPig.avro";
  Set<GenericData.Record> records=getExpected(check);
  assertEquals(3,records.size());
  AvroBagWrapper size0=null;
  AvroBagWrapper size1=null;
  AvroBagWrapper size5=null;
  for (  GenericData.Record record : records) {
    AvroTupleWrapper tw=new AvroTupleWrapper<GenericData.Record>(record);
    if (((AvroBagWrapper)tw.get(0)).size() == 0) {
      size0=(AvroBagWrapper)tw.get(0);
    }
 else     if (((AvroBagWrapper)tw.get(0)).size() == 1) {
      size1=(AvroBagWrapper)tw.get(0);
    }
 else     if (((AvroBagWrapper)tw.get(0)).size() == 5) {
      size5=(AvroBagWrapper)tw.get(0);
    }
  }
  assertEquals(0,size0.size());
  assertEquals(1,size1.size());
  assertEquals(5,size5.size());
  assertTrue(size0.compareTo(size0) == 0);
  assertTrue(size0.compareTo(size1) < 0);
  assertTrue(size0.compareTo(size5) < 0);
  assertTrue(size1.compareTo(size0) > 0);
  assertTrue(size1.compareTo(size5) > 0);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadRecords() throws Exception {
  final String input=basedir + "data/avro/uncompressed/records.avro";
  final String check=basedir + "data/avro/uncompressed/recordsAsOutputByPig.avro";
  testAvroStorage(true,basedir + "code/pig/identity_ao2.pig",ImmutableMap.of("INFILE",input,"AVROSTORAGE_OUT_1","records","AVROSTORAGE_OUT_2","-n org.apache.pig.test.builtin","OUTFILE",createOutputName()));
  verifyResults(createOutputName(),check);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
