<h3 style="margin:0px">Class: org.apache.pig.test.TestResourceSchema (9 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(2)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that ResourceSchema is correctly created given a
 * pig.Schema and vice versa 
 */
@Test public void testResourceFlatSchemaCreation() throws ExecException, SchemaMergeException, FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema origSchema=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  ResourceSchema rsSchema=new ResourceSchema(origSchema);
  assertEquals("num fields",aliases.length,rsSchema.getFields().length);
  ResourceSchema.ResourceFieldSchema[] fields=rsSchema.getFields();
  for (int i=0; i < fields.length; i++) {
    assertEquals(fields[i].getName(),aliases[i]);
    assertEquals(fields[i].getType(),types[i]);
  }
  Schema genSchema=Schema.getPigSchema(rsSchema);
  assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
}

</code></pre>

<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test one-level Pig Schema: bag without tuple field
 */
@Test public void testResourceSchemaWithInvalidPigSchema2() throws FrontendException {
  String[] aliases={"f1"};
  byte[] types={DataType.INTEGER};
  Schema level0=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  Schema.FieldSchema fld0=new Schema.FieldSchema("f0",level0,DataType.BAG);
  Schema level1=new Schema(fld0);
  try {
    Schema.getPigSchema(new ResourceSchema(level1));
    Assert.fail();
  }
 catch (  FrontendException e) {
    assertTrue(e.getErrorCode() == 2218);
  }
}

</code></pre>

<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can turn a schema into a string and then parse it
 * back into a schema.
 */
@Test public void testToStringAndParse() throws Exception {
  ResourceSchema rs=new ResourceSchema();
  ResourceFieldSchema[] fields=new ResourceFieldSchema[13];
  byte[] types={DataType.INTEGER,DataType.LONG,DataType.FLOAT,DataType.DOUBLE,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.MAP,DataType.TUPLE,DataType.TUPLE,DataType.BAG,DataType.BAG,DataType.BOOLEAN,DataType.DATETIME};
  String[] names={"i","l","f","d","b","s","m","tschema","tnull","bschema","bnull","bb","dt"};
  for (int i=0; i < fields.length; i++) {
    fields[i]=new ResourceFieldSchema();
    fields[i].setName(names[i]);
    fields[i].setType(types[i]);
  }
  ResourceSchema tschema=new ResourceSchema();
  ResourceFieldSchema[] tfields=new ResourceFieldSchema[3];
  for (int i=0; i < 3; i++) {
    tfields[i]=new ResourceFieldSchema();
    tfields[i].setName(names[i]);
    tfields[i].setType(types[i]);
  }
  tschema.setFields(tfields);
  fields[7].setSchema(tschema);
  ResourceSchema bschema=new ResourceSchema();
  ResourceFieldSchema[] bfields=new ResourceFieldSchema[1];
  bfields[0]=new ResourceFieldSchema();
  bfields[0].setName("t");
  bfields[0].setType(DataType.TUPLE);
  ResourceSchema tbschema=new ResourceSchema();
  ResourceFieldSchema[] tbfields=new ResourceFieldSchema[3];
  for (int i=3; i < 6; i++) {
    tbfields[i - 3]=new ResourceFieldSchema();
    tbfields[i - 3].setName(names[i]);
    tbfields[i - 3].setType(types[i]);
  }
  tbschema.setFields(tbfields);
  bfields[0].setSchema(tbschema);
  bschema.setFields(bfields);
  fields[9].setSchema(bschema);
  rs.setFields(fields);
  String strSchema=rs.toString();
  assertEquals("i:int,l:long,f:float,d:double,b:bytearray,s:" + "chararray,m:[],tschema:(i:int,l:long,f:float)," + "tnull:(),bschema:{t:(d:double,b:bytearray,s:chararray)},bnull:{},bb:boolean,dt:datetime",strSchema);
  ResourceSchema after=new ResourceSchema(Utils.getSchemaFromString(strSchema));
  ResourceFieldSchema[] afterFields=after.getFields();
  assertEquals(13,afterFields.length);
  assertEquals("i",afterFields[0].getName());
  assertEquals(DataType.INTEGER,afterFields[0].getType());
  assertEquals("l",afterFields[1].getName());
  assertEquals(DataType.LONG,afterFields[1].getType());
  assertEquals("f",afterFields[2].getName());
  assertEquals(DataType.FLOAT,afterFields[2].getType());
  assertEquals("d",afterFields[3].getName());
  assertEquals(DataType.DOUBLE,afterFields[3].getType());
  assertEquals("b",afterFields[4].getName());
  assertEquals(DataType.BYTEARRAY,afterFields[4].getType());
  assertEquals("s",afterFields[5].getName());
  assertEquals(DataType.CHARARRAY,afterFields[5].getType());
  assertEquals("m",afterFields[6].getName());
  assertEquals(DataType.MAP,afterFields[6].getType());
  assertEquals("tschema",afterFields[7].getName());
  assertEquals(DataType.TUPLE,afterFields[7].getType());
  assertEquals("tnull",afterFields[8].getName());
  assertEquals(DataType.TUPLE,afterFields[8].getType());
  assertEquals("bschema",afterFields[9].getName());
  assertEquals(DataType.BAG,afterFields[9].getType());
  assertEquals("bnull",afterFields[10].getName());
  assertEquals(DataType.BAG,afterFields[10].getType());
  assertEquals("bb",afterFields[11].getName());
  assertEquals(DataType.BOOLEAN,afterFields[11].getType());
  assertEquals("dt",afterFields[12].getName());
  assertEquals(DataType.DATETIME,afterFields[12].getType());
  assertNotNull(afterFields[7].getSchema());
  ResourceFieldSchema[] tAfterFields=afterFields[7].getSchema().getFields();
  assertEquals(3,tAfterFields.length);
  assertEquals("i",tAfterFields[0].getName());
  assertEquals(DataType.INTEGER,tAfterFields[0].getType());
  assertEquals("l",tAfterFields[1].getName());
  assertEquals(DataType.LONG,tAfterFields[1].getType());
  assertEquals("f",tAfterFields[2].getName());
  assertEquals(DataType.FLOAT,tAfterFields[2].getType());
  assertNotNull(afterFields[9].getSchema());
  ResourceFieldSchema[] bAfterFields=afterFields[9].getSchema().getFields();
  assertEquals(1,bAfterFields.length);
  assertNotNull(bAfterFields[0].getSchema());
  ResourceFieldSchema[] tbAfterFields=bAfterFields[0].getSchema().getFields();
  assertEquals(3,tbAfterFields.length);
  assertEquals("d",tbAfterFields[0].getName());
  assertEquals(DataType.DOUBLE,tbAfterFields[0].getType());
  assertEquals("b",tbAfterFields[1].getName());
  assertEquals(DataType.BYTEARRAY,tbAfterFields[1].getType());
  assertEquals("s",tbAfterFields[2].getName());
  assertEquals(DataType.CHARARRAY,tbAfterFields[2].getType());
}

</code></pre>

<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that Pig Schema is correctly created given a
 * ResourceSchema and vice versa. Test also that 
 * TwoLevelAccess flag is set for Pig Schema when needed.
 * @throws IOException 
 */
@Test public void testToPigSchemaWithTwoLevelAccess() throws IOException {
  ResourceFieldSchema[] level0=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("fld0").setType(DataType.CHARARRAY),new ResourceFieldSchema().setName("fld1").setType(DataType.DOUBLE),new ResourceFieldSchema().setName("fld2").setType(DataType.INTEGER)};
  ResourceSchema rSchema0=new ResourceSchema().setFields(level0);
  ResourceFieldSchema[] level1=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t1").setType(DataType.TUPLE).setSchema(rSchema0)};
  ResourceSchema rSchema1=new ResourceSchema().setFields(level1);
  ResourceFieldSchema[] level2=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t2").setType(DataType.BAG).setSchema(rSchema1)};
  ResourceSchema origSchema=new ResourceSchema().setFields(level2);
  Schema pSchema=Schema.getPigSchema(origSchema);
  assertTrue(!CheckTwoLevelAccess(pSchema));
  assertTrue(ResourceSchema.equals(origSchema,new ResourceSchema(pSchema)));
}

</code></pre>

<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test one-level Pig Schema: multiple fields for a bag
 */
@Test public void testResourceSchemaWithInvalidPigSchema() throws FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema level0=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  Schema.FieldSchema fld0=new Schema.FieldSchema("f0",level0,DataType.BAG);
  Schema level1=new Schema(fld0);
  try {
    Schema.getPigSchema(new ResourceSchema(level1));
    Assert.fail();
  }
 catch (  FrontendException e) {
    assertTrue(e.getErrorCode() == 2218);
  }
}

</code></pre>

<pre class="type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test that ResourceSchema is correctly created given a
 * pig.Schema and vice versa 
 */
@Test public void testResourceFlatSchemaCreation2() throws ExecException, SchemaMergeException, FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema origSchema=new Schema(new Schema.FieldSchema("t1",new Schema(new Schema.FieldSchema("t0",TypeCheckingTestUtil.genFlatSchema(aliases,types),DataType.TUPLE)),DataType.BAG));
  ResourceSchema rsSchema=new ResourceSchema(origSchema);
  Schema genSchema=Schema.getPigSchema(rsSchema);
  assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
}

</code></pre>

<pre class="type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test that ResourceSchema is correctly with SortInfo
 */
@Test public void testResourceFlatSchemaCreationWithSortInfo() throws ExecException, SchemaMergeException, FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema origSchema=new Schema(new Schema.FieldSchema("t1",new Schema(new Schema.FieldSchema("t0",TypeCheckingTestUtil.genFlatSchema(aliases,types),DataType.TUPLE)),DataType.BAG));
  List<SortColInfo> colList=new ArrayList<SortColInfo>();
  SortColInfo col1=new SortColInfo("f1",0,SortColInfo.Order.ASCENDING);
  SortColInfo col2=new SortColInfo("f1",1,SortColInfo.Order.DESCENDING);
  colList.add(col1);
  colList.add(col2);
  SortInfo sortInfo=new SortInfo(colList);
  ResourceSchema rsSchema=new ResourceSchema(origSchema,sortInfo);
  Schema genSchema=Schema.getPigSchema(rsSchema);
  assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
  assertTrue(rsSchema.getSortKeys()[0] == 0);
  assertTrue(rsSchema.getSortKeys()[1] == 1);
  assertTrue(rsSchema.getSortKeyOrders()[0] == ResourceSchema.Order.ASCENDING);
  assertTrue(rsSchema.getSortKeyOrders()[1] == ResourceSchema.Order.DESCENDING);
}

</code></pre>

<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test invalid Resource Schema: multiple fields for a bag
 * @throws IOException 
 */
@Test(expected=FrontendException.class) public void testToPigSchemaWithInvalidSchema() throws IOException {
  ResourceFieldSchema[] level0=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("fld0").setType(DataType.CHARARRAY),new ResourceFieldSchema().setName("fld1").setType(DataType.DOUBLE),new ResourceFieldSchema().setName("fld2").setType(DataType.INTEGER)};
  ResourceSchema rSchema0=new ResourceSchema().setFields(level0);
  ResourceFieldSchema[] level2=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t2").setType(DataType.BAG).setSchema(rSchema0)};
}

</code></pre>

<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test invalid Resource Schema: bag without tuple field
 * @throws IOException 
 */
@Test(expected=FrontendException.class) public void testToPigSchemaWithInvalidSchema2() throws IOException {
  ResourceFieldSchema[] level0=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("fld0").setType(DataType.CHARARRAY)};
  ResourceSchema rSchema0=new ResourceSchema().setFields(level0);
  ResourceFieldSchema[] level2=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t2").setType(DataType.BAG).setSchema(rSchema0)};
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
