<h3 style="margin:0px">Class: org.apache.pig.tez.TestTezCompiler (52 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(50)</kbd></button>&nbsp;<button id="17"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('17')" data-toggle="tooltip" title="Is an empty test case"><kbd id="tag-17"class="label-info"style="display: inline-block;font-size:7pt" >EmptyTester&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithNestedSplit() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "store b into 'file:///tmp/output/b';"+ "c = foreach b generate a.x, a.y;"+ "store c into 'file:///tmp/output/c';"+ "d = foreach b GENERATE FLATTEN(a);"+ "store d into 'file:///tmp/output/d';"+ "e = foreach d GENERATE a::x, a::y;"+ "store e into 'file:///tmp/output/e';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-5.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-5-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionReplicateJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-4.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-4-OPTOFF.gld");
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join d by x, c by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-5.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-5-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplicatedJoinInReducer() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = group a by x;" + "b1 = foreach b generate group, COUNT(a.y);"+ "c = load 'file:///tmp/input2' as (x:int, z:int);"+ "d = join b1 by group, c by x using 'replicated';"+ "store d into 'file:///tmp/output/e';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-FRJoin-2.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinctAlgebraicUdfCombiner() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "c = foreach b { d = distinct a; generate COUNT(d); };"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Distinct-2.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionSkewedJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x using 'skewed';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-6.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-6-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitScalarOrderby() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = order a by x, y;" + "g = group a all;"+ "h = foreach g generate COUNT(a) as sum;"+ "c = limit b h.sum/2;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Limit-3.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCross() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = cross a, b;"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Cross-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionSplit() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "split a into a1 if x > 100, a2 otherwise;"+ "c = union onschema a1, a2, b;"+ "split c into d if x > 500, e otherwise;"+ "store a2 into 'file:///tmp/output/a2';"+ "store d into 'file:///tmp/output/d';"+ "store e into 'file:///tmp/output/e';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-9.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-9-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithJoin() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = join a by x, b by x;"+ "d = foreach c generate $0, $1, $3;"+ "e = foreach c generate $0, $1, $2, $3;"+ "store c into 'file:///tmp/output/c';"+ "store d into 'file:///tmp/output/d';"+ "store e into 'file:///tmp/output/e';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-4.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-4-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCogroupWithAlgebraiceUDF() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = cogroup a by x, b by x;"+ "d = foreach c generate group, COUNT(a.y), COUNT(b.z);"+ "store d into 'file:///tmp/output/d';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Cogroup-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderByWithFilter() throws Exception {
  String query="a = load 'file:///tmp/input' using PigStorage(',') as (x:int, y:int);" + "b = filter a by x == 1;" + "c = order b by x;"+ "STORE c INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Order-2.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCrossScalarSplit() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = cross b, a;"+ "d = foreach c generate a.x, b.z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Cross-3.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionStore() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "store c into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-1.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-1-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryMultipleScalar() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x == 5;" + "b = foreach b generate $0 as b1;"+ "c = filter a by x == 10;"+ "c = foreach c generate $0 as c1;"+ "d = group a by x;"+ "e = foreach d generate group, b.b1, c.c1;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-8.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-8-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderByReadOnceLoadFunc() throws Exception {
  setProperty("pig.sort.readonce.loadfuncs","org.apache.pig.backend.hadoop.hbase.HBaseStorage,org.apache.pig.backend.hadoop.accumulo.AccumuloStorage");
  String query="a = load 'file:///tmp/input' using org.apache.pig.backend.hadoop.hbase.HBaseStorage(',') as (x:int, y:int);" + "b = order a by x;" + "STORE b INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Order-3.gld");
  setProperty("pig.sort.readonce.loadfuncs",null);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMulitQueryWithSplitSingleVertex() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "split a into b if x <= 5, c if x <= 10, d if x >10;" + "store b into 'file:///tmp/output/b';"+ "store c into 'file:///tmp/output/c';"+ "store d into 'file:///tmp/output/d';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-1.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-1-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDistinct() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = distinct a;" + "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Distinct-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryScalar() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "c = foreach b generate group, COUNT(a) as cnt;"+ "SPLIT a into d if (2 * c.cnt) < y, e OTHERWISE;"+ "store d into 'file:///tmp/output1';"+ "store e into 'file:///tmp/output2';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-6.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-6-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfJoinReplicated() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x < 5;" + "c = filter a by x == 10;"+ "d = filter a by x > 10;"+ "e = join b by x, c by x, d by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SelfJoin-3.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionSplitReplicateJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-13.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-13-OPTOFF.gld");
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join d by x, c by x using 'replicated';"+ "store e into 'file:///tmp/output';";
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-14.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-14-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplicatedJoinInMapper() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = load 'file:///tmp/input3' as (x:int, z:int);"+ "d = join a by x, b by x, c by x using 'replicated';"+ "store d into 'file:///tmp/output/d';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-FRJoin-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRankBy() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = rank a by x;" + "store b into 'file:///tmp/output/d';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Rank-2.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionUnion() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, y:chararray);"+ "e = union onschema c, d;"+ "f = group e by x;"+ "store e into 'file:///tmp/output1';"+ "store f into 'file:///tmp/output2';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-10.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-10-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionUnionStore() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, y:chararray);"+ "e = union onschema c, d;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-11.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-11-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupBy() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "c = foreach b generate group, COUNT(a.x);"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Group-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryMultipleReplicateJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = load 'file:///tmp/input' as (x:int, y:int);" + "c = join a by $0, b by $0 using 'replicated';"+ "d = join a by $1, b by $1 using 'replicated';"+ "e = union c,d;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-7.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-7-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-3.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-3-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMulitQueryWithSplitMultiVertex() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "split a into b if x <= 5, c if x <= 10, d if x >10;" + "split b into e if x < 3, f if x >= 3;"+ "b1 = group b by x;"+ "b2 = foreach b1 generate group, SUM(b.x);"+ "c1 = join c by x, b by x;"+ "c2 = group c by x;"+ "c3 = foreach c2 generate group, SUM(c.x);"+ "d1 = filter d by x == 5;"+ "e1 = order e by x;"+ "f1 = limit f 1;"+ "f2 = union d1, f1;"+ "store b1 into 'file:///tmp/output/b1';"+ "store b2 into 'file:///tmp/output/b2';"+ "store c1 into 'file:///tmp/output/c1';"+ "store c3 into 'file:///tmp/output/c1';"+ "store d1 into 'file:///tmp/output/d1';"+ "store e1 into 'file:///tmp/output/e1';"+ "store f1 into 'file:///tmp/output/f1';"+ "store f2 into 'file:///tmp/output/f2';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-2.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-2-OPTOFF.gld");
}

</code></pre>

<pre class="type-14 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Is an empty test case
"></span><br>
@AfterClass public static void tearDownAfterClass() throws Exception {
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimit() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = limit a 10;" + "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Limit-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStream() throws Exception {
  String query="a = load 'file:///tmp/input' using PigStorage(',') as (x:int, y:int);" + "b = stream a through `stream.pl -n 5`;" + "STORE b INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Stream-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfJoinSkewed() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x < 5;" + "c = filter a by x == 10;"+ "d = join b by x, c by x using 'skewed';"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SelfJoin-2.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJoin() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = join a by x, b by x;"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Join-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfJoinUnionReplicated() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = union a, b;"+ "d = join b by x, c by x using 'replicated';"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SelfJoin-4.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionGroupBy() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = load 'file:///tmp/input' as (y:int, x:int);" + "c = union onschema a, b;"+ "d = group c by x;"+ "e = foreach d generate group, SUM(c.y);"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-2.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-2-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfCross() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x < 5;" + "c = filter a by x == 10;"+ "d = cross b, c;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Cross-2.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionLimit() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = limit c 1;"+ "store d into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-8.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-8-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSecondaryKeySort() throws Exception {
  String query="a = load 'file:///tmp/input' using PigStorage(',') as (x:int, y:int, z:int);" + "b = group a by $0;" + "c = foreach b { d = limit a 10; e = order d by $1; f = order e by $0; generate group, f;};"+ "store c INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SecKeySort-1.gld");
  setProperty(PigConfiguration.PIG_EXEC_NO_SECONDARY_KEY,"true");
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SecKeySort-2.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionOrderby() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = order c by x;"+ "store d into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-7.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-7-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleUnionSplitJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "b1 = foreach b generate *;"+ "b2 = foreach b generate *;"+ "b3 = union onschema b1, b2;"+ "c = filter a by x == 3;"+ "c1 = foreach c generate y, x;"+ "c2 = foreach c generate y, x;"+ "c3 = union c1, c2;"+ "a1 = union onschema b3, c3;"+ "store a1 into 'file:///tmp/output1';"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join a1 by x, d by x using 'skewed';"+ "store e into 'file:///tmp/output2';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-12.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-12-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSelfJoin() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = filter a by x < 5;" + "c = filter a by x == 10;"+ "d = filter a by x > 10;"+ "e = join b by x, c by x, d by x;"+ "store e into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SelfJoin-1.gld");
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp() throws ExecException {
  resetScope();
  pc.getProperties().remove(PigConfiguration.PIG_OPT_MULTIQUERY);
  pc.getProperties().remove(PigConfiguration.PIG_TEZ_OPT_UNION);
  pc.getProperties().remove(PigConfiguration.PIG_EXEC_NO_SECONDARY_KEY);
  pigServer=new PigServer(pc);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testFilter() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = filter a by x > 0;" + "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Filter-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiQueryWithGroupBy() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = group a by x;" + "b = foreach b generate group, COUNT(a.x);"+ "c = group a by (x,y);"+ "c = foreach c generate group, COUNT(a.y);"+ "store b into 'file:///tmp/output/b';"+ "store c into 'file:///tmp/output/c';";
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-3.gld");
  setProperty(PigConfiguration.PIG_OPT_MULTIQUERY,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-MQ-3-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderBy() throws Exception {
  String query="a = load 'file:///tmp/input' using PigStorage(',') as (x:int, y:int);" + "b = order a by x;" + "STORE b INTO 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Order-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedJoin() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = load 'file:///tmp/input2' as (x:int, z:int);" + "c = join a by x, b by x using 'skewed';"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SkewJoin-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLimitOrderby() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:int);" + "b = order a by x, y;" + "c = limit b 10;"+ "store c into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Limit-2.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRank() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "b = rank a;" + "store b into 'file:///tmp/output/d';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Rank-1.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSkewedJoinFilter() throws Exception {
  String query="a = load 'file:///tmp/input1' as (x:int, y:int);" + "a = filter a by x == 1;" + "b = load 'file:///tmp/input2' as (x:int, z:int);"+ "c = join a by x, b by x using 'skewed';"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-SkewJoin-2.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionSplitSkewedJoin() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join c by x, d by x using 'skewed';"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-15.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-15-OPTOFF.gld");
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = filter a by x == 2;" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = join d by x, c by x using 'skewed';"+ "store e into 'file:///tmp/output';";
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-16.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-16-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionScalar() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = filter c by x == d.x;"+ "store e into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-17.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-17-OPTOFF.gld");
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "d = load 'file:///tmp/input1' as (x:int, z:chararray);"+ "e = filter d by x == c.x;"+ "store e into 'file:///tmp/output';";
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-18.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + false);
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-18-OPTOFF.gld");
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnionUnSupportedStore() throws Exception {
  String query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "store c into 'file:///tmp/output';";
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION,"" + true);
  String oldSupported=getProperty(PigConfiguration.PIG_TEZ_OPT_UNION_SUPPORTED_STOREFUNCS);
  String oldUnSupported=getProperty(PigConfiguration.PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS);
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS,PigStorage.class.getName());
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-1-OPTOFF.gld");
  resetScope();
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS,null);
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_SUPPORTED_STOREFUNCS,OrcStorage.class.getName());
  query="a = load 'file:///tmp/input' as (x:int, y:chararray);" + "b = load 'file:///tmp/input' as (y:chararray, x:int);" + "c = union onschema a, b;"+ "store c into 'file:///tmp/output' using " + DummyStoreWithOutputFormat.class.getName() + "();";
  run(query,"test/org/apache/pig/test/data/GoldenFiles/tez/TEZC-Union-1-DummyStore-OPTOFF.gld");
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_SUPPORTED_STOREFUNCS,oldSupported);
  setProperty(PigConfiguration.PIG_TEZ_OPT_UNION_UNSUPPORTED_STOREFUNCS,oldUnSupported);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
