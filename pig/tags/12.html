<h3><span class=" glyphicon glyphicon-tag"/>&nbspExceptionVerifier</h3><kbd>Verifies that exceptions are thrown during the test case execution</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloColumns </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
"></span><br>
@Test(expected=NullPointerException.class) public void testNull(){
  new Column(null);
}

</code></pre>

<br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testBlankColfamQual(){
  new Column(":");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloStorage </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ClassCastException.class) public void testWriteLiteralAsMapWithAsterisk() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("*");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,"value");
  storage.getMutations(t).size();
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ClassCastException.class) public void testWriteLiteralAsMap() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage();
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,"value");
  storage.getMutations(t).size();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestLogicalPlanGenerator </h4><pre class="type-4 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=MismatchedTokenException.class) public void testNegative3() throws Exception {
  String query="A = load 'y'; all = load 'x';";
  try {
    ParserTestingUtils.generateLogicalPlan(query);
  }
 catch (  Exception ex) {
    MismatchedTokenException mex=(MismatchedTokenException)ex;
    assertTrue(mex.token.getText().equals("all"));
    throw ex;
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NonProjectExpressionException.class) public void testNegative1() throws Exception {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );" + "B = foreach A { S = c * 2; T = limit S 100; generate T; };" + "store B into 'y';";
  ParserTestingUtils.generateLogicalPlan(query);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=MismatchedTokenException.class) public void testNegative2() throws Exception {
  String query="ship = load 'x';";
  try {
    ParserTestingUtils.generateLogicalPlan(query);
  }
 catch (  Exception ex) {
    MismatchedTokenException mex=(MismatchedTokenException)ex;
    assertTrue(mex.token.getText().equals("ship"));
    throw ex;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestQueryParser </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative3() throws IOException, RecognitionException {
  shouldFail("A = load 'x';B = (A) as (a:int, b:long);");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative3() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x (a, b, c);";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative5() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x by (a, b, c), CUBE(c);";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative2() throws IOException, RecognitionException {
  shouldFail("A = load 'x'; B=(A);");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative4() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x by (a, b, c), UDF(c);";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative5() throws IOException, RecognitionException {
  shouldFail("A = load 'x'; D = group A by $0:long;");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative1() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "cube = cube x by (a, b, c);";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative4() throws IOException, RecognitionException {
  shouldFail("A = load 'x'; B = ( filter A by $0 == 0 ) as (a:bytearray, b:long);");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative2() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x by a, b, c;";
  shouldFail(query);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testNegative6() throws IOException, RecognitionException {
  shouldFail("A = load '/Users/gates/test/data/studenttab10'; B = foreach A generate $0, 3.0e10.1;");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RecognitionException.class) public void testCubeNegative6() throws IOException, RecognitionException {
  String query="x = load 'cubedata' as (a, b, c, d); " + "y = cube x by CUBE(a, b, c), y, ROLLUP(c);";
  shouldFail(query);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestStuff </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testNegativeNumCharsToDelete() throws IOException {
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,"Replace me now!");
  t.set(1,0);
  t.set(2,-2);
  t.set(3,"test");
  udf.exec(t);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testIndexOutOfBounds() throws IOException {
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,"Replace me now!");
  t.set(1,-1);
  t.set(2,2);
  t.set(3,"test");
  udf.exec(t);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testArgumentCountMismatch() throws IOException {
  Tuple t=TupleFactory.getInstance().newTuple(1);
  t.set(0,"some_val");
  udf.exec(t);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestFixedWidthLoader </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void doesNotSupportObjectTypes() throws IOException, ParseException {
  pig.registerQuery("data = load '" + dataDir + testFile+ "' "+ "using org.apache.pig.piggybank.storage.FixedWidthLoader("+ "'-5, 9-21, 25-29, 33-40, 44, 48-52, 55-74, 78-82, 83-90', 'SKIP_HEADER', 'i: (j: int, k: int)'"+ ");");
  Iterator<Tuple> data=pig.openIterator("data");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void columnEndLessThanStart() throws IOException, ParseException {
  pig.registerQuery("data = load '" + dataDir + testFile+ "' "+ "using org.apache.pig.piggybank.storage.FixedWidthLoader("+ "'5-0', 'SKIP_HEADER', 'i: int'"+ ");");
  Iterator<Tuple> data=pig.openIterator("data");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void fewerColumnsThanSchemaFields() throws IOException, ParseException {
  pig.registerQuery("data = load '" + dataDir + testFile+ "' "+ "using org.apache.pig.piggybank.storage.FixedWidthLoader("+ "'1-5, 9-21, 25-29, 33-40', 'SKIP_HEADER', 'i: int, l: long, f: float, d: double, bit: int, c: chararray, b: bytearray') "+ ");");
  Iterator<Tuple> data=pig.openIterator("data");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void columnStartsAtZero() throws IOException, ParseException {
  pig.registerQuery("data = load '" + dataDir + testFile+ "' "+ "using org.apache.pig.piggybank.storage.FixedWidthLoader("+ "'0-5', 'SKIP_HEADER', 'i: int'"+ ");");
  Iterator<Tuple> data=pig.openIterator("data");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAssert </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verify that alias is not assignable to the ASSERT operator
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testNegativeWithAlias() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3));
  try {
    pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
    pigServer.registerQuery("B = ASSERT A BY i > 1 , 'i should be greater than 1';");
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,"Syntax error, unexpected symbol at or near 'B'");
    throw fe;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBlackAndWhitelistValidator </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is to test the script fails when used with {@link PigServer}, which
 * uses {@link QueryParser} and not the {@link GruntParser}
 */
@Test(expected=FrontendException.class) public void testWhitelistWithPigServer() throws Exception {
  ctx.getProperties().setProperty(PigConfiguration.PIG_WHITELIST,"load");
  PigServer pigServer=new PigServer(ctx);
  Data data=resetData(pigServer);
  data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);");
  pigServer.registerQuery("B = order A by f1,f2,f3 DESC;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test mkdirs fails if its disallowed via the blacklist
 */
@Test(expected=FrontendException.class) public void testBlacklistMkdirWithPigServer() throws Exception {
  ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"mkdir");
  PigServer pigServer=new PigServer(ctx);
  pigServer.mkdirs("foo");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is to test the script fails when used with {@link PigServer}, which
 * uses {@link QueryParser} and not the {@link GruntParser}
 */
@Test(expected=FrontendException.class) public void testBlacklistWithPigServer() throws Exception {
  ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"order");
  PigServer pigServer=new PigServer(ctx);
  Data data=resetData(pigServer);
  data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);");
  pigServer.registerQuery("B = order A by f1,f2,f3 DESC;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test deleteFile fails if its disallowed via the blacklist
 */
@Test(expected=FrontendException.class) public void testBlacklistRemoveWithPigServer() throws Exception {
  ctx.getProperties().setProperty(PigConfiguration.PIG_BLACKLIST,"rm");
  PigServer pigServer=new PigServer(ctx);
  pigServer.deleteFile("foo");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBloom </h4><pre class="type-4 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=RuntimeException.class) public void testBadHash() throws Exception {
  String size="100";
  String numHash="3";
  String hashFunc="nosuchhash";
  try {
    BuildBloom bb=new BuildBloom(hashFunc,"fixed",size,numHash);
  }
 catch (  RuntimeException re) {
    assertTrue(re.getMessage().contains("Unknown hash type"));
    throw re;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltInBagToTupleOrString </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=org.apache.pig.backend.executionengine.ExecException.class) public void testInvalidInputToBagToTupleUDF() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,tf.newTuple());
  BagToTuple udf=new BagToTuple();
  udf.exec(udfInput);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=org.apache.pig.backend.executionengine.ExecException.class) public void testInvalidInputForBagToStringUDF() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple udfInput=tf.newTuple(1);
  udfInput.set(0,tf.newTuple());
  BagToString udf=new BagToString();
  udf.exec(udfInput);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=java.lang.RuntimeException.class) public void testInvalidZeroInputToOutputSchemaForBagToTupleStringUDF() throws Exception {
  Schema inputSch=new Schema();
  BagToString udf=new BagToString();
  Schema outputSchema=udf.outputSchema(inputSch);
  assertEquals("schema of BagToTuple input",outputSchema.getField(0).type,DataType.CHARARRAY);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=java.lang.RuntimeException.class) public void testInvalidOutputSchemaForBagToTupleStringUDF() throws Exception {
  FieldSchema tupSch=new FieldSchema(null,DataType.TUPLE);
  tupSch.schema=new Schema();
  tupSch.schema.add(new FieldSchema(null,DataType.INTEGER));
  tupSch.schema.add(new FieldSchema(null,DataType.CHARARRAY));
  FieldSchema bagSch=new FieldSchema(null,DataType.BAG);
  bagSch.schema=new Schema(tupSch);
  Schema inputSch=new Schema();
  inputSch.add(bagSch);
  inputSch.add(new FieldSchema(null,DataType.DOUBLE));
  BagToString udf=new BagToString();
  udf.outputSchema(inputSch);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCase </h4><pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when case expression is missing,
 * and when branches do not contain conditional expressions.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingCaseExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE " + "    WHEN 0 THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when when expression is missing.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingWhenExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE i % 3" + "    WHEN   THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when when expression is missing.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingElseExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE i % 3" + "    WHEN 0 THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE "+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when when expression is missing.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingThenExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE i % 3" + "    WHEN 0 THEN "+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCmdLineParser </h4><pre class="type-6 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParseException.class) public void testParseUnknownShort() throws Exception {
  String[] args={"-alpha","b","-z"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  try {
    p.getNextOpt();
    assertEquals("b",p.getValStr());
    p.getNextOpt();
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Found unknown option (-z) at position 3");
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParseException.class) public void testParseValueRequiredNotProvided2() throws Exception {
  String[] args={"--alpha","-b"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  p.registerOpt('b',"beta",CmdLineParser.ValueExpected.NOT_ACCEPTED);
  try {
    p.getNextOpt();
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Option --alpha requires a value but you did not provide one.");
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParseException.class) public void testParseUnknownLong() throws Exception {
  String[] args={"--zeta"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  try {
    p.getNextOpt();
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Found unknown option (--zeta) at position 1");
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParseException.class) public void testParseValueRequiredNotProvided1() throws Exception {
  String[] args={"-a"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  try {
    p.getNextOpt();
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Option -a requires a value but you did not provide one.");
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NumberFormatException.class) public void testParseValueStrForInt() throws ParseException {
  String[] args={"-alpha","b"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  p.getNextOpt();
  Integer ii=p.getValInt();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataModel </h4><pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testIntegerConversionErr() throws Exception {
  List list=new ArrayList();
  try {
    DataType.toInteger(list);
  }
 catch (  ExecException ee) {
    assertEquals(1071,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testDetermineFieldSchemaErr() throws Exception {
  List list=new ArrayList();
  try {
    DataType.determineFieldSchema(list);
    fail("Error expected.");
  }
 catch (  ExecException ee) {
    assertEquals(1073,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testTupleConversionErr() throws Exception {
  List list=new ArrayList();
  try {
    DataType.toTuple(list);
  }
 catch (  ExecException ee) {
    assertEquals(1071,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testIntegerConversionErr1() throws Exception {
  DataByteArray ba=new DataByteArray("hello world");
  try {
    DataType.toInteger(ba);
  }
 catch (  ExecException ee) {
    assertEquals(1074,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testMapConversionErr() throws Exception {
  List list=new ArrayList();
  try {
    DataType.toMap(list);
  }
 catch (  ExecException ee) {
    assertEquals(1071,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testTupleConversionErr1() throws Exception {
  DataByteArray ba=new DataByteArray("hello world");
  try {
    DataType.toTuple(ba);
  }
 catch (  ExecException ee) {
    assertEquals(1071,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestIn </h4><pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that IN operator throws FrontendException when no operand is given.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingRhsOperand() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FILTER A BY i IN ();");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown since no rhs operand is given to IN.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInputOutputFileValidator </h4><pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case to test that Input output file validation catches the case
 * where the output file exists when using{@link PigServer#store(String,String)}
 * @throws Exception
 */
@Test(expected=PigException.class) public void testPigServerStoreNeg() throws Exception {
  String input="input.txt";
  String output="output.txt";
  String data[]=new String[]{"hello\tworld"};
  try {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
    Util.createInputFile(pig.getPigContext(),input,data);
    Util.createInputFile(pig.getPigContext(),output,data);
    try {
      pig.registerQuery("a = load '" + input + "';");
      pig.store("a",output);
    }
 catch (    Exception e) {
      assertEquals(6000,LogUtils.getPigException(e).getErrorCode());
      throw e;
    }
  }
  finally {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=VisitorException.class) public void testLocalModeNegative2() throws Throwable {
  String inputfile=generateTempFile().getAbsolutePath();
  String outputfile=generateTempFile().getAbsolutePath();
  LogicalPlan plan=genNewLoadStorePlan(inputfile,outputfile,ctx.getDfs());
  InputOutputFileValidatorVisitor visitor=new InputOutputFileValidatorVisitor(plan,ctx);
  visitor.visit();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInputOutputMiniClusterFileValidator </h4><pre class="type-9 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case to test that Input output file validation catches the case
 * where the output file exists when using{@link PigServer#store(String,String)}
 * @throws Exception
 */
@Test(expected=PigException.class) public void testPigServerStoreNeg() throws Exception {
  String input="input.txt";
  String output="output.txt";
  String data[]=new String[]{"hello\tworld"};
  try {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
    Util.createInputFile(pig.getPigContext(),input,data);
    Util.createInputFile(pig.getPigContext(),output,data);
    try {
      pig.registerQuery("a = load '" + input + "';");
      pig.store("a",output);
      fail("Expected exception to be caught");
    }
 catch (    Exception e) {
      assertEquals(6000,LogUtils.getPigException(e).getErrorCode());
      throw e;
    }
  }
  finally {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLimitVariable </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testLimitVariableException1() throws Throwable {
  String query="a = load '" + inputFile.getName() + "';"+ "b = group a all;"+ "c = foreach b generate COUNT(a) as sum;"+ "d = order a by $0 DESC;"+ "e = limit d $0;";
  Util.registerMultiLineQuery(pigServer,query);
  try {
    pigServer.openIterator("e");
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,ScalarVariableValidator.ERR_MSG_SCALAR);
    throw fe;
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testLimitVariableException2() throws Throwable {
  String query="a = load '" + inputFile.getName() + "' as (id:int, num:chararray);"+ "b = filter a by num == '3';"+ "c = foreach b generate num as falsenum;"+ "d = order a by id DESC;"+ "e = limit d c.falsenum;";
  Util.registerMultiLineQuery(pigServer,query);
  try {
    pigServer.openIterator("e");
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,"Limit's expression must evaluate to Long or Integer");
    throw fe;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLoadFunc </h4><pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testCommaSeparatedString8() throws Exception {
  Assert.assertEquals(curHdfsRoot + "/user/pig/," + curHdfsRoot+ "/test/data/b",LoadFunc.getAbsolutePath(", /test/data/b",curHdfsDir));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRCompiler </h4><pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=MRCompilerException.class) public void testMRCompilerErr() throws Exception {
  String query="a = load 'input';" + "b = filter a by $0 > 5;" + "store b into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  pp.remove(pp.getRoots().get(0));
  try {
    Util.buildMRPlan(new PhysicalPlan(),pc);
  }
 catch (  MRCompilerException mrce) {
    assertEquals(2053,mrce.getErrorCode());
    throw mrce;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=MRCompilerException.class) public void testMRCompilerErr1() throws Exception {
  PhysicalPlan pp=new PhysicalPlan();
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  pp.merge(ldFil1);
  POSplit op=GenPhyOp.topSplitOp();
  pp.addAsLeaf(op);
  try {
    Util.buildMRPlan(pp,pc);
  }
 catch (  MRCompilerException mrce) {
    assertEquals(2025,mrce.getErrorCode());
    throw mrce;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRExecutionEngine </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ExecException.class) public void testJobConfGeneration() throws ExecException {
  Configuration conf=new Configuration(false);
  conf.set("foo","bar");
  PigContext pigContext=new PigContext(ExecType.MAPREDUCE,conf);
  pigContext.connect();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRJobStats </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=RuntimeException.class) public void testGetOuputSizeUsingNonFileBasedStorage3() throws Exception {
  Configuration conf=new Configuration();
  conf.set(PigStatsOutputSizeReader.OUTPUT_SIZE_READER_KEY,"bad_output_size_reader");
  UDFContext.getUDFContext().setClientSystemProps(new Properties());
  JobStats.getOutputSize(createPOStoreForNonFileBasedSystem(new HBaseStorage("colName"),conf),conf);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanOperatorPlan </h4><pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testRemove6() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator load2=new SillyOperator("load2",plan);
  Operator fake1=new SillyOperator("fake1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(load2);
  plan.add(fake1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,fake1);
  plan.connect(load2,fake1);
  plan.connect(fake1,filter1);
  plan.connect(fake1,filter2);
  try {
    plan.removeAndReconnect(fake1);
  }
 catch (  FrontendException e) {
    assertEquals(2256,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNullConstant </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testMapNullKeyFailure() throws IOException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(10,11.0,"will_join"));
  pigServer.registerQuery("a = load 'foo' using mock.Storage() as (x:int, y:double, str:chararray);");
  pigServer.registerQuery("b = foreach a generate [null#'2'];");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParser </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IOException.class) public void testLoadingNonexistentFile() throws Exception {
  for (  ExecType execType : execTypes) {
    setUp(execType);
    pigServer.registerQuery("vals = load 'nonexistentfile';");
    pigServer.openIterator("vals");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigScriptParser </h4><pre class="type-4 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testErrorMessageUndefinedAliasInGroupByStatement() throws Exception {
  String queryA="A = load 'nosuchfile'  using PigStorage() as (f1:chararray,f2:chararray);";
  String queryB="B = GROUP B by f1;";
  PigServer ps=new PigServer(ExecType.LOCAL);
  ps.registerQuery(queryA);
  try {
    ps.registerQuery(queryB);
  }
 catch (  FrontendException e) {
    assertTrue(e.getMessage().contains("Undefined alias:"));
    throw e;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServerLocal </h4><pre class="type-7 type-6 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=RuntimeException.class) public void testLocationStrictCheck() throws Exception {
  Properties properties=PropertiesUtil.loadDefaultProperties();
  properties.setProperty("pig.location.check.strict","true");
  PigServer pigServer=new PigServer(Util.getLocalTestMode(),properties);
  Data data=resetData(pigServer);
  data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);");
  pigServer.registerQuery("B = order A by f1,f2,f3 DESC;");
  pigServer.registerQuery("C = order A by f1,f2,f3;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  pigServer.registerQuery("STORE C INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a",1,"b"),out.get(0));
  assertEquals(tuple("b",2,"c"),out.get(1));
  assertEquals(tuple("c",3,"d"),out.get(2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStorage </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=Exception.class) public void testPigStorageSchemaFailureWithoutOverwrite() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage(',')");
  pig.store("a",datadir + "aout","PigStorage(',')");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRegisterParser </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ParserException.class) public void testIllegalUriException() throws IOException, ParserException {
  new RegisterResolver(pigServer).parseRegister("ivy:||org:mod:ver",null,null);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ParserException.class) public void testRegisterJarException3() throws IOException, ParserException {
  new RegisterResolver(pigServer).parseRegister("test.jar","jython",null);
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ParserException.class) public void testRegisterJarException2() throws IOException, ParserException {
  new RegisterResolver(pigServer).parseRegister("ivy://org:mod:ver","jython","myfunc");
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=ParserException.class) public void testRegisterJarException1() throws IOException, ParserException {
  new RegisterResolver(pigServer).parseRegister("test.jar","jython","myfunc");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestResourceSchema </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test invalid Resource Schema: multiple fields for a bag
 * @throws IOException 
 */
@Test(expected=FrontendException.class) public void testToPigSchemaWithInvalidSchema() throws IOException {
  ResourceFieldSchema[] level0=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("fld0").setType(DataType.CHARARRAY),new ResourceFieldSchema().setName("fld1").setType(DataType.DOUBLE),new ResourceFieldSchema().setName("fld2").setType(DataType.INTEGER)};
  ResourceSchema rSchema0=new ResourceSchema().setFields(level0);
  ResourceFieldSchema[] level2=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t2").setType(DataType.BAG).setSchema(rSchema0)};
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test invalid Resource Schema: bag without tuple field
 * @throws IOException 
 */
@Test(expected=FrontendException.class) public void testToPigSchemaWithInvalidSchema2() throws IOException {
  ResourceFieldSchema[] level0=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("fld0").setType(DataType.CHARARRAY)};
  ResourceSchema rSchema0=new ResourceSchema().setFields(level0);
  ResourceFieldSchema[] level2=new ResourceFieldSchema[]{new ResourceFieldSchema().setName("t2").setType(DataType.BAG).setSchema(rSchema0)};
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSample </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testSampleScalarException() throws IOException {
  String query="a = load '" + Util.encodeEscape(tmpfilepath) + "';"+ "b = sample a $0;";
  Util.registerMultiLineQuery(pig,query);
  try {
    pig.openIterator("b");
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,ScalarVariableValidator.ERR_MSG_SCALAR);
    throw fe;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSchema </h4><pre class="type-7 type-9 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeMismatchType1() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:long, c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:bytearray, c1:long"));
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
    fail();
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
  }
  try {
    LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeDifferentSize1() throws Throwable {
  LogicalSchema a=Utils.parseSchema("a1:bytearray, b1:long, c1:long");
  LogicalSchema b=Utils.parseSchema("a2:bytearray, b2:long");
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  assertNull(mergedSchema);
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeMismatchType2() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:(b11:double, b12:(b121:int)), c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:(), c1:long"));
  expected.getField(1).schema=new LogicalSchema();
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
    fail();
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
  }
  try {
    LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeDifferentSize2() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:bytearray, b1:(b11:int, b12:float, b13:float), c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:bytearray, b1:(), c1:long"));
  expected.getField(1).schema=new LogicalSchema();
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=SchemaMergeException.class) public void testMergeDifferentSize2() throws Throwable {
  List<FieldSchema> list1=new ArrayList<FieldSchema>();
  list1.add(new FieldSchema("1a",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1b",DataType.BYTEARRAY));
  list1.add(new FieldSchema("1c",DataType.LONG));
  List<FieldSchema> list2=new ArrayList<FieldSchema>();
  list2.add(new FieldSchema("2a",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2b",DataType.BYTEARRAY));
  list2.add(new FieldSchema("2c",DataType.INTEGER));
  list2.add(new FieldSchema("2d",DataType.MAP));
  Schema schema1=new Schema(list1);
  Schema schema2=new Schema(list2);
  Schema mergedSchema=Schema.mergeSchema(schema1,schema2,true,false,false);
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParserException.class) public void testGetStringFromSchemaNegative() throws Exception {
  String schemaString="a:int b:long";
  Utils.getSchemaFromString(schemaString);
  fail("The schema string is invalid, so parsing should fail!");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestShortcuts </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is defined, exception is expected
 * @throws Throwable
 */
@Test(expected=ParseException.class) public void testIllustrateShortcutNoAliasDefined() throws Throwable {
  String cmd="\\i";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is define, then exception is expected
 * @throws Throwable
 */
@Test(expected=IOException.class) public void testDescribeShortcutNoAliasDefined() throws Throwable {
  String cmd="\\de";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * When no alias is defined, exception is expected
 * @throws Throwable
 */
@Test(expected=IOException.class) public void testDumpShortcutNoAliasDefined() throws Throwable {
  String cmd="\\d";
  ByteArrayInputStream cmdstream=new ByteArrayInputStream(cmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmdstream);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSkewedJoin </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testSkewedJoin3Way() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' as (id, name, n);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' as (id, name);");
  pigServer.registerQuery("C = LOAD '" + INPUT_FILE3 + "' as (id, name);");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("D = join A by id, B by id, C by id using 'skewed' parallel 5;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext())   dbfrj.add(iter.next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSplit </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testSplitNondeterministic() throws IOException {
  String query="a = load '" + Util.encodeEscape(file.getAbsolutePath()) + "' as (id:int);"+ "split a into b if RANDOM() < 0.5, d otherwise;";
  try {
    Util.registerMultiLineQuery(pig,query);
  }
 catch (  FrontendException fe) {
    Util.checkMessageInException(fe,"Can not use Otherwise in Split with an expression containing a @Nondeterministic UDF");
    throw fe;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypeCheckingValidatorNewLP </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=TypeCheckerException.class) public void testRegexTypeChecking3() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,10);
  ConstantExpression constant2=new ConstantExpression(plan,"Regex");
  RegexExpression regex=new RegexExpression(plan,constant1,constant2);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,null);
  expTypeChecker.visit();
  printMessageCollector(collector);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDF </h4><pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=FrontendException.class) public void testEnsureProperSchema2() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  pig.registerQuery("DEFINE badSchema org.apache.pig.test.TestUDF$MirrorSchema('a:int, b:int, c:int');");
  pig.registerQuery("a = load 'thing';");
  pig.registerQuery("b = foreach a generate badSchema();");
  pig.dumpSchema("b");
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
