<h3><span class=" glyphicon glyphicon-tag"/>&nbspHybridVerifier</h3><kbd>Contains more than 2 JUnit-based stereotypes</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.pig.TestLoadFuncMetadataWrapper </h4><pre class="type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testError() throws IOException {
  MockWrapper wrapper=new MockWrapper();
  IllegalArgumentException e=null;
  try {
    wrapper.getSchema(null,null);
  }
 catch (  IllegalArgumentException ex) {
    e=ex;
  }
  assertNotNull("A useful exception should have been thrown when a method is called on an " + "improperly initialized LoadFuncMetadataWrapper",e);
  assertTrue("The method name that caused the problem should have been mentioned in the " + "exception, since the stack trace gets swallowed when this occurs",e.getMessage().contains("getSchema"));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyLoadMetadata loadFunc=new DummyLoadMetadata();
  MockWrapper wrapper=new MockWrapper(loadFunc);
  wrapper.getSchema(null,null);
  assertEquals("getSchema",loadFunc.getLastMethodCalled());
  wrapper.getStatistics(null,null);
  assertEquals("getStatistics",loadFunc.getLastMethodCalled());
  wrapper.getPartitionKeys(null,null);
  assertEquals("getPartitionKeys",loadFunc.getLastMethodCalled());
  wrapper.setPartitionFilter(null);
  assertEquals("setPartitionFilter",loadFunc.getLastMethodCalled());
  wrapper.relativeToAbsolutePath(null,null);
  assertEquals("relativeToAbsolutePath",loadFunc.getLastMethodCalled());
  wrapper.setLocation(null,null);
  assertEquals("setLocation",loadFunc.getLastMethodCalled());
  wrapper.getInputFormat();
  assertEquals("getInputFormat",loadFunc.getLastMethodCalled());
  wrapper.getLoadCaster();
  assertEquals("getLoadCaster",loadFunc.getLastMethodCalled());
  wrapper.prepareToRead(null,null);
  assertEquals("prepareToRead",loadFunc.getLastMethodCalled());
  wrapper.getNext();
  assertEquals("getNext",loadFunc.getLastMethodCalled());
  wrapper.setUDFContextSignature(null);
  assertEquals("setUDFContextSignature",loadFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    loadFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestLoadFuncWrapper </h4><pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyLoadFunc loadFunc=new DummyLoadFunc();
  MockWrapper wrapper=new MockWrapper(loadFunc);
  wrapper.relativeToAbsolutePath(null,null);
  assertEquals("relativeToAbsolutePath",loadFunc.getLastMethodCalled());
  wrapper.setLocation(null,null);
  assertEquals("setLocation",loadFunc.getLastMethodCalled());
  wrapper.getInputFormat();
  assertEquals("getInputFormat",loadFunc.getLastMethodCalled());
  wrapper.getLoadCaster();
  assertEquals("getLoadCaster",loadFunc.getLastMethodCalled());
  wrapper.prepareToRead(null,null);
  assertEquals("prepareToRead",loadFunc.getLastMethodCalled());
  wrapper.getNext();
  assertEquals("getNext",loadFunc.getLastMethodCalled());
  wrapper.setUDFContextSignature(null);
  assertEquals("setUDFContextSignature",loadFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    loadFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testError() throws IOException {
  MockWrapper wrapper=new MockWrapper();
  IllegalArgumentException e=null;
  try {
    wrapper.getInputFormat();
  }
 catch (  IllegalArgumentException ex) {
    e=ex;
  }
  assertNotNull("A useful exception should have been thrown when a method is called on an " + "improperly initialized LoadFuncWrapper",e);
  assertTrue("The method name that caused the problem should have been mentioned in the " + "exception, since the stack trace gets swallowed when this occurs",e.getMessage().contains("getInputFormat"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestLoadStoreFuncLifeCycle </h4><pre class="type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadStoreFunc() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=Storage.resetData(pigServer.getPigContext());
  data.set("foo",tuple("a"),tuple("b"),tuple("c"));
  pigServer.registerQuery("A = LOAD 'foo' USING " + TestLoadStoreFuncLifeCycle.class.getName() + "$Loader();\n"+ "STORE A INTO 'bar' USING "+ TestLoadStoreFuncLifeCycle.class.getName()+ "$Storer();");
  List<Tuple> out=data.get("bar");
  assertEquals("a",out.get(0).get(0));
  assertEquals("b",out.get(1).get(0));
  assertEquals("c",out.get(2).get(0));
  assertTrue("loader instanciation count increasing: " + Loader.count,Loader.count <= 3);
  if (Util.getLocalTestMode().toString().startsWith("TEZ")) {
    assertTrue("storer instanciation count increasing: " + Storer.count,Storer.count == 6);
    return;
  }
 else {
    assertTrue("storer instanciation count increasing: " + Storer.count,Storer.count <= (org.apache.pig.impl.util.Utils.isHadoop2() ? 5 : 4));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestMain </h4><pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testlog4jConf() throws Exception {
  Properties properties=Main.log4jConfAsProperties(null);
  assertTrue(properties.isEmpty());
  properties=Main.log4jConfAsProperties("");
  assertTrue(properties.isEmpty());
  properties=Main.log4jConfAsProperties("non-existing-" + System.currentTimeMillis());
  assertTrue(properties.isEmpty());
  File tmpFile=File.createTempFile("pig-log4jconf",".properties",new File("build/test/classes"));
  tmpFile.deleteOnExit();
  Files.write("A=B",tmpFile,Charset.forName("UTF-8"));
  properties=Main.log4jConfAsProperties(tmpFile.getName());
  assertEquals("B",properties.getProperty("A"));
  properties=Main.log4jConfAsProperties(tmpFile.getAbsolutePath());
  assertEquals("B",properties.getProperty("A"));
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun_setsErrorThrowableOnPigStats(){
  File outputFile=null;
  try {
    String filename=this.getClass().getSimpleName() + "_" + "testRun_setsErrorThrowableOnPigStats";
    outputFile=File.createTempFile(filename,".out");
    outputFile.delete();
    File scriptFile=File.createTempFile(filename,".pig");
    BufferedWriter bw=new BufferedWriter(new FileWriter(scriptFile));
    bw.write("a = load 'test/org/apache/pig/test/data/passwd';\n");
    bw.write("b = group a by $0\n");
    bw.write("c = foreach b generate group, COUNT(a) as cnt;\n");
    bw.write("store c into 'out'\n");
    bw.close();
    Main.run(new String[]{"-x","local",scriptFile.getAbsolutePath()},null);
    PigStats stats=PigStats.get();
    Throwable t=stats.getErrorThrowable();
    assertTrue(t instanceof FrontendException);
    FrontendException fe=(FrontendException)t;
    SourceLocation sl=fe.getSourceLocation();
    assertEquals(2,sl.line());
    assertEquals(15,sl.offset());
    Throwable cause=fe.getCause();
    assertTrue(cause instanceof ParserException);
  }
 catch (  Exception e) {
    log.error("Encountered exception",e);
    fail("Encountered Exception");
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun_setsErrorThrowableForParamSubstitution(){
  File outputFile=null;
  try {
    String filename=this.getClass().getSimpleName() + "_" + "testRun_setsErrorThrowableForParamSubstitution";
    outputFile=File.createTempFile(filename,".out");
    outputFile.delete();
    File scriptFile=File.createTempFile(filename,".pig");
    BufferedWriter bw=new BufferedWriter(new FileWriter(scriptFile));
    bw.write("a = load '$NOEXIST';\n");
    bw.write("b = group a by $0\n");
    bw.write("c = foreach b generate group, COUNT(a) as cnt;\n");
    bw.write("store c into 'out'\n");
    bw.close();
    Main.run(new String[]{"-x","local",scriptFile.getAbsolutePath()},null);
    PigStats stats=PigStats.get();
    Throwable t=stats.getErrorThrowable();
    assertTrue(t instanceof IOException);
    Throwable cause=t.getCause();
    assertTrue(cause instanceof ParameterSubstitutionException);
    ParameterSubstitutionException pse=(ParameterSubstitutionException)cause;
    assertTrue(pse.getMessage().contains("NOEXIST"));
  }
 catch (  Exception e) {
    log.error("Encountered exception",e);
    fail("Encountered Exception");
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomListener(){
  Properties p=new Properties();
  p.setProperty(Main.PROGRESS_NOTIFICATION_LISTENER_KEY,TestNotificationListener2.class.getName());
  TestNotificationListener2 listener=(TestNotificationListener2)Main.makeListener(p);
  assertEquals(TestNotificationListener2.class,Main.makeListener(p).getClass());
  assertFalse(listener.hadArgs);
  p.setProperty(Main.PROGRESS_NOTIFICATION_LISTENER_ARG_KEY,"foo");
  listener=(TestNotificationListener2)Main.makeListener(p);
  assertEquals(TestNotificationListener2.class,Main.makeListener(p).getClass());
  assertTrue(listener.hadArgs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestStoreFuncMetadataWrapper </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyStoreMetadata storeFunc=new DummyStoreMetadata();
  MockWrapper wrapper=new MockWrapper(storeFunc);
  wrapper.storeSchema(null,null,null);
  assertEquals("storeSchema",storeFunc.getLastMethodCalled());
  wrapper.storeStatistics(null,null,null);
  assertEquals("storeStatistics",storeFunc.getLastMethodCalled());
  wrapper.relToAbsPathForStoreLocation(null,null);
  assertEquals("relToAbsPathForStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.getOutputFormat();
  assertEquals("getOutputFormat",storeFunc.getLastMethodCalled());
  wrapper.setStoreLocation(null,null);
  assertEquals("setStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.checkSchema(null);
  assertEquals("checkSchema",storeFunc.getLastMethodCalled());
  wrapper.prepareToWrite(null);
  assertEquals("prepareToWrite",storeFunc.getLastMethodCalled());
  wrapper.putNext(null);
  assertEquals("putNext",storeFunc.getLastMethodCalled());
  wrapper.setStoreFuncUDFContextSignature(null);
  assertEquals("setStoreFuncUDFContextSignature",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnSuccess(null,null);
  assertEquals("cleanupOnSuccess",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnFailure(null,null);
  assertEquals("cleanupOnFailure",storeFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    storeFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<pre class="type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testError() throws IOException {
  MockWrapper wrapper=new MockWrapper();
  IllegalArgumentException e=null;
  try {
    wrapper.storeSchema(null,null,null);
  }
 catch (  IllegalArgumentException ex) {
    e=ex;
  }
  assertNotNull("A useful exception should have been thrown when a method is called on an " + "improperly initialized StoreFuncMetadataWrapper",e);
  assertTrue("The method name that caused the problem should have been mentioned in the " + "exception, since the stack trace gets swallowed when this occurs",e.getMessage().contains("storeSchema"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.TestStoreFuncWrapper </h4><pre class="type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testError() throws IOException {
  MockWrapper wrapper=new MockWrapper();
  IllegalArgumentException e=null;
  try {
    wrapper.getOutputFormat();
  }
 catch (  IllegalArgumentException ex) {
    e=ex;
  }
  assertNotNull("A useful exception should have been thrown when a method is called on an " + "improperly initialized StoreFuncWrapper",e);
  assertTrue("The method name that caused the problem should have been mentioned in the " + "exception, since the stack trace gets swallowed when this occurs",e.getMessage().contains("getOutputFormat"));
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSucess() throws IOException {
  DummyStoreFunc storeFunc=new DummyStoreFunc();
  MockWrapper wrapper=new MockWrapper(storeFunc);
  wrapper.relToAbsPathForStoreLocation(null,null);
  assertEquals("relToAbsPathForStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.getOutputFormat();
  assertEquals("getOutputFormat",storeFunc.getLastMethodCalled());
  wrapper.setStoreLocation(null,null);
  assertEquals("setStoreLocation",storeFunc.getLastMethodCalled());
  wrapper.checkSchema(null);
  assertEquals("checkSchema",storeFunc.getLastMethodCalled());
  wrapper.prepareToWrite(null);
  assertEquals("prepareToWrite",storeFunc.getLastMethodCalled());
  wrapper.putNext(null);
  assertEquals("putNext",storeFunc.getLastMethodCalled());
  wrapper.setStoreFuncUDFContextSignature(null);
  assertEquals("setStoreFuncUDFContextSignature",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnSuccess(null,null);
  assertEquals("cleanupOnSuccess",storeFunc.getLastMethodCalled());
  wrapper.cleanupOnFailure(null,null);
  assertEquals("cleanupOnFailure",storeFunc.getLastMethodCalled());
  NoSuchElementException e=null;
  try {
    storeFunc.getLastMethodCalled();
  }
 catch (  NoSuchElementException ex) {
    e=ex;
  }
  assertNotNull("The wrapped class had more method invokations than it should have",e);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloPigCluster </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  loadTestData();
  final String loadFlights="flights = LOAD 'accumulo://flights?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String loadAirports="airports = LOAD 'accumulo://airports?instance=" + accumuloCluster.getInstanceName() + "&user=root&password=password&zookeepers="+ accumuloCluster.getZooKeepers()+ "' using org.apache.pig.backend.hadoop.accumulo.AccumuloStorage()"+ " as (rowKey:chararray, column_map:map[]);";
  final String joinQuery="joined = JOIN flights BY column_map#'origin', airports BY column_map#'code';";
  pig.registerQuery(loadFlights);
  pig.registerQuery(loadAirports);
  pig.registerQuery(joinQuery);
  Iterator<Tuple> it=pig.openIterator("joined");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Assert.assertEquals(4,t.size());
    Object o=t.get(1);
    Map<String,String> airport=null, flight=null;
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data1=(Map<String,String>)o;
    Assert.assertTrue(!data1.isEmpty());
    if (data1.containsKey("origin")) {
      flight=data1;
    }
 else     if (data1.containsKey("code")) {
      airport=data1;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    o=t.get(3);
    Assert.assertTrue(Map.class.isAssignableFrom(o.getClass()));
    @SuppressWarnings("unchecked") Map<String,String> data2=(Map<String,String>)o;
    Assert.assertTrue(!data2.isEmpty());
    if (null == flight && data2.containsKey("origin")) {
      flight=data2;
    }
 else     if (null == airport && data2.containsKey("code")) {
      airport=data2;
    }
 else {
      Assert.fail("Received map which did not contain an expected key");
    }
    Assert.assertTrue(null != airport && null != flight);
    Assert.assertEquals(airport.get("code"),flight.get("origin"));
    i++;
  }
  Assert.assertEquals(6,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloStorage </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteIgnoredExtraColumns() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col");
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,"value2");
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(1,colUpdates.size());
  ColumnUpdate colUpdate=colUpdates.get(0);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),new byte[0]));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value1".getBytes()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrite2TupleWithMixedColumns() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1,col1:qual,col2:qual,col2");
  Tuple t=TupleFactory.getInstance().newTuple(5);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,"value2");
  t.set(3,"value3");
  t.set(4,"value4");
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(4,colUpdates.size());
  ColumnUpdate colUpdate=colUpdates.get(0);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col1".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),new byte[0]));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value1".getBytes()));
  colUpdate=colUpdates.get(1);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col1".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),"qual".getBytes()));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value2".getBytes()));
  colUpdate=colUpdates.get(2);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col2".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),"qual".getBytes()));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value3".getBytes()));
  colUpdate=colUpdates.get(3);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col2".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),new byte[0]));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value4".getBytes()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrite2TupleWithColumn() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,"value");
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(1,colUpdates.size());
  ColumnUpdate colUpdate=colUpdates.get(0);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),new byte[0]));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value".getBytes()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteIgnoredExtraMap() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(1,colUpdates.size());
  ColumnUpdate update=colUpdates.get(0);
  Assert.assertEquals("col1",new String(update.getColumnFamily()));
  Assert.assertEquals("",new String(update.getColumnQualifier()));
  Assert.assertEquals("value1",new String(update.getValue()));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMultipleColumnsWithNonExpandedMap() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1,col2");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(2,colUpdates.size());
  ColumnUpdate update=colUpdates.get(0);
  Assert.assertEquals("col1",new String(update.getColumnFamily()));
  Assert.assertEquals("",new String(update.getColumnQualifier()));
  Assert.assertEquals("value1",new String(update.getValue()));
  update=colUpdates.get(1);
  Assert.assertEquals("col2",new String(update.getColumnFamily()));
  Assert.assertEquals("",new String(update.getColumnQualifier()));
  Assert.assertArrayEquals(storage.objToBytes(map,DataType.MAP),update.getValue());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrite2TupleWithColumnQual() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col:qual");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,"value");
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(1,colUpdates.size());
  ColumnUpdate colUpdate=colUpdates.get(0);
  Assert.assertTrue("CF not equal",Arrays.equals(colUpdate.getColumnFamily(),"col".getBytes()));
  Assert.assertTrue("CQ not equal",Arrays.equals(colUpdate.getColumnQualifier(),"qual".getBytes()));
  Assert.assertTrue("Values not equal",Arrays.equals(colUpdate.getValue(),"value".getBytes()));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMultipleColumnsWithExpandedMap() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col1,col2:");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(3);
  t.set(0,"row");
  t.set(1,"value1");
  t.set(2,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(5,colUpdates.size());
  ColumnUpdate update=colUpdates.get(0);
  Assert.assertEquals("col1",new String(update.getColumnFamily()));
  Assert.assertEquals("",new String(update.getColumnQualifier()));
  Assert.assertEquals("value1",new String(update.getValue()));
  Map<Entry<String,String>,String> expectations=Maps.newHashMap();
  expectations.put(Maps.immutableEntry("col2","mapcol1"),"mapval1");
  expectations.put(Maps.immutableEntry("col2","mapcol2"),"mapval2");
  expectations.put(Maps.immutableEntry("col2","mapcol3"),"mapval3");
  expectations.put(Maps.immutableEntry("col2","mapcol4"),"mapval4");
  for (int i=1; i < 5; i++) {
    update=colUpdates.get(i);
    Entry<String,String> key=Maps.immutableEntry(new String(update.getColumnFamily()),new String(update.getColumnQualifier()));
    String value=new String(update.getValue());
    Assert.assertTrue("Did not find expected key: " + key,expectations.containsKey(key));
    String actual=expectations.remove(key);
    Assert.assertEquals(value,actual);
  }
  Assert.assertTrue("Did not find all expectations",expectations.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMapWithColFamColQualPrefix() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col:qual_*");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(4,colUpdates.size());
  Map<Entry<String,String>,String> expectations=Maps.newHashMap();
  expectations.put(Maps.immutableEntry("col","qual_mapcol1"),"mapval1");
  expectations.put(Maps.immutableEntry("col","qual_mapcol2"),"mapval2");
  expectations.put(Maps.immutableEntry("col","qual_mapcol3"),"mapval3");
  expectations.put(Maps.immutableEntry("col","qual_mapcol4"),"mapval4");
  for (  ColumnUpdate update : colUpdates) {
    Entry<String,String> key=Maps.immutableEntry(new String(update.getColumnFamily()),new String(update.getColumnQualifier()));
    String value=new String(update.getValue());
    Assert.assertTrue(expectations.containsKey(key));
    String actual=expectations.remove(key);
    Assert.assertEquals(value,actual);
  }
  Assert.assertTrue("Did not find all expectations",expectations.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMapWithColFamWithColon() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col:");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(4,colUpdates.size());
  Map<Entry<String,String>,String> expectations=Maps.newHashMap();
  expectations.put(Maps.immutableEntry("col","mapcol1"),"mapval1");
  expectations.put(Maps.immutableEntry("col","mapcol2"),"mapval2");
  expectations.put(Maps.immutableEntry("col","mapcol3"),"mapval3");
  expectations.put(Maps.immutableEntry("col","mapcol4"),"mapval4");
  for (  ColumnUpdate update : colUpdates) {
    Entry<String,String> key=Maps.immutableEntry(new String(update.getColumnFamily()),new String(update.getColumnQualifier()));
    String value=new String(update.getValue());
    Assert.assertTrue("Did not find expected key: " + key,expectations.containsKey(key));
    String actual=expectations.remove(key);
    Assert.assertEquals(value,actual);
  }
  Assert.assertTrue("Did not find all expectations",expectations.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMapWithColFamWithColonAsterisk() throws IOException, ParseException {
  AccumuloStorage storage=new AccumuloStorage("col:*");
  Map<String,Object> map=Maps.newHashMap();
  map.put("mapcol1","mapval1");
  map.put("mapcol2","mapval2");
  map.put("mapcol3","mapval3");
  map.put("mapcol4","mapval4");
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,"row");
  t.set(1,map);
  Collection<Mutation> mutations=storage.getMutations(t);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.iterator().next();
  Assert.assertTrue("Rows not equal",Arrays.equals(m.getRow(),((String)t.get(0)).getBytes()));
  List<ColumnUpdate> colUpdates=m.getUpdates();
  Assert.assertEquals(4,colUpdates.size());
  Map<Entry<String,String>,String> expectations=Maps.newHashMap();
  expectations.put(Maps.immutableEntry("col","mapcol1"),"mapval1");
  expectations.put(Maps.immutableEntry("col","mapcol2"),"mapval2");
  expectations.put(Maps.immutableEntry("col","mapcol3"),"mapval3");
  expectations.put(Maps.immutableEntry("col","mapcol4"),"mapval4");
  for (  ColumnUpdate update : colUpdates) {
    Entry<String,String> key=Maps.immutableEntry(new String(update.getColumnFamily()),new String(update.getColumnQualifier()));
    String value=new String(update.getValue());
    Assert.assertTrue("Did not find expected key: " + key,expectations.containsKey(key));
    String actual=expectations.remove(key);
    Assert.assertEquals(value,actual);
  }
  Assert.assertTrue("Did not find all expectations",expectations.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.accumulo.TestAccumuloStorageConfiguration </h4><pre class="type-6 type-5 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore @Test public void testEquivalenceOnTypes(){
  Configuration unsetCopy=new Configuration(original), clearCopy=new Configuration(original);
  Assert.assertEquals(getContents(original),getContents(unsetCopy));
  Assert.assertEquals(getContents(original),getContents(clearCopy));
  Map<String,String> entriesToUnset=new HashMap<String,String>();
  entriesToUnset.put("long","foo");
  entriesToUnset.put("boolean","bar");
  entriesToUnset.put("integer","foobar");
  storage.simpleUnset(unsetCopy,entriesToUnset);
  storage.clearUnset(clearCopy,entriesToUnset);
  Configuration originalCopy=new Configuration();
  for (  Entry<String,String> entry : original) {
    if (!"long".equals(entry.getKey()) && !"boolean".equals(entry.getKey()) && !"integer".equals(entry.getKey())) {
      originalCopy.set(entry.getKey(),entry.getValue());
    }
  }
  Assert.assertEquals(getContents(originalCopy),getContents(unsetCopy));
  Assert.assertEquals(getContents(originalCopy),getContents(clearCopy));
}

</code></pre>

<br>
<pre class="type-6 type-5 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore @Test public void testUnsetEquivalenceStrings(){
  Configuration unsetCopy=new Configuration(original);
  Assert.assertEquals(getContents(original),getContents(unsetCopy));
  Map<String,String> entriesToUnset=new HashMap<String,String>();
  entriesToUnset.put("string1","foo");
  entriesToUnset.put("string3","bar");
  storage.simpleUnset(unsetCopy,entriesToUnset);
  Configuration originalCopy=new Configuration();
  for (  Entry<String,String> entry : original) {
    if (!"string1".equals(entry.getKey()) && !"string2".equals(entry.getKey())) {
      originalCopy.set(entry.getKey(),entry.getValue());
    }
  }
  Assert.assertEquals(getContents(originalCopy),getContents(unsetCopy));
}

</code></pre>

<br>
<pre class="type-6 type-5 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore @Test public void testUnsetEquivalenceOnTypes(){
  Configuration unsetCopy=new Configuration(original);
  Assert.assertEquals(getContents(original),getContents(unsetCopy));
  Map<String,String> entriesToUnset=new HashMap<String,String>();
  entriesToUnset.put("long","foo");
  entriesToUnset.put("boolean","bar");
  entriesToUnset.put("integer","foobar");
  storage.simpleUnset(unsetCopy,entriesToUnset);
  Configuration originalCopy=new Configuration();
  for (  Entry<String,String> entry : original) {
    if (!"long".equals(entry.getKey()) && !"boolean".equals(entry.getKey()) && !"integer".equals(entry.getKey())) {
      originalCopy.set(entry.getKey(),entry.getValue());
    }
  }
  Assert.assertEquals(getContents(originalCopy),getContents(unsetCopy));
}

</code></pre>

<br>
<pre class="type-6 type-5 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore @Test public void testEquivalenceStrings(){
  Configuration unsetCopy=new Configuration(original), clearCopy=new Configuration(original);
  Assert.assertEquals(getContents(unsetCopy),getContents(clearCopy));
  Map<String,String> entriesToUnset=new HashMap<String,String>();
  entriesToUnset.put("string1","foo");
  entriesToUnset.put("string3","bar");
  storage.simpleUnset(unsetCopy,entriesToUnset);
  storage.clearUnset(clearCopy,entriesToUnset);
  Assert.assertEquals(getContents(unsetCopy),getContents(clearCopy));
  Configuration originalCopy=new Configuration();
  for (  Entry<String,String> entry : original) {
    if (!"string1".equals(entry.getKey()) && !"string2".equals(entry.getKey())) {
      originalCopy.set(entry.getKey(),entry.getValue());
    }
  }
  Assert.assertEquals(getContents(originalCopy),getContents(unsetCopy));
  Assert.assertEquals(getContents(originalCopy),getContents(clearCopy));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.backend.hadoop.hbase.TestHBaseStorageFiltering </h4><pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnGroups() throws Exception {
  List<HBaseStorage.ColumnInfo> columnInfoList=getHBaseColumnInfo("cf1:a cf1:b cf2:foo*","");
  Map<String,List<HBaseStorage.ColumnInfo>> groupMap=HBaseStorage.groupByFamily(columnInfoList);
  assertEquals(2,groupMap.size());
  List<HBaseStorage.ColumnInfo> cf1List=groupMap.get("cf1");
  assertNotNull(cf1List);
  assertEquals(2,cf1List.size());
  assertColumnInfo(cf1List.get(0),"cf1","a",null);
  assertColumnInfo(cf1List.get(1),"cf1","b",null);
  List<HBaseStorage.ColumnInfo> cf2List=groupMap.get("cf2");
  assertNotNull(cf2List);
  assertEquals(1,cf2List.size());
  assertColumnInfo(cf2List.get(0),"cf2",null,"foo");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestAvroStorage </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testCompareToOfBagWrapper() throws Exception {
  final String check=basedir + "data/avro/uncompressed/arraysAsOutputByPig.avro";
  Set<GenericData.Record> records=getExpected(check);
  assertEquals(3,records.size());
  AvroBagWrapper size0=null;
  AvroBagWrapper size1=null;
  AvroBagWrapper size5=null;
  for (  GenericData.Record record : records) {
    AvroTupleWrapper tw=new AvroTupleWrapper<GenericData.Record>(record);
    if (((AvroBagWrapper)tw.get(0)).size() == 0) {
      size0=(AvroBagWrapper)tw.get(0);
    }
 else     if (((AvroBagWrapper)tw.get(0)).size() == 1) {
      size1=(AvroBagWrapper)tw.get(0);
    }
 else     if (((AvroBagWrapper)tw.get(0)).size() == 5) {
      size5=(AvroBagWrapper)tw.get(0);
    }
  }
  assertEquals(0,size0.size());
  assertEquals(1,size1.size());
  assertEquals(5,size5.size());
  assertTrue(size0.compareTo(size0) == 0);
  assertTrue(size0.compareTo(size1) < 0);
  assertTrue(size0.compareTo(size5) < 0);
  assertTrue(size1.compareTo(size0) > 0);
  assertTrue(size1.compareTo(size5) > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestBigTypeSort </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBigTypeSort() throws Exception {
  Data data=resetData(pigServer);
  List<Tuple> bigtypes=Lists.newArrayList();
  bigtypes.add(tuple("123456789012314","123000456000789000123000456000789000123000456000789.123"));
  bigtypes.add(tuple("123456789012334","1.0E40"));
  bigtypes.add(tuple("103456789012034","123000456000780000123000456000789000123000456000789.113"));
  data.set("bigtypes",bigtypes);
  pigServer.registerQuery("A = LOAD 'bigtypes' USING mock.Storage() as (x:biginteger,y:bigdecimal);");
  pigServer.registerQuery("B = ORDER A BY x ASC;");
  pigServer.registerQuery("C = ORDER A BY y ASC;");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  assertEquals(new BigInteger("103456789012034"),it.next().get(0));
  assertEquals(new BigInteger("123456789012314"),it.next().get(0));
  assertEquals(new BigInteger("123456789012334"),it.next().get(0));
  assertFalse(it.hasNext());
  it=pigServer.openIterator("C");
  assertTrue(it.hasNext());
  assertEquals(new BigDecimal("1.0E40"),it.next().get(1));
  assertEquals(new BigDecimal("123000456000780000123000456000789000123000456000789.113"),it.next().get(1));
  assertEquals(new BigDecimal("123000456000789000123000456000789000123000456000789.123"),it.next().get(1));
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestCurrentTime </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllCurrentTimeSame() throws Exception {
  Data data=resetData(pigServer);
  List<Tuple> justSomeRows=Lists.newArrayList();
  for (int i=0; i < 1000; i++) {
    justSomeRows.add(tuple(i));
  }
  data.set("justSomeRows",justSomeRows);
  pigServer.registerQuery("A = load 'justSomeRows' using mock.Storage();");
  pigServer.registerQuery("B = foreach A generate CurrentTime();");
  pigServer.registerQuery("C = foreach (group B by $0) generate COUNT($1);");
  Iterator<Tuple> it=pigServer.openIterator("C");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  assertEquals(1000L,t.get(0));
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestFunctionWrapperEvalFunc </h4><pre class="type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public final void testExceptionalIntegerToFloatWithException() throws IOException, ClassNotFoundException, NoSuchMethodException, InstantiationException, IllegalAccessException {
  FunctionWrapperEvalFunc udf=new FunctionWrapperEvalFunc(ExceptionalIntegerFloatFunction.class.getName());
  assertEquals(Float.class,udf.getOutputTypeClass());
  Exception exception=null;
  try {
    udf.exec(new Integer(11));
  }
 catch (  IOException e) {
    exception=e;
  }
  assertNotNull(exception);
  assertEquals(IOException.class,exception.getClass());
  assertEquals(MockException.class,exception.getCause().getClass());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestInvokerGenerator </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcat() throws Exception {
  Data data=resetData(pigServer);
  Set<Tuple> inputs=ImmutableSet.of(tuple("a"),tuple("b"),tuple("c"));
  Set<Tuple> expected=Sets.newHashSet();
  for (  Tuple t : inputs) {
    String str=(String)t.get(0);
    expected.add(tuple(str.concat(str)));
  }
  data.set("foo",Utils.getSchemaFromString("x:chararray"),inputs);
  pigServer.registerQuery("define concat InvokerGenerator('java.lang.String','concat','String');");
  pigServer.registerQuery("a = load 'foo' using mock.Storage();");
  pigServer.registerQuery("b = foreach @ generate concat($0, $0);");
  pigServer.registerQuery("store b into 'bar' using mock.Storage();");
  List<Tuple> results=data.get("bar");
  assertEquals(expected.size(),results.size());
  for (  Tuple t : results) {
    assertTrue(expected.remove(t));
  }
  assertEquals(0,expected.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValueOf() throws Exception {
  Data data=resetData(pigServer);
  Set<Tuple> inputs=Sets.newHashSet();
  while (inputs.size() < 1000) {
    inputs.add(tuple(Integer.toString(r.nextInt())));
  }
  Set<Tuple> expected=Sets.newHashSet();
  for (  Tuple t : inputs) {
    String str=(String)t.get(0);
    expected.add(tuple(Integer.valueOf(str)));
  }
  data.set("foo",Utils.getSchemaFromString("x:chararray"),inputs);
  pigServer.registerQuery("define valueOf InvokerGenerator('java.lang.Integer','valueOf','String');");
  pigServer.registerQuery("a = load 'foo' using mock.Storage();");
  pigServer.registerQuery("b = foreach @ generate valueOf($0);");
  pigServer.registerQuery("store b into 'bar' using mock.Storage();");
  List<Tuple> results=data.get("bar");
  assertEquals(expected.size(),results.size());
  for (  Tuple t : results) {
    assertTrue(expected.remove(t));
  }
  assertEquals(0,expected.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestOrcStorage </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullMapKey() throws Exception {
  pigServer.registerQuery("A = load '" + basedir + "nullmapkey.orc'"+ " using OrcStorage();");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  assertEquals(iter.next().toString(),"([hello#world])");
  assertEquals(iter.next().toString(),"([])");
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharVarchar() throws Exception {
  pigServer.registerQuery("A = load '" + basedir + "charvarchar.orc'"+ " using OrcStorage();");
  Schema schema=pigServer.dumpSchema("A");
  assertEquals(schema.size(),4);
  assertEquals(schema.getField(0).type,DataType.CHARARRAY);
  assertEquals(schema.getField(1).type,DataType.CHARARRAY);
  Iterator<Tuple> iter=pigServer.openIterator("A");
  int count=0;
  Tuple t=null;
  while (iter.hasNext()) {
    t=iter.next();
    assertEquals(t.size(),4);
    assertTrue(t.get(0) instanceof String);
    assertTrue(t.get(1) instanceof String);
    assertEquals(((String)t.get(1)).length(),20);
    count++;
  }
  assertEquals(count,10000);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleStore() throws Exception {
  pigServer.registerQuery("A = load '" + INPUT1 + "' as (a0:int, a1:chararray);");
  pigServer.store("A",OUTPUT1,"OrcStorage");
  Reader reader=OrcFile.createReader(fs,Util.getFirstPartFile(new Path(OUTPUT1)));
  assertEquals(reader.getNumberOfRows(),2);
  RecordReader rows=reader.rows(null);
  Object row=rows.next(null);
  StructObjectInspector soi=(StructObjectInspector)reader.getObjectInspector();
  IntWritable intWritable=(IntWritable)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(0));
  Text text=(Text)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(1));
  assertEquals(intWritable.get(),65536);
  assertEquals(text.toString(),"world");
  row=rows.next(null);
  intWritable=(IntWritable)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(0));
  text=(Text)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(1));
  assertEquals(intWritable.get(),1);
  assertEquals(text.toString(),"hello");
  fs.delete(new Path(OUTPUT1,"_SUCCESS"),true);
  pigServer.registerQuery("A = load '" + OUTPUT1 + "' using OrcStorage();");
  Schema s=pigServer.dumpSchema("A");
  assertEquals(s.toString(),"{a0: int,a1: chararray}");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  Tuple t=iter.next();
  assertEquals(t.size(),2);
  assertEquals(t.get(0),65536);
  assertEquals(t.get(1),"world");
  t=iter.next();
  assertEquals(t.size(),2);
  assertEquals(t.get(0),1);
  assertEquals(t.get(1),"hello");
  assertFalse(iter.hasNext());
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestOrcStoragePushdown </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegativeMatchesExpr() throws Exception {
  String q=query + "b = filter a by name matches 'foo*';" + "store b into 'out';";
  Expression expr=getExpressionForTest(q,Arrays.asList("name"));
  Assert.assertNull(expr);
  SearchArgument sarg=orcStorage.getSearchArgument(expr);
  Assert.assertNull(sarg);
  q=query + "b = filter a by name matches 'foo*' and srcid == 10;" + "store b into 'out';";
  expr=getExpressionForTest(q,Arrays.asList("srcid","name"));
  sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "expr = leaf-0",sarg.toString());
  q=query + "b = filter a by srcid == 10 and name matches 'foo*';" + "store b into 'out';";
  expr=getExpressionForTest(q,Arrays.asList("srcid","name"));
  sarg=orcStorage.getSearchArgument(expr);
  assertEquals("leaf-0 = (EQUALS srcid 10)\n" + "expr = leaf-0",sarg.toString());
  q=query + "b = filter a by name matches 'foo*' or srcid == 10;" + "store b into 'out';";
  expr=getExpressionForTest(q,Arrays.asList("srcid","name"));
  Assert.assertNull(expr);
  sarg=orcStorage.getSearchArgument(expr);
  Assert.assertNull(sarg);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestPluckTuple </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOutput() throws Exception {
  Data data=resetData(pigServer);
  Tuple exp1=tuple(1,"hey",2L);
  Tuple exp2=tuple(2,"woah",3L);
  data.set("a",Utils.getSchemaFromString("x:int,y:chararray,z:long"),exp1,exp2,tuple(3,"c",4L));
  data.set("b",Utils.getSchemaFromString("x:int,y:chararray,z:long"),tuple(1,"sasf",5L),tuple(2,"woah",6L),tuple(4,"c",7L));
  String query="a = load 'a' using mock.Storage();" + "b = load 'b' using mock.Storage();" + "c = join a by x, b by x;"+ "define pluck PluckTuple('a::');"+ "d = foreach c generate flatten(pluck(*));";
  pigServer.registerQuery(query);
  Iterator<Tuple> it=pigServer.openIterator("d");
  assertTrue(it.hasNext());
  assertEquals(exp1,it.next());
  assertTrue(it.hasNext());
  assertEquals(exp2,it.next());
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegativeOutput() throws Exception {
  Data data=resetData(pigServer);
  Tuple exp1=tuple(1,"sasf",5L);
  Tuple exp2=tuple(2,"woah",6L);
  data.set("a",Utils.getSchemaFromString("x:int,y:chararray,z:long"),tuple(1,"hey",2L),tuple(2,"woah",3L),tuple(3,"c",4L));
  data.set("b",Utils.getSchemaFromString("x:int,y:chararray,z:long"),exp1,exp2,tuple(4,"c",7L));
  String query="a = load 'a' using mock.Storage();" + "b = load 'b' using mock.Storage();" + "c = join a by x, b by x;"+ "define pluck PluckTuple('a::','false');"+ "d = foreach c generate flatten(pluck(*));";
  pigServer.registerQuery(query);
  Iterator<Tuple> it=pigServer.openIterator("d");
  assertTrue(it.hasNext());
  assertEquals(exp1,it.next());
  assertTrue(it.hasNext());
  assertEquals(exp2,it.next());
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.TestSUBTRACT </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldThrowAnIOExceptionAsInputDoesNotHaveTwoElements(){
  Tuple input=TupleFactory.getInstance().newTuple(1);
  try {
    input.set(0,bag());
    subtract.exec(input);
    fail("IOException Expected");
  }
 catch (  IOException e) {
    assertEquals("SUBTRACT expected two inputs but received 1 inputs.",e.getMessage());
  }
  input=TupleFactory.getInstance().newTuple(3);
  try {
    input.set(0,bag());
    input.set(1,bag());
    input.set(2,bag());
    subtract.exec(input);
    fail("IOException Expected");
  }
 catch (  IOException e) {
    assertEquals("SUBTRACT expected two inputs but received 3 inputs.",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShouldThrowAnIOExceptionAsInputDoesNotContainDataBagOnly(){
  Tuple input=TupleFactory.getInstance().newTuple(2);
  try {
    input.set(0,"2012/05/05");
    input.set(1,bag());
    subtract.exec(input);
    fail("IOException Expected");
  }
 catch (  IOException e) {
    assertEquals("Expecting input to be DataBag only but was 'String'",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.builtin.mock.TestMockStorage </h4><pre class="type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMockStoreUnion() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("input1",tuple("a"),tuple("b"),tuple("c"));
  data.set("input2",tuple("d"),tuple("e"),tuple("f"));
  pigServer.registerQuery("A = LOAD 'input1' USING mock.Storage();");
  pigServer.registerQuery("B = LOAD 'input2' USING mock.Storage();");
  pigServer.registerQuery("C = UNION A, B;");
  pigServer.registerQuery("STORE C INTO 'output' USING mock.Storage();");
  List<Tuple> out=data.get("output");
  assertEquals(out + " size",6,out.size());
  Set<String> set=new HashSet<String>();
  for (  Tuple tuple : out) {
    if (!set.add((String)tuple.get(0))) {
      fail(tuple.get(0) + " is present twice in " + out);
    }
  }
  assertTrue(set + " contains a",set.contains("a"));
  assertTrue(set + " contains b",set.contains("b"));
  assertTrue(set + " contains c",set.contains("c"));
  assertTrue(set + " contains d",set.contains("d"));
  assertTrue(set + " contains e",set.contains("e"));
  assertTrue(set + " contains f",set.contains("f"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadUsage1() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("input1",tuple("a"),tuple("b"),tuple("c"));
  try {
    data.set("input1",tuple("d"),tuple("e"),tuple("f"));
    fail("should have thrown an exception for setting twice the same input");
  }
 catch (  RuntimeException e) {
    assertEquals("Can not set location input1 twice",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.impl.builtin.TestStreamingUDF </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPythonUDF_withBytearrayAndBytes_onCluster() throws Exception {
  pigServerMapReduce=new PigServer(cluster.getExecType(),cluster.getProperties());
  String[] pythonScript={"from pig_util import outputSchema","import os","@outputSchema('f:bytearray')","def foo(bar):","    return bytearray(os.urandom(1000))"};
  Util.createLocalInputFile("pyfilewBaB.py",pythonScript);
  String[] input={"field1"};
  Util.createLocalInputFile("testTupleBaB",input);
  Util.copyFromLocalToCluster(cluster,"testTupleBaB","testTupleBaB");
  pigServerMapReduce.registerQuery("REGISTER 'pyfilewBaB.py' USING streaming_python AS pf;");
  pigServerMapReduce.registerQuery("A = LOAD 'testTupleBaB' as (b:chararray);");
  pigServerMapReduce.registerQuery("B = FOREACH A generate pf.foo(b);");
  Iterator<Tuple> iter=pigServerMapReduce.openIterator("B");
  assertTrue(iter.hasNext());
  Object result=iter.next().get(0);
  assertTrue(result instanceof DataByteArray);
  assertEquals(1000,((DataByteArray)result).size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPythonUDF_onCluster() throws Exception {
  pigServerMapReduce=new PigServer(cluster.getExecType(),cluster.getProperties());
  String[] pythonScript={"from pig_util import outputSchema","@outputSchema(\'c:chararray\')","def py_func(one,two):","   return one + two"};
  Util.createLocalInputFile("pyfile_mr.py",pythonScript);
  String[] input={"field10\tfield11","field20\tfield21"};
  Util.createLocalInputFile("input_mr",input);
  Util.copyFromLocalToCluster(cluster,"input_mr","input_mr");
  pigServerMapReduce.registerQuery("REGISTER 'pyfile_mr.py' USING streaming_python AS pf;");
  pigServerMapReduce.registerQuery("A = LOAD 'input_mr' as (c1:chararray, c2:chararray);");
  pigServerMapReduce.registerQuery("B = FOREACH A generate pf.py_func(c1, c2);");
  Iterator<Tuple> iter=pigServerMapReduce.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple actual0=iter.next();
  assertTrue(iter.hasNext());
  Tuple actual1=iter.next();
  Tuple expected0=tf.newTuple("field10field11");
  Tuple expected1=tf.newTuple("field20field21");
  assertEquals(expected0,actual0);
  assertEquals(expected1,actual1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.impl.streaming.TestPigStreamingUDF </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__multifieldTuple() throws IOException {
  Tuple t=tf.newTuple(2);
  t.set(0,1234);
  t.set(1,"sam");
  byte[] expectedOutput="I1234|\t_Csam|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__nullTuple() throws IOException {
  byte[] expectedOutput="|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(null)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__emptyString() throws IOException {
  Tuple t=tf.newTuple(1);
  t.set(0,"");
  byte[] expectedOutput="C|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__datetime() throws IOException {
  DateTime dt=new DateTime();
  Tuple t=tf.newTuple(1);
  t.set(0,dt);
  byte[] expectedOutput=("T" + ISODateTimeFormat.dateTime().print(dt) + "|_\n").getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__emptyTuple() throws IOException {
  Tuple t=tf.newTuple(0);
  byte[] expectedOutput="|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__record() throws IOException {
  Tuple t=tf.newTuple(1);
  t.set(0,"12\n34\n");
  byte[] expectedOutput="C12\n34\n|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__string() throws IOException {
  Tuple t=tf.newTuple(1);
  t.set(0,"1234");
  byte[] expectedOutput="C1234|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__multifieldTupleWithNull() throws IOException {
  Tuple t=tf.newTuple(3);
  t.set(0,1234);
  t.set(1,"sam");
  t.set(2,null);
  byte[] expectedOutput="I1234|\t_Csam|\t_|-_|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__nullString() throws IOException {
  Tuple t=tf.newTuple(1);
  t.set(0,null);
  byte[] expectedOutput="|-_|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__boolean() throws IOException {
  Tuple t=tf.newTuple(1);
  t.set(0,false);
  byte[] expectedOutput="Bfalse|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__complex_map() throws IOException {
  Tuple t=tf.newTuple(1);
  Map<String,Object> inner_map=new TreeMap<String,Object>();
  inner_map.put("A",1);
  inner_map.put("B","E");
  Map<String,Object> outer_map=new TreeMap<String,Object>();
  outer_map.put("C","F");
  outer_map.put("D",inner_map);
  t.set(0,outer_map);
  byte[] expectedOutput="|[_CC#CF|,_CD#|[_CA#I1|,_CB#CE|]_|]_|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__bag() throws IOException {
  Tuple t=tf.newTuple(1);
  Tuple t1=tf.newTuple(2);
  Tuple t2=tf.newTuple(2);
  List<Tuple> bagTuples=new ArrayList<Tuple>();
  bagTuples.add(t1);
  bagTuples.add(t2);
  t1.set(0,"A");
  t1.set(1,"B");
  t2.set(0,1);
  t2.set(1,2);
  DataBag b=DefaultBagFactory.getInstance().newDefaultBag(bagTuples);
  t.set(0,b);
  byte[] expectedOutput="|{_|(_CA|,_CB|)_|,_|(_I1|,_I2|)_|}_|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__allDataTypes() throws IOException {
  Tuple t=tf.newTuple(8);
  t.set(0,null);
  t.set(1,true);
  t.set(2,2);
  t.set(3,3L);
  t.set(4,4.0f);
  t.set(5,5.0d);
  t.set(6,new DataByteArray("six"));
  t.set(7,"seven");
  byte[] expectedOutput="|-_|\t_Btrue|\t_I2|\t_L3|\t_F4.0|\t_D5.0|\t_Asix|\t_Cseven|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__nestedTuple() throws IOException {
  Tuple t=tf.newTuple(2);
  Tuple nestedTuple=tf.newTuple(2);
  nestedTuple.set(0,"sam");
  nestedTuple.set(1,"oes");
  t.set(0,nestedTuple);
  t.set(1,"basil");
  byte[] expectedOutput="|(_Csam|,_Coes|)_|\t_Cbasil|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerialize__map() throws IOException {
  Tuple t=tf.newTuple(1);
  Map<String,String> m=new TreeMap<String,String>();
  m.put("A","B");
  m.put("C","D");
  t.set(0,m);
  byte[] expectedOutput="|[_CA#CB|,_CC#CD|]_|_\n".getBytes();
  Assert.assertTrue(assertEquals(expectedOutput,ps.serializeToBytes(t)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.impl.streaming.TestStreamingUtil </h4><pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddJobConfToEnv(){
  StringBuilder streamingEnv=null;
  Configuration conf=new Configuration();
  Map<String,String> all=Maps.newHashMap();
  for (int i=0; i < 10000; i++) {
    String key=RandomStringUtils.randomAlphanumeric(10);
    String value=RandomStringUtils.randomAlphanumeric(10);
    all.put(key,value);
  }
  Map<String,String> toInclude=Maps.newHashMap();
  for (  Map.Entry<String,String> entry : all.entrySet()) {
    String key=entry.getKey();
    String value=entry.getValue();
    conf.set(key,value);
    if (r.nextDouble() < .5) {
      toInclude.put(key,value);
      if (streamingEnv == null) {
        streamingEnv=new StringBuilder();
      }
 else {
        streamingEnv.append(",");
      }
      streamingEnv.append(key);
    }
  }
  conf.set(PIG_STREAMING_ENVIRONMENT,streamingEnv.toString());
  Map<String,String> env=new HashMap<String,String>();
  StreamingUtil.addJobConfToEnvironment(conf,env);
  for (  Map.Entry<String,String> entry : env.entrySet()) {
    String key=entry.getKey();
    String value=entry.getValue();
    String value2=toInclude.remove(key);
    assertEquals("Key [" + key + "] should be set in environment",value,value2);
  }
  assertTrue("There should be no remaining pairs in the included map",toInclude.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestAstValidator </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate if alias name duplication is caught.
 */
@Test public void tesNegative1() throws RecognitionException, IOException {
  try {
    ParserTestingUtils.validateAst("A = load 'x' as ( u:int, v:long, u:chararray, w:bytearray );");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex instanceof DuplicatedSchemaAliasException);
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate if alias name duplication is caught. Slightly more complicated than above test case.
 */
@Test public void tesNegative2() throws RecognitionException, IOException {
  try {
    ParserTestingUtils.validateAst("A = load 'x' as ( u:int, v:long, w:tuple( w:long, u:chararray, w:bytearray) );");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex instanceof DuplicatedSchemaAliasException);
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative3() throws RecognitionException, IOException {
  try {
    ParserTestingUtils.validateAst("A = load 'x'; C = limit B 100;");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex instanceof UndefinedAliasException);
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestErrorHandling </h4><pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative8() throws IOException {
  String query="A = load 'x' as ( a : bag{ T:tuple(u, v) }, c : int, d : long );\n" + "B = foreach A { S = c * 2; T = limit S 100; generate T; };\n" + "store B into 'y';";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 2, column 37"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative9() throws IOException {
  pig.registerQuery("a = load 'temp' as (a0:int, a1:int);\n");
  pig.registerQuery("b = group a by a0;\n");
  try {
    pig.registerQuery("c = foreach b { " + " c1 = foreach a { " + " c11 = filter a by a1 > 0; "+ " generate c11; "+ " } "+ " generate c1; "+ " }\n");
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    Assert.assertTrue(msg.contains("line 5, column 32"));
    Assert.assertTrue(msg.contains("mismatched input '{' expecting GENERATE"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative6(){
  String query="A = load 'x';\n" + "B = load 'y' as ( u : int, v : chararray );\n" + "C = foreach A generate B.w, $0;\n"+ "D = store C into 'output';\n";
  try {
    pig.registerQuery(query);
  }
 catch (  Exception ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 3, column 23"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative7() throws IOException {
  String query="A = load 'x';\n" + "store A into 'fs2you://output';\n";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    System.out.println(ex.getCause().getMessage());
    Assert.assertTrue(ex.getCause().getMessage().contains("line 2, column 0"));
    Assert.assertTrue(ex.getCause().getMessage().contains("No FileSystem for scheme: fs2you"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative4() throws IOException {
  String query="A = load 'x' as ( u:int, v:chararray );\n" + "C = foreach A generate u + v;";
  try {
    pig.registerQuery(query);
  }
 catch (  TypeCheckerException ex) {
    System.out.println(ex.getCause().getMessage());
    Assert.assertTrue(ex.getCause().getMessage().contains("line 2, column 25"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative13() throws IOException {
  String query="A = load 'x' as (u:int, v);\n" + "B = load 'y';\n" + "C = join A by u, B by w;";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertTrue(!msg.contains("null"));
    Assert.assertTrue(msg.contains("Projected field [w] does not exist."));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative5() throws IOException {
  String query="a = load 'a' using PigStorage('a') as (field1, field2: float, field3: chararray );\n" + "b = load 'b' using PigStorage('b') as (field4, field5, field6: chararray );\n" + "c = cogroup a by *, b by * ;\n"+ "d = foreach c generate group, flatten($1), flatten($2);\n"+ "e = foreach d generate group + 1, field1 + 1, field4 + 2.0;";
  try {
    pig.registerQuery(query);
  }
 catch (  TypeCheckerException ex) {
    System.out.println(ex.getCause().getMessage());
    Assert.assertTrue(ex.getCause().getMessage().contains("line 5, column 29"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative12() throws IOException {
  String query="A = loadd 'x' as (name, age, gpa);\n";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertFalse(msg.contains("file null"));
    Assert.assertTrue(msg.contains("Syntax error, unexpected symbol at or near 'A'"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative2(){
  String query="A = load 'x' as ( u:int, v:long, w );\n" + "B = foreach A generate $5;";
  try {
    pig.registerQuery(query);
  }
 catch (  Exception ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 2, column 23"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative14() throws IOException {
  String query="A = load 'x'; \n" + "B = union A, A;";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertTrue(msg.contains("Pig does not accept same alias as input for"));
    Assert.assertTrue(msg.contains("UNION"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative11() throws IOException {
  String query="A = load ^ 'x' as (name, age, gpa);\n";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertFalse(msg.contains("file null"));
    Assert.assertTrue(msg.contains("Unexpected character"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative1(){
  String query="A = load 'x' as ( u:int, v:long, u:chararray, w:bytearray );";
  try {
    pig.registerQuery(query);
  }
 catch (  Exception ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 1, column 33"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative3() throws IOException {
  String query="A = load 'x';\n" + "C = limit B 100;";
  try {
    pig.registerQuery(query);
  }
 catch (  Exception ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 2, column 10"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative15() throws IOException {
  String query="A = load 'x' as (a0, a1); \n" + "B = join A by a0, A by a1;";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String msg=ex.getMessage();
    System.out.println(msg);
    Assert.assertTrue(msg.contains("Pig does not accept same alias as input for"));
    Assert.assertTrue(msg.contains("JOIN"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tesNegative10() throws IOException {
  String query="A = load 'x' as (u :int, v: chararray);\n" + "B = load 'y';\n" + "C = union onschema A, B;";
  try {
    pig.registerQuery(query);
  }
 catch (  FrontendException ex) {
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains("line 3, column 4"));
    Assert.assertTrue(ex.getMessage().contains("UNION ONSCHEMA cannot be used with relations that have null schema"));
    return;
  }
  Assert.fail("Testcase should fail");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestLogicalPlanGenerator </h4><pre class="type-4 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=MismatchedTokenException.class) public void testNegative3() throws Exception {
  String query="A = load 'y'; all = load 'x';";
  try {
    ParserTestingUtils.generateLogicalPlan(query);
  }
 catch (  Exception ex) {
    MismatchedTokenException mex=(MismatchedTokenException)ex;
    assertTrue(mex.token.getText().equals("all"));
    throw ex;
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=MismatchedTokenException.class) public void testNegative2() throws Exception {
  String query="ship = load 'x';";
  try {
    ParserTestingUtils.generateLogicalPlan(query);
  }
 catch (  Exception ex) {
    MismatchedTokenException mex=(MismatchedTokenException)ex;
    assertTrue(mex.token.getText().equals("ship"));
    throw ex;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestQueryLexer </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test2() throws IOException {
  String query="A = load 'input' using PigStorage(';');" + "B = foreach ^ A generate string.concatsep( ';', $1, $2 );";
  CharStream input=new QueryParserStringStream(query,null);
  QueryLexer lexer=new QueryLexer(input);
  Token token;
  try {
    while ((token=lexer.nextToken()).getType() != Token.EOF) {
      if (token.getChannel() == Token.HIDDEN_CHANNEL)       continue;
      if (token.getText().equals(";")) {
        System.out.println(token.getText());
      }
 else {
        System.out.print(token.getText() + "(" + token.getType()+ ") ");
      }
    }
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().contains("Unexpected character"));
    return;
  }
  Assert.fail("Query should fail.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestQueryParser </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDependentNullAlias() throws IOException, RecognitionException {
  PigServer pigServer=new PigServer(ExecType.LOCAL);
  try {
    pigServer.registerQuery("F = limit F 20;store F into 'out';");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().contains("Unrecognized alias F"));
    return;
  }
  Assert.fail();
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAST() throws IOException, RecognitionException {
  CharStream input=new QueryParserFileStream("test/org/apache/pig/parser/TestAST.pig");
  QueryLexer lexer=new QueryLexer(input);
  CommonTokenStream tokens=new CommonTokenStream(lexer);
  QueryParser parser=new QueryParser(tokens);
  QueryParser.query_return result=parser.query();
  Tree ast=(Tree)result.getTree();
  System.out.println(ast.toStringTree());
  TreePrinter.printTree((CommonTree)ast,0);
  Assert.assertEquals(0,lexer.getNumberOfSyntaxErrors());
  Assert.assertEquals(0,parser.getNumberOfSyntaxErrors());
  Assert.assertEquals("QUERY",ast.getText());
  Assert.assertEquals(5,ast.getChildCount());
  for (int i=0; i < ast.getChildCount(); i++) {
    Tree c=ast.getChild(i);
    Assert.assertEquals("STATEMENT",c.getText());
  }
  Tree stmt=ast.getChild(0);
  Assert.assertEquals("A",stmt.getChild(0).getText());
  Assert.assertTrue("LOAD".equalsIgnoreCase(stmt.getChild(1).getText()));
  stmt=ast.getChild(1);
  Assert.assertEquals("B",stmt.getChild(0).getText());
  Assert.assertTrue("FOREACH".equalsIgnoreCase(stmt.getChild(1).getText()));
  stmt=ast.getChild(2);
  Assert.assertEquals("C",stmt.getChild(0).getText());
  Assert.assertTrue("FILTER".equalsIgnoreCase(stmt.getChild(1).getText()));
  stmt=ast.getChild(3);
  Assert.assertEquals("D",stmt.getChild(0).getText());
  Assert.assertTrue("LIMIT".equalsIgnoreCase(stmt.getChild(1).getText()));
  stmt=ast.getChild(4);
  Assert.assertTrue("STORE".equalsIgnoreCase(stmt.getChild(0).getText()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestScalarVisitor </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative1() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x'; " + "B = load 'y' as ( u : int, v : chararray );" + "C = foreach A generate B.w, $0; "+ "D = store C into 'output';";
  try {
    visit(query);
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex instanceof InvalidScalarProjectionException);
    return;
  }
  Assert.fail("Test case should fail");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.parser.TestSchemaAliasVisitor </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative3() throws RecognitionException, ParsingFailureException, IOException {
  String query="a = load '1.txt' as (a0:int, a0:int);" + "store a into 'output';";
  try {
    validate(query);
  }
 catch (  RecognitionException ex) {
    Assert.assertTrue(ex.toString().contains("Duplicated alias in schema"));
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative1() throws RecognitionException, ParsingFailureException, IOException {
  String query="A = load 'x' as ( u:int, v:long, w:bytearray); " + "B = foreach A generate $0, v, $0; " + "C = store B into 'output';";
  try {
    validate(query);
  }
 catch (  PlanValidationException ex) {
    Assert.assertTrue(ex.getMessage().contains("Duplicate schema alias"));
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegative2() throws RecognitionException, ParsingFailureException, IOException {
  String query="a = load '1.txt' as (a0:int, a1:int);" + "b = foreach a generate a0, a1 as a0;" + "c = store b into 'output';";
  try {
    validate(query);
  }
 catch (  PlanValidationException ex) {
    Assert.assertTrue(ex.getMessage().contains("Duplicate schema alias"));
    return;
  }
  Assert.fail("Query should fail to validate.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.evaluation.TestOver </h4><pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunc() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,1);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(2);
  t.set(0,inbag);
  t.set(1,"fred");
  boolean caught=false;
  try {
    DataBag outbag=func.exec(t);
  }
 catch (  ExecException ee) {
    caught=true;
    assertEquals("Unknown aggregate fred",ee.getMessage());
  }
  assertTrue(caught);
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLagDefaults() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,inbag);
  t.set(1,"lag");
  t.set(2,-1);
  t.set(3,-1);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=-1;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    try {
      if (count >= 0)       assertEquals(new Integer(count),to.get(0));
 else       assertNull(to.get(0));
    }
  finally {
      count++;
    }
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLagWithRowsBehindNoDefault() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"lag");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,3);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=-3;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    try {
      if (count >= 0)       assertEquals(new Integer(count),to.get(0));
 else       assertNull(to.get(0));
    }
  finally {
      count++;
    }
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeadWithRowsAheadNoDefault() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(5);
  t.set(0,inbag);
  t.set(1,"lead");
  t.set(2,-1);
  t.set(3,-1);
  t.set(4,3);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=3;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    if (count < 10)     assertEquals(new Integer(count++),to.get(0));
 else     assertNull(to.get(0));
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadInput() throws Exception {
  Over func=new Over();
  boolean caught=false;
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append("Mary had a little lamb");
  t.append("count");
  t.append(0);
  t.append(0);
  try {
    func.exec(t);
  }
 catch (  ExecException ee) {
    caught=true;
    assertEquals("Over expected a bag for arg 1 but received chararray",ee.getMessage());
  }
  assertTrue(caught);
  func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    t=TupleFactory.getInstance().newTuple(1);
    t.set(0,1);
    inbag.add(t);
  }
  t=TupleFactory.getInstance().newTuple();
  t.append(inbag);
  caught=false;
  try {
    func.exec(t);
  }
 catch (  ExecException ee) {
    caught=true;
    assertEquals("Over expected 2 or more inputs but received 1",ee.getMessage());
  }
  assertTrue(caught);
  func=new Over();
  t.append(1);
  caught=false;
  try {
    func.exec(t);
  }
 catch (  ExecException ee) {
    caught=true;
    assertEquals("Over expected a string for arg 2 but received int",ee.getMessage());
  }
  assertTrue(caught);
  func=new Over();
  t.set(1,"count");
  t.append("fred");
  caught=false;
  try {
    func.exec(t);
  }
 catch (  ExecException ee) {
    caught=true;
    assertEquals("Over expected an integer for arg 3 but received chararray",ee.getMessage());
  }
  assertTrue(caught);
  func=new Over();
  t.set(2,-1);
  t.append("fred");
  caught=false;
  try {
    func.exec(t);
  }
 catch (  ExecException ee) {
    caught=true;
    assertEquals("Over expected an integer for arg 4 but received chararray",ee.getMessage());
  }
  assertTrue(caught);
}

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeadDefaults() throws Exception {
  Over func=new Over();
  DataBag inbag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    inbag.add(t);
  }
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,inbag);
  t.set(1,"lead");
  t.set(2,-1);
  t.set(3,-1);
  DataBag outbag=func.exec(t);
  assertEquals(10,outbag.size());
  int count=1;
  for (  Tuple to : outbag) {
    assertEquals(1,to.size());
    if (count < 10)     assertEquals(new Integer(count++),to.get(0));
 else     assertNull(to.get(0));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.TestEvalString </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUPPER() throws Exception {
  UPPER func=new UPPER();
  String in="Hello World!";
  String expected="HELLO WORLD!";
  Tuple input=DefaultTupleFactory.getInstance().newTuple(in);
  String output=func.exec(input);
  assertTrue(output.equals(expected));
  String in2=null;
  Tuple input2=DefaultTupleFactory.getInstance().newTuple(in2);
  assertEquals("upper null value",null,func.exec(input2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.datetime.convert.TestConvertDateTime </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadFormat() throws Exception {
  Tuple t1=TupleFactory.getInstance().newTuple(2);
  t1.set(0,"2011-01-01");
  t1.set(1,"MMMM, yyyy");
  CustomFormatToISO convert=new CustomFormatToISO();
  assertNull("Input that doesn't match format should result in null",convert.exec(t1));
  t1.set(0,"July, 2012");
  assertEquals("Matching format should work correctly","2012-07-01T00:00:00.000+08:00",convert.exec(t1));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testISOToUnix() throws Exception {
  Tuple t2=TupleFactory.getInstance().newTuple(1);
  t2.set(0,"2009-01-07T01:07:01.000Z");
  ISOToUnix func2=new ISOToUnix();
  Long unix=func2.exec(t2);
  assertTrue(unix == 1231290421000L);
  assertEquals("Should not change the default timezone",defaultDTZ,DateTimeZone.getDefault());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.datetime.truncate.TestTruncateDateTime </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseDateTime_UTC() throws ExecException {
  Tuple t1=TupleFactory.getInstance().newTuple(1);
  t1.set(0,"2010-04-15T08:11:33.020Z");
  assertEquals(new DateTime(2010,4,15,8,11,33,20,DateTimeZone.UTC),ISOHelper.parseDateTime(t1));
  assertFalse(ISOHelper.parseDateTime(t1).equals(new DateTime(2010,4,15,0,11,33,20,DateTimeZone.forOffsetHours(-8))));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseDateTime_defaultTimeZonePreserved() throws ExecException {
  DateTimeZone previousDefaultTimeZone=DateTimeZone.getDefault();
  DateTimeZone testDefaultDateTimeZone=DateTimeZone.forOffsetHours(-8);
  DateTimeZone.setDefault(testDefaultDateTimeZone);
  Tuple t1=TupleFactory.getInstance().newTuple(1);
  t1.set(0,"2010-04-15T08:11:33.020");
  assertEquals(new DateTime(2010,4,15,8,11,33,20,testDefaultDateTimeZone),ISOHelper.parseDateTime(t1));
  assertTrue(testDefaultDateTimeZone.equals(DateTimeZone.getDefault()));
  DateTimeZone.setDefault(previousDefaultTimeZone);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseDateTime_TimeZone() throws ExecException {
  Tuple t1=TupleFactory.getInstance().newTuple(1);
  t1.set(0,"2010-04-15T08:11:33.020-08:00");
  assertEquals(new DateTime(2010,4,15,8,11,33,20,DateTimeZone.forOffsetHours(-8)),ISOHelper.parseDateTime(t1));
  assertFalse(ISOHelper.parseDateTime(t1).equals(new DateTime(2010,4,15,16,11,33,20,DateTimeZone.UTC)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.decode.TestDecode </h4><pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBin() throws Exception {
  Tuple t1=TupleFactory.getInstance().newTuple(8);
  t1.set(0,new Integer(19));
  t1.set(1,"infant");
  t1.set(2,new Integer(5));
  t1.set(3,"young");
  t1.set(4,new Integer(20));
  t1.set(5,"normal");
  t1.set(6,new Integer(60));
  t1.set(7,"old");
  Tuple t2=TupleFactory.getInstance().newTuple(8);
  t2.set(0,new Double(1.78));
  t2.set(1,"S");
  t2.set(2,new Double(1.70));
  t2.set(3,"M");
  t2.set(4,new Double(1.80));
  t2.set(5,"L");
  t2.set(6,new Double(1.90));
  t2.set(7,"XL");
  Tuple t3=TupleFactory.getInstance().newTuple(8);
  t3.set(0,null);
  t3.set(1,"S");
  t3.set(2,new Double(1.70));
  t3.set(3,"M");
  t3.set(4,new Double(1.80));
  t3.set(5,"L");
  t3.set(6,new Double(1.90));
  t3.set(7,"XL");
  Tuple t4=TupleFactory.getInstance().newTuple(8);
  t4.set(0,new Double(1.78));
  t4.set(1,null);
  t4.set(2,new Double(1.70));
  t3.set(3,"M");
  t3.set(4,new Double(1.80));
  t3.set(5,"L");
  t3.set(6,new Double(1.90));
  t4.set(7,"XL");
  Bin func=new Bin();
  String r=func.exec(t1);
  assertTrue(r.equals("young"));
  r=func.exec(t2);
  assertTrue(r.equals("M"));
  r=func.exec(t3);
  assertTrue(r == null);
  try {
    r=func.exec(t4);
    fail("Exception not triggered");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().equals("Bin : Encounter null in the input"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinCond() throws Exception {
  Tuple t1=TupleFactory.getInstance().newTuple(7);
  t1.set(0,false);
  t1.set(1,"s&a");
  t1.set(2,false);
  t1.set(3,"a");
  t1.set(4,true);
  t1.set(5,"s");
  t1.set(6,"n");
  Tuple t2=TupleFactory.getInstance().newTuple(7);
  t2.set(0,null);
  t2.set(1,"s&a");
  t2.set(2,false);
  t2.set(3,"a");
  t2.set(4,true);
  t2.set(5,"s");
  t2.set(6,"n");
  Tuple t3=TupleFactory.getInstance().newTuple(7);
  t3.set(0,false);
  t3.set(1,"s&a");
  t3.set(2,null);
  t3.set(3,"a");
  t3.set(4,true);
  t3.set(5,"s");
  t3.set(6,"n");
  BinCond func=new BinCond();
  String r=func.exec(t1);
  assertTrue(r.equals("s"));
  r=func.exec(t2);
  assertTrue(r == null);
  try {
    r=func.exec(t3);
    fail("Exception not triggered");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().equals("BinCond : Encounter null in the input"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecode() throws Exception {
  Tuple t1=TupleFactory.getInstance().newTuple(6);
  t1.set(0,new Integer(1));
  t1.set(1,0);
  t1.set(2,"Sales");
  t1.set(3,1);
  t1.set(4,"Engineering");
  t1.set(5,"Other");
  Tuple t2=TupleFactory.getInstance().newTuple(6);
  t2.set(0,new Integer(3));
  t2.set(1,0);
  t2.set(2,"Sales");
  t2.set(3,1);
  t2.set(4,"Engineering");
  t2.set(5,"Other");
  Tuple t3=TupleFactory.getInstance().newTuple(6);
  t3.set(0,null);
  t3.set(1,0);
  t3.set(2,"Sales");
  t3.set(3,1);
  t3.set(4,"Engineering");
  t3.set(5,"Other");
  Tuple t4=TupleFactory.getInstance().newTuple(6);
  t4.set(0,new Integer(1));
  t4.set(1,null);
  t4.set(2,"Sales");
  t4.set(3,1);
  t4.set(4,"Engineering");
  t4.set(5,"Other");
  Decode func=new Decode();
  String r=func.exec(t1);
  assertTrue(r.equals("Engineering"));
  r=func.exec(t2);
  assertTrue(r.equals("Other"));
  r=func.exec(t3);
  assertTrue(r == null);
  try {
    r=func.exec(t4);
    fail("Exception not triggered");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().equals("Decode : Encounter null in the input"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestLength </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLength() throws IOException {
  testTuple_.set(0,"foo");
  assertEquals("regular length should match",(Integer)3,len_.exec(testTuple_));
  testTuple_.set(0,null);
  assertNull("length of null is null",len_.exec(testTuple_));
  testTuple_.set(0,"");
  assertEquals("empty string has 0 length",(Integer)0,len_.exec(testTuple_));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestRegex </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegexExtractAll() throws IOException {
  String matchRegex="^(.+)\\b\\s+is a\\s+\\b(.+)$";
  TupleFactory tupleFactory=TupleFactory.getInstance();
  Tuple t1=tupleFactory.newTuple(2);
  t1.set(0,"this is a match");
  t1.set(1,matchRegex);
  Tuple t2=tupleFactory.newTuple(2);
  t2.set(0,"no match");
  t2.set(1,matchRegex);
  Tuple t3=tupleFactory.newTuple(2);
  t3.set(0,null);
  t3.set(1,matchRegex);
  RegexExtractAll func=new RegexExtractAll();
  Tuple r=func.exec(t1);
  assertEquals(r.size(),2);
  assertEquals("this",r.get(0));
  assertEquals("match",r.get(1));
  r=func.exec(t2);
  assertTrue(r == null);
  r=func.exec(t3);
  assertTrue(r == null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestReplaceMulti </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigScriptForReplaceMultiUDF() throws Exception {
  String inputStr="Hello World!";
  File inputFile=Util.createInputFile("tmp","testReplaceMultiIn.txt",new String[]{inputStr});
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS (name: chararray);");
  pigServer.registerQuery("B = FOREACH A GENERATE REPLACE_MULTI(name, [' '#'_','e'#'a','o'#'oo','!'#'']);");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  assertEquals("Halloo_Woorld",t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigScriptForReplaceMultiUDFNullParameters() throws Exception {
  String inputStr="Hello World!";
  File inputFile=Util.createInputFile("tmp","testReplaceMultiIn.txt",new String[]{inputStr});
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS (name: chararray);");
  pigServer.registerQuery("B = FOREACH A GENERATE org.apache.pig.piggybank.evaluation.string.REPLACE_MULTI(NULL, NULL);");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  assertNull(t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigScriptForReplaceMultiUDFNullMap() throws Exception {
  String inputStr="Hello World!";
  File inputFile=Util.createInputFile("tmp","testReplaceMultiIn.txt",new String[]{inputStr});
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS (name: chararray);");
  pigServer.registerQuery("B = FOREACH A GENERATE REPLACE_MULTI(name, NULL);");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  assertEquals(inputStr,t.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestStuff </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws IOException {
  Tuple tupleWithNullElement=TupleFactory.getInstance().newTuple(1);
  String result=udf.exec(tupleWithNullElement);
  assertNull(result);
  Tuple t=TupleFactory.getInstance().newTuple(4);
  t.set(0,"Chocolate Cake");
  t.set(1,10);
  t.set(2,4);
  t.set(3,"Pie");
  result=udf.exec(t);
  assertEquals("Chocolate Pie",result);
  t.set(0,"Old Zealand");
  t.set(1,0);
  t.set(2,3);
  t.set(3,"New");
  result=udf.exec(t);
  assertEquals("New Zealand",result);
  t.set(0,"Take a look");
  t.set(1,5);
  t.set(2,1);
  t.set(3,"b");
  result=udf.exec(t);
  assertEquals("Take b look",result);
  t.set(0,"Take a look");
  t.set(1,5);
  t.set(2,6);
  t.set(3,"b");
  result=udf.exec(t);
  assertEquals("Take b",result);
  t.set(0,"Take a look");
  t.set(1,4);
  t.set(2,7);
  t.set(3,null);
  result=udf.exec(t);
  assertEquals("Take",result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.string.TestUcFirst </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUcFirst() throws IOException {
  testTuple_.set(0,null);
  assertNull("null is null",ucf_.exec(testTuple_));
  testTuple_.set(0,"");
  assertEquals("empty string","",ucf_.exec(testTuple_));
  testTuple_.set(0,"foo");
  assertEquals("lowercase string","Foo",ucf_.exec(testTuple_));
  testTuple_.set(0,"Foo");
  assertEquals("uppercase string","Foo",ucf_.exec(testTuple_));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.TestToBagToTuple </h4><pre class="type-13 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void toBag() throws Exception {
  ToBag tb=new ToBag();
  Tuple input=TupleFactory.getInstance().newTuple();
  for (int i=0; i < 100; ++i) {
    input.append(i);
  }
  Set<Integer> s=new HashSet<Integer>();
  DataBag db=tb.exec(input);
  for (  Tuple t : db) {
    s.add((Integer)t.get(0));
  }
  Assert.assertEquals(100,s.size());
  for (int i=0; i < 100; ++i) {
    Assert.assertTrue(s.contains(i));
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void toTuple() throws Exception {
  ToTuple tb=new ToTuple();
  Tuple input=TupleFactory.getInstance().newTuple();
  for (int i=0; i < 100; ++i) {
    input.append(i);
  }
  Tuple output=tb.exec(input);
  Assert.assertFalse(input == output);
  Assert.assertEquals(input,output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.util.apachelogparser.TestSearchEngineExtractor </h4><pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTests() throws Exception {
  SearchEngineExtractor searchEngineExtractor=new SearchEngineExtractor();
  int testCount=0;
  Tuple input=DefaultTupleFactory.getInstance().newTuple(1);
  for (  String key : tests.keySet()) {
    String expected=tests.get(key);
    assertNotNull(expected);
    assertTrue(expected.length() > 0);
    input.set(0,key);
    assertEquals(expected,searchEngineExtractor.exec(input));
    testCount++;
  }
  assertEquals(tests.size(),testCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.xml.XPathAllTest </h4><pre class="type-7 type-6 type-4 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore @Test public void testCacheBenefit() throws Exception {
  final XPathAll xpath=new XPathAll();
  final Tuple tuple=TupleFactory.getInstance().newTuple(3);
  tuple.set(2,true);
  final long withCache=timeTheUDF(tuple,xpath);
  tuple.set(2,false);
  final long withOutCache=timeTheUDF(tuple,xpath);
  System.out.println(withCache + "\t" + withOutCache);
  assertTrue(withCache < withOutCache);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.evaluation.xml.XPathTest </h4><pre class="type-7 type-6 type-4 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore @Test public void testCacheBenefit() throws Exception {
  final XPath xpath=new XPath();
  final Tuple tuple=TupleFactory.getInstance().newTuple(3);
  tuple.set(2,true);
  final long withCache=timeTheUDF(tuple,xpath);
  tuple.set(2,false);
  final long withOutCache=timeTheUDF(tuple,xpath);
  System.out.println(withCache + "\t" + withOutCache);
  assertTrue(withCache < withOutCache);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestAllLoader </h4><pre class="type-11 type-8 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  Configuration hadoopConf=new Configuration();
  FileSystem.setDefaultUri(hadoopConf,LocalFileSystem.getDefaultUri(hadoopConf));
  if (baseDir == null) {
    configuration=new Properties();
    configuration.setProperty(LoadFuncHelper.FILE_EXTENSION_LOADERS,extensionLoaders);
    baseDir=new File("build/test/testAllLoader");
    if (baseDir.exists()) {
      FileUtil.fullyDelete(baseDir);
    }
    assertTrue(baseDir.mkdirs());
    createSimpleDir();
    createDatePartitionDir();
    createLogicPartitionDir();
    createTaggedLogicPartitionDir();
    createFileByContentDir();
    server=new PigServer(ExecType.LOCAL,configuration);
    server.setBatchOn();
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can filter a date partitioned directory by a date range
 * @throws IOException
 */
@Test public void testDateParitionFilterWithoutSchema() throws IOException {
  server.registerQuery("a = LOAD '" + Util.encodeEscape(datePartitionDir.getAbsolutePath()) + "' using "+ allLoaderName+ "('daydate >= \"2010-11-02\" and daydate <= \"2010-11-04\"'); ");
  server.registerQuery("r = FOREACH a GENERATE $0;");
  Iterator<Tuple> it=server.openIterator("r");
  int count=0;
  while (it.hasNext()) {
    count++;
    Tuple t=it.next();
    float f=Float.valueOf(t.get(0).toString());
    assertTrue(f < 1L);
    assertEquals(1,t.size());
  }
  readRecordsFromLoader(server,"a",fileRecords * 3 * fileTypes.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestHadoopJobHistoryLoader </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testHadoopJHLoader() throws Exception {
  PigServer pig=new PigServer(ExecType.LOCAL);
  pig.registerQuery("a = load '" + INPUT_DIR + "' using org.apache.pig.piggybank.storage.HadoopJobHistoryLoader() "+ "as (j:map[], m:map[], r:map[]);");
  Iterator<Tuple> iter=pig.openIterator("a");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  Map<String,Object> job=(Map<String,Object>)t.get(0);
  assertEquals("3eb62180-5473-4301-aa22-467bd685d466",(String)job.get("PIG_SCRIPT_ID"));
  assertEquals("job_201004271216_9998",(String)job.get("JOBID"));
  assertEquals("job_201004271216_9995",(String)job.get("PIG_JOB_PARENTS"));
  assertEquals("0.8.0-dev",(String)job.get("PIG_VERSION"));
  assertEquals("0.20.2",(String)job.get("HADOOP_VERSION"));
  assertEquals("d",(String)job.get("PIG_JOB_ALIAS"));
  assertEquals("PigLatin:Test.pig",job.get("JOBNAME"));
  assertEquals("ORDER_BY",(String)job.get("PIG_JOB_FEATURE"));
  assertEquals("1",(String)job.get("TOTAL_MAPS"));
  assertEquals("1",(String)job.get("TOTAL_REDUCES"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestLoadFuncHelper </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineFunctionSingleArg() throws IOException {
  FuncSpec funcSpec=helper.determineFunction(baseDir.getAbsolutePath());
  assertNotNull(funcSpec);
  assertEquals(LOADER,funcSpec.toString() + "()");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineFirstFile() throws IOException {
  Path path=helper.determineFirstFile(baseDir.getAbsolutePath());
  assertNotNull(path);
  assertEquals(new Path(testFile.getAbsolutePath()).toUri().toString(),path.toUri().toURL().getFile());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDetermineFunction() throws IOException {
  Path firstFile=helper.determineFirstFile(baseDir.getAbsolutePath());
  FuncSpec funcSpec=helper.determineFunction(baseDir.getAbsolutePath(),firstFile);
  assertNotNull(funcSpec);
  assertEquals(LOADER,funcSpec.toString() + "()");
}

</code></pre>

<br>
<pre class="type-11 type-8 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  if (baseDir == null) {
    PigServer pig=new PigServer(ExecType.LOCAL);
    configuration=new Configuration(false);
    configuration.set(LoadFuncHelper.FILE_EXTENSION_LOADERS,extensionLoaders);
    helper=new LoadFuncHelper(configuration);
    baseDir=new File("build/test/testLoadFuncHelper");
    if (baseDir.exists()) {
      FileUtil.fullyDelete(baseDir);
    }
    assertTrue(baseDir.mkdirs());
    testFile=new File(baseDir,"testFile.txt");
    FileWriter writer=new FileWriter(testFile);
    try {
      for (int i=0; i < 100; i++) {
        writer.append("test test\n");
      }
    }
  finally {
      writer.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestPathPartitionHelper </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListStatusPartitionFilterFound() throws Exception {
  PathPartitionHelper partitionHelper=new PathPartitionHelper();
  Job job=new Job(conf);
  job.setJobName("TestJob");
  job.setInputFormatClass(FileInputFormat.class);
  Configuration conf=job.getConfiguration();
  FileInputFormat.setInputPaths(job,new Path(baseDir.getAbsolutePath()));
  JobContext jobContext=HadoopShims.createJobContext(conf,job.getJobID());
  partitionHelper.setPartitionFilterExpression("year<='2010' and month=='01' and day>='01'",PigStorage.class,"2");
  partitionHelper.setPartitionKeys(baseDir.getAbsolutePath(),conf,PigStorage.class,"2");
  List<FileStatus> files=partitionHelper.listStatus(jobContext,PigStorage.class,"2");
  assertNotNull(files);
  assertEquals(1,files.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListStatus() throws Exception {
  PathPartitionHelper partitionHelper=new PathPartitionHelper();
  Job job=new Job(conf);
  job.setJobName("TestJob");
  job.setInputFormatClass(FileInputFormat.class);
  Configuration conf=job.getConfiguration();
  FileInputFormat.setInputPaths(job,new Path(baseDir.getAbsolutePath()));
  JobContext jobContext=HadoopShims.createJobContext(conf,job.getJobID());
  partitionHelper.setPartitionKeys(baseDir.getAbsolutePath(),conf,PigStorage.class,"3");
  List<FileStatus> files=partitionHelper.listStatus(jobContext,PigStorage.class,"3");
  assertNotNull(files);
  assertEquals(1,files.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.TestPathPartitioner </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetKeysForEmptyDir() throws Exception {
  File baseDir=createDir(null,"testPathPartitioner-testGetKeys-" + System.currentTimeMillis());
  File partition1=createDir(baseDir,"year=2010");
  File partition2=createDir(partition1,"month=01");
  File emptyPartition=createDir(partition2,"day=01");
  PathPartitioner pathPartitioner=new PathPartitioner();
  Set<String> keys=pathPartitioner.getPartitionKeys(baseDir.getAbsolutePath(),conf);
  assertNotNull(keys);
  assertEquals(3,keys.size());
  String[] keyArr=keys.toArray(new String[]{});
  assertEquals("year",keyArr[0]);
  assertEquals("month",keyArr[1]);
  assertEquals("day",keyArr[2]);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetKeys() throws Exception {
  PathPartitioner pathPartitioner=new PathPartitioner();
  Set<String> keys=pathPartitioner.getPartitionKeys(baseDir.getAbsolutePath(),conf);
  assertNotNull(keys);
  assertEquals(3,keys.size());
  String[] keyArr=keys.toArray(new String[]{});
  assertEquals("year",keyArr[0]);
  assertEquals("month",keyArr[1]);
  assertEquals("day",keyArr[2]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorage </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecursiveRecordWithData() throws IOException {
  String output=outbasedir + "testRecursiveWithData";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'data', '"+ Util.encodeEscape(testRecursiveRecordInUnion)+ "' );"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  FrontendException e) {
    assertTrue(e.getMessage().contains("could not instantiate 'org.apache.pig.piggybank.storage.avro.AvroStorage'"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenericUnion() throws IOException {
  String output=outbasedir + "testGenericUnion";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testGenericUnionFile) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  FrontendException e) {
    assertTrue(e.getMessage().contains("Cannot get schema"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecursiveRecordWithSchemaFile() throws IOException {
  String output=outbasedir + "testRecursiveWithSchemaFile";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'no_schema_check',"+ " 'schema_file', '"+ Util.encodeEscape(testRecursiveRecordInUnionSchema)+ "' );"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  FrontendException e) {
    assertTrue(e.getMessage().contains("could not instantiate 'org.apache.pig.piggybank.storage.avro.AvroStorage'"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecursiveRecordWithSchemaCheck() throws IOException {
  String output=outbasedir + "testRecursiveWithSchemaCheck";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testRecursiveRecordInUnion) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ " 'schema', '"+ recursiveRecordInUnion+ "' );"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("bytearray is not compatible with avro"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlob6() throws IOException {
  String output=outbasedir + "testGlob6";
  deleteDirectory(new File(output));
  String[] queries={" in = LOAD '" + Util.encodeEscape(testNoMatchedFiles) + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ();"," STORE in INTO '" + output + "' USING org.apache.pig.piggybank.storage.avro.AvroStorage ("+ "   'schema', '{\"type\":\"array\",\"items\":\"float\"}'  );"};
  try {
    testAvroStorage(queries);
    Assert.fail("Negative test to test an exception. Should not be succeeding!");
  }
 catch (  JobCreationException e) {
    assertEquals(e.getMessage(),"Internal error creating job configuration.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.piggybank.test.storage.avro.TestAvroStorageUtils </h4><pre class="type-7 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema8() throws IOException {
  Schema x, y, z;
  x=Schema.createFixed("fixed1",null,null,1);
  y=Schema.createFixed("fixed2",null,null,1);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.FIXED,z.getType());
  assertEquals(x.getFixedSize(),z.getFixedSize());
  x=Schema.createFixed("fixed1",null,null,1);
  y=Schema.createFixed("fixed2",null,null,2);
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("Cannot merge FIXED types with different sizes"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPaths() throws IOException {
  final String basedir="file://" + System.getProperty("user.dir");
  final String tempdir=Long.toString(System.currentTimeMillis());
  final String nonexistentpath=basedir + "/" + tempdir+ "/this_path_does_not_exist";
  String locationStr=null;
  Set<Path> paths;
  Configuration conf=new Configuration();
  locationStr=basedir;
  paths=AvroStorageUtils.getPaths(locationStr,conf,true);
  assertFalse(paths.isEmpty());
  locationStr=nonexistentpath;
  try {
    paths=AvroStorageUtils.getPaths(locationStr,conf,true);
    fail();
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("matches 0 files"));
  }
  locationStr=basedir + "/{}";
  try {
    paths=AvroStorageUtils.getPaths(locationStr,conf,true);
    fail();
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("matches 0 files"));
  }
  paths=AvroStorageUtils.getPaths(locationStr,conf,false);
  assertTrue(paths.isEmpty());
  locationStr=basedir + "/{1,";
  try {
    AvroStorageUtils.getPaths(locationStr,conf,true);
    Assert.fail("Negative test to test illegal file pattern. Should not be succeeding!");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("Illegal file pattern"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema7() throws IOException {
  Schema x, y, z;
  List<Schema> types1=new ArrayList<Schema>();
  types1.add(Schema.create(Schema.Type.INT));
  List<Schema> types2=new ArrayList<Schema>();
  types2.add(Schema.create(Schema.Type.DOUBLE));
  x=Schema.createUnion(types1);
  y=Schema.createUnion(types2);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.UNION,z.getType());
  assertTrue(z.getTypes().contains(types1.get(0)));
  assertTrue(z.getTypes().contains(types2.get(0)));
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema6() throws IOException {
  Schema x, y, z;
  x=Schema.createMap(Schema.create(Schema.Type.INT));
  y=Schema.createMap(Schema.create(Schema.Type.DOUBLE));
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.MAP,z.getType());
  assertEquals(Schema.Type.DOUBLE,z.getValueType().getType());
  x=Schema.createMap(Schema.create(Schema.Type.INT));
  y=Schema.createMap(Schema.create(Schema.Type.BOOLEAN));
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertEquals("Cannot merge " + x.getValueType().getType() + " with "+ y.getValueType().getType(),e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema5() throws IOException {
  Schema x, y, z;
  x=Schema.createArray(Schema.create(Schema.Type.INT));
  y=Schema.createArray(Schema.create(Schema.Type.DOUBLE));
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(Schema.Type.ARRAY,z.getType());
  assertEquals(Schema.Type.DOUBLE,z.getElementType().getType());
  x=Schema.createArray(Schema.create(Schema.Type.INT));
  y=Schema.createArray(Schema.create(Schema.Type.BOOLEAN));
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertEquals("Cannot merge " + x.getElementType().getType() + " with "+ y.getElementType().getType(),e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema3() throws IOException {
  Schema complexType[]={Schema.createRecord(new ArrayList<Schema.Field>()),Schema.createArray(Schema.create(Schema.Type.INT)),Schema.createMap(Schema.create(Schema.Type.INT)),Schema.createUnion(new ArrayList<Schema>()),Schema.createFixed("fixed",null,null,1)};
  for (int i=0; i < complexType.length; i++) {
    Schema x=complexType[i];
    for (int j=0; j < complexType.length; j++) {
      Schema y=complexType[j];
      if (i != j) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x,y);
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x.getType() + " with "+ y.getType(),e.getMessage());
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema4() throws IOException {
  Schema x, y, z;
  List<Schema.Field> fields1=new ArrayList<Schema.Field>();
  fields1.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields1);
  List<Schema.Field> fields2=new ArrayList<Schema.Field>();
  fields2.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  y=Schema.createRecord(fields2);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(x.getFields().size(),z.getFields().size());
  assertEquals(Schema.Type.INT,z.getField("f1").schema().getType());
  List<Schema.Field> fields3=new ArrayList<Schema.Field>();
  fields3.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields3);
  List<Schema.Field> fields4=new ArrayList<Schema.Field>();
  fields4.add(new Schema.Field("f1",Schema.create(Schema.Type.DOUBLE),null,null));
  y=Schema.createRecord(fields4);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(x.getFields().size(),z.getFields().size());
  assertEquals(Schema.Type.DOUBLE,z.getField("f1").schema().getType());
  List<Schema.Field> fields5=new ArrayList<Schema.Field>();
  fields5.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields5);
  List<Schema.Field> fields6=new ArrayList<Schema.Field>();
  fields6.add(new Schema.Field("f1",Schema.create(Schema.Type.BOOLEAN),null,null));
  y=Schema.createRecord(fields6);
  try {
    z=AvroStorageUtils.mergeSchema(x,y);
    Assert.fail("exception is expected, but " + z.getType() + " is returned");
  }
 catch (  IOException e) {
    assertEquals("Cannot merge " + x.getField("f1").schema().getType() + " with "+ y.getField("f1").schema().getType(),e.getMessage());
  }
  List<Schema.Field> fields7=new ArrayList<Schema.Field>();
  fields7.add(new Schema.Field("f1",Schema.create(Schema.Type.INT),null,null));
  x=Schema.createRecord(fields7);
  List<Schema.Field> fields8=new ArrayList<Schema.Field>();
  fields8.add(new Schema.Field("f2",Schema.create(Schema.Type.DOUBLE),null,null));
  y=Schema.createRecord(fields8);
  z=AvroStorageUtils.mergeSchema(x,y);
  assertEquals(x.getFields().size() + y.getFields().size(),z.getFields().size());
  assertEquals(Schema.Type.INT,z.getField("f1").schema().getType());
  assertEquals(Schema.Type.DOUBLE,z.getField("f2").schema().getType());
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenericUnion() throws IOException {
  final String str1="[ \"string\", \"int\", \"boolean\"  ]";
  Schema s=Schema.parse(str1);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str2="[ \"string\", \"int\", \"null\"  ]";
  s=Schema.parse(str2);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str3="[ \"string\", \"null\"  ]";
  s=Schema.parse(str3);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  Schema realSchema=AvroStorageUtils.getAcceptedType(s);
  assertEquals(AvroStorageUtils.StringSchema,realSchema);
  final String str4="{\"type\": \"array\", \"items\": " + str2 + "}";
  s=Schema.parse(str4);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  try {
    realSchema=AvroStorageUtils.getAcceptedType(s);
    fail("\"Should throw a runtime exception when trying to get accepted type from a unacceptable union");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Cannot call this function on a unacceptable union"));
  }
  final String str5=RECORD_BEGINNING + "{ \"name\": \"next\", \"type\": [\"null\", \"int\"] } ] }";
  s=Schema.parse(str5);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  final String str6=RECORD_BEGINNING + "{ \"name\": \"next\", \"type\": [\"string\", \"int\"] } ] }";
  s=Schema.parse(str6);
  assertTrue(AvroStorageUtils.containsGenericUnion(s));
  final String str7="[ \"string\"  ]";
  s=Schema.parse(str7);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  realSchema=AvroStorageUtils.getAcceptedType(s);
  assertEquals(AvroStorageUtils.StringSchema,realSchema);
  final String str8="[  ]";
  s=Schema.parse(str8);
  assertFalse(AvroStorageUtils.containsGenericUnion(s));
  realSchema=AvroStorageUtils.getAcceptedType(s);
  assertNull(realSchema);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeSchema2() throws IOException {
  Schema.Type primitiveType[]={Schema.Type.NULL,Schema.Type.BOOLEAN,Schema.Type.BYTES,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.ENUM,Schema.Type.STRING};
  Schema.Type expectedType[][]={{Schema.Type.NULL,null,null,null,null,null,null,null,null},{null,Schema.Type.BOOLEAN,null,null,null,null,null,null,null},{null,null,Schema.Type.BYTES,null,null,null,null,null,null},{null,null,null,Schema.Type.INT,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.LONG,Schema.Type.LONG,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.FLOAT,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.DOUBLE,Schema.Type.STRING,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.ENUM,Schema.Type.STRING},{null,null,null,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING,Schema.Type.STRING}};
  List<String> enumSymbols=new ArrayList<String>();
  enumSymbols.add("sym1");
  enumSymbols.add("sym2");
  Schema enumSchema=Schema.createEnum("enum",null,null,enumSymbols);
  for (int i=0; i < primitiveType.length; i++) {
    Schema.Type x=primitiveType[i];
    for (int j=0; j < primitiveType.length; j++) {
      Schema.Type y=primitiveType[j];
      if (expectedType[i][j] == null) {
        try {
          Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
          Assert.fail("exception is expected, but " + z.getType() + " is returned");
        }
 catch (        IOException e) {
          assertEquals("Cannot merge " + x + " with "+ y,e.getMessage());
        }
      }
 else {
        Schema z=AvroStorageUtils.mergeSchema(x.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(x),y.equals(Schema.Type.ENUM) ? enumSchema : Schema.create(y));
        assertEquals(expectedType[i][j],z.getType());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAccumulator </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltin() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:double);");
  pigServer.registerQuery("C = group A by id;");
  pigServer.registerQuery("D = foreach C generate group, SUM(A.v), COUNT(A.v), MIN(A.v), MAX(A.v);");
  HashMap<Integer,Double[]> expected=new HashMap<Integer,Double[]>();
  expected.put(100,new Double[]{15.0,5.0,1.0,5.0});
  expected.put(200,new Double[]{6.3,3.0,1.1,3.1});
  expected.put(300,new Double[]{3.3,1.0,3.3,3.3});
  expected.put(400,new Double[]{null,0.0,null,null});
  Iterator<Tuple> iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Double[] v=expected.get((Integer)t.get(0));
    for (int i=0; i < v.length; i++) {
      if (v[i] != null) {
        assertEquals(v[i].doubleValue(),((Number)t.get(i + 1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(i + 1));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumWithBuiltinAvg() throws IOException {
  HashMap<Integer,Double> expected=new HashMap<Integer,Double>();
  expected.put(100,3.0);
  expected.put(200,2.1);
  expected.put(300,3.3);
  expected.put(400,null);
  String[] types={"double","float","int","long"};
  for (int i=0; i < types.length; i++) {
    if (i > 1) {
      expected.put(200,2.0);
      expected.put(300,3.0);
    }
    pigServer.registerQuery("A = load '" + INPUT_FILE3 + "' as (id:int, v:"+ types[i]+ ");");
    pigServer.registerQuery("C = group A by id;");
    pigServer.registerQuery("D = foreach C generate group, AVG(A.v);");
    Iterator<Tuple> iter=pigServer.openIterator("D");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      Double v=expected.get((Integer)t.get(0));
      if (v != null) {
        assertEquals(v.doubleValue(),((Number)t.get(1)).doubleValue(),0.0001);
      }
 else {
        assertNull(t.get(1));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumBasic() throws IOException {
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  org.apache.pig.test.utils.AccumulatorBagCount(A);");
  HashMap<Integer,Integer> expected=new HashMap<Integer,Integer>();
  expected.put(100,2);
  expected.put(200,1);
  expected.put(300,3);
  expected.put(400,1);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
  }
  pigServer.registerQuery("B = group A by id;");
  pigServer.registerQuery("C = foreach B generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A), org.apache.pig.test.utils.BagCount(A);");
  try {
    iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      Tuple t=iter.next();
      assertEquals(expected.get((Integer)t.get(0)),(Integer)t.get(1));
    }
    fail("accumulator should not be called.");
  }
 catch (  IOException e) {
  }
  pigServer.registerQuery("A = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("B = load '" + INPUT_FILE1 + "' as (id:int, fruit);");
  pigServer.registerQuery("C = cogroup A by id, B by id;");
  pigServer.registerQuery("D = foreach C generate group,  " + "org.apache.pig.test.utils.AccumulatorBagCount(A), org.apache.pig.test.utils.AccumulatorBagCount(B);");
  HashMap<Integer,String> expected2=new HashMap<Integer,String>();
  expected2.put(100,"2,2");
  expected2.put(200,"1,1");
  expected2.put(300,"3,3");
  expected2.put(400,"1,1");
  iter=pigServer.openIterator("D");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(expected2.get((Integer)t.get(0)),t.get(1).toString() + "," + t.get(2).toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestAdd </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE,DataType.BIGINTEGER,DataType.BIGDECIMAL};
  System.out.println("Testing Add operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 + inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 + inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 + inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 + inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBZip </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that Pig's Bzip2TextInputFormat throws an IOException when the input files to be loaded are actually
 * a result of concatenating 2 or more bz2 files. It should not silently ignore part
 * of the input data.  When, hadoop's TextInpuFormat is used(PIG-3251), it should
 * successfully read this concatenated bzip file to the end.
 */
@Test public void testBZ2Concatenation() throws Exception {
  String[] inputData1=new String[]{"1\ta","2\taa"};
  String[] inputData2=new String[]{"1\tb","2\tbb"};
  String[] inputDataMerged=new String[]{"1\ta","2\taa","1\tb","2\tbb"};
  File in1=folder.newFile("junit-in1.bz2");
  String compressedInputFileName1=in1.getAbsolutePath();
  File in2=folder.newFile("junit-in2.bz2");
  String compressedInputFileName2=in2.getAbsolutePath();
  String unCompressedInputFileName="testRecordDelims-uncomp.txt";
  Util.createInputFile(cluster,unCompressedInputFileName,inputDataMerged);
  try {
    CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in1));
    for (int i=0; i < inputData1.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData1[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos.write(bytes);
    }
    cos.close();
    CBZip2OutputStream cos2=new CBZip2OutputStream(new FileOutputStream(in2));
    for (int i=0; i < inputData2.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData2[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos2.write(bytes);
    }
    cos2.close();
    catInto(compressedInputFileName2,compressedInputFileName1);
    Util.copyFromLocalToCluster(cluster,compressedInputFileName1,compressedInputFileName1);
    String script="a = load '" + Util.encodeEscape(unCompressedInputFileName) + "';";
    PigServer pig=new PigServer(cluster.getExecType(),properties);
    pig.registerQuery(script);
    Iterator<Tuple> it1=pig.openIterator("a");
    script="a = load '" + Util.encodeEscape(compressedInputFileName1) + "';";
    pig.registerQuery(script);
    try {
      Iterator<Tuple> it2=pig.openIterator("a");
      while (it1.hasNext()) {
        Tuple t1=it1.next();
        Tuple t2=it2.next();
        assertEquals(t1,t2);
      }
      assertFalse(it2.hasNext());
      assertEquals("IOException should be thrown when pig's own Bzip2TextInputFormat is used",properties.getProperty("pig.bzip.use.hadoop.inputformat"),"true");
    }
 catch (    IOException e) {
      assertEquals("IOException should only be thrown when pig's own Bzip2TextInputFormat is used",properties.getProperty("pig.bzip.use.hadoop.inputformat"),"false");
    }
  }
  finally {
    Util.deleteFile(cluster,unCompressedInputFileName);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-19 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the writing and reading of an empty BZip file.
 */
@Test public void testEmptyBzip() throws Exception {
  File tmp=folder.newFile("junit.tmp");
  CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(tmp));
  cos.close();
  assertNotSame(0,tmp.length());
  FileSystem fs=FileSystem.getLocal(new Configuration(false));
  CBZip2InputStream cis=new CBZip2InputStream(fs.open(new Path(tmp.getAbsolutePath())),-1,tmp.length());
  assertEquals(-1,cis.read(new byte[100]));
  cis.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that '\n', '\r' and '\r\n' are treated as record delims when using
 * bzip just like they are when using uncompressed text
 */
@Test public void testRecordDelims() throws Exception {
  String[] inputData=new String[]{"1\t2\r3\t4","5\t6\r","7\t8","9\t10\r"};
  File in=folder.newFile("junit-in.bz2");
  String compressedInputFileName=in.getAbsolutePath();
  String clusterCompressedFilePath=Util.removeColon(compressedInputFileName);
  String unCompressedInputFileName="testRecordDelims-uncomp.txt";
  Util.createInputFile(cluster,unCompressedInputFileName,inputData);
  try {
    CBZip2OutputStream cos=new CBZip2OutputStream(new FileOutputStream(in));
    for (int i=0; i < inputData.length; i++) {
      StringBuffer sb=new StringBuffer();
      sb.append(inputData[i]).append("\n");
      byte bytes[]=sb.toString().getBytes();
      cos.write(bytes);
    }
    cos.close();
    Util.copyFromLocalToCluster(cluster,compressedInputFileName,clusterCompressedFilePath);
    String script="a = load '" + unCompressedInputFileName + "';";
    PigServer pig=new PigServer(cluster.getExecType(),properties);
    pig.registerQuery(script);
    Iterator<Tuple> it1=pig.openIterator("a");
    script="a = load '" + Util.encodeEscape(clusterCompressedFilePath) + "';";
    pig.registerQuery(script);
    Iterator<Tuple> it2=pig.openIterator("a");
    while (it1.hasNext()) {
      Tuple t1=it1.next();
      Tuple t2=it2.next();
      assertEquals(t1,t2);
    }
    assertFalse(it2.hasNext());
  }
  finally {
    Util.deleteFile(cluster,unCompressedInputFileName);
    Util.deleteFile(cluster,clusterCompressedFilePath);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBatchAliases </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBatchAliases() throws IOException {
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'test/org/apache/pig/test/data/passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
  myPig.registerQuery("b = group a by uid;");
  myPig.registerQuery("c = group a by gid;");
  myPig.registerQuery("d = foreach b generate SUM(a.gid);");
  myPig.registerQuery("e = foreach c generate group, COUNT(a);");
  myPig.registerQuery("store d into '/tmp/output1';");
  myPig.registerQuery("store e into '/tmp/output2';");
  boolean foundD=false;
  boolean foundE=false;
  for (  ExecJob job : myPig.executeBatch()) {
    assertEquals(ExecJob.JOB_STATUS.COMPLETED,job.getStatus());
    foundD=foundD || "d".equals(job.getAlias());
    foundE=foundE || "e".equals(job.getAlias());
  }
  assertTrue(foundD);
  assertTrue(foundE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBestFitCast </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast10() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x:float, y:long, z);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(2),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test6() throws Exception {
  Util.createInputFile(cluster,"test6",new String[]{"abc"});
  pigServer.registerQuery("A = LOAD 'test6';");
  pigServer.registerQuery("B = FOREACH A GENERATE " + UDF2.class.getName() + "($0);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  Tuple t=iter.next();
  assertEquals("ABC",t.get(0));
  Util.deleteFile(cluster,"test6");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast8() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x, y:long, z:double);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(2),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast13() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x, y:long, z:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(2),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast11() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x:float, y, z:long);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(1),new Double(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(2),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntSum() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:int);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Long);
  assertEquals(new Long(210),(Long)t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3() throws Exception {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "((float)y,(float)y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals(true,((Tuple)t.get(1)).get(1) instanceof Float);
    ++cnt;
  }
  assertEquals(20,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast15() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y);");
  pigServer.registerQuery("B = FOREACH A generate " + UDF3.class.getName() + "(y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(0)).get(0) instanceof DataByteArray);
    byte[] expected=Integer.toString(cnt + 1).getBytes();
    byte[] actual=((DataByteArray)((Tuple)t.get(0)).get(0)).get();
    assertEquals(expected.length,actual.length);
    for (int i=0; i < expected.length; i++) {
      assertEquals(expected[i],actual[i]);
    }
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast3() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:long);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x, y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleSum() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:double);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Double);
  assertEquals(new Double(210),(Double)t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatSum() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:float);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Double);
  assertEquals(new Double(210),(Double)t.get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast14() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Double);
  assertEquals(new Double(210),(Double)t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast4() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:double);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(1),new Double(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "(x,y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,((Tuple)t.get(1)).get(0) instanceof Long);
    assertEquals(true,((Tuple)t.get(1)).get(1) instanceof Double);
    ++cnt;
  }
  assertEquals(20,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast9() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile2 + "' as (x, y:double, z:long);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y,z);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Double);
    assertEquals((Double)((Tuple)t.get(1)).get(1),new Double(cnt + 1));
    assertTrue(((Tuple)t.get(1)).get(2) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(2),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast2() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF3.class.getName() + "(x,y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(1)).get(0) instanceof Float);
    assertEquals((Float)((Tuple)t.get(1)).get(0),(Float)0.0f);
    assertTrue(((Tuple)t.get(1)).get(1) instanceof Long);
    assertEquals((Long)((Tuple)t.get(1)).get(1),new Long(cnt + 1));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test4() throws Exception {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x:long, y:int);");
  pigServer.registerQuery("B = FOREACH A generate x, " + UDF1.class.getName() + "(x);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,((Tuple)t.get(1)).get(0) instanceof Float);
    ++cnt;
  }
  assertEquals(20,cnt);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongSum() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:long);");
  pigServer.registerQuery("B = group A all;");
  pigServer.registerQuery("C = FOREACH B generate SUM(A.y);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  Tuple t=iter.next();
  assertTrue(t.get(0) instanceof Long);
  assertEquals(new Long(210),(Long)t.get(0));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayCast16() throws IOException, ExecException {
  pigServer.registerQuery("A = LOAD '" + inputFile + "' as (x, y:int);");
  pigServer.registerQuery("B = FOREACH A generate " + UDF3.class.getName() + "(y);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(((Tuple)t.get(0)).get(0) instanceof Integer);
    assertEquals(new Integer(cnt + 1),(Integer)((Tuple)t.get(0)).get(0));
    ++cnt;
  }
  assertEquals(LOOP_SIZE,cnt);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBloom </h4><pre class="type-4 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=RuntimeException.class) public void testBadHash() throws Exception {
  String size="100";
  String numHash="3";
  String hashFunc="nosuchhash";
  try {
    BuildBloom bb=new BuildBloom(hashFunc,"fixed",size,numHash);
  }
 catch (  RuntimeException re) {
    assertTrue(re.getMessage().contains("Unknown hash type"));
    throw re;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBoolean </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrSecondFalse() throws ExecException {
  setupOr();
  lt.setValue(new Boolean(true));
  rt.setValue(new Boolean(false));
  Result res=bop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertTrue((Boolean)res.result);
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotNull() throws ExecException {
  setupNot();
  lt.setValue(null);
  Result res=uop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertNull(res.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndSecondFalse() throws ExecException {
  setupAnd();
  lt.setValue(new Boolean(true));
  rt.setValue(new Boolean(false));
  Result res=bop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertFalse((Boolean)res.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndFirstFalse() throws ExecException {
  setupAnd();
  lt.setValue(new Boolean(false));
  rt.setValue(new Boolean(true));
  Result res=bop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertFalse((Boolean)res.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndBothFalse() throws ExecException {
  setupAnd();
  lt.setValue(new Boolean(false));
  rt.setValue(new Boolean(false));
  Result res=bop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertFalse((Boolean)res.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndTrue() throws ExecException {
  setupAnd();
  lt.setValue(new Boolean(true));
  rt.setValue(new Boolean(true));
  Result res=bop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertTrue((Boolean)res.result);
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndNull() throws ExecException {
  setupAnd();
  Boolean[] testWith=new Boolean[]{false,true,null};
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(null);
    rt.setValue(testWith[i]);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == false) {
      assertFalse((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(testWith[i]);
    rt.setValue(null);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == false) {
      assertFalse((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotFalse() throws ExecException {
  setupNot();
  lt.setValue(new Boolean(false));
  Result res=uop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertTrue((Boolean)res.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrFirstFalse() throws ExecException {
  setupOr();
  lt.setValue(new Boolean(false));
  rt.setValue(new Boolean(true));
  Result res=bop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertTrue((Boolean)res.result);
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrNull() throws ExecException {
  setupOr();
  Boolean[] testWith=new Boolean[]{false,true,null};
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(null);
    rt.setValue(testWith[i]);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == true) {
      assertTrue((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
  for (int i=0; i < testWith.length; i++) {
    lt.setValue(testWith[i]);
    rt.setValue(null);
    Result res=bop.getNextBoolean();
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    if (testWith[i] != null && testWith[i] == true) {
      assertTrue((Boolean)res.result);
    }
 else {
      assertNull(res.result);
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrTrue() throws ExecException {
  setupOr();
  lt.setValue(new Boolean(true));
  rt.setValue(new Boolean(true));
  Result res=bop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertTrue((Boolean)res.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotTrue() throws ExecException {
  setupNot();
  lt.setValue(new Boolean(true));
  Result res=uop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertFalse((Boolean)res.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrBothFalse() throws ExecException {
  setupOr();
  lt.setValue(new Boolean(false));
  rt.setValue(new Boolean(false));
  Result res=bop.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertFalse((Boolean)res.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltInBagToTupleOrString </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOutputSchemaForBagToTupleUDF() throws Exception {
  Schema expectedSch=Schema.generateNestedSchema(DataType.TUPLE,DataType.INTEGER,DataType.CHARARRAY);
  FieldSchema tupSch=new FieldSchema(null,DataType.TUPLE);
  tupSch.schema=new Schema();
  tupSch.schema.add(new FieldSchema(null,DataType.INTEGER));
  tupSch.schema.add(new FieldSchema(null,DataType.CHARARRAY));
  FieldSchema bagSch=new FieldSchema(null,DataType.BAG);
  bagSch.schema=new Schema(tupSch);
  Schema inputSch=new Schema();
  inputSch.add(bagSch);
  BagToTuple udf=new BagToTuple();
  Schema outputSchema=udf.outputSchema(inputSch);
  assertEquals("schema of BagToTuple input",expectedSch.size(),outputSchema.size());
  assertTrue("schema of BagToTuple input",Schema.equals(expectedSch,outputSchema,false,true));
}

</code></pre>

<br>
<pre class="type-6 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=java.lang.RuntimeException.class) public void testInvalidZeroInputToOutputSchemaForBagToTupleStringUDF() throws Exception {
  Schema inputSch=new Schema();
  BagToString udf=new BagToString();
  Schema outputSchema=udf.outputSchema(inputSch);
  assertEquals("schema of BagToTuple input",outputSchema.getField(0).type,DataType.CHARARRAY);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestBuiltin </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * End-to-end testing of the CONCAT() builtin function for vararg parameters
 * @throws Exception
 */
@Test public void testComplexMultiCONCAT() throws Exception {
  String input="vararg_concat_test_jira_3444.txt";
  Util.createLocalInputFile(input,new String[]{"dummy"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerQuery("A = LOAD '" + input + "' as (x:chararray);");
  pigServer.registerQuery("B = foreach A generate CONCAT('a', CONCAT('b',CONCAT('c','d')));");
  Iterator<Tuple> its=pigServer.openIterator("B");
  Tuple t=its.next();
  assertEquals("abcd",t.get(0));
  pigServer.registerQuery("B = foreach A generate CONCAT('a', 'b', 'c', 'd');");
  its=pigServer.openIterator("B");
  t=its.next();
  assertEquals("abcd",t.get(0));
  pigServer.registerQuery("B = foreach A generate CONCAT('a', CONCAT('b','c'), 'd');");
  its=pigServer.openIterator("B");
  t=its.next();
  assertEquals("abcd",t.get(0));
  pigServer.registerQuery("B = foreach A generate CONCAT('a', CONCAT('b',Null), 'd');");
  its=pigServer.openIterator("B");
  t=its.next();
  assertNull(t.get(0));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCount_InvalidArgumentType() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (data:chararray);");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT('data');");
    pigServer.openIterator("C");
    Assert.fail("COUNT is suppose to run with one argument of type BAG, however it ran with an argument of type chararray.");
  }
 catch (  FrontendException e) {
    Assert.assertTrue(e.getCause() instanceof TypeCheckerException);
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCount_InvalidNumberOfArguments_WithoutInputSchema() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "';");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1.$0, $1.$0);");
    pigServer.openIterator("C");
    Assert.fail("COUNT is suppose to run with one argument of type BAG, however it ran with couple of arguments.");
  }
 catch (  FrontendException e) {
    Assert.assertTrue(e.getCause() instanceof TypeCheckerException);
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToBag() throws Exception {
  TOBAG tb=new TOBAG();
  Schema expectedSch=Schema.generateNestedSchema(DataType.BAG,DataType.INTEGER);
  Schema inputSch=new Schema();
  inputSch.add(new FieldSchema(null,DataType.INTEGER));
  assertEquals("schema of tobag when input has only ints",expectedSch,tb.outputSchema(inputSch));
  inputSch.add(new FieldSchema(null,DataType.INTEGER));
  assertEquals("schema of tobag when input has only ints",expectedSch,tb.outputSchema(inputSch));
  inputSch.add(new FieldSchema(null,DataType.LONG));
  expectedSch=Schema.generateNestedSchema(DataType.BAG,DataType.NULL);
  assertEquals("schema of tobag when input has ints and long",expectedSch,tb.outputSchema(inputSch));
  Schema tupInSchema=new Schema(new FieldSchema("x",DataType.CHARARRAY));
  inputSch=new Schema();
  inputSch.add(new FieldSchema("a",tupInSchema,DataType.TUPLE));
  Schema inputSchCp=new Schema(inputSch);
  inputSchCp.getField(0).alias=null;
  expectedSch=new Schema(new FieldSchema(null,inputSchCp,DataType.BAG));
  assertEquals("schema of tobag when input has cols of type tuple ",expectedSch,tb.outputSchema(inputSch));
  inputSch.add(new FieldSchema("b",tupInSchema,DataType.TUPLE));
  assertEquals("schema of tobag when input has cols of type tuple ",expectedSch,tb.outputSchema(inputSch));
  tupInSchema=new Schema(new FieldSchema("x",DataType.BYTEARRAY));
  inputSch.add(new FieldSchema("c",tupInSchema,DataType.TUPLE));
  expectedSch=Schema.generateNestedSchema(DataType.BAG,DataType.NULL);
  assertEquals("schema of tobag when input has cols of type tuple with diff inner schema",expectedSch,tb.outputSchema(inputSch));
  Tuple input=TupleFactory.getInstance().newTuple();
  for (int i=0; i < 100; ++i) {
    input.append(i);
  }
  input.append(null);
  Set<Integer> s=new HashSet<Integer>();
  DataBag db=tb.exec(input);
  for (  Tuple t : db) {
    s.add((Integer)t.get(0));
  }
  assertEquals(101,s.size());
  for (int i=0; i < 100; ++i) {
    assertTrue(s.contains(i));
  }
  assertTrue("null in tobag result",s.contains(null));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSUM() throws Exception {
  String[] sumTypes={"SUM","DoubleSum","LongSum","IntSum","FloatSum","BigDecimalSum","BigIntegerSum"};
  for (int k=0; k < sumTypes.length; k++) {
    EvalFunc<?> sum=evalFuncMap.get(sumTypes[k]);
    String inputType=getInputType(sumTypes[k]);
    Tuple tup=inputMap.get(inputType);
    Object output=sum.exec(tup);
    String msg="[Testing " + sumTypes[k] + " on input type: "+ getInputType(sumTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(sumTypes[k])+ " (expected) )]";
    if (inputType == "Integer" || inputType == "Long") {
      assertEquals(msg,(Long)output,(Long)getExpected(sumTypes[k]),0.00001);
    }
 else     if (inputType == "BigDecimal")     assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(sumTypes[k])).toPlainString());
 else     if (inputType == "BigInteger")     assertEquals(msg,((BigInteger)output).toString(),((BigInteger)getExpected(sumTypes[k])).toString());
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(sumTypes[k]),0.00001);
    }
    assertNull(sum.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLFPig() throws Exception {
  Util.createInputFile(cluster,"input.txt",new String[]{"this:is:delimited:by:a:colon\n"});
  int arity1=6;
  LoadFunc lf=new PigStorage(":");
  LoadFunc p1=new ReadToEndLoader(lf,ConfigurationUtil.toConfiguration(cluster.getProperties()),"input.txt",0);
  Tuple f1=p1.getNext();
  assertTrue(f1.size() == arity1);
  Util.deleteFile(cluster,"input.txt");
  int LOOP_COUNT=100;
  String[] input=new String[LOOP_COUNT * LOOP_COUNT];
  int n=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j++) {
      input[n++]=(i + "\t" + i+ "\t"+ j % 2);
    }
  }
  Util.createInputFile(cluster,"input.txt",input);
  LoadFunc p15=new ReadToEndLoader(new PigStorage(),ConfigurationUtil.toConfiguration(cluster.getProperties()),"input.txt",0);
  int count=0;
  while (true) {
    Tuple f15=p15.getNext();
    if (f15 == null)     break;
    count++;
    assertEquals(3,f15.size());
  }
  assertEquals(LOOP_COUNT * LOOP_COUNT,count);
  Util.deleteFile(cluster,"input.txt");
  String input2=":this:has:a:leading:colon\n";
  int arity2=6;
  Util.createInputFile(cluster,"input.txt",new String[]{input2});
  LoadFunc p2=new ReadToEndLoader(new PigStorage(":"),ConfigurationUtil.toConfiguration(cluster.getProperties()),"input.txt",0);
  Tuple f2=p2.getNext();
  assertTrue(f2.size() == arity2);
  Util.deleteFile(cluster,"input.txt");
  String input3="this:has:a:trailing:colon:\n";
  int arity3=6;
  Util.createInputFile(cluster,"input.txt",new String[]{input3});
  LoadFunc p3=new ReadToEndLoader(new PigStorage(":"),ConfigurationUtil.toConfiguration(cluster.getProperties()),"input.txt",0);
  Tuple f3=p3.getNext();
  assertTrue(f3.size() == arity3);
  Util.deleteFile(cluster,"input.txt");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSPRINTF() throws Exception {
  String fmt="%2$10s <%1$-6s< %2$,10d >%1$7s> %2$8x %3$10.3f";
  String s1="meep";
  Integer ii=665568;
  Float ff=993.14159265f;
  String exp="    665568 <meep  <    665,568 >   meep>    a27e0    993.142";
  Tuple ts;
  String res;
  EvalFunc<String> sprinter=new SPRINTF();
  ts=TupleFactory.getInstance().newTuple(5);
  ts.set(0,fmt);
  ts.set(1,s1);
  ts.set(2,ii);
  ts.set(3,ff);
  ts.set(4,(long)(ii * 1000000L));
  res=sprinter.exec(ts);
  assertEquals(exp,res);
  ts.set(2,665568l);
  ts.set(3,993.14159265d);
  res=sprinter.exec(ts);
  assertEquals(exp,res);
  ts.set(3,null);
  res=sprinter.exec(ts);
  assertNull(res);
  ts.set(3,ff);
  ts.set(0,null);
  res=sprinter.exec(ts);
  assertNull(res);
  ts=TupleFactory.getInstance().newTuple(1);
  ts.set(0,"meep!");
  res=sprinter.exec(ts);
  assertEquals("meep!",res);
  String input="vararg_sprintf_test_jira_3939.txt";
  Util.createLocalInputFile(input,new String[]{"dummy"});
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  pigServer.registerQuery("A = LOAD '" + input + "' as (x:chararray);");
  pigServer.registerQuery("B = foreach A generate SPRINTF('%6s|%-8s|%2$,+12d %2$8x', 'yay', 665568);");
  Iterator<Tuple> its=pigServer.openIterator("B");
  Tuple t=its.next();
  assertEquals("   yay|665568  |    +665,568    a27e0",t.get(0));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCount_InvalidNumberOfArguments_WithInputSchema() throws Exception {
  File inputFile=createCountInputFile();
  try {
    pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (data:chararray);");
    pigServer.registerQuery("=> group @ all;");
    pigServer.registerQuery("C = foreach @ generate COUNT($1.$0, $1.$0);");
    pigServer.openIterator("C");
    Assert.fail("COUNT is suppose to run with one argument of type BAG, however it ran with couple of arguments.");
  }
 catch (  FrontendException e) {
    Assert.assertTrue(e.getCause() instanceof TypeCheckerException);
  }
 finally {
    inputFile.delete();
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeySet() throws Exception {
  Map<String,Object> m=new HashMap<String,Object>();
  m.put("open","apache");
  m.put("1","hadoop");
  m.put("source","code");
  Tuple input=TupleFactory.getInstance().newTuple(m);
  KEYSET keySet=new KEYSET();
  DataBag result=keySet.exec(input);
  Iterator<Tuple> i=result.iterator();
  assertEquals(result.size(),m.size());
  while (i.hasNext()) {
    Tuple t=i.next();
    assertTrue(m.containsKey((String)t.get(0)));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringUDFs() throws Exception {
  String inputStr="amy smith ";
  File inputFile=Util.createInputFile("tmp","testStrUDFsIn.txt",new String[]{inputStr});
  pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (name: chararray);");
  pigServer.registerQuery("B = foreach @ generate SUBSTRING(name, 0, 3), " + "INDEXOF(name, 'a'), INDEXOF(name, 'a', 3), LAST_INDEX_OF(name, 'a'), REPLACE(name, 'a', 'b'), " + "STRSPLIT(name), STRSPLIT(name, ' '), STRSPLIT(name, ' ', 0), STRSPLITTOBAG(name), STRSPLITTOBAG(name,' ')"+ ", STRSPLITTOBAG(name,' ',0), TRIM(name);");
  Iterator<Tuple> it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  Tuple t=it.next();
  Tuple expected=Util.buildTuple("amy","smith");
  DataBag expectedBag=Util.createBag(new Tuple[]{Util.buildTuple("amy"),Util.buildTuple("smith")});
  assertTrue(!it.hasNext());
  assertEquals(12,t.size());
  assertEquals("amy",t.get(0));
  assertEquals(0,t.get(1));
  assertEquals(-1,t.get(2));
  assertEquals(0,t.get(3));
  assertEquals("bmy smith ",t.get(4));
  assertEquals(expected,t.get(5));
  assertEquals(expected,t.get(6));
  assertEquals(expected,t.get(7));
  assertEquals(expectedBag,t.get(8));
  assertEquals(expectedBag,t.get(9));
  assertEquals(expectedBag,t.get(10));
  assertEquals("amy smith",t.get(11));
  pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' as (name);");
  pigServer.registerQuery("B = foreach @ generate SUBSTRING(name, 0, 3), " + "LAST_INDEX_OF(name, 'a'), REPLACE(name, 'a', 'b'), TRIM(name);");
  it=pigServer.openIterator("B");
  assertTrue(it.hasNext());
  t=it.next();
  assertTrue(!it.hasNext());
  assertEquals(4,t.size());
  assertEquals("amy",t.get(0));
  assertEquals(0,t.get(1));
  assertEquals("bmy smith ",t.get(2));
  assertEquals("amy smith",t.get(3));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testInverseMap() throws Exception {
  Map<String,Object> m=new HashMap<String,Object>();
  m.put("open","apache");
  m.put("1","hadoop");
  m.put("source","pig");
  m.put("integer",new Integer(100));
  m.put("floating",new Float(100.012));
  m.put("long",new Long(10000000000000l));
  m.put("boolean",true);
  Tuple input=TupleFactory.getInstance().newTuple(m);
  INVERSEMAP inverseMap=new INVERSEMAP();
  Map inverse=inverseMap.exec(input);
  assertEquals(inverse.size(),7);
  assertTrue(inverse.containsKey("apache"));
  assertTrue(inverse.containsKey("hadoop"));
  assertTrue(inverse.containsKey("pig"));
  assertTrue(inverse.containsKey("100"));
  assertTrue(inverse.containsKey("true"));
  assertTrue(inverse.containsKey("100.012"));
  m.clear();
  m.put("open","apache");
  m.put("1","hadoop");
  m.put("source","apache");
  input.set(0,m);
  inverse=inverseMap.exec(input);
  assertEquals(inverse.size(),2);
  assertTrue(inverse.containsKey("apache"));
  assertTrue(inverse.containsKey("hadoop"));
  DataBag bag=(DataBag)inverse.get("apache");
  List resultList=new ArrayList<String>();
  Iterator<Tuple> i=bag.iterator();
  while (i.hasNext()) {
    Tuple t=i.next();
    resultList.add(t.get(0));
  }
  Collections.sort(resultList);
  assertEquals((String)resultList.get(0),"open");
  assertEquals((String)resultList.get(1),"source");
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringFuncs() throws Exception {
  String inputStr="Hello World!";
  String inputStrLower="hello world!";
  String inputStrUpper="HELLO WORLD!";
  String inputStrCamel="hello World!";
  String inputStroWitha="Hella Warld!";
  String inputStrSpaceRight="Hello World!   ";
  String inputStrSpaceLeft="   Hello World!";
  String inputStrSpaceBoth="   Hello World!   ";
  List l=new LinkedList();
  l.add(inputStr);
  l.add("o");
  String expected=null;
  Tuple input;
  String output;
  Integer intOutput;
  EvalFunc<String> strFunc;
  EvalFunc<Integer> intFunc;
  strFunc=new LCFIRST();
  input=TupleFactory.getInstance().newTuple(inputStr);
  expected=inputStrCamel;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new UCFIRST();
  input=TupleFactory.getInstance().newTuple(inputStrCamel);
  expected=inputStr;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  intFunc=new LAST_INDEX_OF();
  input=TupleFactory.getInstance().newTuple(l);
  intOutput=intFunc.exec(input);
  assertTrue(intOutput.intValue() == 7);
  intFunc=new INDEXOF();
  input=TupleFactory.getInstance().newTuple(l);
  intOutput=intFunc.exec(input);
  assertTrue(intOutput.intValue() == 4);
  strFunc=new UPPER();
  input=TupleFactory.getInstance().newTuple(inputStr);
  expected=inputStrUpper;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new LOWER();
  input=TupleFactory.getInstance().newTuple(inputStr);
  expected=inputStrLower;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new REPLACE();
  l.clear();
  l.add(inputStr);
  l.add("o");
  l.add("a");
  input=TupleFactory.getInstance().newTuple(l);
  expected=inputStroWitha;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new SUBSTRING();
  l.clear();
  l.add(inputStr);
  l.add(1);
  l.add(5);
  input=TupleFactory.getInstance().newTuple(l);
  expected="ello";
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new TRIM();
  input=TupleFactory.getInstance().newTuple(inputStrSpaceBoth);
  expected=inputStr;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new LTRIM();
  input=TupleFactory.getInstance().newTuple(inputStrSpaceLeft);
  expected=inputStr;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  strFunc=new RTRIM();
  input=TupleFactory.getInstance().newTuple(inputStrSpaceRight);
  expected=inputStr;
  output=strFunc.exec(input);
  assertTrue(output.equals(expected));
  STRSPLIT splitter=new STRSPLIT();
  Tuple test1=TupleFactory.getInstance().newTuple(1);
  Tuple test2=TupleFactory.getInstance().newTuple(2);
  Tuple test3=TupleFactory.getInstance().newTuple(3);
  test2.set(0,"foo");
  test2.set(1,":");
  Tuple splits=splitter.exec(test2);
  assertEquals("no matches should return tuple with original string",1,splits.size());
  assertEquals("no matches should return tuple with original string","foo",splits.get(0));
  test1.set(0,"f ooo bar");
  splits=splitter.exec(test1);
  assertEquals("split on default value ",3,splits.size());
  assertEquals("f",splits.get(0));
  assertEquals("ooo",splits.get(1));
  assertEquals("bar",splits.get(2));
  test1.set(0,"foo bar  ");
  splits=splitter.exec(test1);
  assertEquals("whitespace trimmed if no length arg",2,splits.size());
  test3.set(0,"foo bar   ");
  test3.set(1,"\\s");
  test3.set(2,10);
  splits=splitter.exec(test3);
  assertEquals("length forces empty string matches on end",5,splits.size());
  test3.set(0,"foo:bar:baz");
  test3.set(1,":");
  test3.set(2,2);
  splits=splitter.exec(test3);
  assertEquals(2,splits.size());
  assertEquals("foo",splits.get(0));
  assertEquals("bar:baz",splits.get(1));
  Tuple t1=TupleFactory.getInstance().newTuple(3);
  t1.set(0,"/search/iy/term1/test");
  t1.set(1,"^\\/search\\/iy\\/(.*?)\\/.*");
  t1.set(2,1);
  Tuple t2=TupleFactory.getInstance().newTuple(3);
  t2.set(0,"/search/iy/term1/test");
  t2.set(1,"^\\/search\\/iy\\/(.*?)\\/.*");
  t2.set(2,2);
  Tuple t3=TupleFactory.getInstance().newTuple(3);
  t3.set(0,null);
  t3.set(1,"^\\/search\\/iy\\/(.*?)\\/.*");
  t3.set(2,2);
  Tuple t4=tupleFactory.newTuple(3);
  t4.set(0,"this is a match");
  t4.set(1,"this is a (.+?)");
  t4.set(2,1);
  REGEX_EXTRACT func=new REGEX_EXTRACT();
  String r=func.exec(t1);
  assertTrue(r.equals("term1"));
  r=func.exec(t2);
  assertTrue(r == null);
  r=func.exec(t3);
  assertTrue(r == null);
  r=func.exec(t4);
  assertEquals("m",r);
  func=new REGEX_EXTRACT("true");
  r=func.exec(t4);
  assertEquals("match",r);
  String matchRegex="^(.+)\\b\\s+is a\\s+\\b(.+)$";
  TupleFactory tupleFactory=TupleFactory.getInstance();
  Tuple te1=tupleFactory.newTuple(2);
  te1.set(0,"this is a match");
  te1.set(1,matchRegex);
  Tuple te2=tupleFactory.newTuple(2);
  te2.set(0,"no match");
  te2.set(1,matchRegex);
  Tuple te3=tupleFactory.newTuple(2);
  te3.set(0,null);
  te3.set(1,matchRegex);
  REGEX_EXTRACT_ALL funce=new REGEX_EXTRACT_ALL();
  Tuple re=funce.exec(te1);
  assertEquals(re.size(),2);
  assertEquals("this",re.get(0));
  assertEquals("match",re.get(1));
  re=funce.exec(te2);
  assertTrue(re == null);
  re=funce.exec(te3);
  assertTrue(re == null);
  matchRegex="(.+?)(.+?)";
  tupleFactory=TupleFactory.getInstance();
  te1=tupleFactory.newTuple(2);
  te1.set(0,"this is a match");
  te1.set(1,matchRegex);
  funce=new REGEX_EXTRACT_ALL();
  re=funce.exec(te1);
  assertEquals(re.size(),2);
  assertEquals("t",re.get(0));
  assertEquals("his is a match",re.get(1));
  funce=new REGEX_EXTRACT_ALL("false");
  re=funce.exec(te1);
  assertEquals(re.size(),2);
  assertEquals("t",re.get(0));
  assertEquals("h",re.get(1));
  re=funce.exec(te2);
  assertTrue(re == null);
  re=funce.exec(te3);
  assertTrue(re == null);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleSize() throws Exception {
  String inputFileName="TupleSizeIn.txt";
  String[] inputData=new String[]{"Don't call my name, don't call my name, Alejandro","I'm not your babe, I'm not your babe, Fernando","Don't wanna kiss, don't wanna touch","Just smoke my cigarette and hush","Don't call my name, don't call my name, Roberto"};
  File inputFile=Util.createInputFile("tmp",inputFileName,inputData);
  pigServer.registerQuery("=> load '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' AS value:chararray;");
  pigServer.registerQuery("=> foreach @ generate STRSPLIT(value, ' ') AS values;");
  pigServer.registerQuery("C = foreach @ generate values, SIZE(values) as cnt;");
  Iterator<Tuple> it=pigServer.openIterator("C");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    assertEquals("Testing SIZE(<Tuple>): ",new Long(new StringTokenizer(inputData[i]).countTokens()),t.get(1));
    i++;
  }
  inputFile.delete();
  assertTrue(!it.hasNext());
  assertTrue(i == inputData.length);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAVG() throws Exception {
  String[] avgTypes={"AVG","DoubleAvg","LongAvg","IntAvg","FloatAvg","BigDecimalAvg","BigIntegerAvg"};
  for (int k=0; k < avgTypes.length; k++) {
    EvalFunc<?> avg=evalFuncMap.get(avgTypes[k]);
    Tuple tup=inputMap.get(getInputType(avgTypes[k]));
    Object output=avg.exec(tup);
    String msg="[Testing " + avgTypes[k] + " on input type: "+ getInputType(avgTypes[k])+ " ( (output) "+ output+ " == "+ getExpected(avgTypes[k])+ " (expected) )]";
    if (getInputType(avgTypes[k]) == "BigDecimal" || getInputType(avgTypes[k]) == "BigInteger") {
      assertEquals(msg,((BigDecimal)output).toPlainString(),((BigDecimal)getExpected(avgTypes[k])).toPlainString());
    }
 else {
      assertEquals(msg,(Double)output,(Double)getExpected(avgTypes[k]),0.00001);
    }
    assertNull(avg.exec(NULL_INPUT_TUPLE));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCase </h4><pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when case expression is missing,
 * and when branches do not contain conditional expressions.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingCaseExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE " + "    WHEN 0 THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when when expression is missing.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingWhenExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE i % 3" + "    WHEN   THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when when expression is missing.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingElseExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE i % 3" + "    WHEN 0 THEN '3n'"+ "    WHEN 1 THEN '3n+1'"+ "    ELSE "+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that FrontendException is thrown when when expression is missing.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingThenExpression() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FOREACH A GENERATE (" + "  CASE i % 3" + "    WHEN 0 THEN "+ "    WHEN 1 THEN '3n+1'"+ "    ELSE        '3n+2'"+ "  END"+ ");");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown for invalid case statement");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCharArrayToNumeric </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArrayToIntAndLongScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Long> map=new HashMap<Integer,Long>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      long value=rand.nextInt(100);
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input2.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.INTEGER,DataType.LONG};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input2.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.LONG) {
          Long expected=map.get(key);
          if (value != null) {
            Long actual=Long.parseLong(value);
            assertEquals(expected,actual);
          }
 else {
            assertEquals(expected,null);
          }
        }
        if (type == DataType.INTEGER) {
          Integer expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).intValue();
          }
          if (value != null) {
            Integer actual=Integer.parseInt(value);
            assertEquals(expected,actual);
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input2.txt");
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharArray2FloatAndDoubleScript() throws IOException {
  int size=100;
  String[] numbers=new String[size + 1];
  Random rand=new Random();
  Map<Integer,Double> map=new HashMap<Integer,Double>();
  try {
    for (int i=0; i < numbers.length; ++i) {
      int key=i;
      double value=rand.nextDouble() * 100;
      numbers[i]=(key + "\t" + value);
      map.put(key,value);
    }
    numbers[numbers.length - 1]=(numbers.length + "\t" + "null");
    map.put(numbers.length,null);
    Util.createInputFile(cluster,"pig_jira_893-input1.txt",numbers);
    byte[] numericTypes=new byte[]{DataType.DOUBLE,DataType.FLOAT};
    for (    byte type : numericTypes) {
      pig.registerQuery("A = Load 'pig_jira_893-input1.txt' AS " + "(key:int,value:chararray);");
      pig.registerQuery("B = FOREACH A GENERATE key,(" + DataType.findTypeName(type) + ")value;");
      Iterator<Tuple> iter=pig.openIterator("B");
      while (iter.hasNext()) {
        Tuple tuple=iter.next();
        Integer key=(Integer)tuple.get(0);
        String value=null;
        if (tuple.get(1) != null) {
          value=tuple.get(1).toString();
        }
        if (type == DataType.DOUBLE) {
          Double expected=map.get(key);
          if (value != null) {
            assertEquals(expected,(Double)Double.parseDouble(value));
          }
 else {
            assertNull(expected);
          }
        }
        if (type == DataType.FLOAT) {
          Float expected=null;
          if (map.get(key) != null) {
            expected=map.get(key).floatValue();
          }
          if (value != null) {
            assertEquals(expected,(Float)Float.parseFloat(value));
          }
 else {
            assertNull(expected);
          }
        }
      }
    }
  }
  finally {
    Util.deleteFile(cluster,"pig_jira_893-input1.txt");
  }
}

</code></pre>

<br>
<pre class="type-13 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCast() throws ExecException {
  POCast cast=new POCast(newOperatorKey(),-1);
  POProject proj=new POProject(newOperatorKey(),-1,0);
  proj.setResultType(DataType.CHARARRAY);
  List<PhysicalOperator> inputs=new ArrayList<PhysicalOperator>();
  inputs.add(proj);
  cast.setInputs(inputs);
  String[] items={"12.0","-13.2","0.1f","1.3e2","zjf",MaxDouble.toString(),MinDouble.toString()};
  Double[] doubleExpected={12.0,-13.2,0.1,1.3e2,null,MaxDouble,MinDouble};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Double actual=(Double)cast.getNextDouble().result;
    if (doubleExpected[i] != null) {
      assertEquals(doubleExpected[i],actual,1e-6);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"12.0","-13.2","0.1f","1.3e2",MaxFloat.toString(),MinFloat.toString(),"zjf"};
  Float[] floatExpected={12.0f,-13.2f,0.1f,1.3e2f,MaxFloat,MinFloat,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Float actual=(Float)cast.getNextFloat().result;
    if (floatExpected[i] != null) {
      assertEquals(floatExpected[i],actual,1e-6);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"1","-1","12.2","12.8",MaxLong.toString(),MinLong.toString(),"df1.2"};
  Long[] longExpected={1L,-1L,12L,12L,MaxLong,MinLong,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Long actual=(Long)cast.getNextLong().result;
    if (longExpected[i] != null) {
      assertEquals(longExpected[i],actual);
    }
 else {
      assertNull(actual);
    }
  }
  items=new String[]{"1","-1","12.2","12.8",MaxInteger.toString(),MinInteger.toString(),"ff4332"};
  Integer[] intExpected={1,-1,12,12,MaxInteger,MinInteger,null};
  for (int i=0; i < items.length; ++i) {
    Tuple tuple=TupleFactory.getInstance().newTuple(1);
    tuple.set(0,items[i]);
    proj.attachInput(tuple);
    Integer actual=(Integer)cast.getNextInteger().result;
    if (intExpected[i] != null) {
      assertEquals(intExpected[i],actual);
    }
 else {
      assertNull(actual);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCmdLineParser </h4><pre class="type-6 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParseException.class) public void testParseUnknownShort() throws Exception {
  String[] args={"-alpha","b","-z"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  try {
    p.getNextOpt();
    assertEquals("b",p.getValStr());
    p.getNextOpt();
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Found unknown option (-z) at position 3");
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseLongShortLeftover3() throws ParseException {
  String[] args={"-a","--beta","5","--c","--"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.NOT_ACCEPTED);
  p.registerOpt('b',"beta",CmdLineParser.ValueExpected.REQUIRED);
  p.registerOpt('c',null,CmdLineParser.ValueExpected.OPTIONAL);
  assertEquals('a',p.getNextOpt());
  assertEquals('b',p.getNextOpt());
  Integer ii=p.getValInt();
  assertEquals(5,ii.intValue());
  assertEquals('c',p.getNextOpt());
  assertNull(p.getValInt());
  assertEquals(CmdLineParser.EndOfOpts,p.getNextOpt());
  String[] r=p.getRemainingArgs();
  assertNull(p.getRemainingArgs());
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParseException.class) public void testParseValueRequiredNotProvided2() throws Exception {
  String[] args={"--alpha","-b"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  p.registerOpt('b',"beta",CmdLineParser.ValueExpected.NOT_ACCEPTED);
  try {
    p.getNextOpt();
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Option --alpha requires a value but you did not provide one.");
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParseException.class) public void testParseUnknownLong() throws Exception {
  String[] args={"--zeta"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  try {
    p.getNextOpt();
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Found unknown option (--zeta) at position 1");
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=AssertionError.class) public void testDoubleRegisterShort(){
  String[] args={"a","b","c"};
  CmdLineParser p=new CmdLineParser(args);
  try {
    p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.NOT_ACCEPTED);
    p.registerOpt('a',"beta",CmdLineParser.ValueExpected.NOT_ACCEPTED);
    fail("Should have thrown an AssertionError");
  }
 catch (  AssertionError e) {
    assertEquals(e.getMessage(),"CmdLineParser:  You have already registered option a");
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParseLongShortNoLeftover() throws ParseException {
  String[] args={"-a","--beta","beth","--c"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.NOT_ACCEPTED);
  p.registerOpt('b',"beta",CmdLineParser.ValueExpected.REQUIRED);
  p.registerOpt('c',null,CmdLineParser.ValueExpected.OPTIONAL);
  assertEquals('a',p.getNextOpt());
  assertEquals('b',p.getNextOpt());
  assertEquals("beth",p.getValStr());
  assertEquals('c',p.getNextOpt());
  assertNull(p.getValStr());
  assertEquals(CmdLineParser.EndOfOpts,p.getNextOpt());
  assertNull(p.getRemainingArgs());
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParseException.class) public void testParseValueRequiredNotProvided1() throws Exception {
  String[] args={"-a"};
  CmdLineParser p=new CmdLineParser(args);
  p.registerOpt('a',"alpha",CmdLineParser.ValueExpected.REQUIRED);
  try {
    p.getNextOpt();
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Option -a requires a value but you did not provide one.");
    throw e;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCollectedGroup </h4><pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupByStar() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  try {
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
    DataBag dbshj=BagFactory.getInstance().newDefaultBag();
{
      pigServer.registerQuery("B = group A by * using 'collected';");
      pigServer.registerQuery("C = foreach B generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("C");
      while (iter.hasNext()) {
        dbfrj.add(iter.next());
      }
    }
{
      pigServer.registerQuery("D = group A by *;");
      pigServer.registerQuery("E = foreach D generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("E");
      while (iter.hasNext()) {
        dbshj.add(iter.next());
      }
    }
    Assert.assertTrue(dbfrj.size() > 0 && dbshj.size() > 0);
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupParserNoSupportForMultipleInputs() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, grade);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name, grade);");
  try {
    pigServer.registerQuery("C = group A by id, B by id using 'collected';");
    pigServer.openIterator("C");
    Assert.fail("Pig doesn't support multi-input collected group.");
  }
 catch (  Exception e) {
    String msg="pig script failed to validate: Collected group is only supported for single input";
    Assert.assertTrue(e.getMessage().contains(msg));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupParserNoSupportForByExpression() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, grade);");
  try {
    pigServer.registerQuery("B = group A by id*grade using 'collected';");
    pigServer.openIterator("B");
    Assert.fail("Pig doesn't support collected group by expression.");
  }
 catch (  Exception e) {
    String msg="pig script failed to validate: Collected group is only supported for columns or star projection";
    Assert.assertTrue(e.getMessage().contains(msg));
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupParserNoSupportForGroupAll() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, grade);");
  try {
    pigServer.registerQuery("B = group A all using 'collected';");
    pigServer.openIterator("B");
    Assert.fail("Pig doesn't support collected group all.");
  }
 catch (  Exception e) {
    String msg="pig script failed to validate: Collected group is only supported for columns or star projection";
    Assert.assertTrue(e.getMessage().contains(msg));
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupWithMergeJoin() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  try {
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
    DataBag dbshj=BagFactory.getInstance().newDefaultBag();
{
      pigServer.registerQuery("C = join A by id, B by id using 'merge';");
      pigServer.registerQuery("D = group C by A::id using 'collected';");
      pigServer.registerQuery("E = foreach D generate group, COUNT(C);");
      Iterator<Tuple> iter=pigServer.openIterator("E");
      while (iter.hasNext()) {
        dbfrj.add(iter.next());
      }
    }
{
      pigServer.registerQuery("F = join A by id, B by id;");
      pigServer.registerQuery("G = group F by A::id;");
      pigServer.registerQuery("H = foreach G generate group, COUNT(F);");
      Iterator<Tuple> iter=pigServer.openIterator("H");
      while (iter.hasNext()) {
        dbshj.add(iter.next());
      }
    }
    Assert.assertTrue(dbfrj.size() > 0 && dbshj.size() > 0);
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupByOneColumn() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  try {
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
    DataBag dbshj=BagFactory.getInstance().newDefaultBag();
{
      pigServer.registerQuery("B = group A by id using 'collected';");
      pigServer.registerQuery("C = foreach B generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("C");
      while (iter.hasNext()) {
        dbfrj.add(iter.next());
      }
    }
{
      pigServer.registerQuery("D = group A by id;");
      pigServer.registerQuery("E = foreach D generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("E");
      while (iter.hasNext()) {
        dbshj.add(iter.next());
      }
    }
    Assert.assertTrue(dbfrj.size() > 0 && dbshj.size() > 0);
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapsideGroupByMultipleColumns() throws IOException {
  pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' using "+ DummyCollectableLoader.class.getName()+ "() as (id, name, grade);");
  try {
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag();
    DataBag dbshj=BagFactory.getInstance().newDefaultBag();
{
      pigServer.registerQuery("B = group A by (id, name) using 'collected';");
      pigServer.registerQuery("C = foreach B generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("C");
      while (iter.hasNext()) {
        dbfrj.add(iter.next());
      }
    }
{
      pigServer.registerQuery("D = group A by (id, name);");
      pigServer.registerQuery("E = foreach D generate group, COUNT(A);");
      Iterator<Tuple> iter=pigServer.openIterator("E");
      while (iter.hasNext()) {
        dbshj.add(iter.next());
      }
    }
    Assert.assertTrue(dbfrj.size() > 0 && dbshj.size() > 0);
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonCollectableLoader() throws Exception {
  String query="A = LOAD '" + INPUT_FILE + "' as (id, name, grade);"+ "B = group A by id using 'collected';";
  PigContext pc=new PigContext(cluster.getExecType(),cluster.getProperties());
  pc.connect();
  try {
    Util.buildMRPlan(Util.buildPp(pigServer,query),pc);
    Assert.fail("Must throw MRCompiler Exception");
  }
 catch (  Exception e) {
    Assert.assertTrue(e instanceof MRCompilerException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCombiner </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctAggs1() throws Exception {
  String input[]={"pig1\t18\t2.1","pig2\t24\t3.3","pig5\t45\t2.4","pig1\t18\t2.1","pig1\t19\t2.1","pig2\t24\t4.5","pig1\t20\t3.1"};
  Util.createInputFile(cluster,"distinctAggs1Input.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'distinctAggs1Input.txt' as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = foreach b  {" + "        x = distinct a.age;" + "        y = distinct a.gpa;"+ "        z = distinct a;"+ "        generate group, COUNT(x), SUM(x.age), SUM(y.gpa), SUM(a.age), "+ "                       SUM(a.gpa), COUNT(z.age), COUNT(z), SUM(z.age);};");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertTrue(baos.toString().matches("(?si).*combine plan.*"));
  HashMap<String,Object[]> results=new HashMap<String,Object[]>();
  results.put("pig1",new Object[]{"pig1",3L,57L,5.2,75L,9.4,3L,3L,57L});
  results.put("pig2",new Object[]{"pig2",1L,24L,7.8,48L,7.8,2L,2L,48L});
  results.put("pig5",new Object[]{"pig5",1L,45L,2.4,45L,2.4,1L,1L,45L});
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    List fields=t.getAll();
    Object[] expected=results.get(fields.get(0));
    int i=0;
    for (    Object field : fields) {
      assertEquals(expected[i++],field);
    }
  }
  Util.deleteFile(cluster,"distinctAggs1Input.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEachNoCombiner() throws Exception {
  String input[]={"pig1\t18\t2.1","pig2\t24\t3.3","pig5\t45\t2.4","pig1\t18\t2.1","pig1\t19\t2.1","pig2\t24\t4.5","pig1\t20\t3.1"};
  Util.createInputFile(cluster,"forEachNoCombinerInput.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'forEachNoCombinerInput.txt' as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = foreach b  {" + "        z = a.age;" + "        generate group, z, SUM(a.age), SUM(a.gpa);};");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertFalse(baos.toString().matches("(?si).*combine plan.*"));
  HashMap<String,Object[]> results=new HashMap<String,Object[]>();
  results.put("pig1",new Object[]{"pig1","bag-place-holder",75L,9.4});
  results.put("pig2",new Object[]{"pig2","bag-place-holder",48L,7.8});
  results.put("pig5",new Object[]{"pig5","bag-place-holder",45L,2.4});
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    List fields=t.getAll();
    Object[] expected=results.get(fields.get(0));
    int i=0;
    for (    Object field : fields) {
      if (i == 1) {
        continue;
      }
      assertEquals(expected[i++],field);
    }
  }
  Util.deleteFile(cluster,"forEachNoCombinerInput.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiCombinerUse() throws Exception {
  String[] input=new String[500 * 1024];
  for (int i=0; i < input.length; i++) {
    if (i % 2 == 0) {
      input[i]=Integer.toString(1);
    }
 else {
      input[i]=Integer.toString(0);
    }
  }
  Util.createInputFile(cluster,"MultiCombinerUseInput.txt",input);
  String oldValue=properties.getProperty("io.sort.mb");
  properties.setProperty("io.sort.mb","1");
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.getPigContext().getProperties().setProperty(MRConfiguration.CHILD_JAVA_OPTS,"-Xmx1024m");
  pigServer.registerQuery("a = load 'MultiCombinerUseInput.txt' as (x:int);");
  pigServer.registerQuery("b = group a all;");
  pigServer.registerQuery("c = foreach b generate COUNT(a), SUM(a.$0), " + "MIN(a.$0), MAX(a.$0), AVG(a.$0), ((double)SUM(a.$0))/COUNT(a.$0)," + " COUNT(a.$0) + SUM(a.$0) +  MAX(a.$0);");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertTrue(baos.toString().matches("(?si).*combine plan.*"));
  Iterator<Tuple> it=pigServer.openIterator("c");
  Tuple t=it.next();
  assertEquals(512000L,t.get(0));
  assertEquals(256000L,t.get(1));
  assertEquals(0,t.get(2));
  assertEquals(1,t.get(3));
  assertEquals(0.5,t.get(4));
  assertEquals(0.5,t.get(5));
  assertEquals(512000L + 256000L + 1,t.get(6));
  assertFalse(it.hasNext());
  Util.deleteFile(cluster,"MultiCombinerUseInput.txt");
  if (oldValue == null) {
    properties.remove("io.sort.mb");
  }
 else {
    properties.setProperty("io.sort.mb",oldValue);
  }
  pigServer.shutdown();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctNoCombiner() throws Exception {
  String input[]={"pig1\t18\t2.1","pig2\t24\t3.3","pig5\t45\t2.4","pig1\t18\t2.1","pig1\t19\t2.1","pig2\t24\t4.5","pig1\t20\t3.1"};
  Util.createInputFile(cluster,"distinctNoCombinerInput.txt",input);
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.registerQuery("a = load 'distinctNoCombinerInput.txt' as (name:chararray, age:int, gpa:double);");
  pigServer.registerQuery("b = group a by name;");
  pigServer.registerQuery("c = foreach b  {" + "        z = distinct a;" + "        generate group, z, SUM(a.age), SUM(a.gpa);};");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pigServer.explain("c",ps);
  assertFalse(baos.toString().matches("(?si).*combine plan.*"));
  HashMap<String,Object[]> results=new HashMap<String,Object[]>();
  results.put("pig1",new Object[]{"pig1","bag-place-holder",75L,9.4});
  results.put("pig2",new Object[]{"pig2","bag-place-holder",48L,7.8});
  results.put("pig5",new Object[]{"pig5","bag-place-holder",45L,2.4});
  Iterator<Tuple> it=pigServer.openIterator("c");
  while (it.hasNext()) {
    Tuple t=it.next();
    List fields=t.getAll();
    Object[] expected=results.get(fields.get(0));
    int i=0;
    for (    Object field : fields) {
      if (i == 1) {
        continue;
      }
      assertEquals(expected[i++],field);
    }
  }
  Util.deleteFile(cluster,"distinctNoCombinerInput.txt");
  pigServer.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCommit </h4><pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckin2() throws Exception {
  Tuple expected1=mTf.newTuple(4);
  Tuple expected2=mTf.newTuple(4);
  File testFile=Util.createInputFile("tmp","testCheckin2-input.txt",new String[]{"joe smith:18:3.5","amy brown:18:2.5","jim fox:20:4.0","leo fu:55:3.0","amy smith:20:3.0"});
  expected1.set(0,18);
  expected1.set(1,1L);
  expected1.set(2,"joe smith");
  expected1.set(3,18);
  expected2.set(0,55);
  expected2.set(1,1L);
  expected2.set(2,"leo fu");
  expected2.set(3,55);
  pigServer.registerQuery("a = load '" + Util.encodeEscape(testFile.getAbsolutePath()) + "' using "+ PigStorage.class.getName()+ "(':') as (name: chararray, age: int, gpa: float);");
  pigServer.registerQuery("b = group @ by age;");
  pigServer.registerQuery("c = foreach @ { d = filter a by gpa > 2.5;  " + "e = order a by name; f = a.age; g = distinct f; " + " generate group, COUNT(d), MAX (e.name), MIN(g.$0);};");
  pigServer.registerQuery("h = order c by $1;");
  pigServer.registerQuery("i = limit @ 2;");
  pigServer.store("i","testCheckin2-output.txt");
  pigServer.registerQuery("x = load 'testCheckin2-output.txt' as (age: int, cnt: long, max: chararray, min: int);");
  pigServer.registerQuery("y = foreach @ generate age, cnt, max, min;");
  Iterator<Tuple> iter=pigServer.openIterator("y");
  int count=0;
  boolean contain1=false, contain2=false;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    count++;
    if (t.get(0).equals(expected1.get(0)) && t.get(1).equals(expected1.get(1)) && t.get(2).equals(expected1.get(2))&& t.get(3).equals(expected1.get(3))) {
      contain1=true;
    }
    if (t.get(0).equals(expected2.get(0)) && t.get(1).equals(expected2.get(1)) && t.get(2).equals(expected2.get(2))&& t.get(3).equals(expected2.get(3))) {
      contain2=true;
    }
  }
  pigServer.deleteFile("testCheckin2-output.txt");
  assertEquals(2,count);
  assertTrue(contain1);
  assertTrue(contain2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCompressedFiles </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompressed2() throws Throwable {
  pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("A = load '" + Util.generateURI(gzFile.toString(),pig.getPigContext()) + "';");
  DataBag dbGz=BagFactory.getInstance().newDefaultBag(), dbDt=BagFactory.getInstance().newDefaultBag();
{
    Iterator<Tuple> iter=pig.openIterator("A");
    while (iter.hasNext()) {
      dbGz.add(iter.next());
    }
  }
  pig.registerQuery("B = load '" + Util.generateURI(datFile.toString(),pig.getPigContext()) + "';");
  Iterator<Tuple> iter=pig.openIterator("B");
  while (iter.hasNext()) {
    dbDt.add(iter.next());
  }
  assertTrue(dbGz.size() > 0);
  assertTrue(dbDt.size() > 0);
  assertEquals(dbGz.size(),dbDt.size());
  assertTrue(TestHelper.compareBags(dbGz,dbDt));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestConstExpr </h4><pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDataByteArray() throws ExecException {
  DataByteArray inp=GenRandomData.genRandDBA(r);
  ce.setValue(inp);
  Result resba=ce.getNextDataByteArray();
  DataByteArray ret=(DataByteArray)resba.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resba=ce.getNextDataByteArray();
  ret=(DataByteArray)resba.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple() throws ExecException {
  Tuple inp=GenRandomData.genRandSmallBagTuple(r,10,100);
  ce.setValue(inp);
  Result rest=ce.getNextTuple();
  Tuple ret=(Tuple)rest.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  rest=ce.getNextTuple();
  ret=(Tuple)rest.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextInteger() throws ExecException {
  Integer inp=r.nextInt();
  ce.setValue(inp);
  Result resi=ce.getNextInteger();
  Integer ret=(Integer)resi.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resi=ce.getNextInteger();
  ret=(Integer)resi.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextLong() throws ExecException {
  Long inp=r.nextLong();
  ce.setValue(inp);
  Result resl=ce.getNextLong();
  Long ret=(Long)resl.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resl=ce.getNextLong();
  ret=(Long)resl.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDouble() throws ExecException {
  Double inp=r.nextDouble();
  ce.setValue(inp);
  Result resd=ce.getNextDouble();
  Double ret=(Double)resd.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resd=ce.getNextDouble();
  ret=(Double)resd.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextFloat() throws ExecException {
  Float inp=r.nextFloat();
  ce.setValue(inp);
  Result resf=ce.getNextFloat();
  Float ret=(Float)resf.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resf=ce.getNextFloat();
  ret=(Float)resf.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextString() throws ExecException {
  String inp=GenRandomData.genRandString(r);
  ce.setValue(inp);
  Result ress=ce.getNextString();
  String ret=(String)ress.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  ress=ce.getNextString();
  ret=(String)ress.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextMap() throws ExecException {
  Map<String,Object> inp=GenRandomData.genRandMap(r,10);
  ce.setValue(inp);
  Result resm=ce.getNextMap();
  Map<Integer,String> ret=(Map)resm.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  resm=ce.getNextMap();
  ret=(Map)resm.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextBoolean() throws ExecException {
  Boolean inp=r.nextBoolean();
  ce.setValue(inp);
  Result res=ce.getNextBoolean();
  Boolean ret=(Boolean)res.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  res=ce.getNextBoolean();
  ret=(Boolean)res.result;
  assertNull(ret);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextDataBag() throws ExecException {
  DataBag inp=GenRandomData.genRandSmallTupDataBag(r,10,100);
  ce.setValue(inp);
  Result res=ce.getNextDataBag();
  DataBag ret=(DataBag)res.result;
  assertEquals(inp,ret);
  ce.setValue(null);
  res=ce.getNextDataBag();
  ret=(DataBag)res.result;
  assertNull(ret);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestConversions </h4><pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToBoolean() throws IOException {
  String[] a={"true","True","TRUE","false","False","FALSE"};
  Boolean[] b={Boolean.TRUE,Boolean.TRUE,Boolean.TRUE,Boolean.FALSE,Boolean.FALSE,Boolean.FALSE};
  for (int i=0; i < b.length; ++i) {
    byte[] bytes=a[i].getBytes();
    assertEquals(b[i],ps.getLoadCaster().bytesToBoolean(bytes));
  }
  a=new String[]{"neither true nor false"};
  for (  String s : a) {
    byte[] bytes=s.getBytes();
    Boolean bool=ps.getLoadCaster().bytesToBoolean(bytes);
    assertNull(bool);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToTupleWithConversion() throws IOException {
  for (int i=0; i < 100; i++) {
    Tuple t=GenRandomData.genMixedTupleToConvert(r);
    ResourceFieldSchema fs=GenRandomData.getMixedTupleToConvertFieldSchema();
    Tuple convertedTuple=ps.getLoadCaster().bytesToTuple(t.toString().getBytes(),fs);
    assertTrue(convertedTuple.get(0) instanceof String);
    assertEquals(convertedTuple.get(0),((Integer)t.get(0)).toString());
    assertTrue(convertedTuple.get(1) instanceof Long);
    Integer origValue1=(Integer)t.get(1);
    assertEquals(convertedTuple.get(1),Long.valueOf(origValue1.longValue()));
    assertNull(convertedTuple.get(2));
    assertTrue(convertedTuple.get(3) instanceof Double);
    Float origValue3=(Float)t.get(3);
    assertEquals(((Double)convertedTuple.get(3)).doubleValue(),origValue3.doubleValue(),0.01);
    assertTrue(convertedTuple.get(4) instanceof Float);
    Double origValue4=(Double)t.get(4);
    assertEquals((Float)convertedTuple.get(4),origValue4.floatValue(),0.01);
    assertTrue(convertedTuple.get(5) instanceof String);
    assertEquals(convertedTuple.get(5),t.get(5));
    assertNull(convertedTuple.get(6));
    assertNull(convertedTuple.get(7));
    assertNull(convertedTuple.get(8));
    assertTrue(convertedTuple.get(9) instanceof Boolean);
    String origValue9=(String)t.get(9);
    assertEquals(Boolean.valueOf(origValue9),convertedTuple.get(9));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToLong() throws IOException {
  String[] a={"1703598819951657279 "," 999888123L  "," 1234 "," 1234","1234 ","1","-2345","123456789012345678","1.1","-23.45","21345345","3422342",""};
  Long[] la={1703598819951657279L,999888123L,1234L,1234L,1234L,1L,-2345L,123456789012345678L,1L,-23L,21345345L,3422342L};
  for (int i=0; i < la.length; i++) {
    byte[] b=a[i].getBytes();
    assertEquals(la[i],ps.getLoadCaster().bytesToLong(b));
  }
  a=new String[]{"This is a long","1.0e1000","","    "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Long l=ps.getLoadCaster().bytesToLong(b);
    assertNull(l);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToComplexTypeMisc() throws IOException, ParserException {
  String s="(a,b";
  Schema schema=Utils.getSchemaFromString("t:tuple(a:chararray, b:chararray)");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Tuple t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertNull(t);
  s="{(a,b}";
  schema=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:chararray)}");
  rfs=new ResourceSchema(schema).getFields()[0];
  DataBag b=ps.getLoadCaster().bytesToBag(s.getBytes(),rfs);
  assertNull(b);
  s="{(a,b)";
  schema=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:chararray)}");
  rfs=new ResourceSchema(schema).getFields()[0];
  b=ps.getLoadCaster().bytesToBag(s.getBytes(),rfs);
  assertNull(b);
  s="[ab]";
  schema=Utils.getSchemaFromString("m:map[chararray]");
  rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#b";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#]";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  Map.Entry<String,Object> entry=m.entrySet().iterator().next();
  assertEquals("a",entry.getKey());
  assertNull(entry.getValue());
  s="[#]";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#}";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[a#)";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertNull(m);
  s="[]";
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  assertTrue(m.isEmpty());
  s="(a,b)";
  schema=Utils.getSchemaFromString("t:tuple()");
  rfs=new ResourceSchema(schema).getFields()[0];
  t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertEquals(2,t.size());
  assertTrue(t.get(0) instanceof DataByteArray);
  assertEquals("a",t.get(0).toString());
  assertTrue(t.get(1) instanceof DataByteArray);
  assertEquals("b",t.get(1).toString());
  s="[a#(1,2,3)]";
  schema=Utils.getSchemaFromString("m:map[]");
  rfs=new ResourceSchema(schema).getFields()[0];
  m=ps.getLoadCaster().bytesToMap(s.getBytes(),rfs);
  entry=m.entrySet().iterator().next();
  assertEquals("a",entry.getKey());
  assertTrue(entry.getValue() instanceof DataByteArray);
  assertEquals("(1,2,3)",entry.getValue().toString());
  s="(a,b,(123,456,{(1,2,3)}))";
  schema=Utils.getSchemaFromString("t:tuple()");
  rfs=new ResourceSchema(schema).getFields()[0];
  t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertTrue(t.size() == 3);
  assertTrue(t.get(0) instanceof DataByteArray);
  assertEquals("a",t.get(0).toString());
  assertTrue(t.get(1) instanceof DataByteArray);
  assertEquals("b",t.get(1).toString());
  assertTrue(t.get(2) instanceof DataByteArray);
  assertEquals("(123,456,{(1,2,3)})",t.get(2).toString());
  s="(a,b,(123,456,{(1,2,3}))";
  schema=Utils.getSchemaFromString("t:tuple()");
  rfs=new ResourceSchema(schema).getFields()[0];
  t=ps.getLoadCaster().bytesToTuple(s.getBytes(),rfs);
  assertNull(t);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToInteger() throws IOException {
  String[] a={"1234 "," 4321"," 12345 ","1","-2345","1234567","1.1","-23.45",""};
  Integer[] ia={1234,4321,12345,1,-2345,1234567,1,-23};
  for (int i=0; i < ia.length; i++) {
    byte[] b=a[i].getBytes();
    assertEquals(ia[i],ps.getLoadCaster().bytesToInteger(b));
  }
  a=new String[]{"1234567890123456","This is an int","","   "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Integer i=ps.getLoadCaster().bytesToInteger(b);
    assertNull(i);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToBagWithConversion() throws IOException {
  DataBag b=GenRandomData.genFloatDataBag(r,5,100);
  ResourceFieldSchema fs=GenRandomData.getFloatDataBagFieldSchema(5);
  DataBag convertedBag=ps.getLoadCaster().bytesToBag(b.toString().getBytes(),fs);
  Iterator<Tuple> iter1=b.iterator();
  Iterator<Tuple> iter2=convertedBag.iterator();
  for (int i=0; i < 100; i++) {
    Tuple t1=(Tuple)iter1.next();
    assertTrue(iter2.hasNext());
    Tuple t2=(Tuple)iter2.next();
    for (int j=0; j < 5; j++) {
      assertTrue(t2.get(j) instanceof Integer);
      Integer expectedValue=((Float)t1.get(j)).intValue();
      assertEquals(expectedValue,t2.get(j));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToFloat() throws IOException {
  String[] a={"1","-2.345","12.12334567","1.02e-2",".23344","23.1234567897","12312.33","002312.33","1.02e-2",""};
  Float[] f={1f,-2.345f,12.12334567f,1.02e-2f,.23344f,23.1234567f,12312.33f,2312.33f,1.02e-2f};
  for (int j=0; j < f.length; j++) {
    byte[] b=a[j].getBytes();
    assertEquals(f[j],ps.getLoadCaster().bytesToFloat(b));
  }
  a=new String[]{"1a.1","23.1234567a890123456","This is a float","","  "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Float fl=ps.getLoadCaster().bytesToFloat(b);
    assertNull(fl);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesToDouble() throws IOException {
  String[] a={"1","-2.345","12.12334567890123456","1.02e12","-.23344",""};
  Double[] d={1.0,-2.345,12.12334567890123456,1.02e12,-.23344};
  for (int j=0; j < d.length; j++) {
    byte[] b=a[j].getBytes();
    assertEquals(d[j],ps.getLoadCaster().bytesToDouble(b));
  }
  a=new String[]{"-0x1.1","-23a.45","This is a double","","   "};
  for (  String s : a) {
    byte[] b=s.getBytes();
    Double dl=ps.getLoadCaster().bytesToDouble(b);
    assertNull(dl);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCounters </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryStores() throws Exception {
  int[] nums=new int[100];
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  for (int i=0; i < MAX; i++) {
    int t=r.nextInt(100);
    pw.println(t);
    nums[t]++;
  }
  pw.close();
  int groups=0;
  for (  int i : nums) {
    if (i > 0)     groups++;
  }
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = filter a by $0 >= 50;");
  pigServer.registerQuery("c = group b by $0;");
  pigServer.registerQuery("d = foreach c generate group;");
  pigServer.registerQuery("e = filter a by $0 < 50;");
  pigServer.registerQuery("f = group e by $0;");
  pigServer.registerQuery("g = foreach f generate group;");
  pigServer.registerQuery("store d into '/tmp/outout1';");
  pigServer.registerQuery("store g into '/tmp/outout2';");
  List<ExecJob> jobs=pigServer.executeBatch();
  PigStats stats=jobs.get(0).getStatistics();
  assertTrue(stats.getOutputLocations().size() == 2);
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("/tmp/outout1"),true);
  cluster.getFileSystem().delete(new Path("/tmp/outout2"),true);
  MRJobStats js=(MRJobStats)stats.getJobGraph().getSinks().get(0);
  Map<String,Long> entry=js.getMultiStoreCounters();
  long counter=0;
  for (  Long val : entry.values()) {
    counter+=val;
  }
  assertEquals(groups,counter);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapOnlyMultiQueryStores() throws Exception {
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,file));
  for (int i=0; i < MAX; i++) {
    int t=r.nextInt(100);
    pw.println(t);
  }
  pw.close();
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.registerQuery("a = load '" + file + "';");
  pigServer.registerQuery("b = filter a by $0 > 50;");
  pigServer.registerQuery("c = filter a by $0 <= 50;");
  pigServer.registerQuery("store b into '/tmp/outout1';");
  pigServer.registerQuery("store c into '/tmp/outout2';");
  List<ExecJob> jobs=pigServer.executeBatch();
  PigStats stats=jobs.get(0).getStatistics();
  assertTrue(stats.getOutputLocations().size() == 2);
  cluster.getFileSystem().delete(new Path(file),true);
  cluster.getFileSystem().delete(new Path("/tmp/outout1"),true);
  cluster.getFileSystem().delete(new Path("/tmp/outout2"),true);
  MRJobStats js=(MRJobStats)stats.getJobGraph().getSinks().get(0);
  Map<String,Long> entry=js.getMultiStoreCounters();
  long counter=0;
  for (  Long val : entry.values()) {
    counter+=val;
  }
  assertEquals(MAX,counter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCubeDimensions </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCube() throws IOException {
  Tuple t=TF.newTuple(ImmutableList.of("a","b","c"));
  Set<Tuple> expected=ImmutableSet.of(TF.newTuple(ImmutableList.of("a","b","c")),TF.newTuple(ImmutableList.of("a","b","ALL")),TF.newTuple(ImmutableList.of("a","ALL","c")),TF.newTuple(ImmutableList.of("ALL","b","c")),TF.newTuple(ImmutableList.of("ALL","ALL","c")),TF.newTuple(ImmutableList.of("a","ALL","ALL")),TF.newTuple(ImmutableList.of("ALL","ALL","ALL")),TF.newTuple(ImmutableList.of("ALL","b","ALL")));
  CubeDimensions cd=new CubeDimensions("ALL");
  DataBag bag=cd.exec(t);
  assertEquals(bag.size(),expected.size());
  for (  Tuple tup : bag) {
    assertTrue(expected.contains(tup));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCubeOperator </h4><pre class="type-6 type-4 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIllustrate() throws Exception {
  Assume.assumeTrue("illustrate does not work in tez (PIG-3993)",!Util.getLocalTestMode().toString().startsWith("TEZ"));
  String query="a = load 'input' USING mock.Storage() as (a1:chararray,b1:chararray,c1:long); " + "b = cube a by cube(a1,b1);";
  Util.registerMultiLineQuery(pigServer,query);
  Map<Operator,DataBag> examples=pigServer.getExamples("b");
  assertTrue(examples != null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestCustomPartitioner </h4><pre class="type-13 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomPartitionerDistinct() throws Exception {
  String[] input={"1\t1","2\t1","1\t1","3\t1","4\t1"};
  Util.createInputFile(cluster,"table_testCustomPartitionerDistinct",input);
  String outputDir="tmp_testCustomPartitionerDistinct";
  pigServer.registerQuery("A = LOAD 'table_testCustomPartitionerDistinct' as (a0:int, a1:int);");
  pigServer.registerQuery("B = distinct A PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner3 parallel 2;");
  pigServer.store("B",outputDir);
  new File(outputDir).mkdir();
  FileStatus[] outputFiles=fs.listStatus(new Path(outputDir),Util.getSuccessMarkerPathFilter());
  Util.copyFromClusterToLocal(cluster,outputFiles[0].getPath().toString(),outputDir + "/" + 0);
  BufferedReader reader=new BufferedReader(new FileReader(outputDir + "/" + 0));
  while (reader.readLine() != null) {
    Assert.fail("Partition 0 should be empty.  Most likely Custom Partitioner was not used.");
  }
  reader.close();
  Util.copyFromClusterToLocal(cluster,outputFiles[1].getPath().toString(),outputDir + "/" + 1);
  reader=new BufferedReader(new FileReader(outputDir + "/" + 1));
  int count=0;
  while (reader.readLine() != null) {
    count++;
  }
  reader.close();
  Assert.assertEquals(4,count);
  Util.deleteDirectory(new File(outputDir));
  Util.deleteFile(cluster,outputDir);
  Util.deleteFile(cluster,"table_testCustomPartitionerDistinct");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomPartitionerParseJoins() throws Exception {
  String[] input={"1\t3","1\t2"};
  Util.createInputFile(cluster,"table_testCustomPartitionerParseJoins",input);
  try {
    pigServer.registerQuery("A = LOAD 'table_testCustomPartitionerParseJoins' as (a0:int, a1:int);");
    pigServer.registerQuery("B = ORDER A by $0;");
    pigServer.registerQuery("skewed = JOIN A by $0, B by $0 USING 'skewed' PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner;");
    Assert.fail("Skewed join cannot accept a custom partitioner");
  }
 catch (  FrontendException e) {
    Assert.assertTrue(e.getMessage().contains("Custom Partitioner is not supported for skewed join"));
  }
  pigServer.registerQuery("hash = JOIN A by $0, B by $0 USING 'hash' PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner;");
  Iterator<Tuple> iter=pigServer.openIterator("hash");
  List<String> expected=new ArrayList<String>();
  expected.add("(1,3,1,2)");
  expected.add("(1,3,1,3)");
  expected.add("(1,2,1,2)");
  expected.add("(1,2,1,3)");
  Collections.sort(expected);
  List<String> actual=new ArrayList<String>();
  while (iter.hasNext()) {
    actual.add(iter.next().toString());
  }
  Collections.sort(actual);
  Assert.assertEquals(expected,actual);
  Util.deleteFile(cluster,"table_testCustomPartitionerParseJoins");
}

</code></pre>

<br>
<pre class="type-13 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomPartitionerGroups() throws Exception {
  String[] input={"1\t1","2\t1","3\t1","4\t1"};
  Util.createInputFile(cluster,"table_testCustomPartitionerGroups",input);
  String outputDir="tmp_testCustomPartitionerGroup";
  pigServer.registerQuery("A = LOAD 'table_testCustomPartitionerGroups' as (a0:int, a1:int);");
  pigServer.registerQuery("B = group A by $0 PARTITION BY org.apache.pig.test.utils.SimpleCustomPartitioner3 parallel 2;");
  pigServer.store("B",outputDir);
  new File(outputDir).mkdir();
  FileStatus[] outputFiles=fs.listStatus(new Path(outputDir),Util.getSuccessMarkerPathFilter());
  Util.copyFromClusterToLocal(cluster,outputFiles[0].getPath().toString(),outputDir + "/" + 0);
  BufferedReader reader=new BufferedReader(new FileReader(outputDir + "/" + 0));
  while (reader.readLine() != null) {
    Assert.fail("Partition 0 should be empty.  Most likely Custom Partitioner was not used.");
  }
  reader.close();
  Util.copyFromClusterToLocal(cluster,outputFiles[1].getPath().toString(),outputDir + "/" + 1);
  reader=new BufferedReader(new FileReader(outputDir + "/" + 1));
  int count=0;
  while (reader.readLine() != null) {
    count++;
  }
  reader.close();
  Assert.assertEquals(4,count);
  Util.deleteDirectory(new File(outputDir));
  Util.deleteFile(cluster,outputDir);
  Util.deleteFile(cluster,"table_testCustomPartitionerGroups");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataBag </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctTripleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 50; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  assertEquals("Size of distinct data bag is incorrect",rightAnswer.size(),b.size());
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTypedTupleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(30);
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultInMemInFile() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctInMemory() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProvidedBagFactory() throws Exception {
  BagFactory.resetSelf();
  System.setProperty("pig.data.bag.factory.name","no such class");
  System.setProperty("pig.data.bag.factory.jar","file:./pig.jar");
  boolean caughtIt=false;
  try {
    BagFactory f=BagFactory.getInstance();
  }
 catch (  RuntimeException re) {
    assertEquals("Expected Unable to instantiate message","Unable to instantiate bag factory no such class",re.getMessage());
    caughtIt=true;
  }
  assertTrue("Expected to catch exception",caughtIt);
  BagFactory.resetSelf();
  System.setProperty("pig.data.bag.factory.name","org.apache.pig.test.TestDataBag");
  System.setProperty("pig.data.bag.factory.jar","file:./pig.jar");
  caughtIt=false;
  try {
    BagFactory f=BagFactory.getInstance();
  }
 catch (  RuntimeException re) {
    assertEquals("Expected does not extend BagFactory message","Provided factory org.apache.pig.test.TestDataBag does not extend BagFactory!",re.getMessage());
    caughtIt=true;
  }
  assertTrue("Expected to catch exception",caughtIt);
  BagFactory.resetSelf();
  System.setProperty("pig.data.bag.factory.name","org.apache.pig.test.NonDefaultBagFactory");
  System.setProperty("pig.data.bag.factory.jar","file:./pig.jar");
  BagFactory f=BagFactory.getInstance();
  DataBag b=f.newDefaultBag();
  b=f.newSortedBag(null);
  b=f.newDistinctBag();
  BagFactory.resetSelf();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedInMemInFile() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctSingleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultTripleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(30);
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedInMemory() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedTripleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(30);
  for (int j=0; j < 3; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultInMemory() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  for (int i=0; i < 15; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rightAnswer.poll());
  }
  mgr.forceSpill();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedFirstSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  for (int i=0; i < 5; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rightAnswer.poll());
  }
  mgr.forceSpill();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedPreMerge() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(30);
  for (int j=0; j < 373; j++) {
    for (int i=0; i < 10; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(20);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  for (int i=0; i < 15; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  mgr.forceSpill();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctSpillDuringRead() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  for (int i=0; i < 5; i++) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  mgr.forceSpill();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultSingleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDefaultBag();
  ArrayList<Tuple> rightAnswer=new ArrayList<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortedSingleSpill() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newSortedBag(null);
  PriorityQueue<Tuple> rightAnswer=new PriorityQueue<Tuple>(10);
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt()));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  Iterator<Tuple> bIter=b.iterator();
  Tuple t;
  while ((t=rightAnswer.poll()) != null) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),t);
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctPreMerge() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int j=0; j < 321; j++) {
    for (int i=0; i < 50; i++) {
      Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
      b.add(t);
      rightAnswer.add(t);
    }
    mgr.forceSpill();
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctInMemInFile() throws Exception {
  TestMemoryManager mgr=new TestMemoryManager();
  LocalBagFactory factory=new LocalBagFactory(mgr);
  DataBag b=factory.newDistinctBag();
  TreeSet<Tuple> rightAnswer=new TreeSet<Tuple>();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(rand.nextInt() % 5));
    b.add(t);
    rightAnswer.add(t);
  }
  mgr.forceSpill();
  for (int i=0; i < 50; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(new Integer(i));
    b.add(t);
    rightAnswer.add(t);
  }
  Iterator<Tuple> bIter=b.iterator();
  Iterator<Tuple> rIter=rightAnswer.iterator();
  while (rIter.hasNext()) {
    assertTrue("bag ran out of tuples before answer",bIter.hasNext());
    assertEquals("tuples should be the same",bIter.next(),rIter.next());
  }
  assertFalse("right answer ran out of tuples before the bag",bIter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataBagAccess </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagConstantFlatten1() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"sampledata\tnot_used"});
  pigServer.registerQuery("A = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = foreach A generate {(('p1-t1-e1', 'p1-t1-e2'),('p1-t2-e1', 'p1-t2-e2'))," + "(('p2-t1-e1', 'p2-t1-e2'), ('p2-t2-e1', 'p2-t2-e2'))};");
  pigServer.registerQuery("C = foreach B generate $0 as pairbag : { pair: ( t1: (e1, e2), t2: (e1, e2) ) };");
  pigServer.registerQuery("D = foreach C generate FLATTEN(pairbag);");
  pigServer.registerQuery("E = foreach D generate t1.e2 as t1e2, t2.e1 as t2e1;");
  Iterator<Tuple> it=pigServer.openIterator("E");
  Tuple t=it.next();
  assertEquals("p1-t1-e2",t.get(0));
  assertEquals("p1-t2-e1",t.get(1));
  t=it.next();
  assertEquals("p2-t1-e2",t.get(0));
  assertEquals("p2-t2-e1",t.get(1));
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagStoreLoad() throws IOException, ExecException {
  File input=Util.createInputFile("tmp","",new String[]{"a\tid1","a\tid2","a\tid3","b\tid4","b\tid5","b\tid6"});
  pigServer.registerQuery("a = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' "+ "as (s:chararray, id:chararray);");
  pigServer.registerQuery("b = group a by s;");
  Class[] loadStoreClasses=new Class[]{BinStorage.class,PigStorage.class};
  for (int i=0; i < loadStoreClasses.length; i++) {
    String output="TestDataBagAccess-testBagStoreLoad-" + loadStoreClasses[i].getName() + ".txt";
    pigServer.deleteFile(output);
    pigServer.store("b",output,loadStoreClasses[i].getName());
    pigServer.registerQuery("c = load '" + output + "' using "+ loadStoreClasses[i].getName()+ "() AS "+ "(gp: chararray, bg:bag { t: tuple (sReLoaded: chararray, idReLoaded: chararray)});;");
    Iterator<Tuple> it=pigServer.openIterator("c");
    MultiMap<Object,Object> results=new MultiMap<Object,Object>();
    results.put("a","id1");
    results.put("a","id2");
    results.put("a","id3");
    results.put("b","id4");
    results.put("b","id5");
    results.put("b","id6");
    int j=0;
    while (it.hasNext()) {
      Tuple t=it.next();
      Object groupKey=t.get(0);
      DataBag groupBag=(DataBag)t.get(1);
      Iterator<Tuple> bgIt=groupBag.iterator();
      int k=0;
      while (bgIt.hasNext()) {
        HashMap<Object,Boolean> seen=new HashMap<Object,Boolean>();
        Tuple bgt=bgIt.next();
        assertTrue(bgt.get(0).equals(groupKey));
        Collection values=results.get(groupKey);
        assertTrue(values.contains(bgt.get(1)));
        if (seen.containsKey(bgt.get(1)))         fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate value ("+ bgt.get(1)+ ")");
 else         seen.put(bgt.get(1),true);
        k++;
      }
      assertEquals(3,k);
      j++;
    }
    assertEquals(results.keySet().size(),j);
    pigServer.registerQuery("d = foreach c generate gp, flatten(bg);");
    List<Tuple> resultTuples=new ArrayList<Tuple>();
    resultTuples.add(Util.createTuple(new String[]{"a","a","id1"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id2"}));
    resultTuples.add(Util.createTuple(new String[]{"a","a","id3"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id4"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id5"}));
    resultTuples.add(Util.createTuple(new String[]{"b","b","id6"}));
    it=pigServer.openIterator("d");
    j=0;
    HashMap<Tuple,Boolean> seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("e = foreach d generate gp, sReLoaded, idReLoaded;");
    it=pigServer.openIterator("e");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
    pigServer.registerQuery("f = foreach d generate $0, $1, $2;");
    it=pigServer.openIterator("f");
    j=0;
    seen=new HashMap<Tuple,Boolean>();
    while (it.hasNext()) {
      Tuple t=it.next();
      assertTrue(resultTuples.contains(t));
      if (seen.containsKey(t)) {
        fail("LoadStoreClass used : " + loadStoreClasses[i].getName() + " "+ ", duplicate tuple ("+ t+ ") encountered.");
      }
 else {
        seen.put(t,true);
      }
      j++;
    }
    assertEquals(resultTuples.size(),j);
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleTupleBagAcess() throws Exception {
  Tuple inputTuple=new DefaultTuple();
  inputTuple.append("a");
  inputTuple.append("b");
  SingleTupleBag bg=new SingleTupleBag(inputTuple);
  Iterator<Tuple> it=bg.iterator();
  assertEquals(inputTuple,it.next());
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestDataModel </h4><pre class="type-13 type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWrite() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=giveMeOneOfEach();
  File file=File.createTempFile("Tuple","put");
  FileOutputStream fos=new FileOutputStream(file);
  DataOutput out=new DataOutputStream(fos);
  t1.write(out);
  t1.write(out);
  fos.close();
  FileInputStream fis=new FileInputStream(file);
  DataInput in=new DataInputStream(fis);
  for (int i=0; i < 2; i++) {
    Tuple after=tf.newTuple();
    after.readFields(in);
    Object o=after.get(0);
    assertTrue("isa Tuple",o instanceof Tuple);
    Tuple t3=(Tuple)o;
    o=t3.get(0);
    assertTrue("isa Integer",o instanceof Integer);
    assertEquals(new Integer(3),(Integer)o);
    o=t3.get(1);
    assertTrue("isa Float",o instanceof Float);
    assertEquals(new Float(3.0),(Float)o);
    o=after.get(1);
    assertTrue("isa Bag",o instanceof DataBag);
    DataBag b=(DataBag)o;
    Iterator<Tuple> j=b.iterator();
    Tuple[] ts=new Tuple[2];
    assertTrue("first tuple in bag",j.hasNext());
    ts[0]=j.next();
    assertTrue("second tuple in bag",j.hasNext());
    ts[1]=j.next();
    o=ts[0].get(0);
    assertTrue("isa Integer",o instanceof Integer);
    assertEquals(new Integer(4),(Integer)o);
    o=ts[1].get(0);
    assertTrue("isa String",o instanceof String);
    assertEquals("mary had a little lamb",(String)o);
    o=after.get(2);
    assertTrue("isa Map",o instanceof Map);
    Map<String,Object> m=(Map<String,Object>)o;
    assertEquals("world",(String)m.get("hello"));
    assertEquals("all",(String)m.get("goodbye"));
    assertNull(m.get("fred"));
    o=after.get(3);
    assertTrue("isa Integer",o instanceof Integer);
    Integer ii=(Integer)o;
    assertEquals(new Integer(42),ii);
    o=after.get(4);
    assertTrue("isa Long",o instanceof Long);
    Long l=(Long)o;
    assertEquals(new Long(5000000000L),l);
    o=after.get(5);
    assertTrue("isa Float",o instanceof Float);
    Float f=(Float)o;
    assertEquals(new Float(3.141592654),f);
    o=after.get(6);
    assertTrue("isa Double",o instanceof Double);
    Double d=(Double)o;
    assertEquals(new Double(2.99792458e8),d);
    o=after.get(7);
    assertTrue("isa Boolean",o instanceof Boolean);
    Boolean bool=(Boolean)o;
    assertTrue(bool);
    o=after.get(8);
    assertTrue("isa DataByteArray",o instanceof DataByteArray);
    DataByteArray ba=(DataByteArray)o;
    assertEquals(new DataByteArray("hello"),ba);
    o=after.get(9);
    assertTrue("isa String",o instanceof String);
    String s=(String)o;
    assertEquals("goodbye",s);
  }
  file.delete();
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testIntegerConversionErr() throws Exception {
  List list=new ArrayList();
  try {
    DataType.toInteger(list);
  }
 catch (  ExecException ee) {
    assertEquals(1071,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteInternal() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=tf.newTuple(1);
  InternalMap map=new InternalMap(2);
  map.put(new Integer(1),new String("world"));
  map.put(new Long(3L),new String("all"));
  t1.set(0,map);
  File file=File.createTempFile("Tuple","put");
  FileOutputStream fos=new FileOutputStream(file);
  DataOutput out=new DataOutputStream(fos);
  t1.write(out);
  fos.close();
  FileInputStream fis=new FileInputStream(file);
  DataInput in=new DataInputStream(fis);
  Tuple after=tf.newTuple();
  after.readFields(in);
  Object o=after.get(0);
  assertTrue("isa InternalMap",o instanceof InternalMap);
  InternalMap m=(InternalMap)o;
  assertEquals("world",(String)m.get(new Integer(1)));
  assertEquals("all",(String)m.get(new Long(3L)));
  assertNull(m.get("fred"));
  file.delete();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testDetermineFieldSchemaErr() throws Exception {
  List list=new ArrayList();
  try {
    DataType.determineFieldSchema(list);
    fail("Error expected.");
  }
 catch (  ExecException ee) {
    assertEquals(1073,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleCompareTo() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=tf.newTuple();
  Tuple t2=tf.newTuple();
  t1.append(new Integer(3));
  t2.append(new Integer(3));
  assertEquals("same data equal",0,t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new Integer(2));
  assertTrue("greater than tuple with lesser value",0 < t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new Integer(4));
  assertTrue("less than tuple with greater value",0 > t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new Integer(3));
  t2.append(new Integer(4));
  assertTrue("less than bigger tuple",0 > t1.compareTo(t2));
  t2=tf.newTuple();
  assertTrue("greater than smaller tuple",0 < t1.compareTo(t2));
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testTupleConversionErr() throws Exception {
  List list=new ArrayList();
  try {
    DataType.toTuple(list);
  }
 catch (  ExecException ee) {
    assertEquals(1071,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleHashCode() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=tf.newTuple(2);
  t1.set(0,new DataByteArray("hello world"));
  t1.set(1,new Integer(1));
  Tuple t2=tf.newTuple(2);
  t2.set(0,new DataByteArray("hello world"));
  t2.set(1,new Integer(1));
  assertEquals("same data",t1.hashCode(),t2.hashCode());
  Tuple t3=tf.newTuple(3);
  t3.set(0,new DataByteArray("hello world"));
  t3.set(1,new Integer(1));
  t3.set(2,new Long(4));
  assertFalse("different size",t1.hashCode() == t3.hashCode());
  Tuple t4=tf.newTuple(2);
  t4.set(0,new DataByteArray("hello world"));
  t4.set(1,new Integer(2));
  assertFalse("same size, different data",t1.hashCode() == t4.hashCode());
  Tuple t5=giveMeOneOfEach();
  t5.hashCode();
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiFieldTupleCompareTo() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  Tuple t1=tf.newTuple();
  Tuple t2=tf.newTuple();
  t1.append(new DataByteArray("bbb"));
  t1.append(new DataByteArray("bbb"));
  t2.append(new DataByteArray("bbb"));
  t2.append(new DataByteArray("bbb"));
  assertEquals("same data equal",0,t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new DataByteArray("aaa"));
  t2.append(new DataByteArray("aaa"));
  assertTrue("greater than tuple with lesser value",0 < t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new DataByteArray("ddd"));
  t2.append(new DataByteArray("ddd"));
  assertTrue("less than tuple with greater value",0 > t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new DataByteArray("bbb"));
  t2.append(new DataByteArray("aaa"));
  assertTrue("greater than tuple with lesser value",0 < t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new DataByteArray("bbb"));
  t2.append(new DataByteArray("ccc"));
  assertTrue("greater than tuple with lesser value",0 > t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new DataByteArray("aaa"));
  t2.append(new DataByteArray("bbb"));
  assertTrue("greater than tuple with lesser value",0 < t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new DataByteArray("ccc"));
  t2.append(new DataByteArray("bbb"));
  assertTrue("greater than tuple with lesser value",0 > t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new DataByteArray("aaa"));
  t2.append(new DataByteArray("ccc"));
  assertTrue("greater than tuple with lesser value",0 < t1.compareTo(t2));
  t2=tf.newTuple();
  t2.append(new DataByteArray("ccc"));
  t2.append(new DataByteArray("aaa"));
  assertTrue("greater than tuple with lesser value",0 > t1.compareTo(t2));
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testIntegerConversionErr1() throws Exception {
  DataByteArray ba=new DataByteArray("hello world");
  try {
    DataType.toInteger(ba);
  }
 catch (  ExecException ee) {
    assertEquals(1074,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testMapConversionErr() throws Exception {
  List list=new ArrayList();
  try {
    DataType.toMap(list);
  }
 catch (  ExecException ee) {
    assertEquals(1071,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testByteArrayHashCode() throws Exception {
  DataByteArray ba1=new DataByteArray("hello world");
  DataByteArray ba2=new DataByteArray("hello world");
  DataByteArray ba3=new DataByteArray("goodbye world");
  assertEquals("same data",ba1.hashCode(),ba2.hashCode());
  assertFalse("different data",ba1.hashCode() == ba3.hashCode());
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ExecException.class) public void testTupleConversionErr1() throws Exception {
  DataByteArray ba=new DataByteArray("hello world");
  try {
    DataType.toTuple(ba);
  }
 catch (  ExecException ee) {
    assertEquals(1071,ee.getErrorCode());
    throw ee;
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTuple() throws Exception {
  TupleFactory tf=TupleFactory.getInstance();
  int arity=5;
  int[] input1={1,2,3,4,5};
  String[] input2={"1","2","3","4","5"};
  String[] input3={"1","2","3","4","5","6"};
  Tuple f1=Util.loadFlatTuple(tf.newTuple(arity),input1);
  Tuple f2=Util.loadFlatTuple(tf.newTuple(arity),input1);
  Tuple f3=tf.newTuple(arity);
  assertEquals(arity,f1.size());
  assertEquals(f1,f2);
  f2=Util.loadTuple(tf.newTuple(input3.length),input3);
  assertFalse(f1.equals(f2));
  int[] input4={1,2,3};
  int[] input5={4,5};
  f1=Util.loadFlatTuple(tf.newTuple(input1.length),input1);
  f2=Util.loadFlatTuple(tf.newTuple(input4.length),input4);
  assertTrue(f1.compareTo(f2) > 0);
  assertFalse(f1.compareTo(f2) < 0);
  int[] input6={1,2,3,4,6};
  f2=Util.loadFlatTuple(tf.newTuple(input6.length),input6);
  assertTrue(f1.compareTo(f2) < 0);
  assertFalse(f1.compareTo(f2) > 0);
  String expected="1:2:3:4:5";
  f1=Util.loadFlatTuple(tf.newTuple(input1.length),input1);
  assertTrue(expected.equals(f1.toDelimitedString(":")));
  PipedOutputStream pos=new PipedOutputStream();
  DataOutputStream dos=new DataOutputStream(pos);
  PipedInputStream pis=new PipedInputStream(pos);
  DataInputStream dis=new DataInputStream(pis);
  f1.write(dos);
  f1.write(dos);
  f2.readFields(dis);
  assertTrue(f1.equals(f2));
  f2.readFields(dis);
  assertTrue(f1.equals(f2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEmptyInputDir </h4><pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join A by $0, B by $0 using 'merge';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    MRJobStats js=(MRJobStats)stats.getJobGraph().getSources().get(0);
    if (!Util.isHadoop205() && !Util.isHadoop1_x())     assertEquals(0,js.getNumberMaps());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeftOuterJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (x:int);");
  w.println("B = load '" + EMPTY_DIR + "' as (x:int);");
  w.println("C = join B by $0 left outer, A by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    assertEquals(0,stats.getNumberRecords(OUTPUT_FILE));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRightOuterJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "' as (x:int);");
  w.println("C = join B by $0 right outer, A by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    assertEquals(2,stats.getNumberRecords(OUTPUT_FILE));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkewedJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join B by $0, A by $0 using 'skewed';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    MRJobStats js=(MRJobStats)stats.getJobGraph().getSources().get(0);
    if (!Util.isHadoop205() && !Util.isHadoop1_x())     assertEquals(0,js.getNumberMaps());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegularJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join B by $0, A by $0;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFRJoin() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "';");
  w.println("B = load '" + EMPTY_DIR + "';");
  w.println("C = join A by $0, B by $0 using 'repl';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    MRJobStats js=(MRJobStats)stats.getJobGraph().getSources().get(0);
    if (!Util.isHadoop205() && !Util.isHadoop1_x())     assertEquals(0,js.getNumberMaps());
    FileSystem fs=cluster.getFileSystem();
    FileStatus status=fs.getFileStatus(new Path(OUTPUT_FILE));
    assertTrue(status.isDir());
    assertEquals(0,status.getLen());
    assertTrue(fs.listStatus(status.getPath()).length > 0);
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEqualTo </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(0L));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(0.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(0.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleEq() throws ExecException {
  Tuple tuple_1=TupleFactory.getInstance().newTuple("item_1");
  Tuple tuple_2=TupleFactory.getInstance().newTuple("item_1");
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(tuple_1);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(tuple_2);
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.TUPLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBooleanEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(Boolean.TRUE);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(Boolean.TRUE);
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BOOLEAN);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapNe() throws ExecException {
  Map map_1=new HashMap();
  map_1.put("key_1","value_1");
  Map map_2=new HashMap();
  map_2.put("key_1","value_2");
  Tuple tuple_2=TupleFactory.getInstance().newTuple("item_2");
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(map_1);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(map_2);
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.MAP);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(0L));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(0));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBooleanNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(Boolean.TRUE);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(Boolean.FALSE);
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BOOLEAN);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapEq() throws ExecException {
  Map map_1=new HashMap();
  map_1.put("key_1","value_1");
  Map map_2=new HashMap();
  map_2.put("key_1","value_1");
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(map_1);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(map_2);
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.MAP);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleNe() throws ExecException {
  Tuple tuple_1=TupleFactory.getInstance().newTuple("item_1");
  Tuple tuple_2=TupleFactory.getInstance().newTuple("item_2");
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(tuple_1);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(tuple_2);
  EqualToExpr g=GenPhyOp.compEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.TUPLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapLookup() throws Exception {
  DataBag b=BagFactory.getInstance().newDefaultBag();
  Map<String,Object> colors=new HashMap<String,Object>();
  colors.put("apple","red");
  colors.put("orange","orange");
  Map<String,Object> weights=new HashMap<String,Object>();
  weights.put("apple","0.1");
  weights.put("orange","0.3");
  Tuple t=mTf.newTuple();
  t.append(colors);
  t.append(weights);
  b.add(t);
  File tmpFile=File.createTempFile("tmp","");
  tmpFile.delete();
  String fileName=Util.removeColon(tmpFile.getAbsolutePath());
  PigFile f=new PigFile(fileName);
  f.store(b,new FuncSpec(BinStorage.class.getCanonicalName()),pigServer.getPigContext());
  pigServer.registerQuery("a = load '" + Util.encodeEscape(fileName) + "' using BinStorage();");
  pigServer.registerQuery("b = foreach a generate $0#'apple',flatten($1#'orange');");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  t=iter.next();
  Assert.assertEquals(t.get(0).toString(),"red");
  Assert.assertEquals(0.3d,DataType.toDouble(t.get(1)).doubleValue(),0.0d);
  Assert.assertFalse(iter.hasNext());
  Util.deleteFile(cluster,fileName);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin() throws Exception {
  File f1=Util.createFile(new String[]{"a:1","b:1","a:1"});
  File f2=Util.createFile(new String[]{"b","b","a"});
  pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(),pigContext) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = load '" + Util.generateURI(f2.toString(),pigContext) + "';");
  pigServer.registerQuery("c = cogroup a by $0, b by $0;");
  pigServer.registerQuery("d = foreach c generate flatten($1),flatten($2);");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals(t.get(2).toString()));
    count++;
  }
  Assert.assertEquals(count,4);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimit() throws Exception {
  int LOOP_COUNT=20;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = limit A 5;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    iter.next();
    ++numIdentity;
  }
  Assert.assertEquals(5,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDriverMethod() throws Exception {
  File f=Util.createTempFileDelOnExit("tmp","");
  PrintWriter pw=new PrintWriter(f);
  pw.println("a");
  pw.println("a");
  pw.close();
  pigServer.registerQuery("a = foreach (load '" + Util.generateURI(f.toString(),pigContext) + "') "+ "generate 1, flatten("+ MyBagFunction.class.getName()+ "(*));");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals("1"));
    Assert.assertTrue(t.get(1).toString().equals("a"));
    count++;
  }
  Assert.assertEquals(count,6);
  f.delete();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testMapUDF() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = foreach A generate " + MapUDF.class.getName() + "($0) as mymap;");
  String query="C = foreach B {" + "generate (double)mymap#'double' as d, (long)mymap#'long' + (float)mymap#'float' as float_sum, CONCAT((chararray) mymap#'string', ' World!'), mymap#'int' * 10, (bag{tuple()}) mymap#'bag' as mybag, (tuple()) mymap#'tuple' as mytuple, (map[])mymap#'map' as mapInMap, mymap#'dba' as dba;" + "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(1.0,(Double)t.get(0),0.01);
    Assert.assertEquals(2.0,(Float)t.get(1),0.01);
    Assert.assertTrue(((String)t.get(2)).equals("Hello World!"));
    Assert.assertEquals(new Integer(10),(Integer)t.get(3));
    Assert.assertEquals(1,((DataBag)t.get(4)).size());
    Assert.assertEquals(4,((Tuple)t.get(5)).size());
    Assert.assertEquals(2,((Map<String,Object>)t.get(6)).size());
    Assert.assertEquals(DataByteArray.class,t.get(7).getClass());
    Assert.assertEquals(8,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT * LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanWithExpressionAssignment() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = " + Identity.class.getName() + "(*);"+ "C5 = COUNT(C2);"+ "C6 = SUM(C2.$1);"+ "C7 = "+ TitleNGrams.class.getName()+ "(C3);"+ "C8 = MAX(C3.$1);"+ "generate (int)group, C4, C5, C6, C7, C8, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=Util.createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=Util.createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigContext) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigContext) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue(),0.0d);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlan() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by $0 > -1;" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "generate (int)group," + Identity.class.getName() + "(*), COUNT(C2), SUM(C2.$1),"+ TitleNGrams.class.getName()+ "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)numIdentity,(Integer)t.get(0));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigContext) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipeline2 </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testCrossAfterGroupAll() throws Exception {
  String[] input={"1\tA","2\tB","3\tC","4\tD"};
  Util.createInputFile(cluster,"table_testCrossAfterGroupAll",input);
  try {
    pigServer.getPigContext().getProperties().setProperty("pig.exec.reducers.bytes.per.reducer","40");
    pigServer.registerQuery("A = load 'table_testCrossAfterGroupAll' as (a0:int, a1:chararray);");
    pigServer.registerQuery("B = group A all;");
    pigServer.registerQuery("C = foreach B generate COUNT(A);");
    pigServer.registerQuery("D = cross A, C;");
    Path output=FileLocalizer.getTemporaryPath(pigServer.getPigContext());
    ExecJob job=pigServer.store("D",output.toString());
    FileSystem fs=output.getFileSystem(cluster.getConfiguration());
    FileStatus[] partFiles=fs.listStatus(output,new PathFilter(){
      @Override public boolean accept(      Path path){
        if (path.getName().startsWith("part")) {
          return true;
        }
        return false;
      }
    }
);
    Assert.assertTrue(partFiles.length >= 2);
    Iterator<Tuple> iter=job.getResults();
    List<Tuple> results=new ArrayList<Tuple>();
    while (iter.hasNext()) {
      results.add(iter.next());
    }
    Collections.sort(results);
    Assert.assertEquals(4,results.size());
    Assert.assertEquals("(1,A,4)",results.get(0).toString());
    Assert.assertEquals("(2,B,4)",results.get(1).toString());
    Assert.assertEquals("(3,C,4)",results.get(2).toString());
    Assert.assertEquals("(4,D,4)",results.get(3).toString());
  }
  finally {
    pigServer.getPigContext().getProperties().remove("pig.exec.reducers.bytes.per.reducer");
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageWithCtrlChars() throws Exception {
  String[] inputData={"hello\u0001world","good\u0001morning","nice\u0001day"};
  Util.createInputFile(cluster,"testPigStorageWithCtrlCharsInput.txt",inputData);
  String script="a = load 'testPigStorageWithCtrlCharsInput.txt' using PigStorage('\u0001');" + "b = foreach a generate $0, CONCAT($0, '\u0005'), $1; " + "store b into 'testPigStorageWithCtrlCharsOutput.txt' using PigStorage('\u0001');"+ "c = load 'testPigStorageWithCtrlCharsOutput.txt' using PigStorage('\u0001') as (f1:chararray, f2:chararray, f3:chararray);";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("c");
  HashMap<String,Tuple> expectedResults=new HashMap<String,Tuple>();
  expectedResults.put("hello",(Tuple)Util.getPigConstant("('hello','hello\u0005','world')"));
  expectedResults.put("good",(Tuple)Util.getPigConstant("('good','good\u0005','morning')"));
  expectedResults.put("nice",(Tuple)Util.getPigConstant("('nice','nice\u0005','day')"));
  HashMap<String,Boolean> seen=new HashMap<String,Boolean>();
  int numRows=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String firstCol=(String)t.get(0);
    Assert.assertFalse(seen.containsKey(firstCol));
    seen.put(firstCol,true);
    Assert.assertEquals(expectedResults.get(firstCol),t);
    numRows++;
  }
  Assert.assertEquals(3,numRows);
  Util.deleteFile(cluster,"testPigStorageWithCtrlCharsInput.txt");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSortDesc() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num desc parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MAX_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum <= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddingTwoBag(){
  try {
    pigServer.registerQuery("a = load '1.txt' as (name:chararray, age:int, gpa:double);");
    pigServer.registerQuery("b = group a by name;");
    pigServer.registerQuery("c = foreach b generate group, SUM(a.age*a.gpa);");
    pigServer.openIterator("c");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertTrue(pe.getErrorCode() == 1039);
    Assert.assertTrue(pe.getMessage().contains("incompatible types"));
    return;
  }
  Assert.fail();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAfterSort() throws Exception {
  int LOOP_COUNT=40;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    ps.println(rand);
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' AS (num:int);");
  pigServer.registerQuery("B = order A by num parallel 2;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  int oldNum=Integer.MIN_VALUE;
  int newNum;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    newNum=(Integer)t.get(0);
    Assert.assertTrue(newNum >= oldNum);
    oldNum=newNum;
    ++numIdentity;
  }
  Assert.assertEquals(10,numIdentity);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinStorageByteArrayCastsSimple() throws IOException {
  String[] input={"asdf\t12\t1.1\t231\t234\t3024123\t3.2492","sa\t1231\t123.4\t12345678\t1234.567\t5081123453\t9.181817","asdff\t1232123\t1.45345\t123456789\t123456789.9\t1234567\t1.234567"};
  Util.createInputFile(cluster,"table_bs_ac",input);
  pigServer.registerQuery("a = load 'table_bs_ac';");
  String output="/pig/out/TestEvalPipeline2_BinStorageByteArrayCasts";
  pigServer.deleteFile(output);
  pigServer.store("a",output,BinStorage.class.getName());
  pigServer.registerQuery("b = load '" + output + "' using BinStorage('Utf8StorageConverter') "+ "as (name: int, age: int, gpa: float, lage: long, dgpa: double, bi:biginteger, bd:bigdecimal);");
  Iterator<Tuple> it=pigServer.openIterator("b");
  Tuple tup=null;
  tup=it.next();
  Assert.assertTrue((Integer)tup.get(0) == null);
  Assert.assertTrue((Integer)tup.get(1) == 12);
  Assert.assertTrue((Float)tup.get(2) == 1.1F);
  Assert.assertTrue((Long)tup.get(3) == 231L);
  Assert.assertTrue((Double)tup.get(4) == 234.0);
  Assert.assertEquals((BigInteger)tup.get(5),new BigInteger("3024123"));
  Assert.assertEquals((BigDecimal)tup.get(6),new BigDecimal("3.2492"));
  tup=it.next();
  Assert.assertTrue(tup.get(0) == null);
  Assert.assertTrue((Integer)tup.get(1) == 1231);
  Assert.assertTrue((Float)tup.get(2) == 123.4F);
  Assert.assertTrue((Long)tup.get(3) == 12345678L);
  Assert.assertTrue((Double)tup.get(4) == 1234.567);
  Assert.assertEquals((BigInteger)tup.get(5),new BigInteger("5081123453"));
  Assert.assertEquals((BigDecimal)tup.get(6),new BigDecimal("9.181817"));
  tup=it.next();
  Assert.assertTrue(tup.get(0) == null);
  Assert.assertTrue((Integer)tup.get(1) == 1232123);
  Assert.assertTrue((Float)tup.get(2) == 1.45345F);
  Assert.assertTrue((Long)tup.get(3) == 123456789L);
  Assert.assertTrue((Double)tup.get(4) == 1.234567899E8);
  Assert.assertEquals((BigInteger)tup.get(5),new BigInteger("1234567"));
  Assert.assertEquals((BigDecimal)tup.get(6),new BigDecimal("1.234567"));
  Util.deleteFile(cluster,"table");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonStandardDataWithoutFetch() throws Exception {
  Properties props=pigServer.getPigContext().getProperties();
  props.setProperty(PigConfiguration.PIG_OPT_FETCH,"false");
  String[] input1={"0"};
  try {
    Util.createInputFile(cluster,"table_testNonStandardDataWithoutFetch",input1);
    pigServer.registerQuery("a = load 'table_testNonStandardDataWithoutFetch' as (a0);");
    pigServer.registerQuery("b = foreach a generate " + UDFWithNonStandardType.class.getName() + "(a0);");
    try {
      pigServer.openIterator("b");
      Assert.fail();
    }
 catch (    Exception e) {
      Assert.assertTrue(e.getMessage().contains(ArrayList.class.getName()));
    }
  }
  finally {
    props.setProperty(PigConfiguration.PIG_OPT_FETCH,"true");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCastMap() throws Exception {
  String[] input={"([key#1])","([key#2])"};
  Util.createInputFile(cluster,"table_testCastMap",input);
  pigServer.registerQuery("a = load 'table_testCastMap' as (m:map[]);");
  pigServer.registerQuery("b = foreach a generate (map[int])m;");
  pigServer.registerQuery("c = foreach b generate m#'key' + 1;");
  Iterator<Tuple> iter=pigServer.openIterator("c");
  Tuple t=iter.next();
  Assert.assertEquals(t.get(0),2);
  t=iter.next();
  Assert.assertEquals(t.get(0),3);
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonStandardData() throws Exception {
  String[] input1={"0"};
  Util.createInputFile(cluster,"table_testNonStandardData",input1);
  pigServer.registerQuery("a = load 'table_testNonStandardData' as (a0);");
  pigServer.registerQuery("b = foreach a generate " + UDFWithNonStandardType.class.getName() + "(a0);");
  try {
    pigServer.openIterator("b");
    Assert.fail();
  }
 catch (  Exception e) {
    Throwable cause=e.getCause().getCause() == null ? e.getCause() : e.getCause().getCause();
    String message=cause.getMessage();
    Assert.assertTrue(message.contains(ArrayList.class.getName()));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUDFwithStarInput() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "generate " + Identity.class.getName() + "(*);"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple tuple=iter.next();
    Tuple t=(Tuple)tuple.get(0);
    Assert.assertEquals(DataByteArray.class,t.get(0).getClass());
    int group=Integer.parseInt(new String(((DataByteArray)t.get(0)).get()));
    Assert.assertEquals(numIdentity,group);
    Assert.assertTrue(t.get(1) instanceof DataBag);
    DataBag bag=(DataBag)t.get(1);
    Assert.assertEquals(10,bag.size());
    Assert.assertEquals(2,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestEvalPipelineLocal </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedPlanForCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = group A by $0;");
  String query="C = foreach B {" + "C1 = filter A by not($0 <= -1);" + "C2 = distinct C1;"+ "C3 = distinct A;"+ "C4 = order A by $0;"+ "generate (group + 1) * 10, COUNT(C4), COUNT(C2), SUM(C2.$1)," + TitleNGrams.class.getName() + "(C3), MAX(C3.$1), C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numIdentity=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals((Integer)((numIdentity + 1) * 10),(Integer)t.get(0));
    Assert.assertEquals((Long)10L,(Long)t.get(1));
    Assert.assertEquals((Long)5L,(Long)t.get(2));
    Assert.assertEquals(LOOP_COUNT * 2.0,(Double)t.get(3),0.01);
    Assert.assertEquals(8.0,(Double)t.get(5),0.01);
    Assert.assertEquals(5L,((DataBag)t.get(6)).size());
    Assert.assertEquals(7,t.size());
    ++numIdentity;
  }
  Assert.assertEquals(LOOP_COUNT,numIdentity);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentity() throws Exception {
  int LOOP_COUNT=2;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A ;");
  pigServer.registerQuery("C = foreach B generate FLATTEN(" + Identity.class.getName() + "($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i),new Double(t.get(0).toString()),0.01);
      Assert.assertEquals(new Double(j),new Double(t.get(1).toString()),0.01);
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlattenTwice() throws Exception {
  File f1=createFile(new String[]{"{(1),(12),(9)}","{(15),(2)}"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(Util.generateURI(f1.toString(),pigServer.getPigContext())) + "' as (bag1:bag{(t:int)});");
  pigServer.registerQuery("b = foreach a generate flatten(bag1) as field1;");
  pigServer.registerQuery("c = foreach b generate flatten(" + GenBag.class.getName() + "(field1));");
  Iterator<Tuple> iter=pigServer.openIterator("c");
  Assert.assertEquals(iter.next().toString(),"(12)");
  Assert.assertEquals(iter.next().toString(),"(15)");
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesRawComparatorDesc() throws Exception {
  File f1=createFile(new String[]{"2","1","4","3"});
  pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(),pigServer.getPigContext()) + "' as (value:long);");
  pigServer.registerQuery("b = foreach a generate " + TOTUPLENOINNERSCHEMA.class.getName() + "(value);");
  pigServer.registerQuery("c = foreach b generate flatten($0);");
  pigServer.registerQuery("d = order c by $0 desc;");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  Assert.assertEquals(iter.next().toString(),"(4)");
  Assert.assertEquals(iter.next().toString(),"(3)");
  Assert.assertEquals(iter.next().toString(),"(2)");
  Assert.assertEquals(iter.next().toString(),"(1)");
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-20 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExplainInDotGraph() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ since TEZ does not support explain in dot format",!Util.getLocalTestMode().toString().startsWith("TEZ"));
  pigServer.registerQuery("a = load 'voter' using " + PigStorage.class.getName() + "(',') as (name, age, registration, contributions);");
  pigServer.registerQuery("b = filter a by age < 50;");
  pigServer.registerQuery("c = group b by registration;");
  pigServer.registerQuery("d = foreach c generate (chararray)group, SUM(b.contributions);");
  pigServer.registerQuery("e = order d by $1;");
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  pigServer.explain("e","dot",true,true,ps,System.out,null,null);
  ps.close();
  FileInputStream fis1=new FileInputStream("test/org/apache/pig/test/data/DotFiles/explain1.dot");
  byte[] b1=new byte[MAX_SIZE];
  fis1.read(b1);
  String goldenPlan=new String(b1);
  goldenPlan=goldenPlan.trim();
  goldenPlan=goldenPlan.replaceAll("\\d{3,}","");
  FileInputStream fis2=new FileInputStream(tmpFile);
  byte[] b2=new byte[MAX_SIZE];
  fis2.read(b2);
  String realPlan=new String(b2);
  realPlan=realPlan.trim();
  realPlan=realPlan.replaceAll("\\d{3,}","");
  String goldenPlanClean=Util.standardizeNewline(goldenPlan);
  String realPlanClean=Util.standardizeNewline(realPlan);
  System.out.println("-----------golden");
  System.out.println(goldenPlanClean);
  System.out.println("-----------");
  System.out.println(realPlanClean);
  Assert.assertEquals(realPlanClean,goldenPlanClean);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpressionReUse() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $0 + $1;" + "C2 = C1 + $0;"+ "generate C1, C2;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(2,t.size());
      Assert.assertEquals(new Double(i + j),(Double)t.get(0),0.01);
      Assert.assertEquals(new Double(i + j + i),(Double)t.get(1));
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin() throws Exception {
  File f1=createFile(new String[]{"a:1","b:1","a:1"});
  File f2=createFile(new String[]{"b","b","a"});
  pigServer.registerQuery("a = load '" + Util.generateURI(f1.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(':');");
  pigServer.registerQuery("b = load '" + Util.generateURI(f2.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("c = cogroup a by $0, b by $0;");
  pigServer.registerQuery("d = foreach c generate flatten($1),flatten($2);");
  Iterator<Tuple> iter=pigServer.openIterator("d");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals(t.get(2).toString()));
    count++;
  }
  Assert.assertEquals(count,4);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticCloning() throws Exception {
  int LOOP_COUNT=10;
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      ps.println(i + "\t" + j);
      ps.println(i + "\t" + j);
    }
  }
  ps.close();
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = distinct A;");
  String query="C = foreach B {" + "C1 = $1 - $0;" + "C2 = $1%2;"+ "C3 = ($1 == 0? 0 : $0/$1);"+ "generate C1, C2, C3;"+ "};";
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("C");
  if (!iter.hasNext())   Assert.fail("No output found");
  int numRows=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    for (int j=0; j < LOOP_COUNT; j+=2) {
      Tuple t=null;
      if (iter.hasNext())       t=iter.next();
      Assert.assertEquals(3,t.size());
      Assert.assertEquals(new Double(j - i),(Double)t.get(0),0.01);
      Assert.assertEquals((Integer)(j % 2),(Integer)t.get(1));
      if (j == 0) {
        Assert.assertEquals(0.0,(Double)t.get(2),0.01);
      }
 else {
        Assert.assertEquals((Double)((double)i / j),(Double)t.get(2),0.01);
      }
      ++numRows;
    }
  }
  Assert.assertEquals((LOOP_COUNT * LOOP_COUNT) / 2,numRows);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapLookup() throws Exception {
  DataBag b=BagFactory.getInstance().newDefaultBag();
  Map<String,Object> colors=new HashMap<String,Object>();
  colors.put("apple","red");
  colors.put("orange","orange");
  Map<String,Object> weights=new HashMap<String,Object>();
  weights.put("apple","0.1");
  weights.put("orange","0.3");
  Tuple t=mTf.newTuple();
  t.append(colors);
  t.append(weights);
  b.add(t);
  File tempF=File.createTempFile("tmp","");
  tempF.delete();
  String fileName=Util.removeColon(tempF.getCanonicalPath());
  PigFile f=new PigFile(fileName);
  f.store(b,new FuncSpec(BinStorage.class.getCanonicalName()),pigServer.getPigContext());
  pigServer.registerQuery("a = load '" + Util.encodeEscape(fileName) + "' using BinStorage();");
  pigServer.registerQuery("b = foreach a generate $0#'apple',flatten($1#'orange');");
  Iterator<Tuple> iter=pigServer.openIterator("b");
  t=iter.next();
  Assert.assertEquals(t.get(0).toString(),"red");
  Assert.assertEquals(DataType.toDouble(t.get(1)),0.3);
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagFunctionWithFlattening() throws Exception {
  File queryLogFile=createFile(new String[]{"stanford\tdeer\tsighting","bush\tpresident","stanford\tbush","conference\tyahoo","world\tcup\tcricket","bush\twins","stanford\tpresident"});
  File newsFile=createFile(new String[]{"deer seen at stanford","george bush visits stanford","yahoo hosting a conference in the bay area","who will win the world cup"});
  Map<String,Integer> expectedResults=new HashMap<String,Integer>();
  expectedResults.put("bush",2);
  expectedResults.put("stanford",3);
  expectedResults.put("world",1);
  expectedResults.put("conference",1);
  pigServer.registerQuery("newsArticles = LOAD '" + Util.generateURI(newsFile.toString(),pigServer.getPigContext()) + "' USING "+ TextLoader.class.getName()+ "();");
  pigServer.registerQuery("queryLog = LOAD '" + Util.generateURI(queryLogFile.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("titleNGrams = FOREACH newsArticles GENERATE flatten(" + TitleNGrams.class.getName() + "(*));");
  pigServer.registerQuery("cogrouped = COGROUP titleNGrams BY $0 INNER, queryLog BY $0 INNER;");
  pigServer.registerQuery("answer = FOREACH cogrouped GENERATE COUNT(queryLog),group;");
  Iterator<Tuple> iter=pigServer.openIterator("answer");
  if (!iter.hasNext())   Assert.fail("No Output received");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertEquals(expectedResults.get(t.get(1).toString()).doubleValue(),(DataType.toDouble(t.get(0))).doubleValue());
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDriverMethod() throws Exception {
  File f=File.createTempFile("tmp","");
  PrintWriter pw=new PrintWriter(f);
  pw.println("a");
  pw.println("a");
  pw.close();
  pigServer.registerQuery("a = foreach (load '" + Util.generateURI(f.toString(),pigServer.getPigContext()) + "') generate 1, flatten("+ MyBagFunction.class.getName()+ "(*));");
  Iterator<Tuple> iter=pigServer.openIterator("a");
  int count=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    Assert.assertTrue(t.get(0).toString().equals("1"));
    Assert.assertTrue(t.get(1).toString().equals("a"));
    count++;
  }
  Assert.assertEquals(count,6);
  f.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFRJoin </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortFRJoin() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  pigServer.registerQuery("D = ORDER A by y;");
  pigServer.registerQuery("E = ORDER B by y;");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join D by $0, E by $0 using \'replicated\';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join D by $0, E by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  assertEquals(dbfrj.size(),dbshj.size());
  assertTrue(TestHelper.compareBags(dbfrj,dbshj));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinctFRJoin() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  pigServer.registerQuery("D = distinct A ;");
  pigServer.registerQuery("E = distinct B ;");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("C = join D by $0, E by $0 using 'replicated';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("C = join D by $0, E by $0;");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    while (iter.hasNext()) {
      dbshj.add(iter.next());
    }
  }
  assertEquals(dbfrj.size(),dbshj.size());
  assertTrue(TestHelper.compareBags(dbfrj,dbshj));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFRJoin2 </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTooBigReplicatedFile() throws Exception {
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_DIR + "' as (x:int,y:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (x:int,y:int);");
  pigServer.registerQuery("C = group B all parallel 5;");
  pigServer.registerQuery("C = foreach C generate MAX(B.x) as x;");
  pigServer.registerQuery("D = join A by x, B by x, C by x using 'repl';");
{
    try {
      pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_JOIN_REPLICATED_MAX_BYTES,String.valueOf(16));
      pigServer.openIterator("D");
      Assert.fail();
    }
 catch (    FrontendException e) {
      assertEquals("Internal error. Distributed cache could" + " not be set up for the replicated files",e.getCause().getCause().getCause().getMessage());
    }
    pigServer.getPigContext().getProperties().setProperty(PigConfiguration.PIG_JOIN_REPLICATED_MAX_BYTES,String.valueOf(17));
    pigServer.openIterator("D");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSoftLinkDependencyWithMultipleScalarReferences() throws Exception {
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE,cluster.getProperties());
  pigServer.setBatchOn();
  pigServer.getPigContext().getProperties().setProperty(MRCompiler.FILE_CONCATENATION_THRESHOLD,String.valueOf(FILE_MERGE_THRESHOLD));
  pigServer.getPigContext().getProperties().setProperty("pig.noSplitCombination","false");
  String query="A = LOAD '" + INPUT_FILE + "' as (x:int,y:int);"+ "B = group A by x parallel "+ FILE_MERGE_THRESHOLD+ ";"+ "C = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "D = FOREACH C generate B.$0;"+ "STORE D into '/tmp/output1';"+ "E = LOAD '"+ INPUT_FILE+ "' as (x:int,y:int);"+ "F = FOREACH E generate B.$0;"+ "STORE F into '/tmp/output2';";
  MROperPlan mrplan=Util.buildMRPlanWithOptimizer(Util.buildPp(pigServer,query),pigServer.getPigContext());
  assertEquals("Unexpected number of mapreduce job. Missing concat job?",4,mrplan.size());
  MapReduceOper concatMRop=null;
  for (  MapReduceOper mrOp : mrplan) {
    if (mrOp.mapPlan.size() == 2 && mrOp.reducePlan.isEmpty()) {
      concatMRop=mrOp;
      break;
    }
  }
  if (concatMRop == null) {
    fail("Cannot find concat job.");
  }
  assertEquals("Missing dependency for concatjob",2,mrplan.getSuccessors(concatMRop).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilter </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndFilter() throws Exception {
  for (int i=0; i < nullFlags.length; i++) {
    POProject p1=GenPhyOp.exprProject(0);
    ConstantExpression c2=GenPhyOp.exprConst();
    c2.setValue(new Integer(0));
    GreaterThanExpr gt=GenPhyOp.compGreaterThanExpr(p1,c2,DataType.INTEGER);
    POProject p3=GenPhyOp.exprProject(1);
    ConstantExpression c=GenPhyOp.exprConst();
    c.setValue(new Integer(1));
    EqualToExpr eq=GenPhyOp.compEqualToExpr(p3,c,DataType.INTEGER);
    POAnd and=GenPhyOp.compAndExpr(gt,eq);
    PhysicalPlan ip=new PhysicalPlan();
    ip.add(p1);
    ip.add(c2);
    ip.add(gt);
    ip.add(p3);
    ip.add(c);
    ip.add(eq);
    ip.add(and);
    ip.connect(p1,gt);
    ip.connect(c2,gt);
    ip.connect(p3,eq);
    ip.connect(c,eq);
    ip.connect(eq,and);
    ip.connect(gt,and);
    int[] ints={0,1,1,0,1,1};
    TupleFactory tf=TupleFactory.getInstance();
    DataBag inbag=BagFactory.getInstance().newDefaultBag();
    Random r=new Random();
    for (int j=0; j < ints.length; j+=2) {
      if (nullFlags[i] == true) {
        int rand=r.nextInt(100);
        if (rand <= 20) {
          Tuple t=tf.newTuple(2);
          t.set(0,new Integer(ints[j]));
          t.set(1,null);
          inbag.add(t);
        }
 else         if (rand > 20 && rand <= 40) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,new Integer(ints[j + 1]));
          inbag.add(t);
        }
 else         if (rand > 40 && rand <= 60) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,null);
          inbag.add(t);
        }
      }
      Tuple t=tf.newTuple(2);
      t.set(0,new Integer(ints[j]));
      t.set(1,new Integer(ints[j + 1]));
      inbag.add(t);
    }
    PORead read=GenPhyOp.topReadOp(inbag);
    POFilter filter=GenPhyOp.connectedFilterOp(read);
    filter.setPlan(ip);
    PhysicalPlan op=new PhysicalPlan();
    op.add(filter);
    op.add(read);
    op.connect(read,filter);
    DataBag outbag=BagFactory.getInstance().newDefaultBag();
    Result res;
    Tuple t=tf.newTuple();
    do {
      res=filter.getNextTuple();
      if (res.returnStatus == POStatus.STATUS_OK) {
        outbag.add((Tuple)res.result);
      }
    }
 while (res.returnStatus == POStatus.STATUS_OK);
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
    assertEquals(1,outbag.size());
    Iterator<Tuple> it=outbag.iterator();
    assertTrue(it.hasNext());
    t=it.next();
    assertEquals(2,t.size());
    assertTrue(t.get(0) instanceof Integer);
    assertTrue(t.get(1) instanceof Integer);
    Integer i1=(Integer)t.get(0);
    Integer i2=(Integer)t.get(1);
    assertEquals(1,(int)i1);
    assertEquals(1,(int)i2);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleFilter() throws Exception {
  for (int i=0; i < nullFlags.length; i++) {
    POProject p1=GenPhyOp.exprProject(0);
    POProject p2=GenPhyOp.exprProject(1);
    GreaterThanExpr gt=GenPhyOp.compGreaterThanExpr(p1,p2,DataType.INTEGER);
    PhysicalPlan ip=new PhysicalPlan();
    ip.add(p1);
    ip.add(p2);
    ip.add(gt);
    ip.connect(p1,gt);
    ip.connect(p2,gt);
    int[] ints={0,1,1,0,1,1};
    TupleFactory tf=TupleFactory.getInstance();
    DataBag inbag=BagFactory.getInstance().newDefaultBag();
    Random r=new Random();
    for (int j=0; j < ints.length; j+=2) {
      if (nullFlags[i] == true) {
        int rand=r.nextInt(100);
        if (rand <= 20) {
          Tuple t=tf.newTuple(2);
          t.set(0,new Integer(ints[j]));
          t.set(1,null);
          inbag.add(t);
        }
 else         if (rand > 20 && rand <= 40) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,new Integer(ints[j + 1]));
          inbag.add(t);
        }
 else         if (rand > 40 && rand <= 60) {
          Tuple t=tf.newTuple(2);
          t.set(0,null);
          t.set(1,null);
          inbag.add(t);
        }
      }
      Tuple t=tf.newTuple(2);
      t.set(0,new Integer(ints[j]));
      t.set(1,new Integer(ints[j + 1]));
      inbag.add(t);
    }
    PORead read=GenPhyOp.topReadOp(inbag);
    POFilter filter=GenPhyOp.connectedFilterOp(read);
    filter.setPlan(ip);
    PhysicalPlan op=new PhysicalPlan();
    op.add(filter);
    op.add(read);
    op.connect(read,filter);
    DataBag outbag=BagFactory.getInstance().newDefaultBag();
    Result res;
    Tuple t=tf.newTuple();
    do {
      res=filter.getNextTuple();
      if (res.returnStatus == POStatus.STATUS_OK) {
        outbag.add((Tuple)res.result);
      }
    }
 while (res.returnStatus == POStatus.STATUS_OK);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",POStatus.STATUS_EOP,res.returnStatus);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",1,outbag.size());
    Iterator<Tuple> it=outbag.iterator();
    assertTrue("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",it.hasNext());
    t=it.next();
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",2,t.size());
    assertTrue("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",t.get(0) instanceof Integer);
    assertTrue("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",t.get(1) instanceof Integer);
    Integer i1=(Integer)t.get(0);
    Integer i2=(Integer)t.get(1);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",1,(int)i1);
    assertEquals("Running " + this.getClass().getName() + "with nullFlags set to "+ nullFlags[i]+ ":",0,(int)i2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterOpNumeric </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedBinCond() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i + "\t" + i+ "\t1");
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "';");
  String query="A = foreach A generate (($0 < 10 or $0 < 9)?(($1 >= 5 and $1 >= 4) ? 2: 1) : 0);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Integer first=(Integer)t.get(0);
    count+=first;
    assertTrue(first == 1 || first == 2 || first == 0);
  }
  assertEquals("expected count of 15",15,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNumericEq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println(i + ":" + (double)i);
    }
 else {
      ps.println(i + ":" + (i - 1));
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by ($0 == $1 and $0 <= $1);";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    Double second=Double.valueOf(t.get(1).toString());
    assertEquals(first,second);
    String sfirst=t.get(0).toString();
    String ssecond=t.get(1).toString();
    assertFalse(sfirst.equals(ssecond));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinCond() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  for (int i=0; i < LOOP_COUNT; i++) {
    ps.println(i + "\t" + i+ "\t1");
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "';");
  String query="A = foreach A generate ($1 >= " + LOOP_COUNT + "-10?'1':'0');";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    Double first=Double.valueOf(t.get(0).toString());
    if (first == 1)     count++;
 else     assertTrue(first == 0);
  }
  assertEquals("expected count of 10",10,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterOpString </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      expectedCount++;
    }
 else {
      ps.println("a:b");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 gt $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) > 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLt() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
 else {
      ps.println("a:b");
      expectedCount++;
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 lt $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) < 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      expectedCount++;
    }
 else     if (i % 3 == 0) {
      ps.println("b:b");
      expectedCount++;
    }
 else {
      ps.println("a:b");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 gte $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) >= 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringNeq() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("ab:ab");
    }
 else     if (i % 3 == 0) {
      ps.println("ab:abc");
      expectedCount++;
    }
 else {
      ps.println(":");
      ps.println("ab:");
      ps.println(":ab");
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 neq $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertFalse(first.equals(second));
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLte() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
  int expectedCount=0;
  for (int i=0; i < LOOP_COUNT; i++) {
    if (i % 5 == 0) {
      ps.println("b:a");
      ps.println("a:");
      ps.println(":b");
      ps.println(":");
    }
 else     if (i % 3 == 0) {
      ps.println("b:b");
      expectedCount++;
    }
 else {
      ps.println("a:b");
      expectedCount++;
    }
  }
  ps.close();
  pig.registerQuery("A=load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':');");
  String query="A = filter A by $0 lte $1;";
  log.info(query);
  pig.registerQuery(query);
  Iterator<Tuple> it=pig.openIterator("A");
  tmpFile.delete();
  int count=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String first=t.get(0).toString();
    String second=t.get(1).toString();
    assertTrue(first.compareTo(second) <= 0);
    count++;
  }
  assertEquals(expectedCount,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFilterUDF </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterUDF() throws Exception {
  pigServer.registerQuery("A = LOAD '" + Util.generateURI(tmpFile.toString(),pigServer.getPigContext()) + "' as (x:int);");
  pigServer.registerQuery("B = filter A by " + MyFilterFunction.class.getName() + "($0);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(true,(Integer)t.get(0) > 10);
    ++cnt;
  }
  assertEquals(10,cnt);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEach </h4><pre class="type-13 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple() throws ExecException, IOException {
  int size=0;
  for (Result res=fe.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=fe.getNextTuple()) {
    Tuple t=(Tuple)res.result;
    assertTrue(TestHelper.bagContains(projDB,t));
    ++size;
  }
  assertEquals(size,db.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEachNestedPlan </h4><pre class="type-13 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAlgebricFuncWithoutGroupBy() throws IOException, ParserException {
  String INPUT_FILE="test-sum.txt";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
  w.println("10\t{(1),(2),(3)}");
  w.println("20\t{(4),(5),(6),(7)}");
  w.println("30\t{(8),(9)}");
  w.close();
  try {
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pig.registerQuery("a = load '" + INPUT_FILE + "' "+ "as (id:int, g:bag{t:tuple(u:int)});");
    pig.registerQuery("b = foreach a generate id, SUM(g);");
    Iterator<Tuple> iter=pig.openIterator("b");
    List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(10,6L)","(20,22L)","(30,17L)"});
    int counter=0;
    while (iter.hasNext()) {
      assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
    }
    assertEquals(expectedResults.size(),counter);
  }
  finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiColInAlias() throws Exception {
  pig.getPigContext().getProperties().setProperty("pig.exec.nosecondarykey","true");
  String INPUT_FILE="test-multi-alias.txt";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
  w.println("10\tnrai01\t01");
  w.println("20\tnrai02\t02");
  w.close();
  try {
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pig.registerQuery("A = load '" + INPUT_FILE + "' "+ "as (a:int, b:chararray, c:int);");
    pig.registerQuery("B = GROUP A BY (a, b);");
    DataBag dbfrj=BagFactory.getInstance().newDefaultBag(), dbshj=BagFactory.getInstance().newDefaultBag();
{
      pig.registerQuery("C = FOREACH B { bg = A.($1,$2); GENERATE group, bg; } ;");
      Iterator<Tuple> iter1=pig.openIterator("C");
      while (iter1.hasNext()) {
        dbfrj.add(iter1.next());
      }
    }
{
      pig.registerQuery("D = FOREACH B { GENERATE group, A.($1,$2);};");
      Iterator<Tuple> iter2=pig.openIterator("D");
      while (iter2.hasNext()) {
        dbshj.add(iter2.next());
      }
    }
    Assert.assertEquals(dbfrj.size(),dbshj.size());
    Assert.assertEquals(true,TestHelper.compareBags(dbfrj,dbshj));
  }
  finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestForEachStar </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForeachStarSchemaUnkown() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  String query="  l1 = load '" + INPUT_FILE + "' ;"+ "f1 = foreach l1 generate * ;";
  Util.registerMultiLineQuery(pig,query);
  pig.explain("f1",System.out);
  Iterator<Tuple> it=pig.openIterator("f1");
  Tuple expectedResCharArray=(Tuple)Util.getPigConstant("('one','two')");
  Tuple expectedRes=TupleFactory.getInstance().newTuple();
  for (  Object field : expectedResCharArray.getAll()) {
    expectedRes.append(new DataByteArray(field.toString()));
  }
  assertTrue("has output",it.hasNext());
  assertEquals(expectedRes,it.next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestFuncSpec </h4><pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSpecCtorClassNameWithArgs(){
  String dummy=DummyClass.class.getName();
  FuncSpec fs=new FuncSpec(dummy + "(':')");
  Object o=PigContext.instantiateFuncFromSpec(fs);
  assertTrue(o instanceof DummyClass);
  assertEquals((byte)':',((DummyClass)o).delim);
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCtorClassNameArgs(){
  String dummy=DummyClass.class.getName();
  String[] args=new String[]{":"};
  FuncSpec fs=new FuncSpec(dummy,args);
  Object o=PigContext.instantiateFuncFromSpec(fs);
  assertTrue(o instanceof DummyClass);
  assertEquals((byte)':',((DummyClass)o).delim);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGTOrEqual </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(0.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(0.0));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("a"));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(0.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(0.0f));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(0));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(0L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("a"));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(0L));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(0L));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(0L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  GTOrEqualToExpr g=GenPhyOp.compGTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGreaterThan </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(0.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("a"));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(0.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(0L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(0.0f));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(0L));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(0.0));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(0L));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(0L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("a"));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(0));
  GreaterThanExpr g=GenPhyOp.compGreaterThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestGrunt </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagSchemaFail() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="a = load 'input1'as (b: bag{t:(i: int, c:chararray, f: float)});\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  try {
    grunt.exec();
    fail("Test case is supposed to fail.");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("<line 1, column 62>  mismatched input ';' expecting RIGHT_PAREN"));
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterWithQuotes() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String jarName=Util.findPigJarName();
  String strCmd="register '" + jarName + "'\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
  assertEquals(context.extraJars + " of size 1",1,context.extraJars.size());
  assertTrue(context.extraJars.get(0) + " ends with /" + jarName,context.extraJars.get(0).toString().endsWith("/" + jarName));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorLineNumber() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String strCmd="A = load 'x' as ( u:int, v:chararray );\n" + "sh ls\n" + "B = foreach A generate u , v; C = distinct 'xxx';\n"+ "store C into 'y';";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  try {
    grunt.exec();
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("<line 3, column 42>  Syntax error, unexpected symbol at or near ''xxx''"));
    return;
  }
  fail("Test case is supposed to fail.");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShellCommand(){
  try {
    PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
    PigContext context=server.getPigContext();
    String strRemoveFile="rm";
    String strRemoveDir="rmdir";
    if (Util.WINDOWS) {
      strRemoveFile="del";
      strRemoveDir="rd";
    }
    String strCmd="sh mkdir test_shell_tmp;";
    ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
    InputStreamReader reader=new InputStreamReader(cmd);
    Grunt grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertTrue(new File("test_shell_tmp").exists());
    strCmd="sh " + strRemoveDir + " test_shell_tmp;";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertFalse(new File("test_shell_tmp").exists());
    strCmd="sh echo hello world > tempShFileToTestShCommand";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    BufferedReader fileReader=null;
    fileReader=new BufferedReader(new FileReader("tempShFileToTestShCommand"));
    assertTrue(fileReader.readLine().trim().equals("hello world"));
    fileReader.close();
    strCmd="sh " + strRemoveFile + " tempShFileToTestShCommand";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertFalse(new File("tempShFileToTestShCommand").exists());
    if (Util.WINDOWS) {
      strCmd="sh echo foo > TouchedFileInsideGrunt_61 && dir /B | findstr TouchedFileInsideGrunt_61 > fileContainingTouchedFileInsideGruntShell_71";
    }
 else {
      strCmd="sh touch TouchedFileInsideGrunt_61 && ls | grep TouchedFileInsideGrunt_61 > fileContainingTouchedFileInsideGruntShell_71";
    }
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    fileReader=new BufferedReader(new FileReader("fileContainingTouchedFileInsideGruntShell_71"));
    assertTrue(fileReader.readLine().trim().equals("TouchedFileInsideGrunt_61"));
    fileReader.close();
    strCmd="sh " + strRemoveFile + " fileContainingTouchedFileInsideGruntShell_71";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertFalse(new File("fileContainingTouchedFileInsideGruntShell_71").exists());
    strCmd="sh " + strRemoveFile + " TouchedFileInsideGrunt_61";
    cmd=new ByteArrayInputStream(strCmd.getBytes());
    reader=new InputStreamReader(cmd);
    grunt=new Grunt(new BufferedReader(reader),context);
    grunt.exec();
    assertFalse(new File("TouchedFileInsideGrunt_61").exists());
  }
 catch (  ExecException e) {
    e.printStackTrace();
    fail();
  }
catch (  Throwable e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAutoShipUDFContainingJar() throws Throwable {
  String FILE_SEPARATOR=System.getProperty("file.separator");
  File tmpDir=File.createTempFile("test","");
  tmpDir.delete();
  tmpDir.mkdir();
  File udfDir=new File(tmpDir.getAbsolutePath() + FILE_SEPARATOR + "com"+ FILE_SEPARATOR+ "xxx"+ FILE_SEPARATOR+ "udf");
  udfDir.mkdirs();
  String udfSrc=new String("package com.xxx.udf;\n" + "import java.io.IOException;\n" + "import org.apache.pig.EvalFunc;\n"+ "import org.apache.pig.data.Tuple;\n"+ "public class TestUDF extends EvalFunc<Integer>{\n"+ "public Integer exec(Tuple input) throws IOException {\n"+ "return 1;}\n"+ "}");
  JavaCompilerHelper javaCompilerHelper=new JavaCompilerHelper();
  javaCompilerHelper.compile(tmpDir.getAbsolutePath(),new JavaCompilerHelper.JavaSourceFromString("com.xxx.udf.TestUDF",udfSrc));
  String jarName="TestUDFJar.jar";
  String jarFile=tmpDir.getAbsolutePath() + FILE_SEPARATOR + jarName;
  int status=Util.executeJavaCommand("jar -cf " + jarFile + " -C "+ tmpDir.getAbsolutePath()+ " "+ "com");
  assertEquals(0,status);
  Util.createInputFile(cluster,"table_testAutoShipUDFContainingJar",new String[]{"1"});
  File scriptFile=Util.createFile(new String[]{"a = load 'table_testAutoShipUDFContainingJar' as (a0:int);" + "b = foreach a generate com.xxx.udf.TestUDF(a0);" + "store b into 'output_testAutoShipUDFContainingJar';"});
  String scriptFileName=scriptFile.getAbsolutePath();
  String execTypeOptions="-x " + cluster.getExecType() + " ";
  String cmd="java -cp " + System.getProperty("java.class.path") + File.pathSeparator+ jarFile+ " org.apache.pig.Main "+ execTypeOptions+ scriptFileName;
  ProcessReturnInfo pri=Util.executeJavaCommandAndReturnInfo(cmd);
  assertEquals(pri.exitCode,0);
  String[] lines=pri.stderrContents.split("\n");
  boolean found=false;
  for (  String line : lines) {
    if (line.matches(".*Added jar .*" + jarName + ".*")) {
      found=true;
    }
 else     if (line.matches(".*Local resource.*" + jarName + ".*")) {
      found=true;
    }
  }
  assertTrue(found);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterWithoutQuotes() throws Throwable {
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  String jarName=Util.findPigJarName();
  String strCmd="register " + jarName + "\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
  assertEquals(context.extraJars + " of size 1",1,context.extraJars.size());
  assertTrue(context.extraJars.get(0) + " ends with /" + jarName,context.extraJars.get(0).toString().endsWith("/" + jarName));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStopOnFailure() throws Throwable {
  Assume.assumeTrue("Skip this test for TEZ",Util.isMapredExecType(cluster.getExecType()));
  PigServer server=new PigServer(cluster.getExecType(),cluster.getProperties());
  PigContext context=server.getPigContext();
  context.getProperties().setProperty("stop.on.failure","" + true);
  String strCmd="rmf bar;\n" + "rmf foo;\n" + "rmf baz;\n"+ "copyFromLocal test/org/apache/pig/test/data/passwd pre;\n"+ "A = load '" + Util.generateURI("file:test/org/apache/pig/test/data/passwd",context) + "';\n"+ "B = stream A through `false`;\n"+ "store B into 'bar' using BinStorage();\n"+ "A = load 'bar';\n"+ "store A into 'foo';\n"+ "cp pre done;\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  boolean caught=false;
  try {
    grunt.exec();
  }
 catch (  PigException e) {
    caught=true;
    assertTrue(e.getErrorCode() == 6017);
  }
  assertFalse(server.existsFile("done"));
  assertTrue(caught);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestHBaseStorage </h4><pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Assert that -noWAL actually disables the WAL
 * @throws IOException
 * @throws ParseException
 */
@Test public void testNoWAL() throws Exception {
  HBaseStorage hbaseStorage=new HBaseStorage(TESTCOLUMN_A,"-noWAL");
  Object key="somekey";
  byte type=DataType.CHARARRAY;
  Put put=hbaseStorage.createPut(key,type);
  Delete delete=hbaseStorage.createDelete(key,type,System.currentTimeMillis());
  boolean hasDurabilityMethod=false;
  try {
    put.getClass().getMethod("getDurability");
    hasDurabilityMethod=true;
  }
 catch (  NoSuchMethodException e) {
  }
  if (hasDurabilityMethod) {
    Object skipWal=Class.forName("org.apache.hadoop.hbase.client.Durability").getField("SKIP_WAL").get(put);
    Assert.assertEquals(put.getClass().getMethod("getDurability").invoke(put),skipWal);
    Assert.assertEquals(delete.getClass().getMethod("getDurability").invoke(delete),skipWal);
  }
 else {
    Assert.assertFalse(put.getWriteToWAL());
    Assert.assertFalse(delete.getWriteToWAL());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreEmptyMap() throws IOException {
  String tableName="emptyMapTest";
  HTable table;
  try {
    deleteAllRows(tableName);
  }
 catch (  Exception e) {
  }
  byte[][] cfs=new byte[2][];
  cfs[0]=Bytes.toBytes("info");
  cfs[1]=Bytes.toBytes("friends");
  try {
    table=util.createTable(Bytes.toBytesBinary(tableName),cfs);
  }
 catch (  Exception e) {
    table=new HTable(conf,Bytes.toBytesBinary(tableName));
  }
  File inputFile=Util.createInputFile("test","tmp",new String[]{"row1;Homer;Morrison;[1#Silvia,2#Stacy]","row2;Sheila;Fletcher;[1#Becky,2#Salvador,3#Lois]","row4;Andre;Morton;[1#Nancy]","row3;Sonja;Webb;[]"});
  pig.registerQuery("source = LOAD '" + Util.generateURI(inputFile.toString(),pig.getPigContext()) + "' USING PigStorage(';')"+ " AS (row:chararray, first_name:chararray, last_name:chararray, friends:map[]);");
  pig.registerQuery("STORE source INTO 'hbase://" + tableName + "' USING"+ " org.apache.pig.backend.hadoop.hbase.HBaseStorage('info:fname info:lname friends:*');");
  Get get=new Get(Bytes.toBytes("row3"));
  Result r=table.get(get);
  Assert.assertEquals(new String(r.getValue(cfs[0],Bytes.toBytes("fname"))),"Sonja");
  Assert.assertEquals(new String(r.getValue(cfs[0],Bytes.toBytes("lname"))),"Webb");
  Assert.assertTrue(r.getFamilyMap(cfs[1]).isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test Load from hbase with maxTimestamp, minTimestamp, timestamp
 */
@Test public void testLoadWithSpecifiedTimestampAndRanges() throws IOException {
  long beforeTimeStamp=System.currentTimeMillis() - 10;
  HTable table=prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  long afterTimeStamp=System.currentTimeMillis() + 10;
  Assert.assertEquals("MaxTimestamp is set before rows added",0,queryWithTimestamp(null,beforeTimeStamp,null));
  Assert.assertEquals("MaxTimestamp is set after rows added",TEST_ROW_COUNT,queryWithTimestamp(null,afterTimeStamp,null));
  Assert.assertEquals("MinTimestamp is set after rows added",0,queryWithTimestamp(afterTimeStamp,null,null));
  Assert.assertEquals("MinTimestamp is set before rows added",TEST_ROW_COUNT,queryWithTimestamp(beforeTimeStamp,null,null));
  Assert.assertEquals("Timestamp range is set around rows added",TEST_ROW_COUNT,queryWithTimestamp(beforeTimeStamp,afterTimeStamp,null));
  Assert.assertEquals("Timestamp range is set after rows added",0,queryWithTimestamp(afterTimeStamp,afterTimeStamp + 10,null));
  Assert.assertEquals("Timestamp range is set before rows added",0,queryWithTimestamp(beforeTimeStamp - 10,beforeTimeStamp,null));
  Assert.assertEquals("Timestamp is set before rows added",0,queryWithTimestamp(null,null,beforeTimeStamp));
  Assert.assertEquals("Timestamp is set after rows added",0,queryWithTimestamp(null,null,afterTimeStamp));
  long specifiedTimestamp=table.get(new Get(Bytes.toBytes("00"))).getColumnLatest(COLUMNFAMILY,Bytes.toBytes("col_a")).getTimestamp();
  Assert.assertTrue("Timestamp is set equals to row 01",queryWithTimestamp(null,null,specifiedTimestamp) > 0);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to if HBaseStorage handles different scans in a single MR job.
 * This can happen PIG loads two different aliases (as in a join or
 * union).
 */
@Test public void testHeterogeneousScans() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.HBaseBinary);
  prepareTable(TESTTABLE_2,true,DataFormat.UTF8PlainText);
  scanTable1(pig,DataFormat.HBaseBinary);
  pig.registerQuery(String.format(" b = load 'hbase://%s' using %s('%s %s') as (col_a:int, col_c);",TESTTABLE_2,"org.apache.pig.backend.hadoop.hbase.HBaseStorage",TESTCOLUMN_A,TESTCOLUMN_C));
  pig.registerQuery(" c = join a by col_a, b by col_a; ");
  Iterator<Tuple> it=pig.openIterator("c");
  int index=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    String rowKey=(String)t.get(0);
    int col_a=(Integer)t.get(1);
    Assert.assertNotNull(t.get(2));
    double col_b=(Double)t.get(2);
    String col_c=(String)t.get(3);
    Assert.assertEquals("00".substring((index + "").length()) + index,rowKey);
    Assert.assertEquals(index,col_a);
    Assert.assertEquals(index + 0.0,col_b,1e-6);
    Assert.assertEquals("Text_" + index,col_c);
    index++;
  }
  Assert.assertEquals(index,TEST_ROW_COUNT);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * load from hbase test
 * @throws IOException
 */
@Test public void testLoadFromHBase() throws IOException {
  prepareTable(TESTTABLE_1,true,DataFormat.UTF8PlainText);
  LOG.info("QUERY: " + "a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:col_d"+ "') as (col_a, col_b, col_c, col_d);");
  pig.registerQuery("a = load 'hbase://" + TESTTABLE_1 + "' using "+ "org.apache.pig.backend.hadoop.hbase.HBaseStorage('"+ TESTCOLUMN_A+ " "+ TESTCOLUMN_B+ " "+ TESTCOLUMN_C+ " pig:col_d"+ "') as (col_a, col_b, col_c, col_d);");
  Iterator<Tuple> it=pig.openIterator("a");
  int count=0;
  LOG.info("LoadFromHBase Starting");
  while (it.hasNext()) {
    Tuple t=it.next();
    String col_a=((DataByteArray)t.get(0)).toString();
    String col_b=((DataByteArray)t.get(1)).toString();
    String col_c=((DataByteArray)t.get(2)).toString();
    Object col_d=t.get(3);
    Assert.assertEquals(count,Integer.parseInt(col_a));
    Assert.assertEquals(count + 0.0,Double.parseDouble(col_b),1e-6);
    Assert.assertEquals("Text_" + count,col_c);
    Assert.assertNull(col_d);
    count++;
  }
  Assert.assertEquals(TEST_ROW_COUNT,count);
  LOG.info("LoadFromHBase done");
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Assert that without -noWAL, the WAL is enabled the WAL
 * @throws IOException
 * @throws ParseException
 */
@Test public void testWIthWAL() throws Exception {
  HBaseStorage hbaseStorage=new HBaseStorage(TESTCOLUMN_A);
  Object key="somekey";
  byte type=DataType.CHARARRAY;
  Put put=hbaseStorage.createPut(key,type);
  Delete delete=hbaseStorage.createDelete(key,type,System.currentTimeMillis());
  boolean hasDurabilityMethod=false;
  try {
    put.getClass().getMethod("getDurability");
    hasDurabilityMethod=true;
  }
 catch (  NoSuchMethodException e) {
  }
  if (hasDurabilityMethod) {
    Object skipWal=Class.forName("org.apache.hadoop.hbase.client.Durability").getField("SKIP_WAL").get(put);
    Assert.assertNotEquals(put.getClass().getMethod("getDurability").invoke(put),skipWal);
    Assert.assertNotEquals(delete.getClass().getMethod("getDurability").invoke(delete),skipWal);
  }
 else {
    Assert.assertTrue(put.getWriteToWAL());
    Assert.assertTrue(delete.getWriteToWAL());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestImplicitSplit </h4><pre class="type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplit() throws Exception {
  int LOOP_SIZE=20;
  String[] input=new String[LOOP_SIZE];
  for (int i=1; i <= LOOP_SIZE; i++) {
    input[i - 1]=Integer.toString(i);
  }
  String inputFileName="testImplicitSplit-input.txt";
  Util.createInputFile(cluster,inputFileName,input);
  pigServer.registerQuery("A = LOAD '" + inputFileName + "';");
  pigServer.registerQuery("B = filter A by $0<=10;");
  pigServer.registerQuery("C = filter A by $0>10;");
  pigServer.registerQuery("D = union B,C;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  if (!iter.hasNext())   fail("No Output received");
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    ++cnt;
  }
  assertEquals(20,cnt);
  Util.deleteFile(cluster,inputFileName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestIn </h4><pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that IN operator throws FrontendException when no operand is given.
 * @throws Exception
 */
@Test(expected=FrontendException.class) public void testMissingRhsOperand() throws Exception {
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  data.set("foo",tuple(1),tuple(2),tuple(3),tuple(4),tuple(5));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (i:int);");
  pigServer.registerQuery("B = FILTER A BY i IN ();");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  fail("FrontendException must be thrown since no rhs operand is given to IN.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInfixArithmetic </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdd() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 + $1, $1;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first + first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivide() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 / $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(1.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiply() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 * $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(first * first),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtract() throws Throwable {
  File tmpFile=File.createTempFile("test","txt");
  for (int i=0; i < nullFlags.length; i++) {
    System.err.println("Testing with nulls: " + nullFlags[i]);
    PrintStream ps=new PrintStream(new FileOutputStream(tmpFile));
    generateInput(ps,nullFlags[i]);
    String query="A = foreach (load '" + Util.encodeEscape(Util.generateURI(tmpFile.toString(),pig.getPigContext())) + "' using "+ PigStorage.class.getName()+ "(':')) generate $0, $0 - $1, $1 ;";
    log.info(query);
    pig.registerQuery(query);
    Iterator<Tuple> it=pig.openIterator("A");
    tmpFile.delete();
    while (it.hasNext()) {
      Tuple t=it.next();
      Double first=(t.get(0) == null ? null : DataType.toDouble(t.get(0)));
      Double second=(t.get(1) == null ? null : DataType.toDouble(t.get(1)));
      Double third=(t.get(2) == null ? null : DataType.toDouble(t.get(2)));
      if (first != null && third != null) {
        assertEquals(Double.valueOf(0.0),second);
      }
 else {
        assertNull(second);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInputOutputFileValidator </h4><pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case to test that Input output file validation catches the case
 * where the output file exists when using{@link PigServer#store(String,String)}
 * @throws Exception
 */
@Test(expected=PigException.class) public void testPigServerStoreNeg() throws Exception {
  String input="input.txt";
  String output="output.txt";
  String data[]=new String[]{"hello\tworld"};
  try {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
    Util.createInputFile(pig.getPigContext(),input,data);
    Util.createInputFile(pig.getPigContext(),output,data);
    try {
      pig.registerQuery("a = load '" + input + "';");
      pig.store("a",output);
    }
 catch (    Exception e) {
      assertEquals(6000,LogUtils.getPigException(e).getErrorCode());
      throw e;
    }
  }
  finally {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Testcase to ensure Input output validation allows store to a location
 * that does not exist when using {@link PigServer#store(String,String)}
 * @throws Exception
 */
@Test public void testPigServerStore() throws Exception {
  String input="input.txt";
  String output="output.txt";
  String data[]=new String[]{"hello\tworld"};
  try {
    FileLocalizer.setInitialized(false);
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
    Util.createInputFile(pig.getPigContext(),input,data);
    pig.registerQuery("a = load '" + input + "';");
    pig.store("a",output);
    pig.registerQuery("b = load '" + output + "';");
    Iterator<Tuple> it=pig.openIterator("b");
    Tuple t=it.next();
    assertEquals("hello",t.get(0).toString());
    assertEquals("world",t.get(1).toString());
    assertFalse(it.hasNext());
  }
  finally {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestInputOutputMiniClusterFileValidator </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidationNeg() throws Throwable {
  try {
    pig.setBatchOn();
    pig.registerQuery("A = load 'inputfile' using PigStorage () as (a:int);");
    pig.registerQuery("store A into 'outfile' using " + DummyStorer.class.getName() + ";");
    pig.executeBatch();
    assert false;
  }
 catch (  Exception fe) {
    assertTrue(fe instanceof FrontendException);
    PigException pe=LogUtils.getPigException(fe);
    assertTrue(pe instanceof FrontendException);
    assertEquals(1115,pe.getErrorCode());
    assertTrue(pe.getMessage().contains("Exception from DummyStorer."));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case to test that Input output file validation catches the case
 * where the output file exists when using{@link PigServer#store(String,String)}
 * @throws Exception
 */
@Test(expected=PigException.class) public void testPigServerStoreNeg() throws Exception {
  String input="input.txt";
  String output="output.txt";
  String data[]=new String[]{"hello\tworld"};
  try {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
    Util.createInputFile(pig.getPigContext(),input,data);
    Util.createInputFile(pig.getPigContext(),output,data);
    try {
      pig.registerQuery("a = load '" + input + "';");
      pig.store("a",output);
      fail("Expected exception to be caught");
    }
 catch (    Exception e) {
      assertEquals(6000,LogUtils.getPigException(e).getErrorCode());
      throw e;
    }
  }
  finally {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Testcase to ensure Input output validation allows store to a location
 * that does not exist when using {@link PigServer#store(String,String)}
 * @throws Exception
 */
@Test public void testPigServerStore() throws Exception {
  String input="input.txt";
  String output="output.txt";
  String data[]=new String[]{"hello\tworld"};
  try {
    FileLocalizer.setInitialized(false);
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
    Util.createInputFile(pig.getPigContext(),input,data);
    pig.registerQuery("a = load '" + input + "';");
    pig.store("a",output);
    pig.registerQuery("b = load '" + output + "';");
    Iterator<Tuple> it=pig.openIterator("b");
    Tuple t=it.next();
    assertEquals("hello",t.get(0).toString());
    assertEquals("world",t.get(1).toString());
    assertFalse(it.hasNext());
  }
  finally {
    Util.deleteFile(pig.getPigContext(),input);
    Util.deleteFile(pig.getPigContext(),output);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJobControlCompiler </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * specifically tests that REGISTERED jars get added to distributed cache
 * @throws Exception
 */
@Test public void testJarAddedToDistributedCache() throws Exception {
  File tmpFile=File.createTempFile("Some_",".jar");
  tmpFile.deleteOnExit();
  String className=createTestJar(tmpFile);
  final String testUDFFileName=className + ".class";
  PigServer pigServer=new PigServer(ExecType.MAPREDUCE);
  PigContext pigContext=pigServer.getPigContext();
  pigContext.connect();
  pigContext.addJar(tmpFile.getAbsolutePath());
  JobControlCompiler jobControlCompiler=new JobControlCompiler(pigContext,CONF);
  MROperPlan plan=new MROperPlan();
  MapReduceOper mro=new MapReduceOper(new OperatorKey());
  mro.UDFs=new HashSet<String>();
  mro.UDFs.add(className + "()");
  plan.add(mro);
  JobControl jobControl=jobControlCompiler.compile(plan,"test");
  JobConf jobConf=jobControl.getWaitingJobs().get(0).getJobConf();
  Path[] fileClassPaths=DistributedCache.getFileClassPaths(jobConf);
  Assert.assertEquals("size for " + Arrays.toString(fileClassPaths),HadoopShims.isHadoopYARN() ? 5 : 6,fileClassPaths.length);
  Path distributedCachePath=fileClassPaths[0];
  Assert.assertEquals("ends with jar name: " + distributedCachePath,distributedCachePath.getName(),tmpFile.getName());
  Assert.assertTrue("starts with /: " + distributedCachePath,distributedCachePath.toString().startsWith("/"));
  Assert.assertTrue("jar pushed to distributed cache should contain testUDF",jarContainsFileNamed(new File(fileClassPaths[0].toUri().getPath()),testUDFFileName));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJobSubmission </h4><pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParallelInSort() throws Throwable {
  String query="a = load 'input';" + "b = order a by $0 parallel 100;" + "store b into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  Iterator<MapReduceOper> iter=mrPlan.getKeys().values().iterator();
  int counter=0;
  while (iter.hasNext()) {
    MapReduceOper op=iter.next();
    counter++;
    if (op.isGlobalSort()) {
      assertTrue(op.getRequestedParallelism() == 100);
    }
  }
  assertEquals(3,counter);
  pc.defaultParallel=-1;
}

</code></pre>

<br>
<pre class="type-7 type-6 type-20 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReducerNumEstimationForOrderBy() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ",Util.isMapredExecType(cluster.getExecType()));
  pc.getProperties().setProperty("pig.exec.reducers.bytes.per.reducer","100");
  pc.getProperties().setProperty("pig.exec.reducers.max","10");
  String query="a = load '/passwd';" + "b = order a by $0;" + "store b into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlanWithOptimizer(pp,pc);
  Configuration conf=ConfigurationUtil.toConfiguration(pc.getProperties());
  JobControlCompiler jcc=new JobControlCompiler(pc,conf);
  JobControl jobControl=jcc.compile(mrPlan,query);
  assertEquals(2,mrPlan.size());
  Util.assertParallelValues(-1,1,-1,1,jobControl.getWaitingJobs().get(0).getJobConf());
  MapReduceOper sort=mrPlan.getLeaves().get(0);
  jcc.updateMROpPlan(jobControl.getReadyJobs());
  FileLocalizer.create(sort.getQuantFile(),pc);
  jobControl=jcc.compile(mrPlan,query);
  sort=mrPlan.getLeaves().get(0);
  long reducer=Math.min((long)Math.ceil(new File("test/org/apache/pig/test/data/passwd").length() / 100.0),10);
  assertEquals(reducer,sort.getRequestedParallelism());
  Util.assertParallelValues(-1,-1,reducer,reducer,jobControl.getWaitingJobs().get(0).getJobConf());
  query="a = load '/passwd';" + "b = order a by $0 PARALLEL 2;" + "store b into 'output';";
  pp=Util.buildPp(ps,query);
  mrPlan=Util.buildMRPlanWithOptimizer(pp,pc);
  assertEquals(2,mrPlan.size());
  sort=mrPlan.getLeaves().get(0);
  assertEquals(2,sort.getRequestedParallelism());
  query="a = load 'hbase://passwd' using org.apache.pig.backend.hadoop.hbase.HBaseStorage('c:f1 c:f2');" + "b = order a by $0 ;" + "store b into 'output';";
  pp=Util.buildPp(ps,query);
  mrPlan=Util.buildMRPlanWithOptimizer(pp,pc);
  assertEquals(2,mrPlan.size());
  sort=mrPlan.getLeaves().get(0);
  assertEquals(-1,sort.getRequestedParallelism());
  query="a = load '/passwd';" + "b = foreach a generate $0, $1, $2;" + "c = order b by $0;"+ "store c into 'output';";
  pp=Util.buildPp(ps,query);
  mrPlan=Util.buildMRPlanWithOptimizer(pp,pc);
  assertEquals(3,mrPlan.size());
  sort=mrPlan.getLeaves().get(0);
  FileLocalizer.create(sort.getQuantFile(),pc);
  jobControl=jcc.compile(mrPlan,query);
  Util.copyFromLocalToCluster(cluster,"test/org/apache/pig/test/data/passwd",((POLoad)sort.mapPlan.getRoots().get(0)).getLFile().getFileName());
  Util.assertParallelValues(-1,-1,-1,0,jobControl.getWaitingJobs().get(0).getJobConf());
  jcc.updateMROpPlan(jobControl.getReadyJobs());
  jobControl=jcc.compile(mrPlan,query);
  jcc.updateMROpPlan(jobControl.getReadyJobs());
  Util.assertParallelValues(-1,1,-1,1,jobControl.getWaitingJobs().get(0).getJobConf());
  jobControl=jcc.compile(mrPlan,query);
  sort=mrPlan.getLeaves().get(0);
  assertEquals(reducer,sort.getRequestedParallelism());
  Util.assertParallelValues(-1,-1,reducer,reducer,jobControl.getWaitingJobs().get(0).getJobConf());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParallelInSkewJoin() throws Throwable {
  String query="a = load 'input';" + "b = load 'input';" + "c = join a by $0, b by $0 using 'skewed' parallel 100;"+ "store c into 'output';";
  PigServer ps=new PigServer(cluster.getExecType(),cluster.getProperties());
  PhysicalPlan pp=Util.buildPp(ps,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  Iterator<MapReduceOper> iter=mrPlan.getKeys().values().iterator();
  int counter=0;
  while (iter.hasNext()) {
    MapReduceOper op=iter.next();
    counter++;
    if (op.isSkewedJoin()) {
      assertTrue(op.getRequestedParallelism() == 100);
    }
  }
  assertEquals(3,counter);
  pc.defaultParallel=-1;
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToUri() throws Exception {
  Class<JobControlCompiler> jobControlCompilerClass=JobControlCompiler.class;
  Method toURIMethod=jobControlCompilerClass.getDeclaredMethod("toURI",Path.class);
  toURIMethod.setAccessible(true);
  Path p1=new Path("/tmp/temp-1510081022/tmp-1308657145#pigsample_1889145873_1351808882314");
  URI uri1=(URI)toURIMethod.invoke(null,p1);
  Assert.assertEquals(uri1.toString(),"/tmp/temp-1510081022/tmp-1308657145#pigsample_1889145873_1351808882314");
  Path p2=new Path("C:/Program Files/GnuWin32/bin/head.exe#pigsample_1889145873_1351808882314");
  URI uri2=(URI)toURIMethod.invoke(null,p2);
  Assert.assertTrue(uri2.toString().equals("C:/Program%20Files/GnuWin32/bin/head.exe#pigsample_1889145873_1351808882314") || uri2.toString().equals("/C:/Program%20Files/GnuWin32/bin/head.exe#pigsample_1889145873_1351808882314"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinBase </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinSchema() throws Exception {
  String[] input1={"1\t2","2\t3","3\t4"};
  String[] input2={"1\thello","4\tbye"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  Tuple expectedResult=(Tuple)Util.getPigConstant("(1,2,1,'hello',1,2,1,'hello')");
  String script="a = load '" + Util.encodeEscape(firstInput) + "' as (i:int, j:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (k:int, l:chararray); "+ "c = join a by $0, b by $0;"+ "d = foreach c generate i,j,k,l,a::i as ai,a::j as aj,b::k as bk,b::l as bl;";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("d");
  assertTrue(it.hasNext());
  assertEquals(expectedResult,it.next());
  assertFalse(it.hasNext());
  script="a = load '" + Util.encodeEscape(firstInput) + "' as (i:int, j:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (i:int, l:chararray); "+ "c = join a by $0, b by $0;"+ "d = foreach c generate i,j,l,a::i as ai,a::j as aj,b::i as bi,b::l as bl;";
  boolean exceptionThrown=false;
  try {
    Util.registerMultiLineQuery(pigServer,script);
    pigServer.openIterator("d");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    assertEquals(1025,pe.getErrorCode());
    exceptionThrown=true;
  }
  assertTrue(exceptionThrown);
  script="a = load '" + Util.encodeEscape(firstInput) + "' as (i:int, j:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (i:int, l:chararray); "+ "c = join a by $0, b by $0;"+ "d = foreach c generate a::i as ai1,j,b::i as bi1,l,a::i as ai2,a::j as aj2,b::i as bi3,b::l as bl3;";
  Util.registerMultiLineQuery(pigServer,script);
  it=pigServer.openIterator("d");
  assertTrue(it.hasNext());
  assertEquals(expectedResult,it.next());
  assertFalse(it.hasNext());
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultJoin() throws Exception {
  String[] input1={"hello\t1","bye\t2","\t3"};
  String[] input2={"hello\tworld","good\tmorning","\tevening"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  Tuple expectedResult=(Tuple)Util.getPigConstant("('hello',1,'hello','world')");
  String script="a = load '" + Util.encodeEscape(firstInput) + "' as (n:chararray, a:int); "+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (n:chararray, m:chararray); "+ "c = join a by $0, b by $0;";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("c");
  assertTrue(it.hasNext());
  assertEquals(expectedResult,it.next());
  assertFalse(it.hasNext());
  script="a = load '" + Util.encodeEscape(firstInput) + "'; "+ "b = load '"+ Util.encodeEscape(secondInput)+ "'; "+ "c = join a by $0, b by $0;";
  Util.registerMultiLineQuery(pigServer,script);
  it=pigServer.openIterator("c");
  assertTrue(it.hasNext());
  assertEquals(expectedResult.toString(),it.next().toString());
  assertFalse(it.hasNext());
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJoinLocal </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndirectSelfJoinRealias() throws Exception {
  Data data=resetData(pigServer);
  Set<Tuple> tuples=Sets.newHashSet(tuple("a"),tuple("b"),tuple("c"));
  data.set("foo",Utils.getSchemaFromString("field1:chararray"),tuples);
  pigServer.registerQuery("A = load 'foo' using mock.Storage();");
  pigServer.registerQuery("B = foreach A generate *;");
  pigServer.registerQuery("C = join A by field1, B by field1;");
  assertEquals(Utils.getSchemaFromString("A::field1:chararray, B::field1:chararray"),pigServer.dumpSchema("C"));
  pigServer.registerQuery("D = foreach C generate B::field1, A::field1 as field2;");
  assertEquals(Utils.getSchemaFromString("B::field1:chararray, field2:chararray"),pigServer.dumpSchema("D"));
  pigServer.registerQuery("E = foreach D generate field1, field2;");
  assertEquals(Utils.getSchemaFromString("B::field1:chararray, field2:chararray"),pigServer.dumpSchema("E"));
  pigServer.registerQuery("F = foreach E generate field2;");
  pigServer.registerQuery("store F into 'foo_out' using mock.Storage();");
  List<Tuple> out=data.get("foo_out");
  assertEquals("Expected size was " + tuples.size() + " but was "+ out.size(),tuples.size(),out.size());
  for (  Tuple t : out) {
    assertTrue("Should have found tuple " + t + " in expected: "+ tuples,tuples.remove(t));
  }
  assertTrue("All expected tuples should have been found, remaining: " + tuples,tuples.isEmpty());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndirectSelfJoinData() throws Exception {
  Data data=resetData(pigServer);
  Set<Tuple> tuples=Sets.newHashSet(tuple("a",1),tuple("b",2),tuple("c",3));
  data.set("foo",Utils.getSchemaFromString("field1:chararray,field2:int"),tuples);
  pigServer.registerQuery("A = load 'foo' using mock.Storage();");
  pigServer.registerQuery("B = foreach A generate field1, field2*2 as field2;");
  pigServer.registerQuery("C = join A by field1, B by field1;");
  pigServer.registerQuery("D = foreach C generate A::field1 as field1_a, B::field1 as field1_b, A::field2 as field2_a, B::field2 as field2_b;");
  pigServer.registerQuery("store D into 'foo_out' using mock.Storage();");
  Set<Tuple> expected=Sets.newHashSet(tuple("a","a",1,2),tuple("b","b",2,4),tuple("c","c",3,6));
  List<Tuple> out=data.get("foo_out");
  assertEquals("Expected size was " + expected.size() + " but was "+ out.size(),expected.size(),out.size());
  for (  Tuple t : out) {
    assertTrue("Should have found tuple " + t + " in expected: "+ expected,expected.remove(t));
  }
  assertTrue("All expected tuples should have been found, remaining: " + expected,expected.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinSchema2() throws Exception {
  String[] input1={"1\t2","2\t3","3\t4"};
  String[] input2={"1\thello","4\tbye"};
  String firstInput=createInputFile("a.txt",input1);
  String secondInput=createInputFile("b.txt",input2);
  Tuple expectedResultCharArray=(Tuple)Util.getPigConstant("('1','2','1','hello','1','2','1','hello')");
  Tuple expectedResult=TupleFactory.getInstance().newTuple();
  for (  Object field : expectedResultCharArray.getAll()) {
    expectedResult.append(new DataByteArray(field.toString()));
  }
  String script="a = load '" + Util.encodeEscape(firstInput) + "' ; "+ "a = foreach a generate $0 as i, $1 as j ;"+ "b = load '"+ Util.encodeEscape(secondInput)+ "' as (k, l); "+ "c = join a by $0, b by $0;"+ "d = foreach c generate i,j,k,l,a::i as ai,a::j as aj,b::k as bk,b::l as bl;";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("d");
  assertTrue(it.hasNext());
  Tuple res=it.next();
  assertEquals(expectedResult,res);
  assertFalse(it.hasNext());
  deleteInputFile(firstInput);
  deleteInputFile(secondInput);
}

</code></pre>

<br>
<pre class="type-13 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonRegularOuterJoinFailure() throws Exception {
  String query="a = load 'a.txt' as (n:chararray, a:int); " + "b = load 'b.txt' as (n:chararray, m:chararray); ";
  String[] types=new String[]{"left","right","full"};
  String[] joinTypes=new String[]{"replicated","repl"};
  for (int i=0; i < types.length; i++) {
    for (int j=0; j < joinTypes.length; j++) {
      boolean errCaught=false;
      try {
        String q=query + "d = join a by $0 " + types[i]+ " outer, b by $0 using '"+ joinTypes[j]+ "';"+ "store d into 'output';";
        Util.buildLp(pigServer,q);
      }
 catch (      Exception e) {
        errCaught=true;
        assertTrue(e.getMessage().contains("does not support (right|full) outer joins"));
      }
      assertEquals(i == 0 ? false : true,errCaught);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestJsonLoaderStorage </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testJsonLoaderBigDecimalFormats() throws IOException {
  String bigDecimalJsonFile=createInput(bigDecimalJson);
  pigServer.registerQuery("data = load '" + bigDecimalJsonFile + "' using JsonLoader('a:bigdecimal, b:bigdecimal');");
  Iterator<Tuple> tuples=pigServer.openIterator("data");
  Tuple t=tuples.next();
  assertTrue(t.size() == 2);
  assertTrue(t.get(0) != null);
  assertTrue(t.get(1) != null);
  assertEquals(t.get(0),t.get(1));
  assertTrue(!tuples.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testJsonLoader() throws IOException {
  Iterator<Tuple> tuples=loadJson(json);
  int count=0;
  while (tuples.hasNext()) {
    Tuple tuple=tuples.next();
    assertEquals(Boolean.class,tuple.get(0).getClass());
    assertEquals(Integer.class,tuple.get(1).getClass());
    assertEquals(Long.class,tuple.get(2).getClass());
    assertEquals(Float.class,tuple.get(3).getClass());
    assertEquals(Double.class,tuple.get(4).getClass());
    assertEquals(DateTime.class,tuple.get(5).getClass());
    assertEquals("2013-01-02T03:04:05.123+03:00",tuple.get(5).toString());
    assertEquals(DataByteArray.class,tuple.get(6).getClass());
    assertEquals(String.class,tuple.get(7).getClass());
    assertEquals(BigInteger.class,tuple.get(8).getClass());
    assertEquals(BigDecimal.class,tuple.get(9).getClass());
    assertTrue(tuple.get(10) instanceof Map);
    assertEquals(String.class,((Map)tuple.get(10)).get("a").getClass());
    assertTrue(tuple.get(11) instanceof Tuple);
    assertEquals(Integer.class,((Tuple)tuple.get(11)).get(0).getClass());
    assertTrue(tuple.get(12) instanceof DataBag);
    DataBag bag=(DataBag)tuple.get(12);
    assertEquals(3,bag.size());
    Iterator<Tuple> bagTuples=bag.iterator();
    while (bagTuples.hasNext()) {
      assertEquals(Integer.class,bagTuples.next().get(0).getClass());
    }
    count++;
  }
  assertEquals(1,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestKeyTypeDiscoveryVisitor </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullJoin() throws Exception {
  String[] inputData=new String[]{"\t7\t8","\t8\t9","1\t20\t30","1\t20\t40"};
  Util.createInputFile(cluster,"a.txt",inputData);
  inputData=new String[]{"7\t2","1\t5","1\t10"};
  Util.createInputFile(cluster,"b.txt",inputData);
  String script="a = load 'a.txt' as (x:int, y:int, z:int);" + "b = load 'b.txt' as (x:int, y:int);" + "b_group = group b by x;"+ "b_sum = foreach b_group generate flatten(group) as x, SUM(b.y) as clicks;"+ "a_group = group a by (x, y);"+ "a_aggs = foreach a_group generate flatten(group) as (x, y), SUM(a.z) as zs;"+ "join_a_b = join b_sum by x, a_aggs by x;";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("join_a_b");
  Object[] results=new Object[]{1,15L,1,20,70L};
  Tuple output=it.next();
  assertFalse(it.hasNext());
  assertEquals(results.length,output.size());
  for (int i=0; i < output.size(); i++) {
    assertEquals(results[i],output.get(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLOLoadDeterminedSchema </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Loads a test file using ScriptSchemaTestLoader with a user defined schema
 * a,b,c.<br/>
 * Then tests the the ScriptSchemaTestLoader found the schema.
 * @throws IOException
 */
@Test public void testDeterminedSchema() throws IOException {
  FuncSpec funcSpec=new FuncSpec(ScriptSchemaTestLoader.class.getName() + "()");
  server.registerFunction(ScriptSchemaTestLoader.class.getName(),funcSpec);
  server.registerQuery("a = LOAD '" + Util.encodeEscape(inputFile.getAbsolutePath()) + "' using "+ ScriptSchemaTestLoader.class.getName()+ "() as (a, b, c) ;");
  server.openIterator("a");
  Schema scriptSchema=ScriptSchemaTestLoader.getScriptSchema();
  assertNotNull(scriptSchema);
  assertEquals(3,scriptSchema.size());
  assertNotNull(scriptSchema.getField("a"));
  assertNotNull(scriptSchema.getField("b"));
  assertNotNull(scriptSchema.getField("c"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  FileLocalizer.deleteTempFiles();
  server=new PigServer(Util.getLocalTestMode(),new Properties());
  baseDir=new File("build/testLoLoadDeterminedSchema");
  if (baseDir.exists()) {
    FileUtil.fullyDelete(baseDir);
  }
  assertTrue(baseDir.mkdirs());
  inputFile=new File(baseDir,"testInput.txt");
  inputFile.createNewFile();
  FileWriter writer=new FileWriter(inputFile);
  try {
    writer.write("a\tb\tc");
  }
  finally {
    writer.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLTOrEqual </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(0.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(0));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(0.0f));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(0L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(0.0));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(0L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(0L));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("a"));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(0L));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("a"));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(0.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  LTOrEqualToExpr g=GenPhyOp.compLTOrEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLessThan </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(0.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(0.0));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(0L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(0.0f));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("a"));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(0));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(0.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(0L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(0L));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("a"));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongGt() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(0L));
  LessThanExpr g=GenPhyOp.compLessThanExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLineageFindRelVisitor </h4><pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testhaveIdenticalCasters() throws Exception {
  LogicalPlan lp=new LogicalPlan();
  Class<LineageFindRelVisitor> lineageFindRelVisitorClass=LineageFindRelVisitor.class;
  Method testMethod=lineageFindRelVisitorClass.getDeclaredMethod("haveIdenticalCasters",FuncSpec.class,FuncSpec.class);
  testMethod.setAccessible(true);
  LineageFindRelVisitor lineageFindRelVisitor=new LineageFindRelVisitor(lp);
  FuncSpec defaultSpec=new FuncSpec("PigStorage",new String[0]);
  Assert.assertFalse("null param should always return false",(Boolean)testMethod.invoke(lineageFindRelVisitor,null,null));
  Assert.assertFalse("null param should always return false",(Boolean)testMethod.invoke(lineageFindRelVisitor,null,defaultSpec));
  Assert.assertFalse("null param should always return false",(Boolean)testMethod.invoke(lineageFindRelVisitor,defaultSpec,null));
  Assert.assertTrue("Same loaders are considered equal",(Boolean)testMethod.invoke(lineageFindRelVisitor,defaultSpec,defaultSpec));
  FuncSpec withDefaultCasterSpec=new FuncSpec("org.apache.pig.test.PigStorageWithStatistics",new String[0]);
  Assert.assertTrue("Different Loaders but same LoadCaster with only default constructor. They should be considered same.",(Boolean)testMethod.invoke(lineageFindRelVisitor,defaultSpec,withDefaultCasterSpec));
  FuncSpec casterWithExtraConstuctorSpec=new FuncSpec("org.apache.pig.test.TestLineageFindRelVisitor$SillyLoaderWithLoadCasterWithExtraConstructor",new String[0]);
  FuncSpec casterWithExtraConstuctorSpec2=new FuncSpec("org.apache.pig.test.TestLineageFindRelVisitor$SillyLoaderWithLoadCasterWithExtraConstructor2",new String[0]);
  Assert.assertFalse("Different Loader, different LoadCaster are definitely not equal",(Boolean)testMethod.invoke(lineageFindRelVisitor,defaultSpec,casterWithExtraConstuctorSpec));
  Assert.assertFalse("Even when LoadCaster class matches, we consider them different when they have non-default constructor",(Boolean)testMethod.invoke(lineageFindRelVisitor,casterWithExtraConstuctorSpec,casterWithExtraConstuctorSpec2));
  Assert.assertTrue("Same Loaders should be always equal irrespective of loadcaster constructors",(Boolean)testMethod.invoke(lineageFindRelVisitor,casterWithExtraConstuctorSpec,casterWithExtraConstuctorSpec));
  Assert.assertEquals("Loader should be instantiated at most once.",SillyLoaderWithLoadCasterWithExtraConstructor.counter,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLoadFunc </h4><pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testCommaSeparatedString8() throws Exception {
  Assert.assertEquals(curHdfsRoot + "/user/pig/," + curHdfsRoot+ "/test/data/b",LoadFunc.getAbsolutePath(", /test/data/b",curHdfsDir));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocal2 </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin1() throws Exception {
  File fp1=File.createTempFile("test1","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(fp1));
  ps.println("1\t1");
  ps.println("2\t2");
  ps.close();
  File fp2=File.createTempFile("test2","txt");
  ps=new PrintStream(new FileOutputStream(fp2));
  ps.println("1\t1");
  ps.println("2\t2");
  ps.close();
  pig.registerQuery("A = load '" + Util.generateURI(fp1.toString(),pig.getPigContext()) + "'AS (a0:int, a1:int); ");
  pig.registerQuery("B = load '" + Util.generateURI(fp2.toString(),pig.getPigContext()) + "'AS (b0:int, b1:int); ");
  pig.registerQuery("C = join A by a0, B by b0;");
  Iterator<Tuple> iter=pig.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(Integer.valueOf(1),t.get(0));
  assertEquals(Integer.valueOf(1),t.get(1));
  assertEquals(Integer.valueOf(1),t.get(2));
  assertEquals(Integer.valueOf(1),t.get(3));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(Integer.valueOf(2),t.get(0));
  assertEquals(Integer.valueOf(2),t.get(1));
  assertEquals(Integer.valueOf(2),t.get(2));
  assertEquals(Integer.valueOf(2),t.get(3));
  assertFalse(iter.hasNext());
  fp1.delete();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperatorLocal() throws Exception {
  File fp1=File.createTempFile("opTest","txt");
  PrintStream ps=new PrintStream(new FileOutputStream(fp1));
  ps.println("1\t2");
  ps.close();
  pig.registerQuery("A = load '" + Util.generateURI(fp1.toString(),pig.getPigContext()) + "' AS (c1:int, c2:int); ");
  pig.registerQuery("B = filter A by c1 > 0;");
  pig.registerQuery("C = filter B by c1 < 2;");
  pig.registerQuery("D = filter C by c1 >= 0;");
  pig.registerQuery("E = filter D by c1 <= 2;");
  Iterator<Tuple> iter=pig.openIterator("E");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(Integer.valueOf(1),t.get(0));
  assertEquals(Integer.valueOf(2),t.get(1));
  assertFalse(iter.hasNext());
  fp1.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLocalRearrange </h4><pre class="type-13 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple1() throws ExecException, PlanException {
  setUp1();
  int size=0;
  for (Result res=lr.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=lr.getNextTuple()) {
    Tuple t=(Tuple)res.result;
    String key=(String)t.get(1);
    Tuple val=(Tuple)t.get(2);
    assertEquals(1,val.size());
    Tuple actualVal=new DefaultTuple();
    actualVal.append(key);
    actualVal.append(val.get(0));
    assertEquals((byte)0,(byte)(Byte)t.get(0));
    assertTrue(TestHelper.bagContains(db,actualVal));
    String inpKey=(String)actualVal.get(0);
    assertEquals(0,inpKey.compareTo((String)t.get(1)));
    ++size;
  }
  assertEquals(db.size(),size);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple2() throws ExecException, PlanException {
  setUp2();
  int size=0;
  for (Result res=lr.getNextTuple(); res.returnStatus != POStatus.STATUS_EOP; res=lr.getNextTuple()) {
    Tuple t=(Tuple)res.result;
    Tuple key=(Tuple)t.get(1);
    Tuple val=(Tuple)t.get(2);
    assertEquals(0,val.size());
    assertEquals((byte)0,(byte)(Byte)t.get(0));
    val=key;
    assertTrue(TestHelper.bagContains(db,val));
    Tuple inpKey=TupleFactory.getInstance().newTuple(2);
    inpKey.set(0,val.get(0));
    inpKey.set(1,val.get(1));
    assertEquals(inpKey,(Tuple)t.get(1));
    ++size;
  }
  assertEquals(db.size(),size);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestLogicalPlanBuilder </h4><pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroupByIncompatibleSchemaFailure() throws Exception {
  boolean exceptionThrown=false;
  try {
    String query=" a = load '1.txt' as (a0:int, a1:int);" + " b = load '2.txt' as (a0:int, a1:chararray); " + "c = cogroup a by (a0,a1), b by (a0,a1);"+ "store c into 'output';";
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    String msg="group column no. 2 in relation no. 2 of  group statement" + " has datatype chararray which is incompatible with type of" + " corresponding column in earlier relation(s) in the statement";
    Assert.assertTrue(e.getMessage().contains(msg));
    exceptionThrown=true;
  }
  Assert.assertEquals("An exception was expected but did " + "not occur",true,exceptionThrown);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate that parallel is parsed correctly Bug 831714 - fixed
 */
@Test public void testQuery18() throws Exception {
  String query="store (FOREACH (group (load 'a') ALL PARALLEL 16) generate group ) into 'y';";
  LogicalPlan lp=buildPlan(query);
  Operator root=lp.getSources().get(0);
  List<Operator> listOp=lp.getSuccessors(root);
  Operator lo=listOp.get(0);
  if (lo instanceof LOCogroup) {
    Assert.assertEquals(16,((LOCogroup)lo).getRequestedParallelism());
  }
 else {
    Assert.fail("Error: Unexpected Parse Tree output");
  }
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQuery110Fail() throws Exception {
  String query="a = load 'one' as (name, age, gpa);" + "b = load 'two';" + "c = cogroup a by $0, b by *;";
  try {
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    Assert.assertTrue(e.getMessage().contains("Cogroup/Group by '*' or 'x..' (range of columns to the end) is only allowed " + "if the input has a schema"));
    return;
  }
  Assert.fail("Test case should fail.");
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLogicalPlanData() throws Exception {
  String query="a = load 'input.txt'; b = load 'anotherinput.txt'; c = join a by $0, b by $1;" + "store c into 'output' using org.apache.pig.test.PigStorageWithSchema();";
  pigServer.setBatchOn();
  pigServer.registerQuery(query);
  LogicalPlanData lData=pigServer.getLogicalPlanData();
  assertEquals("LoadFunc must be PigStorage","org.apache.pig.builtin.PigStorage",lData.getLoadFuncs().get(0));
  assertEquals("StoreFunc must be PigStorageWithSchema","org.apache.pig.test.PigStorageWithSchema",lData.getStoreFuncs().get(0));
  assertEquals("Number of sources must be 2",lData.getNumSources(),2);
  assertEquals("Number of sinks must be 1",lData.getNumSinks(),1);
  assertTrue("Source must end with input.txt",lData.getSources().get(0).endsWith("input.txt"));
  assertTrue("Sink must end with output",lData.getSinks().get(0).endsWith("output"));
  assertEquals("Number of logical relational operators must be 4",lData.getNumLogicalRelationOperators(),4);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroupByStarFailure1() throws Exception {
  boolean exceptionThrown=false;
  try {
    String query=" a = load '1.txt' as (a0:int, a1:int);" + " b = load '2.txt'; " + "c = cogroup a by *, b by *;"+ "store c into 'output';";
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    Assert.assertTrue(e.getMessage().contains("Cogroup/Group by '*' or 'x..' (range of columns to the end) is only" + " allowed if the input has a schema"));
    exceptionThrown=true;
  }
  Assert.assertEquals("An exception was expected but did " + "not occur",true,exceptionThrown);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroupByStarFailure2() throws Exception {
  boolean exceptionThrown=false;
  try {
    String query=" a = load '1.txt' ;" + " b = load '2.txt' as (b0:int, b1:int); " + "c = cogroup a by *, b by *;"+ "store c into 'output';";
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    Assert.assertTrue(e.getMessage().contains("Cogroup/Group by '*' or 'x..' (range of columns to the end) is only allowed if the input has a schema"));
    exceptionThrown=true;
  }
  Assert.assertEquals("An exception was expected but did " + "not occur",true,exceptionThrown);
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingSemicolon() throws Exception {
  try {
    String query="A = load '1.txt' \n" + "B = load '2.txt' as (b0:int, b1:int);\n" + "C = union A, B;\n"+ "store C into 'output';";
    buildPlan(query);
  }
 catch (  AssertionFailedError e) {
    Assert.assertTrue(e.getMessage().contains("mismatched input 'B' expecting SEMI_COLON"));
    return;
  }
  Assert.fail("An exception was expected but did not occur");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRCompiler </h4><pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=MRCompilerException.class) public void testMRCompilerErr() throws Exception {
  String query="a = load 'input';" + "b = filter a by $0 > 5;" + "store b into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  pp.remove(pp.getRoots().get(0));
  try {
    Util.buildMRPlan(new PhysicalPlan(),pc);
  }
 catch (  MRCompilerException mrce) {
    assertEquals(2053,mrce.getErrorCode());
    throw mrce;
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUDFInJoin() throws Exception {
  String query="a = load 'input1' using BinStorage();" + "b = load 'input2';" + "c = join a by $0, b by $0;"+ "store c into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  assertEquals(2,mrOper.UDFs.size());
  assertEquals(2,mrOper.UDFs.size());
  assertTrue(mrOper.UDFs.contains("BinStorage"));
  assertTrue(mrOper.UDFs.contains("org.apache.pig.builtin.PigStorage"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLimitAdjusterFuncShipped() throws Exception {
  String query="a = load 'input';" + "b = order a by $0 parallel 2;" + "c = limit b 7;"+ "store c into 'output' using " + PigStorageNoDefCtor.class.getName() + "('\t');";
  PhysicalPlan pp=Util.buildPp(pigServerMR,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  LimitAdjuster la=new LimitAdjuster(mrPlan,pc);
  la.visit();
  la.adjust();
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  int count=1;
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(4,count);
  MapReduceOper op=mrPlan.getLeaves().get(0);
  assertTrue(op.UDFs.contains(new FuncSpec(PigStorageNoDefCtor.class.getName()) + "('\t')"));
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=MRCompilerException.class) public void testMRCompilerErr1() throws Exception {
  PhysicalPlan pp=new PhysicalPlan();
  PhysicalPlan ldFil1=GenPhyOp.loadedFilter();
  pp.merge(ldFil1);
  POSplit op=GenPhyOp.topSplitOp();
  pp.addAsLeaf(op);
  try {
    Util.buildMRPlan(pp,pc);
  }
 catch (  MRCompilerException mrce) {
    assertEquals(2025,mrce.getErrorCode());
    throw mrce;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMRJobStats </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoTaskReportProperty() throws IOException {
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster(MiniGenericCluster.EXECTYPE_MR);
  Properties properties=cluster.getProperties();
  String inputFile="input";
  PrintWriter pw=new PrintWriter(Util.createInputFile(cluster,inputFile));
  pw.println("100\tapple");
  pw.println("200\torange");
  pw.close();
  properties.setProperty(PigConfiguration.PIG_NO_TASK_REPORT,"false");
  PigServer pigServer=new PigServer(cluster.getExecType(),properties);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = load '" + inputFile + "' as (id:int, fruit:chararray);");
  pigServer.registerQuery("store A into 'task_reports';");
  List<ExecJob> jobs=pigServer.executeBatch();
  PigStats pigStats=jobs.get(0).getStatistics();
  MRJobStats jobStats=(MRJobStats)pigStats.getJobGraph().getJobList().get(0);
  long minMapTime=jobStats.getMinMapTime();
  long maxMapTime=jobStats.getMaxMapTime();
  long avgMapTime=jobStats.getAvgMapTime();
  assertTrue("TaskReports are enabled, so minMapTime shouldn't be -1",minMapTime != -1l);
  assertTrue("TaskReports are enabled, so maxMapTime shouldn't be -1",maxMapTime != -1l);
  assertTrue("TaskReports are enabled, so avgMapTime shouldn't be -1",avgMapTime != -1l);
  properties.setProperty(PigConfiguration.PIG_NO_TASK_REPORT,"true");
  pigServer.registerQuery("B = load '" + inputFile + "' as (id:int, fruit:chararray);");
  pigServer.registerQuery("store B into 'no_task_reports';");
  jobs=pigServer.executeBatch();
  pigStats=jobs.get(0).getStatistics();
  jobStats=(MRJobStats)pigStats.getJobGraph().getJobList().get(0);
  minMapTime=jobStats.getMinMapTime();
  maxMapTime=jobStats.getMaxMapTime();
  avgMapTime=jobStats.getAvgMapTime();
  assertEquals("TaskReports are disabled, so minMapTime should be -1",-1l,minMapTime);
  assertEquals("TaskReports are disabled, so maxMapTime should be -1",-1l,maxMapTime);
  assertEquals("TaskReports are disabled, so avgMapTime should be -1",-1l,avgMapTime);
  cluster.shutDown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMapSideCogroup </h4><pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3Way() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("E = LOAD '" + INPUT_FILE3 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1, E by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"(1,{(1,1),(1,2),(1,3)},{(1,1),(1,2),(1,3)},{(1,1),(1,2),(1,3)})","(2,{(2,2),(2,1),(2,3)},{(2,1),(2,2),(2,3)},{(2,1),(2,2),(2,3)})","(3,{(3,2),(3,3),(3,1)},{(3,1),(3,2),(3,3)},{(3,1),(3,2),(3,3)})"};
  assertEquals(3,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 3; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyDeltaFile() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + EMPTY_FILE + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"(1,{(1,1),(1,2),(1,3)},{})","(2,{(2,1),(2,2),(2,3)},{})","(3,{(3,1),(3,2),(3,3)},{})"};
  assertEquals(3,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 3; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimple() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"(1,{(1,1),(1,2),(1,3)},{(1,1),(1,2),(1,3)})","(2,{(2,2),(2,1),(2,3)},{(2,1),(2,2),(2,3)})","(3,{(3,3),(3,2),(3,1)},{(3,1),(3,2),(3,3)})"};
  assertEquals(3,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 3; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiSplits() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + ","+ INPUT_FILE4+ "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE5 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"(4,{(4,1),(4,2),(4,3)},{(4,1),(4,2),(4,3)})","(5,{(5,2),(5,1),(5,3)},{(5,1),(5,2),(5,3)})","(6,{(6,1),(6,2),(6,3)},{})","(7,{(7,1),(7,2),(7,3)},{})","(8,{(8,1),(8,2),(8,3)},{})","(9,{(9,1),(9,2),(9,3)},{})","(1,{(1,1),(1,2),(1,3)},{})","(2,{(2,1),(2,2),(2,3)},{})","(3,{(3,3),(3,2),(3,1)},{(3,1),(3,2),(3,3)})"};
  assertEquals(9,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 9; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompilation(){
  try {
    PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
    String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "D = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = cogroup A by id, B by id, D by id using 'merge';"+ "store C into 'output';";
    LogicalPlan lp=Util.buildLp(pigServer,query);
    Operator op=lp.getSinks().get(0);
    LOCogroup cogrp=(LOCogroup)lp.getPredecessors(op).get(0);
    assertEquals(LOCogroup.GROUPTYPE.MERGE,cogrp.getGroupType());
    PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
    pc.connect();
    PhysicalPlan phyP=Util.buildPp(pigServer,query);
    PhysicalOperator phyOp=phyP.getLeaves().get(0);
    assertTrue(phyOp instanceof POStore);
    phyOp=phyOp.getInputs().get(0);
    assertTrue(phyOp instanceof POMergeCogroup);
    MROperPlan mrPlan=Util.buildMRPlan(phyP,pc);
    assertEquals(2,mrPlan.size());
    Iterator<MapReduceOper> itr=mrPlan.iterator();
    List<MapReduceOper> opers=new ArrayList<MapReduceOper>();
    opers.add(itr.next());
    opers.add(itr.next());
    Collections.sort(opers);
    assertTrue(opers.get(0).reducePlan.isEmpty());
    assertFalse(opers.get(0).mapPlan.isEmpty());
    assertFalse(opers.get(1).reducePlan.isEmpty());
    assertFalse(opers.get(1).mapPlan.isEmpty());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Compilation of merged cogroup failed.");
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataWithNullKeys() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + DATA_WITH_NULL_KEYS + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  pigServer.registerQuery("B = LOAD '" + DATA_WITH_NULL_KEYS + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:int);");
  String[] results=new String[]{"(,{(,1),(,2),(,3)},{})","(,{},{(,1),(,2),(,3)})","(2,{(2,3),(2,1),(2,2)},{(2,1),(2,2),(2,3)})","(3,{(3,3),(3,1),(3,2)},{(3,1),(3,2),(3,3)})"};
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by c1, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  assertEquals(4,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 4; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogrpOnMultiKeys() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray,c2:chararray);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray,c2:chararray);");
  DataBag dbMergeCogrp=BagFactory.getInstance().newDefaultBag();
  pigServer.registerQuery("C = cogroup A by (c1,c2) , B by (c1,c2) using 'merge' ;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  while (iter.hasNext()) {
    Tuple t=iter.next();
    dbMergeCogrp.add(t);
  }
  String[] results=new String[]{"((1,1),{(1,1)},{(1,1)})","((1,2),{(1,2)},{(1,2)})","((1,3),{(1,3)},{(1,3)})","((2,1),{(2,1)},{(2,1)})","((2,2),{(2,2)},{(2,2)})","((2,3),{(2,3)},{(2,3)})","((3,1),{(3,1)},{(3,1)})","((3,2),{(3,2)},{(3,2)})","((3,3),{(3,3)},{(3,3)})"};
  assertEquals(9,dbMergeCogrp.size());
  Iterator<Tuple> itr=dbMergeCogrp.iterator();
  for (int i=0; i < 9; i++) {
    assertEquals(itr.next().toString(),results[i]);
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailure2() throws Exception {
  PigServer pigServer=new PigServer(cluster.getExecType(),cluster.getProperties());
  String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "D = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = cogroup A by id inner, B by id, D by id inner using 'merge';"+ "store C into 'output';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  Operator op=lp.getSinks().get(0);
  LOCogroup cogrp=(LOCogroup)lp.getPredecessors(op).get(0);
  assertEquals(LOCogroup.GROUPTYPE.MERGE,cogrp.getGroupType());
  PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
  pc.connect();
  boolean exceptionCaught=false;
  try {
    Util.buildPp(pigServer,query);
  }
 catch (  FrontendException e) {
    exceptionCaught=true;
  }
  assertTrue(exceptionCaught);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMergeForEachOptimization </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * One output of first foreach was referred more than once in the second foreach
 * @throws Exception 
 */
@Test public void testDuplicateInputs() throws Exception {
  String query="A = load 'file.txt' as (a0:int, a1:double);" + "A1 = foreach A generate (int)a0 as a0, (double)a1 as a1;" + "B = group A1 all;"+ "C = foreach B generate A1;"+ "D = foreach C generate SUM(A1.a0), AVG(A1.a1);"+ "store D into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  Operator store=newLogicalPlan.getSinks().get(0);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  LOForEach foreach1=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  Assert.assertTrue(foreach1.getAlias().equals("D"));
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(1,forEachCount1 - forEachCount2);
  LOForEach foreach2=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  Assert.assertTrue(foreach2.getAlias().equals("D"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test more complex case where the first for each in the script has inner plan.
 * @throws Exception 
 */
@Test public void testComplex() throws Exception {
  String query="A = load 'file.txt' as (a:int, b, c:bag{t:tuple(c0:int,c1:int)});" + "B = foreach A { S = ORDER c BY $0; generate $0, COUNT(S), SIZE(S); };" + "C = foreach B generate $2+5 as x, $0-$1/2 as y;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  int outputExprCount1=getOutputExprCount(newLogicalPlan);
  LOForEach foreach1=getForEachOperator(newLogicalPlan);
  Assert.assertTrue(foreach1.getAlias().equals("C"));
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(0,forEachCount1 - forEachCount2);
  int outputExprCount2=getOutputExprCount(newLogicalPlan);
  Assert.assertTrue(outputExprCount1 == outputExprCount2);
  LOForEach foreach2=getForEachOperator(newLogicalPlan);
  Assert.assertTrue(foreach2.getAlias().equals("C"));
  LogicalSchema newSchema=foreach2.getSchema();
  Assert.assertTrue(newSchema.getField(0).alias.equals("x"));
  Assert.assertTrue(newSchema.getField(1).alias.equals("y"));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Basic test case. Two simple FOREACH statements can be merged to one.
 * @throws Exception 
 */
@Test public void testSimple() throws Exception {
  String query="A = load 'file.txt' as (a, b, c);" + "B = foreach A generate a+b, c-b;" + "C = foreach B generate $0+5, $1;"+ "store C into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  int outputExprCount1=getOutputExprCount(newLogicalPlan);
  LOForEach foreach1=getForEachOperator(newLogicalPlan);
  Assert.assertTrue(foreach1.getAlias().equals("C"));
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(1,forEachCount1 - forEachCount2);
  int outputExprCount2=getOutputExprCount(newLogicalPlan);
  Assert.assertTrue(outputExprCount1 == outputExprCount2);
  LOForEach foreach2=getForEachOperator(newLogicalPlan);
  Assert.assertTrue(foreach2.getAlias().equals("C"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that join input order does not get reversed (PIG-1672)
 * @throws Exception 
 */
@Test public void testJoinInputOrder() throws Exception {
  String query="l1 = load 'y' as (a);" + "l2 = load 'z' as (a1,b1,c1,d1);" + "f1 = foreach l2 generate a1, b1, c1, d1;"+ "f2 = foreach f1 generate a1, b1, c1;"+ "j1 = join f2 by a1, l1 by a using 'replicated';"+ "store j1 into 'empty';";
  LogicalPlan newLogicalPlan=Util.buildLp(pigServer,query);
  int forEachCount1=getForEachOperatorCount(newLogicalPlan);
  List<Operator> loads=newLogicalPlan.getSources();
  Operator l2=null;
  for (  Operator load : loads) {
    if (((LogicalRelationalOperator)load).getAlias().equals("l2"))     l2=load;
  }
  LOForEach foreachL2=(LOForEach)newLogicalPlan.getSuccessors(l2).get(0);
  foreachL2=(LOForEach)newLogicalPlan.getSuccessors(foreachL2).get(0);
  int outputExprCount1=((LOGenerate)foreachL2.getInnerPlan().getSinks().get(0)).getOutputPlans().size();
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  int forEachCount2=getForEachOperatorCount(newLogicalPlan);
  Assert.assertEquals(1,forEachCount1 - forEachCount2);
  loads=newLogicalPlan.getSources();
  l2=null;
  for (  Operator load : loads) {
    if (((LogicalRelationalOperator)load).getAlias().equals("l2"))     l2=load;
  }
  foreachL2=(LOForEach)newLogicalPlan.getSuccessors(l2).get(0);
  int outputExprCount2=((LOGenerate)foreachL2.getInnerPlan().getSinks().get(0)).getOutputPlans().size();
  Assert.assertTrue(outputExprCount1 == outputExprCount2);
  Assert.assertTrue(foreachL2.getAlias().equals("f2"));
  LOJoin join=(LOJoin)getOperator(newLogicalPlan,LOJoin.class);
  LogicalRelationalOperator leftInp=(LogicalRelationalOperator)newLogicalPlan.getPredecessors(join).get(0);
  assertEquals("join child left",leftInp.getAlias(),"f2");
  LogicalRelationalOperator rightInp=(LogicalRelationalOperator)newLogicalPlan.getPredecessors(join).get(1);
  assertEquals("join child right",rightInp.getAlias(),"l1");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMergeJoin </h4><pre class="type-7 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoinFailure2() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, n);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name);");
  pigServer.registerQuery("C = GROUP B by id;");
  pigServer.registerQuery("D = join A by id, C by $0 using 'merge';");
  try {
    pigServer.openIterator("D");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertEquals(1103,pe.getErrorCode());
    return;
  }
  Assert.fail("Should fail to compile");
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMergeJoin3Way() throws IOException {
  try {
    pigServer.registerQuery("A = LOAD '" + INPUT_FILE + "' as (id, name, n);");
    pigServer.registerQuery("B = LOAD '" + INPUT_FILE + "' as (id, name);");
    pigServer.registerQuery("C = LOAD '" + INPUT_FILE + "' as (id, name);");
    pigServer.registerQuery("D = join A by id, B by id, C by id using 'merge';");
  }
 catch (  Exception e) {
    PigException pe=LogUtils.getPigException(e);
    Assert.assertTrue(pe.getMessage().contains("Merge join can only be applied for 2-way joins"));
    return;
  }
  Assert.fail("Should throw exception, do not support 3 way join");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMergeJoinOuter </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFullOuter() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray, c2:chararray);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray, c2:chararray);");
  pigServer.registerQuery("C = join A by c1 full, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  String[] results={"(1,1,,)","(1,2,,)","(1,3,,)","(2,2,2,2)","(2,2,2,3)","(2,1,2,2)","(2,1,2,3)","(2,3,2,2)","(2,3,2,3)","(3,3,3,1)","(3,1,3,1)","(3,2,3,1)","(,,4,1)","(,,4,3)"};
  for (  String result : results)   assertEquals(result,iter.next().toString());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRightOuter() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray, c2:chararray);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray, c2:chararray);");
  pigServer.registerQuery("C = join A by c1 right, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  String[] results={"(2,2,2,2)","(2,2,2,3)","(2,1,2,2)","(2,1,2,3)","(2,3,2,2)","(2,3,2,3)","(3,3,3,1)","(3,1,3,1)","(3,2,3,1)","(,,4,1)","(,,4,3)"};
  for (  String result : results)   assertEquals(result,iter.next().toString());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLeftOuter() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE1 + "' using "+ DummyCollectableLoader.class.getName()+ "() as (c1:chararray, c2:chararray);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE2 + "' using "+ DummyIndexableLoader.class.getName()+ "() as (c1:chararray, c2:chararray);");
  pigServer.registerQuery("C = join A by c1 left, B by c1 using 'merge';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  String[] results={"(1,1,,)","(1,2,,)","(1,3,,)","(2,2,2,2)","(2,2,2,3)","(2,1,2,2)","(2,1,2,3)","(2,3,2,2)","(2,3,2,3)","(3,3,3,1)","(3,1,3,1)","(3,2,3,1)"};
  for (  String result : results)   assertEquals(result,iter.next().toString());
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompilation(){
  try {
    String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = join A by id left, B by id using 'merge';"+ "store C into 'out';";
    LogicalPlan lp=Util.buildLp(pigServer,query);
    LOStore store=(LOStore)lp.getSinks().get(0);
    LOJoin join=(LOJoin)lp.getPredecessors(store).get(0);
    assertEquals(LOJoin.JOINTYPE.MERGE,join.getJoinType());
    PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
    pc.connect();
    PhysicalPlan phyP=Util.buildPp(pigServer,query);
    PhysicalOperator phyOp=phyP.getLeaves().get(0);
    assertTrue(phyOp instanceof POStore);
    phyOp=phyOp.getInputs().get(0);
    assertTrue(phyOp instanceof POForEach);
    assertEquals(1,phyOp.getInputs().size());
    assertTrue(phyOp.getInputs().get(0) instanceof POMergeCogroup);
    MROperPlan mrPlan=Util.buildMRPlan(phyP,pc);
    assertEquals(2,mrPlan.size());
    Iterator<MapReduceOper> itr=mrPlan.iterator();
    List<MapReduceOper> opers=new ArrayList<MapReduceOper>();
    opers.add(itr.next());
    opers.add(itr.next());
    Collections.sort(opers);
    assertTrue(opers.get(0).reducePlan.isEmpty());
    assertFalse(opers.get(0).mapPlan.isEmpty());
    assertFalse(opers.get(1).reducePlan.isEmpty());
    assertFalse(opers.get(1).mapPlan.isEmpty());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Compilation of merged cogroup failed.");
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailure() throws Exception {
  String query="A = LOAD 'data1' using " + DummyCollectableLoader.class.getName() + "() as (id, name, grade);"+ "E = group A by id;"+ "B = LOAD 'data2' using "+ DummyIndexableLoader.class.getName()+ "() as (id, name, grade);"+ "C = join E by A.id, B by id using 'merge';"+ "store C into 'output';";
  LogicalPlan lp=Util.buildLp(pigServer,query);
  Operator op=lp.getSinks().get(0);
  LOJoin join=(LOJoin)lp.getPredecessors(op).get(0);
  assertEquals(LOJoin.JOINTYPE.MERGE,join.getJoinType());
  PigContext pc=new PigContext(ExecType.MAPREDUCE,cluster.getProperties());
  pc.connect();
  boolean exceptionCaught=false;
  try {
    Util.buildPp(pigServer,query);
  }
 catch (  FrontendException e) {
    assertEquals(1103,e.getErrorCode());
    exceptionCaught=true;
  }
  assertTrue(exceptionCaught);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMod </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Mod operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertEquals(POStatus.STATUS_ERR,resd.returnStatus);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertEquals(POStatus.STATUS_ERR,resf.returnStatus);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 % inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 % inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryBasic </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that MultiQuery optimization won't use user's output for
 * ScalarExpression (and get empty output) at the end
 */
@Test public void testMultiQueryWithScalarExpression() throws Exception {
  System.out.println("===== multi-query with ScalarExpression =====");
  String[] inputData={"john","henry","adam"};
  Util.createLocalInputFile("queryInput.txt",inputData);
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'queryInput.txt' using PigStorage() as (uname:chararray);");
  myPig.registerQuery("b = group a ALL;");
  myPig.registerQuery("c = foreach b generate COUNT(a) as count;");
  myPig.registerQuery("store c into 'output1';");
  myPig.registerQuery("z = load 'queryInput.txt' using PigStorage() as (uname:chararray);");
  myPig.registerQuery("y = foreach z generate uname, c.count;");
  myPig.registerQuery("store y into 'output2';");
  List<ExecJob> jobs=myPig.executeBatch();
  for (  ExecJob job : jobs) {
    assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
  }
  myPig.registerQuery("aa = load 'output2' as (uname:chararray, cnt:int) ;");
  Iterator<Tuple> it=myPig.openIterator("aa");
  int i=0;
  while (it.hasNext()) {
    Tuple t=it.next();
    i++;
    assertEquals(3,t.get(1));
  }
  assertEquals(3,i);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryWithFJ_2() throws Exception {
  System.out.println("===== multi-query with FJ (2) =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
  myPig.registerQuery("b = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
  myPig.registerQuery("c = filter a by uid > 5;");
  myPig.registerQuery("store c into 'output1';");
  myPig.registerQuery("d = filter b by gid > 10;");
  myPig.registerQuery("store d into 'output2';");
  myPig.registerQuery("e = join c by gid, d by gid using \'repl\';");
  myPig.registerQuery("store e into 'output3';");
  List<ExecJob> jobs=myPig.executeBatch();
  assertEquals(3,jobs.size());
  for (  ExecJob job : jobs) {
    assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryPhase3WithDifferentMapDataTypes2() throws Exception {
  System.out.println("===== multi-query phase 3 with different map datatypes (2) =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
  myPig.registerQuery("b = filter a by uid < 5;");
  myPig.registerQuery("c = filter a by uid >= 5 and uid < 10;");
  myPig.registerQuery("d = filter a by uid >= 10;");
  myPig.registerQuery("b1 = group b by gid;");
  myPig.registerQuery("b2 = foreach b1 generate group, COUNT(b.uid);");
  myPig.registerQuery("b3 = filter b2 by $1 > 5;");
  myPig.registerQuery("store b3 into 'output1';");
  myPig.registerQuery("c1 = group c by $1;");
  myPig.registerQuery("c2 = foreach c1 generate group, SUM(c.uid);");
  myPig.registerQuery("store c2 into 'output2';");
  myPig.registerQuery("d1 = group d by $1;");
  myPig.registerQuery("d2 = foreach d1 generate group, COUNT(d.uid);");
  myPig.registerQuery("store d2 into 'output3';");
  List<ExecJob> jobs=myPig.executeBatch();
  assertEquals(3,jobs.size());
  for (  ExecJob job : jobs) {
    assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryPhase3StreamingInReducer2() throws Exception {
  System.out.println("===== multi-query phase 3 with streaming in reducer (2) =====");
  myPig.setBatchOn();
  myPig.registerQuery("A = load 'passwd';");
  myPig.registerQuery("Split A into A1 if $2 > 5, A2 if $2 >= 5;");
  myPig.registerQuery("Split A1 into A3 if $0 > 'm', A4 if $0 >= 'm';");
  myPig.registerQuery("B = group A3 by $2;");
  myPig.registerQuery("C = foreach B generate flatten(A3);");
  myPig.registerQuery("D = stream B through `cat`;");
  myPig.registerQuery("store D into 'output1';");
  myPig.registerQuery("E = group A4 by $2;");
  myPig.registerQuery("F = foreach E generate group, COUNT(A4);");
  myPig.registerQuery("store F into 'output2';");
  myPig.registerQuery("G = group A1 by $2;");
  myPig.registerQuery("H = foreach G generate group, COUNT(A1);");
  myPig.registerQuery("store H into 'output3';");
  List<ExecJob> jobs=myPig.executeBatch();
  assertEquals(3,jobs.size());
  for (  ExecJob job : jobs) {
    assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryPhase3WithMixedCombiner2() throws Exception {
  System.out.println("===== multi-query phase 3 with mixed combiner (2) =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
  myPig.registerQuery("b = filter a by uid < 5;");
  myPig.registerQuery("c = filter a by uid >= 5 and uid < 10;");
  myPig.registerQuery("d = filter a by uid >= 10;");
  myPig.registerQuery("b1 = group b by gid;");
  myPig.registerQuery("b2 = foreach b1 generate group, COUNT(b.uid);");
  myPig.registerQuery("b3 = filter b2 by $1 > 5;");
  myPig.registerQuery("store b3 into 'output1';");
  myPig.registerQuery("c1 = group c by gid;");
  myPig.registerQuery("c2 = foreach c1 generate group, SUM(c.uid);");
  myPig.registerQuery("store c2 into 'output2';");
  myPig.registerQuery("d1 = group d by gid;");
  myPig.registerQuery("d2 = foreach d1 generate group, MAX(d.uid) - MIN(d.uid);");
  myPig.registerQuery("store d2 into 'output3';");
  List<ExecJob> jobs=myPig.executeBatch();
  assertEquals(3,jobs.size());
  for (  ExecJob job : jobs) {
    assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryWithPigMixL12_2() throws Exception {
  System.out.println("===== multi-query with PigMix L12 (2) =====");
  myPig.setBatchOn();
  myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname, passwd, uid, gid);");
  myPig.registerQuery("b = foreach a generate uname, passwd, uid, gid;");
  myPig.registerQuery("split b into c1 if uid > 5, c2 if uid <= 5 ;");
  myPig.registerQuery("split c1 into d1 if gid < 5, d2 if gid >= 5;");
  myPig.registerQuery("e = group d1 by uname;");
  myPig.registerQuery("e1 = foreach e generate group, MAX(d1.uid);");
  myPig.registerQuery("store e1 into 'output1';");
  myPig.registerQuery("f = group c2 by uname;");
  myPig.registerQuery("f1 = foreach f generate group, SUM(c2.gid);");
  myPig.registerQuery("store f1 into 'output2';");
  myPig.registerQuery("g = group d2 by uname;");
  myPig.registerQuery("g1 = foreach g generate group, COUNT(d2);");
  myPig.registerQuery("store g1 into 'output3';");
  List<ExecJob> jobs=myPig.executeBatch();
  assertEquals(3,jobs.size());
  for (  ExecJob job : jobs) {
    assertTrue(job.getStatus() == ExecJob.JOB_STATUS.COMPLETED);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryPhase3WithDifferentMapDataTypes3() throws Exception {
  System.out.println("===== multi-query phase 3 with different map datatypes (3) =====");
  myPig.setBatchOn();
  String[] inputData={"john\t20\t3.4","john\t25\t3.4","henry\t23\t3.9","adam\t54\t2.9","henry\t21\t3.9"};
  Util.createLocalInputFile("queryInput.txt",inputData);
  myPig.registerQuery("a = load 'queryInput.txt' " + "as (name:chararray, age:int, gpa:double);");
  myPig.registerQuery("b = group a all;");
  myPig.registerQuery("c = foreach b generate group, COUNT(a);");
  myPig.registerQuery("store c into 'output1';");
  myPig.registerQuery("d = group a by (name, gpa);");
  myPig.registerQuery("e = foreach d generate flatten(group), MIN(a.age);");
  myPig.registerQuery("store e into 'output2';");
  myPig.executeBatch();
  myPig.registerQuery("a = load 'output1' as (grp:chararray, cnt:long) ;");
  Iterator<Tuple> it=myPig.openIterator("a");
  assertEquals(Util.getPigConstant("('all', 5l)"),it.next());
  assertFalse(it.hasNext());
  myPig.registerQuery("a = load 'output2' as (name:chararray, gpa:double, age:int);");
  it=myPig.openIterator("a");
  int i=0;
  Map<String,Tuple> expectedResults=new HashMap<String,Tuple>();
  expectedResults.put("john",(Tuple)Util.getPigConstant("('john',3.4,20)"));
  expectedResults.put("adam",(Tuple)Util.getPigConstant("('adam',2.9,54)"));
  expectedResults.put("henry",(Tuple)Util.getPigConstant("('henry',3.9,21)"));
  while (it.hasNext()) {
    Tuple t=it.next();
    i++;
    assertEquals(expectedResults.get(t.get(0)),t);
  }
  assertEquals(3,i);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiQueryCompiler </h4><pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryWithCustomPartitioner(){
  System.out.println("===== multi-query with intermediate stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("l = FILTER a BY uname == 'foo';");
    myPig.registerQuery("b = GROUP a BY uname PARTITION BY " + SimpleCustomPartitioner.class.getName() + " PARALLEL 3;");
    myPig.registerQuery("c = FOREACH b GENERATE FLATTEN(a) PARALLEL 3;");
    myPig.registerQuery("STORE c INTO 'output1';");
    myPig.registerQuery("STORE l INTO 'output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,9);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,12);
    MROperPlan mrp=checkMRPlan(pp,1,1,2);
    MapReduceOper mrop=mrp.getLeaves().get(0);
    Assert.assertTrue(mrop.getCustomPartitioner().equals(SimpleCustomPartitioner.class.getName()));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiQueryDoNotMergeMRwithDifferentPartitioners(){
  System.out.println("===== multi-query with intermediate stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int, gid:int);");
    myPig.registerQuery("b1 = FILTER a BY gid != 0;");
    myPig.registerQuery("b2 = FILTER a BY uid > 100;");
    myPig.registerQuery("c1 = GROUP b1 BY uname PARTITION BY " + SimpleCustomPartitioner.class.getName() + " PARALLEL 3;");
    myPig.registerQuery("c2 = GROUP b2 BY uname PARALLEL 3;");
    myPig.registerQuery("STORE c1 INTO 'output1';");
    myPig.registerQuery("STORE c2 INTO 'output2';");
    LogicalPlan lp=checkLogicalPlan(1,2,10);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,15);
    MROperPlan mrp=checkMRPlan(pp,1,1,2);
    MapReduceOper mrop;
    mrop=mrp.getRoots().get(0);
    Assert.assertTrue(mrop.getCustomPartitioner() == null);
    mrop=mrp.getLeaves().get(0);
    Assert.assertTrue(mrop.getCustomPartitioner().equals(SimpleCustomPartitioner.class.getName()));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnnecessaryStoreRemovalCollapseSplit(){
  System.out.println("===== multi-query unnecessary stores collapse split =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = group a by uname;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("c = load '/tmp/output1';");
    myPig.registerQuery("d = group c by $0;");
    myPig.registerQuery("e = store d into '/tmp/output2';");
    LogicalPlan lp=checkLogicalPlan(1,1,6);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,1,11);
    MROperPlan mp=checkMRPlan(pp,1,1,2);
    MapReduceOper mo1=mp.getRoots().get(0);
    MapReduceOper mo2=mp.getLeaves().get(0);
    checkPhysicalPlan(mo1.mapPlan,1,1,3);
    checkPhysicalPlan(mo1.reducePlan,1,1,2);
    PhysicalOperator leaf=mo1.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    checkPhysicalPlan(mo2.mapPlan,1,1,2);
    checkPhysicalPlan(mo2.reducePlan,1,1,2);
    leaf=mo2.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnnecessaryStoreRemoval(){
  System.out.println("===== multi-query unnecessary stores =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = group a by uname;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("store b into '/tmp/output2';");
    myPig.registerQuery("c = load '/tmp/output1';");
    myPig.registerQuery("d = group c by $0;");
    myPig.registerQuery("e = store d into '/tmp/output3';");
    myPig.registerQuery("f = load '/tmp/output2';");
    myPig.registerQuery("g = group f by $0;");
    myPig.registerQuery("store g into '/tmp/output4';");
    LogicalPlan lp=checkLogicalPlan(1,2,13);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,2,20);
    MROperPlan mp=checkMRPlan(pp,1,2,3);
    MapReduceOper mo1=mp.getRoots().get(0);
    MapReduceOper mo2=mp.getLeaves().get(0);
    MapReduceOper mo3=mp.getLeaves().get(1);
    checkPhysicalPlan(mo1.mapPlan,1,1,3);
    checkPhysicalPlan(mo1.reducePlan,1,1,2);
    PhysicalOperator leaf=mo1.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POSplit);
    POSplit split=(POSplit)leaf;
    int i=0;
    for (    PhysicalPlan p : split.getPlans()) {
      checkPhysicalPlan(p,1,1,1);
      ++i;
    }
    Assert.assertEquals(i,2);
    checkPhysicalPlan(mo2.mapPlan,1,1,2);
    checkPhysicalPlan(mo2.reducePlan,1,1,2);
    leaf=mo2.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    checkPhysicalPlan(mo3.mapPlan,1,1,2);
    checkPhysicalPlan(mo3.reducePlan,1,1,2);
    leaf=mo3.reducePlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POStore);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output3"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output4"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFilterRemoval(){
  System.out.println("===== multi-query empty filters =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd' " + "using PigStorage(':') as (uname:chararray, passwd:chararray, uid:int,gid:int);");
    myPig.registerQuery("b = filter a by uid>0;");
    myPig.registerQuery("c = filter a by uid>5;");
    myPig.registerQuery("d = filter c by uid<10;");
    myPig.registerQuery("store b into '/tmp/output1';");
    myPig.registerQuery("store b into '/tmp/output2';");
    myPig.registerQuery("store b into '/tmp/output3';");
    LogicalPlan lp=checkLogicalPlan(1,3,9);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,10);
    MROperPlan mp=checkMRPlan(pp,1,1,1);
    MapReduceOper mo=mp.getRoots().get(0);
    checkPhysicalPlan(mo.mapPlan,1,1,4);
    PhysicalOperator leaf=mo.mapPlan.getLeaves().get(0);
    Assert.assertTrue(leaf instanceof POSplit);
    POSplit split=(POSplit)leaf;
    int i=0;
    for (    PhysicalPlan p : split.getPlans()) {
      checkPhysicalPlan(p,1,1,1);
      ++i;
    }
    Assert.assertEquals(i,3);
    myPig.executeBatch();
    myPig.discardBatch();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreOrder(){
  System.out.println("===== multi-query store order =====");
  try {
    myPig.setBatchOn();
    myPig.registerQuery("a = load 'passwd';");
    myPig.registerQuery("store a into '/tmp/output1' using BinStorage();");
    myPig.registerQuery("a = load '/tmp/output1';");
    myPig.registerQuery("store a into '/tmp/output2';");
    myPig.registerQuery("a = load '/tmp/output1';");
    myPig.registerQuery("store a into '/tmp/output3';");
    myPig.registerQuery("a = load '/tmp/output2' using BinStorage();");
    myPig.registerQuery("store a into '/tmp/output4';");
    myPig.registerQuery("a = load '/tmp/output2';");
    myPig.registerQuery("b = load '/tmp/output1';");
    myPig.registerQuery("c = cogroup a by $0, b by $0;");
    myPig.registerQuery("store c into '/tmp/output5';");
    LogicalPlan lp=checkLogicalPlan(1,3,12);
    PhysicalPlan pp=checkPhysicalPlan(lp,1,3,15);
    MROperPlan mp=checkMRPlan(pp,1,3,5);
    myPig.executeBatch();
    myPig.discardBatch();
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output1"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output2"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output3"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output4"));
    Assert.assertTrue(myPig.getPigContext().getDfs().isContainer("/tmp/output5"));
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestMultiply </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Multiply operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 * inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 * inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 * inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 * inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
{
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resb=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
}
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNativeMapReduce </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNativeMRJobSimple() throws Exception {
  try {
    Collection<String> results=new HashSet<String>();
    results.add("(two,2)");
    results.add("(three,3)");
    pigServer.setBatchOn();
    pigServer.registerQuery("A = load '" + INPUT_FILE + "';");
    pigServer.registerQuery("B = mapreduce '" + jarFileName + "' "+ "Store A into 'table_testNativeMRJobSimple_input' "+ "Load 'table_testNativeMRJobSimple_output' "+ "`org.apache.pig.test.utils.WordCount "+ " -Dmapred.child.java.opts='-Xmx1536m -Xms128m' "+ " -files "+ STOPWORD_FILE+ " table_testNativeMRJobSimple_input table_testNativeMRJobSimple_output "+ STOPWORD_FILE+ "`;");
    pigServer.registerQuery("Store B into 'table_testNativeMRJobSimpleDir';");
    List<ExecJob> execJobs=pigServer.executeBatch();
    assertEquals("num of jobs",execJobs.size(),1);
    boolean foundNativeFeature=false;
    for (    ExecJob job : execJobs) {
      assertEquals("job status",job.getStatus(),JOB_STATUS.COMPLETED);
      if (job.getStatistics().getFeatures().contains("NATIVE")) {
        foundNativeFeature=true;
      }
    }
    assertTrue("foundNativeFeature",foundNativeFeature);
    pigServer.registerQuery("C = load 'table_testNativeMRJobSimpleDir';");
    Iterator<Tuple> iter=pigServer.openIterator("C");
    Tuple t;
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertFalse(iter.hasNext());
    iter=pigServer.openIterator("B");
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertTrue("iter.hasNext()",iter.hasNext());
    t=iter.next();
    assertTrue(exp_msg_prefix + t,results.contains(t.toString()));
    assertFalse(iter.hasNext());
  }
  finally {
    Util.deleteFile(cluster,"table_testNativeMRJobSimple_input");
    Util.deleteFile(cluster,"table_testNativeMRJobSimple_output");
    Util.deleteFile(cluster,"table_testNativeMRJobSimpleDir");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPartitionFilterPushDown </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test PIG-1267
 * @throws Exception
 */
@Test public void testColNameMapping5() throws Exception {
  TestLoader.partFilter=null;
  String q="a = load 'foo' using " + TestLoader.class.getName() + "('mrkt:chararray, a1:chararray, a2:chararray, srcid:int, bcookie:chararray', "+ "'srcid');"+ "b = load 'bar' using "+ TestLoader.class.getName()+ "('dstid:int, b1:int, b2:int, srcid:int, bcookie:chararray, mrkt:chararray',"+ "'srcid');"+ "a1 = filter a by srcid == 10;"+ "b1 = filter b by srcid == 20;"+ "c = join a1 by bcookie, b1 by bcookie;"+ "d = foreach c generate $4 as bcookie:chararray, "+ "$5 as dstid:int, $0 as mrkt:chararray;"+ "store d into 'out';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(q);
  String partFilter=TestLoader.partFilter.toString();
  Assert.assertTrue("(srcid == 20)".equals(partFilter) || "(srcid == 10)".equals(partFilter));
  int counter=0;
  Iterator<Operator> iter=newLogicalPlan.getOperators();
  while (iter.hasNext()) {
    Assert.assertTrue(!(iter.next() instanceof LOFilter));
    counter++;
  }
  Assert.assertEquals(counter,5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanColumnPrune </h4><pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testPruneWithMapKey() throws Exception {
  String query="a =load 'd.txt' as (id, v1, m:map[]);" + "b = foreach a generate id, m#'path';" + "store b into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  PlanOptimizer optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, m:map[]);" + "b = foreach a generate id, m#'path';" + "store b into 'empty';";
  LogicalPlan expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  LOLoad op=(LOLoad)newLogicalPlan.getSources().get(0);
  Map<Integer,Set<String>> annotation=(Map<Integer,Set<String>>)op.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertEquals(1,annotation.size());
  Set<String> s=new HashSet<String>();
  s.add("path");
  assertEquals(annotation.get(2),s);
  query="a =load 'd.txt' as (id, v1, m:map[]);" + "b = load 'd.txt' as (id, v1, m:map[]);" + "c = join a by id, b by id;"+ "d = filter c by a::m#'path' != NULL;"+ "e = foreach d generate a::id, b::id, b::m#'path', a::m;"+ "store e into 'empty';";
  newLogicalPlan=buildPlan(query);
  optimizer=new MyPlanOptimizer(newLogicalPlan,3);
  optimizer.optimize();
  query="a =load 'd.txt' as (id, m:map[]);" + "b = load 'd.txt' as (id, m:map[]);" + "c = join a by id, b by id;"+ "d = filter c by a::m#'path' != NULL;"+ "e = foreach d generate a::id, b::id, b::m#'path', a::m;"+ "store e into 'empty';";
  expected=buildPlan(query);
  assertTrue(expected.isEqual(newLogicalPlan));
  List<Operator> ll=newLogicalPlan.getSources();
  assertEquals(2,ll.size());
  LOLoad loada=null;
  LOLoad loadb=null;
  for (  Operator opp : ll) {
    if (((LogicalRelationalOperator)opp).getAlias().equals("a")) {
      loada=(LOLoad)opp;
      continue;
    }
    if (((LogicalRelationalOperator)opp).getAlias().equals("b")) {
      loadb=(LOLoad)opp;
      continue;
    }
  }
  annotation=(Map<Integer,Set<String>>)loada.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertNull(annotation);
  annotation=(Map<Integer,Set<String>>)loadb.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertEquals(1,annotation.size());
  s=new HashSet<String>();
  s.add("path");
  assertEquals(annotation.get(2),s);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanFilterRule </h4><pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterRuleWith2And() throws Exception {
  prep();
  LogicalExpressionPlan p5=new LogicalExpressionPlan();
  LogicalExpression lp3=new ProjectExpression(p5,0,2,filter);
  LogicalExpression cont=new ConstantExpression(p5,new Integer(3));
  p5.add(lp3);
  p5.add(cont);
  LogicalExpression eq=new EqualExpression(p5,lp3,cont);
  LogicalExpression lp4=new ProjectExpression(p5,0,3,filter);
  LogicalExpression cont2=new ConstantExpression(p5,new Integer(3));
  p5.add(lp4);
  p5.add(cont2);
  LogicalExpression eq2=new EqualExpression(p5,lp4,cont2);
  LogicalExpression and1=new AndExpression(p5,eq,eq2);
  lp3=new ProjectExpression(p5,0,0,filter);
  lp4=new ProjectExpression(p5,0,3,filter);
  p5.add(lp3);
  p5.add(lp4);
  eq2=new EqualExpression(p5,lp3,lp4);
  LogicalExpression and2=new AndExpression(p5,and1,eq2);
  ((LOFilter)filter).setFilterPlan(p5);
  Rule r=new SplitFilter("SplitFilter");
  Set<Rule> s=new HashSet<Rule>();
  s.add(r);
  List<Set<Rule>> ls=new ArrayList<Set<Rule>>();
  ls.add(s);
  MyPlanOptimizer optimizer=new MyPlanOptimizer(plan,ls,3);
  MyPlanTransformListener listener=new MyPlanTransformListener();
  optimizer.addPlanTransformListener(listener);
  optimizer.optimize();
  Assert.assertEquals(plan.getPredecessors(filter).get(0),join);
  Operator next=plan.getSuccessors(filter).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  next=plan.getSuccessors(next).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  next=plan.getSuccessors(next).get(0);
  Assert.assertEquals(LOStore.class,next.getClass());
  OperatorPlan transformed=listener.getTransformed();
  Assert.assertEquals(transformed.size(),3);
  r=new PushUpFilter("PushUpFilter");
  s=new HashSet<Rule>();
  s.add(r);
  ls=new ArrayList<Set<Rule>>();
  ls.add(s);
  optimizer=new MyPlanOptimizer(plan,ls,3);
  listener=new MyPlanTransformListener();
  optimizer.addPlanTransformListener(listener);
  optimizer.optimize();
  next=plan.getSuccessors(load1).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  Assert.assertEquals(plan.getSuccessors(next).get(0),join);
  next=plan.getSuccessors(load2).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  Assert.assertEquals(plan.getSuccessors(next).get(0),join);
  next=plan.getSuccessors(join).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  next=plan.getSuccessors(next).get(0);
  Assert.assertEquals(next.getClass(),LOStore.class);
  transformed=listener.getTransformed();
  Assert.assertEquals(transformed.size(),7);
  r=new MergeFilter("MergeFilter");
  s=new HashSet<Rule>();
  s.add(r);
  ls=new ArrayList<Set<Rule>>();
  ls.add(s);
  optimizer=new MyPlanOptimizer(plan,ls,3);
  listener=new MyPlanTransformListener();
  optimizer.addPlanTransformListener(listener);
  optimizer.optimize();
  next=plan.getSuccessors(load1).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  Assert.assertEquals(plan.getSuccessors(next).get(0),join);
  next=plan.getSuccessors(load2).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  Assert.assertEquals(plan.getSuccessors(next).get(0),join);
  next=plan.getSuccessors(join).get(0);
  Assert.assertEquals(next.getClass(),LOFilter.class);
  next=plan.getSuccessors(next).get(0);
  Assert.assertEquals(next.getClass(),LOStore.class);
  transformed=listener.getTransformed();
  Assert.assertNull(transformed);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanImplicitSplit </h4><pre class="type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplit() throws Exception {
  int LOOP_SIZE=20;
  String[] input=new String[LOOP_SIZE];
  for (int i=1; i <= LOOP_SIZE; i++) {
    input[i - 1]=Integer.toString(i);
  }
  String inputFileName="testImplicitSplit-input.txt";
  Util.createInputFile(cluster,inputFileName,input);
  pigServer.registerQuery("A = LOAD '" + inputFileName + "';");
  pigServer.registerQuery("B = filter A by $0<=10;");
  pigServer.registerQuery("C = filter A by $0>10;");
  pigServer.registerQuery("D = union B,C;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  if (!iter.hasNext())   fail("No Output received");
  int cnt=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    ++cnt;
  }
  assertEquals(20,cnt);
  Util.deleteFile(cluster,inputFileName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanListener </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaPatcher() throws FrontendException {
  SchemaPatcher patcher=new SchemaPatcher();
  patcher.transformed(lp,changedPlan);
  List<Operator> roots=changedPlan.getSources();
  assertEquals(1,roots.size());
  LOFilter D=(LOFilter)roots.get(0);
  assertNotNull(D);
  LogicalSchema dschema=D.getSchema();
  assertEquals(1,dschema.size());
  LogicalSchema.LogicalFieldSchema y=dschema.getField(0);
  assertEquals("y",y.alias);
  assertEquals(2,y.uid);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectionPatcher() throws FrontendException {
  ProjectionPatcher patcher=new ProjectionPatcher();
  patcher.transformed(lp,changedPlan);
  List<Operator> roots=changedPlan.getSources();
  assertEquals(1,roots.size());
  LOFilter D=(LOFilter)roots.get(0);
  assertNotNull(D);
  LogicalExpressionPlan filterPlan=D.getFilterPlan();
  List<Operator> leaves=filterPlan.getSinks();
  assertEquals(2,leaves.size());
  ProjectExpression proj=null;
  for (  Operator leaf : leaves) {
    if (leaf instanceof ProjectExpression) {
      proj=(ProjectExpression)leaf;
      break;
    }
  }
  assertNotNull(proj);
  assertEquals(0,proj.getInputNum());
  assertEquals(0,proj.getColNum());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanLogToPhyTranslationVisitor </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithSubtract() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a-b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(SubtractExpression.class,genExp.getSources().get(0).getClass());
  SubtractExpression add=(SubtractExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Subtract.class,inputPln.getLeaves().get(0).getClass());
  Subtract pSubtract=(Subtract)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pSubtract.getLhs().getClass());
  assertEquals(POProject.class,pSubtract.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanWithCast() throws Exception {
  String query=("a = load 'd.txt' as (id, c);" + "b = filter a by (int)id==10;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(3,phyPlan.size());
  assertEquals(phyPlan.getRoots().size(),1);
  assertEquals(phyPlan.getLeaves().size(),1);
  PhysicalOperator load=phyPlan.getRoots().get(0);
  assertEquals(POLoad.class,load.getClass());
  assertTrue(((POLoad)load).getLFile().getFileName().contains("d.txt"));
  PhysicalOperator fil=phyPlan.getSuccessors(load).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  PhysicalOperator equal=filPlan.getLeaves().get(0);
  assertEquals(EqualToExpr.class,equal.getClass());
  assertEquals(DataType.BOOLEAN,((EqualToExpr)equal).getResultType());
  PhysicalOperator constExpr=((EqualToExpr)equal).getRhs();
  assertEquals(ConstantExpression.class,constExpr.getClass());
  assertEquals(10,((ConstantExpression)constExpr).getValue());
  PhysicalOperator castExpr=((EqualToExpr)equal).getLhs();
  assertEquals(POCast.class,castExpr.getClass());
  assertEquals(DataType.INTEGER,((POCast)castExpr).getResultType());
  PhysicalOperator prj=((POCast)castExpr).getInputs().get(0);
  assertEquals(POProject.class,prj.getClass());
  assertEquals(0,((POProject)prj).getColumn());
  PhysicalOperator stor=phyPlan.getLeaves().get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithNegative() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate -a;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(NegativeExpression.class,genExp.getSources().get(0).getClass());
  NegativeExpression add=(NegativeExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getExpression().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(PONegative.class,inputPln.getLeaves().get(0).getClass());
  PONegative pNegative=(PONegative)inputPln.getLeaves().get(0);
  assertEquals(1,inputPln.getRoots().size());
  assertEquals(POProject.class,pNegative.getInputs().get(0).getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForeachPlan() throws Exception {
  String query=("a = load 'd.txt' as (id, c);" + "b = foreach a generate id, c;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(phyPlan.size(),3);
  assertEquals(phyPlan.getLeaves().get(0).getClass(),POStore.class);
  POForEach foreach=(POForEach)phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(foreach.getInputPlans().size(),2);
  PhysicalPlan inner=foreach.getInputPlans().get(0);
  assertEquals(inner.size(),1);
  POProject prj=(POProject)inner.getRoots().get(0);
  assertEquals(prj.getColumn(),0);
  assertEquals(prj.getInputs(),null);
  inner=foreach.getInputPlans().get(1);
  assertEquals(inner.size(),1);
  prj=(POProject)inner.getRoots().get(0);
  assertEquals(prj.getColumn(),1);
  assertEquals(prj.getInputs(),null);
  Boolean[] flat=foreach.getToBeFlattened().toArray(new Boolean[0]);
  assertFalse(flat[0]);
  assertFalse(flat[1]);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanWithGreaterThan() throws Exception {
  String query=("a = load 'd.txt' as (id, c);" + "b = filter a by (int)id>10;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(3,phyPlan.size());
  assertEquals(phyPlan.getRoots().size(),1);
  assertEquals(phyPlan.getLeaves().size(),1);
  PhysicalOperator load=phyPlan.getRoots().get(0);
  assertEquals(POLoad.class,load.getClass());
  assertTrue(((POLoad)load).getLFile().getFileName().contains("d.txt"));
  PhysicalOperator fil=phyPlan.getSuccessors(load).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  PhysicalOperator greaterThan=filPlan.getLeaves().get(0);
  assertEquals(GreaterThanExpr.class,greaterThan.getClass());
  assertEquals(DataType.BOOLEAN,((GreaterThanExpr)greaterThan).getResultType());
  PhysicalOperator constExpr=((GreaterThanExpr)greaterThan).getRhs();
  assertEquals(ConstantExpression.class,constExpr.getClass());
  assertEquals(10,((ConstantExpression)constExpr).getValue());
  PhysicalOperator castExpr=((GreaterThanExpr)greaterThan).getLhs();
  assertEquals(POCast.class,castExpr.getClass());
  assertEquals(DataType.INTEGER,((POCast)castExpr).getResultType());
  PhysicalOperator prj=((POCast)castExpr).getInputs().get(0);
  assertEquals(POProject.class,prj.getClass());
  assertEquals(0,((POProject)prj).getColumn());
  PhysicalOperator stor=phyPlan.getLeaves().get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithMultiply() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a*b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(MultiplyExpression.class,genExp.getSources().get(0).getClass());
  MultiplyExpression add=(MultiplyExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Multiply.class,inputPln.getLeaves().get(0).getClass());
  Multiply pMultiply=(Multiply)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pMultiply.getLhs().getClass());
  assertEquals(POProject.class,pMultiply.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimplePlan() throws Exception {
  String query=("a = load 'd.txt';" + "b = filter a by $0==NULL;" + "store b into 'empty';");
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(3,phyPlan.size());
  assertEquals(1,phyPlan.getRoots().size());
  assertEquals(1,phyPlan.getLeaves().size());
  PhysicalOperator load=phyPlan.getRoots().get(0);
  assertEquals(POLoad.class,load.getClass());
  assertTrue(((POLoad)load).getLFile().getFileName().contains("d.txt"));
  PhysicalOperator fil=phyPlan.getSuccessors(load).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  List<PhysicalOperator> roots=filPlan.getRoots();
  Collections.sort(roots);
  assertEquals(2,roots.size());
  assertEquals(1,filPlan.getLeaves().size());
  PhysicalOperator eq=filPlan.getLeaves().get(0);
  assertEquals(EqualToExpr.class,eq.getClass());
  PhysicalOperator prj1=roots.get(0);
  assertEquals(POProject.class,prj1.getClass());
  assertEquals(0,((POProject)prj1).getColumn());
  PhysicalOperator constExp=roots.get(1);
  assertEquals(ConstantExpression.class,constExp.getClass());
  assertEquals(null,((ConstantExpression)constExp).getValue());
  PhysicalOperator stor=phyPlan.getSuccessors(fil).get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithisNotNull() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = filter a by a is not null;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fil=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(newLogicalPlan.getSources().get(0)).get(0);
  assertEquals(LOFilter.class,fil.getClass());
  LOFilter filter=(LOFilter)fil;
  LogicalExpressionPlan filPlan=filter.getFilterPlan();
  assertEquals(1,filPlan.getSources().size());
  assertEquals(3,filPlan.size());
  assertEquals(1,filPlan.getSinks().size());
  assertEquals(NotExpression.class,filPlan.getSources().get(0).getClass());
  NotExpression notExp=(NotExpression)filPlan.getSources().get(0);
  assertTrue(ls.getField(0).uid != notExp.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != notExp.getFieldSchema().uid);
  assertEquals(IsNullExpression.class,notExp.getExpression().getClass());
  IsNullExpression isNull=(IsNullExpression)notExp.getExpression();
  assertTrue(ls.getField(0).uid != isNull.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != isNull.getFieldSchema().uid);
  assertEquals(ProjectExpression.class,isNull.getExpression().getClass());
  ProjectExpression prj=(ProjectExpression)isNull.getExpression();
  assertEquals(ls.getField(0).uid,prj.getFieldSchema().uid);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroupSchema2() throws Exception {
  String query="a = load '1.txt' as (a0, a1);" + "b = group a by a0;" + "c = foreach b generate a.a1;"+ "store c into 'empty';";
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  LOForEach foreach=(LOForEach)newLogicalPlan.getPredecessors(store).get(0);
  LogicalSchema foreachSchema=foreach.getSchema();
  assertEquals(foreachSchema.getField(0).type,DataType.BAG);
  LogicalSchema bagSchema=foreachSchema.getField(0).schema;
  assertEquals(bagSchema.getField(0).type,DataType.TUPLE);
  assertEquals(bagSchema.getField(0).alias,null);
  LogicalSchema tupleSchema=bagSchema.getField(0).schema;
  assertEquals(tupleSchema.size(),1);
  assertTrue(tupleSchema.getField(0).alias.equals("a1"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiStore() throws Exception {
  String query=("a = load 'd1.txt' as (id, c);" + "b = load 'd2.txt'as (id, c);" + "c = load 'd3.txt' as (id, c);"+ "d = join a by id, b by c;"+ "e = filter d by a::id==NULL AND b::c==NULL;"+ "f = join e by b::c, c by id;"+ "g = filter f by b::id==NULL AND c::c==NULL;"+ "store g into 'empty2';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(16,phyPlan.size());
  List<PhysicalOperator> phyPlanRoots=phyPlan.getRoots();
  Collections.sort(phyPlanRoots);
  assertEquals(phyPlanRoots.size(),3);
  assertEquals(phyPlan.getLeaves().size(),1);
  PhysicalOperator LoR=(PhysicalOperator)phyPlan.getSuccessors(phyPlanRoots.get(2)).get(0);
  assertEquals(POLocalRearrange.class,LoR.getClass());
  POLocalRearrange Lor=(POLocalRearrange)LoR;
  PhysicalOperator prj1=Lor.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj1.getClass());
  assertEquals(0,((POProject)prj1).getColumn());
  PhysicalOperator inp1=Lor.getInputs().get(0);
  assertEquals(POLoad.class,inp1.getClass());
  assertTrue(((POLoad)inp1).getLFile().getFileName().contains("d3.txt"));
  PhysicalOperator LoR1=(PhysicalOperator)phyPlan.getSuccessors(phyPlanRoots.get(0)).get(0);
  assertEquals(POLocalRearrange.class,LoR1.getClass());
  POLocalRearrange Lor1=(POLocalRearrange)LoR1;
  PhysicalOperator prj2=Lor1.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj2.getClass());
  assertEquals(0,((POProject)prj2).getColumn());
  PhysicalOperator inp2=Lor1.getInputs().get(0);
  assertEquals(POLoad.class,inp2.getClass());
  assertTrue(((POLoad)inp2).getLFile().getFileName().contains("d1.txt"));
  PhysicalOperator GoR=(PhysicalOperator)phyPlan.getSuccessors(LoR).get(0);
  assertEquals(POGlobalRearrange.class,GoR.getClass());
  PhysicalOperator Pack=(PhysicalOperator)phyPlan.getSuccessors(GoR).get(0);
  assertEquals(POPackage.class,Pack.getClass());
  PhysicalOperator LoR2=(PhysicalOperator)phyPlan.getSuccessors(phyPlanRoots.get(1)).get(0);
  assertEquals(POLocalRearrange.class,LoR2.getClass());
  POLocalRearrange Lor2=(POLocalRearrange)LoR2;
  PhysicalOperator prj3=Lor2.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj3.getClass());
  assertEquals(1,((POProject)prj3).getColumn());
  PhysicalOperator inp3=Lor2.getInputs().get(0);
  assertEquals(POLoad.class,inp3.getClass());
  assertTrue(((POLoad)inp3).getLFile().getFileName().contains("d2.txt"));
  PhysicalOperator GoR2=(PhysicalOperator)phyPlan.getSuccessors(LoR2).get(0);
  assertEquals(POGlobalRearrange.class,GoR2.getClass());
  PhysicalOperator Pack2=(PhysicalOperator)phyPlan.getSuccessors(GoR2).get(0);
  assertEquals(POPackage.class,Pack2.getClass());
  PhysicalOperator ForE=(PhysicalOperator)phyPlan.getSuccessors(Pack).get(0);
  assertEquals(POForEach.class,ForE.getClass());
  PhysicalOperator prj4=((POForEach)ForE).getInputPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj4.getClass());
  assertEquals(1,((POProject)prj4).getColumn());
  PhysicalOperator prj5=((POForEach)ForE).getInputPlans().get(1).getLeaves().get(0);
  assertEquals(POProject.class,prj5.getClass());
  assertEquals(2,((POProject)prj5).getColumn());
  PhysicalOperator ForE2=(PhysicalOperator)phyPlan.getSuccessors(Pack2).get(0);
  assertEquals(POForEach.class,ForE2.getClass());
  PhysicalOperator prj6=((POForEach)ForE2).getInputPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj6.getClass());
  assertEquals(1,((POProject)prj6).getColumn());
  PhysicalOperator prj7=((POForEach)ForE2).getInputPlans().get(1).getLeaves().get(0);
  assertEquals(POProject.class,prj7.getClass());
  assertEquals(2,((POProject)prj7).getColumn());
  PhysicalOperator fil=(PhysicalOperator)phyPlan.getSuccessors(ForE).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  List<PhysicalOperator> filRoots=filPlan.getRoots();
  Collections.sort(filRoots);
  assertEquals(ConstantExpression.class,filRoots.get(1).getClass());
  ConstantExpression ce1=(ConstantExpression)filRoots.get(1);
  assertEquals(null,ce1.getValue());
  assertEquals(ConstantExpression.class,filRoots.get(3).getClass());
  ConstantExpression ce2=(ConstantExpression)filRoots.get(3);
  assertEquals(null,ce2.getValue());
  assertEquals(POProject.class,filRoots.get(2).getClass());
  POProject prj8=(POProject)filRoots.get(2);
  assertEquals(5,prj8.getColumn());
  assertEquals(POProject.class,filRoots.get(0).getClass());
  POProject prj9=(POProject)filRoots.get(0);
  assertEquals(2,prj9.getColumn());
  PhysicalOperator fil2=(PhysicalOperator)phyPlan.getSuccessors(ForE2).get(0);
  assertEquals(POFilter.class,fil2.getClass());
  PhysicalOperator LoR3=(PhysicalOperator)phyPlan.getSuccessors(fil2).get(0);
  assertEquals(POLocalRearrange.class,LoR3.getClass());
  POLocalRearrange Lor3=(POLocalRearrange)LoR3;
  PhysicalOperator prj12=Lor3.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj12.getClass());
  assertEquals(3,((POProject)prj12).getColumn());
  PhysicalPlan filPlan2=((POFilter)fil2).getPlan();
  List<PhysicalOperator> filRoots2=filPlan2.getRoots();
  Collections.sort(filRoots2);
  assertEquals(ConstantExpression.class,filRoots2.get(1).getClass());
  ConstantExpression ce3=(ConstantExpression)filRoots2.get(1);
  assertEquals(null,ce3.getValue());
  assertEquals(ConstantExpression.class,filRoots2.get(3).getClass());
  ConstantExpression ce4=(ConstantExpression)filRoots2.get(3);
  assertEquals(null,ce4.getValue());
  assertEquals(POProject.class,filRoots2.get(2).getClass());
  POProject prj10=(POProject)filRoots2.get(2);
  assertEquals(3,prj10.getColumn());
  assertEquals(POProject.class,filRoots2.get(0).getClass());
  POProject prj11=(POProject)filRoots2.get(0);
  assertEquals(0,prj11.getColumn());
  PhysicalOperator stor=(PhysicalOperator)phyPlan.getLeaves().get(0);
  assertEquals(stor,phyPlan.getSuccessors(fil).get(0));
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroupSchema1() throws Exception {
  String query=("a = load '1.txt' as (a0, a1);" + "b = group a by a0;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  Operator store=newLogicalPlan.getSinks().get(0);
  LOCogroup cogroup=(LOCogroup)newLogicalPlan.getPredecessors(store).get(0);
  LogicalSchema cogroupSchema=cogroup.getSchema();
  assertEquals(cogroupSchema.getField(1).type,DataType.BAG);
  assertTrue(cogroupSchema.getField(1).alias.equals("a"));
  LogicalSchema bagSchema=cogroupSchema.getField(1).schema;
  assertEquals(bagSchema.getField(0).type,DataType.TUPLE);
  assertEquals(bagSchema.getField(0).alias,null);
  LogicalSchema tupleSchema=bagSchema.getField(0).schema;
  assertEquals(tupleSchema.size(),2);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithDivide() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a/b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(DivideExpression.class,genExp.getSources().get(0).getClass());
  DivideExpression add=(DivideExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Divide.class,inputPln.getLeaves().get(0).getClass());
  Divide pDivide=(Divide)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pDivide.getLhs().getClass());
  assertEquals(POProject.class,pDivide.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithPlus() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a+b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(AddExpression.class,genExp.getSources().get(0).getClass());
  AddExpression add=(AddExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Add.class,inputPln.getLeaves().get(0).getClass());
  Add pAdd=(Add)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pAdd.getLhs().getClass());
  assertEquals(POProject.class,pAdd.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanWithLessThan() throws Exception {
  String query=("a = load 'd.txt' as (id, c);" + "b = filter a by (int)id<10;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(3,phyPlan.size());
  assertEquals(phyPlan.getRoots().size(),1);
  assertEquals(phyPlan.getLeaves().size(),1);
  PhysicalOperator load=phyPlan.getRoots().get(0);
  assertEquals(POLoad.class,load.getClass());
  assertTrue(((POLoad)load).getLFile().getFileName().contains("d.txt"));
  PhysicalOperator fil=phyPlan.getSuccessors(load).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  PhysicalOperator lessThan=filPlan.getLeaves().get(0);
  assertEquals(LessThanExpr.class,lessThan.getClass());
  assertEquals(DataType.BOOLEAN,((LessThanExpr)lessThan).getResultType());
  PhysicalOperator constExpr=((LessThanExpr)lessThan).getRhs();
  assertEquals(ConstantExpression.class,constExpr.getClass());
  assertEquals(10,((ConstantExpression)constExpr).getValue());
  PhysicalOperator castExpr=((LessThanExpr)lessThan).getLhs();
  assertEquals(POCast.class,castExpr.getClass());
  assertEquals(DataType.INTEGER,((POCast)castExpr).getResultType());
  PhysicalOperator prj=((POCast)castExpr).getInputs().get(0);
  assertEquals(POProject.class,prj.getClass());
  assertEquals(0,((POProject)prj).getColumn());
  PhysicalOperator stor=phyPlan.getLeaves().get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithMod() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = foreach a generate a%b;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  PhysicalOperator pFE=phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(POForEach.class,pFE.getClass());
  POForEach pForEach=(POForEach)pFE;
  PhysicalPlan inputPln=pForEach.getInputPlans().get(0);
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(load).get(0);
  assertEquals(LOForEach.class,fe.getClass());
  LOForEach forEach=(LOForEach)fe;
  LogicalPlan innerPlan=forEach.getInnerPlan();
  assertEquals(1,innerPlan.getSinks().size());
  assertEquals(LOGenerate.class,innerPlan.getSinks().get(0).getClass());
  LOGenerate gen=(LOGenerate)innerPlan.getSinks().get(0);
  assertEquals(1,gen.getOutputPlans().size());
  LogicalExpressionPlan genExp=gen.getOutputPlans().get(0);
  assertEquals(1,genExp.getSources().size());
  assertEquals(ModExpression.class,genExp.getSources().get(0).getClass());
  ModExpression add=(ModExpression)genExp.getSources().get(0);
  assertEquals(ls.getField(0).uid,add.getLhs().getFieldSchema().uid);
  assertEquals(ls.getField(1).uid,add.getRhs().getFieldSchema().uid);
  assertTrue(ls.getField(0).uid != add.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != add.getFieldSchema().uid);
  assertEquals(1,inputPln.getLeaves().size());
  assertEquals(Mod.class,inputPln.getLeaves().get(0).getClass());
  Mod pMod=(Mod)inputPln.getLeaves().get(0);
  assertEquals(2,inputPln.getRoots().size());
  assertEquals(POProject.class,pMod.getLhs().getClass());
  assertEquals(POProject.class,pMod.getRhs().getClass());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinPlan() throws Exception {
  String query=("a = load 'd1.txt' as (id, c);" + "b = load 'd2.txt'as (id, c);" + "c = join a by id, b by c;"+ "d = filter c by a::id==NULL AND b::c==NULL;"+ "store d into 'empty';");
  LogicalPlan newPlan=buildPlan(query);
  PhysicalPlan physicalPlan=translatePlan(newPlan);
  assertEquals(9,physicalPlan.size());
  List<PhysicalOperator> roots=physicalPlan.getRoots();
  Collections.sort(roots);
  assertEquals(roots.size(),2);
  PhysicalOperator LoR=(PhysicalOperator)physicalPlan.getSuccessors(roots.get(0)).get(0);
  assertEquals(POLocalRearrange.class,LoR.getClass());
  POLocalRearrange Lor=(POLocalRearrange)LoR;
  PhysicalOperator prj3=Lor.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj3.getClass());
  assertEquals(0,((POProject)prj3).getColumn());
  PhysicalOperator inp1=Lor.getInputs().get(0);
  assertEquals(POLoad.class,inp1.getClass());
  assertTrue(((POLoad)inp1).getLFile().getFileName().contains("d1.txt"));
  PhysicalOperator LoR1=(PhysicalOperator)physicalPlan.getSuccessors(roots.get(1)).get(0);
  assertEquals(POLocalRearrange.class,LoR1.getClass());
  POLocalRearrange Lor1=(POLocalRearrange)LoR1;
  PhysicalOperator prj4=Lor1.getPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj4.getClass());
  assertEquals(1,((POProject)prj4).getColumn());
  PhysicalOperator inp2=Lor1.getInputs().get(0);
  assertEquals(POLoad.class,inp2.getClass());
  assertTrue(((POLoad)inp2).getLFile().getFileName().contains("d2.txt"));
  PhysicalOperator GoR=(PhysicalOperator)physicalPlan.getSuccessors(LoR).get(0);
  assertEquals(POGlobalRearrange.class,GoR.getClass());
  PhysicalOperator Pack=(PhysicalOperator)physicalPlan.getSuccessors(GoR).get(0);
  assertEquals(POPackage.class,Pack.getClass());
  PhysicalOperator ForE=(PhysicalOperator)physicalPlan.getSuccessors(Pack).get(0);
  assertEquals(POForEach.class,ForE.getClass());
  PhysicalOperator prj5=((POForEach)ForE).getInputPlans().get(0).getLeaves().get(0);
  assertEquals(POProject.class,prj5.getClass());
  assertEquals(1,((POProject)prj5).getColumn());
  PhysicalOperator prj6=((POForEach)ForE).getInputPlans().get(1).getLeaves().get(0);
  assertEquals(POProject.class,prj6.getClass());
  assertEquals(2,((POProject)prj6).getColumn());
  PhysicalOperator fil=(PhysicalOperator)physicalPlan.getSuccessors(ForE).get(0);
  assertEquals(POFilter.class,fil.getClass());
  PhysicalPlan filPlan=((POFilter)fil).getPlan();
  List<PhysicalOperator> filRoots=filPlan.getRoots();
  assertEquals(4,filRoots.size());
  Collections.sort(filRoots);
  assertEquals(ConstantExpression.class,filRoots.get(1).getClass());
  ConstantExpression ce1=(ConstantExpression)filRoots.get(1);
  assertEquals(null,ce1.getValue());
  assertEquals(ConstantExpression.class,filRoots.get(3).getClass());
  ConstantExpression ce2=(ConstantExpression)filRoots.get(3);
  assertEquals(null,ce2.getValue());
  assertEquals(POProject.class,filRoots.get(0).getClass());
  POProject prj1=(POProject)filRoots.get(0);
  assertEquals(0,prj1.getColumn());
  assertEquals(POProject.class,filRoots.get(2).getClass());
  POProject prj2=(POProject)filRoots.get(2);
  assertEquals(3,prj2.getColumn());
  PhysicalOperator stor=(PhysicalOperator)physicalPlan.getSuccessors(fil).get(0);
  assertEquals(POStore.class,stor.getClass());
  assertTrue(((POStore)stor).getSFile().getFileName().contains("empty"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlanwithisNull() throws Exception {
  String query=("a = load 'd.txt' as (a:int, b:int);" + "b = filter a by a is null;" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  assertEquals(LOLoad.class,ld.getClass());
  LOLoad load=(LOLoad)ld;
  LogicalSchema ls=load.getSchema();
  assertEquals(1,ls.getField(0).uid);
  assertEquals(2,ls.getField(1).uid);
  LogicalRelationalOperator fil=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(newLogicalPlan.getSources().get(0)).get(0);
  assertEquals(LOFilter.class,fil.getClass());
  LOFilter filter=(LOFilter)fil;
  LogicalExpressionPlan filPlan=filter.getFilterPlan();
  assertEquals(1,filPlan.getSources().size());
  assertEquals(2,filPlan.size());
  assertEquals(1,filPlan.getSinks().size());
  assertEquals(IsNullExpression.class,filPlan.getSources().get(0).getClass());
  IsNullExpression isNull=(IsNullExpression)filPlan.getSources().get(0);
  assertTrue(ls.getField(0).uid != isNull.getFieldSchema().uid);
  assertTrue(ls.getField(1).uid != isNull.getFieldSchema().uid);
  assertEquals(ProjectExpression.class,isNull.getExpression().getClass());
  ProjectExpression prj=(ProjectExpression)isNull.getExpression();
  assertEquals(ls.getField(0).uid,prj.getFieldSchema().uid);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForeachPlan2() throws Exception {
  String query=("a = load 'd.txt' as (id, c:bag{t:(s,v)});" + "b = foreach a generate id, flatten(c);" + "store b into 'empty';");
  LogicalPlan newLogicalPlan=buildPlan(query);
  LogicalRelationalOperator ld=(LogicalRelationalOperator)newLogicalPlan.getSources().get(0);
  LogicalRelationalOperator fe=(LogicalRelationalOperator)newLogicalPlan.getSuccessors(ld).get(0);
  LogicalSchema ls=fe.getSchema();
  assertEquals(1,ls.getField(0).uid);
  assertEquals(4,ls.getField(1).uid);
  assertEquals(5,ls.getField(2).uid);
  LogicalSchema expected=new LogicalSchema();
  expected.addField(new LogicalFieldSchema("id",null,DataType.BYTEARRAY));
  expected.addField(new LogicalFieldSchema("s",null,DataType.BYTEARRAY));
  expected.addField(new LogicalFieldSchema("v",null,DataType.BYTEARRAY));
  assertTrue(expected.isEqual(ls));
  PhysicalPlan phyPlan=translatePlan(newLogicalPlan);
  assertEquals(phyPlan.size(),3);
  assertEquals(phyPlan.getLeaves().get(0).getClass(),POStore.class);
  POForEach foreach=(POForEach)phyPlan.getSuccessors(phyPlan.getRoots().get(0)).get(0);
  assertEquals(foreach.getInputPlans().size(),2);
  PhysicalPlan inner=foreach.getInputPlans().get(0);
  assertEquals(inner.size(),1);
  POProject prj=(POProject)inner.getRoots().get(0);
  assertEquals(prj.getColumn(),0);
  assertEquals(prj.getInputs(),null);
  inner=foreach.getInputPlans().get(1);
  assertEquals(inner.size(),1);
  prj=(POProject)inner.getRoots().get(0);
  assertEquals(prj.getColumn(),1);
  assertEquals(prj.getInputs(),null);
  Boolean[] flat=foreach.getToBeFlattened().toArray(new Boolean[0]);
  assertFalse(flat[0]);
  assertTrue(flat[1]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanOperatorPlan </h4><pre class="type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplace4() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,filter1);
  plan.connect(filter1,filter2);
  Operator filter3=new SillyOperator("filter3",plan);
  plan.replace(filter2,filter3);
  List<Operator> preds=plan.getPredecessors(filter3);
  assertEquals(1,preds.size());
  assertTrue(preds.contains(filter1));
  List<Operator> succs=plan.getSuccessors(filter3);
  assertNull(succs);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove2() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator load2=new SillyOperator("load2",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator join1=new SillyOperator("join1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(load2);
  plan.add(filter1);
  plan.add(filter2);
  plan.add(join1);
  plan.connect(load1,join1);
  plan.connect(load2,filter1);
  plan.connect(filter1,join1);
  plan.connect(join1,filter2);
  plan.removeAndReconnect(load1);
  List<Operator> preds=plan.getPredecessors(join1);
  assertEquals(1,preds.size());
  assertTrue(preds.contains(filter1));
  plan.removeAndReconnect(filter1);
  preds=plan.getPredecessors(join1);
  assertEquals(1,preds.size());
  assertTrue(preds.contains(load2));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplace5() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,filter1);
  plan.connect(filter1,filter2);
  Operator load2=new SillyOperator("load2",plan);
  plan.replace(load1,load2);
  List<Operator> preds=plan.getPredecessors(load2);
  assertNull(preds);
  List<Operator> succs=plan.getSuccessors(load2);
  assertEquals(1,succs.size());
  assertTrue(succs.contains(filter1));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove1() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator load2=new SillyOperator("load2",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator join1=new SillyOperator("join1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(load2);
  plan.add(filter1);
  plan.add(filter2);
  plan.add(join1);
  plan.connect(load1,join1);
  plan.connect(load2,filter1);
  plan.connect(filter1,join1);
  plan.connect(join1,filter2);
  plan.removeAndReconnect(filter1);
  List<Operator> preds=plan.getPredecessors(join1);
  assertEquals(2,preds.size());
  assertTrue(preds.contains(load2));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperatorPlan() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  SillyOperator fred=new SillyOperator("fred",plan);
  SillyOperator joe=new SillyOperator("joe",plan);
  SillyOperator bob=new SillyOperator("bob",plan);
  SillyOperator jim=new SillyOperator("jim",plan);
  SillyOperator sam=new SillyOperator("sam",plan);
  List<Operator> list=plan.getSources();
  assertEquals(0,list.size());
  list=plan.getSinks();
  assertEquals(0,list.size());
  plan.add(fred);
  plan.add(joe);
  plan.add(bob);
  plan.add(jim);
  plan.add(sam);
  list=plan.getSources();
  assertEquals(5,list.size());
  list=plan.getSinks();
  assertEquals(5,list.size());
  plan.connect(fred,bob);
  plan.connect(joe,bob);
  plan.connect(bob,jim);
  plan.connect(bob,sam);
  list=plan.getSources();
  assertEquals(2,list.size());
  for (  Operator op : list) {
    assertTrue(fred.isEqual(op) || joe.isEqual(op));
  }
  list=plan.getSinks();
  assertEquals(2,list.size());
  for (  Operator op : list) {
    assertTrue(jim.isEqual(op) || sam.isEqual(op));
  }
  list=plan.getSuccessors(fred);
  assertEquals(1,list.size());
  assertEquals(bob,list.get(0));
  list=plan.getSuccessors(joe);
  assertEquals(1,list.size());
  assertEquals(bob,list.get(0));
  list=plan.getPredecessors(jim);
  assertEquals(1,list.size());
  assertEquals(bob,list.get(0));
  list=plan.getPredecessors(sam);
  assertEquals(1,list.size());
  assertEquals(bob,list.get(0));
  list=plan.getPredecessors(bob);
  assertEquals(2,list.size());
  assertEquals(fred,list.get(0));
  assertEquals(joe,list.get(1));
  list=plan.getSuccessors(bob);
  assertEquals(2,list.size());
  assertEquals(jim,list.get(0));
  assertEquals(sam,list.get(1));
  Pair<Integer,Integer> p1=plan.disconnect(bob,jim);
  Pair<Integer,Integer> p2=plan.disconnect(fred,bob);
  plan.connect(bob,p1.first,fred,p1.second);
  plan.connect(jim,p2.first,bob,p2.second);
  list=plan.getSources();
  assertEquals(2,list.size());
  for (  Operator op : list) {
    assertTrue(jim.isEqual(op) || joe.isEqual(op));
  }
  list=plan.getSinks();
  assertEquals(2,list.size());
  for (  Operator op : list) {
    assertTrue(fred.isEqual(op) || sam.isEqual(op));
  }
  list=plan.getSuccessors(jim);
  assertEquals(1,list.size());
  assertEquals(bob,list.get(0));
  list=plan.getSuccessors(joe);
  assertEquals(1,list.size());
  assertEquals(bob,list.get(0));
  list=plan.getPredecessors(fred);
  assertEquals(1,list.size());
  assertEquals(bob,list.get(0));
  list=plan.getPredecessors(sam);
  assertEquals(1,list.size());
  assertEquals(bob,list.get(0));
  list=plan.getPredecessors(bob);
  assertEquals(2,list.size());
  assertEquals(jim,list.get(0));
  assertEquals(joe,list.get(1));
  list=plan.getSuccessors(bob);
  assertEquals(2,list.size());
  assertEquals(fred,list.get(0));
  assertEquals(sam,list.get(1));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplace2() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator split1=new SillyOperator("split1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(split1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,split1);
  plan.connect(split1,filter1);
  plan.connect(split1,filter2);
  Operator split2=new SillyOperator("split2",plan);
  plan.replace(split1,split2);
  List<Operator> preds=plan.getPredecessors(split2);
  assertEquals(1,preds.size());
  assertTrue(preds.contains(load1));
  List<Operator> succs=plan.getSuccessors(split2);
  assertEquals(2,succs.size());
  assertTrue(succs.contains(filter1));
  assertTrue(succs.contains(filter2));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplace3() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,filter1);
  plan.connect(filter1,filter2);
  Operator filter3=new SillyOperator("filter3",plan);
  plan.replace(filter1,filter3);
  List<Operator> preds=plan.getPredecessors(filter3);
  assertEquals(1,preds.size());
  assertTrue(preds.contains(load1));
  List<Operator> succs=plan.getSuccessors(filter3);
  assertEquals(1,succs.size());
  assertTrue(succs.contains(filter2));
}

</code></pre>

<br>
<pre class="type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testRemove6() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator load2=new SillyOperator("load2",plan);
  Operator fake1=new SillyOperator("fake1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(load2);
  plan.add(fake1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,fake1);
  plan.connect(load2,fake1);
  plan.connect(fake1,filter1);
  plan.connect(fake1,filter2);
  try {
    plan.removeAndReconnect(fake1);
  }
 catch (  FrontendException e) {
    assertEquals(2256,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplace1() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator load2=new SillyOperator("load2",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator join1=new SillyOperator("join1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(load2);
  plan.add(filter1);
  plan.add(filter2);
  plan.add(join1);
  plan.connect(load1,join1);
  plan.connect(load2,filter1);
  plan.connect(filter1,join1);
  plan.connect(join1,filter2);
  Operator join2=new SillyOperator("join2",plan);
  plan.replace(join1,join2);
  List<Operator> preds=plan.getPredecessors(join2);
  assertEquals(2,preds.size());
  assertTrue(preds.contains(load1));
  assertTrue(preds.contains(filter1));
  List<Operator> succs=plan.getSuccessors(join2);
  assertEquals(1,succs.size());
  assertTrue(succs.contains(filter2));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove5() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator split1=new SillyOperator("split1",plan);
  Operator split2=new SillyOperator("split2",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.add(load1);
  plan.add(split1);
  plan.add(filter1);
  plan.add(filter2);
  plan.connect(load1,split1);
  plan.connect(split1,split2);
  plan.connect(split2,filter1);
  plan.connect(split2,filter2);
  plan.removeAndReconnect(split2);
  List<Operator> succs=plan.getSuccessors(split1);
  assertEquals(2,succs.size());
  assertTrue(succs.contains(filter1));
  assertTrue(succs.contains(filter2));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReplace6() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator load2=new SillyOperator("load2",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator fake1=new SillyOperator("fake1",plan);
  Operator filter2=new SillyOperator("filter2",plan);
  Operator filter3=new SillyOperator("filter3",plan);
  plan.add(load1);
  plan.add(load2);
  plan.add(filter1);
  plan.add(filter2);
  plan.add(filter3);
  plan.add(fake1);
  plan.connect(load1,fake1);
  plan.connect(load2,filter1);
  plan.connect(filter1,fake1);
  plan.connect(fake1,filter2);
  plan.connect(fake1,filter3);
  Operator fake2=new SillyOperator("fake2",plan);
  plan.replace(fake1,fake2);
  List<Operator> preds=plan.getPredecessors(fake2);
  assertEquals(2,preds.size());
  assertTrue(preds.contains(load1));
  assertTrue(preds.contains(filter1));
  List<Operator> succs=plan.getSuccessors(fake2);
  assertEquals(2,succs.size());
  assertTrue(succs.contains(filter2));
  assertTrue(succs.contains(filter3));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInsertBetween1() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  plan.add(load1);
  plan.add(filter1);
  plan.connect(load1,filter1);
  Operator filter2=new SillyOperator("filter2",plan);
  plan.insertBetween(load1,filter2,filter1);
  List<Operator> succs=plan.getSuccessors(filter2);
  assertEquals(1,succs.size());
  assertTrue(succs.contains(filter1));
  List<Operator> preds=plan.getPredecessors(filter2);
  assertEquals(1,preds.size());
  assertTrue(preds.contains(load1));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove4() throws FrontendException {
  SillyPlan plan=new SillyPlan();
  Operator load1=new SillyOperator("load1",plan);
  Operator load2=new SillyOperator("load2",plan);
  Operator filter1=new SillyOperator("filter1",plan);
  Operator join1=new SillyOperator("join1",plan);
  Operator fake1=new SillyOperator("fake1",plan);
  plan.add(load1);
  plan.add(load2);
  plan.add(filter1);
  plan.add(join1);
  plan.connect(load1,join1);
  plan.connect(load2,filter1);
  plan.connect(filter1,join1);
  plan.connect(join1,fake1);
  plan.removeAndReconnect(join1);
  List<Operator> preds=plan.getPredecessors(fake1);
  assertEquals(2,preds.size());
  assertTrue(preds.contains(load1));
  assertTrue(preds.contains(filter1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanPruneMapKeys </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan2() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "c = foreach b generate b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  assertEquals(1,newLogicalPlan.getSources().size());
  LOLoad load=(LOLoad)newLogicalPlan.getSources().get(0);
  Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)load.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertNotNull(annotation);
  assertEquals(1,annotation.keySet().size());
  Integer[] keySet=annotation.keySet().toArray(new Integer[0]);
  assertEquals(new Integer(0),keySet[0]);
  Set<String> keys=annotation.get(0);
  assertEquals(1,keys.size());
  assertEquals("name",keys.toArray(new String[0])[0]);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan3() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "c = foreach b generate a#'age',b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  assertEquals(1,newLogicalPlan.getSources().size());
  LOLoad load=(LOLoad)newLogicalPlan.getSources().get(0);
  Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)load.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
  assertNotNull(annotation);
  assertEquals(1,annotation.keySet().size());
  Integer[] keySet=annotation.keySet().toArray(new Integer[0]);
  assertEquals(new Integer(0),keySet[0]);
  Set<String> keys=annotation.get(0);
  assertEquals(2,keys.size());
  assertTrue(keys.contains("name"));
  assertTrue(keys.contains("age"));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan4() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "c = foreach b generate a#'age',a,b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(1,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null || annotation.isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan() throws Exception {
  String query="a =load 'd.txt' as (a:map[], b:int, c:float);" + "b = filter a by a#'name' == 'hello';" + "store b into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(1,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null || annotation.isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan5() throws Exception {
  String query="a =load 'd.txt' as (a:chararray, b:int, c:float);" + "b = filter a by a == 'hello';" + "c = foreach b generate a,b,c;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(1,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertNull(annotation);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan6() throws Exception {
  String query="a =load 'd.txt';" + "b = filter a by $0 == 'hello';" + "c = foreach b generate $0,$1,$2;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(1,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan7() throws Exception {
  String query="a =load 'd.txt';" + "a1 = load 'b.txt' as (a:map[],b:int, c:float);" + "b = join a by $0, a1 by a#'name';"+ "c = foreach b generate $0,$1,$2;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  printPlan(newLogicalPlan);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(2,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null || annotation.isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void testSimplePlan8() throws Exception {
  String query="a =load 'd.txt';" + "a1 = load 'b.txt' as (a:chararray,b:int, c:float);" + "b = join a by $0, a1 by a;"+ "c = foreach b generate $0,$1,$2;"+ "store c into 'empty';";
  org.apache.pig.newplan.logical.relational.LogicalPlan newLogicalPlan=migratePlan(query);
  printPlan(newLogicalPlan);
  List<Operator> sources=newLogicalPlan.getSources();
  assertEquals(2,sources.size());
  for (  Operator source : sources) {
    Map<Long,Set<String>> annotation=(Map<Long,Set<String>>)source.getAnnotation(MapKeysPruneHelper.REQUIRED_MAPKEYS);
    assertTrue(annotation == null || annotation.isEmpty());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanPushUpFilter </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Cascading joins. First one has outer, but filter should be able to push up above the second one, but below
 * the first one.
 */
@Test public void testFullOutJoin1() throws Exception {
  String query="A = load 'myfile' as (d1:int);" + "B = load 'anotherfile' as (d2:int);" + "C = join A by d1 full outer, B by d2;"+ "D = load 'xxx' as (d3:int);"+ "E = join C by d1, D by d3;"+ "F = filter E by d1 > 5;"+ "G = store F into 'dummy';";
  LogicalPlan newLogicalPlan=migrateAndOptimizePlan(query);
  List<Operator> ops=newLogicalPlan.getSinks();
  Assert.assertTrue(ops.size() == 1);
  Operator op=ops.get(0);
  Assert.assertTrue(op instanceof LOStore);
  Operator join=newLogicalPlan.getPredecessors(op).get(0);
  Assert.assertTrue(join instanceof LOJoin);
  ops=newLogicalPlan.getPredecessors(join);
  Assert.assertEquals(2,ops.size());
  Assert.assertTrue(ops.get(0) instanceof LOFilter || ops.get(1) instanceof LOFilter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNewPlanRule </h4><pre class="type-7 type-6 type-4 type-19 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiNode() throws Exception {
  Operator l3=new OP_Load("p3",plan);
  Operator f5=new OP_Filter("f5",plan);
  plan.add(l3);
  plan.add(f5);
  plan.connect(l3,f5);
  plan.connect(f5,join);
  OperatorPlan pattern=new SillyPlan();
  Operator op1=new OP_Load("mmm1",pattern);
  Operator op2=new OP_Filter("mmm2",pattern);
  Operator op3=new OP_Join("mmm3",pattern);
  pattern.add(op1);
  pattern.add(op2);
  pattern.add(op3);
  pattern.connect(op1,op3);
  pattern.connect(op2,op3);
  Rule r=new SillyRule("basic",pattern);
  List<OperatorPlan> l=r.match(plan);
  assertEquals(1,l.size());
  OperatorPlan match=l.get(0);
  assertEquals(3,match.size());
  assertEquals(1,match.getSinks().size());
  assertEquals(join,match.getSinks().get(0));
  assertEquals(2,match.getSources().size());
  assertTrue(match.getSources().get(0).getClass().equals(OP_Load.class) || match.getSources().get(0).equals(f5));
  assertTrue(match.getSources().get(1).getClass().equals(OP_Load.class) || match.getSources().get(1).equals(f5));
  assertNotSame(match.getSources().get(0),match.getSources().get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-19 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleNodeMatch() throws FrontendException {
  OperatorPlan pattern=new SillyPlan();
  pattern.add(new OP_Load("mmm",pattern));
  Rule r=new SillyRule("basic",pattern);
  List<OperatorPlan> l=r.match(plan);
  assertEquals(2,l.size());
  Operator m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("p1") || m1.getName().equals("p2"));
  assertEquals(1,l.get(0).size());
  Operator m2=l.get(1).getSources().get(0);
  assertTrue(m2.getName().equals("p1") || m2.getName().equals("p2"));
  assertEquals(1,l.get(1).size());
  assertNotSame(m1.getName(),m2.getName());
  pattern=new SillyPlan();
  pattern.add(new OP_Filter("mmm",pattern));
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(4,l.size());
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("f1") || m1.getName().equals("f2") || m1.getName().equals("f3")|| m1.getName().equals("f4"));
  assertEquals(1,l.get(0).size());
  m2=l.get(1).getSources().get(0);
  assertTrue(m1.getName().equals("f1") || m1.getName().equals("f2") || m1.getName().equals("f3")|| m1.getName().equals("f4"));
  assertEquals(1,l.get(1).size());
  assertNotSame(m1.getName(),m2.getName());
  pattern=new SillyPlan();
  pattern.add(new OP_Store("mmm",pattern));
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(l.size(),2);
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("s1") || m1.getName().equals("s2"));
  assertEquals(l.get(0).size(),1);
  m2=l.get(1).getSources().get(0);
  assertTrue(m2.getName().equals("s1") || m2.getName().equals("s2"));
  assertEquals(l.get(1).size(),1);
  assertNotSame(m1.getName(),m2.getName());
  pattern=new SillyPlan();
  pattern.add(new OP_Split("mmm",pattern));
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(l.size(),1);
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("t1"));
  assertEquals(l.get(0).size(),1);
  pattern=new SillyPlan();
  pattern.add(new OP_Join("mmm",pattern));
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(l.size(),1);
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("j1"));
  assertEquals(l.get(0).size(),1);
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeNodeMatch() throws FrontendException {
  Operator f5=new OP_Filter("f5",plan);
  Operator f6=new OP_Filter("f6",plan);
  Operator s5=new OP_Store("s5",plan);
  Operator s6=new OP_Store("s6",plan);
  plan.add(f5);
  plan.add(f6);
  plan.add(s5);
  plan.add(s6);
  plan.connect(f5,s5);
  plan.connect(f6,s6);
  plan.connect(join,f5);
  plan.connect(join,f6);
  OperatorPlan pattern=new SillyPlan();
  Operator s1=new OP_Join("mmm1",pattern);
  Operator s2=new OP_Filter("mmm2",pattern);
  Operator s3=new OP_Filter("mmm3",pattern);
  Operator s4=new OP_Filter("mmm4",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.add(s3);
  pattern.add(s4);
  pattern.connect(s1,s2);
  pattern.connect(s1,s3);
  pattern.connect(s1,s4);
  Rule r=new SillyRule("basic",pattern);
  List<OperatorPlan> l=r.match(plan);
  assertEquals(1,l.size());
  assertEquals(1,l.get(0).getSources().size());
  assertEquals(3,l.get(0).getSinks().size());
  assertEquals(4,l.get(0).size());
  Operator m1, m2;
  m1=l.get(0).getSources().get(0);
  assertEquals("j1",m1.getName());
  for (int i=0; i < 3; i++) {
    m2=l.get(0).getSinks().get(i);
    assertTrue(m2.getName().equals("f1") || m2.getName().equals("f5") || m2.getName().equals("f6"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-19 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoNodeMatch() throws FrontendException {
  OperatorPlan pattern=new SillyPlan();
  pattern.add(new OP_Load("mmm1",pattern));
  pattern.add(new OP_Load("mmm2",pattern));
  Rule r=new SillyRule("basic",pattern);
  List<OperatorPlan> l=r.match(plan);
  assertEquals(l.size(),1);
  assertEquals(l.get(0).getSources().size(),2);
  assertEquals(l.get(0).getSinks().size(),2);
  assertEquals(l.get(0).size(),2);
  Operator m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("p1") || m1.getName().equals("p2"));
  Operator m2=l.get(0).getSources().get(1);
  assertTrue(m2.getName().equals("p1") || m2.getName().equals("p2"));
  assertNotSame(m1.getName(),m2.getName());
  pattern=new SillyPlan();
  Operator s1=new OP_Join("mmm1",pattern);
  Operator s2=new OP_Filter("mmm2",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.connect(s1,s2);
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(1,l.size());
  assertEquals(1,l.get(0).getSources().size());
  assertEquals(1,l.get(0).getSinks().size());
  assertEquals(2,l.get(0).size());
  m1=l.get(0).getSources().get(0);
  assertTrue(m1.getName().equals("j1"));
  m2=l.get(0).getSinks().get(0);
  assertTrue(m2.getName().equals("f1"));
  pattern=new SillyPlan();
  s1=new OP_Filter("mmm1",pattern);
  s2=new OP_Store("mmm2",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.connect(s1,s2);
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(2,l.size());
  assertEquals(1,l.get(0).getSources().size());
  assertEquals(1,l.get(0).getSinks().size());
  pattern=new SillyPlan();
  s1=new OP_Load("mmm1",pattern);
  s2=new OP_Load("mmm2",pattern);
  Operator s3=new OP_Join("jjj",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.add(s3);
  pattern.connect(s1,s3);
  pattern.connect(s2,s3);
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(l.size(),1);
  pattern=new SillyPlan();
  s1=new OP_Split("mmm1",pattern);
  s2=new OP_Filter("mmm2",pattern);
  s3=new OP_Filter("mmm3",pattern);
  pattern.add(s1);
  pattern.add(s2);
  pattern.add(s3);
  pattern.connect(s1,s2);
  pattern.connect(s1,s3);
  r=new SillyRule("basic",pattern);
  l=r.match(plan);
  assertEquals(1,l.size());
  assertEquals(1,l.get(0).getSources().size());
  assertEquals(2,l.get(0).getSinks().size());
  assertEquals(3,l.get(0).size());
  m1=l.get(0).getSources().get(0);
  assertEquals("t1",m1.getName());
  m2=l.get(0).getSinks().get(0);
  assertTrue(m2.getName().equals("f3") || m2.getName().equals("f4"));
  m2=l.get(0).getSinks().get(1);
  assertTrue(m2.getName().equals("f3") || m2.getName().equals("f4"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestNotEqualTo </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapEq() throws ExecException {
  Map map_1=new HashMap();
  map_1.put("key_1","value_1");
  Map map_2=new HashMap();
  map_2.put("key_1","value_1");
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(map_1);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(map_2);
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.MAP);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(0L));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleNe() throws ExecException {
  Tuple tuple_1=TupleFactory.getInstance().newTuple("item_1");
  Tuple tuple_2=TupleFactory.getInstance().newTuple("item_2");
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(tuple_1);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(tuple_2);
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.TUPLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(0));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBooleanNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(Boolean.TRUE);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(Boolean.FALSE);
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BOOLEAN);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBooleanEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(Boolean.TRUE);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(Boolean.TRUE);
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BOOLEAN);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(0L));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleEq() throws ExecException {
  Tuple tuple_1=TupleFactory.getInstance().newTuple("item_1");
  Tuple tuple_2=TupleFactory.getInstance().newTuple("item_1");
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(tuple_1);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(tuple_2);
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.TUPLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataByteArrayNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DataByteArray("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DataByteArray("b"));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.BYTEARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("b"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new String("a"));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new String("b"));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.CHARARRAY);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(1.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Long(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Long(1L));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.LONG);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(1.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFloatNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Float(0.0f));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Float(1.0f));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.FLOAT);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntegerEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Integer(1));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Integer(1));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.INTEGER);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateTimeEq() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new DateTime(1L));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new DateTime(1L));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DATETIME);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertFalse((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoubleNe() throws Exception {
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(new Double(0.0));
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(new Double(1.0));
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.DOUBLE);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapNe() throws ExecException {
  Map map_1=new HashMap();
  map_1.put("key_1","value_1");
  Map map_2=new HashMap();
  map_2.put("key_1","value_2");
  Tuple tuple_2=TupleFactory.getInstance().newTuple("item_2");
  ConstantExpression lt=GenPhyOp.exprConst();
  lt.setValue(map_1);
  ConstantExpression rt=GenPhyOp.exprConst();
  rt.setValue(map_2);
  NotEqualToExpr g=GenPhyOp.compNotEqualToExpr();
  g.setLhs(lt);
  g.setRhs(rt);
  g.setOperandType(DataType.MAP);
  Result r=g.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,r.returnStatus);
  assertTrue((Boolean)r.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOBinCond </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondLongWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.LONG);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.LONG,new Long(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Long value=null;
    if (t.get(0) != null) {
      value=(Long)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondDoubleWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.DOUBLE);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DOUBLE,new Double(1.0));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Double value=null;
    if (t.get(0) != null) {
      value=(Double)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondIntWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.INTEGER);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.INTEGER,new Integer(1));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    Integer value=null;
    Integer result;
    if (t.get(0) != null) {
      value=(Integer)t.get(0);
      result=(Integer)testHelper.getOperator().getNextInteger().result;
    }
 else {
      result=(Integer)testHelper.getOperator().getNextInteger().result;
    }
    int actual;
    if (value != null) {
      int expected=(value.intValue() == 1) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPOBinCondDateTimeWithNull() throws ExecException, PlanException {
  bag=getBagWithNulls(DataType.DATETIME);
  TestPoBinCondHelper testHelper=new TestPoBinCondHelper(DataType.DATETIME,new DateTime(1L));
  for (  Tuple t : bag) {
    testHelper.getPlan().attachInput(t);
    DateTime value=null;
    if (t.get(0) != null) {
      value=(DateTime)t.get(0);
    }
    Integer dummy=new Integer(0);
    Integer result=(Integer)testHelper.getOperator().getNextInteger().result;
    int expected;
    int actual;
    if (value != null) {
      expected=value.equals(new DateTime(1L)) ? 1 : 0;
      actual=result.intValue();
      assertEquals(expected,actual);
    }
 else {
      assertNull(result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOCast </h4><pre class="type-13 type-7 type-8 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagToOther() throws IOException, ParserException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  op.setFuncSpec(new FuncSpec(PigStorage.class.getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.BAG);
  TupleFactory tf=TupleFactory.getInstance();
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Result res=op.getNextTuple();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataBag b=(DataBag)t.get(0);
    Result res=op.getNextDataBag();
    assertEquals(b,res.result);
    planToTestBACasts.attachInput(t);
    res=opWithInputTypeAsBA.getNextDataBag();
    assertEquals(b,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Integer i=null;
    Result res=op.getNextInteger();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Long i=null;
    Result res=op.getNextLong();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Float i=null;
    Result res=op.getNextFloat();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    Double i=null;
    Result res=op.getNextDouble();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    String i=null;
    Result res=op.getNextString();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBag(r,1,100));
    plan.attachInput(t);
    DataByteArray i=null;
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
    op.setFuncSpec(new FuncSpec(BinStorage.class.getName()));
    plan.attachInput(t);
    res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{t:tuple(a:chararray, b:float)}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Float);
        assertTrue(((Float)(expectedBagTuple.get(1))).floatValue() == (Float)(convertedBagTuple.get(1)));
      }
    }
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandSmallTupDataBagWithNulls(r,20,100));
    Schema s=Utils.getSchemaFromString("b:bag{}");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    DataBag db=null;
    Result res=op.getNextDataBag();
    Iterator<Tuple> expectedBagIterator=((DataBag)(t.get(0))).iterator();
    Iterator<Tuple> convertedBagIterator=((DataBag)(res.result)).iterator();
    while (expectedBagIterator.hasNext()) {
      Tuple expectedBagTuple=expectedBagIterator.next();
      Tuple convertedBagTuple=convertedBagIterator.next();
      if (expectedBagTuple.get(0) != null) {
        assertTrue(convertedBagTuple.get(0) instanceof String);
        assertTrue(expectedBagTuple.get(0).equals(convertedBagTuple.get(0)));
      }
      if (expectedBagTuple.get(1) != null) {
        assertTrue(convertedBagTuple.get(1) instanceof Integer);
        assertTrue(((Integer)(expectedBagTuple.get(1))) == (Integer)(convertedBagTuple.get(1)));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleToOther() throws IOException, ParserException {
  POCast op=new POCast(new OperatorKey("",r.nextLong()),-1);
  op.setFuncSpec(new FuncSpec(PigStorage.class.getName()));
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(op);
  plan.connect(prj,op);
  prj.setResultType(DataType.TUPLE);
  TupleFactory tf=TupleFactory.getInstance();
  POCast opWithInputTypeAsBA=new POCast(new OperatorKey("",r.nextLong()),-1);
  PhysicalPlan planToTestBACasts=constructPlan(opWithInputTypeAsBA);
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Map map=null;
    Result res=op.getNextMap();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Result res=op.getNextTuple();
    assertEquals(t,res.result);
    planToTestBACasts.attachInput(tNew);
    res=opWithInputTypeAsBA.getNextTuple();
    assertEquals(t,res.result);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    DataBag b=null;
    Result res=op.getNextDataBag();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Integer i=null;
    Result res=op.getNextInteger();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Long i=null;
    Result res=op.getNextLong();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Float i=null;
    Result res=op.getNextFloat();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    Double i=null;
    Result res=op.getNextDouble();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    DateTime dt=null;
    Result res=op.getNextDateTime();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    String i=null;
    Result res=op.getNextString();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    t.append(GenRandomData.genRandString(r));
    Tuple tNew=tf.newTuple();
    tNew.append(t);
    plan.attachInput(tNew);
    DataByteArray i=null;
    Result res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
    op.setFuncSpec(new FuncSpec(BinStorage.class.getName()));
    plan.attachInput(tNew);
    res=op.getNextDataByteArray();
    assertEquals(POStatus.STATUS_ERR,res.returnStatus);
  }
{
    Tuple t=tf.newTuple();
    Tuple wrappedTuple=tf.newTuple();
    wrappedTuple.append(GenRandomData.genRandString(r));
    wrappedTuple.append(GenRandomData.genRandString(r));
    t.append(wrappedTuple);
    Schema s=Utils.getSchemaFromString("t:tuple(a:chararray)");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    Tuple tup=null;
    Result res=op.getNextTuple();
    assertTrue(res.result == null);
  }
{
    Tuple t=tf.newTuple();
    Tuple wrappedTuple=tf.newTuple();
    wrappedTuple.append(GenRandomData.genRandString(r));
    wrappedTuple.append(GenRandomData.genRandString(r));
    t.append(wrappedTuple);
    Schema s=Utils.getSchemaFromString("t:tuple(a:chararray, b:chararray)");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    Tuple tup=null;
    Result res=op.getNextTuple();
    verifyResult(res,POStatus.STATUS_OK,wrappedTuple);
  }
{
    Tuple t=tf.newTuple();
    Tuple wrappedTuple=tf.newTuple();
    wrappedTuple.append(GenRandomData.genRandString(r));
    wrappedTuple.append(null);
    t.append(wrappedTuple);
    Schema s=Utils.getSchemaFromString("t:tuple(a:chararray, b:chararray)");
    op.setFieldSchema(new ResourceSchema.ResourceFieldSchema(s.getField(0)));
    plan.attachInput(t);
    Tuple tup=null;
    Result res=op.getNextTuple();
    verifyResult(res,POStatus.STATUS_OK,wrappedTuple);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOGenerate </h4><pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleGenerate() throws Exception {
  ExpressionOperator prj1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  ExpressionOperator prj2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  prj1.setResultType(DataType.INTEGER);
  prj2.setResultType(DataType.INTEGER);
  List<Boolean> toBeFlattened=new LinkedList<Boolean>();
  toBeFlattened.add(true);
  toBeFlattened.add(false);
  PhysicalPlan plan1=new PhysicalPlan();
  plan1.add(prj1);
  PhysicalPlan plan2=new PhysicalPlan();
  plan2.add(prj2);
  List<PhysicalPlan> inputs=new LinkedList<PhysicalPlan>();
  inputs.add(plan1);
  inputs.add(plan2);
  PhysicalOperator poGen=new POForEach(new OperatorKey("",r.nextLong()),1,inputs,toBeFlattened);
  List<String> obtained=new LinkedList<String>();
  for (  Tuple t : simpleGenerate) {
    poGen.attachInput(t);
    Result output=poGen.getNextTuple();
    while (output.result != null && output.returnStatus != POStatus.STATUS_EOP) {
      obtained.add(((Tuple)output.result).toString());
      output=poGen.getNextTuple();
    }
  }
  int count=0;
  for (  Tuple t : simpleGenerate) {
    assertTrue(obtained.contains(t.toString()));
    ++count;
  }
  assertEquals(simpleGenerate.size(),count);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialJoin() throws Exception {
  ExpressionOperator prj1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  ExpressionOperator prj2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  prj1.setResultType(DataType.BAG);
  prj2.setResultType(DataType.BAG);
  List<Boolean> toBeFlattened=new LinkedList<Boolean>();
  toBeFlattened.add(true);
  toBeFlattened.add(false);
  PhysicalPlan plan1=new PhysicalPlan();
  plan1.add(prj1);
  PhysicalPlan plan2=new PhysicalPlan();
  plan2.add(prj2);
  List<PhysicalPlan> inputs=new LinkedList<PhysicalPlan>();
  inputs.add(plan1);
  inputs.add(plan2);
  PhysicalOperator poGen=new POForEach(new OperatorKey("",r.nextLong()),1,inputs,toBeFlattened);
  List<String> obtained=new LinkedList<String>();
  for (  Tuple t : cogroup) {
    poGen.attachInput(t);
    Result output=poGen.getNextTuple();
    while (output.result != null && output.returnStatus != POStatus.STATUS_EOP) {
      obtained.add(((Tuple)output.result).toString());
      output=poGen.getNextTuple();
    }
  }
  int count=0;
  for (  Tuple t : partialFlatten) {
    assertTrue(obtained.contains(t.toString()));
    ++count;
  }
  assertEquals(partialFlatten.size(),count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPONegative </h4><pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegLongAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextLong());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.LONG);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.LONG);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Long output=(Long)pn.getNextLong().result;
      assertNull(output);
    }
 else {
      Long expected=-(Long)t.get(0);
      long output=(Long)pn.getNextLong().result;
      assertEquals(expected.longValue(),output);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegIntAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextInt());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.INTEGER);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.INTEGER);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    if (t.get(0) == null) {
      Integer output=(Integer)pn.getNextInteger().result;
      assertNull(output);
    }
 else {
      Integer expected=-(Integer)t.get(0);
      Integer output=(Integer)pn.getNextInteger().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegFloatAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextFloat());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.FLOAT);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.FLOAT);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (Iterator<Tuple> it=bag.iterator(); it.hasNext(); ) {
    Tuple t=it.next();
    plan.attachInput(t);
    if (t.get(0) == null) {
      Float output=(Float)pn.getNextFloat().result;
      assertNull(output);
    }
 else {
      Float expected=-(Float)t.get(0);
      Float output=(Float)pn.getNextFloat().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPONegDoubleAndNull() throws PlanException, ExecException {
  for (int i=0; i < MAX; i++) {
    Tuple t=tf.newTuple();
    t.append(r.nextDouble());
    bag.add(t);
    if (r.nextInt(3) % 3 == 0) {
      t=tf.newTuple();
      t.append(null);
      bag.add(t);
    }
  }
  POProject prj=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  prj.setResultType(DataType.DOUBLE);
  PONegative pn=new PONegative(new OperatorKey("",r.nextLong()),-1,prj);
  pn.setResultType(DataType.DOUBLE);
  PhysicalPlan plan=new PhysicalPlan();
  plan.add(prj);
  plan.add(pn);
  plan.connect(prj,pn);
  for (  Tuple t : bag) {
    plan.attachInput(t);
    if (t.get(0) == null) {
      Double output=(Double)pn.getNextDouble().result;
      assertNull(output);
    }
 else {
      Double expected=-(Double)t.get(0);
      Double output=(Double)pn.getNextDouble().result;
      assertEquals(expected,output);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAgg </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemorySpill1() throws Exception {
  Result res;
  for (long i=1; i <= 15; i++) {
    Tuple t=tuple(1,tuple(i));
    partAggOp.attachInput(t);
    res=partAggOp.getNextTuple();
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  }
  Future<Long> spilled=executor.submit(new Spill(partAggOp));
  Thread.sleep(100);
  partAggOp.attachInput(tuple(2,tuple(-1L)));
  assertFalse(spilled.isDone());
  res=partAggOp.getNextTuple();
  assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  Thread.sleep(100);
  assertTrue(spilled.isDone());
  assertEquals(new Long(1),spilled.get());
  List<Tuple> expectedValues=new ArrayList<Tuple>();
  expectedValues.add(tuple(1,tuple(120L)));
  expectedValues.add(tuple(2,tuple(-1L)));
  parentPlan.endOfAllInput=true;
  res=partAggOp.getNextTuple();
  do {
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertTrue(expectedValues.remove(res.result));
    res=partAggOp.getNextTuple();
  }
 while (res.returnStatus != POStatus.STATUS_EOP);
  assertTrue(expectedValues.isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemorySpill2() throws Exception {
  Result res=null;
  List<Tuple> expectedValues=new ArrayList<Tuple>();
  for (long i=1; i <= 2001; i++) {
    Tuple t=tuple(i,tuple(i));
    expectedValues.add(t);
    partAggOp.attachInput(t);
    res=partAggOp.getNextTuple();
    assertEquals(POStatus.STATUS_EOP,res.returnStatus);
  }
  Future<Long> spilled=executor.submit(new Spill(partAggOp));
  Thread.sleep(100);
  partAggOp.attachInput(tuple(2,tuple(-1L)));
  expectedValues.add(tuple(2,tuple(-1L)));
  long i=0;
  res=partAggOp.getNextTuple();
  do {
    assertFalse(spilled.isDone());
    assertEquals(POStatus.STATUS_OK,res.returnStatus);
    assertTrue(expectedValues.remove(res.result));
    i++;
    res=partAggOp.getNextTuple();
  }
 while (res.returnStatus != POStatus.STATUS_EOP);
  assertEquals(2002,i);
  assertTrue(expectedValues.isEmpty());
  Thread.sleep(100);
  assertTrue(spilled.isDone());
  assertEquals(new Long(1),spilled.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAggPlan </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNotCombinable() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group, COUNT(l.b), l.b;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMapAggProp() throws Exception {
  String query=getGByQuery();
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropTrue() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNotNull("POPartialAgg should be present",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNoAggFunc() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropFalse() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"false");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOPartialAggPlanMR </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNoAggFunc() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropTrue() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNotNull("POPartialAgg should be present",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNotCombinable() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group, COUNT(l.b), l.b;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropFalse() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"false");
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMapAggProp() throws Exception {
  String query=getGByQuery();
  MROperPlan mrp=Util.buildMRPlan(query,pc);
  assertEquals(mrp.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(mrp));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPOSort </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Sorting
 * (null, 10)
 * (1, 8)
 * (1, null)
 * (null,null)
 * (3, 8)
 * BY $1 DESC, $0 ASC
 * should return
 * (null, 10)
 * (1, 8 )
 * (3, 8 )
 * (null,null)
 * (1, null)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc1WithNull() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(null);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(1);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(1);
  t3.append(null);
  input.add(t3);
  Tuple t4=TupleFactory.getInstance().newTuple();
  t4.append(null);
  t4.append(null);
  input.add(t4);
  Tuple t5=TupleFactory.getInstance().newTuple();
  t5.append(3);
  t5.append(8);
  input.add(t5);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertEquals(((Tuple)res.result).get(1),10);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertNull(((Tuple)res.result).get(1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Sorting
 * (null, 10)
 * (1, 8)
 * (1, null)
 * (null,null)
 * (3, 8)
 * BY $0 DESC, $1 ASC
 * should return
 * (3, 8 )
 * (1, null)
 * (1, 8 )
 * (null,null)
 * (null, 10)
 * @throws ExecException
 */
@Test public void testPOSortMixAscDesc2Null() throws ExecException {
  DataBag input=DefaultBagFactory.getInstance().newDefaultBag();
  Tuple t1=TupleFactory.getInstance().newTuple();
  t1.append(null);
  t1.append(10);
  input.add(t1);
  Tuple t2=TupleFactory.getInstance().newTuple();
  t2.append(1);
  t2.append(8);
  input.add(t2);
  Tuple t3=TupleFactory.getInstance().newTuple();
  t3.append(1);
  t3.append(null);
  input.add(t3);
  Tuple t4=TupleFactory.getInstance().newTuple();
  t4.append(null);
  t4.append(null);
  input.add(t4);
  Tuple t5=TupleFactory.getInstance().newTuple();
  t5.append(3);
  t5.append(8);
  input.add(t5);
  List<PhysicalPlan> sortPlans=new LinkedList<PhysicalPlan>();
  POProject pr1=new POProject(new OperatorKey("",r.nextLong()),-1,0);
  pr1.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan1=new PhysicalPlan();
  expPlan1.add(pr1);
  sortPlans.add(expPlan1);
  POProject pr2=new POProject(new OperatorKey("",r.nextLong()),-1,1);
  pr2.setResultType(DataType.INTEGER);
  PhysicalPlan expPlan2=new PhysicalPlan();
  expPlan2.add(pr2);
  sortPlans.add(expPlan2);
  List<Boolean> mAscCols=new LinkedList<Boolean>();
  mAscCols.add(false);
  mAscCols.add(true);
  PORead read=new PORead(new OperatorKey("",r.nextLong()),input);
  List<PhysicalOperator> inputs=new LinkedList<PhysicalOperator>();
  inputs.add(read);
  POSort sort=new POSort(new OperatorKey("",r.nextLong()),-1,inputs,sortPlans,mAscCols,null);
  Tuple t=null;
  Result res;
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),3);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertEquals(((Tuple)res.result).get(0),1);
  assertEquals(((Tuple)res.result).get(1),8);
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertNull(((Tuple)res.result).get(1));
  res=sort.getNextTuple();
  assertNull(((Tuple)res.result).get(0));
  assertEquals(((Tuple)res.result).get(1),10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParamSubPreproc </h4><pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEscaping() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputEscape.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult2.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUndefinedParam() throws Exception {
  log.info("Starting test testUndefinedParam()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input2.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  try {
    ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
    fail("Should have thrown an Undefined parameter exception");
  }
 catch (  ParseException e) {
    assertEquals(e.getMessage(),"Undefined parameter : param");
  }
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMacroDef() throws Exception {
  log.info("Starting test testMacroDef() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input6.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult6.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileComboDuplicate() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFileDuplicates.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdnameAsParamDeclare() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputCmdnameAsParamDeclare.pig","sh \\$cmd.sh \\$date","\\$cmd.bat \\$date",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution for a command with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSameParamInMultipleFiles() throws Exception {
  log.info("Starting test testSameParamInMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile3.txt",basedir + "/ConfFile2.txt",basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Same Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamCurlySyntax() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input7.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult7.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParam() throws Exception {
  log.info("Starting test testCmdlineParam() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=20080228"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamPriortoDeclare() throws Exception {
  log.info("Starting test testCmdlineParamPriortoDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input2.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"param='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultCmdLnPriorDeclare.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution of command line arg. prior to declare stmt failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionInFuncArgs() throws Exception {
  log.info("Starting test testSubstitutionInFuncArgs()");
  final String queryString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": $debug,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"$name\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  final String expectedString="  avro = LOAD '/data/part-m-00000.avro' USING PigStorage ();\n" + "   avro2 = FOREACH avro GENERATE  browser_id, component_version, " + "member_id, page_key, session_id, tracking_time, type;\n"+ "    fs -rmr testOut/out1;\n"+ "    STORE avro2 INTO 'testOut/out2'\n"+ "    USING PigStorage (\n"+ "    ' {\n"+ "   \"debug\": 5,\n"+ "    \"schema\":\n"+ "        { \"type\":\"record\",\"name\":\"TestRecord\",   \n"+ "          \"fields\": [ {\"name\":\"browser_id\", \"type\":[\"null\",\"string\"]},  \n"+ "                      {\"name\":\"component_version\",\"type\":\"int\"},\n"+ "                      {\"name\":\"member_id\",\"type\":\"int\"},\n"+ "                      {\"name\":\"page_key\",\"type\":[\"null\",\"string\"]},\n"+ "                      {\"name\":\"session_id\",\"type\":\"long\"},\n"+ "                      {\"name\":\"tracking_time\",\"type\":\"long\"},\n"+ "                      {\"name\":\"type\",\"type\":[\"null\",\"string\"]}\n"+ "                   ]\n"+ "        }\n"+ "    }\n"+ "    ');";
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new InputStreamReader(new ByteArrayInputStream(queryString.getBytes("UTF-8"))));
  pigOStream=new FileWriter(basedir + "/output26.pig");
  String[] arg={"debug = '5'","name = 'TestRecord'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output26.pig");
  InputStream expected=new ByteArrayInputStream(expectedString.getBytes("UTF-8"));
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(expected));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareDefaultComboDuplicates() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'","tableName=\"skip this\""};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDefault.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexVals() throws Exception {
  log.info("Starting test testComplexVals() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input5.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"loadfile = /user/pig/tests/data/singlefile/textdoc.txt"};
  String[] argFiles={basedir + "/ConfFileComplexVal.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult3.txt");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithDollarSign() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputDollarSign.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"filter=\"($0 == 'x') and ($1 == 'y')\""};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDollarSign.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommentWithParam() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputComment.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultComment.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineParamWithInlineCmd() throws Exception {
  log.info("Starting test testCmdlineParamWithInlineCmd() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date=`perl -e \"print qq@20080228\\n20070101@\" | head -n 1`"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleCmdlineParam() throws Exception {
  log.info("Starting test testCmdnameAsParamDeclare()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='092487'","date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShellCommand() throws Exception {
  log.info("Starting test testShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/input4.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultDefault.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParamsFromMultipleFiles() throws Exception {
  log.info("Starting test testFileParamsFromMultipleFiles()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt",basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from multiple config files failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidLineinConfigfile() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFileWithInvalidLines.txt"};
  try {
    ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
    fail("Should have thrown an exception");
  }
 catch (  ParseException e) {
    assertTrue(e.getMessage().startsWith("Encountered \" <IDENTIFIER> \"is \"\" at line 2, column 6."));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinValue() throws Exception {
  log.info("Starting test  testSubstitutionWithinValue()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputSubstitutionWithinValue.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution within a value failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsinSingleLine() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstituteWithinLiteral() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileParam() throws Exception {
  log.info("Starting test  testFileParam()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFile1.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution from config file failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleDeclareScope() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputMultipleDeclares.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResultMulDecs.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCmdlineFileDeclareCombo() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputThreeParams.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg={"date='20080228'"};
  String[] argFiles={basedir + "/ConfFile2.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoVars() throws Exception {
  log.info("Starting test testNoVars() ...");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/inputNoVars.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/inputNoVars.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Command line parameter substitution failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstitutionWithinShellCommand() throws Exception {
  log.info("Starting test testSubstitutionWithinShellCommand()");
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=WithConditionalReplacement(basedir + "/inputSubstitutionWithinShellCommand.pig","sh test/org/apache/pig/test/data/generate_date.sh","test/org/apache/pig/test/data/generate_date.bat",Shell.WINDOWS);
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles=null;
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult4.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Parameter substitution with shell command failed. " + "Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
  log.info("Done");
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleParamsFromSingleFile() throws Exception {
  ParameterSubstitutionPreprocessor ps=new ParameterSubstitutionPreprocessor(50);
  pigIStream=new BufferedReader(new FileReader(basedir + "/input1.pig"));
  pigOStream=new FileWriter(basedir + "/output1.pig");
  String[] arg=null;
  String[] argFiles={basedir + "/ConfFileSameParamMultipleTimes.txt"};
  ps.genSubstitutedFile(pigIStream,pigOStream,arg,argFiles);
  FileInputStream pigResultStream=new FileInputStream(basedir + "/output1.pig");
  pigExResultStream=new FileInputStream(basedir + "/ExpectedResult.pig");
  BufferedReader inExpected=new BufferedReader(new InputStreamReader(pigExResultStream));
  BufferedReader inResult=new BufferedReader(new InputStreamReader(pigResultStream));
  String exLine;
  String resLine;
  int lineNum=0;
  while (true) {
    lineNum++;
    exLine=inExpected.readLine();
    resLine=inResult.readLine();
    if (exLine == null || resLine == null)     break;
    assertEquals("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum,exLine.trim(),resLine.trim());
  }
  if (!(exLine == null && resLine == null)) {
    fail("Expected : " + exLine + " , but got : "+ resLine+ " in line num : "+ lineNum);
  }
  inExpected.close();
  inResult.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestParser </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestrictedColumnNamesWhitelist() throws Exception {
  pigServer=new PigServer(Util.getLocalTestMode());
  Data data=resetData(pigServer);
  Set<Tuple> tuples=Sets.newHashSet(tuple(1),tuple(2),tuple(3));
  data.set("foo","x:int",tuples);
  pigServer.registerQuery("a = load 'foo' using mock.Storage();");
  pigServer.registerQuery("a = foreach a generate x as rank;");
  pigServer.registerQuery("a = foreach a generate rank as cube;");
  pigServer.registerQuery("a = foreach a generate cube as y;");
  pigServer.registerQuery("rank = a;");
  pigServer.registerQuery("cube = rank;");
  pigServer.registerQuery("rank = cube;");
  pigServer.registerQuery("cube = foreach rank generate y as cube;");
  pigServer.registerQuery("store cube into 'baz' using mock.Storage();");
  List<Tuple> tuples2=data.get("baz");
  assertEquals(tuples.size(),tuples2.size());
  for (  Tuple t : tuples2) {
    tuples.remove(t);
  }
  assertTrue(tuples.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPhyPatternMatch </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeNodePatternLinear() throws PlanException {
  PatternPlan ptPlan=new PatternPlan();
  PatternNode ptFilNode=createPtNode(ptPlan,POFilter.class);
  PatternNode ptFENode=createPtNode(ptPlan,POForEach.class);
  PatternNode ptStNode=createPtNode(ptPlan,POStore.class);
  ptPlan.connect(ptFilNode,ptFENode);
  ptPlan.connect(ptFENode,ptStNode);
  PhysicalPlan pplan=new PhysicalPlan();
  POFilter fil=new POFilter(getNewOpKey());
  pplan.add(fil);
  assertFalse("plan not matched",ptPlan.match(pplan));
  assertEquals("null match",ptFilNode.getMatch(),null);
  assertEquals("null match",ptFENode.getMatch(),null);
  assertEquals("null match",ptStNode.getMatch(),null);
  POForEach fe=new POForEach(getNewOpKey());
  pplan.add(fe);
  pplan.connect(fil,fe);
  assertFalse("plan not matched",ptPlan.match(pplan));
  POFilter fil2=new POFilter(getNewOpKey());
  pplan.add(fil2);
  pplan.connect(fil2,fil);
  assertFalse("plan not matched",ptPlan.match(pplan));
  POStore store=new POStore(getNewOpKey());
  pplan.add(store);
  pplan.connect(fe,store);
  assertTrue("plan matched",ptPlan.match(pplan));
  assertEquals("test match node",ptFilNode.getMatch(),fil);
  assertEquals("test match node",ptFENode.getMatch(),fe);
  assertEquals("test match node",ptStNode.getMatch(),store);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingleNodePattern() throws PlanException {
  PatternPlan ptPlan=new PatternPlan();
  PatternNode ptFilNode=new PatternNode(ptPlan);
  ptFilNode.setClassName(POFilter.class);
  ptPlan.add(ptFilNode);
  PhysicalPlan pplan=new PhysicalPlan();
  POForEach fe=new POForEach(getNewOpKey());
  pplan.add(fe);
  boolean matched=ptPlan.match(pplan);
  assertFalse("plan not matched",matched);
  POFilter fil=new POFilter(getNewOpKey());
  pplan.add(fil);
  pplan.connect(fe,fil);
  matched=ptPlan.match(pplan);
  assertTrue("plan matched",matched);
  assertEquals(" class matched ",ptFilNode.getMatch(),fil);
  ptFilNode.setSourceNode(true);
  assertFalse("plan matched",ptPlan.match(pplan));
  ptFilNode.setSourceNode(false);
  ptFilNode.setLeafNode(true);
  assertTrue("plan matched",ptPlan.match(pplan));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTwoNodePattern() throws PlanException {
  Class<?>[] nodes={POForEach.class,POFilter.class};
  PatternPlan ptPlan=PatternPlan.create(nodes);
  PatternNode ptFilNode=(PatternNode)ptPlan.getSinks().get(0);
  PatternNode ptFENode=(PatternNode)ptPlan.getSources().get(0);
  PhysicalPlan pplan=new PhysicalPlan();
  POFilter fil=new POFilter(getNewOpKey());
  pplan.add(fil);
  assertFalse("plan not matched",ptPlan.match(pplan));
  assertEquals("null match",ptFilNode.getMatch(),null);
  assertEquals("null match",ptFENode.getMatch(),null);
  POForEach fe=new POForEach(getNewOpKey());
  pplan.add(fe);
  pplan.connect(fe,fil);
  assertTrue("plan matched",ptPlan.match(pplan));
  ptFilNode.setLeafNode(true);
  ptFENode.setSourceNode(true);
  assertTrue("plan matched",ptPlan.match(pplan));
  POStore store=new POStore(getNewOpKey());
  pplan.add(store);
  pplan.connect(fil,store);
  assertFalse("plan matched",ptPlan.match(pplan));
  ptFilNode.setLeafNode(false);
  assertTrue("plan matched",ptPlan.match(pplan));
  assertEquals("filter pt node match",ptFilNode.getMatch(),fil);
  assertEquals("foreach pt node match",ptFENode.getMatch(),fe);
  POForEach fe2=new POForEach(getNewOpKey());
  pplan.add(fe2);
  pplan.connect(fe2,fe);
  assertFalse("plan matched",ptPlan.match(pplan));
  ptFENode.setSourceNode(false);
  assertTrue("plan matched",ptPlan.match(pplan));
  assertEquals("filter pt node match",ptFilNode.getMatch(),fil);
  assertEquals("foreach pt node match",ptFENode.getMatch(),fe);
  PhysicalPlan pplan2=new PhysicalPlan();
  POFilter fil2=new POFilter(getNewOpKey());
  pplan.add(fil2);
  POForEach fe21=new POForEach(getNewOpKey());
  pplan.add(fe21);
  pplan.connect(fil2,fe21);
  assertFalse("plan not matched",ptPlan.match(pplan2));
  assertEquals("null match",ptFilNode.getMatch(),null);
  assertEquals("null match",ptFENode.getMatch(),null);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreeNodePatternTwoParents() throws PlanException, ExecException {
  PatternPlan ptPlan=new PatternPlan();
  PatternNode ptFilNode=createPtNode(ptPlan,POFilter.class);
  PatternNode ptFENode=createPtNode(ptPlan,POForEach.class);
  PatternNode ptJoinNode=createPtNode(ptPlan,POFRJoin.class);
  ptPlan.connect(ptFilNode,ptJoinNode);
  ptPlan.connect(ptFENode,ptJoinNode);
  PhysicalPlan pplan=new PhysicalPlan();
  POFilter fil=new POFilter(getNewOpKey());
  pplan.add(fil);
  assertFalse("plan not matched",ptPlan.match(pplan));
  POForEach fe=new POForEach(getNewOpKey());
  pplan.add(fe);
  assertFalse("plan not matched",ptPlan.match(pplan));
  POFRJoin join=new POFRJoin(getNewOpKey(),0,null,new ArrayList<List<PhysicalPlan>>(),null,null,0,false,null);
  pplan.add(join);
  pplan.connect(fil,join);
  pplan.connect(fe,join);
  assertTrue("plan matched",ptPlan.match(pplan));
  assertEquals("test match node",ptFilNode.getMatch(),fil);
  assertEquals("test match node",ptFENode.getMatch(),fe);
  assertEquals("test match node",ptJoinNode.getMatch(),join);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPi </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPi() throws Exception {
  pig.registerQuery("A = load 'foo' using mock.Storage() as (x:double, y:double);");
  pig.registerQuery("B = foreach A generate $0 - 0.5 as d1, $1 - 0.5 as d2;");
  pig.registerQuery("C = foreach B generate $0 * $0 as m1, $1 * $1 as m2;");
  pig.registerQuery("D = foreach C generate $0 + $1 as s1;");
  pig.registerQuery("D = foreach D generate $0, ARITY($0);");
  pig.registerQuery("E = filter D by $0 <= 0.25;");
  pig.registerQuery("F = cogroup D by $1, E by $1;");
  pig.registerQuery("G = foreach F generate COUNT($1) as total, COUNT($2) as in_circle;");
  Iterator<Tuple> values=pig.openIterator("G");
  assertTrue(values.hasNext());
  Tuple finalValues=values.next();
  int totalPoints=DataType.toInteger(finalValues.get(0));
  int inCirclePoints=DataType.toInteger(finalValues.get(1));
  log.info("Value of PI = " + 4 * (double)inCircle / (double)total);
  log.info("Value of PI (From Test data) = " + 4 * (double)inCirclePoints / (double)totalPoints);
  Iterator<Tuple> lengthTest=pig.openIterator("D");
  while (lengthTest.hasNext()) {
    Tuple temp=lengthTest.next();
    totalLengthTest+=temp.get(0).toString().length();
  }
  assertEquals(totalPoints,total);
  assertEquals(inCirclePoints,inCircle);
  assertEquals(totalLengthTest,totalLength);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigContext </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportList() throws Exception {
  String FILE_SEPARATOR=System.getProperty("file.separator");
  File tmpDir=File.createTempFile("test","");
  tmpDir.delete();
  tmpDir.mkdir();
  File udf1Dir=new File(tmpDir.getAbsolutePath() + FILE_SEPARATOR + "com"+ FILE_SEPARATOR+ "xxx"+ FILE_SEPARATOR+ "udf1");
  udf1Dir.mkdirs();
  File udf2Dir=new File(tmpDir.getAbsolutePath() + FILE_SEPARATOR + "com"+ FILE_SEPARATOR+ "xxx"+ FILE_SEPARATOR+ "udf2");
  udf2Dir.mkdirs();
  String udf1Src=new String("package com.xxx.udf1;\n" + "import java.io.IOException;\n" + "import org.apache.pig.EvalFunc;\n"+ "import org.apache.pig.data.Tuple;\n"+ "public class TestUDF1 extends EvalFunc<Integer>{\n"+ "public Integer exec(Tuple input) throws IOException {\n"+ "return 1;}\n"+ "}");
  String udf2Src=new String("package com.xxx.udf2;\n" + "import org.apache.pig.builtin.PigStorage;\n" + "public class TestUDF2 extends PigStorage { }\n");
  JavaCompilerHelper javaCompilerHelper=new JavaCompilerHelper();
  javaCompilerHelper.compile(tmpDir.getAbsolutePath(),new JavaCompilerHelper.JavaSourceFromString("com.xxx.udf1.TestUDF1",udf1Src),new JavaCompilerHelper.JavaSourceFromString("com.xxx.udf2.TestUDF2",udf2Src));
  String jarName="TestUDFJar.jar";
  String jarFile=tmpDir.getAbsolutePath() + FILE_SEPARATOR + jarName;
  int status=Util.executeJavaCommand("jar -cf " + jarFile + " -C "+ tmpDir.getAbsolutePath()+ " "+ "com");
  assertEquals(0,status);
  Util.resetStateForExecModeSwitch();
  PigContext localPigContext=new PigContext(cluster.getExecType(),properties);
  localPigContext.getProperties().setProperty("pig.additional.jars",jarFile);
  PigServer pigServer=new PigServer(localPigContext);
  PigContext.initializeImportList("com.xxx.udf1:com.xxx.udf2.");
  ArrayList<String> importList=PigContext.getPackageImportList();
  assertEquals(6,importList.size());
  assertEquals("",importList.get(0));
  assertEquals("com.xxx.udf1.",importList.get(1));
  assertEquals("com.xxx.udf2.",importList.get(2));
  assertEquals("java.lang.",importList.get(3));
  assertEquals("org.apache.pig.builtin.",importList.get(4));
  assertEquals("org.apache.pig.impl.builtin.",importList.get(5));
  Object udf=PigContext.instantiateFuncFromSpec("TestUDF1");
  assertTrue(udf.getClass().toString().endsWith("com.xxx.udf1.TestUDF1"));
  int LOOP_COUNT=40;
  File tmpFile=File.createTempFile("test","txt");
  tmpFile.delete();
  String clusterTmpPath=Util.removeColon(tmpFile.getCanonicalPath());
  String localInput[]=new String[LOOP_COUNT];
  Random r=new Random(1);
  int rand;
  for (int i=0; i < LOOP_COUNT; i++) {
    rand=r.nextInt(100);
    localInput[i]=Integer.toString(rand);
  }
  Util.createInputFile(cluster,clusterTmpPath,localInput);
  FileLocalizer.deleteTempFiles();
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(clusterTmpPath) + "' using TestUDF2() AS (num:chararray);");
  pigServer.registerQuery("B = foreach A generate TestUDF1(num);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue("No Output received",iter.hasNext());
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertTrue(t.get(0) instanceof Integer);
    assertEquals(Integer.valueOf(1),(Integer)t.get(0));
  }
  Util.deleteFile(cluster,clusterTmpPath);
  Util.deleteDirectory(tmpDir);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigRunner </h4><pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleTest2() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 == 3;");
  w.println("C = limit B 1;");
  w.println("dump C;");
  w.close();
  try {
    String[] args={"-Dstop.on.failure=true","-Dopt.multiquery=false","-Daggregate.warning=false","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (execType.toString().startsWith("tez")) {
      assertEquals(1,stats.getNumberJobs());
      assertEquals(stats.getJobGraph().size(),1);
    }
 else {
      assertEquals(2,stats.getNumberJobs());
      assertEquals(stats.getJobGraph().size(),2);
    }
    Configuration conf=ConfigurationUtil.toConfiguration(stats.getPigProperties());
    assertTrue(conf.getBoolean("stop.on.failure",false));
    assertTrue(!conf.getBoolean("aggregate.warning",true));
    assertTrue(!conf.getBoolean(PigConfiguration.PIG_OPT_MULTIQUERY,true));
    assertTrue(conf.getBoolean("opt.fetch",true));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisablePigCounters2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 > 3;");
  w1.println("store A into 'output';");
  w1.println("store B into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-Dpig.disable.counter=true","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    if (execType.equals("tez")) {
      assertEquals(outputs.get(0).getNumberRecords(),5);
      assertEquals(outputs.get(1).getNumberRecords(),2);
    }
 else {
      for (      OutputStats outstats : outputs) {
        assertEquals(-1,outstats.getNumberRecords());
      }
    }
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(1,inputs.size());
    InputStats instats=inputs.get(0);
    assertEquals(5,instats.getNumberRecords());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFileCounter2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 < 0;");
  w1.println("store A into '" + OUTPUT_FILE + "';");
  w1.println("store B into 'output2';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    for (    OutputStats outstats : outputs) {
      if (outstats.getLocation().endsWith("output2")) {
        assertEquals(0,outstats.getNumberRecords());
      }
 else {
        assertEquals(5,outstats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"output2");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-20 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void streamNegativeTest() throws Exception {
  Assume.assumeTrue("Skip this test for TEZ temporarily as it hangs",Util.isMapredExecType(cluster.getExecType()));
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = foreach A generate 1;");
  w.println("C = foreach A generate 0/0;");
  w.println("store B into '" + OUTPUT_FILE + "';");
  w.println("store C into '" + OUTPUT_FILE_2 + "';");
  w.println("D = load '" + OUTPUT_FILE_2 + "';");
  w.println("E = stream D through `false`;");
  w.println("store E into 'ee';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(!stats.isSuccessful());
    if (execType.equals("tez")) {
      assertTrue(stats.getReturnCode() == ReturnCode.FAILURE);
      assertTrue(stats.getJobGraph().size() == 1);
      JobStats job=(JobStats)stats.getJobGraph().getSinks().get(0);
      assertTrue(!job.isSuccessful());
      assertTrue(stats.getOutputStats().size() == 3);
      for (      OutputStats output : stats.getOutputStats()) {
        assertTrue(!output.isSuccessful());
      }
    }
 else {
      assertTrue(stats.getReturnCode() == ReturnCode.PARTIAL_FAILURE);
      assertTrue(stats.getJobGraph().size() == 2);
      JobStats job=(JobStats)stats.getJobGraph().getSources().get(0);
      assertTrue(job.isSuccessful());
      job=(JobStats)stats.getJobGraph().getSinks().get(0);
      assertTrue(!job.isSuccessful());
      assertTrue(stats.getOutputStats().size() == 3);
      for (      OutputStats output : stats.getOutputStats()) {
        if (output.getName().equals("ee")) {
          assertTrue(!output.isSuccessful());
        }
 else {
          assertTrue(output.isSuccessful());
        }
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = group A by a0;");
  w.println("C = foreach B generate group, COUNT(A);");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-Dstop.on.failure=true","-Dopt.multiquery=false","-Dopt.fetch=false","-Daggregate.warning=false","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    String name=stats.getOutputNames().get(0);
    assertEquals(OUTPUT_FILE,name);
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
    Configuration conf=ConfigurationUtil.toConfiguration(stats.getPigProperties());
    assertTrue(conf.getBoolean("stop.on.failure",false));
    assertTrue(!conf.getBoolean("aggregate.warning",true));
    assertTrue(!conf.getBoolean(PigConfiguration.PIG_OPT_MULTIQUERY,true));
    assertTrue(!conf.getBoolean("opt.fetch",true));
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertTrue(stats.getJobGraph().size() == 1);
    final int numOfRecords=5;
    final int numOfCharsPerRecord=6;
    assertEquals(numOfRecords,stats.getRecordWritten());
    assertEquals(numOfRecords * numOfCharsPerRecord,stats.getBytesWritten());
    assertTrue(stats.getOutputNames().size() == 2);
    for (    String fname : stats.getOutputNames()) {
      assertTrue(fname.equals(OUTPUT_FILE) || fname.equals(OUTPUT_FILE_2));
      if (fname.equals(OUTPUT_FILE)) {
        assertEquals(3,stats.getNumberRecords(fname));
      }
 else {
        assertEquals(2,stats.getNumberRecords(fname));
      }
    }
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFileCounter() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.close();
  Util.copyFromLocalToCluster(cluster,"myinputfile","1.txt");
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '1.txt' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      if (instats.getLocation().endsWith("1.txt")) {
        assertEquals(0,instats.getNumberRecords());
      }
 else {
        assertEquals(5,instats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisablePigCounters() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-Dpig.disable.counter=true","-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    if (execType.equals("tez")) {
      assertEquals(5,inputs.get(0).getNumberRecords());
      assertEquals(5,inputs.get(1).getNumberRecords());
    }
 else {
      for (      InputStats instats : inputs) {
        assertEquals(-1,instats.getNumberRecords());
      }
    }
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(1,outputs.size());
    OutputStats outstats=outputs.get(0);
    assertEquals(9,outstats.getNumberRecords());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongCounterName() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.println("1\t2\t3");
  w.println("5\t3\t4");
  w.println("3\t4\t5");
  w.println("5\t6\t7");
  w.println("3\t7\t8");
  w.close();
  String longfilename="longlonglonglonglonglonglonglonglonglonglonglongfilefilefilename";
  Util.copyFromLocalToCluster(cluster,"myinputfile",longfilename);
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + longfilename + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      assertEquals(5,instats.getNumberRecords());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void scriptsInDfsTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = group A by a0;");
  w.println("C = foreach B generate group, COUNT(A);");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  Util.copyFromLocalToCluster(cluster,PIG_FILE,PIG_FILE);
  Path inputInDfs=new Path(cluster.getFileSystem().getHomeDirectory(),PIG_FILE);
  try {
    String[] args={"-x",execType,inputInDfs.toString()};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertTrue(stats.getJobGraph().size() == 1);
    String name=stats.getOutputNames().get(0);
    assertEquals(OUTPUT_FILE,name);
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
    assertEquals("A,B,C",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,PIG_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFile() throws IOException {
  File f1=new File(PIG_FILE);
  FileWriter fw1=new FileWriter(f1);
  fw1.close();
  try {
    String[] args={"-x","local","-c",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    assertEquals(0,stats.getReturnCode());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest3() throws Exception {
  final String INPUT_FILE_2="input2";
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE_2));
  w.println("3\t4\t5");
  w.println("5\t6\t7");
  w.println("3\t7\t8");
  w.close();
  Util.copyFromLocalToCluster(cluster,INPUT_FILE_2,INPUT_FILE_2);
  new File(INPUT_FILE_2).delete();
  w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("A1 = load '" + INPUT_FILE_2 + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 == 3;");
  w.println("C = filter A by a1 <=5;");
  w.println("D = join C by a0, B by a0, A1 by a0 using 'replicated';");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.println("store D into '" + OUTPUT_FILE_2 + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (Util.isMapredExecType(cluster.getExecType())) {
      assertEquals(3,stats.getJobGraph().size());
    }
 else {
      assertEquals(1,stats.getJobGraph().size());
    }
    final int numOfRecords1=3;
    final int numOfRecords2=4;
    final int numOfBytesWritten1=18;
    final int numOfBytesWritten2=72;
    assertEquals(numOfRecords1 + numOfRecords2,stats.getRecordWritten());
    assertEquals(numOfBytesWritten1 + numOfBytesWritten2,stats.getBytesWritten());
    List<String> outputNames=new ArrayList<String>(stats.getOutputNames());
    assertTrue(outputNames.size() == 2);
    Collections.sort(outputNames);
    assertEquals(OUTPUT_FILE,outputNames.get(0));
    assertEquals(OUTPUT_FILE_2,outputNames.get(1));
    assertEquals(3,stats.getNumberRecords(OUTPUT_FILE));
    assertEquals(4,stats.getNumberRecords(OUTPUT_FILE_2));
    List<InputStats> inputStats=new ArrayList<InputStats>(stats.getInputStats());
    assertTrue(inputStats.size() == 2);
    Collections.sort(inputStats,new Comparator<InputStats>(){
      @Override public int compare(      InputStats o1,      InputStats o2){
        return o1.getLocation().compareTo(o2.getLocation());
      }
    }
);
    assertEquals(5,inputStats.get(0).getNumberRecords());
    assertEquals(3,inputStats.get(1).getNumberRecords());
    if (!Util.isMapredExecType(cluster.getExecType())) {
      assertEquals(30,inputStats.get(0).getBytes());
      assertEquals(18,inputStats.get(1).getBytes());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,INPUT_FILE_2);
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleMultiQueryTest2() throws Exception {
  final String OUTPUT_FILE_2="output2";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = filter A by a0 >= 4;");
  w.println("C = filter A by a0 < 4;");
  w.println("D = group C by a0;");
  w.println("E = foreach D generate group, COUNT(C);");
  w.println("store B into '" + OUTPUT_FILE_2 + "';");
  w.println("store E into '" + OUTPUT_FILE + "';");
  w.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(stats.getJobGraph().size(),1);
    final int numOfRecords1=2;
    final int numOfRecords2=2;
    final int numOfCharsPerRecord1=6;
    final int numOfCharsPerRecord2=4;
    assertEquals(numOfRecords1 + numOfRecords2,stats.getRecordWritten());
    assertEquals((numOfRecords1 * numOfCharsPerRecord1) + (numOfRecords2 * numOfCharsPerRecord2),stats.getBytesWritten());
    assertTrue(stats.getOutputNames().size() == 2);
    for (    String fname : stats.getOutputNames()) {
      assertTrue(fname.equals(OUTPUT_FILE) || fname.equals(OUTPUT_FILE_2));
      if (fname.equals(OUTPUT_FILE)) {
        assertEquals(2,stats.getNumberRecords(fname));
      }
 else {
        assertEquals(2,stats.getNumberRecords(fname));
      }
    }
    assertEquals("A,B,C,D,E",((JobStats)stats.getJobGraph().getSinks().get(0)).getAlias());
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,OUTPUT_FILE_2);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleNegativeTest3() throws Exception {
  String[] args={"-x",execType,"-c","-y"};
  PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
  assertTrue(stats.getReturnCode() == ReturnCode.PARSE_EXCEPTION);
  assertEquals("Found unknown option (-y) at position 4",stats.getErrorMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterExternalJar() throws Exception {
  String jarName=Util.findPigJarName();
  String[] args={"-Dpig.additional.jars=" + jarName,"-Dmapred.job.queue.name=default","-x",execType,"-e","A = load '" + INPUT_FILE + "';store A into '"+ OUTPUT_FILE+ "';\n"};
  PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
  Util.deleteFile(cluster,OUTPUT_FILE);
  PigContext ctx=stats.getPigContext();
  assertNotNull(ctx);
  assertTrue(ctx.extraJars.contains(ClassLoader.getSystemResource(jarName)));
  assertTrue("default",ctx.getProperties().getProperty(MRConfiguration.JOB_QUEUE_NAME) != null && ctx.getProperties().getProperty(MRConfiguration.JOB_QUEUE_NAME).equals("default") || ctx.getProperties().getProperty("mapreduce.job.queuename") != null && ctx.getProperties().getProperty("mapreduce.job.queuename").equals("default"));
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCounterName2() throws Exception {
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = filter A by a0 > 3;");
  w1.println("store A into 'output';");
  w1.println("store B into 'tmp/output';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<OutputStats> outputs=stats.getOutputStats();
    assertEquals(2,outputs.size());
    for (    OutputStats outstats : outputs) {
      if (outstats.getLocation().endsWith("tmp/output")) {
        assertEquals(2,outstats.getNumberRecords());
      }
 else {
        assertEquals(5,outstats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
    Util.deleteFile(cluster,"tmp/output");
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void orderByTest() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w.println("B = order A by a0;");
  w.println("C = limit B 2;");
  w.println("store C into '" + OUTPUT_FILE + "';");
  w.close();
  String[] args={"-x",execType,PIG_FILE};
  try {
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    if (execType.equals("tez")) {
      assertEquals(stats.getJobGraph().size(),1);
      assertEquals(stats.getJobGraph().getSources().get(0).getPlan().size(),5);
    }
 else {
      assertEquals(stats.getJobGraph().size(),4);
    }
    assertTrue(stats.getJobGraph().getSinks().size() == 1);
    assertTrue(stats.getJobGraph().getSources().size() == 1);
    JobStats js=(JobStats)stats.getJobGraph().getSinks().get(0);
    assertEquals(OUTPUT_FILE,js.getOutputs().get(0).getName());
    assertEquals(2,js.getOutputs().get(0).getNumberRecords());
    assertEquals(12,js.getOutputs().get(0).getBytes());
    assertEquals(OUTPUT_FILE,stats.getOutputNames().get(0));
    assertEquals(2,stats.getRecordWritten());
    assertEquals(12,stats.getBytesWritten());
    if (execType.equals("tez")) {
      assertEquals("A,B",((JobStats)stats.getJobGraph().getSources().get(0)).getAlias());
    }
 else {
      assertEquals("A",((JobStats)stats.getJobGraph().getSources().get(0)).getAlias());
      assertEquals("B",((JobStats)stats.getJobGraph().getPredecessors(js).get(0)).getAlias());
      assertEquals("B",js.getAlias());
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateCounterName() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("myinputfile"));
  w.println("1\t2\t3");
  w.println("5\t3\t4");
  w.close();
  String samefilename="tmp/input";
  Util.copyFromLocalToCluster(cluster,"myinputfile",samefilename);
  PrintWriter w1=new PrintWriter(new FileWriter(PIG_FILE));
  w1.println("A = load '" + INPUT_FILE + "' as (a0:int, a1:int, a2:int);");
  w1.println("B = load '" + samefilename + "' as (a0:int, a1:int, a2:int);");
  w1.println("C = join A by a0, B by a0;");
  w1.println("store C into '" + OUTPUT_FILE + "';");
  w1.close();
  try {
    String[] args={"-x",execType,PIG_FILE};
    PigStats stats=PigRunner.run(args,new TestNotificationListener(execType));
    assertTrue(stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    List<InputStats> inputs=stats.getInputStats();
    assertEquals(2,inputs.size());
    for (    InputStats instats : inputs) {
      if (instats.getLocation().endsWith("tmp/input")) {
        assertEquals(2,instats.getNumberRecords());
      }
 else {
        assertEquals(5,instats.getNumberRecords());
      }
    }
  }
  finally {
    new File(PIG_FILE).delete();
    Util.deleteFile(cluster,OUTPUT_FILE);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigScriptParser </h4><pre class="type-4 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testErrorMessageUndefinedAliasInGroupByStatement() throws Exception {
  String queryA="A = load 'nosuchfile'  using PigStorage() as (f1:chararray,f2:chararray);";
  String queryB="B = GROUP B by f1;";
  PigServer ps=new PigServer(ExecType.LOCAL);
  ps.registerQuery(queryA);
  try {
    ps.registerQuery(queryB);
  }
 catch (  FrontendException e) {
    assertTrue(e.getMessage().contains("Undefined alias:"));
    throw e;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServer </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescribeForeachFail() throws Throwable {
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (field1: int, field2: float, field3: chararray );");
  pig.registerQuery("b = foreach a generate field1 + 10;");
  try {
    pig.dumpSchema("c");
    fail("Error expected");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Unable to describe schema for alias c"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigTempDir() throws Throwable {
  Properties properties=PropertiesUtil.loadDefaultProperties();
  File pigTempDir=new File(tempDir,FILE_SEPARATOR + "tmp" + FILE_SEPARATOR+ "test");
  properties.put("pig.temp.dir",pigTempDir.getPath());
  PigContext pigContext=new PigContext(ExecType.LOCAL,properties);
  pigContext.connect();
  FileLocalizer.setInitialized(false);
  String tempPath=FileLocalizer.getTemporaryPath(pigContext).toString();
  Path path=new Path(tempPath);
  assertTrue(tempPath.startsWith(pigTempDir.toURI().toString()));
  FileSystem fs=FileSystem.get(path.toUri(),ConfigurationUtil.toConfiguration(pigContext.getProperties()));
  FileStatus status=fs.getFileStatus(path.getParent());
  assertEquals("rwx------",status.getPermission().toString());
  pigTempDir.delete();
  FileLocalizer.setInitialized(false);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterRemoteScript() throws Throwable {
  String scriptName="script.py";
  File scriptFile=File.createTempFile("tmp","");
  PrintWriter pw=new PrintWriter(new FileWriter(scriptFile));
  pw.println("@outputSchema(\"word:chararray\")\ndef helloworld():\n    return 'Hello, World'");
  pw.close();
  FileSystem fs=cluster.getFileSystem();
  fs.copyFromLocalFile(new Path(scriptFile.getAbsolutePath()),new Path(scriptName));
  String absPath=fs.getFileStatus(new Path(scriptName)).getPath().toString();
  Util.createInputFile(cluster,"testRegisterRemoteScript_input",new String[]{"1","2"});
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerCode(absPath,"jython","pig");
  pig.registerQuery("a = load 'testRegisterRemoteScript_input';");
  pig.registerQuery("b = foreach a generate pig.helloworld($0);");
  Iterator<Tuple> iter=pig.openIterator("b");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertTrue(t.size() > 0);
  assertEquals("Hello, World",t.get(0));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertTrue(t.size() > 0);
  assertEquals("Hello, World",t.get(0));
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExplainXmlComplex() throws Throwable {
  if (cluster.getExecType() != ExecType.MAPREDUCE) {
    return;
  }
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  pig.registerQuery("a = load 'a' as (site: chararray, count: int, itemCounts: bag { itemCountsTuple: tuple (type: chararray, typeCount: int, f: float, m: map[]) } ) ;");
  pig.registerQuery("b = foreach a generate site, count, FLATTEN(itemCounts);");
  pig.registerQuery("c = group b by site;");
  pig.registerQuery("d = foreach c generate FLATTEN($1);");
  pig.registerQuery("e = group d by $2;");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  pig.explain("e","xml",true,false,ps,ps,null,null);
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DocumentBuilderFactory dbFactory=DocumentBuilderFactory.newInstance();
  DocumentBuilder dBuilder=dbFactory.newDocumentBuilder();
  Document doc=dBuilder.parse(bais);
  NodeList logicalPlan=doc.getElementsByTagName("logicalPlan");
  assertEquals(1,logicalPlan.getLength());
  assertTrue(logicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList physicalPlan=doc.getElementsByTagName("physicalPlan");
  assertEquals(1,physicalPlan.getLength());
  assertTrue(physicalPlan.item(0).getTextContent().contains("Not Supported"));
  NodeList loads=doc.getElementsByTagName("POLoad");
  assertEquals(2,loads.getLength());
  boolean sawTempLoad=false;
  boolean sawNonTempLoad=false;
  for (int i=0; i < loads.getLength(); i++) {
    Boolean isTempLoad=null;
    boolean hasAlias=false;
    Node poLoad=loads.item(i);
    NodeList children=poLoad.getChildNodes();
    for (int j=0; j < children.getLength(); j++) {
      Node child=children.item(j);
      if (child.getNodeName().equals("alias")) {
        hasAlias=true;
      }
      if (child.getNodeName().equals("isTmpLoad")) {
        if (child.getTextContent().equals("false")) {
          isTempLoad=false;
        }
 else         if (child.getTextContent().equals("true")) {
          isTempLoad=true;
        }
      }
    }
    if (isTempLoad == null) {
      fail("POLoad elements should have isTmpLoad child node.");
    }
 else     if (isTempLoad && hasAlias) {
      fail("Temp loads should not have aliases");
    }
 else     if (!isTempLoad && !hasAlias) {
      fail("Non temporary loads should be associated with alias.");
    }
    sawTempLoad=sawTempLoad || isTempLoad;
    sawNonTempLoad=sawNonTempLoad || !isTempLoad;
  }
  assertTrue(sawTempLoad && sawNonTempLoad);
}

</code></pre>

<br>
<pre class="type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigProperties() throws Throwable {
  File propertyFile=new File(tempDir,"pig.properties");
  propertyFile.deleteOnExit();
  TestPigServer.registerNewResource(propertyFile.getAbsolutePath());
  File cliPropertyFile=new File("commandLine_pig.properties");
  cliPropertyFile.deleteOnExit();
  TestPigServer.registerNewResource(cliPropertyFile.getAbsolutePath());
  Properties properties=PropertiesUtil.loadDefaultProperties();
  assertEquals("40000000",properties.getProperty("pig.spill.gc.activation.size"));
  assertNull(properties.getProperty("test123"));
  PrintWriter out=new PrintWriter(new FileWriter(propertyFile));
  out.println("test123=properties");
  out.close();
  properties=PropertiesUtil.loadDefaultProperties();
  assertEquals("properties",properties.getProperty("test123"));
  out=new PrintWriter(new FileWriter(cliPropertyFile));
  out.println("test123=cli_properties");
  out.close();
  properties=PropertiesUtil.loadDefaultProperties();
  PropertiesUtil.loadPropertiesFromFile(properties,"commandLine_pig.properties");
  assertEquals("cli_properties",properties.getProperty("test123"));
  propertyFile.delete();
  cliPropertyFile.delete();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Use a resource inside a jar file.
 * Verify that the containing jar file is registered correctly.
 * @throws Exception
 */
@Test public void testRegisterJarResourceInJar() throws Throwable {
  String dir="test_register_jar_res_in_jar";
  String subDir="sub_dir";
  String jarName="TestRegisterJarNonEmpty.jar";
  String className="TestRegisterJar";
  String javaSrc="package " + subDir + "; class "+ className+ " { }";
  (new File(dir + FILE_SEPARATOR + subDir)).mkdirs();
  FileOutputStream outStream=new FileOutputStream(new File(dir + FILE_SEPARATOR + subDir+ FILE_SEPARATOR+ className+ ".java"));
  OutputStreamWriter outWriter=new OutputStreamWriter(outStream);
  outWriter.write(javaSrc);
  outWriter.close();
  int status;
  status=Util.executeJavaCommand("javac " + dir + FILE_SEPARATOR+ subDir+ FILE_SEPARATOR+ className+ ".java");
  assertEquals(0,status);
  (new File(dir + FILE_SEPARATOR + subDir+ FILE_SEPARATOR+ className+ ".java")).delete();
  status=Util.executeJavaCommand("jar -cf " + dir + FILE_SEPARATOR+ jarName+ " "+ "-C "+ dir+ " "+ subDir);
  assertEquals(0,status);
  (new File(dir + FILE_SEPARATOR + subDir+ FILE_SEPARATOR+ className+ ".class")).delete();
  (new File(dir + FILE_SEPARATOR + subDir)).delete();
  registerNewResource(dir + FILE_SEPARATOR + jarName);
  boolean exceptionRaised=false;
  PigServer pig=new PigServer(cluster.getExecType(),properties);
  try {
    pig.registerJar("sub_dir/TestRegisterJar.class");
  }
 catch (  IOException e) {
    exceptionRaised=true;
  }
  assertFalse(exceptionRaised);
  verifyStringContained(pig.getPigContext().extraJars,jarName,true);
  (new File(dir + FILE_SEPARATOR + jarName)).delete();
  (new File(dir)).delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigServerLocal </h4><pre class="type-7 type-8 type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonExistingSecondDirectoryInSkewJoin() throws Exception {
  String script="exists = LOAD 'test/org/apache/pig/test/data/InputFiles/jsTst1.txt' AS (x:chararray, a:long);" + "missing = LOAD '/non/existing/directory' AS (a:long);" + "missing = FOREACH ( GROUP missing BY a ) GENERATE $0 AS a, COUNT_STAR($1);"+ "joined = JOIN exists BY a, missing BY a USING 'skewed';"+ "STORE joined INTO '/tmp/test_out.tsv';";
  PigServer pig=new PigServer(Util.getLocalTestMode());
  if (Util.getLocalTestMode().toString().startsWith("TEZ")) {
    try {
      pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")));
      fail("Expect front exception");
    }
 catch (    Exception ex) {
      Throwable excp=ex;
      assertTrue(excp instanceof FrontendException);
      excp=excp.getCause();
      assertTrue(excp instanceof VisitorException);
      excp=excp.getCause();
      assertTrue(excp instanceof ExecException);
      excp=excp.getCause();
      assertTrue(excp instanceof InvalidInputException);
    }
  }
 else {
    try {
      pig.registerScript(new ByteArrayInputStream(script.getBytes("UTF-8")));
    }
 catch (    Exception ex) {
      fail("Unexpected exception: " + ex);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=RuntimeException.class) public void testLocationStrictCheck() throws Exception {
  Properties properties=PropertiesUtil.loadDefaultProperties();
  properties.setProperty("pig.location.check.strict","true");
  PigServer pigServer=new PigServer(Util.getLocalTestMode(),properties);
  Data data=resetData(pigServer);
  data.set("foo",tuple("a",1,"b"),tuple("b",2,"c"),tuple("c",3,"d"));
  pigServer.registerQuery("A = LOAD 'foo' USING mock.Storage() AS (f1:chararray,f2:int,f3:chararray);");
  pigServer.registerQuery("B = order A by f1,f2,f3 DESC;");
  pigServer.registerQuery("C = order A by f1,f2,f3;");
  pigServer.registerQuery("STORE B INTO 'bar' USING mock.Storage();");
  pigServer.registerQuery("STORE C INTO 'bar' USING mock.Storage();");
  List<Tuple> out=data.get("bar");
  assertEquals(tuple("a",1,"b"),out.get(0));
  assertEquals(tuple("b",2,"c"),out.get(1));
  assertEquals(tuple("c",3,"d"),out.get(2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigSplit </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaWithSplit() throws Exception {
  inputFileName="testSchemaWithSplit-input.txt";
  String[] input={"2","12","42"};
  for (  ExecType execType : execTypes) {
    try {
      setUp(execType);
      createInput(input,execType);
      pigServer.registerQuery("a = load '" + inputFileName + "' as (value:chararray);");
      pigServer.registerQuery("split a into b if value < '20', c if value > '10';");
      pigServer.registerQuery("b1 = order b by value;");
      pigServer.registerQuery("c1 = order c by value;");
      Iterator<Tuple> iter=pigServer.openIterator("b1");
      assertTrue("b1 has an element",iter.hasNext());
      assertEquals("first item in b1","12",iter.next().get(0));
      assertTrue("b1 has an element",iter.hasNext());
      assertEquals("second item in b1","2",iter.next().get(0));
      assertFalse("b1 is over",iter.hasNext());
      iter=pigServer.openIterator("c1");
      assertTrue("c1 has an element",iter.hasNext());
      assertEquals("first item in c1","12",iter.next().get(0));
      assertTrue("c1 has an element",iter.hasNext());
      assertEquals("second item in c1","2",iter.next().get(0));
      assertTrue("c1 has an element",iter.hasNext());
      assertEquals("third item in c1","42",iter.next().get(0));
      assertFalse("c1 is over",iter.hasNext());
    }
  finally {
      tearDown(execType);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStats </h4><pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBytesWritten_JIRA_1027() throws Exception {
  File outputFile=null;
  try {
    String fileName=this.getClass().getName() + "_" + "testBytesWritten_JIRA_1027";
    outputFile=File.createTempFile(fileName,".out");
    String filePath=outputFile.getAbsolutePath();
    outputFile.delete();
    PigServer pig=new PigServer(Util.getLocalTestMode());
    pig.registerQuery("A = load 'test/org/apache/pig/test/data/passwd';");
    ExecJob job=pig.store("A",filePath);
    PigStats stats=job.getStatistics();
    File dataFile=Util.getFirstPartFile(outputFile);
    assertEquals(dataFile.length(),stats.getBytesWritten());
  }
 catch (  IOException e) {
    LOG.error("Error while generating file",e);
    fail("Encountered IOException");
  }
 finally {
    if (outputFile != null) {
      deleteDirectory(outputFile);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStatsMR </h4><pre class="type-7 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testBytesWritten_JIRA_1027() throws Exception {
  FileLocalizer.setInitialized(false);
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster();
  try {
    String filePath="/tmp/" + this.getClass().getName() + "_"+ "testBytesWritten_JIRA_1027";
    PigServer pig=new PigServer(cluster.getExecType(),cluster.getProperties());
    String inputFile="test/org/apache/pig/test/data/passwd";
    Util.copyFromLocalToCluster(cluster,inputFile,inputFile);
    pig.registerQuery("A = load '" + inputFile + "';");
    ExecJob job=pig.store("A",filePath);
    PigStats stats=job.getStatistics();
    Path dataFile=Util.getFirstPartFile(new Path(filePath));
    FileStatus fs=cluster.getFileSystem().getFileStatus(dataFile);
    assertEquals(fs.getLen(),stats.getBytesWritten());
  }
 catch (  IOException e) {
    LOG.error("Error while generating file",e);
    fail("Encountered IOException");
  }
 finally {
    FileLocalizer.setInitialized(false);
    cluster.shutDown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigStorage </h4><pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaConversion2() throws Exception {
  pig.registerQuery("A = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (f1:chararray, f2:int);");
  pig.registerQuery("B = group A by f1;");
  Schema origSchema=pig.dumpSchema("B");
  ResourceSchema rs1=new ResourceSchema(origSchema);
  pig.registerQuery("STORE B into '" + datadir + "cout' using PigStorage('\\t', '-schema');");
  pig.registerQuery("C = LOAD '" + datadir + "cout' using PigStorage('\\t', '-schema');");
  Schema genSchema=pig.dumpSchema("C");
  ResourceSchema rs2=new ResourceSchema(genSchema);
  Assert.assertTrue("generated schema equals original",ResourceSchema.equals(rs1,rs2));
  pig.registerQuery("C1 = LOAD '" + datadir + "cout' as (a0:chararray, A: {t: (f1:chararray, f2:int) } );");
  pig.registerQuery("D = foreach C1 generate a0, SUM(A.f2);");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"('A',23L)","('B',7L)","('C',11L)","('D',10L)"});
  Iterator<Tuple> iter=pig.openIterator("D");
  int counter=0;
  while (iter.hasNext()) {
    Assert.assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  Assert.assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncompleteDataWithPigSchema() throws Exception {
  File parent=new File(datadir,"incomplete_data_with_pig_schema_1");
  parent.deleteOnExit();
  parent.mkdirs();
  File tmpInput=File.createTempFile("tmp","tmp");
  tmpInput.deleteOnExit();
  File outFile=new File(parent,"out");
  pig.registerQuery("a = load '" + Util.encodeEscape(tmpInput.getAbsolutePath()) + "' as (x:int, y:chararray, z:chararray);");
  pig.store("a",outFile.getAbsolutePath(),"PigStorage('\\t', '-schema')");
  File schemaFile=new File(outFile,".pig_schema");
  parent=new File(datadir,"incomplete_data_with_pig_schema_2");
  parent.deleteOnExit();
  File inputDir=new File(parent,"input");
  inputDir.mkdirs();
  File inputSchemaFile=new File(inputDir,".pig_schema");
  FileUtils.moveFile(schemaFile,inputSchemaFile);
  File inputFile=new File(inputDir,"data");
  Util.writeToFile(inputFile,new String[]{"1"});
  pig.registerQuery("a = load '" + Util.encodeEscape(inputDir.getAbsolutePath()) + "';");
  Iterator<Tuple> it=pig.openIterator("a");
  assertTrue(it.hasNext());
  assertEquals(tuple(1,null,null),it.next());
  assertFalse(it.hasNext());
  pig.registerQuery("a = load '" + Util.encodeEscape(inputDir.getAbsolutePath()) + "'; b = foreach a generate y, z;");
  it=pig.openIterator("b");
  assertTrue(it.hasNext());
  assertEquals(tuple(null,null),it.next());
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageSchema() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage('\\t') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  Schema origSchema=pig.dumpSchema("a");
  pig.store("a",datadir + "aout","PigStorage('\\t', '-schema')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t');");
  Schema genSchema=pig.dumpSchema("b");
  Assert.assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
  String[] aliases={"foo","bar"};
  byte[] types={DataType.INTEGER,DataType.LONG};
  Schema newSchema=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  pig.registerQuery("c = LOAD '" + datadir + "aout' using PigStorage('\\t', '-schema') "+ "as (foo:int, bar:long);");
  Schema newGenSchema=pig.dumpSchema("c");
  Assert.assertTrue("explicit schema overrides metadata",Schema.equals(newSchema,newGenSchema,true,false));
  pig.registerQuery("d = LOAD '" + datadir + "aout' using PigStorage('\\t', '-noschema');");
  genSchema=pig.dumpSchema("d");
  assertNull(genSchema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This is for testing source tagging option on PigStorage. When a user
 * specifies '-tagFile' as an option, PigStorage must prepend the input
 * source path to the tuple and "INPUT_FILE_NAME" to schema.
 * @throws Exception
 */
@Test public void testPigStorageSourceTagSchema() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage('\\t') "+ "as (f1:chararray, f2:int);";
  pig.registerQuery(query);
  pig.store("a",datadir + "aout","PigStorage('\\t', '-schema')");
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagFile');");
  Schema genSchema=pig.dumpSchema("b");
  String[] fileAliases={"INPUT_FILE_NAME","f1","f2"};
  byte[] fileTypes={DataType.CHARARRAY,DataType.CHARARRAY,DataType.INTEGER};
  Schema newSchema=TypeCheckingTestUtil.genFlatSchema(fileAliases,fileTypes);
  Assert.assertTrue("schema with -tagFile preprends INPUT_FILE_NAME",Schema.equals(newSchema,genSchema,true,false));
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagPath');");
  genSchema=pig.dumpSchema("b");
  String[] pathAliases={"INPUT_FILE_PATH","f1","f2"};
  byte[] pathTypes={DataType.CHARARRAY,DataType.CHARARRAY,DataType.INTEGER};
  newSchema=TypeCheckingTestUtil.genFlatSchema(pathAliases,pathTypes);
  Assert.assertTrue("schema with -tagPath preprends INPUT_FILE_PATH",Schema.equals(newSchema,genSchema,true,false));
  pig.registerQuery("d = LOAD '" + datadir + "aout' using PigStorage('\\t', '-noschema');");
  genSchema=pig.dumpSchema("d");
  assertNull(genSchema);
  pig.registerQuery("b = LOAD '" + datadir + "aout' using PigStorage('\\t', '-tagFile') "+ "as (input_file:chararray, foo:chararray, bar:int);");
  genSchema=pig.dumpSchema("b");
  String[] newAliases={"input_file","foo","bar"};
  byte[] newTypes={DataType.CHARARRAY,DataType.CHARARRAY,DataType.INTEGER};
  newSchema=TypeCheckingTestUtil.genFlatSchema(newAliases,newTypes);
  Assert.assertTrue("explicit schema overrides metadata",Schema.equals(newSchema,genSchema,true,false));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageNoSchema() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage('\\t', '-schema') "+ "as (f1:chararray, f2:int);";
  try {
    pig.registerQuery(query);
    pig.dumpSchema("a");
  }
 catch (  FrontendException ex) {
    assertEquals(ex.toString(),1000,ex.getErrorCode());
    return;
  }
  fail("no exception caught");
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBlockBoundary() throws ExecException {
  MiniGenericCluster cluster=MiniGenericCluster.buildCluster();
  Properties properties=cluster.getProperties();
  Properties props=new Properties();
  for (  Entry<Object,Object> entry : properties.entrySet()) {
    props.put(entry.getKey(),entry.getValue());
  }
  props.setProperty(MRConfiguration.MAX_SPLIT_SIZE,"20");
  Util.resetStateForExecModeSwitch();
  PigServer pigServer=new PigServer(cluster.getExecType(),props);
  String[] inputs={"abcdefgh1","abcdefgh2","abcdefgh3","abcdefgh4","abcdefgh5","abcdefgh6","abcdefgh7","abcdefgh8","abcdefgh9"};
  String[] expected={"(abcdefgh1)","(abcdefgh2)","(abcdefgh3)","(abcdefgh4)","(abcdefgh5)","(abcdefgh6)","(abcdefgh7)","(abcdefgh8)","(abcdefgh9)"};
  System.setProperty("pig.overrideBlockSize","20");
  String INPUT_FILE="tmp.txt";
  try {
    PrintWriter w=new PrintWriter(new FileWriter(INPUT_FILE));
    for (    String s : inputs) {
      w.println(s);
    }
    w.close();
    Util.copyFromLocalToCluster(cluster,INPUT_FILE,INPUT_FILE);
    pigServer.registerQuery("a = load '" + INPUT_FILE + "';");
    Iterator<Tuple> iter=pigServer.openIterator("a");
    int counter=0;
    while (iter.hasNext()) {
      assertEquals(expected[counter++].toString(),iter.next().toString());
    }
    assertEquals(expected.length,counter);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail();
  }
 finally {
    new File(INPUT_FILE).delete();
    try {
      Util.deleteFile(cluster,INPUT_FILE);
    }
 catch (    IOException e) {
      e.printStackTrace();
      Assert.fail();
    }
    cluster.shutDown();
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageSchemaHeaderDelimiter() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (foo:chararray, bar:int);";
  pig.registerQuery(query);
  pig.registerQuery("STORE a into '" + datadir + "dout' using PigStorage('#', '-schema');");
  pig.registerQuery("STORE a into '" + datadir + "eout' using PigStorage('\\t', '-schema');");
  String outPath=FileLocalizer.fullPath(datadir + "dout/.pig_header",pig.getPigContext());
  Assert.assertTrue(FileLocalizer.fileExists(outPath,pig.getPigContext()));
  String[] header=Util.readOutput(pig.getPigContext(),outPath);
  Assert.assertArrayEquals("Headers are not the same.",new String[]{"foo#bar"},header);
  outPath=FileLocalizer.fullPath(datadir + "eout/.pig_header",pig.getPigContext());
  Assert.assertTrue(FileLocalizer.fileExists(outPath,pig.getPigContext()));
  header=Util.readOutput(pig.getPigContext(),outPath);
  Assert.assertArrayEquals("Headers are not the same.",new String[]{"foo\tbar"},header);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigStorageSchemaHeader() throws Exception {
  pigContext.connect();
  String query="a = LOAD '" + datadir + "originput' using PigStorage(',') "+ "as (foo:chararray, bar:int);";
  pig.registerQuery(query);
  pig.registerQuery("a2 = FOREACH a GENERATE *, 1;");
  pig.registerQuery("STORE a2 into '" + datadir + "nout' using PigStorage('\\t', '-schema');");
  String outPath=FileLocalizer.fullPath(datadir + "nout/.pig_header",pig.getPigContext());
  Assert.assertTrue(FileLocalizer.fileExists(outPath,pig.getPigContext()));
  String[] header=Util.readOutput(pig.getPigContext(),outPath);
  Assert.assertArrayEquals("Headers are not the same.",new String[]{"foo\tbar\t$2"},header);
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaConversion() throws Exception {
  Util.createLocalInputFile(datadir + "originput2",new String[]{"1","2","3","2","5","5","8","8","8","9"});
  pig.registerQuery("A = LOAD '" + datadir + "originput2' using PigStorage('\\t') "+ "as (f:int);");
  pig.registerQuery("B = group A by f;");
  Schema origSchema=pig.dumpSchema("B");
  ResourceSchema rs1=new ResourceSchema(origSchema);
  pig.registerQuery("STORE B into '" + datadir + "bout' using PigStorage('\\t', '-schema');");
  pig.registerQuery("C = LOAD '" + datadir + "bout' using PigStorage('\\t', '-schema');");
  Schema genSchema=pig.dumpSchema("C");
  ResourceSchema rs2=new ResourceSchema(genSchema);
  Assert.assertTrue("generated schema equals original",ResourceSchema.equals(rs1,rs2));
  pig.registerQuery("C1 = LOAD '" + datadir + "bout' as (a0:int, A: {t: (f:int) } );");
  pig.registerQuery("D = foreach C1 generate a0, SUM(A);");
  List<Tuple> expectedResults=Util.getTuplesFromConstantTupleStrings(new String[]{"(1,1L)","(2,4L)","(3,3L)","(5,10L)","(8,24L)","(9,9L)"});
  Iterator<Tuple> iter=pig.openIterator("D");
  int counter=0;
  while (iter.hasNext()) {
    Assert.assertEquals(expectedResults.get(counter++).toString(),iter.next().toString());
  }
  Assert.assertEquals(expectedResults.size(),counter);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to verify that PigStorage works fine in the following scenario:
 * The column prune optimization determines only columns 2 and 3 are needed
 * and there are records in the data which have only 1 column (malformed data).
 * In this case, PigStorage should return an empty tuple to represent columns
 * 2 and 3 and {@link POProject} would handle catching any{@link IndexOutOfBoundsException} resulting from accessing a field in the
 * tuple and substitute a null.
 */
@Test public void testPruneColumnsWithMissingFields() throws IOException {
  String inputFileName="TestPigStorage-testPruneColumnsWithMissingFields-input.txt";
  Util.createLocalInputFile(inputFileName,new String[]{"1\t2\t3","4","5\t6\t7"});
  String script="a = load '" + inputFileName + "' as (i:int, j:int, k:int);"+ "b = foreach a generate j, k;";
  Util.registerMultiLineQuery(pig,script);
  Iterator<Tuple> it=pig.openIterator("b");
  assertEquals(Util.createTuple(new Integer[]{2,3}),it.next());
  assertEquals(Util.createTuple(new Integer[]{null,null}),it.next());
  assertEquals(Util.createTuple(new Integer[]{6,7}),it.next());
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPigTupleRawComparator </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareMap() throws IOException {
  list=new ArrayList(list);
  list.add(Collections.singletonMap("pig","scalability"));
  NullableTuple t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,Collections.singletonMap("pig","scalability"));
  NullableTuple t2=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res == 0);
  list.set(list.size() - 1,Collections.singletonMap("pigg","scalability"));
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
  list.set(list.size() - 1,Collections.singletonMap("pig","Scalability"));
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res > 0);
  list.set(list.size() - 1,Collections.singletonMap("pii","scalability"));
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
  list.add(107);
  t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,108);
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortOrder() throws IOException {
  list.set(2,(Double)list.get(2) + 0.1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  JobConf jobConf=new JobConf();
  jobConf.set("pig.sortOrder",ObjectSerializer.serialize(new boolean[]{false}));
  comparator.setConf(jobConf);
  int res=compareHelper(prototype,t,comparator);
  assertEquals(-1 * Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  jobConf.set("pig.sortOrder",ObjectSerializer.serialize(new boolean[]{true,true,false,true,true,true,true,true,true}));
  comparator.setConf(jobConf);
  res=compareHelper(prototype,t,comparator);
  assertEquals(-1 * Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareEquals() throws IOException {
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res == 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareFloat() throws IOException {
  list.set(0,(Float)list.get(0) - 1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDateTime() throws IOException {
  list.set(9,((DateTime)list.get(9)).plus(1L));
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDataBag() throws IOException {
  list=new ArrayList(list);
  list.add(new DefaultDataBag(Arrays.asList(tf.newTuple(Arrays.asList(0)))));
  NullableTuple t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,new DefaultDataBag(Arrays.asList(tf.newTuple(Arrays.asList(1)))));
  NullableTuple t2=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
  DataBag largeBag=createLargeBag(200,tf);
  t2=new NullableTuple(tf.newTuple(largeBag));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  largeBag=createLargeBag(3000,tf);
  t2=new NullableTuple(tf.newTuple(largeBag));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareBoolean() throws IOException {
  list.set(5,false);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDiffertTypes() throws IOException {
  list.set(3,4);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDouble() throws IOException {
  list.set(2,(Double)list.get(2) + 0.1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareCharArray() throws IOException {
  list.set(7,"hello world!");
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res == 0);
  list.set(7,"hello worlc!");
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  String largeTinyString=appendChars("hello worlc!",'x',300);
  list.set(7,largeTinyString);
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  list.set(7,"hello worlz!");
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
  list.set(7,"hello");
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  list.set(7,"hello world!?");
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareByte() throws IOException {
  list.set(4,(Byte)list.get(4) + 1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void compareInnerTuples() throws IOException {
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res == 0);
  list.set(8,tf.newTuple(Arrays.asList(8.0,9f,10l,12)));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
  list.set(8,tf.newTuple(Arrays.asList(8.0,9f,9l,12)));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  list.set(8,tf.newTuple(Arrays.asList(7.0,9f,9l,12)));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  Tuple tinyTuple=createLargeTuple(1,200,tf);
  list.set(8,tinyTuple);
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  Tuple smallTuple=createLargeTuple(1,1000,tf);
  list.set(8,smallTuple);
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  list.set(8,tf.newTuple(Arrays.asList(8l,9f,9l,12)));
  t=new NullableTuple(tf.newTuple(list));
  res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res > 0);
  list=new ArrayList(list);
  list.add(10);
  NullableTuple t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,11);
  NullableTuple t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res < 0);
  list.set(list.size() - 1,tf.newTuple(list));
  t1=new NullableTuple(tf.newTuple(list));
  list.set(list.size() - 1,10);
  list.set(list.size() - 1,tf.newTuple(list));
  t2=new NullableTuple(tf.newTuple(list));
  res=compareHelper(t1,t2,comparator);
  assertEquals(Math.signum(t1.compareTo(t2)),Math.signum(res),0);
  assertTrue(res > 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareDifferentSizes() throws IOException {
  list=new ArrayList(list);
  list.add(new DefaultDataBag());
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareInt() throws IOException {
  list.set(1,(Integer)list.get(1) + 1);
  NullableTuple t=new NullableTuple(tf.newTuple(list));
  int res=compareHelper(prototype,t,comparator);
  assertEquals(Math.signum(prototype.compareTo(t)),Math.signum(res),0);
  assertTrue(res < 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPinOptions </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotPinnedJinOption() throws Exception {
  pigServer.setBatchOn();
  pigServer.registerQuery("a = load 'tmp1' as (foo, bar);");
  pigServer.registerQuery("b = load 'tmp1' as (foo, bar);");
  pigServer.registerQuery("c = join a by foo, b by foo;");
  pigServer.registerQuery("store c into 'tmp2';");
  LOJoin op=(LOJoin)TestPigStats.getLogicalPlan(pigServer).findByAlias("c");
  assertEquals("default join should be hash",((LOJoin)op).getJoinType().toString(),"HASH");
  assertFalse(op.isPinnedOption(LOJoin.OPTION_JOIN));
  pigServer.discardBatch();
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPinnedJoinOption() throws Exception {
  String[] joinTypes={"hash","repl","merge","skewed","default"};
  String[] expectedJoinTypes={"HASH","REPLICATED","MERGE","SKEWED","HASH"};
  for (int i=0; i < joinTypes.length; i++) {
    pigServer.setBatchOn();
    pigServer.registerQuery("a = load 'tmp1' as (foo, bar);");
    pigServer.registerQuery("b = load 'tmp1' as (foo, bar);");
    pigServer.registerQuery("c = join a by foo, b by foo using '" + joinTypes[i] + "';");
    pigServer.registerQuery("store c into 'tmp2';");
    LOJoin op=(LOJoin)TestPigStats.getLogicalPlan(pigServer).findByAlias("c");
    assertTrue("did " + joinTypes[i] + " join get pinned? ",op.isPinnedOption(LOJoin.OPTION_JOIN));
    assertEquals("did the right join type get set? ",((LOJoin)op).getJoinType().toString(),expectedJoinTypes[i]);
    pigServer.discardBatch();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPlanGeneration </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderByNullFieldSchema() throws Exception {
  String query="A = load 'x';" + "B = order A by *;" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOSort loSort=(LOSort)lp.getPredecessors(loStore).get(0);
  Operator sortPlanLeaf=loSort.getSortColPlans().get(0).getSources().get(0);
  LogicalFieldSchema sortPlanFS=((LogicalExpression)sortPlanLeaf).getFieldSchema();
  assertNull(sortPlanFS);
  PhysicalPlan pp=Util.buildPhysicalPlanFromNewLP(lp,pc);
  POStore poStore=(POStore)pp.getLeaves().get(0);
  POSort poSort=(POSort)pp.getPredecessors(poStore).get(0);
  POProject poProject=(POProject)poSort.getSortPlans().get(0).getLeaves().get(0);
  assertEquals(DataType.TUPLE,poProject.getResultType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyBagInnerPlan() throws Exception {
  String query="A = load 'x' as ( u:bag{} );" + "B = foreach A { B1 = filter u by $1==0; generate B1;};" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOForEach loForEach=(LOForEach)lp.getPredecessors(loStore).get(0);
  LogicalSchema schema=loForEach.getSchema();
  assertEquals(1,schema.size());
  LogicalFieldSchema bagFieldSchema=schema.getField(0);
  assertEquals(DataType.BAG,bagFieldSchema.type);
  LogicalFieldSchema tupleFieldSchema=bagFieldSchema.schema.getField(0);
  assertNull(tupleFieldSchema.schema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupByNullFieldSchema() throws Exception {
  String query="A = load 'x';" + "B = group A by *;" + "store B into '111';";
  LogicalPlan lp=Util.parseAndPreprocess(query,pc);
  Util.optimizeNewLP(lp);
  LOStore loStore=(LOStore)lp.getSinks().get(0);
  LOCogroup loCoGroup=(LOCogroup)lp.getPredecessors(loStore).get(0);
  LogicalFieldSchema groupFieldSchema=loCoGroup.getSchema().getField(0);
  assertEquals(DataType.TUPLE,groupFieldSchema.type);
  assertNull(groupFieldSchema.schema);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionFilterOptimizer() throws Exception {
  String query="a = load 'foo' using " + PartitionedLoader.class.getName() + "('name:chararray, dt:chararray', 'dt');\n"+ "b = filter a by dt=='2011';\n"+ "store b into 'output';";
  LogicalPlan lp=Util.parse(query,pc);
  Util.optimizeNewLP(lp);
  LOLoad loLoad=(LOLoad)lp.getSources().get(0);
  LOStore loStore=(LOStore)lp.getSuccessors(loLoad).get(0);
  assertNotNull(((PartitionedLoader)loLoad.getLoadFunc()).getPartFilter());
  assertEquals("b",loStore.getAlias());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPoissonSampleLoader </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInstantiation() throws IOException {
  pigServer.registerQuery("A = Load '" + INPUT_FILE1 + "' Using PoissonSampleLoader('PigStorage(\\\\\\':\\\\\\')', '100');");
  Iterator<Tuple> iter=pigServer.openIterator("A");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  while (iter.hasNext()) {
    t=iter.next();
  }
  assertEquals(5,t.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestProject </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTuple() throws IOException, ExecException {
  t=tRandom;
  proj.attachInput(t);
  proj.setColumn(0);
  proj.setOverloaded(true);
  DataBag inpBag=(DataBag)t.get(0);
  int cntr=0;
  boolean contains=true;
  while (true) {
    res=proj.getNextTuple();
    if (res.returnStatus == POStatus.STATUS_EOP)     break;
    if (!TestHelper.bagContains(inpBag,(Tuple)res.result)) {
      contains=false;
      break;
    }
    ++cntr;
  }
  assertEquals((float)inpBag.size(),(float)cntr,0.01f);
  assertTrue(contains);
  proj.attachInput(t);
  proj.setColumn(8);
  proj.setOverloaded(false);
  res=proj.getNextTuple();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertEquals(t.get(8),res.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextTupleWithNull() throws IOException, ExecException {
  t=tRandomAndNull;
  proj.attachInput(t);
  proj.setColumn(0);
  proj.setOverloaded(true);
  DataBag inpBag=(DataBag)t.get(0);
  int cntr=0;
  boolean contains=true;
  while (true) {
    res=proj.getNextTuple();
    if (res.returnStatus == POStatus.STATUS_EOP)     break;
    if (!TestHelper.bagContains(inpBag,(Tuple)res.result)) {
      contains=false;
      break;
    }
    ++cntr;
  }
  assertEquals((float)inpBag.size(),(float)cntr,0.01f);
  assertTrue(contains);
  proj.attachInput(t);
  proj.setColumn(8);
  proj.setOverloaded(false);
  res=proj.getNextTuple();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertEquals(t.get(8),res.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestPruneColumn </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2:int);");
  pigServer.registerQuery("B = filter A by a2==3;");
  pigServer.registerQuery("C = foreach B generate $2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(3)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderBy3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = order A by a2;");
  pigServer.registerQuery("C = foreach B generate a2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("(2)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("(3)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:int, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1:int);");
  pigServer.registerQuery("C = cogroup A by $1, B by $1;");
  pigServer.registerQuery("D = foreach C generate AVG($1.$1);");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertNull(t.get(0));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2.0",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("5.0",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for B: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroup9() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (b0, b1, b2);");
  pigServer.registerQuery("C = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (c0, c1, c2);");
  pigServer.registerQuery("D = cogroup A by a2, B by b2, C by c2;");
  pigServer.registerQuery("E = foreach D generate $1, $2;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("({(2,5,2)},{(2,5,2)})",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("({(1,2,3)},{(1,2,3)})",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for C: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = filter A by " + MyFilterFunc.class.getName() + "(*) ;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplex2() throws Exception {
  HashSet<String> optimizerRules=new HashSet<String>();
  optimizerRules.add("PushUpFilter");
  pigServer.getPigContext().getProperties().setProperty(PigImplConstants.PIG_OPTIMIZER_RULES_KEY,ObjectSerializer.serialize(optimizerRules));
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile13.toString(),pigServer.getPigContext()) + "' as (a:int, b:chararray);");
  pigServer.registerQuery("B = FOREACH A generate a;");
  pigServer.registerQuery("C = GROUP B by a;");
  pigServer.registerQuery("D = filter C by group > 0 and group < 100;");
  pigServer.registerQuery("E = FOREACH D {F = LIMIT B 1 ;GENERATE B.a as mya, FLATTEN(F.a) as setting;}");
  pigServer.registerQuery("G = FOREACH E GENERATE mya, setting as setting;");
  Iterator<Tuple> iter=pigServer.openIterator("G");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("({(1)},1)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("({(2),(2)},2)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("({(3),(3),(3)},3)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
  pigServer.getPigContext().getProperties().remove(PigImplConstants.PIG_OPTIMIZER_RULES_KEY);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOutJoin1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile6.toString(),pigServer.getPigContext()) + "' AS (a0:chararray, a1:chararray, a2:chararray);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (a0:chararray, a1:chararray, a2:chararray);");
  pigServer.registerQuery("C = join A by $0 left, B by $0;");
  pigServer.registerQuery("D = foreach C generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Collection<String> results=new HashSet<String>();
  results.add("(2)");
  results.add("()");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2","Columns pruned for B: $1, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDistinct1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile4.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = distinct A;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKey1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:map[]);");
  pigServer.registerQuery("B = foreach A generate a0, a1#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinCond1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile5.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2, a3);");
  pigServer.registerQuery("B = foreach A generate ($1 == '2'? $2 : $3);");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("3",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("5",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEachFlatten() throws Exception {
  File inputFile=Util.createInputFile("table_testForEachFlatten","",new String[]{"oiue\tM\t{(3),(4)}\t{(toronto),(montreal)}"});
  pigServer.registerQuery("A = load '" + Util.encodeEscape(inputFile.toString()) + "' as (a0:chararray, a1:chararray, a2:bag{t:tuple(id:chararray)}, a3:bag{t:tuple(loc:chararray)});");
  pigServer.registerQuery("B = foreach A generate a0, a1, flatten(a2), flatten(a3), 10;");
  pigServer.registerQuery("C = foreach B generate a0, $4;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(oiue,10)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(oiue,10)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(oiue,10)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(oiue,10)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("split A into B if $0<=1, C if $0>1;");
  pigServer.registerQuery("D = foreach B generate $1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectCastKeyLookup() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0, a1);");
  pigServer.registerQuery("B = foreach A generate a1#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0","Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFRJoin1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = join A by $0, B by $0 using 'replicated';");
  pigServer.registerQuery("D = foreach C generate $0, $3;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCogroup8() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = group A by *;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("(1,2,3)",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("(2,5,2)",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderbyWrongSignature() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = order A by a1;");
  pigServer.registerQuery("D = join C by a1, B by b0;");
  pigServer.registerQuery("E = foreach D generate a1, b0, b1;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  assertEquals("(2,2,2)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = filter A by a0+a2 == 4;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKeyInSplit1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile12.toString(),pigServer.getPigContext()) + "' as (m:map[]);");
  pigServer.registerQuery("B = foreach A generate m#'key1' as key1;");
  pigServer.registerQuery("C = foreach A generate m#'key2' as key2;");
  pigServer.registerQuery("D = join B by key1, C by key2;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Map key required for A: $0->[key1, key2]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRelayFlattenMap() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0, a1:map[]);");
  pigServer.registerQuery("B = foreach A generate flatten(a1);");
  pigServer.registerQuery("C = foreach B generate a1#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0","Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInconsistentPruning() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0:chararray, a1:chararray, a2);");
  pigServer.registerQuery("B = foreach A generate CONCAT(a0,a1) as b0, a0, a2;");
  pigServer.registerQuery("C = foreach B generate a0, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(1,3)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(2,2)",t.toString());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("split A into B if $0<=1, C if $0>1;");
  pigServer.registerQuery("D = foreach B generate $1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup7() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = cogroup A by ($1), B by ($1);");
  pigServer.registerQuery("D = foreach C {B = order B by $0;generate FLATTEN(A), B.($1);};");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(4,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertEquals("3",t.get(2).toString());
  assertEquals("{(2)}",t.get(3).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(4,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("5",t.get(1).toString());
  assertEquals("2",t.get(2).toString());
  assertEquals("{}",t.get(3).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEach2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a0 as b0, *;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(4,t.size());
  assertEquals(1,t.get(0));
  assertEquals(1,t.get(1));
  assertEquals(2,t.get(2));
  assertEquals(3,t.get(3));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(4,t.size());
  assertEquals(2,t.get(0));
  assertEquals(2,t.get(1));
  assertEquals(5,t.get(2));
  assertEquals(2,t.get(3));
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadForEach2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a0, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals(3,t.get(1));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals(2,t.get(1));
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = order A by a1;");
  pigServer.registerQuery("C = limit B 10;");
  pigServer.registerQuery("D = foreach C generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("rawtypes") @Test public void testMapKeyInSplit2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile12.toString(),pigServer.getPigContext()) + "' as (m:map[]);");
  pigServer.registerQuery("B = filter A by m#'cond'==1;");
  pigServer.registerQuery("C = filter B by m#'key1'==1;");
  pigServer.registerQuery("D = filter B by m#'key2'==2;");
  pigServer.registerQuery("E = join C by m#'key1', D by m#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",((Map)t.get(0)).get("key1").toString());
  assertEquals("2",((Map)t.get(0)).get("key2").toString());
  assertEquals("1",((Map)t.get(0)).get("cond").toString());
  assertEquals("1",((Map)t.get(1)).get("key1").toString());
  assertEquals("2",((Map)t.get(1)).get("key2").toString());
  assertEquals("1",((Map)t.get(1)).get("cond").toString());
  assertFalse(iter.hasNext());
  assertTrue(this.emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2:int);");
  pigServer.registerQuery("split A into B if a2==3, C if a2<3;");
  pigServer.registerQuery("C = foreach B generate $2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(3)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEach1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a0, a1+a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals(5,t.get(1));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals(7,t.get(1));
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadForEach1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a1, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals(3,t.get(1));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(5,t.get(0));
  assertEquals(2,t.get(1));
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup8() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:int, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1:int);");
  pigServer.registerQuery("C = cogroup A by ($1), B by ($1);");
  pigServer.registerQuery("D = foreach C generate $0, $1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("{}",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("{(1,2,3)}",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("5",t.get(0).toString());
  assertEquals("{(2,5,2)}",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for B: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' as (b0:int, b1:int);");
  pigServer.registerQuery("C = join A by a1, B by b1;");
  pigServer.registerQuery("D = foreach C generate a1, a2, b0, b1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(4,t.size());
  assertEquals(2,t.get(0));
  assertEquals(3,t.get(1));
  assertEquals(2,t.get(2));
  assertEquals(2,t.get(3));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnion1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile4.toString(),pigServer.getPigContext()) + "' AS (b0, b1, b2);");
  pigServer.registerQuery("C = union A, B;");
  pigServer.registerQuery("D = foreach C generate $0, $2;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Collection<String> results=new HashSet<String>();
  results.add("(1,3)");
  results.add("(2,2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  results.contains(t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  results.contains(t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  results.contains(t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  results.contains(t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup5() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = group A by (a0, a1);");
  pigServer.registerQuery("C = foreach B generate flatten(group);");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("5",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a0;");
  pigServer.registerQuery("C = join A by a0, B by a0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(1,2,3,1)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(2,5,2,2)",t.toString());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKey4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:map[]);");
  pigServer.registerQuery("B = limit A 10;");
  pigServer.registerQuery("C = foreach B generate $0, $1#'key1';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinStorage1() throws Exception {
  File intermediateFile=File.createTempFile("intemediate","txt");
  intermediateFile.delete();
  String clusterPath=Util.removeColon(intermediateFile.getAbsolutePath());
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.store("A",clusterPath,"BinStorage()");
  pigServer.registerQuery("A = load '" + Util.encodeEscape(clusterPath) + "' using BinStorage() as (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a0;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStream1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = stream A through `" + simpleEchoStreamingCommand + "`;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForeachNoSchema2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = foreach A generate $1, 'aoeuaoeu';");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("aoeuaoeu",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("5",t.get(0).toString());
  assertEquals("aoeuaoeu",t.get(1).toString());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCrossAtLeastOneColumnOneInput() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' as (b0:int, b1:int);");
  pigServer.registerQuery("C = cross A, B;");
  pigServer.registerQuery("D = foreach C generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Collection<String> results=new HashSet<String>();
  results.add("(1)");
  results.add("(2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEachFilter() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = filter A by a2==3;");
  pigServer.registerQuery("C = foreach B generate a0, a1;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals(2,t.get(1));
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' as (b0:int, b1:int);");
  pigServer.registerQuery("C = join A by a1, B by b1;");
  pigServer.registerQuery("D = foreach C generate a1, a2, b1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  assertEquals(2,t.get(0));
  assertEquals(3,t.get(1));
  assertEquals(2,t.get(2));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0","Columns pruned for B: $0"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadForEach4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate *;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup6() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = cogroup A by ($1), B by ($1);");
  pigServer.registerQuery("D = foreach C generate A, flatten(B.($0, $1));");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  assertEquals("{}",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertEquals("1",t.get(2).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(3,t.size());
  assertEquals("{(1,2,3)}",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertEquals("2",t.get(2).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinStorage2() throws Exception {
  File intermediateFile=File.createTempFile("intemediate","txt");
  intermediateFile.delete();
  String clusterPath=Util.removeColon(intermediateFile.getAbsolutePath());
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.store("A",clusterPath,"BinStorage()");
  pigServer.registerQuery("A = load '" + Util.encodeEscape(clusterPath) + "' using BinStorage() as (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a2, a0, a1;");
  pigServer.registerQuery("C = foreach B generate a0, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("3",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnionMixedPruning() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:chararray, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b2);");
  pigServer.registerQuery("C = foreach B generate b0, 'hello', b2;");
  pigServer.registerQuery("D = union A, C;");
  pigServer.registerQuery("E = foreach D generate $0, $2;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  Collection<String> results=new HashSet<String>();
  results.add("(1,3)");
  results.add("(2,2)");
  results.add("(1,1)");
  results.add("(2,2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKey5() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:map[]);");
  pigServer.registerQuery("B = foreach A generate $0, $1#'key1';");
  pigServer.registerQuery("C = stream B through `" + simpleEchoStreamingCommand + "`;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Map key required for A: $1->[key1]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForeachNoSchema1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("B = foreach A generate $1, $2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("3",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("5",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlainPlan() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("B = order A by $0;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(3,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertEquals("3",t.get(2).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(3,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("5",t.get(1).toString());
  assertEquals("2",t.get(2).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoin3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile4.toString(),pigServer.getPigContext()) + "' AS (b0, b1, b2);");
  pigServer.registerQuery("C = join A by *, B by * using 'replicated';");
  pigServer.registerQuery("D = foreach C generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadForEach3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:int, a2:int);");
  pigServer.registerQuery("B = foreach A generate a0, a1;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals(1,t.get(0));
  assertEquals(2,t.get(1));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals(2,t.get(0));
  assertEquals(5,t.get(1));
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup3() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:int, a2);");
  pigServer.registerQuery("B = group A by $1;");
  pigServer.registerQuery("C = foreach B generate $1, '1';");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{(1,2,3)}",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{(2,5,2)}",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplex1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile7.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile8.toString(),pigServer.getPigContext()) + "' as (b0, b1, b2, b3);");
  pigServer.registerQuery("B1 = foreach B generate b2, b0+b3;");
  pigServer.registerQuery("C = join A by $0, B1 by $0;");
  pigServer.registerQuery("D = order C by $4;");
  pigServer.registerQuery("E = foreach D generate $0, $2;");
  pigServer.registerQuery("F = filter E by $1<10;");
  pigServer.registerQuery("G = group F by $0;");
  pigServer.registerQuery("H = foreach G generate $1;");
  Iterator<Tuple> iter=pigServer.openIterator("H");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("{(2,2)}",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderBy1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = order A by $0;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapKey2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile3.toString(),pigServer.getPigContext()) + "' as (a0:int, a1:map[]);");
  pigServer.registerQuery("B = foreach A generate a1, a1#'key1';");
  pigServer.registerQuery("C = foreach B generate $0#'key2', $1;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("2",t.get(0).toString());
  assertEquals("1",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("4",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0","Map key required for A: $1->[key1, key2]"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFieldsToReadDuplicatedEntry() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a0+a0, a1, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(2.0,2,3)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(4.0,5,2)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoGroup4() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1:int, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1:int);");
  pigServer.registerQuery("C = cogroup A by ($1), B by ($1);");
  pigServer.registerQuery("D = foreach C generate $1.$1, $2.$1;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{}",t.get(0).toString());
  assertEquals("{(1)}",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{(2)}",t.get(0).toString());
  assertEquals("{(2)}",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("{(5)}",t.get(0).toString());
  assertEquals("{}",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCross1() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "' AS (b0, b1);");
  pigServer.registerQuery("C = cross A, B;");
  pigServer.registerQuery("D = foreach C generate $0, $3;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  Collection<String> results=new HashSet<String>();
  results.add("(1,1)");
  results.add("(2,1)");
  results.add("(1,2)");
  results.add("(2,2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1, $2","Columns pruned for B: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderBy2() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = order A by *;");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("2",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUserDefinedSchema() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS ( c1 : chararray, c2 : int);");
  pigServer.registerQuery("B = foreach A generate c1 as c1 : chararray, c2 as c2 : int, 'CA' as state : chararray;");
  pigServer.registerQuery("C = foreach B generate c1 as c1 : chararray;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("(1)",t.toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals("(2)",t.toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitOutputWithForEach() throws Exception {
  Path output1=FileLocalizer.getTemporaryPath(pigServer.getPigContext());
  Path output2=FileLocalizer.getTemporaryPath(pigServer.getPigContext());
  pigServer.setBatchOn();
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile5.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2, a3);");
  pigServer.registerQuery("B = foreach A generate a0, a1, a2;");
  pigServer.registerQuery("store B into '" + Util.generateURI(output1.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("C = order B by a2;");
  pigServer.registerQuery("D = foreach C generate a2;");
  pigServer.registerQuery("store D into '" + Util.generateURI(output2.toString(),pigServer.getPigContext()) + "';");
  pigServer.executeBatch();
  BufferedReader reader1=new BufferedReader(new InputStreamReader(FileLocalizer.openDFSFile(output1.toString(),pigServer.getPigContext().getProperties())));
  String line=reader1.readLine();
  assertEquals("1\t2\t3",line);
  line=reader1.readLine();
  assertEquals("2\t3\t4",line);
  assertNull(reader1.readLine());
  BufferedReader reader2=new BufferedReader(new InputStreamReader(FileLocalizer.openDFSFile(output2.toString(),pigServer.getPigContext().getProperties())));
  line=reader2.readLine();
  assertEquals("3",line);
  line=reader2.readLine();
  assertEquals("4",line);
  assertNull(reader2.readLine());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $3"}));
  reader1.close();
  reader2.close();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConstantPlan() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' as (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate 1, a2;");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("3",t.get(1).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(2,t.size());
  assertEquals("1",t.get(0).toString());
  assertEquals("2",t.get(1).toString());
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $1"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSharedSchemaObject() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile10.toString(),pigServer.getPigContext()) + "' AS (a0, a1:map[], a2);");
  pigServer.registerQuery("B = foreach A generate a1;");
  pigServer.registerQuery("C = limit B 10;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals("([1#1, 2#1])",TestHelper.sortString("\\[(.*)\\]",t.toString(),","));
  assertFalse(iter.hasNext());
  assertTrue(checkLogFileMessage(new String[]{"Columns pruned for A: $0, $2"}));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testForEachUDF() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0:chararray, a1:chararray, a2:chararray);");
  pigServer.registerQuery("B = foreach A generate StringSize(*);");
  pigServer.registerQuery("C = foreach B generate $0;");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("1",t.get(0).toString());
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnionMixedSchemaPruning() throws Exception {
  pigServer.registerQuery("A = load '" + Util.generateURI(tmpFile1.toString(),pigServer.getPigContext()) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = foreach A generate a0;;");
  pigServer.registerQuery("C = load '" + Util.generateURI(tmpFile2.toString(),pigServer.getPigContext()) + "';");
  pigServer.registerQuery("D = foreach C generate $0;");
  pigServer.registerQuery("E = union B, D;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  Collection<String> results=new HashSet<String>();
  results.add("(1)");
  results.add("(2)");
  results.add("(1)");
  results.add("(2)");
  assertTrue(iter.hasNext());
  Tuple t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertTrue(iter.hasNext());
  t=iter.next();
  assertEquals(1,t.size());
  assertTrue(results.contains(t.toString()));
  assertFalse(iter.hasNext());
  assertTrue(emptyLogFileMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRegexp </h4><pre class="type-6 type-4 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMatches() throws ExecException {
  lt.setValue(new String("The quick sly fox jumped over the lazy brown dog"));
  rt.setValue(".*s.y.*");
  Result res=op.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertTrue((Boolean)res.result);
  lt.setValue(null);
  rt.setValue(".*s.y.*");
  res=op.getNextBoolean();
  assertNull(res.result);
  lt.setValue(new String("The quick sly fox jumped over the lazy brown dog"));
  rt.setValue(null);
  res=op.getNextBoolean();
  assertNull(res.result);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoesntMatch() throws ExecException {
  lt.setValue(new String("The quick sly fox jumped over the lazy brown dog"));
  rt.setValue(new String("zzz"));
  Result res=op.getNextBoolean();
  assertEquals(POStatus.STATUS_OK,res.returnStatus);
  assertFalse((Boolean)res.result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRegisterParser </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterArtifactWithFileResolver() throws Throwable {
  PigContext context=pigServer.getPigContext();
  File confFile=new File("test/org/apache/pig/test/data/testivysettings.xml");
  System.setProperty("grape.config",confFile.toString());
  String strCmd="register ivy://testgroup:testjar:1?changing=true\n";
  ByteArrayInputStream cmd=new ByteArrayInputStream(strCmd.getBytes());
  InputStreamReader reader=new InputStreamReader(cmd);
  Grunt grunt=new Grunt(new BufferedReader(reader),context);
  grunt.exec();
  assertEquals(context.extraJars + " of size 1",1,context.extraJars.size());
  assertTrue(context.extraJars.get(0) + " ends with /testjar-1.jar",context.extraJars.get(0).toString().endsWith("/testjar-1.jar"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRelationToExprProject </h4><pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterCount1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        filter_notone = filter test by (col2!=1);"+ "        generate group as col1, COUNT(filter_one) as cnt_one, COUNT(filter_notone) as cnt_notone;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Tuple[] expected=new DefaultTuple[2];
  expected[0]=(Tuple)Util.getPigConstant("(1,1L,1L)");
  expected[1]=(Tuple)Util.getPigConstant("(2,2L,0L)");
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertTrue(expected[j].equals(results[j]));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter1() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate filter_one;};";
  pigServer.registerQuery(script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("({(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("({(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(new Integer(1),occurences);
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilter2() throws IOException, ParserException {
  Data data=resetData(pigServer);
  data.set("foo",tuple(1,1,3),tuple(1,2,3),tuple(2,1,3),tuple(2,1,3),tuple(3,4,4));
  String script="test   = load 'foo' using mock.Storage() as (col1: int, col2: int, col3: int);" + "test2 = group test by col1;" + "test3 = foreach test2 {"+ "        filter_one    = filter test by (col2==1);"+ "        generate group, filter_one;};";
  Util.registerMultiLineQuery(pigServer,script);
  Iterator<Tuple> it=pigServer.openIterator("test3");
  Map<Tuple,Integer> expected=new HashMap<Tuple,Integer>();
  expected.put((Tuple)Util.getPigConstant("(1,{(1,1,3)})"),0);
  expected.put((Tuple)Util.getPigConstant("(2,{(2,1,3),(2,1,3)})"),0);
  Tuple t=TupleFactory.getInstance().newTuple();
  t.append(new Integer(3));
  t.append(BagFactory.getInstance().newDefaultBag());
  expected.put(t,0);
  int i=0;
  while (it.hasNext()) {
    if (i == 3) {
      fail("Got more tuples than expected!");
    }
    t=it.next();
    assertTrue(expected.containsKey(t));
    int occurences=expected.get(t);
    occurences++;
    expected.put(t,occurences);
    i++;
  }
  for (  Integer occurences : expected.values()) {
    assertEquals(Integer.valueOf(1),occurences);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestResourceSchema </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that ResourceSchema is correctly created given a
 * pig.Schema and vice versa 
 */
@Test public void testResourceFlatSchemaCreation() throws ExecException, SchemaMergeException, FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema origSchema=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  ResourceSchema rsSchema=new ResourceSchema(origSchema);
  assertEquals("num fields",aliases.length,rsSchema.getFields().length);
  ResourceSchema.ResourceFieldSchema[] fields=rsSchema.getFields();
  for (int i=0; i < fields.length; i++) {
    assertEquals(fields[i].getName(),aliases[i]);
    assertEquals(fields[i].getType(),types[i]);
  }
  Schema genSchema=Schema.getPigSchema(rsSchema);
  assertTrue("generated schema equals original",Schema.equals(genSchema,origSchema,true,false));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test one-level Pig Schema: bag without tuple field
 */
@Test public void testResourceSchemaWithInvalidPigSchema2() throws FrontendException {
  String[] aliases={"f1"};
  byte[] types={DataType.INTEGER};
  Schema level0=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  Schema.FieldSchema fld0=new Schema.FieldSchema("f0",level0,DataType.BAG);
  Schema level1=new Schema(fld0);
  try {
    Schema.getPigSchema(new ResourceSchema(level1));
    Assert.fail();
  }
 catch (  FrontendException e) {
    assertTrue(e.getErrorCode() == 2218);
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can turn a schema into a string and then parse it
 * back into a schema.
 */
@Test public void testToStringAndParse() throws Exception {
  ResourceSchema rs=new ResourceSchema();
  ResourceFieldSchema[] fields=new ResourceFieldSchema[13];
  byte[] types={DataType.INTEGER,DataType.LONG,DataType.FLOAT,DataType.DOUBLE,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.MAP,DataType.TUPLE,DataType.TUPLE,DataType.BAG,DataType.BAG,DataType.BOOLEAN,DataType.DATETIME};
  String[] names={"i","l","f","d","b","s","m","tschema","tnull","bschema","bnull","bb","dt"};
  for (int i=0; i < fields.length; i++) {
    fields[i]=new ResourceFieldSchema();
    fields[i].setName(names[i]);
    fields[i].setType(types[i]);
  }
  ResourceSchema tschema=new ResourceSchema();
  ResourceFieldSchema[] tfields=new ResourceFieldSchema[3];
  for (int i=0; i < 3; i++) {
    tfields[i]=new ResourceFieldSchema();
    tfields[i].setName(names[i]);
    tfields[i].setType(types[i]);
  }
  tschema.setFields(tfields);
  fields[7].setSchema(tschema);
  ResourceSchema bschema=new ResourceSchema();
  ResourceFieldSchema[] bfields=new ResourceFieldSchema[1];
  bfields[0]=new ResourceFieldSchema();
  bfields[0].setName("t");
  bfields[0].setType(DataType.TUPLE);
  ResourceSchema tbschema=new ResourceSchema();
  ResourceFieldSchema[] tbfields=new ResourceFieldSchema[3];
  for (int i=3; i < 6; i++) {
    tbfields[i - 3]=new ResourceFieldSchema();
    tbfields[i - 3].setName(names[i]);
    tbfields[i - 3].setType(types[i]);
  }
  tbschema.setFields(tbfields);
  bfields[0].setSchema(tbschema);
  bschema.setFields(bfields);
  fields[9].setSchema(bschema);
  rs.setFields(fields);
  String strSchema=rs.toString();
  assertEquals("i:int,l:long,f:float,d:double,b:bytearray,s:" + "chararray,m:[],tschema:(i:int,l:long,f:float)," + "tnull:(),bschema:{t:(d:double,b:bytearray,s:chararray)},bnull:{},bb:boolean,dt:datetime",strSchema);
  ResourceSchema after=new ResourceSchema(Utils.getSchemaFromString(strSchema));
  ResourceFieldSchema[] afterFields=after.getFields();
  assertEquals(13,afterFields.length);
  assertEquals("i",afterFields[0].getName());
  assertEquals(DataType.INTEGER,afterFields[0].getType());
  assertEquals("l",afterFields[1].getName());
  assertEquals(DataType.LONG,afterFields[1].getType());
  assertEquals("f",afterFields[2].getName());
  assertEquals(DataType.FLOAT,afterFields[2].getType());
  assertEquals("d",afterFields[3].getName());
  assertEquals(DataType.DOUBLE,afterFields[3].getType());
  assertEquals("b",afterFields[4].getName());
  assertEquals(DataType.BYTEARRAY,afterFields[4].getType());
  assertEquals("s",afterFields[5].getName());
  assertEquals(DataType.CHARARRAY,afterFields[5].getType());
  assertEquals("m",afterFields[6].getName());
  assertEquals(DataType.MAP,afterFields[6].getType());
  assertEquals("tschema",afterFields[7].getName());
  assertEquals(DataType.TUPLE,afterFields[7].getType());
  assertEquals("tnull",afterFields[8].getName());
  assertEquals(DataType.TUPLE,afterFields[8].getType());
  assertEquals("bschema",afterFields[9].getName());
  assertEquals(DataType.BAG,afterFields[9].getType());
  assertEquals("bnull",afterFields[10].getName());
  assertEquals(DataType.BAG,afterFields[10].getType());
  assertEquals("bb",afterFields[11].getName());
  assertEquals(DataType.BOOLEAN,afterFields[11].getType());
  assertEquals("dt",afterFields[12].getName());
  assertEquals(DataType.DATETIME,afterFields[12].getType());
  assertNotNull(afterFields[7].getSchema());
  ResourceFieldSchema[] tAfterFields=afterFields[7].getSchema().getFields();
  assertEquals(3,tAfterFields.length);
  assertEquals("i",tAfterFields[0].getName());
  assertEquals(DataType.INTEGER,tAfterFields[0].getType());
  assertEquals("l",tAfterFields[1].getName());
  assertEquals(DataType.LONG,tAfterFields[1].getType());
  assertEquals("f",tAfterFields[2].getName());
  assertEquals(DataType.FLOAT,tAfterFields[2].getType());
  assertNotNull(afterFields[9].getSchema());
  ResourceFieldSchema[] bAfterFields=afterFields[9].getSchema().getFields();
  assertEquals(1,bAfterFields.length);
  assertNotNull(bAfterFields[0].getSchema());
  ResourceFieldSchema[] tbAfterFields=bAfterFields[0].getSchema().getFields();
  assertEquals(3,tbAfterFields.length);
  assertEquals("d",tbAfterFields[0].getName());
  assertEquals(DataType.DOUBLE,tbAfterFields[0].getType());
  assertEquals("b",tbAfterFields[1].getName());
  assertEquals(DataType.BYTEARRAY,tbAfterFields[1].getType());
  assertEquals("s",tbAfterFields[2].getName());
  assertEquals(DataType.CHARARRAY,tbAfterFields[2].getType());
}

</code></pre>

<br>
<pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test one-level Pig Schema: multiple fields for a bag
 */
@Test public void testResourceSchemaWithInvalidPigSchema() throws FrontendException {
  String[] aliases={"f1","f2"};
  byte[] types={DataType.CHARARRAY,DataType.INTEGER};
  Schema level0=TypeCheckingTestUtil.genFlatSchema(aliases,types);
  Schema.FieldSchema fld0=new Schema.FieldSchema("f0",level0,DataType.BAG);
  Schema level1=new Schema(fld0);
  try {
    Schema.getPigSchema(new ResourceSchema(level1));
    Assert.fail();
  }
 catch (  FrontendException e) {
    assertTrue(e.getErrorCode() == 2218);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestRollupDimensions </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCube() throws IOException {
  Tuple t=TF.newTuple(ImmutableList.of("a","b","c"));
  Set<Tuple> expected=ImmutableSet.of(TF.newTuple(ImmutableList.of("a","b","c")),TF.newTuple(ImmutableList.of("a","b","NULL")),TF.newTuple(ImmutableList.of("a","NULL","NULL")),TF.newTuple(ImmutableList.of("NULL","NULL","NULL")));
  RollupDimensions rd=new RollupDimensions("NULL");
  DataBag bag=rd.exec(t);
  assertEquals(bag.size(),expected.size());
  for (  Tuple tup : bag) {
    assertTrue(expected.contains(tup));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSampleOptimizer </h4><pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptimizerNotFired() throws Exception {
  String query=" A = load 'input' using PigStorage('\t');" + "B = group A by $0;" + " C = order B by $0;"+ "store C into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  int count=1;
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  SampleOptimizer so=new SampleOptimizer(mrPlan,pc);
  so.visit();
  count=1;
  mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  mrOper=mrPlan.getRoots().get(0);
  List<PhysicalOperator> phyOps=mrOper.mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertFalse(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
  phyOps=mrPlan.getSuccessors(mrOper).get(0).mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertTrue(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrderByUDFSet() throws Exception {
  String query="a = load 'input1' using BinStorage();" + "b = order a by $0;" + "store b into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  int count=1;
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  SampleOptimizer so=new SampleOptimizer(mrPlan,pc);
  so.visit();
  count=1;
  mrOper=mrPlan.getRoots().get(0);
  assertTrue(mrOper.UDFs.size() == 1);
  assertTrue(mrOper.UDFs.contains("BinStorage"));
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    assertTrue(mrOper.UDFs.size() == 2);
    assertTrue(mrOper.UDFs.contains("BinStorage"));
    assertTrue(mrOper.UDFs.contains("org.apache.pig.builtin.PigStorage"));
    ++count;
  }
  assertEquals(2,count);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptimizerFired() throws Exception {
  String query=" A = load 'input' using PigStorage('\t');" + " B = order A by $0;" + "store B into 'output';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  MROperPlan mrPlan=Util.buildMRPlan(pp,pc);
  int count=1;
  MapReduceOper mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(3,count);
  SampleOptimizer so=new SampleOptimizer(mrPlan,pc);
  so.visit();
  count=1;
  mrOper=mrPlan.getRoots().get(0);
  while (mrPlan.getSuccessors(mrOper) != null) {
    mrOper=mrPlan.getSuccessors(mrOper).get(0);
    ++count;
  }
  assertEquals(2,count);
  mrOper=mrPlan.getRoots().get(0);
  List<PhysicalOperator> phyOps=mrOper.mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertTrue(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
  phyOps=mrPlan.getSuccessors(mrOper).get(0).mapPlan.getRoots();
  assertEquals(1,phyOps.size());
  assertTrue(phyOps.get(0) instanceof POLoad);
  assertFalse(((POLoad)phyOps.get(0)).getLFile().getFuncName().equals("org.apache.pig.impl.builtin.RandomSampleLoader"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScalarAliasesLocal </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScalarAliasesGrammarNegative() throws Exception {
  String[] input={"1\t5","2\t10","3\t20"};
  String inputPath=BUILD_TEST_TMP + "table_testScalarAliasesGrammar";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  try {
    pigServer.registerQuery("A = LOAD '" + inputPath + "' as (a0: long, a1: double);");
    pigServer.registerQuery("B = group A all;");
    pigServer.registerQuery("C = foreach B generate COUNT(A);");
    pigServer.registerQuery("Y = foreach A generate C;");
    pigServer.openIterator("Y");
    fail("Scalar projections are only supported");
  }
 catch (  IOException pe) {
    assertTrue(pe.getMessage().contains("Invalid scalar projection: C"));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilteredScalarDollarProj() throws Exception {
  String output=BUILD_TEST_TMP + "table_testFilteredScalarDollarProjDir";
  TestScalarAliases.deleteDirectory(new File(output));
  String[] input={"1\t5\t[state#maine,city#portland]\t{(a),(b)}\t(a,b)","2\t10\t\t\t","3\t20\t\t\t"};
  String inputPath=BUILD_TEST_TMP + "table_testFilteredScalarDollarProj";
  TestScalarAliases.createLocalInputFile(inputPath,input);
  pigServer.setBatchOn();
  pigServer.registerQuery("A = LOAD '" + inputPath + "'"+ " as (a0: long, a1: double, a2 : bytearray, "+ "a3: bag{ t : tuple(tc : chararray)}, "+ "a4: tuple(c1 : chararray, c2 : chararray) );");
  pigServer.registerQuery("B = filter A by $1 < 8;");
  pigServer.registerQuery("Y = foreach A generate (a0 * B.$0), (a1 / B.$1), B.$2, B.$2#'state', B.$3, B.a4;");
  pigServer.registerQuery("Store Y into '" + output + "';");
  pigServer.explain("Y",System.err);
  pigServer.executeBatch();
  pigServer.registerQuery("Z = LOAD '" + output + "' as (a0: int, a1: double);");
  pigServer.explain("Z",System.err);
  Iterator<Tuple> iter=pigServer.openIterator("Z");
  Tuple t=iter.next();
  assertTrue(t.toString().equals("(1,1.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(2,2.0)"));
  t=iter.next();
  assertTrue(t.toString().equals("(3,4.0)"));
  assertFalse(iter.hasNext());
  iter=pigServer.openIterator("Y");
  t=iter.next();
  assertEquals(t.toString(),"(1,1.0,[state#maine,city#portland],maine,{(a),(b)},(a,b))");
  t=iter.next();
  assertEquals(t.toString(),"(2,2.0,[state#maine,city#portland],maine,{(a),(b)},(a,b))");
  t=iter.next();
  assertEquals(t.toString(),"(3,4.0,[state#maine,city#portland],maine,{(a),(b)},(a,b))");
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSchema </h4><pre class="type-7 type-9 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeMismatchType1() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:long, c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:bytearray, c1:long"));
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
    fail();
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
  }
  try {
    LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeDifferentSize1() throws Throwable {
  LogicalSchema a=Utils.parseSchema("a1:bytearray, b1:long, c1:long");
  LogicalSchema b=Utils.parseSchema("a2:bytearray, b2:long");
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  assertNull(mergedSchema);
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeMismatchType2() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:(b11:double, b12:(b121:int)), c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:chararray, b1:(), c1:long"));
  expected.getField(1).schema=new LogicalSchema();
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
    fail();
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
  }
  try {
    LogicalSchema.merge(b,a,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=FrontendException.class) public void testNewMergeDifferentSize2() throws Throwable {
  LogicalSchema a=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:bytearray, b1:(b11:int, b12:float, b13:float), c1:long"));
  LogicalSchema b=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a2:bytearray, b2:(b21:double, b22:long), c2:int"));
  LogicalSchema mergedSchema=LogicalSchema.merge(a,b,LogicalSchema.MergeMode.Union);
  LogicalSchema expected=org.apache.pig.newplan.logical.Util.translateSchema(Utils.getSchemaFromString("a1:bytearray, b1:(), c1:long"));
  expected.getField(1).schema=new LogicalSchema();
  assertTrue(LogicalSchema.equals(mergedSchema,expected,false,false));
  try {
    LogicalSchema.merge(a,b,LogicalSchema.MergeMode.LoadForEach);
  }
 catch (  FrontendException e) {
    assertEquals(1031,e.getErrorCode());
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ParserException.class) public void testGetStringFromSchemaNegative() throws Exception {
  String schemaString="a:int b:long";
  Utils.getSchemaFromString(schemaString);
  fail("The schema string is invalid, so parsing should fail!");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptLanguage </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void runLoopTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","Pig.fs(\"rmr simple_out2\")","input = 'simple_table_4'","P = Pig.compile(\"mypipeline\", \"\"\"a = load '$input';store a into '$output';\"\"\")","for x in [\"simple_out\", \"simple_out2\"]:","\tQ = P.bind({'input':input, 'output':x}).run()"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"simple_table_4",input);
  PigStats mainStats=runPigRunner("runLoopTest",script);
  Map<String,List<PigStats>> statsMap=mainStats.getAllStats();
  assertEquals(1,statsMap.size());
  assertEquals("mypipeline",statsMap.keySet().iterator().next());
  List<PigStats> lst=statsMap.get("mypipeline");
  assertEquals(2,lst.size());
  for (  PigStats stats : lst) {
    assertTrue("job should succeed",stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void runParallelTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","input = 'simple_table_3'","Pig.fs(\"rmr simple_out\")","Pig.fs(\"rmr simple_out2\")","output1 = 'simple_out'","output2 = 'simple_out2'","P = Pig.compile(\"mypipeline\", \"\"\"a = load '$input';store a into '$output';\"\"\")","Q = P.bind([{'input':input, 'output':output1}, {'input':input, 'output':output2}])","stats = Q.run()"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"simple_table_3",input);
  PigStats mainStats=runPigRunner("runParallelTest",script);
  Map<String,List<PigStats>> statsMap=mainStats.getAllStats();
  assertEquals(1,statsMap.size());
  assertEquals("mypipeline",statsMap.keySet().iterator().next());
  List<PigStats> lst=statsMap.get("mypipeline");
  assertEquals(2,lst.size());
  for (  PigStats stats : lst) {
    assertTrue("job should succeed",stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void firstParallelTest() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","Pig.fs(\"rmr simple_out2\")","input = 'simple_table_1'","output1 = 'simple_out'","output2 = 'simple_out2'","P = Pig.compile(\"mypipeline\", \"\"\"a = load '$input';store a into '$output';\"\"\")","Q = P.bind([{'input':input, 'output':output1}, {'input':input, 'output':output2}])","stats = Q.run()"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"simple_table_1",input);
  Map<String,List<PigStats>> statsMap=runScript("firstParallelTest",script);
  assertEquals(1,statsMap.size());
  assertEquals("mypipeline",statsMap.keySet().iterator().next());
  List<PigStats> lst=statsMap.get("mypipeline");
  assertEquals(2,lst.size());
  for (  PigStats stats : lst) {
    assertTrue("job should succeed",stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    assertEquals(12,stats.getBytesWritten());
    assertEquals(3,stats.getRecordWritten());
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void runParallelTest2() throws Exception {
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","input = 'simple_table_7'","Pig.fs(\"rmr simple_out\")","Pig.fs(\"rmr simple_out2\")","output1 = 'simple_out'","output2 = 'simple_out2'","P = Pig.compile(\"mypipeline\", \"\"\"a = load '$input';","b = foreach a generate $0, org.apache.pig.test.utils.UDFContextTestEvalFunc3($0);","store b into '$output';\"\"\")","Q = P.bind([{'input':input, 'output':output1}, {'input':input, 'output':output2}])","stats = Q.run()"};
  String[] input={"1\t3"};
  Util.createInputFile(cluster,"simple_table_7",input);
  PigStats mainStats=runPigRunner("runParallelTest2",script);
  Map<String,List<PigStats>> statsMap=mainStats.getAllStats();
  assertEquals(1,statsMap.size());
  assertEquals("mypipeline",statsMap.keySet().iterator().next());
  List<PigStats> lst=statsMap.get("mypipeline");
  assertEquals(2,lst.size());
  String[] results=new String[2];
  int i=0;
  for (  PigStats stats : lst) {
    assertTrue("job should succeed",stats.isSuccessful());
    assertEquals(1,stats.getNumberJobs());
    OutputStats os=stats.getOutputStats().get(0);
    Tuple t=os.iterator().next();
    results[i++]=t.get(1).toString();
  }
  assertTrue(results[0] != null);
  assertTrue(results[1] != null);
  assertTrue(!results[0].equals(results[1]));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void pigRunnerTest() throws Exception {
  String[] script={"from org.apache.pig.scripting import *","Pig.fs(\"rmr simple_out\")","input = 'simple_table_2'","output = 'simple_out'","P = Pig.compile(\"\"\"a = load '$input';store a into '$output';\"\"\")","Q = P.bind({'input':input, 'output':output})","stats = Q.runSingle()","if stats.isSuccessful():","\tprint 'success!'","else:","\traise 'failed'"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.createInputFile(cluster,"simple_table_2",input);
  PigStats mainStats=runPigRunner("pigRunnerTest",script);
  Map<String,List<PigStats>> statsMap=mainStats.getAllStats();
  assertEquals(1,statsMap.size());
  Iterator<List<PigStats>> it=statsMap.values().iterator();
  PigStats stats=it.next().get(0);
  assertTrue("job should succeed",stats.isSuccessful());
  assertEquals(1,stats.getNumberJobs());
  String name=stats.getOutputNames().get(0);
  assertEquals("simple_out",name);
  assertEquals(12,stats.getBytesWritten());
  assertEquals(3,stats.getRecordWritten());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptLanguageJavaScript </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void firstTest() throws Exception {
  String[] script={"importPackage(Packages.org.apache.pig.scripting.js)","pig = org.apache.pig.scripting.js.JSPig;","function main() {","  pig.fs(\"-rmr simple_out\")","  input = 'simple_table'","  output = 'simple_out'","  P = pig.compile(\"a = load '$input';store a into '$output';\")","  Q = P.bind({'input':input, 'output':output})","  stats = Q.runSingle()","  if (stats.isSuccessful()) {","    print(\"success!\")","  } else {","    print(\"failed\")","  }","}"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.deleteFile(pigServer.getPigContext(),"simple_table");
  Util.createInputFile(pigServer.getPigContext(),"simple_table",input);
  Util.createLocalInputFile("testScript.js",script);
  ScriptEngine scriptEngine=ScriptEngine.getInstance("javascript");
  Map<String,List<PigStats>> statsMap=scriptEngine.run(pigServer.getPigContext(),"testScript.js");
  assertEquals(1,statsMap.size());
  Iterator<List<PigStats>> it=statsMap.values().iterator();
  PigStats stats=it.next().get(0);
  assertTrue("job should succeed",stats.isSuccessful());
  assertEquals(1,stats.getNumberJobs());
  String name=stats.getOutputNames().get(0);
  assertEquals("simple_out",name);
  String[] output=Util.readOutput(pigServer.getPigContext(),"simple_out");
  assertTrue(Arrays.toString(input) + " equals " + Arrays.toString(output),Arrays.equals(input,output));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptUDF </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJavascriptExampleScript() throws Exception {
  String[] script={"function simple(word) {","return word;","}","helloworld.outputSchema = \"word:chararray\";","function helloworld() {","return 'Hello, World';","}","complex.outputSchema = \"(word:chararray,num:long)\";","function complex(word) {","return {word:word, num:word.length};","}"};
  String[] input={"one\t1","two\t2","three\t3"};
  Util.createInputFile(cluster,"table_testJavascriptExampleScript",input);
  Util.createLocalInputFile("testJavascriptExampleScript.js",script);
  pigServer.registerCode("testJavascriptExampleScript.js","javascript","myfuncs");
  pigServer.registerQuery("A = LOAD 'table_testJavascriptExampleScript' as (a0:chararray, a1:long);");
  pigServer.registerQuery("B = foreach A generate myfuncs.simple($0), myfuncs.helloworld(), myfuncs.complex($0);");
  Iterator<Tuple> iter=pigServer.openIterator("B");
  Assert.assertTrue(iter.hasNext());
  Tuple t=iter.next();
  Assert.assertEquals(((Tuple)t.get(2)).get(1),3);
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertEquals(((Tuple)t.get(2)).get(1),3);
  Assert.assertTrue(iter.hasNext());
  t=iter.next();
  Assert.assertEquals(((Tuple)t.get(2)).get(1),5);
  Schema outputSchema=pigServer.dumpSchema("B");
  Assert.assertEquals(new Schema.FieldSchema(null,DataType.BYTEARRAY),outputSchema.getField(0));
  Assert.assertEquals(new Schema.FieldSchema("word",DataType.CHARARRAY),outputSchema.getField(1));
  Schema inner=new Schema();
  inner.add(new Schema.FieldSchema("word",DataType.CHARARRAY));
  inner.add(new Schema.FieldSchema("num",DataType.LONG));
  Assert.assertEquals(new Schema.FieldSchema("tuple_0",inner,DataType.TUPLE),outputSchema.getField(2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestScriptingLanguagePython </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void varargTest() throws Exception {
  System.setProperty("python.cachedir",System.getProperty("java.io.tmpdir"));
  PigServer pigServer=new PigServer(Util.getLocalTestMode());
  String[] script={"#!/usr/bin/python","from org.apache.pig.scripting import *","@outputSchema(\"s:chararray\")","def firstNonempty(*args):","\tfor v in args:","\t\tif len(v) != 0:","\t\t\treturn v","\treturn ''","if __name__ == \"__main__\":","\tPig.compile(\"\"\"","data = load 'simple_table' AS (string1:chararray, string2:chararray);","data = foreach data generate firstNonempty(string1, string2) as id, string1, string2;","store data into 'simple_out';","\"\"\").bind().runSingle()"};
  String[] input={"1\t3","2\t4","3\t5"};
  Util.deleteFile(pigServer.getPigContext(),"simple_table");
  Util.deleteFile(pigServer.getPigContext(),"simple_out");
  Util.createInputFile(pigServer.getPigContext(),"simple_table",input);
  Util.createLocalInputFile("testScript.py",script);
  ScriptEngine scriptEngine=ScriptEngine.getInstance("jython");
  Map<String,List<PigStats>> statsMap=scriptEngine.run(pigServer.getPigContext(),"testScript.py");
  assertEquals(1,statsMap.size());
  Iterator<List<PigStats>> it=statsMap.values().iterator();
  PigStats stats=it.next().get(0);
  assertTrue(stats.isSuccessful());
  String[] output=Util.readOutput(pigServer.getPigContext(),"simple_out");
  assertEquals(3,output.length);
  assertEquals(output[0],"1\t1\t3");
  assertEquals(output[1],"2\t2\t4");
  assertEquals(output[2],"3\t3\t5");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSecondarySort </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedDistinctEndToEnd1() throws Exception {
  File tmpFile1=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps1=new PrintStream(new FileOutputStream(tmpFile1));
  ps1.println("1\t2\t3");
  ps1.println("1\t3\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("2\t3\t4");
  ps1.close();
  File tmpFile2=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps2=new PrintStream(new FileOutputStream(tmpFile2));
  ps2.println("1\t4\t4");
  ps2.println("2\t3\t1");
  ps2.close();
  String file1ClusterPath=Util.removeColon(tmpFile1.getCanonicalPath());
  String file2ClusterPath=Util.removeColon(tmpFile2.getCanonicalPath());
  Util.copyFromLocalToCluster(cluster,tmpFile1.getCanonicalPath(),file1ClusterPath);
  Util.copyFromLocalToCluster(cluster,tmpFile2.getCanonicalPath(),file2ClusterPath);
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(file1ClusterPath) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = LOAD '" + Util.encodeEscape(file2ClusterPath) + "' AS (b0, b1, b2);");
  pigServer.registerQuery("C = cogroup A by a0, B by b0 parallel 2;");
  pigServer.registerQuery("D = foreach C { E = limit A 10; F = E.a1; G = DISTINCT F; generate group, COUNT(G);};");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  assertTrue(iter.hasNext());
  assertEquals("(2,1)",iter.next().toString());
  assertTrue(iter.hasNext());
  assertEquals("(1,2)",iter.next().toString());
  assertFalse(iter.hasNext());
  Util.deleteFile(cluster,file1ClusterPath);
  Util.deleteFile(cluster,file2ClusterPath);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedDistinctEndToEnd2() throws Exception {
  File tmpFile1=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps1=new PrintStream(new FileOutputStream(tmpFile1));
  ps1.println("1\t2\t3");
  ps1.println("1\t3\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("2\t3\t4");
  ps1.close();
  String clusterPath=Util.removeColon(tmpFile1.getCanonicalPath());
  Util.copyFromLocalToCluster(cluster,tmpFile1.getCanonicalPath(),clusterPath);
  pigServer.registerQuery("A = LOAD '" + Util.encodeEscape(clusterPath) + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = group A by $0 parallel 2;");
  pigServer.registerQuery("C = foreach B { D = distinct A; generate group, D;};");
  Iterator<Tuple> iter=pigServer.openIterator("C");
  assertTrue(iter.hasNext());
  assertEquals("(2,{(2,3,4)})",iter.next().toString());
  assertTrue(iter.hasNext());
  assertEquals("(1,{(1,2,3),(1,2,4),(1,3,4)})",iter.next().toString());
  assertFalse(iter.hasNext());
  Util.deleteFile(cluster,clusterPath);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedSortEndToEnd3() throws Exception {
  File tmpFile1=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps1=new PrintStream(new FileOutputStream(tmpFile1));
  ps1.println("1\t2\t3");
  ps1.println("1\t3\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("1\t2\t4");
  ps1.println("2\t3\t4");
  ps1.close();
  File tmpFile2=Util.createTempFileDelOnExit("test","txt");
  PrintStream ps2=new PrintStream(new FileOutputStream(tmpFile2));
  ps2.println("1\t4\t4");
  ps2.println("2\t3\t1");
  ps2.close();
  String clusterPath1=tmpFile1.getName();
  String clusterPath2=tmpFile2.getName();
  Util.copyFromLocalToCluster(cluster,tmpFile1.getCanonicalPath(),clusterPath1);
  Util.copyFromLocalToCluster(cluster,tmpFile2.getCanonicalPath(),clusterPath2);
  pigServer.registerQuery("A = LOAD '" + clusterPath1 + "' AS (a0, a1, a2);");
  pigServer.registerQuery("B = LOAD '" + clusterPath2 + "' AS (b0, b1, b2);");
  pigServer.registerQuery("C = cogroup A by (a0,a1), B by (b0,b1) parallel 2;");
  pigServer.registerQuery("D = ORDER C BY group;");
  pigServer.registerQuery("E = foreach D { F = limit A 10; G = ORDER F BY a2; generate group, COUNT(G);};");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  assertTrue(iter.hasNext());
  assertEquals("((1,2),4)",iter.next().toString());
  assertTrue(iter.hasNext());
  assertEquals("((1,3),1)",iter.next().toString());
  assertTrue(iter.hasNext());
  assertEquals("((1,4),0)",iter.next().toString());
  assertTrue(iter.hasNext());
  assertEquals("((2,3),1)",iter.next().toString());
  assertFalse(iter.hasNext());
  Util.deleteFile(cluster,clusterPath1);
  Util.deleteFile(cluster,clusterPath2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSkewedJoin </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkewedJoinManyReducers() throws IOException {
  pigServer.getPigContext().getProperties().setProperty("pig.skewedjoin.reduce.maxtuple","2");
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE6 + "' as (id,name);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE7 + "' as (id,name);");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag(), dbrj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("E = join A by id, B by id using 'skewed' parallel 300;");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("E = join A by id, B by id;");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbrj.add(iter.next());
    }
  }
  assertEquals(dbfrj.size(),dbrj.size());
  assertTrue(TestHelper.compareBags(dbfrj,dbrj));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSkewedJoinOneValue() throws IOException {
  pigServer.registerQuery("A = LOAD '" + INPUT_FILE3 + "' as (id,name);");
  pigServer.registerQuery("B = LOAD '" + INPUT_FILE3 + "' as (id,name);");
  pigServer.registerQuery("C = FILTER A by id == 400;");
  pigServer.registerQuery("D = FILTER B by id == 400;");
  DataBag dbfrj=BagFactory.getInstance().newDefaultBag(), dbrj=BagFactory.getInstance().newDefaultBag();
{
    pigServer.registerQuery("E = join C by id, D by id using 'skewed';");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbfrj.add(iter.next());
    }
  }
{
    pigServer.registerQuery("E = join C by id, D by id;");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    while (iter.hasNext()) {
      dbrj.add(iter.next());
    }
  }
  assertEquals(dbfrj.size(),dbrj.size());
  assertTrue(TestHelper.compareBags(dbfrj,dbrj));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStore </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidationFailure() throws Exception {
  String input[]=new String[]{"some data"};
  String outputFileName="test-output.txt";
  boolean sawException=false;
  try {
    Util.createInputFile(ps.getPigContext(),outputFileName,input);
    String query="a = load '" + inputFileName + "' as (c:chararray, "+ "i:int,d:double);"+ "store a into '"+ outputFileName+ "' using PigStorage();";
    Util.buildLp(ps,query);
  }
 catch (  InvocationTargetException e) {
    FrontendException pve=(FrontendException)e.getCause();
    pve.printStackTrace();
    assertEquals(6000,pve.getErrorCode());
    assertEquals(PigException.REMOTE_ENVIRONMENT,pve.getErrorSource());
    assertTrue(pve.getCause() instanceof IOException);
    sawException=true;
  }
 finally {
    assertTrue(sawException);
    Util.deleteFile(ps.getPigContext(),outputFileName);
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStore() throws Exception {
  inpDB=GenRandomData.genRandSmallTupDataBag(new Random(),10,100);
  storeAndCopyLocally(inpDB);
  int size=0;
  BufferedReader br=new BufferedReader(new FileReader(outputFileName));
  for (String line=br.readLine(); line != null; line=br.readLine()) {
    String[] flds=line.split("\t",-1);
    Tuple t=new DefaultTuple();
    t.append(flds[0].compareTo("") != 0 ? flds[0] : null);
    t.append(flds[1].compareTo("") != 0 ? Integer.parseInt(flds[1]) : null);
    System.err.println("Simple data: ");
    System.err.println(line);
    System.err.println("t: ");
    System.err.println(t);
    assertTrue(TestHelper.bagContains(inpDB,t));
    ++size;
  }
  assertEquals(size,inpDB.size());
  br.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStoreBase </h4><pre class="type-13 type-6 type-20 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test whether "part-m-00000" file is created on empty output when{@link PigConfiguration#PIG_OUTPUT_LAZY} is set and if LazyOutputFormat is
 * supported by Hadoop.
 * The test covers multi store and single store case in local and mapreduce mode
 * @throws IOException
 */
@Test public void testEmptyPartFileCreation() throws Exception {
  boolean isLazyOutputPresent=true;
  try {
    Class<?> clazz=PigContext.resolveClassName("org.apache.hadoop.mapreduce.lib.output.LazyOutputFormat");
    clazz.getMethod("setOutputFormatClass",Job.class,Class.class);
  }
 catch (  Exception e) {
    isLazyOutputPresent=false;
  }
  Assume.assumeTrue("LazyOutputFormat couldn't be loaded, test is skipped",isLazyOutputPresent);
  try {
    String[] inputData=new String[]{"hello\tworld","hi\tworld","bye\tworld"};
    String multiStoreScript="a = load '" + inputFileName + "';"+ "b = filter a by $0 == 'hey';"+ "c = filter a by $1 == 'globe';"+ "d = limit a 2;"+ "e = foreach d generate *, 'x';"+ "f = filter e by $3 == 'y';"+ "store b into '"+ outputFileName+ "_1';"+ "store c into '"+ outputFileName+ "_2';"+ "store f into '"+ outputFileName+ "_3';";
    String singleStoreScript="a = load '" + inputFileName + "';"+ "b = filter a by $0 == 'hey';"+ "store b into '"+ outputFileName+ "_1';";
    for (    boolean isMultiStore : new boolean[]{true,false}) {
      if (isMultiStore && (mode.isLocal() || mode.equals(ExecType.MAPREDUCE))) {
        continue;
      }
      String script=(isMultiStore ? multiStoreScript : singleStoreScript);
      ps.getPigContext().getProperties().setProperty(PigConfiguration.PIG_OUTPUT_LAZY,"true");
      Util.deleteFile(ps.getPigContext(),TESTDIR);
      ps.setBatchOn();
      Util.createInputFile(ps.getPigContext(),inputFileName,inputData);
      Util.registerMultiLineQuery(ps,script);
      ps.executeBatch();
      Configuration conf=ConfigurationUtil.toConfiguration(ps.getPigContext().getProperties());
      for (int i=1; i <= (isMultiStore ? 3 : 1); i++) {
        assertEquals("For an empty output part-m-00000 should not exist in " + mode + " mode",null,getFirstOutputFile(conf,new Path(outputFileName + "_" + i),mode,true));
      }
    }
  }
  finally {
    Util.deleteFile(ps.getPigContext(),TESTDIR);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStreaming </h4><pre class="type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegativeMultipleInput() throws IOException {
  String[] script=new String[]{"#!/usr/bin/perl","open(INFILE,  $ARGV[0]) or die \"Can't open \".$ARGV[0].\"!: $!\";","while (<INFILE>) {","  chomp $_;","  print STDOUT \"$_\n\";","  print STDERR \"STDERR: $_\n\";","}"};
  File command1=Util.createInputFile("script","pl",script);
  String query="define CMD1 `perl " + command1.getName() + " foo` "+ "ship ('"+ Util.encodeEscape(command1.toString())+ "') "+ "input('foo' using "+ PigStreaming.class.getName()+ "(',')) "+ "output(stdout using "+ PigStreaming.class.getName()+ "(',')) "+ "input('foo' using "+ PigStreaming.class.getName()+ "(',')) "+ "stderr();";
  try {
    pigServer.registerQuery(query);
  }
 catch (  FrontendException ex) {
    String expectedMsg="pig script failed to validate: Duplicated command option";
    System.out.println(ex.getMessage());
    Assert.assertTrue(ex.getMessage().contains(expectedMsg));
    return;
  }
  Assert.fail("Testcase is supposed to fail.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStreamingLocal </h4><pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinTwoStreamingRelations() throws Exception {
  ArrayList<String> list=new ArrayList<String>();
  for (int i=0; i < 10000; i++) {
    list.add("A," + i);
  }
  File input=Util.createInputFile("tmp","",list.toArray(new String[0]));
  Tuple expected=TupleFactory.getInstance().newTuple(4);
  expected.set(0,"A");
  expected.set(1,0);
  expected.set(2,"A");
  expected.set(3,0);
  pigServer.registerQuery("A = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',') as (a0, a1);");
  pigServer.registerQuery("B = stream A through `head -1` as (a0, a1);");
  pigServer.registerQuery("C = load '" + Util.generateURI(input.toString(),pigServer.getPigContext()) + "' using "+ PigStorage.class.getName()+ "(',') as (a0, a1);");
  pigServer.registerQuery("D = stream C through `head -1` as (a0, a1);");
  pigServer.registerQuery("E = join B by a0, D by a0;");
  Iterator<Tuple> iter=pigServer.openIterator("E");
  int count=0;
  while (iter.hasNext()) {
    Assert.assertEquals(expected.toString(),iter.next().toString());
    count++;
  }
  Assert.assertTrue(count == 1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestStringUDFs </h4><pre class="type-6 type-4 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEndsWith() throws IOException {
  ENDSWITH endsWith=new ENDSWITH();
  Tuple testTuple1=Util.buildTuple("foo","bar");
  assertFalse("String suffix should not match",endsWith.exec(testTuple1));
  Tuple testTuple2=Util.buildTuple("foobaz","foo");
  assertFalse("String suffix should not match",endsWith.exec(testTuple2));
  Tuple testTuple3=Util.buildTuple("foobaz","baz");
  assertTrue("String suffix should match",endsWith.exec(testTuple3));
  Tuple testTuple4=Util.buildTuple(null,"bar");
  assertNull("Should return null",endsWith.exec(testTuple4));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrim() throws IOException {
  TRIM trim=new TRIM();
  Tuple testTuple=Util.buildTuple("nospaces");
  assertEquals("nospaces".trim(),trim.exec(testTuple));
  testTuple=Util.buildTuple("spaces right    ");
  assertEquals("spaces right",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces left");
  assertEquals("spaces left",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces both    ");
  assertEquals("spaces both",trim.exec(testTuple));
  testTuple=TupleFactory.getInstance().newTuple();
  assertNull(trim.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLtrim() throws IOException {
  LTRIM trim=new LTRIM();
  Tuple testTuple=Util.buildTuple("nospaces");
  assertEquals("nospaces",trim.exec(testTuple));
  testTuple=Util.buildTuple("spaces right    ");
  assertEquals("spaces right    ",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces left");
  assertEquals("spaces left",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces both    ");
  assertEquals("spaces both    ",trim.exec(testTuple));
  testTuple=TupleFactory.getInstance().newTuple();
  assertNull(trim.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRtrim() throws IOException {
  RTRIM trim=new RTRIM();
  Tuple testTuple=Util.buildTuple("nospaces");
  assertEquals("nospaces",trim.exec(testTuple));
  testTuple=Util.buildTuple("spaces right    ");
  assertEquals("spaces right",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces left");
  assertEquals("    spaces left",trim.exec(testTuple));
  testTuple=Util.buildTuple("    spaces both    ");
  assertEquals("    spaces both",trim.exec(testTuple));
  testTuple=TupleFactory.getInstance().newTuple();
  assertNull(trim.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIndexOf() throws IOException {
  INDEXOF indexOf=new INDEXOF();
  Tuple testTuple=Util.buildTuple("xyz","");
  assertEquals(((Integer)"xyz".indexOf("")),indexOf.exec(testTuple));
  testTuple=Util.buildTuple(null,null);
  assertNull(indexOf.exec(testTuple));
  testTuple=Util.buildTuple("xyz","y");
  assertEquals(((Integer)"xyz".indexOf("y")),indexOf.exec(testTuple));
  testTuple=Util.buildTuple("xyz","abc");
  assertEquals(((Integer)"xyz".indexOf("abc")),indexOf.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringSubstr() throws IOException {
  Tuple testTuple=Util.buildTuple(null,0,2);
  assertNull("null is null",stringSubstr_.exec(testTuple));
  testTuple=Util.buildTuple("",0,2);
  assertEquals("empty string","",stringSubstr_.exec(testTuple));
  testTuple=Util.buildTuple("abcde",1,3);
  assertEquals("lowercase string","bc",stringSubstr_.exec(testTuple));
  testTuple=Util.buildTuple("abc",0,15);
  assertEquals("uppercase string","abc",stringSubstr_.exec(testTuple));
}

</code></pre>

<br>
<pre class="type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLastIndexOf() throws IOException {
  LAST_INDEX_OF lastIndexOf=new LAST_INDEX_OF();
  Tuple testTuple=Util.buildTuple("xyz","");
  assertEquals(((Integer)"xyz".lastIndexOf("")),lastIndexOf.exec(testTuple));
  testTuple=Util.buildTuple(null,null);
  assertNull(lastIndexOf.exec(testTuple));
  testTuple=Util.buildTuple("xyzyy","y");
  assertEquals(((Integer)"xyzyy".lastIndexOf("y")),lastIndexOf.exec(testTuple));
  testTuple=Util.buildTuple("xyz","abc");
  assertEquals(((Integer)"xyz".lastIndexOf("abc")),lastIndexOf.exec(testTuple));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestSubtract </h4><pre class="type-7 type-8 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOperator() throws ExecException {
  byte[] types={DataType.BAG,DataType.BOOLEAN,DataType.BYTEARRAY,DataType.CHARARRAY,DataType.DOUBLE,DataType.FLOAT,DataType.INTEGER,DataType.LONG,DataType.DATETIME,DataType.MAP,DataType.TUPLE};
  System.out.println("Testing Subtract operator");
  for (  byte type : types) {
    lt.setResultType(type);
    rt.setResultType(type);
    op.setLhs(lt);
    op.setRhs(rt);
switch (type) {
case DataType.BAG:
      DataBag inpdb1=GenRandomData.genRandSmallTupDataBag(r,10,100);
    DataBag inpdb2=GenRandomData.genRandSmallTupDataBag(r,10,100);
  lt.setValue(inpdb1);
rt.setValue(inpdb2);
Result resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(null);
rt.setValue(inpdb2);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
lt.setValue(inpdb1);
rt.setValue(null);
resdb=op.getNextDataBag();
assertEquals(POStatus.STATUS_ERR,resdb.returnStatus);
break;
case DataType.BOOLEAN:
Boolean inpb1=r.nextBoolean();
Boolean inpb2=r.nextBoolean();
lt.setValue(inpb1);
rt.setValue(inpb2);
Result resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(null);
rt.setValue(inpb2);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
lt.setValue(inpb1);
rt.setValue(null);
resb=op.getNextBoolean();
assertEquals(POStatus.STATUS_ERR,resb.returnStatus);
break;
case DataType.BYTEARRAY:
{
DataByteArray inpba1=GenRandomData.genRandDBA(r);
DataByteArray inpba2=GenRandomData.genRandDBA(r);
lt.setValue(inpba1);
rt.setValue(inpba2);
Result resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(null);
rt.setValue(inpba2);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
lt.setValue(inpba1);
rt.setValue(null);
resba=op.getNextDataByteArray();
assertEquals(POStatus.STATUS_ERR,resba.returnStatus);
break;
}
case DataType.CHARARRAY:
{
String inps1=GenRandomData.genRandString(r);
String inps2=GenRandomData.genRandString(r);
lt.setValue(inps1);
rt.setValue(inps2);
Result ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(null);
rt.setValue(inps2);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
lt.setValue(inps1);
rt.setValue(null);
ress=op.getNextString();
assertEquals(POStatus.STATUS_ERR,ress.returnStatus);
break;
}
case DataType.DOUBLE:
{
Double inpd1=r.nextDouble();
Double inpd2=r.nextDouble();
lt.setValue(inpd1);
rt.setValue(inpd2);
Result resd=op.getNextDouble();
Double expected=new Double(inpd1 - inpd2);
assertEquals(expected,(Double)resd.result);
lt.setValue(null);
rt.setValue(inpd2);
resd=op.getNextDouble();
assertNull(resd.result);
lt.setValue(inpd1);
rt.setValue(null);
resd=op.getNextDouble();
assertNull(resd.result);
break;
}
case DataType.FLOAT:
{
Float inpf1=r.nextFloat();
Float inpf2=r.nextFloat();
lt.setValue(inpf1);
rt.setValue(inpf2);
Result resf=op.getNextFloat();
Float expected=new Float(inpf1 - inpf2);
assertEquals(expected,(Float)resf.result);
lt.setValue(null);
rt.setValue(inpf2);
resf=op.getNextFloat();
assertNull(resf.result);
lt.setValue(inpf1);
rt.setValue(null);
resf=op.getNextFloat();
assertNull(resf.result);
break;
}
case DataType.INTEGER:
{
Integer inpi1=r.nextInt();
Integer inpi2=r.nextInt();
lt.setValue(inpi1);
rt.setValue(inpi2);
Result resi=op.getNextInteger();
Integer expected=new Integer(inpi1 - inpi2);
assertEquals(expected,(Integer)resi.result);
lt.setValue(null);
rt.setValue(inpi2);
resi=op.getNextInteger();
assertNull(resi.result);
lt.setValue(inpi1);
rt.setValue(null);
resi=op.getNextInteger();
assertNull(resi.result);
break;
}
case DataType.LONG:
{
Long inpl1=r.nextLong();
Long inpl2=r.nextLong();
lt.setValue(inpl1);
rt.setValue(inpl2);
Result resl=op.getNextLong();
Long expected=new Long(inpl1 - inpl2);
assertEquals(expected,(Long)resl.result);
lt.setValue(null);
rt.setValue(inpl2);
resl=op.getNextLong();
assertNull(resl.result);
lt.setValue(inpl1);
rt.setValue(null);
resl=op.getNextLong();
assertNull(resl.result);
break;
}
case DataType.DATETIME:
{
DateTime inpdt1=new DateTime(r.nextLong());
DateTime inpdt2=new DateTime(r.nextLong());
lt.setValue(inpdt1);
rt.setValue(inpdt2);
Result resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(null);
rt.setValue(inpdt2);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
lt.setValue(inpdt1);
rt.setValue(null);
resdt=op.getNextDateTime();
assertEquals(POStatus.STATUS_ERR,resdt.returnStatus);
break;
}
case DataType.MAP:
{
Map<String,Object> inpm1=GenRandomData.genRandMap(r,10);
Map<String,Object> inpm2=GenRandomData.genRandMap(r,10);
lt.setValue(inpm1);
rt.setValue(inpm2);
Result resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(null);
rt.setValue(inpm2);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
lt.setValue(inpm1);
rt.setValue(null);
resm=op.getNextMap();
assertEquals(POStatus.STATUS_ERR,resm.returnStatus);
break;
}
case DataType.TUPLE:
{
Tuple inpt1=GenRandomData.genRandSmallBagTuple(r,10,100);
Tuple inpt2=GenRandomData.genRandSmallBagTuple(r,10,100);
lt.setValue(inpt1);
rt.setValue(inpt2);
Result rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(null);
rt.setValue(inpt2);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
lt.setValue(inpt1);
rt.setValue(null);
rest=op.getNextTuple();
assertEquals(POStatus.STATUS_ERR,rest.returnStatus);
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTextDataParser </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapLongValueType() throws Exception {
  String myMap="[key1#1l]";
  Schema schema=Utils.getSchemaFromString("m:map[long]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof Long);
  String value=String.valueOf(v);
  assertEquals("1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTuple() throws Exception {
  String myTuple="(1,a)";
  Object o=ps.getLoadCaster().bytesToTuple(myTuple.getBytes(),getTupleFieldSchema());
  assertTrue(o instanceof Tuple);
  Tuple t=(Tuple)o;
  Tuple expectedTuple=tupleFactory.newTuple(2);
  expectedTuple.set(0,1);
  expectedTuple.set(1,"a");
  assertEquals(expectedTuple,t);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBag() throws Exception {
  String myBag="{(1,a),(2,b)}";
  Object o=ps.getLoadCaster().bytesToBag(myBag.getBytes(),getBagFieldSchema());
  assertTrue(o instanceof DataBag);
  DataBag b=(DataBag)o;
  DataBag expectedBag=bagFactory.newDefaultBag();
  Tuple expectedTuple=tupleFactory.newTuple(2);
  expectedTuple.set(0,1);
  expectedTuple.set(1,"a");
  expectedBag.add(expectedTuple);
  expectedTuple=tupleFactory.newTuple(2);
  expectedTuple.set(0,2);
  expectedTuple.set(1,"b");
  expectedBag.add(expectedTuple);
  assertEquals(expectedBag,b);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapDoubleValueType() throws Exception {
  String myMap="[key1#0.1]";
  Schema schema=Utils.getSchemaFromString("m:map[double]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof Double);
  String value=String.valueOf(v);
  assertEquals("0.1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapStringValueType() throws Exception {
  String myMap="[key1#value1]";
  Schema schema=Utils.getSchemaFromString("m:map[chararray]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof String);
  String value=String.valueOf(v);
  assertEquals("value1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapFloatValueType() throws Exception {
  String myMap="[key1#0.1f]";
  Schema schema=Utils.getSchemaFromString("m:map[float]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof Float);
  String value=String.valueOf(v);
  assertEquals("0.1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapIntegerValueType() throws Exception {
  String myMap="[key1#1]";
  Schema schema=Utils.getSchemaFromString("m:map[int]");
  ResourceFieldSchema rfs=new ResourceSchema(schema).getFields()[0];
  Map<String,Object> map=ps.getLoadCaster().bytesToMap(myMap.getBytes(),rfs);
  String key=map.keySet().iterator().next();
  Object v=map.get("key1");
  assertEquals("key1",key);
  assertTrue(v instanceof Integer);
  String value=String.valueOf(v);
  assertEquals("1",value);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyBag() throws Exception {
  String myBag="{}";
  Object o=ps.getLoadCaster().bytesToBag(myBag.getBytes(),getBagFieldSchema());
  assertTrue(o instanceof DataBag);
  DataBag b=(DataBag)o;
  assertEquals(0,b.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTmpFileCompression </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplitInCoGroupUncompressed() throws Exception {
  resetLog(InterStorage.class);
  String input1="testImplicitSplitInCoGroup-input1.txt";
  String input2="testImplicitSplitInCoGroup-input2.txt";
  Util.createInputFile(cluster,input1,new String[]{"a:1","b:2","b:20","c:3","c:30"});
  Util.createInputFile(cluster,input2,new String[]{"a:first","b:second","c:third"});
  pigServer.registerQuery("a = load '" + input1 + "' using PigStorage(':') as (name:chararray, marks:int);");
  pigServer.registerQuery("b = load '" + input2 + "' using PigStorage(':') as (name:chararray, rank:chararray);");
  pigServer.registerQuery("c = cogroup a by name, b by name;");
  pigServer.registerQuery("d = foreach c generate group, FLATTEN(a.marks) as newmarks;");
  pigServer.registerQuery("e = cogroup a by marks, d by newmarks;");
  pigServer.registerQuery("f = foreach e generate group, flatten(a), flatten(d);");
  HashMap<Integer,Object[]> results=new HashMap<Integer,Object[]>();
  results.put(1,new Object[]{"a",1,"a",1});
  results.put(2,new Object[]{"b",2,"b",2});
  results.put(3,new Object[]{"c",3,"c",3});
  results.put(20,new Object[]{"b",20,"b",20});
  results.put(30,new Object[]{"c",30,"c",30});
  Iterator<Tuple> it=pigServer.openIterator("f");
  while (it.hasNext()) {
    Tuple t=it.next();
    System.err.println("Tuple:" + t);
    Integer group=(Integer)t.get(0);
    Object[] groupValues=results.get(group);
    for (int i=0; i < 4; i++) {
      assertEquals(groupValues[i],t.get(i + 1));
    }
  }
  Util.deleteFile(cluster,input1);
  Util.deleteFile(cluster,input2);
  assertTrue(checkLogFileMessage(new String[]{InterStorage.useLog}));
}

</code></pre>

<br>
<pre class="type-8 type-9 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImplicitSplitUncompressed() throws Exception {
  resetLog(InterStorage.class);
  int LOOP_SIZE=20;
  String[] input=new String[LOOP_SIZE];
  for (int i=1; i <= LOOP_SIZE; i++) {
    input[i - 1]=Integer.toString(i);
  }
  String inputFileName="testImplicitSplit-input.txt";
  Util.createInputFile(cluster,inputFileName,input);
  pigServer.registerQuery("A = LOAD '" + inputFileName + "';");
  pigServer.registerQuery("B = filter A by $0<=10;");
  pigServer.registerQuery("C = filter A by $0>10;");
  pigServer.registerQuery("D = union B,C;");
  Iterator<Tuple> iter=pigServer.openIterator("D");
  if (!iter.hasNext())   fail("No Output received");
  int cnt=0;
  while (iter.hasNext()) {
    iter.next();
    ++cnt;
  }
  assertEquals(20,cnt);
  Util.deleteFile(cluster,inputFileName);
  assertTrue(checkLogFileMessage(new String[]{"Pig Internal storage in use"}));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTFileRecordReader() throws Exception {
  PrintWriter w=new PrintWriter(new FileWriter("1.txt"));
  for (int i=0; i < 30; i++) {
    w.println("1\tthis is a test for compression of temp files");
  }
  w.close();
  Util.copyFromLocalToCluster(cluster,"1.txt","1.txt");
  PrintWriter w1=new PrintWriter(new FileWriter("tfile.pig"));
  w1.println("A = load '1.txt' as (a0:int, a1:chararray);");
  w1.println("B = group A by a0;");
  w1.println("store B into 'tfile' using org.apache.pig.impl.io.TFileStorage();");
  w1.close();
  PrintWriter w2=new PrintWriter(new FileWriter("tfile2.pig"));
  w2.println("A = load 'tfile' using org.apache.pig.impl.io.TFileStorage() as (a:int, b:bag{(b0:int, b1:chararray)});");
  w2.println("B = foreach A generate flatten($1);");
  w2.println("store B into '2.txt';");
  w2.close();
  try {
    String[] args={"-Dpig.tmpfilecompression.codec=gz","-Dtfile.io.chunk.size=100","tfile.pig"};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    String[] args2={"-Dpig.tmpfilecompression.codec=gz","-Dtfile.io.chunk.size=100","tfile2.pig"};
    PigStats stats2=PigRunner.run(args2,null);
    assertTrue(stats2.isSuccessful());
    OutputStats os=stats2.result("B");
    Iterator<Tuple> iter=os.iterator();
    int count=0;
    String expected="(1,this is a test for compression of temp files)";
    while (iter.hasNext()) {
      count++;
      assertEquals(expected,iter.next().toString());
    }
    assertEquals(30,count);
  }
  finally {
    new File("tfile.pig").delete();
    new File("tfile2.pig").delete();
    new File("1.txt").delete();
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTFileRecordWriterReaderAndProgress() throws Exception {
  File tFile=File.createTempFile("test","tfile");
  Path basicTFile=new Path(tFile.getAbsolutePath());
  tFile.delete();
  Configuration conf=new Configuration();
  conf.set("tfile.io.chunk.size","100");
  conf.set("fs.default.name","file:///");
  for (  String codec : new String[]{"none","gz"}) {
    System.err.println("Testing RecordWriter/Reader with codec: " + codec);
    try {
      TFileRecordWriter writer=new TFileRecordWriter(basicTFile,codec,conf);
      Tuple tuple=TupleFactory.getInstance().newTuple(1);
      int LOOP_SIZE=25000;
      for (int i=0; i <= LOOP_SIZE; i++) {
        String key=String.format("%010d",i);
        tuple.set(0,key);
        writer.write(null,tuple);
      }
      writer.close(null);
      int size=(int)tFile.length();
      FileSplit split=new FileSplit(basicTFile,0,size,null);
      TFileRecordReader reader=new TFileRecordReader();
      reader.initialize(split,HadoopShims.createTaskAttemptContext(conf,HadoopShims.createTaskAttemptID("jt",1,true,1,1)));
      float progress=0, lastprogress=0;
      int curval=0, prevval=-1;
      while (reader.nextKeyValue()) {
        Tuple t=(Tuple)reader.getCurrentValue();
        curval=Integer.valueOf((String)t.get(0));
        assertEquals("Unexpected Value",curval,prevval + 1);
        prevval=curval;
        progress=reader.getProgress();
        if (progress != lastprogress) {
          System.err.println("progress: " + progress);
        }
        assertTrue("Progress is not positive",progress > 0);
        assertTrue("Progress is not increasing",progress >= lastprogress);
        lastprogress=progress;
      }
      assertEquals("Last value does not match",curval,LOOP_SIZE);
      reader.close();
    }
  finally {
      tFile.delete();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestToolsPigServer </h4><pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToolsPigServerRegister() throws Exception {
  Util.createLocalInputFile("testRegisterScripts.jar",new String[]{"mary had a little lamb"});
  Util.createInputFile(cluster,"input1",new String[]{"abc:123","def:456","ghi:789"});
  File scriptFile=Util.createFile(new String[]{"register 'testRegisterScripts.jar';","a = load 'input1' using " + PigStorage.class.getName() + "(':');","b = foreach a generate $0;","store b into '/bla1';"});
  pig.registerNoRun(scriptFile.getAbsolutePath(),null,null);
  ToolsPigServer.PigPlans plans=pig.getPlans();
  assertNotNull(plans);
  assertNotNull(plans.lp);
  List<ExecJob> jobs=pig.runPlan(plans.lp,"testToolsPigServer");
  assertEquals(1,jobs.size());
  ExecJob job=jobs.get(0);
  assertEquals(JOB_STATUS.COMPLETED,job.getStatus());
  Iterator<Tuple> results=job.getResults();
  assertTrue(results.hasNext());
  Tuple t=results.next();
  assertEquals("abc",t.get(0).toString());
  assertTrue(results.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToolsPigServer() throws Exception {
  Util.createInputFile(cluster,"input",new String[]{"abc\t123","def\t456","ghi\t789"});
  File scriptFile=Util.createFile(new String[]{"a = load 'input' using " + PigStorage.class.getName() + "('\t');","b = foreach a generate $0;","store b into '/bla';"});
  pig.registerNoRun(scriptFile.getAbsolutePath(),null,null);
  ToolsPigServer.PigPlans plans=pig.getPlans();
  assertNotNull(plans);
  assertNotNull(plans.lp);
  List<ExecJob> jobs=pig.runPlan(plans.lp,"testToolsPigServer");
  assertEquals(1,jobs.size());
  ExecJob job=jobs.get(0);
  assertEquals(JOB_STATUS.COMPLETED,job.getStatus());
  Iterator<Tuple> results=job.getResults();
  assertTrue(results.hasNext());
  Tuple t=results.next();
  assertEquals("abc",t.get(0).toString());
  assertTrue(results.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-8 type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  pig=new ToolsPigServer(cluster.getExecType(),cluster.getProperties());
  stdOutRedirectedFile=new File("stdout.redirected");
  if (!stdOutRedirectedFile.createNewFile())   fail("Unable to create input files");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTuple </h4><pre class="type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTupleFormat(){
  try {
    Tuple tuple=mTupleFactory.newTuple(7);
    tuple.set(0,12);
    Map<String,String> map=new HashMap<String,String>();
    map.put("pig","scalability");
    tuple.set(1,map);
    tuple.set(2,null);
    tuple.set(3,12L);
    tuple.set(4,1.2F);
    Tuple innerTuple=mTupleFactory.newTuple(1);
    innerTuple.set(0,"innerTuple");
    tuple.set(5,innerTuple);
    DataBag bag=BagFactory.getInstance().newDefaultBag();
    bag.add(innerTuple);
    tuple.set(6,bag);
    assertEquals("(12,[pig#scalability],,12,1.2,(innerTuple),{(innerTuple)})",TupleFormat.format(tuple));
  }
 catch (  ExecException e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypeCheckingValidatorNewLP </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnionCastingInsert2() throws Throwable {
  printCurrentMethodName();
  LogicalPlan plan=new LogicalPlan();
  String pigStorage=PigStorage.class.getName();
  LOLoad load1=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  LOLoad load2=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  Schema inputSchema1=null;
{
    List<FieldSchema> fsList1=new ArrayList<FieldSchema>();
    fsList1.add(new FieldSchema("field1a",DataType.INTEGER));
    fsList1.add(new FieldSchema("field2a",DataType.BYTEARRAY));
    inputSchema1=new Schema(fsList1);
  }
  Schema inputSchema2=null;
{
    List<FieldSchema> fsList2=new ArrayList<FieldSchema>();
    fsList2.add(new FieldSchema("field1b",DataType.DOUBLE));
    fsList2.add(new FieldSchema("field2b",DataType.DOUBLE));
    inputSchema2=new Schema(fsList2);
  }
  load1.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema(inputSchema1));
  load2.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema(inputSchema2));
  ArrayList<LogicalRelationalOperator> inputList=new ArrayList<LogicalRelationalOperator>();
  inputList.add(load1);
  inputList.add(load2);
  LOUnion union=new LOUnion(plan,false);
  plan.add(load1);
  plan.add(load2);
  plan.add(union);
  plan.connect(load1,union);
  plan.connect(load2,union);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
  typeChecker.visit();
  printMessageCollector(collector);
  Schema outputSchema=org.apache.pig.newplan.logical.Util.translateSchema(union.getSchema());
  Schema expectedSchema=null;
{
    List<FieldSchema> fsListExpected=new ArrayList<FieldSchema>();
    fsListExpected.add(new FieldSchema("field1a",DataType.DOUBLE));
    fsListExpected.add(new FieldSchema("field2a",DataType.DOUBLE));
    expectedSchema=new Schema(fsListExpected);
  }
  assertTrue(Schema.equals(outputSchema,expectedSchema,true,false));
{
    List<Operator> sucList1=plan.getSuccessors(load1);
    assertEquals(1,sucList1.size());
    LOForEach foreach=(LOForEach)sucList1.get(0);
    assertTrue(foreach instanceof LOForEach);
    List<Operator> sucList2=plan.getSuccessors(foreach);
    assertEquals(1,sucList2.size());
    assertTrue(sucList2.get(0) instanceof LOUnion);
    checkForEachCasting(foreach,0,true,DataType.DOUBLE);
    checkForEachCasting(foreach,1,true,DataType.DOUBLE);
  }
{
    List<Operator> sucList1=plan.getSuccessors(load2);
    assertEquals(1,sucList1.size());
    assertTrue(sucList1.get(0) instanceof LOUnion);
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareNULL() throws Throwable {
{
    String query="a = load 'a' as (t1 : int);" + "b = filter a by null == t1;";
    CastExpression castExp=getCastFromLastFilter(query);
    assertNotNull("cast ",castExp);
    assertEquals("cast type",DataType.INTEGER,castExp.getType());
  }
{
    String query="a = load 'a' as (t1 : (i : int));" + "b = filter a by null == t1;";
    CastExpression castExp=getCastFromLastFilter(query);
    assertNotNull("cast ",castExp);
    assertEquals("cast type",DataType.TUPLE,castExp.getType());
  }
{
    String query="a = load 'a' as (t1 : int);" + "b = filter a by t1 <= null;";
    CastExpression castExp=getCastFromLastFilter(query);
    assertNotNull("cast ",castExp);
    assertEquals("cast type",DataType.INTEGER,castExp.getType());
  }
}

</code></pre>

<br>
<pre class="type-7 type-9 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBincond() throws Throwable {
  String query="a= load 'a' as (name: chararray, age: int, gpa: float);" + "b = group a by name;" + "c = foreach b generate (IsEmpty(a) ? " + TestBinCondFieldSchema.class.getName() + "(*): a);";
  LOForEach foreach=getForeachFromPlan(query);
  Schema.FieldSchema charFs=new FieldSchema(null,DataType.CHARARRAY);
  Schema.FieldSchema intFs=new FieldSchema(null,DataType.INTEGER);
  Schema.FieldSchema floatFs=new FieldSchema(null,DataType.FLOAT);
  Schema tupleSchema=new Schema();
  tupleSchema.add(charFs);
  tupleSchema.add(intFs);
  tupleSchema.add(floatFs);
  Schema.FieldSchema bagFs=null;
  Schema bagSchema=new Schema();
  bagSchema.add(new FieldSchema(null,tupleSchema,DataType.TUPLE));
  try {
    bagFs=new Schema.FieldSchema(null,bagSchema,DataType.BAG);
  }
 catch (  FrontendException fee) {
    fail("Did not expect an error");
  }
  Schema expectedSchema=new Schema(bagFs);
  Schema foreachSch=org.apache.pig.newplan.logical.Util.translateSchema(foreach.getSchema());
  assertTrue(Schema.equals(foreachSch,expectedSchema,false,true));
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareEqualityMapCast() throws Throwable {
  String query="a = load 'a' as (t : map[], col);" + "b = filter a by t != col;";
  CastExpression castExp=getCastFromLastFilter(query);
  assertNotNull("cast ",castExp);
  assertEquals("cast type",DataType.MAP,castExp.getType());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnionCastingInsert1() throws Throwable {
  printCurrentMethodName();
  LogicalPlan plan=new LogicalPlan();
  String pigStorage=PigStorage.class.getName();
  LOLoad load1=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  LOLoad load2=newLOLoad(new FileSpec("pi",new FuncSpec(pigStorage)),null,plan,new Configuration(ConfigurationUtil.toConfiguration(pc.getFs().getConfiguration())));
  Schema inputSchema1=null;
{
    List<FieldSchema> fsList1=new ArrayList<FieldSchema>();
    fsList1.add(new FieldSchema("field1a",DataType.INTEGER));
    fsList1.add(new FieldSchema("field2a",DataType.LONG));
    fsList1.add(new FieldSchema(null,DataType.BYTEARRAY));
    fsList1.add(new FieldSchema(null,DataType.CHARARRAY));
    inputSchema1=new Schema(fsList1);
  }
  Schema inputSchema2=null;
{
    List<FieldSchema> fsList2=new ArrayList<FieldSchema>();
    fsList2.add(new FieldSchema("field1b",DataType.DOUBLE));
    fsList2.add(new FieldSchema(null,DataType.INTEGER));
    fsList2.add(new FieldSchema("field3b",DataType.FLOAT));
    fsList2.add(new FieldSchema("field4b",DataType.CHARARRAY));
    inputSchema2=new Schema(fsList2);
  }
  load1.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema(inputSchema1));
  load2.setScriptSchema(org.apache.pig.newplan.logical.Util.translateSchema(inputSchema2));
  ArrayList<LogicalRelationalOperator> inputList=new ArrayList<LogicalRelationalOperator>();
  inputList.add(load1);
  inputList.add(load2);
  LOUnion union=new LOUnion(plan,false);
  plan.add(load1);
  plan.add(load2);
  plan.add(union);
  plan.connect(load1,union);
  plan.connect(load2,union);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingRelVisitor typeChecker=new TypeCheckingRelVisitor(plan,collector);
  typeChecker.visit();
  printMessageCollector(collector);
  Schema outputSchema=org.apache.pig.newplan.logical.Util.translateSchema(union.getSchema());
  Schema expectedSchema=null;
{
    List<FieldSchema> fsListExpected=new ArrayList<FieldSchema>();
    fsListExpected.add(new FieldSchema("field1a",DataType.DOUBLE));
    fsListExpected.add(new FieldSchema("field2a",DataType.LONG));
    fsListExpected.add(new FieldSchema("field3b",DataType.FLOAT));
    fsListExpected.add(new FieldSchema("field4b",DataType.CHARARRAY));
    expectedSchema=new Schema(fsListExpected);
  }
  assertTrue(Schema.equals(outputSchema,expectedSchema,true,false));
{
    List<Operator> sucList1=plan.getSuccessors(load1);
    assertEquals(1,sucList1.size());
    LOForEach foreach=(LOForEach)sucList1.get(0);
    assertTrue(foreach instanceof LOForEach);
    List<Operator> sucList2=plan.getSuccessors(foreach);
    assertEquals(1,sucList2.size());
    assertTrue(sucList2.get(0) instanceof LOUnion);
    checkForEachCasting(foreach,0,true,DataType.DOUBLE);
    checkForEachCasting(foreach,1,false,DataType.UNKNOWN);
    checkForEachCasting(foreach,2,true,DataType.FLOAT);
    checkForEachCasting(foreach,3,false,DataType.UNKNOWN);
  }
{
    List<Operator> sucList1=plan.getSuccessors(load2);
    assertEquals(1,sucList1.size());
    LOForEach foreach=(LOForEach)sucList1.get(0);
    assertTrue(foreach instanceof LOForEach);
    List<Operator> sucList2=plan.getSuccessors(foreach);
    assertEquals(1,sucList2.size());
    assertTrue(sucList2.get(0) instanceof LOUnion);
    checkForEachCasting(foreach,0,false,DataType.UNKNOWN);
    checkForEachCasting(foreach,1,true,DataType.LONG);
    checkForEachCasting(foreach,2,false,DataType.UNKNOWN);
    checkForEachCasting(foreach,3,false,DataType.UNKNOWN);
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticOpCastInsert2() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,10);
  ConstantExpression constant2=new ConstantExpression(plan,20L);
  NegativeExpression neg1=new NegativeExpression(plan,constant1);
  SubtractExpression subtract1=new SubtractExpression(plan,neg1,constant2);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,null);
  expTypeChecker.visit();
  printMessageCollector(collector);
  System.out.println(DataType.findTypeName(subtract1.getType()));
  assertEquals(DataType.LONG,subtract1.getType());
  assertTrue(subtract1.getLhs() instanceof CastExpression);
  assertEquals(DataType.LONG,((CastExpression)subtract1.getLhs()).getType());
  assertEquals(neg1,((CastExpression)subtract1.getLhs()).getExpression());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModCastInsert1() throws Throwable {
  LogicalExpressionPlan plan=new LogicalExpressionPlan();
  ConstantExpression constant1=new ConstantExpression(plan,10);
  ConstantExpression constant2=new ConstantExpression(plan,20L);
  ModExpression mod1=new ModExpression(plan,constant1,constant2);
  CompilationMessageCollector collector=new CompilationMessageCollector();
  TypeCheckingExpVisitor expTypeChecker=new TypeCheckingExpVisitor(plan,collector,null);
  expTypeChecker.visit();
  printMessageCollector(collector);
  System.out.println(DataType.findTypeName(mod1.getType()));
  assertEquals(DataType.LONG,mod1.getType());
  assertTrue(mod1.getLhs() instanceof CastExpression);
  assertEquals(DataType.LONG,((CastExpression)mod1.getLhs()).getType());
  assertEquals(constant1,((CastExpression)mod1.getLhs()).getExpression());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapLookupCast() throws Exception {
  String input[]={"[k1#hello,k2#bye]","[k1#good,k2#morning]"};
  PigServer ps=new PigServer(ExecType.LOCAL);
  File f=org.apache.pig.test.Util.createInputFile("test",".txt",input);
  String inputFileName=Util.generateURI(f.getAbsolutePath(),ps.getPigContext());
  String query="a= load '" + inputFileName + "' as (m);"+ " b = foreach a generate m#'k1';";
  checkLastForeachCastLoadFunc(query,"org.apache.pig.builtin.PigStorage",0);
  query="a= load '" + inputFileName + "' as (m:[]);"+ "b = foreach a generate m#'k1';";
  LOForEach foreach=getForeachFromPlan(query);
  LOGenerate loGen=(LOGenerate)foreach.getInnerPlan().getSinks().get(0);
  Operator outExp=loGen.getOutputPlans().get(0).getSources().get(0);
  assertFalse("outExp is not cast",outExp instanceof CastExpression);
  ps.registerQuery("a = load '" + inputFileName + "' as (m);");
  ps.registerQuery("b = foreach a generate m#'k1';");
  Iterator<Tuple> it=ps.openIterator("b");
  String[] expectedResults=new String[]{"(hello)","(good)"};
  int i=0;
  while (it.hasNext()) {
    assertEquals(expectedResults[i++],it.next().toString());
  }
  ps.registerQuery("a = load '" + inputFileName + "' as (m:[]);");
  ps.registerQuery("b = foreach a generate m#'k1';");
  it=ps.openIterator("b");
  expectedResults=new String[]{"(hello)","(good)"};
  i=0;
  while (it.hasNext()) {
    assertEquals(expectedResults[i++],it.next().toString());
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompareEqualityTupleCast() throws Throwable {
  String query="a = load 'a' as (t : (i : int, j : int), col);" + "b = filter a by t == col;";
  CastExpression castExp=getCastFromLastFilter(query);
  assertNotNull("cast ",castExp);
  assertEquals("cast type",DataType.TUPLE,castExp.getType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestTypedMap </h4><pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexLoad() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#{(1,2),(1,3)},134#]","[key2#]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testComplexLoad",input);
  String query="a = load '" + tmpDirName + "/testComplexLoad' as (m:map[bag{(i:int,j:int)}]);";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("a");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[{(i: int,j: int)}]}");
  Iterator<Tuple> it=pig.openIterator("a");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("134"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof DataBag);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("{(1,2),(1,3)}"));
  Assert.assertTrue(((Map)t.get(0)).get("134") == null);
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") == null);
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexCast2() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testComplexCast2",input);
  String query="a = load '" + tmpDirName + "/testComplexCast2' as (m:[int]);"+ "b = foreach a generate ([long])m;";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("b");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[long]}");
  Iterator<Tuple> it=pig.openIterator("b");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Long);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("1"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") instanceof Long);
  Assert.assertTrue(((Map)t.get(0)).get("key2").toString().equals("2"));
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnTypedMap() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testUnTypedMap",input);
  String query="a = load '" + tmpDirName + "/testUnTypedMap' as (m:[]);";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("a");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[]}");
  Iterator<Tuple> it=pig.openIterator("a");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof DataByteArray);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("1"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") instanceof DataByteArray);
  Assert.assertTrue(((Map)t.get(0)).get("key2").toString().equals("2"));
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleMapKeyLookup() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]","[key#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testSimpleMapKeyLookup",input);
  String query="a = load '" + tmpDirName + "/testSimpleMapKeyLookup' as (m:map[int]);"+ "b = foreach a generate m#'key';";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("b");
  assertEquals("Checking expected schema",sch.toString(),"{int}");
  Iterator<Tuple> it=pig.openIterator("b");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue((Integer)t.get(0) == 1);
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue((Integer)t.get(0) == 2);
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleLoad() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]","[key#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/table_testSimpleLoad",input);
  String query="  a = load '" + tmpDirName + "/table_testSimpleLoad' as (m:map[int]);";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("a");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[int]}");
  Iterator<Tuple> it=pig.openIterator("a");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("1"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key2").toString().equals("2"));
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("2"));
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testComplexCast() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#{(1,2),(1,3)},134#]","[key2#]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testComplexCast",input);
  String query="a = load '" + tmpDirName + "/testComplexCast' as (m);"+ "b = foreach a generate ([{(i:int,j:int)}])m;";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("b");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[{(i: int,j: int)}]}");
  Iterator<Tuple> it=pig.openIterator("b");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("134"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof DataBag);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("{(1,2),(1,3)}"));
  Assert.assertTrue(((Map)t.get(0)).get("134") == null);
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") == null);
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleMapCast() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode(),new Properties());
  String[] input={"[key#1,key2#2]","[key#2]"};
  Util.createInputFile(FileSystem.getLocal(new Configuration()),tmpDirName + "/testSimpleMapCast",input);
  String query="a = load '" + tmpDirName + "/testSimpleMapCast' as (m);"+ "b = foreach a generate ([int])m;";
  Util.registerMultiLineQuery(pig,query);
  Schema sch=pig.dumpSchema("b");
  assertEquals("Checking expected schema",sch.toString(),"{m: map[int]}");
  Iterator<Tuple> it=pig.openIterator("b");
  Assert.assertTrue(it.hasNext());
  Tuple t=it.next();
  Assert.assertTrue(t.size() == 1);
  Assert.assertTrue(t.get(0) instanceof Map);
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).containsKey("key2"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("1"));
  Assert.assertTrue(((Map)t.get(0)).get("key2") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key2").toString().equals("2"));
  Assert.assertTrue(it.hasNext());
  t=it.next();
  Assert.assertTrue(((Map)t.get(0)).containsKey("key"));
  Assert.assertTrue(((Map)t.get(0)).get("key") instanceof Integer);
  Assert.assertTrue(((Map)t.get(0)).get("key").toString().equals("2"));
  Assert.assertFalse(it.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDF </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUDFNullInput() throws Exception {
  PigServer pig=new PigServer(Util.getLocalTestMode());
  File inputFile=Util.createInputFile("tmp","",new String[]{"\t","2\t3"});
  pig.registerQuery("a = load '" + Util.generateURI(inputFile.toString(),pig.getPigContext()) + "' as (i1:int, i2:int);");
  pig.registerQuery("b = foreach a generate " + IntToBool.class.getName() + "(i1);");
  Iterator<Tuple> iter=pig.openIterator("b");
  assertEquals(iter.next().toString(),"(false)");
  assertEquals(iter.next().toString(),"(true)");
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUDFGroovy </h4><pre class="type-13 type-7 type-4 type-19 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroovyToPig() throws Exception {
  Object groovyObject=Boolean.TRUE;
  Object pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Boolean);
  assertEquals(true,pigObject);
  groovyObject=Byte.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals((int)Byte.MIN_VALUE,pigObject);
  groovyObject=Short.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals((int)Short.MIN_VALUE,pigObject);
  groovyObject=Integer.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Integer);
  assertEquals(Integer.MIN_VALUE,pigObject);
  groovyObject=Long.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Long);
  assertEquals(Long.MIN_VALUE,pigObject);
  groovyObject=BigInteger.TEN;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=Float.MIN_NORMAL;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Float);
  assertEquals(Float.MIN_NORMAL,pigObject);
  groovyObject=Double.MIN_VALUE;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Double);
  assertEquals(Double.MIN_VALUE,pigObject);
  groovyObject=new BigDecimal("42.42");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject="Dans le cochon tout est bon !";
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof String);
  assertEquals("Dans le cochon tout est bon !",pigObject);
  groovyObject="Surtout le jambon".getBytes("UTF-8");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof DataByteArray);
  assertArrayEquals("Surtout le jambon".getBytes("UTF-8"),((DataByteArray)pigObject).get());
  groovyObject=new Object[2];
  ((Object[])groovyObject)[0]="Pate";
  ((Object[])groovyObject)[1]="Henaff";
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Tuple);
  assertEquals(2,((Tuple)pigObject).size());
  assertEquals("Pate",((Tuple)pigObject).get(0));
  assertEquals("Henaff",((Tuple)pigObject).get(1));
  groovyObject=new Object[2];
  ((Object[])groovyObject)[0]="Rillettes";
  ((Object[])groovyObject)[1]="Bordeau Chesnel";
  groovyObject=new groovy.lang.Tuple((Object[])groovyObject);
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Tuple);
  assertEquals(2,((Tuple)pigObject).size());
  assertEquals("Rillettes",((Tuple)pigObject).get(0));
  assertEquals("Bordeau Chesnel",((Tuple)pigObject).get(1));
  groovyObject=new ArrayList();
  ((List)groovyObject).add("Jaret");
  ((List)groovyObject).add("Filet Mignon");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof DataBag);
  assertEquals(2,((DataBag)pigObject).size());
  Iterator<Tuple> iter=((DataBag)pigObject).iterator();
  Set<String> values=new HashSet<String>();
  while (iter.hasNext()) {
    Tuple t=iter.next();
    assertEquals(1,t.size());
    values.add((String)t.get(0));
  }
  assertEquals(2,values.size());
  assertTrue(values.contains("Jaret"));
  assertTrue(values.contains("Filet Mignon"));
  groovyObject=new HashMap<String,String>();
  ((Map)groovyObject).put("Henaff","a bord");
  ((Map)groovyObject).put("Copains","comme cochons");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof Map);
  assertEquals(2,((Map)pigObject).size());
  assertEquals("a bord",((Map)pigObject).get("Henaff"));
  assertEquals("comme cochons",((Map)pigObject).get("Copains"));
  groovyObject=TupleFactory.getInstance().newTuple(2);
  ((Tuple)groovyObject).set(0,"jambon");
  ((Tuple)groovyObject).set(1,"blanc");
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=new DefaultDataBag();
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertSame(groovyObject,pigObject);
  groovyObject=new org.joda.time.DateTime();
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertTrue(pigObject instanceof org.joda.time.DateTime);
  assertSame(groovyObject,pigObject);
  groovyObject=null;
  pigObject=GroovyUtils.groovyToPig(groovyObject);
  assertNull(pigObject);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-19 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigToGroovy() throws Exception {
  Object pigObject=Boolean.TRUE;
  Object groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Boolean);
  assertEquals(true,groovyObject);
  pigObject=Integer.valueOf(42);
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Integer);
  assertEquals(42,groovyObject);
  pigObject=Long.valueOf(0x100000000L);
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Long);
  assertEquals(0x100000000L,groovyObject);
  pigObject=Float.MIN_VALUE;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Float);
  assertEquals(Float.MIN_VALUE,groovyObject);
  pigObject=Double.MAX_VALUE;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Double);
  assertEquals(Double.MAX_VALUE,groovyObject);
  pigObject="Dans le cochon tout est bon !";
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof String);
  assertEquals("Dans le cochon tout est bon !",groovyObject);
  pigObject=new DataByteArray("Surtout le jambon".getBytes("UTF-8"));
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof byte[]);
  assertNotSame(groovyObject,pigObject);
  assertArrayEquals("Surtout le jambon".getBytes("UTF-8"),(byte[])groovyObject);
  pigObject=new org.joda.time.DateTime();
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof org.joda.time.DateTime);
  assertSame(groovyObject,pigObject);
  pigObject=tuple("a","b","c");
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof groovy.lang.Tuple);
  assertEquals(3,((groovy.lang.Tuple)groovyObject).size());
  assertEquals("a",((groovy.lang.Tuple)groovyObject).get(0));
  assertEquals("b",((groovy.lang.Tuple)groovyObject).get(1));
  assertEquals("c",((groovy.lang.Tuple)groovyObject).get(2));
  pigObject=bag(tuple("a"),tuple("b"));
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof groovy.lang.Tuple);
  assertEquals(2,((groovy.lang.Tuple)groovyObject).size());
  assertEquals(2L,((groovy.lang.Tuple)groovyObject).get(0));
  assertTrue(((groovy.lang.Tuple)groovyObject).get(1) instanceof Iterator);
  Iterator<groovy.lang.Tuple> iter=(Iterator)((groovy.lang.Tuple)groovyObject).get(1);
  groovy.lang.Tuple t=iter.next();
  assertEquals(1,t.size());
  assertEquals("a",t.get(0));
  t=iter.next();
  assertEquals(1,t.size());
  assertEquals("b",t.get(0));
  pigObject=new HashMap<String,String>();
  ((Map)pigObject).put("Pate","Henaff");
  ((Map)pigObject).put("Rillettes","Bordeau Chesnel");
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertTrue(groovyObject instanceof Map);
  assertEquals(2,((Map)groovyObject).size());
  assertEquals("Henaff",((Map)groovyObject).get("Pate"));
  assertEquals("Bordeau Chesnel",((Map)groovyObject).get("Rillettes"));
  pigObject=BigInteger.ONE;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertSame(pigObject,groovyObject);
  pigObject=new BigDecimal("42.42");
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertSame(pigObject,groovyObject);
  pigObject=null;
  groovyObject=GroovyUtils.pigToGroovy(pigObject);
  assertNull(groovyObject);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.test.TestUnion </h4><pre class="type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNextNullInput() throws Exception {
  File f1=Util.createInputFile("tmp","a.txt",new String[]{"1\t2\t3","4\t5\t6"});
  File f2=Util.createInputFile("tmp","b.txt",new String[]{"7\t8\t9","1\t200\t300"});
  File f3=Util.createInputFile("tmp","c.txt",new String[]{"1\t20\t30"});
  pigServer.registerQuery("a = load '" + Util.encodeEscape(f1.getAbsolutePath()) + "' ;");
  pigServer.registerQuery("b = load '" + Util.encodeEscape(f2.getAbsolutePath()) + "';");
  pigServer.registerQuery("c = union a, b;");
  pigServer.registerQuery("d = load '" + Util.encodeEscape(f3.getAbsolutePath()) + "' ;");
  pigServer.registerQuery("e = cogroup c by $0 inner, d by $0 inner;");
  pigServer.explain("e",System.err);
  Tuple expectedResult=new DefaultTuple();
  expectedResult.append(new DataByteArray("1"));
  Tuple[] secondFieldContents=new DefaultTuple[2];
  secondFieldContents[0]=Util.createTuple(Util.toDataByteArrays(new String[]{"1","2","3"}));
  secondFieldContents[1]=Util.createTuple(Util.toDataByteArrays(new String[]{"1","200","300"}));
  DataBag secondField=Util.createBag(secondFieldContents);
  expectedResult.append(secondField);
  DataBag thirdField=Util.createBag(new Tuple[]{Util.createTuple(Util.toDataByteArrays(new String[]{"1","20","30"}))});
  expectedResult.append(thirdField);
  Iterator<Tuple> it=pigServer.openIterator("e");
  assertEquals(expectedResult,it.next());
  assertFalse(it.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-9 type-6 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaMergeWithBag() throws Exception {
  File f1=Util.createInputFile("tmp","input1.txt",new String[]{"dummy"});
  File f2=Util.createInputFile("tmp","input2.txt",new String[]{"dummy"});
  Util.registerMultiLineQuery(pigServer,"a = load '" + Util.encodeEscape(f1.getAbsolutePath()) + "';"+ "b = load '"+ Util.encodeEscape(f2.getAbsolutePath())+ "';"+ "c = foreach a generate 1, {(1, 'str1')};"+ "d = foreach b generate 2, {(2, 'str2')};"+ "e = union c,d;"+ "");
  Iterator<Tuple> it=pigServer.openIterator("e");
  Object[] expected=new Object[]{Util.getPigConstant("(1, {(1, 'str1')})"),Util.getPigConstant("(2, {(2, 'str2')})")};
  Object[] results=new Object[2];
  int i=0;
  while (it.hasNext()) {
    if (i == 2) {
      fail("Got more tuples than expected!");
    }
    Tuple t=it.next();
    if (t.get(0).equals(1)) {
      results[0]=t;
    }
 else {
      results[1]=t;
    }
    i++;
  }
  for (int j=0; j < expected.length; j++) {
    assertEquals(expected[j],results[j]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestPOPartialAggPlanTez </h4><pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropTrue() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNotNull("POPartialAgg should be present",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMapAggProp() throws Exception {
  String query=getGByQuery();
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNotCombinable() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group, COUNT(l.b), l.b;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggPropFalse() throws Exception {
  String query=getGByQuery();
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"false");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggNoAggFunc() throws Exception {
  String query="l = load 'x' as (a,b,c);" + "g = group l by a;" + "f = foreach g generate group;";
  pc.getProperties().setProperty(PigConfiguration.PIG_EXEC_MAP_PARTAGG,"true");
  TezPlanContainer tezPlanContainer=TezUtil.buildTezPlanContainer(query,pc);
  assertEquals(tezPlanContainer.size(),1);
  assertNull("POPartialAgg should be absent",findPOPartialAgg(tezPlanContainer));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezAutoParallelism </h4><pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncreaseIntermediateParallelism1() throws IOException {
  String outputDir="/tmp/testIncreaseIntermediateParallelism";
  String script="A = load '" + INPUT_FILE1 + "' as (name:chararray, age:int);"+ "B = load '"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);"+ "C = join A by name, B by name using 'skewed' parallel 1;"+ "D = group C by A::name;"+ "E = foreach D generate group, COUNT(C.A::name);"+ "STORE E into '"+ outputDir+ "/finalout';";
  String log=testIncreaseIntermediateParallelism(script,outputDir,true);
  assertTrue(log.contains("Increased requested parallelism of scope-59 to 4"));
  assertEquals(1,StringUtils.countMatches(log,"Increased requested parallelism"));
  assertTrue(log.contains("Total estimated parallelism is 52"));
}

</code></pre>

<br>
<pre class="type-7 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncreaseIntermediateParallelism3() throws IOException {
  try {
    String outputDir="/tmp/testIncreaseIntermediateParallelism";
    String script="set default_parallel 1\n" + "A = load '" + INPUT_FILE1 + "' as (name:chararray, age:int);"+ "B = load '"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);"+ "C = join A by name, B by name;"+ "STORE C into '/tmp/testIncreaseIntermediateParallelism';"+ "C1 = group C by A::name;"+ "C2 = FOREACH C1 generate group, FLATTEN(C);"+ "D = group C2 by group;"+ "E = foreach D generate group, COUNT(C2.A::name);"+ "F = order E by $0;"+ "STORE F into '"+ outputDir+ "/finalout';";
    String log=testIncreaseIntermediateParallelism(script,outputDir,false);
    assertEquals(1,StringUtils.countMatches(log,"Increased requested parallelism"));
    assertTrue(log.contains("Increased requested parallelism of scope-65 to 10"));
    assertTrue(log.contains("Total estimated parallelism is 19"));
  }
  finally {
    pigServer.setDefaultParallel(-1);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezGraceParallelism </h4><pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncreaseParallelism() throws IOException {
  NodeIdGenerator.reset();
  PigServer.resetScope();
  StringWriter writer=new StringWriter();
  Util.createLogAppender("testIncreaseParallelism",writer,new Class[]{PigGraceShuffleVertexManager.class,ShuffleVertexManager.class});
  try {
    pigServer.getPigContext().getProperties().setProperty(InputSizeReducerEstimator.BYTES_PER_REDUCER_PARAM,"80000");
    pigServer.registerQuery("A = load '" + INPUT_DIR + "/"+ INPUT_FILE1+ "' as (name:chararray, age:int);");
    pigServer.registerQuery("B = load '" + INPUT_DIR + "/"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);");
    pigServer.registerQuery("C = join A by 1, B by 1;");
    pigServer.registerQuery("D = foreach C generate A::name as name, A::age as age, gender;");
    pigServer.registerQuery("E = order D by name;");
    pigServer.registerQuery("F = distinct E;");
    Iterator<Tuple> iter=pigServer.openIterator("F");
    int count=0;
    while (iter.hasNext()) {
      iter.next();
      count++;
    }
    assertEquals(count,644);
    System.out.println(writer.toString());
    assertTrue(writer.toString().contains("Initialize parallelism for scope-64 to 50"));
    assertTrue(Pattern.compile("Reduce auto parallelism for vertex: scope-64 to (\\d+)* from 50").matcher(writer.toString()).find());
  }
  finally {
    Util.removeLogAppender("testIncreaseParallelism",PigGraceShuffleVertexManager.class,ShuffleVertexManager.class);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinWithDifferentDepth() throws IOException {
  NodeIdGenerator.reset();
  PigServer.resetScope();
  StringWriter writer=new StringWriter();
  Util.createLogAppender("testJoinWithDifferentDepth",writer,PigGraceShuffleVertexManager.class);
  try {
    pigServer.registerQuery("A = load '" + INPUT_DIR + "/"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);");
    pigServer.registerQuery("B = order A by name;");
    pigServer.registerQuery("C = distinct B;");
    pigServer.registerQuery("D = load '" + INPUT_DIR + "/"+ INPUT_FILE1+ "' as (name:chararray, age:int);");
    pigServer.registerQuery("E = group D by name;");
    pigServer.registerQuery("F = foreach E generate group as name, AVG(D.age) as avg_age;");
    pigServer.registerQuery("G = join C by name, F by name;");
    Iterator<Tuple> iter=pigServer.openIterator("G");
    int count=0;
    while (iter.hasNext()) {
      iter.next();
      count++;
    }
    assertEquals(count,20);
    assertTrue(writer.toString().contains("All predecessors for scope-84 are finished, time to set parallelism for scope-85"));
    assertTrue(writer.toString().contains("Initialize parallelism for scope-85 to 101"));
  }
  finally {
    Util.removeLogAppender("testJoinWithDifferentDepth",PigGraceShuffleVertexManager.class);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinWithDifferentDepth2() throws IOException {
  NodeIdGenerator.reset();
  PigServer.resetScope();
  StringWriter writer=new StringWriter();
  Util.createLogAppender("testJoinWithDifferentDepth2",writer,PigGraceShuffleVertexManager.class);
  try {
    pigServer.registerQuery("A = load '" + INPUT_DIR + "/"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);");
    pigServer.registerQuery("B = order A by name;");
    pigServer.registerQuery("C = distinct B;");
    pigServer.registerQuery("D = load '" + INPUT_DIR + "/"+ INPUT_FILE1+ "' as (name:chararray, age:int);");
    pigServer.registerQuery("E = join C by name, D by name;");
    Iterator<Tuple> iter=pigServer.openIterator("E");
    int count=0;
    while (iter.hasNext()) {
      iter.next();
      count++;
    }
    assertEquals(count,1000);
    assertFalse(writer.toString().contains("scope-68"));
  }
  finally {
    Util.removeLogAppender("testJoinWithDifferentDepth2",PigGraceShuffleVertexManager.class);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinWithUnion() throws IOException {
  NodeIdGenerator.reset();
  PigServer.resetScope();
  StringWriter writer=new StringWriter();
  Util.createLogAppender("testJoinWithUnion",writer,PigGraceShuffleVertexManager.class);
  try {
    pigServer.registerQuery("A = load '" + INPUT_DIR + "/"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);");
    pigServer.registerQuery("B = distinct A;");
    pigServer.registerQuery("C = group B by name;");
    pigServer.registerQuery("D = load '" + INPUT_DIR + "/"+ INPUT_FILE2+ "' as (name:chararray, gender:chararray);");
    pigServer.registerQuery("E = distinct D;");
    pigServer.registerQuery("F = group E by name;");
    pigServer.registerQuery("G = union C, F;");
    pigServer.registerQuery("H = distinct G;");
    Iterator<Tuple> iter=pigServer.openIterator("H");
    int count=0;
    while (iter.hasNext()) {
      iter.next();
      count++;
    }
    assertEquals(count,20);
    assertTrue(writer.toString().contains("time to set parallelism for scope-41"));
    assertTrue(writer.toString().contains("time to set parallelism for scope-54"));
  }
  finally {
    Util.removeLogAppender("testJoinWithUnion",PigGraceShuffleVertexManager.class);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezJobControlCompiler </h4><pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezParallelismEstimatorFilterFlatten() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = filter a by age>20;"+ "c = group b by name;"+ "d = foreach c generate group, flatten(b.gpa);"+ "e = group d by group;"+ "store e into 'output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  TezOperator leafOper=compiledPlan.first.getLeaves().get(0);
  assertTrue(leafOper.isUseGraceParallelism());
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),-1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezParallelismEstimatorSplitBranch() throws Exception {
  pc.getProperties().setProperty(PigConfiguration.PIG_NO_SPLIT_COMBINATION,"true");
  String query="a = load '10' using " + ArbitarySplitsLoader.class.getName() + "() as (name:chararray, age:int, gpa:double);"+ "b = filter a by age>20;"+ "c = filter a by age>50;"+ "store b into 'o1';"+ "d = group c by name;"+ "store d into 'o2';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  Collections.sort(leaves);
  TezOperator leafOper=leaves.get(1);
  assertTrue(leafOper.isUseGraceParallelism());
  Vertex leafVertex=compiledPlan.second.getVertex(leafOper.getOperatorKey().toString());
  assertEquals(leafVertex.getParallelism(),-1);
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun2() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = group a by x;"+ "c = foreach b generate group, a;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(1,root.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(1,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root.getOutputVertices().get(0),leaf);
  assertEquals(root,leaf.getInputVertices().get(0));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-4 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun3() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = load '"+ input2+ "' as (x:int, z:int);"+ "c = join a by x, b by x;"+ "d = foreach c generate a::x as x, y, z;"+ "store d into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(2,roots.size());
  List<TezOperator> leaves=compiledPlan.first.getLeaves();
  assertEquals(1,leaves.size());
  Vertex root0=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  Vertex root1=compiledPlan.second.getVertex(roots.get(1).getOperatorKey().toString());
  assertNotNull(root0);
  assertNotNull(root1);
  assertEquals(0,root0.getInputVertices().size());
  assertEquals(1,root1.getOutputVertices().size());
  Vertex leaf=compiledPlan.second.getVertex(leaves.get(0).getOperatorKey().toString());
  assertNotNull(leaf);
  assertEquals(2,leaf.getInputVertices().size());
  assertEquals(0,leaf.getOutputVertices().size());
  assertEquals(root0.getOutputVertices().get(0),leaf);
  assertEquals(root1.getOutputVertices().get(0),leaf);
  assertTrue(leaf.getInputVertices().contains(root0));
  assertTrue(leaf.getInputVertices().contains(root1));
}

</code></pre>

<br>
<pre class="type-7 type-6 type-2 type-5 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun1() throws Exception {
  String query="a = load '" + input1 + "' as (x:int, y:int);"+ "b = filter a by x > 0;"+ "c = foreach b generate y;"+ "store c into 'file:///tmp/output';";
  Pair<TezOperPlan,DAG> compiledPlan=compile(query);
  List<TezOperator> roots=compiledPlan.first.getRoots();
  assertEquals(1,roots.size());
  Vertex root=compiledPlan.second.getVertex(roots.get(0).getOperatorKey().toString());
  assertNotNull(root);
  assertEquals(0,root.getInputVertices().size());
  assertEquals(0,root.getOutputVertices().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tez.TestTezLauncher </h4><pre class="type-13 type-7 type-6 type-4 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRun1() throws Exception {
  String query="a = load '" + INPUT_FILE + "' as (x:int, y:chararray);"+ "b = filter a by x > 100;"+ "c = foreach b generate y;"+ "d = group c all;"+ "store d into '"+ OUTPUT_FILE+ "';";
  PhysicalPlan pp=Util.buildPp(pigServer,query);
  TezLauncher launcher=new TezLauncher();
  PigStats pigStats=launcher.launchPig(pp,"testRun1",pc);
  assertTrue(pigStats.isSuccessful());
  assertEquals(1,pigStats.getInputStats().size());
  assertEquals(INPUT_FILE,pigStats.getInputStats().get(0).getName());
  assertEquals(1,pigStats.getOutputStats().size());
  assertEquals(OUTPUT_FILE,pigStats.getOutputStats().get(0).getName());
  query="m = load '" + OUTPUT_FILE + "' as (a:chararray, b:{(y:chararray)});";
  pigServer=new PigServer(pc);
  pigServer.registerQuery(query);
  Iterator<Tuple> iter=pigServer.openIterator("m");
  Tuple result=iter.next();
  assertEquals(result.get(0).toString(),"all");
  Iterator<Tuple> innerIter=((DataBag)result.get(1)).iterator();
  int count=0;
  while (innerIter.hasNext()) {
    assertTrue(Arrays.asList(OUTPUT_RECORDS).contains(innerIter.next().toString()));
    count++;
  }
  assertEquals(count,OUTPUT_RECORDS.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.pig.tools.grunt.TestGruntParser </h4><pre class="type-9 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessRemove() throws IOException {
  File tmpFile=File.createTempFile("TestGruntParser","testProcessRemove");
  String dummyScript="";
  parser=new GruntParser(new ByteArrayInputStream(dummyScript.getBytes()),pig);
  parser.processRemove(tmpFile.getAbsolutePath(),"");
  assertFalse(tmpFile.exists());
  try {
    parser.processRemove(tmpFile.getAbsolutePath(),"");
    fail("processRemove should throw exception when deleting missing file.");
  }
 catch (  IOException e) {
  }
  parser.processRemove(tmpFile.getAbsolutePath(),"force");
  tmpFile=File.createTempFile("TestGruntParser","testProcessRemove");
  parser.setExplainState(new ExplainState("","","",false,""));
  parser.processRemove(tmpFile.getAbsolutePath(),"force");
  assertTrue(tmpFile.exists());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
